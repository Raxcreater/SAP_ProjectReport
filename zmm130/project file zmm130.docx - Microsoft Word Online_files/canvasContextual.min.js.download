(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[15],{1077:function(e,t,o){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,i,n)}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(o(1773),t),n(o(1774),t),n(o(1775),t),n(o(1776),t),n(o(1777),t),n(o(1778),t),n(o(1779),t),n(o(1780),t),n(o(1781),t),n(o(1782),t),n(o(1783),t),n(o(1784),t),n(o(1785),t),n(o(1786),t),n(o(1787),t),n(o(1788),t),n(o(1789),t),n(o(1790),t),n(o(1791),t),n(o(1792),t),n(o(1793),t),n(o(1794),t),n(o(1795),t),n(o(1796),t),n(o(1078),t),n(o(1797),t),n(o(1798),t),n(o(1799),t)},1078:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInitiatedAnnotationClient=t.EccAnnotationClient=t.EccAnnotation=t.EccAnnotationBase=t.UserInitiatedAnnotation=t.PredictionAnnotation=t.PredictionAnnotationClient=t.PredictionAnnotationBase=t.FlagAnnotation=t.NudgeAnnotationClient=t.NudgeAnnotation=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.NudgeAnnotation=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.NudgeAnnotationClient=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagAnnotation=s;var a=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionAnnotationBase=a;var l=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionAnnotationClient=l;var c=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionAnnotation=c;var u=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedAnnotation=u;var p=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccAnnotationBase=p;var d=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccAnnotation=d;var g=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccAnnotationClient=g;var h=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedAnnotationClient=h},1773:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1774:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomPropName=void 0,function(e){e.Fields="Fields",e.Filter="Filter"}(t.CustomPropName||(t.CustomPropName={}))},1775:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1776:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1777:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1778:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityType=void 0,function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Topic="Topic",e.TuringQnA="TuringQnA"}(t.EntityType||(t.EntityType={}))},1779:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionMode=void 0,function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(t.InteractionMode||(t.InteractionMode={}))},1780:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1781:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1782:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1783:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1784:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1785:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1786:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1787:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1788:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultStatus=void 0,function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError"}(t.ResultStatus||(t.ResultStatus={}))},1789:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFlagResultList=t.isSystemInitiatedResultList=t.isUserInitiatedResultList=t.isEccResultList=t.isFlagResult=t.isUserInitiatedResult=t.isSystemInitiatedResult=t.isPredictionAnnotation=t.isEccResult=void 0;var i=o(1078);t.isEccResult=function(e){return i.EccAnnotation.typeGuard(e)};t.isPredictionAnnotation=function(e){return i.PredictionAnnotationBase.typeGuard(e)};t.isSystemInitiatedResult=function(e){return(0,t.isPredictionAnnotation)(e)||i.NudgeAnnotation.typeGuard(e)};t.isUserInitiatedResult=function(e){return i.UserInitiatedAnnotation.typeGuard(e)};t.isFlagResult=function(e){return i.FlagAnnotation.typeGuard(e)};t.isEccResultList=function(e){return(null==e?void 0:e.length)>0&&i.EccAnnotation.typeGuard(e[0])};t.isUserInitiatedResultList=function(e){return(null==e?void 0:e.length)>0&&i.UserInitiatedAnnotation.typeGuard(e[0])};t.isSystemInitiatedResultList=function(e){return(null==e?void 0:e.length)>0&&(0,t.isSystemInitiatedResult)(e[0])};t.isFlagResultList=function(e){return(null==e?void 0:e.length)>0&&i.FlagAnnotation.typeGuard(e[0])}},1790:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionConfig=t.ClientConfig=t.PredictionConfig=t.NudgeConfig=t.FlagConfig=t.EccConfig=t.ScopeConfig=t.BestMatchConfig=t.FeatureConfig=t.EccFeatureConfig=t.EccEntityConfig=t.EntityConfig=t.CustomProp=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_CustomProp"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.CustomProp=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EntityConfig=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccEntityConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EntityConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccEntityConfig=s;var a=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccFeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccFeatureConfig=a;var l=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FeatureConfig=l;var c=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.BestMatchConfig=c;var u=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ScopeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ScopeConfig=u;var p=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccFeatureConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccConfig=p;var d=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagConfig=d;var g=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.NudgeConfig=g;var h=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionConfig=h;var m=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ClientConfig=m;var y=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionConfig"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SessionConfig=y},1791:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShutdownSignal=t.ClientConfigSignal=t.StartupSignal=t.InteractionModeSignal=t.ControlSignal=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ControlSignal=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.InteractionModeSignal=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.StartupSignal=s;var a=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ClientConfigSignal=a;var l=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ShutdownSignal=l},1792:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityList=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityList"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EntityList=n},1793:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalResult=t.EntityResult=t.AddressResult=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_AddressResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.AddressResult=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EntityResult=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_LocalResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.LocalResult=s},1794:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelInfo=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ModelInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ModelInfo=n},1795:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelMetadata=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ModelMetadata"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ModelMetadata=n},1796:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInitiatedRequestClient=t.UserInitiatedRequest=t.UserInitiatedRequestBase=t.SystemInitiatedRequestHybrid=t.SystemInitiatedRequestClient=t.SystemInitiatedRequest=t.SystemInitiatedRequestBase=t.SessionStartRequest=t.FlagRequest=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagRequest=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SessionStartRequest=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequestBase=s;var a=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequest=a;var l=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequestClient=l;var c=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequestHybrid=c;var u=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedRequestBase=u;var p=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedRequest=p;var d=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedRequestClient=d},1797:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagResultAnnotation=t.SystemInitiatedResultAnnotationHybrid=t.SystemInitiatedResultAnnotationClient=t.SystemInitiatedResultAnnotation=t.SystemInitiatedResultAnnotationBase=t.UserInitiatedResultAnnotationHybrid=t.UserInitiatedResultAnnotationClient=t.UserInitiatedResultAnnotation=t.UserInitiatedResultAnnotationBase=t.EccResultAnnotationHybrid=t.EccResultAnnotationClient=t.EccResultAnnotation=t.EccResultAnnotationBase=t.UxTreatments=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UxTreatments=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotationBase=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotation=s;var a=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotationClient=a;var l=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotationHybrid=l;var c=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotationBase=c;var u=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotation=u;var p=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotationClient=p;var d=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotationHybrid=d;var g=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotationBase=g;var h=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotation=h;var m=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotationClient=m;var y=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotationHybrid=y;var f=function(){function e(t){i.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagResultAnnotation=f},1798:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultInfo=t.BestMatchInfo=t.IconInfo=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_IconInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.IconInfo=n;var r=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.BestMatchInfo=r;var s=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ResultInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ResultInfo=s},1799:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugInfo=void 0;var i=o(83),n=function(){function e(t){i.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_DebugInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.DebugInfo=n},1804:function(e,t,o){var i={"./af-ZA/canvas-contextual.json":[1183,23],"./am-ET/canvas-contextual.json":[1184,25],"./ar-SA/canvas-contextual.json":[1185,27],"./as-IN/canvas-contextual.json":[1186,29],"./az-Latn-AZ/canvas-contextual.json":[1187,31],"./be-BY/canvas-contextual.json":[1188,32],"./bg-BG/canvas-contextual.json":[1189,34],"./bn-BD/canvas-contextual.json":[1190,35],"./bn-IN/canvas-contextual.json":[1191,37],"./bs-Latn-BA/canvas-contextual.json":[1192,39],"./ca-ES/canvas-contextual.json":[1193,41],"./ca-Es-VALENCIA/canvas-contextual.json":[1194,43],"./chr-Cher-US/canvas-contextual.json":[1195,44],"./cs-CZ/canvas-contextual.json":[1196,46],"./cy-GB/canvas-contextual.json":[1197,48],"./da-DK/canvas-contextual.json":[1198,50],"./de-DE/canvas-contextual.json":[1199,52],"./el-GR/canvas-contextual.json":[1200,54],"./en-GB/canvas-contextual.json":[1201,56],"./en-US/canvas-contextual.json":[1202,57],"./es-ES/canvas-contextual.json":[1203,59],"./es-MX/canvas-contextual.json":[1204,61],"./et-EE/canvas-contextual.json":[1205,63],"./eu-ES/canvas-contextual.json":[1206,65],"./fa-IR/canvas-contextual.json":[1207,67],"./fi-FI/canvas-contextual.json":[1208,69],"./fil-PH/canvas-contextual.json":[1209,71],"./fr-CA/canvas-contextual.json":[1210,73],"./fr-FR/canvas-contextual.json":[1211,75],"./ga-IE/canvas-contextual.json":[1212,77],"./gd-gb/canvas-contextual.json":[1213,79],"./gl-ES/canvas-contextual.json":[1214,81],"./gu-IN/canvas-contextual.json":[1215,83],"./ha-Latn-NG/canvas-contextual.json":[1216,84],"./he-IL/canvas-contextual.json":[1217,86],"./hi-IN/canvas-contextual.json":[1218,88],"./hr-HR/canvas-contextual.json":[1219,90],"./hu-HU/canvas-contextual.json":[1220,92],"./hy-AM/canvas-contextual.json":[1221,94],"./id-ID/canvas-contextual.json":[1222,96],"./is-IS/canvas-contextual.json":[1223,98],"./it-IT/canvas-contextual.json":[1224,100],"./ja-JP/canvas-contextual.json":[1225,102],"./ka-GE/canvas-contextual.json":[1226,104],"./kk-KZ/canvas-contextual.json":[1227,106],"./km-KH/canvas-contextual.json":[1228,108],"./kn-IN/canvas-contextual.json":[1229,110],"./ko-KR/canvas-contextual.json":[1230,112],"./kok-IN/canvas-contextual.json":[1231,114],"./ky-KG/canvas-contextual.json":[1232,115],"./lb-LU/canvas-contextual.json":[1233,117],"./lo-LA/canvas-contextual.json":[1234,119],"./lt-LT/canvas-contextual.json":[1235,121],"./lv-LV/canvas-contextual.json":[1236,123],"./mi-NZ/canvas-contextual.json":[1237,125],"./mk-MK/canvas-contextual.json":[1238,127],"./ml-IN/canvas-contextual.json":[1239,129],"./mn-MN/canvas-contextual.json":[1240,130],"./mr-IN/canvas-contextual.json":[1241,132],"./ms-MY/canvas-contextual.json":[1242,134],"./mt-MT/canvas-contextual.json":[1243,136],"./nb-NO/canvas-contextual.json":[1244,138],"./ne-NP/canvas-contextual.json":[1245,140],"./nl-NL/canvas-contextual.json":[1246,142],"./nn-NO/canvas-contextual.json":[1247,144],"./or-IN/canvas-contextual.json":[1248,146],"./pa-IN/canvas-contextual.json":[1249,148],"./pl-PL/canvas-contextual.json":[1250,150],"./prs-AF/canvas-contextual.json":[1251,151],"./pt-BR/canvas-contextual.json":[1252,153],"./pt-PT/canvas-contextual.json":[1253,155],"./qps-ploc/canvas-contextual.json":[1254,156],"./qps-ploca/canvas-contextual.json":[1255,157],"./qps-plocm/canvas-contextual.json":[1256,158],"./quz-PE/canvas-contextual.json":[1257,160],"./ro-RO/canvas-contextual.json":[1258,162],"./ru-RU/canvas-contextual.json":[1259,164],"./sd-Arab-PK/canvas-contextual.json":[1260,165],"./si-LK/canvas-contextual.json":[1261,166],"./sk-SK/canvas-contextual.json":[1262,168],"./sl-SI/canvas-contextual.json":[1263,170],"./sq-AL/canvas-contextual.json":[1264,172],"./sr-Cyrl-BA/canvas-contextual.json":[1265,174],"./sr-Cyrl-RS/canvas-contextual.json":[1266,176],"./sr-Latn-RS/canvas-contextual.json":[1267,178],"./sv-SE/canvas-contextual.json":[1268,180],"./sw-KE/canvas-contextual.json":[1269,181],"./ta-IN/canvas-contextual.json":[1270,183],"./te-IN/canvas-contextual.json":[1271,185],"./th-TH/canvas-contextual.json":[1272,187],"./tk-TM/canvas-contextual.json":[1273,188],"./tr-TR/canvas-contextual.json":[1274,190],"./tt-RU/canvas-contextual.json":[1275,192],"./ug-CN/canvas-contextual.json":[1276,194],"./uk-UA/canvas-contextual.json":[1277,196],"./ur-PK/canvas-contextual.json":[1278,198],"./uz-Latn-UZ/canvas-contextual.json":[1279,200],"./vi-VN/canvas-contextual.json":[1280,202],"./zh-CN/canvas-contextual.json":[1281,204],"./zh-TW/canvas-contextual.json":[1282,206]};function n(e){if(!o.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return o.e(t[1]).then((function(){return o.t(n,3)}))}n.keys=function(){return Object.keys(i)},n.id=1804,e.exports=n},2696:function(e,t,o){"use strict";var i,n;o.r(t),function(e){e[e.Unknown=0]="Unknown",e[e.Inference=1]="Inference"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.VoiceDictationBadge=1]="VoiceDictationBadge",e[e.VoiceDictationPhrase=2]="VoiceDictationPhrase"}(n||(n={}));var r,s,a,l=o(5),c=o(29),u=o(1313),p=o(2359),d=o(1537),g=o(1077),h=o(1564),m=o(1595),y=o(2393),f=o(138),b=o(613),v=o(97),S=o(1318),x=o(2554);!function(e){e.Location="Location",e.Person="Person",e.SatoriEntity="SatoriEntity",e.Topic="Topic"}(r||(r={})),function(e){e[e.Retry=0]="Retry",e[e.ClearSearch=1]="ClearSearch"}(s||(s={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(a||(a={}));var C=o(4),T=o.n(C),A=o(107),w=o(466),O=o(366),k=function(){return(k=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},I={background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},text:{resting:"#201F1E",disabled:"#707070"},altText:{resting:"#605E5C"},action:"#0078D4",highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},focusRing:"#323130"},_={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:24,itemHeight:40,menuHeight:252},D={flexibleSize:!0,borderRadius:4,height:40},E={width:24,height:24,minWidth:24};function M(e,t){var o=k(k({},e.background),{disabled:void 0}),i=void 0;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,title:e.text,subtitle:e.altText,focusRing:"transparent",border:i}}function j(e,t,o){var i,n;return{fontWeight:w.a.SemiBold,fontFamily:O.a,fontSize:o.xsmall,marginVertical:null!==(i=t.headerMarginVertical)&&void 0!==i?i:4,paddingHorizontal:8,cssColor:e.text.resting,lineHeight:null!==(n=t.headerLineHeight)&&void 0!==n?n:20}}function R(e,t,o){var i,n,r;return{fontWeight:w.a.Normal,fontFamily:O.a,fontSize:o.xsmall,marginTop:0,marginBottom:null!==(i=t.headerMarginVertical)&&void 0!==i?i:4,paddingHorizontal:8,cssColor:null!==(r=null===(n=e.altText)||void 0===n?void 0:n.resting)&&void 0!==r?r:"#605e5c"}}function B(e,t){return{fontWeight:w.a.Normal,fontFamily:O.a,fontSize:t.small,cssColor:e.text.disabled}}function L(e,t){return{fontSize:t.small,fontFamily:O.a,cssColor:e.action}}function P(e,t){var o=void 0;return t&&e.highlighting&&(o=e.action),{background:{resting:"transparent"},title:{resting:e.action},focusRing:e.action,border:o}}function F(e,t){var o={backgroundColor:e.background.resting};return t&&(o.borderColor="#E1DFDD",o.borderWidth={bottom:1},o.borderStyle="solid"),o}function N(e){var t;return{focusRing:null!==(t=e.focusRing)&&void 0!==t?t:"#323130"}}var H=o(2613),z=o(2614);var U=o(139);Object(U.a)([{rawString:".customScrollBar_28a06a37{scrollbar-width:none}.customScrollBar_28a06a37::-webkit-scrollbar{display:none}.customScrollBar_28a06a37 .scrollbarContainer_28a06a37{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:6px;top:4px;right:3px;overflow:hidden}.customScrollBar_28a06a37 .scrollbarContainer_28a06a37 .scrollbarThumb_28a06a37{position:absolute;width:3px;border-radius:6px;background:var(--thumb-color);opacity:.7}.customScrollBar_28a06a37 .scrollbarContainer_28a06a37 .scrollbarThumb_28a06a37:hover{width:5px}"}]);var W,q=function(){return(q=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},G=C.memo((function(e){var t,o,i,n,r=C.useState(!1),s=r[0],a=r[1],l=C.useState(20),c=l[0],u=l[1],p=C.useState(0),d=p[0],g=p[1],h=C.useState(0),m=h[0],y=h[1],f=C.useRef({delta:{x:0,y:0},isMovingThumb:!1}),b=C.useRef(null),v=C.useRef(null),S=function(){var t,o;if(b.current){var i=e.style,n=b.current,r=n.clientHeight,s=n.scrollHeight;return{clientHeight:r,contentHeight:s,viewableRatio:(r-(null!==(t=null==i?void 0:i.paddingTop)&&void 0!==t?t:0)-(null!==(o=null==i?void 0:i.paddingBottom)&&void 0!==o?o:0))/s}}return{clientHeight:0,contentHeight:0,viewableRatio:0}},x=(t=function(){if(b.current){var e=f.current.delta.y;f.current.delta={x:0,y:0};var t=S(),o=t.clientHeight,i=t.contentHeight;b.current.scroll({top:b.current.scrollTop+e/o*i})}},o=100,i=!1,function(){i||(t(),i=!0,setTimeout((function(){i=!1}),o))}),T={scrollableContainer:{scroll:function(){if(b.current){var e=S().viewableRatio;g(Math.max(e*b.current.scrollTop,0))}},mouseMove:function(e){f.current.isMovingThumb&&(e.movementX||e.movementY)&&(f.current.delta.x+=e.movementX,f.current.delta.y+=e.movementY,x())},mouseUp:function(){f.current.isMovingThumb=!1,f.current.delta={x:0,y:0}}},scrollbarContainer:{mouseDown:function(e){if(b.current&&v.current){var t=S(),o=t.clientHeight,i=t.contentHeight,n=e.clientY-v.current.getBoundingClientRect().top;b.current.scroll({top:n/o*i})}}},scrollbarThumb:{mouseDown:function(e){e.stopPropagation(),f.current.isMovingThumb=!0}}},A=e.scrollTo;switch(C.useEffect((function(){if(b.current){var t=b.current,o=t.clientHeight,i=t.scrollHeight>o;if(i!==s){var n=e.onScrollStatusChange;n&&n(i),a(i)}}})),C.useEffect((function(){return function(){if(b.current&&e.scrollTo){var t=e.scrollTo,o=t.top,i=t.bottom,n=Math.max(o-6,0);i<=b.current.scrollTop+b.current.offsetHeight&&n>=b.current.scrollTop||b.current.scroll({top:n,behavior:"smooth"})}}()}),[null==A?void 0:A.top,null==A?void 0:A.bottom]),C.useEffect((function(){return function(){if(b.current){var e=S(),t=e.clientHeight,o=e.viewableRatio;u(Math.round(o*t)),y(t)}}()})),e.scrollDirection){case"horizontal":n={overflowY:"hidden",overflowX:"auto",display:"flex",flexDirection:"row"};break;case"both":n={overflowY:"auto",overflowX:"auto",display:"block",flexDirection:"row"};break;case"vertical":default:n={overflowY:"auto",overflowX:"hidden",display:"block",flexDirection:"column"}}var w=s&&"horizontal"!==e.scrollDirection?C.createElement("div",{style:{height:m,opacity:e.hidden?0:1},className:"scrollbarContainer_28a06a37",ref:v,onMouseDown:T.scrollbarContainer.mouseDown},C.createElement("div",{style:{height:c,top:d},className:"scrollbarThumb_28a06a37",onMouseDown:T.scrollbarThumb.mouseDown})):void 0;return C.createElement("div",{style:function(t){var o,i=q({},t),n=e.style,r=e.theme;return n&&(n.paddingHorizontal&&(i.paddingRight=n.paddingHorizontal,i.paddingLeft=n.paddingHorizontal),n.paddingTop&&(i.paddingTop=n.paddingTop),n.paddingBottom&&(i.paddingBottom=n.paddingBottom),n.borderRadius&&(i.borderRadius=n.borderRadius)),r&&r.thumbColor&&(i=q(q({},i),((o={})["--thumb-color"]=r.thumbColor,o))),i}(n),className:"customScrollBar_28a06a37",ref:b,onScroll:T.scrollableContainer.scroll,onMouseMove:T.scrollableContainer.mouseMove,onMouseUp:T.scrollableContainer.mouseUp},e.children,w)}));!function(e){e[e.Default=0]="Default",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal"}(W||(W={}));var Z,V,Q=o(1592),Y=o(603),X=(Z=function(e,t){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}Z(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusZoneRef=C.createRef(),t}return X(t,e),t.prototype.render=function(){return C.createElement(Q.a,{direction:this.getDirection(),componentRef:this.focusZoneRef},this.props.children)},t.prototype.focus=function(){this.focusZoneRef.current&&this.focusZoneRef.current.focus()},t.prototype.getDirection=function(){switch(this.props.direction){case W.Horizontal:return Y.a.horizontal;case W.Vertical:return Y.a.vertical;default:return Y.a.bidirectional}},t}(C.PureComponent),K=o(2111),$=o(1801),ee=function(){return(ee=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},te=function(e){return"option"+e},oe=function(e){return e&&"actions"in e?e.actions:[]},ie=function(e){var t;if(e)return ee(ee({},e),{background:null!==(t=e.footerButtonBackground)&&void 0!==t?t:e.background,header:"",subheader:"",dialogText:"",iconText:"",contextText:"",errorText:"",border:"",separator:"",focusRing:"",link:"",linkPressed:""})},ne=o(470),re=o(2618),se=o(2787),ae=o(2722),le=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return le(t,e),t.prototype.render=function(){return C.createElement("tr",null,this.props.children)},t}(C.PureComponent),ue=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ue(t,e),t.prototype.render=function(){return this.props.header?C.createElement("th",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children):C.createElement("td",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)},t.prototype.getTableCellStyle=function(){var e={};return this.props.style&&this.props.style.paddingVertical&&(e.paddingBottom=this.props.style.paddingVertical,e.paddingTop=this.props.style.paddingVertical),this.props.style&&this.props.style.paddingHorizontal&&(e.paddingLeft=this.props.style.paddingHorizontal,e.paddingRight=this.props.style.paddingHorizontal),this.props.style&&this.props.style.paddingStart&&(e.paddingInlineStart=this.props.style.paddingStart),this.props.style&&this.props.style.paddingEnd&&(e.paddingInlineEnd=this.props.style.paddingEnd),this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),this.props.style&&this.props.style.marginHorizontal&&(e.marginLeft=this.props.style.marginHorizontal,e.marginRight=this.props.style.marginHorizontal),this.props.style&&this.props.style.verticalAlign&&(e.verticalAlign=this.props.style.verticalAlign),this.props.style&&this.props.style.horizontalAlign&&(e.textAlign=this.props.style.horizontalAlign),e},t}(C.PureComponent),de=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return de(t,e),t.prototype.render=function(){return C.createElement("table",{style:this.getTableStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)},t.prototype.getTableStyle=function(){var e={borderCollapse:"collapse"};return this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),e},t}(C.PureComponent),he=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),me=function(){return(me=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!function(e){e[e.Exposition=0]="Exposition",e[e.Example=1]="Example"}(V||(V={}));var ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return he(t,e),t.prototype.render=function(){var e=this.parseExplanationText(this.getExplanationText()),t=this.getDefinition(),o=t&&t.explanationTitle||"";return C.createElement(re.a,{componentStackStyle:A.N(this.props.style,this.props.theme),stackAlignment:z.b.Stretch,stackDirection:z.c.TopToBottom,header:o,headerStyle:A.P(this.props.theme,this.props.fontTable),focusable:!0},this.renderExplanationText(e),this.renderAccessibleColorsLearningTip())},t.prototype.renderAccessibleColorsLearningTip=function(){if(this.props.definition.critiqueType!==$.c.AccColorChecker)return null;var e={height:16,width:16},t={type:"ErrorBadge",primaryColor:"#E41323",style:e},o={type:"Completed",primaryColor:"#0B6A0B",style:e},i={backgroundColor:"#CCCCCC",borderRadius:2,height:24,marginVertical:4,marginStart:10,paddingHorizontal:15},n={width:"50%"};return C.createElement(H.a,null,C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(H.a,{style:n},C.createElement(se.a,{text:this.props.strings.critiqueExplanation("explanationTableBefore"),style:A.Q(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})),C.createElement(H.a,{style:n},C.createElement(se.a,{text:this.props.strings.critiqueExplanation("explanationTableAfter"),style:A.Q(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(H.a,{style:n},C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center,style:{height:32}},C.createElement(ae.a,me({},t))),C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center,style:i},C.createElement(se.a,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#BECFFA",fontSize:this.props.fontTable.xsmall,fontWeight:w.a.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(H.a,{style:{width:26}}),C.createElement(se.a,{text:this.props.strings.critiqueExplanation("poorContrast"),style:A.O(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(H.a,{style:n},C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center,style:{height:32}},C.createElement(ae.a,me({},o))),C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center,style:i},C.createElement(se.a,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#002EA3",fontSize:this.props.fontTable.xsmall,fontWeight:w.a.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(H.a,{style:{width:26}}),C.createElement(se.a,{text:this.props.strings.critiqueExplanation("goodContrast"),style:A.O(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))))},t.prototype.getDefinition=function(){return this.props.definition},t.prototype.getExplanationText=function(){var e=this.getDefinition();return e&&e.explanation?e.explanation.replace("\\r\\n","\r\n"):""},t.prototype.parseExplanationText=function(e){for(var t=[],o=[],i=null,n=!0,r=!1,s=0,a=0,l=0,c=this.props.strings.critiqueExplanation("explanationTableBefore"),u=this.props.strings.critiqueExplanation("explanationTableAfter"),p=0,d=e.split("\r\n");p<d.length;p++){var g=d[p];if(0!==g.length)if("•"===g[0]){var h=g.indexOf(":"),m=g.substr(2,h-1),y=g.substr(h+2);n?(c=m,i=this.renderBeforeText(y,a++),n=!1,r=!0):r?(u=m,o.push(C.createElement(ce,{key:s++},this.renderTableHeaderText(c,a++,0===o.length,!0),this.renderTableHeaderText(u,l++,0===o.length,!1))),o.push(C.createElement(ce,{key:s++},i,this.renderAfterText(y,l++))),i=null,r=!1):(o.push(C.createElement(ce,{key:s++},this.renderPlaceholder(a++),this.renderExampleSeparator(l++))),o.push(C.createElement(ce,{key:s++},this.renderPlaceholder(a++),this.renderAfterText(y,l++))))}else o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t.push(this.renderExplanationNonExampleText(g));else i=null,n=!0,r=!1}return o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t},t.prototype.analyzeExampleText=function(e){var t={trimmedText:e,emphasisStart:-1,emphasisLength:-1},o=e.indexOf("{ul}");if(-1!==o){var i=e.indexOf("{ul 0}",o);if(-1!==i){var n=o+"{ul}".length,r=i-n;t.trimmedText=e.substr(0,o)+e.substr(n,r)+e.substr(i+"{ul 0}".length),t.emphasisStart=o,t.emphasisLength=r}}return t},t.prototype.renderTableHeaderText=function(e,t,o,i){var n=i?A.J():A.I();return o?C.createElement(pe,{header:!0,key:t,style:n},C.createElement(se.a,{text:e,style:A.Q(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})):C.createElement(pe,{key:t,style:n}," ")},t.prototype.renderCurrentTable=function(e){return{explanationPartType:V.Example,data:e}},t.prototype.getDecorationType=function(e){switch(e){case $.c.Grammar:return $.d.Grammar;case $.c.Refinement:return $.d.Refinement;default:return $.d.None}},t.prototype.renderBeforeText=function(e,t){return this.renderExampleText(e,t,this.getDecorationType(this.getDefinition().critiqueType),this.props.strings.critiqueExplanation("explanationTableBefore"),!0)},t.prototype.renderAfterText=function(e,t){return this.renderExampleText(e,t,$.d.Modification,this.props.strings.critiqueExplanation("explanationTableAfter"),!1)},t.prototype.renderExampleText=function(e,t,o,i,n){var r=[],s=this.analyzeExampleText(e);-1!==s.emphasisStart&&-1!==s.emphasisLength&&r.push({start:s.emphasisStart,length:s.emphasisLength,decorationType:o});var a=i+" "+Object(ne.a)(this.props.strings.textFormatting,this.getDefinition().critiqueType,s.trimmedText,r),l=n?A.J():A.I();return C.createElement(pe,{key:t,style:l},C.createElement(se.a,{text:s.trimmedText,style:A.O(this.props.theme,this.props.fontTable),formatting:Object(ne.b)(e.length,this.props.theme,r),accessibilityRole:"text",accessibilityLabel:a}))},t.prototype.renderExampleSeparator=function(e){return C.createElement(pe,{key:e,style:A.I()},C.createElement(se.a,{text:this.props.strings.critiqueExplanation("explanationTableSeparator"),style:A.R(this.props.theme,this.props.fontTable),accessibilityRole:"text"}))},t.prototype.renderPlaceholder=function(e){return C.createElement(pe,{key:e,style:A.J()})},t.prototype.renderExplanationNonExampleText=function(e){return{explanationPartType:V.Exposition,data:[C.createElement(se.a,{key:0,text:e,style:A.S(this.props.theme,this.props.fontTable),accessibilityRole:"text"})]}},t.prototype.renderExplanationText=function(e){for(var t=[],o=0,i=e;o<i.length;o++){var n=i[o];switch(n.explanationPartType){case V.Exposition:n.data[0]&&t.push(n.data[0]);break;case V.Example:t.push(C.createElement(ge,{style:A.K(),accessibilityLabel:this.props.strings.critiqueExplanation("explanationTableAccessibilityLabel")},n.data))}}return t},t}(C.PureComponent),fe=o(468),be=o(2741),ve=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Se=function(){return(Se=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t.prototype.getAccessibilityLabel=function(){return this.props.accessibilityLabel||this.props.title||this.props.strings&&this.props.strings.defaultOverflowButtonAccessibilityLabel},t.prototype.renderButton=function(e,t,o,i,n){var r,s,a,l,c;return C.createElement(be.a,{ref:n,key:t,title:this.props.title,icon:{type:null!==(s=null===(r=this.props.icon)||void 0===r?void 0:r.type)&&void 0!==s?s:"Overflow",filled:(null===(a=this.props.icon)||void 0===a?void 0:a.filled)||o},tooltip:null!==(l=this.props.tooltip)&&void 0!==l?l:null===(c=this.props.strings)||void 0===c?void 0:c.defaultOverflowButtonAccessibilityLabel,disabled:this.props.disabled,hidden:this.props.hidden,refusesKeyboardFocus:this.props.refusesKeyboardFocus,style:this.getStyle(),theme:this.getCompositeButtonTheme(),strings:this.props.strings,onClick:e,onHoverIn:this.props.onHoverIn,onHoverOut:this.props.onHoverOut,onFocus:this.props.onFocus,onBlur:this.props.onBlur,accessibilityLabel:this.getAccessibilityLabel(),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:o,onAccessibilityExpandCollapse:i,automationLabel:"".concat(this.props.automationLabelType,"_").concat(this.props.title||"OverFlow","_").concat(this.props.automationId)})},t.prototype.getCompositeButtonTheme=function(){return this.props.theme?this.props.theme:fe.a.defaultTheme},t.prototype.getStyle=function(){var e=this.props.style;return e&&void 0!==e.paddingHorizontal?e:Se(Se({},e),{paddingHorizontal:8})},t}(C.PureComponent),Ce=o(2617),Te=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Ae=function(){return(Ae=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},we=function(e){function t(t){var o=e.call(this,t)||this;return o.state={menuOpen:!1},o.buttonRef=C.createRef(),o.onMenuDismiss=o.onMenuDismiss.bind(o),o.onButtonClick=o.onButtonClick.bind(o),o.onItemClick=o.onItemClick.bind(o),o.onAccessibilityExpandCollapse=o.onAccessibilityExpandCollapse.bind(o),o}return Te(t,e),t.prototype.openMenu=function(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.handleMenuOpen())},t.prototype.focus=function(){this.buttonRef.current&&!this.buttonRef.current.props.refusesKeyboardFocus&&this.buttonRef.current.focus()},t.prototype.performAccessibilityExpandCollapse=function(e){this.onAccessibilityExpandCollapse(e)},t.prototype.renderAnchorButtonAndMaybeCallout=function(){var e=this.renderButton(this.onButtonClick,"button",this.state.menuOpen,this.onAccessibilityExpandCollapse,this.buttonRef),t=this.state.menuOpen?this.renderCallout("callout",this.onMenuDismiss,this.buttonRef):void 0;return t?[e,t]:[e]},t.prototype.renderCalloutItems=function(){var e=this,t=this.props.items;if(!t)return[];var o=t.filter((function(e){return"item"===e.type})),i=o.some((function(t){var o=t,i=e.buildIconProps(o);return!!i&&ae.a.shouldRender(i)})),n=1;return t.map((function(t){switch(t.type){case"item":return e.buildItem(t,n++,o.length,i);case"separator":return C.createElement(Ce.a,{key:t.key,color:e.props.theme&&e.props.theme.separator});default:return null}}))},t.prototype.getCompositeButtonTheme=function(){var t=Ae({},e.prototype.getCompositeButtonTheme.call(this));return this.state.menuOpen&&(t.background.hover&&(t.background=Ae(Ae({},t.background),{resting:t.background.hover})),t.title.hover&&(t.title=Ae(Ae({},t.title),{resting:t.title.hover})),t.subtitle&&t.subtitle.hover&&(t.subtitle=Ae(Ae({},t.subtitle),{resting:t.subtitle.hover})),t.icon&&t.icon.hover&&(t.icon=Ae(Ae({},t.icon),{resting:t.icon.hover}))),t},t.prototype.handleMenuOpen=function(){this.props.onMenuOpen&&this.props.onMenuOpen()},t.prototype.handleMenuDismiss=function(){this.props.onMenuDismiss&&this.props.onMenuDismiss(),this.shouldFocusButtonOnDismiss()&&this.focus()},t.prototype.onMenuDismiss=function(){this.handleMenuDismiss(),this.setState({menuOpen:!1})},t.prototype.onButtonClick=function(){var e=this;this.setState((function(t){var o={menuOpen:!t.menuOpen};return o.menuOpen?e.handleMenuOpen():e.handleMenuDismiss(),o}))},t.prototype.onItemClick=function(e){this.props.onClick&&this.props.onClick(e),this.onMenuDismiss()},t.prototype.onAccessibilityExpandCollapse=function(e){"expand"===e&&this.state.menuOpen||"collapse"===e&&!this.state.menuOpen||this.onButtonClick()},t.prototype.buildIconProps=function(e){return void 0!==e.iconType?{type:e.iconType,filled:!0}:void 0},t.prototype.buildItem=function(e,t,o,i){var n=this,r=this.buildIconProps(e),s=this.props.itemTheme;return C.createElement(be.a,{key:e.key,title:e.title,titleStyle:e.titleStyle,onClick:function(){return n.onItemClick(e)},disabled:e.disabled,theme:s,accessibilityRole:"menuitem",automationLabel:"".concat(this.props.automationLabelType,"_").concat(e.title,"_").concat(this.props.automationId),icon:r,style:this.computeItemStyle(i,void 0!==e.iconType),accessibilityPositionInSet:t,accessibilitySetSize:o})},t.prototype.computeItemStyle=function(e,t){var o,i={paddingHorizontal:8,flexibleSize:!0};return!e||t||(i.paddingStart=8+Object(ae.b)(null===(o=this.props.icon)||void 0===o?void 0:o.fontSize)),i},t}(xe),Oe=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),ke=function(){return(ke=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Ie=function(e){function t(o){var i=e.call(this,o)||this;return i.buttonId="OverflowMenu"+t.ids,t.ids+=1,i}return Oe(t,e),t.prototype.render=function(){return C.createElement("div",{id:this.buttonId,style:{display:"flex"}},this.renderAnchorButtonAndMaybeCallout())},t.prototype.shouldFocusButtonOnDismiss=function(){return!0},t.prototype.renderCallout=function(e,t,o){var i={role:"menu",target:"#"+this.buttonId,isBeakVisible:!1,onDismiss:t,setInitialFocus:!0},n={isCircularNavigation:!0,handleTabKey:Y.b.all};return C.createElement(b.a,ke({key:e},i),C.createElement(Q.a,ke({},n),C.createElement(H.a,{align:z.b.Stretch},this.renderCalloutItems())))},t.ids=0,t}(we),_e=o(1315);function De(e){if(e)return{paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingHorizontal:e.paddingHorizontal}}var Ee=function(e){if(e.styles&&e.styles.widths&&e.shimmerCount!==e.styles.widths.length)return null;for(var t,o=[],i=0;i<e.shimmerCount;i+=1)o.push(C.createElement(_e.a,{styles:(t=e.styles&&e.styles.widths?e.styles.widths[i]:void 0,{root:{paddingBottom:5,width:t}})}));return C.createElement(H.a,{style:De(e.styles),direction:z.c.TopToBottom,align:z.b.Stretch},o)},Me=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),je=function(){return(je=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Re=function(e){function t(o){var i=e.call(this,o)||this;return i.shouldFocusButtonOnUpdate=!1,i.buttonRef=C.createRef(),i.buttonId="FlyoutAnchor"+t.ids,t.ids+=1,i.handleClick=i.handleClick.bind(i),i.closeCallout=i.closeCallout.bind(i),i.onAccessibilityExpandCollapse=i.onAccessibilityExpandCollapse.bind(i),i.state={calloutVisible:!1},i}return Me(t,e),t.prototype.render=function(){var e=this.renderButton();if(this.state.calloutVisible){var t={role:"document",target:"#"+this.buttonId,isBeakVisible:!1,ariaLabel:this.props.calloutAccessibilityLabel,setInitialFocus:!0,onDismiss:this.closeCallout},o=C.createElement(b.a,je({},t),this.props.children);return C.createElement("div",{id:this.buttonId,style:{display:"flex"}},e,o)}return e},t.prototype.componentDidUpdate=function(){var e;this.shouldFocusButtonOnUpdate&&(null===(e=this.buttonRef.current)||void 0===e||e.focus(),this.shouldFocusButtonOnUpdate=!1)},t.prototype.renderButton=function(){var e=je(je({},this.props.buttonProps),{onClick:this.handleClick,accessibilityState:this.state.calloutVisible,accessibilityRole:"overflow"});return this.state.calloutVisible&&e.theme&&e.theme.background.hover&&(e.theme=je(je({},e.theme),{background:je(je({},e.theme.background),{resting:e.theme.background.hover})})),C.createElement(be.a,je({},e,{onAccessibilityExpandCollapse:this.onAccessibilityExpandCollapse,ref:this.buttonRef}))},t.prototype.handleClick=function(){this.props.buttonProps.onClick&&this.props.buttonProps.onClick(),this.setState((function(e){return{calloutVisible:!e.calloutVisible}}))},t.prototype.closeCallout=function(){this.shouldFocusButtonOnUpdate=!0,this.setState((function(e){return{calloutVisible:!1}}))},t.prototype.onAccessibilityExpandCollapse=function(e){"expand"===e&&this.state.calloutVisible||"collapse"===e&&!this.state.calloutVisible||this.handleClick()},t.ids=0,t}(C.PureComponent),Be=o(1800),Le=function(){return(Le=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Pe={type:"Text",textColor:"#616161"},Fe={type:"Icon",iconColor:"#616161"},Ne={type:"IconButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#616161",disabled:"#BDBDBD"},focusRing:"#323130"},He={type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"};function ze(e){return("Icon"===(null==e?void 0:e.type)?e:Fe).iconColor}var Ue=function(){return(Ue=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function We(e){return{defaultOverflowButtonAccessibilityLabel:e("defaultOverflowButtonAccessibilityLabel"),oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function qe(e,t,o,i,n,r,s,a,l,c){var u=Ve(e),p=void 0!==a;if(void 0===a||!(a<0||a>=u.length)){var d=p?u[a]:void 0,g=n.filter((function(t){return $e(e,t,d)})).filter((function(t){return Je(e,o,t)})).map((function(t){return nt(e,o,i,t)}));if(!p&&$e(e,$.a.ShowMenu)&&(g.length>0&&g.push({type:"separator",key:"separator"}),g.push(nt(e,o,i,$.a.ShowMenu))),0!==g.length)return{tooltip:p||r?void 0:s,items:g,onClick:function(e){if(c){var t=parseInt(e.key,10);c(t,a)}},style:p?{}:A.C,theme:A.ib(t),itemTheme:A.G(t,void 0,!0),strings:We(o.common),accessibilityLabel:s,automationLabelType:"CritiqueActionButton",automationId:l||""}}}function Ge(e,t,o,i,n,r,s,a,l,c,u,p,d,g,h,m,y,f,b){var v=Ke(o),S=void 0!==v?{type:v,filled:h}:void 0,x={onClick:function(){null==g||g(o,void 0,r)},title:s,titleStyle:a,tooltip:l,disabled:et(e,o),style:i,theme:A.G(t,void 0,h,y),accessibilityLabel:Xe(e,n,o),automationLabel:null!=c?c:it(o,d),badgeProps:p,icon:S,htmlId:m,onPositionChange:b,uiAnchorId:f};return C.createElement(be.a,Ue({ref:u},x,{key:o.toString()}))}function Ze(e,t,o,i,n,r,s){if(e.showDictationCommandUx&&!i){var a=function(e,t,o,i){var n=Qe(e,t).filter((function(e){return e.action===o&&e.suggestionIndex===i}));return n.length>0?n[0].badgeId:void 0}(e,t,n,r);if(void 0!==a)return{text:a.toString(),theme:o,style:s}}}function Ve(e){var t=e.maximumSuggestions||A.Gb;return e.suggestions?e.suggestions.length>t?e.suggestions.slice(0,t):e.suggestions:[]}function Qe(e,t){var o,i=Ye(e,t),n=[],r=1;return i?i.forEach((function(e,t){n.push({action:e,badgeId:r++,suggestionIndex:t})})):null===(o=Ve(e))||void 0===o||o.forEach((function(t,o){et(e,$.a.Accept,t)||n.push({action:$.a.Accept,badgeId:r++,suggestionIndex:o})})),n}function Ye(e,t){switch(e.critiqueType){case $.c.RepeatedWord:return[$.a.Accept];case $.c.SimilarityChecker:return($e(e,$.a.MoreSources)?[$.a.IntextCitation,$.a.FullCitation,$.a.MoreSources]:[$.a.IntextCitation,$.a.FullCitation]).filter((function(o){return Je(e,t,o)}))}return e.isContentPending||e.isBehindPaywall?[]:void 0}function Xe(e,t,o){switch(o){case $.a.Previous:case $.a.Next:if(e.wrapAroundNavigation&&void 0!==e.critiqueSetSize&&e.critiqueSetSize>1){var i=e.critiqueSetSize.toString(10);return o===$.a.Previous?t.critique("previousIssueWithCount").replace("{0}",i):t.critique("nextIssueWithCount").replace("{0}",i)}return o===$.a.Previous?t.critique("previousIssue"):t.critique("nextIssue")}return Je(e,t,o)}function Je(e,t,o){switch(o){case $.a.ReadAloud:return t.critique("readAloud");case $.a.SpellOut:return t.critique("spellOut");case $.a.ChangeAll:return t.critique("changeAll");case $.a.AddToAutoCorrect:return t.critique("addToAutoCorrect");case $.a.AutoCorrectOptions:return t.critique("autoCorrectOptions");case $.a.IgnoreOnce:return t.critique("ignoreOnce");case $.a.IgnoreAll:return t.critique("ignoreAll");case $.a.IgnoreRule:return t.critique("ignoreRule");case $.a.AddToDictionary:return t.critique("addToDictionary");case $.a.Options:return t.critique("options");case $.a.ShowExplanation:return t.critique("footerExplanationButtonAccessibilityLabel");case $.a.Next:return t.critique("nextIssue");case $.a.Previous:return t.critique("previousIssue");case $.a.ToggleContext:return e.showContext?t.critique("hideContext"):t.critique("showContext");case $.a.ToggleDescription:return e.critiqueType===$.c.Spelling?e.showDescription?t.critique("hideSynonyms"):t.critique("showSynonyms"):e.critiqueType===$.c.NeuralRewrite?e.showDescription?t.critique("hideExplanationButtonText"):t.critique("showExplanationButtonText"):void 0;case $.a.ReadContext:return t.critique("readAloudOriginalSentenceAccessibilityLabel");case $.a.ShowMenu:return t.critique("showMenuButtonText");case $.a.Feedback:return t.critique("giveFeedbackButtonText");case $.a.Dismiss:return t.common("cancelButton");case $.a.OpenEditorPane:return t.critique("accessibilityLabelForEditorButton");case $.a.LearnMore:return t.critique("learnMore");case $.a.IntextCitation:return t.critique("addInTextCitation");case $.a.FullCitation:return t.critique("copyFullCitation");case $.a.MoreSources:return t.critique("moreSources");case $.a.Accessibility:return t.critique("accAssistant");case $.a.OpenColorPicker:return t.critique("moreColors");case $.a.TurnOffAccChecker:return t.critique("turnOffAccChecker");case $.a.Allow:return t.critique("allowAccIssue");case $.a.AllowAll:return t.critique("allowAllAccIssues");case $.a.Accept:case $.a.AddOnFooterAction:case $.a.Report:case $.a.RejectHoverIn:case $.a.RejectHoverOut:case $.a.AcceptHoverIn:case $.a.AcceptHoverOut:case $.a.Reject:case $.a.OpenCustomDictionary:case $.a.SourceSelected:case $.a.ApplyColor:case $.a.GoPremium:case $.a.RevealSuggestions:case $.a.RefreshSummary:case $.a.UndoInsertSummarization:return}}function Ke(e){switch(e){case $.a.Allow:return"Ignore";case $.a.AllowAll:return"IgnoreAll";case $.a.IgnoreOnce:return"Ignore";case $.a.IgnoreAll:return"IgnoreAll";case $.a.AddToDictionary:return"AddToDictionary";case $.a.ShowExplanation:return"ShowExplanation";case $.a.Next:return"Next";case $.a.Previous:return"Previous";case $.a.ReadContext:return"ReadAloud";case $.a.Feedback:return"GiveFeedback";case $.a.Dismiss:return"Cancel";case $.a.OpenEditorPane:return"Editor";case $.a.Options:return"EditorSettings";case $.a.IntextCitation:return"Plus";case $.a.FullCitation:return"Copy";case $.a.Accessibility:return"Accessibility";case $.a.OpenColorPicker:return"Color";case $.a.TurnOffAccChecker:return"Hide";case $.a.RevealSuggestions:return"Wand"}}function $e(e,t,o){switch(t){case $.a.Previous:case $.a.Next:return tt(e)&&ot(e,t);case $.a.ToggleContext:if(void 0===e.contextText)return!1;break;case $.a.ReadContext:var i=Ke(t);if(void 0===i||!ae.a.shouldRender({type:i}))return!1;break;case $.a.IgnoreOnce:if(e.critiqueType===$.c.SimilarityChecker)return!0;break;case $.a.Accessibility:case $.a.OpenColorPicker:case $.a.Allow:case $.a.AllowAll:return!0;case $.a.Feedback:case $.a.TurnOffAccChecker:if(e.critiqueType===$.c.AccColorChecker)return!0}return ot(e,t,o)}function et(e,t,o){switch(t){case $.a.Next:case $.a.Previous:return!tt(e)||!ot(e,t)||!e.wrapAroundNavigation&&(t===$.a.Previous?e.critiquePosition<=0:e.critiquePosition>=e.critiqueSetSize-1);case $.a.Dismiss:case $.a.Accessibility:case $.a.OpenColorPicker:case $.a.Allow:case $.a.AllowAll:return!1;default:return!ot(e,t,o)}}function tt(e){return void 0!==e.critiquePosition&&void 0!==e.critiqueSetSize&&e.critiquePosition>=0&&e.critiqueSetSize>0}function ot(e,t,o){var i=e.actions,n=o?o.actions:i;return!!n&&n.indexOf(t)>=0}function it(e,t){switch(e){case $.a.Previous:return"CritiqueNavButton_Left_".concat(t);case $.a.Next:return"CritiqueNavButton_Right_".concat(t);case $.a.Dismiss:return"CritiqueCloseButton_".concat(t);case $.a.OpenEditorPane:return"EditorPaneOpenButton_".concat(t)}return"undefined"}function nt(e,t,o,i){var n=Je(e,t,i);return{type:"item",key:i.toString(),title:n,titleStyle:A.hb(o,n.length),iconType:Ke(i)}}var rt,st=function(){return(st=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},at=function(e){var t=e.brandingMode,o=e.theme;switch(t){case $.b.Text:var i=e.strings,n=e.fontTable,r=i.critique("microsoftEditorBranding"),s=function(e,t){var o="Text"===(null==e?void 0:e.type)?e:Pe;return{fontWeight:w.a.SemiBold,fontSize:t.xsmall,cssColor:o.textColor}}(o,n),a=i.critique("microsoftEditorBrandingAccessibilityLabel"),l=C.createElement(se.a,{text:r,accessibilityLabel:a,style:s});return lt(l);case $.b.Icon:return lt(C.createElement(ae.a,{type:"Editor",primaryColor:ze(o)}));case $.b.MonochromeIcon:return lt(C.createElement(ae.a,{type:"EditorSingleColor",primaryColor:ze(o)}));case $.b.IconButton:return ct(e);case $.b.IconAndTextButton:return ut(e);default:return C.createElement(C.Fragment,null)}},lt=function(e){return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center,style:{paddingHorizontal:6,paddingVertical:6}},e)},ct=function(e){var t=e.definition,o=e.strings,i=e.theme,n=e.automationId,r=e.onAction,s=e.fontTable,a=e.htmlId,l=e.appearFocused,c=e.isDisabled,u=e.onPositionChange,p=e.showPreviewTooltipForBranding,d=function(e,t){var o,i="IconButton"===(null==e?void 0:e.type)?e:Ne;return Le(Le({},i),{background:Le(Le({},i.background),{resting:t&&null!==(o=i.background.hover)&&void 0!==o?o:i.background.resting}),title:Le({},i.icon),border:t?i.focusRing:void 0})}(i,l),g=function(e){return{textAlign:Be.a.Center,borderRadius:4,iconFontSize:e.xsmall}}(s),h=p?o.critique("editorButtonCiqPreviewTooltipContent"):o.critique("editorButtonTooltipContent");return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Stretch},pt(t,d,g,o,void 0,void 0,h,n,r,a,c,u))},ut=function(e){var t,o=e.definition,i=e.strings,n=e.theme,r=e.automationId,s=e.onAction,a=e.fontTable,l=e.htmlId,c=e.appearFocused,u=e.isDisabled,p=e.onPositionChange,d=e.showPreviewTooltipForBranding,g=function(e,t){var o,i="IconAndTextButton"===(null==e?void 0:e.type)?e:He;return Le(Le({},i),{background:Le(Le({},i.background),{resting:t&&null!==(o=i.background.hover)&&void 0!==o?o:i.background.resting}),border:t?i.focusRing:void 0})}(n,c),h=function(e){return{textAlign:Be.a.Center,borderRadius:2,iconFontSize:e.xlarge,paddingHorizontal:7,paddingBottom:0,textHorizontalPadding:0,iconTextSpacing:3}}(a),m=i.critique("editorButtonText"),y=(t=a,{fontWeight:w.a.SemiBold,fontFamily:O.a,fontSize:t.small}),f=d?i.critique("editorButtonCiqPreviewTooltipContent"):i.critique("editorButtonTooltipContent");return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Stretch},pt(o,g,h,i,m,y,f,r,s,l,u,p))},pt=function(e,t,o,i,n,r,s,a,l,c,u,p){var d=Ke($.a.OpenEditorPane),g=void 0!==d?{type:d}:void 0,h={onClick:function(){null==l||l($.a.OpenEditorPane,void 0,void 0)},title:n,titleRootStyle:r,tooltip:s,disabled:u,style:o,theme:t,accessibilityLabel:Xe(e,i,$.a.OpenEditorPane),automationLabel:it($.a.OpenEditorPane,a),icon:g,htmlId:c,onPositionChange:p};return C.createElement(be.a,st({},h,{key:$.a.OpenEditorPane.toString()}))},dt=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),gt=function(){return(gt=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},ht=function(e){function t(t){var o=e.call(this,t)||this;return o.defaultActionButtonRef=C.createRef(),o.overflowMenuRef=C.createRef(),o.isFirstTimeRendering=C.createRef(),o.actionIds=C.createRef(),o.state={actionIdShowAppearFocusMap:{}},o.addActionId=o.addActionId.bind(o),o.isFirstTimeRendering.current=!0,o}return dt(t,e),t.prototype.componentDidMount=function(){var e;this.props.setFooterActionIdList&&this.props.setFooterActionIdList(null!==(e=this.actionIds.current)&&void 0!==e?e:[]),this.isFirstTimeRendering.current=!1},t.prototype.componentDidUpdate=function(e,t){var o=this,i=this.props.selectedButtonIndex,n=e.selectedButtonIndex;i!==n&&(void 0!==n&&-1!==n&&this.setState((function(e){if(null!==o.actionIds.current){var t=o.actionIds.current[n],i=gt({},e.actionIdShowAppearFocusMap);return i[t]=!1,gt(gt({},o.state),{actionIdShowAppearFocusMap:i})}return e})),void 0!==i&&-1!==i&&this.setState((function(e){if(null!==o.actionIds.current){var t=o.actionIds.current[i],n=gt({},e.actionIdShowAppearFocusMap);return n[t]=!0,gt(gt({},o.state),{actionIdShowAppearFocusMap:n})}return e})))},t.prototype.render=function(){return C.createElement(H.a,{direction:z.c.LeftToRight,style:this.getFooterStyle(),align:z.b.Stretch},this.renderIcons(),C.createElement(H.a,{style:{flexibleSize:!0}}),this.props.definition.critiqueType===$.c.AccColorChecker?this.renderFooterButton($.a.Accessibility):null,this.renderBrandingOrPrevNextButton())},t.prototype.focus=function(){this.defaultActionButtonRef.current?this.defaultActionButtonRef.current.focus():this.overflowMenuRef.current&&this.overflowMenuRef.current.focus()},t.prototype.componentWillUnmount=function(){this.props.setFooterActionIdList&&this.props.setFooterActionIdList([]),this.isFirstTimeRendering.current=null},t.prototype.renderIcons=function(){return this.props.definition.onlyShowFeedbackButton?this.renderFeedbackIcon():C.createElement(C.Fragment,null,this.renderDefaultActionButtons(),this.renderExplanation(),this.renderOverflowMenu())},t.prototype.renderFeedbackIcon=function(){var e=this.props,t=e.definition,o=e.strings,i=e.onAction,n=e.automationId,r=e.onPositionChange;return $e(t,$.a.Feedback)?(this.addActionId($.a.Feedback),function(e,t,o,i,n,r,s,a){var l=Je(e,i,$.a.Feedback);if(!l)return null;var c={type:Ke($.a.Feedback),filled:!0},u=A.T(t,s),p={onClick:function(){null==r||r($.a.Feedback,void 0,void 0)},title:l,tooltip:l,disabled:et(e,$.a.Feedback),style:o,theme:u,accessibilityLabel:Xe(e,i,$.a.Feedback),automationLabel:"CritiqueActionButton_".concat(l,"_").concat(n),icon:c,onPositionChange:a};return C.createElement(be.a,Ue({},p,{key:$.a.Feedback.toString()}))}(t,this.getTheme(),A.y,o,n,i,this.state.actionIdShowAppearFocusMap[$.a.Feedback],r)):null},t.prototype.addActionId=function(e){et(this.props.definition,e)||this.isFirstTimeRendering.current&&(null===this.actionIds.current&&(this.actionIds.current=[]),this.actionIds.current.push(e))},t.prototype.parseBooleanSetting=function(e){return!!this.props.settings&&"true"===this.props.settings[e]},t.prototype.renderOverflowMenu=function(){var e=this.props,t=e.definition,o=e.strings,i=e.onAction,n=e.automationId,r=t.critiqueType,s=t.isContentPending;if(r===$.c.NeuralRewrite&&s||r===$.c.DictationCorrection)return null;var a=qe(t,this.getTheme(),o,this.getFontTable(),this.calculateOverflowActions(),this.parseBooleanSetting("NoTooltipForFooterOverflow"),o.critique("footerSeeMoreActionsAccessibilityLabel"),void 0,n,i);return a?C.createElement(Ie,gt({ref:this.overflowMenuRef},a,{icon:{type:"Overflow",filled:!0}})):null},t.prototype.calculateOverflowActions=function(){var e=this.props.definition.actions;return void 0===e||0===e.length?[]:this.getAllFooterOverflowActions().filter((function(t){return void 0!==t&&-1!==e.indexOf(t)}))},t.prototype.getTheme=function(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:A.k},t.prototype.getBrandingTheme=function(){var e,t;return null!==(t=null===(e=this.props.theme)||void 0===e?void 0:e.branding)&&void 0!==t?t:function(e){switch(e){case $.b.Text:return Pe;case $.b.Icon:case $.b.MonochromeIcon:return Fe;case $.b.IconButton:return Ne;case $.b.IconAndTextButton:return He;default:return}}(this.props.definition.brandingMode)},t.prototype.getFontTable=function(){var e;return null!==(e=this.props.fontTable)&&void 0!==e?e:A.l},t.prototype.getFooterStyle=function(){var e;return null!==(e=this.props.footerContainerStyle)&&void 0!==e?e:A.z},t.prototype.renderFooterButton=function(e,t,o){var i,n=this.props,r=n.definition,s=n.strings,a=n.onAction,l=n.automationId,c=n.onPositionChange;if(!$e(r,e))return null;var u=Je(r,s,e);if(!u)return null;this.addActionId(e);var p="CritiqueActionButton_".concat(u,"_").concat(l),d=et(r,e),g=e===$.a.IgnoreOnce||e===$.a.IgnoreAll?Ze(r,s,this.getTheme(),d,e,void 0,{horizontalSpacing:null===(i=this.getFooterStyle())||void 0===i?void 0:i.paddingHorizontal}):void 0;if(!this.shouldRenderFooterIconActionInOverflow(e))return Ge(r,this.getTheme(),e,A.y,s,void 0,void 0,void 0,u,p,t?this.defaultActionButtonRef:void 0,g,l,a,!0,void 0,this.state.actionIdShowAppearFocusMap[e],o,c);var h={title:u,titleStyle:A.X(this.getFontTable(),u.length),onClick:function(){null==a||a(e)},style:A.y,theme:A.G(this.getTheme()),automationLabel:p,disabled:d};return C.createElement(be.a,gt({key:e,ref:this.defaultActionButtonRef},h))},t.prototype.renderDefaultActionButtons=function(){var e=this,t=this.props,o=t.definition,i=t.strings,n=t.onAction,r=t.automationId,s=o.critiqueType,a=o.actions,l=[];return void 0!==a&&a.length>0&&(l=this.getDefaultActions().filter((function(e){return void 0!==e&&-1!==a.indexOf(e)}))),s!==$.c.NeuralRewrite?C.createElement(C.Fragment,null,l.map((function(t){return e.renderFooterButton(t,0===l.indexOf(t))})),this.props.definition.critiqueType===$.c.AccColorChecker&&this.parseBooleanSetting("OpenColorPickerEnabled")?this.renderFooterButton($.a.OpenColorPicker,void 0,"ACCF2E3E-7EC7-46DF-AB25-A1AFEDBC6B7B"):null):0===l.length?C.createElement(Ee,{shimmerCount:1,styles:A.W(this.getSpacing())}):C.createElement(C.Fragment,null,l.map((function(t){return t===$.a.Dismiss?(e.addActionId(t),Ge(o,e.getTheme(),$.a.Dismiss,A.Z(e.getFontTable()),i,void 0,void 0,void 0,void 0,void 0,e.defaultActionButtonRef,void 0,r,n)):e.renderFooterButton(t)})))},t.prototype.getDefaultActions=function(){var e=this.props.definition,t=e.critiqueType,o=e.isContentPending,i=function(e){switch(e){case $.c.Refinement:case $.c.RepeatedWord:case $.c.SimilarityChecker:case $.c.AccColorChecker:case $.c.TonalRewrite:case $.c.Grammar:case $.c.DictationCorrection:case r.Person:case r.Location:case r.SatoriEntity:return $.a.IgnoreOnce;case $.c.Spelling:case $.c.Topic:case r.Topic:return $.a.IgnoreAll;case $.c.NeuralRewrite:case $.c.Classification:case $.c.WritersUnblock:default:return}}(t),n=this.parseBooleanSetting("EnableFeedback");switch(t){case $.c.Refinement:case $.c.Topic:var s=[i];return $e(e,$.a.Feedback)&&(this.shouldRenderFooterIconActionInOverflow($.a.Feedback)&&t!==$.c.Topic||s.push($.a.Feedback)),s;case $.c.Spelling:return[i,$e(e,$.a.Feedback)&&!this.shouldRenderFooterIconActionInOverflow($.a.Feedback)?$.a.Feedback:void 0,this.shouldRenderFooterIconActionInOverflow($.a.AddToDictionary)?void 0:$.a.AddToDictionary];case $.c.AccColorChecker:return this.parseBooleanSetting("AllowAccesibilityIssueEnabled")?[$.a.Allow]:[];case $.c.RepeatedWord:case $.c.SimilarityChecker:case $.c.DictationCorrection:return[i];case $.c.Grammar:return[i,n&&!this.shouldRenderFooterIconActionInOverflow($.a.Feedback)?$.a.Feedback:void 0];case $.c.TonalRewrite:return[i,n?$.a.Feedback:void 0];case $.c.NeuralRewrite:return o?[]:0===Ve(e).length?[$.a.Dismiss]:[$.a.Feedback];case r.Location:case r.Person:case r.SatoriEntity:case r.Topic:return[i];default:return[]}},t.prototype.renderExplanation=function(){var e=this.props,t=e.definition,o=e.onAction,i=e.strings,n=e.automationId,r=e.style,s=t.explanation,a=this.getTheme(),l=this.getFontTable();if(!s||0===s.length){if(this.props.definition.critiqueType!==$.c.AccColorChecker)return null;t.explanationTitle=this.props.strings.critiqueExplanation("contrastIssueExplanationTitle"),t.explanation=this.props.strings.critiqueExplanation("contrastIssueExplanation")}var c={onClick:function(){null==o||o($.a.ShowExplanation)},style:A.Y(l),theme:A.G(a,void 0,!0),tooltip:Je(t,i,$.a.ShowExplanation),accessibilityLabel:Xe(t,i,$.a.ShowExplanation),automationLabel:"CritiqueExplanationButton_".concat(n),icon:{type:"ShowExplanation",filled:!0}};this.addActionId($.a.ShowExplanation);var u={definition:t,strings:i,style:r,theme:a,fontTable:l};return C.createElement(Re,{calloutAccessibilityLabel:i.critique("explanationFlyoutAccessibilityLabel"),buttonProps:c},C.createElement(ye,gt({},u)))},t.prototype.renderBrandingOrPrevNextButton=function(){var e=this.props,t=e.definition,o=e.showPreviewTooltipForBranding,i=t.brandingMode;if(tt(t))return this.renderPrevNextButtons();if(void 0===i)return null;var n=this.props,r=n.strings,s=n.automationId,a=n.onAction,l=n.onPositionChange,c=et(t,$.a.OpenEditorPane);return i!==$.b.IconButton&&i!==$.b.IconAndTextButton||this.addActionId($.a.OpenEditorPane),C.createElement(at,{strings:r,theme:this.getBrandingTheme(),fontTable:this.getFontTable(),definition:t,automationId:s,brandingMode:i,onAction:a,htmlId:"editorButton",appearFocused:c?void 0:this.state.actionIdShowAppearFocusMap[$.a.OpenEditorPane],isDisabled:c,onPositionChange:l,showPreviewTooltipForBranding:o})},t.prototype.renderPrevNextButtons=function(){if(!$e(this.props.definition,$.a.Previous)||!$e(this.props.definition,$.a.Next))return null;var e=A.Z(this.getFontTable()),t=!this.parseBooleanSetting("NoTooltipForPrevNext");return this.addActionId($.a.Previous),this.addActionId($.a.Next),C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Stretch},Ge(this.props.definition,this.getTheme(),$.a.Previous,e,this.props.strings,void 0,void 0,void 0,t?Je(this.props.definition,this.props.strings,$.a.Previous):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,void 0,this.state.actionIdShowAppearFocusMap[$.a.Previous]),Ge(this.props.definition,this.getTheme(),$.a.Next,e,this.props.strings,void 0,void 0,void 0,t?Je(this.props.definition,this.props.strings,$.a.Next):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,void 0,this.state.actionIdShowAppearFocusMap[$.a.Next]))},t.prototype.getAllFooterOverflowActions=function(){var e=this.props.definition.critiqueType,t=this.parseBooleanSetting("EnableFeedback");switch(e){case $.c.Spelling:return[$.a.IgnoreOnce,this.shouldRenderFooterIconActionInOverflow($.a.AddToDictionary)?$.a.AddToDictionary:void 0,$.a.ToggleContext,$.a.ToggleDescription,$.a.Options];case $.c.RepeatedWord:return[$.a.ToggleContext,$.a.Options];case $.c.Grammar:return[$.a.IgnoreAll,$.a.IgnoreRule,$.a.ShowExplanation,$.a.ToggleContext,t&&this.shouldRenderFooterIconActionInOverflow($.a.Feedback)?$.a.Feedback:void 0,$.a.Options];case $.c.Refinement:return[$.a.IgnoreRule,$.a.ToggleContext,t&&this.shouldRenderFooterIconActionInOverflow($.a.Feedback)?$.a.Feedback:void 0,$.a.Options];case $.c.TonalRewrite:return[$.a.IgnoreAll,$.a.IgnoreRule,$.a.ToggleContext,$.a.Options];case $.c.Topic:return[$.a.IgnoreOnce,$.a.IgnoreRule,$.a.ToggleContext,$.a.Options];case $.c.NeuralRewrite:return[$.a.ToggleContext,$.a.ToggleDescription];case $.c.SimilarityChecker:return[$.a.Feedback,$.a.LearnMore];case $.c.AccColorChecker:return[this.parseBooleanSetting("AllowAccesibilityIssueEnabled")?$.a.AllowAll:void 0,$.a.TurnOffAccChecker,$.a.Feedback];case r.Location:case r.SatoriEntity:case r.Person:return[$.a.IgnoreRule,$.a.Feedback,$.a.ReadAloud,$.a.Options];case r.Topic:return[$.a.Feedback,$.a.Options];default:return[]}},t.prototype.shouldRenderFooterIconActionInOverflow=function(e){var t=Ke(e);return!(this.parseBooleanSetting("RenderFooterIcons")||this.props.definition.critiqueType===$.c.AccColorChecker)||!t||!ae.a.shouldRender({type:t})},t.prototype.getSpacing=function(){var e;return null!==(e=this.props.spacing)&&void 0!==e?e:A.m},t.contextMaxLength=120,t}(C.Component),mt=o(467);!function(e){e[e.line=1]="line",e[e.circle=2]="circle",e[e.gap=3]="gap"}(rt||(rt={}));var yt=o(469),ft=function(e,t,o){if(o||2===arguments.length)for(var i,n=0,r=t.length;n<r;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},bt=function(e){var t,o;return null!==(o=null!==(t=null==e?void 0:e.paddingTop)&&void 0!==t?t:null==e?void 0:e.paddingVertical)&&void 0!==o?o:4},vt=function(e){var t,o;return null!==(o=null!==(t=null==e?void 0:e.paddingBottom)&&void 0!==t?t:null==e?void 0:e.paddingVertical)&&void 0!==o?o:4},St=function(e,t,o){return void 0===e&&(e=24),void 0===t&&(t=8),void 0===o&&(o=120),[[{type:rt.circle,height:e},{type:rt.gap,width:t,height:16},{type:rt.line,width:o,height:16}],[{type:rt.circle,height:e},{type:rt.gap,width:t,height:16},{type:rt.line,width:o-20,height:16}],[{type:rt.circle,height:e},{type:rt.gap,width:t,height:16},{type:rt.line,width:o,height:16}]]},xt=C.memo((function(e){var t=e.items,o=e.theme,i=e.style,n=e.isLongShimmer,r=e.circleSize,s=e.gapSize,a=e.lineSize,l=null!=t?t:n?function(e,t,o){void 0===e&&(e=24),void 0===t&&(t=8),void 0===o&&(o=120);var i=St(e,t,o);return ft(ft(ft(ft([[{type:rt.line,width:100,height:10}]],i,!0),[[{type:rt.line,width:100,height:10}]],!1),i,!0),i,!0)}(r,s,a):St(r,s,a),c=Object(yt.a)(),u=function(e){var t,o;return null!==(o=null!==(t=null==e?void 0:e.paddingStart)&&void 0!==t?t:null==e?void 0:e.paddingHorizontal)&&void 0!==o?o:8}(i),p=function(e){var t,o;return null!==(o=null!==(t=null==e?void 0:e.paddingEnd)&&void 0!==t?t:null==e?void 0:e.paddingHorizontal)&&void 0!==o?o:8}(i);if(!l.length)return null;for(var d=[],g=0;g<l.length;g++){var h=l[g];d.push(C.createElement(_e.a,{key:"shimmer-".concat(g),style:{paddingTop:bt(i),paddingRight:c?u:p,paddingBottom:vt(i),paddingLeft:c?p:u},shimmerColors:{background:null==o?void 0:o.background,shimmer:null==o?void 0:o.shimmer,shimmerWave:null==o?void 0:o.shimmerWave},shimmerElements:h}))}return C.createElement(C.Fragment,null,d)})),Ct=function(){return(Ct=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Tt=function(e){var t=e.style,o=e.isError,i=e.strings,n=e.onAction,r=e.theme,a=e.htmlId,l=e.appearFocused,c=e.buttonRef,u=C.useCallback((function(){n&&n(o?s.Retry:s.ClearSearch)}),[i.inlineSuggestions("clearSearchLabel"),i.inlineSuggestions("tryAgainLabel")]),p=o?i.inlineSuggestions("somethingWentWrongLabel"):i.common("suggestionsGroupNoSuggestionsText"),d=o?i.inlineSuggestions("tryAgainLabel"):i.inlineSuggestions("clearSearchLabel"),g={style:A.Eb,theme:P(r,l),onClick:u,appearFocused:l,accessibilityLabel:p+". "+d};return C.createElement(H.a,{style:t,align:z.b.Stretch,direction:z.c.TopToBottom},C.createElement(se.a,{text:p,style:B(r,A.l)}),C.createElement(H.a,{style:{paddingVertical:6}}),C.createElement(be.a,Ct({ref:c,htmlId:a,automationLabel:d},g),C.createElement(se.a,{text:d,style:L(r,A.l)})))};function At(e,t){if(t){e=e.toLocaleLowerCase();var o=(t=t.toLocaleLowerCase()).indexOf(e);if(!(o<0))return[{start:o,length:e.length,fontWeight:w.a.SemiBold,wrapMode:w.b.NoWrap}]}}function wt(e,t,o){if(e){var i=o?null==t?void 0:t.filter((function(e){return e.propertyHit===o})):t,n=[];return i&&i.forEach((function(e){n.push({start:e.offset,length:e.word.length,fontWeight:w.a.SemiBold,wrapMode:w.b.NoWrap})})),n}}var Ot=function(e){var t=e.htmlId,o=e.theme,i=e.style,n=e.containerStyles,r=e.suggestionId,s=e.suggestionType,a=e.queryString,l=e.title,c=e.titleFontSize,u=e.subtitle,p=e.subtitleFontSize,d=e.truncateSubtitle,g=e.tooltip,h=e.icon,m=e.personaCoinProps,y=e.isHighlighted,f=e.accessibilityRole,b=e.accessibilityPositionInSet,v=e.accessibilitySetSize,S=e.onPositionChange,x=e.onClick,T=e.enablePrefixHighlighting,w=e.hitHighlightIndexes,O="Topic"===s,k=(null==n?void 0:n.maxWidth)&&n.maxWidth-70;return C.createElement(be.a,{htmlId:t,onClick:x,accessibilityRole:f,accessibilityPositionInSet:b,accessibilitySetSize:v,onPositionChange:S,automationLabel:"Inline".concat(s,"Suggestion-").concat(r),tooltipProps:{showBeak:O,coverTarget:!O,directionHint:O?Be.b.rightCenter:void 0},title:l,titleStyle:A.Bb(A.l,l?l.length:0,!0,c),titleRootStyle:A.db(k),personaCoinProps:m,style:i,subtitle:u,subtitleStyle:A.xb(A.l,!0,d,p),theme:M(o,y),appearFocused:y,tooltip:g,icon:h,titleFormatting_DONOTUSE:a?T?wt(l,w,"title"):At(a,l):void 0,subtitleFormatting:a?T?wt(u,w,"subTitle"):At(a,u):void 0})},kt=Object.freeze({doc:{iconType:"Word"},docx:{iconType:"Word"},dot:{iconType:"Word"},dotx:{iconType:"Word"},docm:{iconType:"Word"},docb:{iconType:"Word"},ppt:{iconType:"PowerPoint"},pptx:{iconType:"PowerPoint"},xls:{iconType:"Excel"},xlm:{iconType:"Excel"},xlsx:{iconType:"Excel"},xlsm:{iconType:"Excel"},xlsb:{iconType:"Excel"},xltx:{iconType:"Excel"},pdf:{iconType:"Pdf"},vsd:{iconType:"Visio"},vsdx:{iconType:"Visio"},loop:{iconType:"Loop"},fluid:{iconType:"Loop"}});var It=Object.freeze({Apps:"Apps",FFXCAccounts:"Person",FFXCBulletedList:"BulletedList",FFXCCalendarAgenda:"Agenda",FFXCChecklist:"Checklist",FFXCodeSnippet:"Code",FFXCCommentAdd:"CommentAdd",FFXCCompleted:"Completed",FFXConversation:"Conversation",FFXCEmoji:"EmojiSmile",FFXCEventDate:"Date",FFXFeedbackRequest:"FeedbackRequest",FFXCHorizontalDivider:"HorizontalDivider",FFXCInsertTextBox:"Paragraph",FFXCNumberedList:"NumberedList",FFXCPhoto2:"InsertImage",FFXQuestionAnswer:"QuestionAnswer",FFXCStatusTracker:"StatusTracker",FFXSignUp:"SignUpSheet",FFXCTable:"Table",FFXTeamUpdate:"TeamUpdate",FFXCVote:"Vote",Files:"Files",Location:"Location",Loop:"Loop",People:"People"});var _t=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};var Dt,Et=function(e,t){if(function(e){return e.type===g.EntityType.File}(e)){var o=e.hitFileName||"".concat(e.fileName,".").concat(e.fileExtension),i=(null==t?void 0:t.fileItemStyles)||{},n=i.iconStyles,r=i.titleFontSize,s=i.subtitleFontSize,a=_t(i,["iconStyles","titleFontSize","subtitleFontSize"]);return{suggestionId:e.itemId,suggestionType:e.type,title:o,titleFontSize:r,icon:{type:(h=e.fileExtension,m=h.toLocaleLowerCase(),kt.hasOwnProperty(m)?kt[m].iconType:"Cloud"),style:n||{}},style:a,subtitle:e.subject,subtitleFontSize:s,tooltip:o,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(function(e){return e.type===g.EntityType.People}(e)){var l=(null==t?void 0:t.personItemStyles)||{},c=l.personaCoinSize,u=l.titleFontSize,p=l.subtitleFontSize,d=_t(l,["personaCoinSize","titleFontSize","subtitleFontSize"]);return{suggestionId:e.displayName,suggestionType:e.type,title:e.displayName,titleFontSize:u,personaCoinProps:{text:"",coinSize:c,imageUrl:e.imageUrl,imageInitials:e.initials},style:d,subtitle:e.primaryEmailAddress,subtitleFontSize:p,truncateSubtitle:!0,tooltip:e.primaryEmailAddress,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}var h,m,y,f=e,b=f.id,v=f.title,S=f.subtitle,x=f.imageUrl,C=f.tooltip,T=f.type,A=f.isHighlighted,w=(null==t?void 0:t.genericItemStyles)||{},O=w.iconStyles,k=w.personaCoinSize,I=w.titleFontSize,_=w.subtitleFontSize,D=_t(w,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),E=(y=e.iconName)&&y in It?It[y]:y;return{suggestionId:b,suggestionType:T,title:v,titleFontSize:I,icon:void 0!==E?{type:E,style:O}:void 0,personaCoinProps:x||E?{text:"",coinSize:k,imageUrl:x}:void 0,style:D,subtitle:S,subtitleFontSize:_,truncateSubtitle:!!C,tooltip:null!=C?C:v,isHighlighted:A,hitHighlightIndexes:e.hitHighlightIndexes}},Mt=function(){return(Mt=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},jt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o},Rt=C.memo((function(e){var t=e.suggestion,o=e.theme,i=e.styles,n=e.onItemSelected,r=jt(e,["suggestion","theme","styles","onItemSelected"]),s=C.useCallback((function(){n(t)}),[t]),a=Et(t,i);return C.createElement(Ot,Mt({},r,a,{theme:o,onClick:s}))})),Bt=function(){return(Bt=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Lt=C.memo((function(e){var t=e.group,o=t.title,i=t.subtitle,n=t.isScoped,r=void 0!==n&&n,s=t.isHighlighted,a=t.addBottomBorder,l=e.htmlId,c=e.theme,u=e.style,p=e.styles,d=e.isScopableHeader,g=e.accessibilityPositionInSet,h=e.accessibilitySetSize,m=e.onClick,y=e.onPositionChange,f=null!=c?c:I,b=null!=u?u:_;if(d&&o){var v=null==f?void 0:f.text.resting,S={lineHeight:"10px",display:"flex",width:r?"auto":"100%",flexDirection:r?"row-reverse":"row"},x={color:v,marginLeft:"4px",fontWeight:"600",flexGrow:r?0:1,fontSize:A.l.xsmall,display:"flex",alignItems:"center"},T=r?"Previous":"Next";return C.createElement(be.a,{htmlId:l,icon:{type:T},automationLabel:o,title:o,titleStyle:A.Bb(A.l,(null==o?void 0:o.length)||0,!0),theme:M(f,s),onClick:m,style:{flexibleSize:!0},onPositionChange:y,accessibilityRole:"option",accessibilityPositionInSet:g,accessibilitySetSize:h,useFullWidth:!0},C.createElement("span",{"data-is-focusable":!0,style:S},C.createElement("span",{style:x},o),C.createElement(ae.a,{type:T,primaryColor:v,fontSize:10})))}return C.createElement(re.a,{header:o,headerStyle:Bt(Bt({},j(f,b,A.l)),p),subheader:i,subheaderStyle:Bt(Bt({},R(f,b,A.l)),p),componentStackStyle:F(f,a),stackDirection:z.c.TopToBottom,stackAlignment:z.b.Stretch,accessibleLive:z.a.Off})})),Pt=C.memo((function(e){var t=e.theme,o=e.style,i=e.group,n=e.accessibilitySetSize,r=e.headerHtmlId,s=e.headerStyles,a=e.containerStyles,l=e.hasScopableHeader,c=e.headerAccessibilityPositionInSet,u=e.enablePrefixHighlighting,p=e.itemsStyles,d=e.itemQueryString,g=e.onHeaderClick,h=e.onHeaderPositionChange,m=e.onItemSelected,y=e.onItemPositionChange,f=null!=t?t:I,b=null!=o?o:_,v=i.suggestions;return C.createElement(C.Fragment,null,C.createElement(Lt,{theme:f,style:b,styles:s,htmlId:r,group:i,isScopableHeader:l,accessibilityPositionInSet:c,accessibilitySetSize:n,onClick:g,onPositionChange:h}),v.map((function(e,t){var o=c+(l?++t:t);return C.createElement(Rt,{styles:p,containerStyles:a,suggestion:e,key:"suggestion-item-".concat(t),htmlId:te(o),theme:f,queryString:""!==d?d:void 0,accessibilityRole:"option",accessibilityPositionInSet:o+1,accessibilitySetSize:n,truncateSubtitle:!0,onItemSelected:m,onPositionChange:function(e,t){return y(e,t,o)},enablePrefixHighlighting:u})})))})),Ft=function(){return(Ft=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Nt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o},Ht=C.memo((function(e){var t,o,i,n=e.theme,r=e.style,s=e.styles,a=e.strings,l=e.results,c=e.isError,u=e.isEmpty,p=e.isShimmerVisible,d=e.isScrollVisible,g=e.enableScopedHeader,h=e.enablePrefixHighlighting,m=e.itemsCount,y=e.itemPositions,f=e.itemQueryString,b=e.noSuggestionId,v=void 0===b?"noSuggestions":b,S=e.noSuggestionsButtonRef,x=e.onGroupSelected,T=e.onItemSelected,A=e.onNoSuggestionAction,w=null!=n?n:I,O=null!=r?r:_,k=0;if(p){var D=(null==s?void 0:s.shimmerStyles)||{},E=D.circleSize,M=D.gapSize,j=D.lineSize,R=Nt(D,["circleSize","gapSize","lineSize"]);return C.createElement(H.a,{style:F(w),align:z.b.Start},C.createElement(xt,{style:R,circleSize:E,gapSize:M,lineSize:j,isLongShimmer:d,theme:{background:null==w?void 0:w.background.resting,shimmer:null===(t=null==w?void 0:w.shimmer)||void 0===t?void 0:t.shimmerColor,shimmerWave:null===(o=null==w?void 0:w.shimmer)||void 0===o?void 0:o.shimmerWaveColor}}))}return c||u?C.createElement(H.a,{style:F(w),align:z.b.Stretch},C.createElement(Tt,{style:Ft(Ft({},null==s?void 0:s.noSuggestionsStyles),{backgroundColor:null===(i=null==n?void 0:n.background)||void 0===i?void 0:i.resting}),isError:c,strings:a,onAction:A,theme:w,htmlId:v,appearFocused:!1,buttonRef:S})):C.createElement(C.Fragment,null,l.map((function(e,t){var o=e.suggestions,i=k,n=C.createElement(Pt,{theme:w,style:O,key:"suggestion-group-".concat(t),group:e,accessibilitySetSize:m,headerHtmlId:te(k),headerStyles:null==s?void 0:s.headerStyles,containerStyles:null==s?void 0:s.containerStyles,headerAccessibilityPositionInSet:k,hasScopableHeader:g,enablePrefixHighlighting:h,onHeaderClick:function(){return null==x?void 0:x(e)},onHeaderPositionChange:function(e,t){return y[i]={top:e,bottom:t}},itemsStyles:null==s?void 0:s.itemsStyles,itemQueryString:f,onItemSelected:T,onItemPositionChange:function(e,t,o){0===o&&(e=0),y[o]={top:e,bottom:t}}});return g&&k++,k+=o.length,n})))})),zt=function(){return(zt=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Ut=function(e,t){var o;return void 0===e&&(e={}),zt({hideFocusBox:!0,minWidth:240,maxWidth:240,maxHeight:null!==(o=null==t?void 0:t.menuHeight)&&void 0!==o?o:252,borderRadius:8,paddingHorizontal:4,paddingTop:4,paddingBottom:4},e)},Wt=function(e){return void 0===e&&(e={}),zt({paddingVertical:4,paddingHorizontal:8},e)},qt=function(e){return void 0===e&&(e={}),zt({paddingHorizontal:A.g,paddingVertical:9},e)},Gt=function(e){return void 0===e&&(e={}),zt({},e)},Zt=function(e,t){return void 0===e&&(e={}),{genericItemStyles:Yt(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:Xt(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:Jt(e.fileItemStyles,e.sharedItemStyles,t)}},Vt=function(e){var t,o;return zt(zt({},D),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:D.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:D.height})},Qt=function(e){return zt(zt({},E),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{})},Yt=function(e,t,o){var i;return void 0===e&&(e={}),void 0===t&&(t={}),zt(zt(zt(zt(zt({},Vt(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:zt(zt({},Qt(o)),null==e?void 0:e.iconStyles)})},Xt=function(e,t,o){var i;return void 0===e&&(e={}),void 0===t&&(t={}),zt(zt(zt(zt({},Vt(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e)},Jt=function(e,t,o){return void 0===e&&(e={}),void 0===t&&(t={}),zt(zt(zt(zt({},Vt(o)),t),e),{iconStyles:zt(zt({},Qt(o)),null==e?void 0:e.iconStyles)})},Kt=function(e){return void 0===e&&(e={}),zt(zt(zt({},A.z),{height:40,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},$t=function(){return($t=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},eo=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o},to=function(e){var t,o,i=e.definition,n=e.theme,s=e.style,a=e.styles,l=e.strings,c=e.queryString,u=e.results,p=e.isError,d=e.isLoading,g=e.menuType,h=e.enableScopedHeader,m=e.enablePrefixHighlighting,y=e.enableStickyFooter,f=e.keyboardHandlerTarget,b=e.onGroupSelected,v=e.onAction,S=e.onItemSelected,x=e.onItemFocused,T=e.onFooterAction,w=e.onAfterUpdate,O=null!=n?n:I,k=null!=s?s:_,D=function(e,t){return void 0===e&&(e={}),{containerStyles:Ut(e.containerStyles,t),shimmerStyles:Wt(e.shimmerStyles),noSuggestionsStyles:qt(e.noSuggestionsStyles),headerStyles:Gt(e.headerStyles),itemsStyles:Zt(e.itemsStyles,t),footerStyles:Kt(e.footerStyles)}}(a,k),E=[],M=g&&"flag"in g?g.flag:$.c.Spelling,j={RenderFooterIcons:"true"},R=C.useRef(null),B=C.useRef(null),L=C.createRef(),P=C.useState({value:0}),F=P[0],U=P[1],W=C.useState({value:-1}),q=W[0],Z=W[1],V=C.useState([]),Q=V[0],Y=V[1],X=function(e){return Y(e)},ee=C.useState(!1),ne=ee[0],re=ee[1],se=C.useState(!1),ae=se[0],le=se[1],ce=C.useState(),ue=ce[0],pe=ce[1],de=u.every((function(e){return!e.suggestions||0===e.suggestions.length})),ge=h?u.length:0,he=u.map((function(e){return e.suggestions.length})).reduce((function(e,t){return t+e}),0)+ge,me=!!(o=g)&&(o.hasOwnProperty("userInitiated")?void 0!==o.brandingMode:!!o.hasOwnProperty("flag")),ye=!!g&&"brandingMode"in g&&void 0!==g.brandingMode?g.brandingMode:void 0,fe=g&&"flag"in g?g.critiquePosition:void 0,be=g&&"flag"in g?g.critiqueSetSize:void 0;C.useEffect((function(){for(var e=0,t=0,o=u;t<o.length;t++){var i=o[t];e++,F.value>=e&&F.value<e+i.suggestions.length&&(B.current=i.suggestions[F.value-e]),e+=i.suggestions.length}}),[F]),C.useEffect((function(){R.current&&(clearTimeout(R.current),R.current=null),d?u&&u.length?R.current=setTimeout((function(){return le(!0)}),2e3):le(!0):le(!1)}),[d]),C.useEffect((function(){w&&i&&w(i)}),[]);var ve=function(e,t){var o=0;u.forEach((function(i){h&&(e===o&&(i.isHighlighted=t,pe(E[e]),null==x||x(te(e))),o++),e>=o&&e<o+i.suggestions.length&&(i.suggestions[e-o].isHighlighted=t,t&&(pe(E[e]),x&&x(te(e)))),o+=i.suggestions.length}))},Se=function(e,t){return t<0?-1:(e>=0&&ve(e,!1),ve(t%=he,!0),t)};C.useEffect((function(){if((p||de)&&x)x("noSuggestions");else{var e=h?1:0;x&&x(te(e)),Se(F.value,e),U({value:e})}}),[u]);var xe=function(e){switch(e){case mt.a.ArrowDown:-1===q.value?(ve(F.value,!1),Z({value:0})):q.value<Q.length-1?Z({value:q.value+1}):(U({value:Se(-1,0)}),Z({value:-1}));break;case mt.a.ArrowUp:if(0===q.value)U({value:Se(-1,he-1)}),Z({value:-1});else if(q.value>0)Z({value:q.value-1});else{ve(0,!1),Z({value:Q.length-1});var t=E[he-1],o=t.top,i=t.bottom,n=E[he],r=n.top,s=n.bottom;pe({top:o+r,bottom:i+s})}break;case mt.a.Enter:case mt.a.Tab:null==T||T(Q[q.value])}},Ce=function(e){var t;if(e!==mt.a.ArrowDown&&e!==mt.a.ArrowUp&&e!==mt.a.Enter&&e!==mt.a.Tab&&e!==mt.a.Home&&e!==mt.a.End)return!1;if(p||de)return e!==mt.a.ArrowDown&&e!==mt.a.ArrowUp||!x?e===mt.a.Enter&&(null===(t=L.current)||void 0===t?void 0:t.props.onClick)&&L.current.props.onClick():x("noSuggestions"),!0;switch(e){case mt.a.ArrowDown:if(-1===q.value&&F.value!==he-1){var o=Se(F.value,F.value+1);U({value:o})}else Q.length>0?xe(e):U({value:Se(F.value,0)});break;case mt.a.ArrowUp:-1===q.value&&0!==F.value?U({value:Se(F.value,0===F.value?(he||1)-1:F.value-1)}):Q.length>0?xe(e):U({value:Se(F.value,he-1)});break;case mt.a.Home:U({value:Se(F.value,0)});break;case mt.a.End:U({value:Se(F.value,he-1)});break;case mt.a.Enter:case mt.a.Tab:if(-1!==q.value){xe(e);break}if(d&&B.current)S(B.current);else{var i=0;u.forEach((function(e){h&&(F.value===i&&(null==b||b(e)),i++),F.value>=i&&F.value<i+e.suggestions.length&&S(e.suggestions[F.value-i]),i+=e.suggestions.length}))}break;default:return!1}return!0};C.useEffect((function(){return null==f||f.setKeyPressHandler(Ce),function(){null==f||f.setKeyPressHandler(void 0)}}));var Te,Ae=D.containerStyles||{},we=Ae.paddingHorizontal,Oe=Ae.paddingTop,ke=Ae.paddingBottom,Ie=Ae.paddingVertical,_e=eo(Ae,["paddingHorizontal","paddingTop","paddingBottom","paddingVertical"]),De=function(){return me?C.createElement(ht,{theme:ie(O),definition:{critiqueType:M,brandingMode:ye,onlyShowFeedbackButton:y,actions:oe(g),critiquePosition:fe,critiqueSetSize:be},strings:l,settings:j,onAction:T,footerContainerStyle:D.footerStyles,setFooterActionIdList:X,selectedButtonIndex:q.value,onPositionChange:function(e,t){return E[he]={top:e,bottom:t}},showPreviewTooltipForBranding:!0}):C.createElement(C.Fragment,null)};return C.createElement(H.a,{style:$t($t({},A.pb(O)),_e),align:z.b.Stretch,focusable:!0,onKeyDown:function(e){f||Ce(e.key)},handledKeys:[mt.a.ArrowDown,mt.a.ArrowUp,mt.a.Enter,mt.a.Tab,mt.a.Home,mt.a.End],accessibilityRole:ae||p||de?void 0:"listbox",accessible:!0,accessibilityLabel:l.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel")},C.createElement(G,{scrollDirection:"vertical",style:{paddingHorizontal:we,paddingTop:Oe,paddingBottom:ke,paddingVertical:Ie,borderRadius:_e.borderRadius},theme:{thumbColor:null===(t=null==O?void 0:O.scroll)||void 0===t?void 0:t.thumbColor},onScrollStatusChange:function(e){return re(e)},scrollTo:ue,hidden:ae},C.createElement(J,null,C.createElement(Ht,{theme:O,style:k,styles:D,strings:l,results:u,isEmpty:de,isError:p,isShimmerVisible:ae,isScrollVisible:ne,enableScopedHeader:h,itemsCount:he,itemPositions:E,itemQueryString:c,noSuggestionsButtonRef:L,onGroupSelected:b,onItemSelected:S,onNoSuggestionAction:v,enablePrefixHighlighting:m})),g&&"flag"in g&&g.flag===r.SatoriEntity&&C.createElement(H.a,{style:{paddingHorizontal:A.g}},C.createElement(K.a,{url:(Te=c,"https://www.bing.com/q="+Te),text:l.inlineSuggestions("seeMoreHyperLinkLabel"),theme:N(O),style:{fontSize:12,fontWeight:600},inline:!1})),!y&&De()),y&&De())},oo=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),io=function(){return(io=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!function(e){e[e.Undo=0]="Undo",e[e.Ignore=1]="Ignore",e[e.Feedback=2]="Feedback"}(Dt||(Dt={}));var no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oo(t,e),t.prototype.render=function(){return this.renderUndoButton()},t.prototype.renderUndoButton=function(){var e=this,t={icon:{type:"Undo"},onClick:function(){e.props.onAction&&e.props.onAction(Dt.Undo)},style:A.Ab(A.l),theme:A.G(A.k),accessibilityLabel:this.props.strings.undoAccessibilityLabel,automationLabel:"undefined",tooltip:this.props.originalText};return C.createElement(be.a,io({},t))},t}(C.Component),ro={paddingHorizontal:8,paddingVertical:4};function so(e,t){return function(e,t){switch(t){case $.a.Feedback:return e.summarization("giveFeedback");case $.a.UndoInsertSummarization:return e.summarization("undoInsertSummary");case $.a.RefreshSummary:return e.summarization("refreshSummary");default:return}}(e,t)}function ao(e){switch(e){case $.a.Feedback:return"Summarization_GiveFeedback";case $.a.UndoInsertSummarization:return"Summarization_Undo";case $.a.RefreshSummary:return"Summarization_Regenerate";default:return"Summarization_"+e}}var lo,co,uo,po,go,ho,mo=function(){return(mo=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},yo=function(e){var t=function(e){switch(e){case $.a.Feedback:return"GiveFeedback";case $.a.UndoInsertSummarization:return"Undo";case $.a.RefreshSummary:return"Repeat"}}(e.action),o=void 0!==t?{type:t}:void 0,i={onClick:function(){e.onAction&&e.onAction(e.action)},tooltip:so(e.strings,e.action),theme:e.theme,accessibilityLabel:so(e.strings,e.action),automationLabel:ao(e.action),icon:o};return C.createElement(be.a,mo({},i,{key:e.action.toString()}))},fo=function(e){var t;return C.createElement(H.a,{direction:z.c.LeftToRight,style:null!==(t=e.style)&&void 0!==t?t:ro,align:z.b.Stretch},e.actions.map((function(t){return C.createElement(yo,{action:t,onAction:e.onAction,theme:e.theme,strings:e.strings,key:t.toString()})})))},bo=o(1305),vo=o(33);!function(e){e[e.None=0]="None",e[e.Offer=1]="Offer",e[e.See=2]="See",e[e.Try=3]="Try",e[e.Keep=4]="Keep"}(lo||(lo={})),function(e){e[e.SessionStart=0]="SessionStart",e[e.SessionEnd=1]="SessionEnd",e[e.Apply=2]="Apply",e[e.Preview=3]="Preview",e[e.BlurPreview=4]="BlurPreview",e[e.DrillIn=5]="DrillIn",e[e.Search=6]="Search",e[e.Created=7]="Created",e[e.Accepted=8]="Accepted",e[e.Resolved=9]="Resolved",e[e.Presented=10]="Presented",e[e.Modified=11]="Modified",e[e.Deleted=12]="Deleted",e[e.Rejected=13]="Rejected",e[e.Replied=14]="Replied",e[e.Back=15]="Back",e[e.Next=16]="Next",e[e.Previous=17]="Previous",e[e.IgnoreOnce=18]="IgnoreOnce",e[e.IgnoreAll=19]="IgnoreAll",e[e.Options=20]="Options",e[e.Toggle=21]="Toggle",e[e.Report=22]="Report",e[e.LearnMore=23]="LearnMore",e[e.SnoozeSuggestionGroupForSession=25]="SnoozeSuggestionGroupForSession",e[e.SnoozeSuggestionTypeForSession=26]="SnoozeSuggestionTypeForSession",e[e.Delete=27]="Delete",e[e.InvokeOnAddOnFooter=28]="InvokeOnAddOnFooter",e[e.GiveFeedback=29]="GiveFeedback",e[e.OpenEditorPane=30]="OpenEditorPane",e[e.AcceptAll=31]="AcceptAll",e[e.RejectAll=32]="RejectAll",e[e.Undo=33]="Undo",e[e.ShowExplanation=34]="ShowExplanation",e[e.SelectSource=35]="SelectSource",e[e.OpenDesignerPane=36]="OpenDesignerPane",e[e.AddToDictionary=37]="AddToDictionary",e[e.ViewOriginal=38]="ViewOriginal",e[e.SnoozeAll=39]="SnoozeAll",e[e.Retry=40]="Retry",e[e.ClearSearch=41]="ClearSearch",e[e.ShowMore=42]="ShowMore",e[e.ShowHideContext=43]="ShowHideContext",e[e.RevealSuggestions=44]="RevealSuggestions",e[e.UndoInsertSummarization=45]="UndoInsertSummarization",e[e.RefreshSummary=46]="RefreshSummary"}(co||(co={})),function(e){e[e.Normal=5]="Normal",e[e.Bold=8]="Bold"}(uo||(uo={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SpellingSquiggle=3]="SpellingSquiggle",e[e.GrammarSquiggle=4]="GrammarSquiggle",e[e.CritiqueSquiggle=5]="CritiqueSquiggle"}(po||(po={})),function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.Modification=6]="Modification",e[e.PremiumEmphasis=7]="PremiumEmphasis",e[e.TrackChangeContent=8]="TrackChangeContent",e[e.TrackChangePlaceholder=9]="TrackChangePlaceholder"}(go||(go={})),function(e){e[e.None=0]="None",e[e.HideFromReviewCard=1]="HideFromReviewCard",e[e.HideFromReviewCardAndRibbon=2]="HideFromReviewCardAndRibbon"}(ho||(ho={}));po.None;var So,xo,Co,To,Ao=o(1081),wo=function(){function e(){}return e.prototype.loadStrings=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(l.__generator)(this,(function(i){return[2,o(1804)("./".concat(e,"/canvas-contextual.json")).then((function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return[2,e]}))}))})).catch((function(t){return u.a.sendTraceTag(595727971,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Canvas contextual failed to load resources for locale '".concat(e,"'. Error: ").concat(JSON.stringify({message:t.message,stack:t.stack}),")}")),Ao.CanvasContextual}))]}))}))},e}(),Oo=o(13),ko={selectors:(So={},So[Oo.l]={outline:"1px solid Highlight",color:"Highlight"},So)},Io='"Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif',_o=o(340),Do=o(2417),Eo={themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",themeLighterAlt:"#eff6fc",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#424242",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#e0e0e0",neutralLighterAlt:"#f5f5f5",white:"#ffffff",blue:"#3355ff",purple:"#5a4ebc",greenLight:"#d4edd4",greenDark:"#0b6a0b",orange:"#da3b01",blueDark:"#ebf3fc"},Mo="red",jo="white",Ro="#5A45B6",Bo=(xo=Eo,Co={themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#296FE6",themeTertiary:"#296FE6",themeLight:"#0c2145",themeLighter:"#071225",themeLighterAlt:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#d6d6d6",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#141414",neutralLighter:"#1f1f1f",neutralLighterAlt:"#3d3d3d",white:"#292929",blue:"#92a4f4",purple:"#a79cf1",greenLight:"#094609",greenDark:"#4fd34f",orange:"#ff6a49",blueDark:"#0c2145"},(To={})[Do.a.Light]=Object(_o.a)({palette:xo}),To[Do.a.Dark]=Object(_o.a)({palette:Co}),To);function Lo(){return Bo[Do.b.getInstance().getThemeMode()]}var Po=function(e){this.isRightToLeft=e,this.themeColors=Lo().palette,this.overflowButtonStyles={root:{display:"block",minHeight:"18px",padding:"11px",width:"100%",maxWidth:"100%",backgroundColor:"transparent",borderWidth:"0px",borderRadius:"0px"},iconHovered:{fontSize:14,color:this.themeColors.neutralSecondary,margin:"0px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},ko),flexContainer:{alignItems:"center"},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.overflowMenuStyles={root:{direction:this.isRightToLeft?"rtl":"ltr",borderRadius:"2px",boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2)",backgroundColor:this.themeColors.white,width:"auto",borderWidth:"0px",outline:"transparent solid 1px",alignContent:"center"},beakCurtain:{borderRadius:"2px"},calloutMain:{backgroundColor:this.themeColors.white,borderRadius:"2px"}},this.iconStyles={root:{fontSize:14,color:this.themeColors.neutralSecondary,margin:"0px"}},this.overflowIconName="More"},Fo=function(e){function t(){var t,o=null!==e&&e.apply(this,arguments)||this;return o.overflowButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingTop:"6px",paddingBottom:"6px",backgroundColor:o.themeColors.white,borderWidth:"0px",borderRadius:"2px"},icon:{paddingTop:"5px"},iconHovered:{color:o.themeColors.neutralSecondary},rootFocused:Object(l.__assign)({},ko),rootHovered:(t={backgroundColor:o.themeColors.neutralLighterAlt},t[Oo.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},t),rootPressed:{backgroundColor:o.themeColors.neutralLighter},flexContainer:{outline:"transparent solid 1px"},label:{color:o.themeColors.neutralSecondary}},o}return Object(l.__extends)(t,e),t}(Po),No=function(){function e(e){this.isRightToLeft=e,this.themeColors=Lo().palette,this.suggestionStyles={display:"flex",flexDirection:"column"},this.previewHeaderStyles={display:"block",fontSize:10,margin:"4px 7px 4px 7px",paddingLeft:"7px",paddingRight:"7px",borderRadius:"12px",height:"14px",textAlign:this.isRightToLeft?"right":"left",color:this.themeColors.black,fontFamily:Io,fontWeight:600,backgroundColor:this.themeColors.neutralLight},this.suggestionButtonStyles={root:{display:"block",border:"transparent solid 1px",padding:"8px",width:"100%",maxWidth:"100%",backgroundColor:this.themeColors.white},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},ko),flexContainer:{alignItems:"center"},textContainer:{margin:"4px 12px 0px 12px",textAlign:this.isRightToLeft?"right":"left"},label:{fontSize:14,height:20,marginBottom:0,color:this.themeColors.neutralDark,fontFamily:Io,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},description:{fontSize:12,height:16,color:this.themeColors.neutralSecondary,fontFamily:Io,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},this.suggestionButtonIconStyles={root:{margin:"4px 0px 0px 0px",fontSize:32,height:32,width:32}},this.footerButtonStyles={root:{backgroundColor:this.themeColors.white,border:"transparent solid 1px",padding:"5px 9px 8px",height:44,borderRadius:0},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},ko),textContainer:{margin:"5px 6px",textAlign:this.isRightToLeft?"right":"left"},label:{margin:0,fontSize:14,height:19,color:this.themeColors.neutralSecondaryAlt,fontFamily:Io,lineHeight:"inherit",fontWeight:"normal"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt}},this.footerIconStyles={root:{margin:"0px 8px 0px 0px",fontSize:18,color:this.themeColors.themeDarkAlt}},this.suggestionOverflowMenuStyleProvider=new Po(this.isRightToLeft),this.bottomAlignedOverflowMenuStyleProvider=new Fo(this.isRightToLeft),this.suggestionOverflowButtonStyles={root:{padding:"8px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"18px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootDisabled:{backgroundColor:this.themeColors.white},flexContainer:{outline:"transparent solid 1px"},textContainer:{margin:"4px 4px 0px 4px",textAlign:this.isRightToLeft?"right":"left"},label:{fontSize:14,height:"20px",marginBottom:"0px",fontFamily:Io,fontWeight:600,color:this.themeColors.neutralPrimaryAlt},labelDisabled:{color:this.themeColors.neutralQuaternaryAlt}},this.overflowActionButtonRootStyles={margin:"0px",padding:"8px 12px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"36px",height:"36px"},this.overflowActionButtonStyles={root:Object(l.__assign)(Object(l.__assign)({},this.overflowActionButtonRootStyles),{width:"186px"}),rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootDisabled:{backgroundColor:this.themeColors.white},rootFocused:Object(l.__assign)({},ko),flexContainer:{outline:"transparent solid 1px",alignItems:"center",height:"20px"},label:{fontSize:14,color:this.themeColors.neutralSecondaryAlt,fontFamily:Io,fontWeight:"normal",margin:"0px"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.footerOverflowContainerStyles={minWidth:"140px",display:"flex",flexDirection:"column",marginTop:"4px",marginBottom:"4px"},this.onboardingHeadingStyles={color:this.themeColors.neutralSecondary,fontWeight:"bold",margin:"10px 14px 0px 14px"},this.onboardingContentStyles={color:this.themeColors.neutralSecondary,margin:"4px 14px 0px 14px"},this.onboardingLearnMoreStyles={margin:"14px 14px 8px 14px"},this.onboardingLearnMoreLinkStyles={color:this.themeColors.neutralSecondary}}return Object.defineProperty(e.prototype,"suggestionGroupStyles",{get:function(){return{width:"288px",display:"flex",flexDirection:"column",borderRadius:4}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headerStyles",{get:function(){return{display:"flex",justifyContent:"space-between",margin:"14px 16px 8px 16px",fontSize:12,minHeight:16,textAlign:this.isRightToLeft?"right":"left",color:this.themeColors.neutralSecondary,fontFamily:Io}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"footerStyles",{get:function(){return{display:"flex",height:44,margin:"2px 4px"}},enumerable:!1,configurable:!0}),e}(),Ho=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suggestionButtonStyles={root:{display:"block",border:"none",padding:"10px 16px 9px 16px",width:"100%",maxWidth:"100%",minHeight:"38px",maxHeight:"38px",backgroundColor:t.themeColors.white},rootHovered:{backgroundColor:t.themeColors.neutralLighter,borderColor:t.themeColors.white},flexContainer:{maxHeight:"38px"},textContainer:{textAlign:t.isRightToLeft?"right":"left",margin:"0px 8px 0px 8px"},label:{fontSize:14,height:"19px",color:t.themeColors.neutralDark,margin:"0px",fontFamily:Io,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},t.suggestionButtonIconStyles={root:{margin:"0px",fontSize:16,height:"16px",width:"16px"}},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{minWidth:"186px",display:"flex",flexDirection:"column",borderRadius:"4px",outline:"transparent solid 1px"}},enumerable:!1,configurable:!0}),t.prototype.compoundButtonIconName=function(e){switch(e.type){case"InsertPlaceholderItem":return"ReminderTime";case"MarkCompleteItem":case"MarkCompleteKeepTextItem":case"MarkCompleteRemoveTextItem":return"CheckMark";case"OpenNavPaneItem":return"BulletedList2";default:return}},t}(No),zo=function(e){function t(){var t,o=null!==e&&e.apply(this,arguments)||this;return o.overflowButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingTop:"6px",paddingBottom:"6px",paddingLeft:"8px",paddingRight:"8px",backgroundColor:o.themeColors.white,borderWidth:"0px",borderRadius:"2px"},iconHovered:{color:o.themeColors.neutralSecondary},rootFocused:Object(l.__assign)({},ko),rootHovered:(t={backgroundColor:o.themeColors.neutralLighterAlt},t[Oo.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},t),rootPressed:{backgroundColor:o.themeColors.neutralLighter},flexContainer:{flexDirection:"row-reverse",outline:"transparent solid 1px"},label:{color:o.themeColors.neutralSecondary}},o.iconStyles={root:{fontSize:10,color:o.themeColors.neutralSecondary,margin:o.isRightToLeft?"0px 4px 0px 0px":"0px 0px 0px 4px",paddingTop:"5px"}},o}return Object(l.__extends)(t,e),t}(Po),Uo=function(e){function t(){var t,o,i=null!==e&&e.apply(this,arguments)||this;return i.themeColors=Lo().palette,i.contextStyles={style:{color:i.themeColors.neutralSecondaryAlt,display:"block",margin:Qo.critiqueMargin,fontFamily:Io}},i.disabledFooterIconStyles={root:{fontSize:10,color:i.themeColors.neutralQuaternaryAlt,background:"transparent",padding:"5px 0px 0px 0px",margin:"0px"}},i.footerRightIconName="ChevronRight",i.footerLeftIconName="ChevronLeft",i.footerButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingLeft:"8px",paddingRight:"8px",paddingBottom:"6px",paddingTop:"6px",backgroundColor:i.themeColors.white,borderWidth:"0px",minHeight:"18px",selectors:(t={},t[Oo.l]={color:"ButtonText",backgroundColor:"Button"},t)},rootHovered:(o={backgroundColor:i.themeColors.neutralLighterAlt},o[Oo.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},o),rootPressed:{backgroundColor:i.themeColors.neutralLighter},rootDisabled:{backgroundColor:i.themeColors.white},rootFocused:Object(l.__assign)({},ko),flexContainer:{alignItems:"center",outline:"transparent solid 1px"},label:{fontSize:14,color:i.themeColors.neutralSecondaryAlt,fontFamily:Io,fontWeight:"normal",margin:"0px"},labelDisabled:{color:i.themeColors.neutralTertiaryAlt}},i.footerIconStyles={root:{fontSize:10,color:i.themeColors.neutralSecondary,background:"transparent",padding:"5px 0px 0px 0px",margin:"0px"}},i.tooltipHostStyles={root:{display:"inline-block"}},i}return Object(l.__extends)(t,e),t.critiqueMargin=16,t}(No);function Wo(){var e=Lo().palette,t=e.themeDarker,o=e.themeDark,i=e.themeDarkAlt,n=e.themePrimary,r=e.themeSecondary,s=e.neutralDark,a=e.neutralPrimary,l=e.neutralSecondaryAlt,c=e.neutralTertiary,u=e.neutralTertiaryAlt,p=e.neutralLight,d=e.neutralLighter,g=e.neutralLighterAlt,h=e.black,m=e.white,y=e.blue,f=e.purple,b=e.greenLight,v=e.blueDark;return{background:{resting:m,hover:g,pressed:d,disabled:g},text:{resting:s,disabled:c},tag:{resting:s},altText:{resting:l},icon:{resting:l,disabled:u},grammarText:{resting:y},refinementText:{resting:f},rewriteText:f,suggestionMenuHoverBackground:p,primaryButtonBackground:{resting:r,hover:r,pressed:r,disabled:g},primaryButtonText:{resting:jo,disabled:c},header:a,subheader:l,dialogText:a,iconText:s,contextText:s,errorText:Mo,border:s,separator:d,focusRing:l,link:i,linkPressed:t,branding:{type:"IconAndTextButton",background:{resting:m,hover:g,pressed:d,disabled:m},icon:{resting:n,disabled:c},title:{resting:n,disabled:c},tooltip:{textColor:s},focusRing:l},addOnFooterBackground:g,addOnHeaderBackground:v,addOnFooterMessage:h,premiumEmphasis:n,addOnAction:n,editorIcon:n,correctionHighlight:b,helpLink:{text:{resting:i,hover:o,focused:i,pressed:t},focusRing:a},badgeBackground:r,badgeText:jo}}var qo,Go,Zo,Vo,Qo=function(e){function t(){var o,i,n=null!==e&&e.apply(this,arguments)||this;return n.defaultTitleStyles={fontSize:14,fontFamily:Io,fontWeight:400},n.citationFeedbackContainerStyles={backgroundColor:n.themeColors.neutralLighterAlt,color:n.themeColors.neutralDark,marginLeft:"8px",marginRight:"8px",marginTop:"8px",marginBottom:"12px"},n.defaultHeaderStyles={display:"block",marginTop:"14px",marginBottom:"8px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,fontSize:12,color:n.themeColors.neutralSecondary,fontFamily:Io},n.largeHeaderStyles={fontSize:22},n.subheaderStyles={marginTop:"9px",color:n.themeColors.neutralPrimary},n.twoLineContextStyles={style:{display:"block",margin:t.critiqueMargin,fontFamily:Io,overflow:"hidden",maxHeight:"38px",fontSize:12,color:n.themeColors.neutralSecondaryAlt}},n.webkitTwoLineContextStyles={style:{display:"-webkit-box",margin:t.critiqueMargin,fontFamily:Io,overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontSize:12,color:n.themeColors.neutralSecondaryAlt}},n.suggestionGroupFeedbackStyles={display:"flex",minWidth:"248px",maxWidth:"600px",flexDirection:"column",outline:"transparent solid 1px"},n.suggestionStyles={display:"flex",flexDirection:"column"},n.suggestionTitleStyles={style:Object(l.__assign)(Object(l.__assign)({},n.defaultTitleStyles),{color:n.themeColors.neutralDark,wordBreak:"break-word"})},n.noSuggestionStyles={style:{display:"flex",fontWeight:600,margin:"8px 16px 8px 16px"}},n.disabledSuggestionTitleStyles={style:Object(l.__assign)(Object(l.__assign)({},n.defaultTitleStyles),{color:n.themeColors.neutralTertiary,wordBreak:"break-word"})},n.suggestionDescriptionStyles={style:{fontSize:12,height:"16px",color:n.themeColors.neutralSecondaryAlt,fontFamily:Io}},n.suggestionButtonStyles={root:{display:"block",minHeight:"18px",paddingTop:"9px",paddingBottom:"10px",paddingRight:t.critiqueMargin,paddingLeft:t.critiqueMargin,backgroundColor:"transparent",borderWidth:"0px",borderRadius:"0px",width:"100%",maxWidth:"100%"},rootHovered:{backgroundColor:n.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:n.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},ko),rootDisabled:{backgroundColor:"transparent"},flexContainer:{justifyContent:"flex-start",display:"flex",flexDirection:"column",textAlign:n.isRightToLeft?"right":"left",outline:"transparent solid 1px",alignItems:"initial"}},n.suggestionContainerStyles={display:"flex",flexDirection:"row"},n.hoveredSuggestionContainerStyles=Object(l.__assign)(Object(l.__assign)({},n.suggestionContainerStyles),{backgroundColor:n.themeColors.neutralLighterAlt}),n.disabledSuggestionContainerStyles=Object(l.__assign)(Object(l.__assign)({},n.suggestionContainerStyles),{backgroundColor:n.themeColors.neutralLighterAlt}),n.suggestionChoiceGroupStyles={display:"flex",flexDirection:"row",paddingTop:"6px",paddingBottom:"10px",paddingRight:t.critiqueMargin,paddingLeft:t.critiqueMargin},n.suggestionChoiceItemStyles={display:"flex",paddingBottom:"12px"},n.suggestionShimmerTitleStyles={root:{paddingBottom:"3px"}},n.suggestionShimmerDescriptionStyles={root:{paddingBottom:"3px"}},n.suggestionShimmerFlexStyles={padding:"6px"},n.footerDialogStyles=Object(l.__assign)(Object(l.__assign)({},n.footerStyles),{flexDirection:"column",height:"auto"}),n.footerDialogButtonGroupStyles={display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"44px"},n.footerDefaultActionStyles={display:"flex"},n.similarityHeaderStyles={color:n.themeColors.neutralPrimary,fontSize:10,fontWeight:600,fontFamily:Io},n.similarityHeaderFeedbackStyles=Object(l.__assign)(Object(l.__assign)({},n.similarityHeaderStyles),{fontSize:20,color:n.themeColors.neutralPrimary}),n.similaritySourceTitleStyles={display:"block",marginTop:"6px",marginBottom:"1px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,fontSize:12,fontWeight:600,color:n.themeColors.neutralSecondary,fontFamily:Io},n.similaritySourceUrlStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,textAlign:n.isRightToLeft?"right":"left",fontFamily:Io,fontSize:10,color:n.themeColors.neutralSecondaryAlt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.chooseSourceHeaderStyles={color:n.themeColors.neutralSecondaryAlt,fontSize:12,fontFamily:Io},n.chooseSourceSourceSnippetStyles={style:{display:"block",marginLeft:n.isRightToLeft?t.critiqueMargin:"0px",marginTop:t.critiqueMargin,marginBottom:t.critiqueMargin,marginRight:n.isRightToLeft?"0px":t.critiqueMargin,fontFamily:Io,overflow:"hidden",maxHeight:"38px",fontSize:12,color:n.themeColors.neutralSecondaryAlt}},n.webkitChooseSourceSourceSnippetStyles={style:{display:"-webkit-box",marginLeft:n.isRightToLeft?t.critiqueMargin:"0px",marginTop:t.critiqueMargin,marginBottom:t.critiqueMargin,marginRight:n.isRightToLeft?"0px":t.critiqueMargin,fontFamily:Io,overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontSize:12,color:n.themeColors.neutralSecondaryAlt}},n.chooseSourceSourceTitleStyles={display:"block",marginBottom:"1px",marginRight:n.isRightToLeft?"0px":t.critiqueMargin,marginLeft:n.isRightToLeft?t.critiqueMargin:"0px",fontSize:14,fontWeight:600,color:n.themeColors.neutralSecondaryAlt,fontFamily:Io},n.chooseSourceSourceUrlStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:n.isRightToLeft?"0px":t.critiqueMargin,marginLeft:n.isRightToLeft?t.critiqueMargin:"0px",textAlign:n.isRightToLeft?"right":"left",fontFamily:Io,fontSize:12,color:n.themeColors.neutralSecondaryAlt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.similaritySourcesStyles={root:{display:"flex",paddingLeft:"12px",paddingRight:"12px",fontSize:"12px",backgroundColor:"transparent",color:n.themeColors.themePrimary,border:"solid 1px transparent",width:"100%",selectors:(o={},o[Oo.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},o)},rootHovered:{backgroundColor:n.themeColors.neutralLighterAlt,color:n.themeColors.themePrimary,border:"solid 1px transparent"},rootFocused:Object(l.__assign)(Object(l.__assign)({},ko),{border:"solid 1px ".concat(n.themeColors.themeDarkAlt),borderRadius:"0px"})},n.similaritySourceBackButtonStyles={root:{display:"flex",paddingLeft:"3px",paddingRight:"3px",marginBottom:"5px",minWidth:"30px",fontSize:"12px",backgroundColor:"transparent",color:n.themeColors.themePrimary,border:"solid 1px transparent",selectors:(i={},i[Oo.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},i)},rootHovered:{backgroundColor:n.themeColors.neutralLighterAlt,color:n.themeColors.themePrimary,border:"solid 1px transparent"},rootPressed:{backgroundColor:n.themeColors.neutralLighter,color:n.themeColors.themePrimary,border:"solid 1px transparent"},rootFocused:Object(l.__assign)(Object(l.__assign)({},ko),{border:"solid 1px ".concat(n.themeColors.themeDarkAlt),borderRadius:"0px"})},n.similaritySourceChoiceStyle={display:"flex",textAlign:n.isRightToLeft?"right":"left"},n.footerNextPrevStyles={display:"flex"},n.footerDialogButtonStyle={root:{marginLeft:"6px",marginRight:"6px"}},n.footerDialogDefaultButtonStyle={root:{marginLeft:"6px",marginRight:"6px",backgroundColor:n.themeColors.themeSecondary,color:jo},rootHovered:{backgroundColor:n.themeColors.themeSecondary,color:jo},rootPressed:{backgroundColor:n.themeColors.themeSecondary,color:jo}},n.footerRightIconName="ChevronRight",n.footerLeftIconName="ChevronLeft",n.linkStyle={root:{fontSize:"12px",width:"100%",marginLeft:"8px",marginRight:"8px",marginBottom:"16px",color:n.themeColors.themeDarkAlt,":hover":{color:n.themeColors.themeDark},":focus":{color:n.themeColors.themeDarkAlt},":press":{color:n.themeColors.themeDarker}}},n.privacyStatementStyle={style:{fontSize:"12px",marginLeft:"8px",marginRight:"8px",marginBottom:"2px"}},n.rewriteReportedSuggestionButtonStyles=Object(l.__assign)(Object(l.__assign)({},n.suggestionButtonStyles),{icon:{fontSize:"18px",height:"auto",margin:"4px"},label:{margin:"4px"},flexContainer:{alignItems:"center"}}),n.rewriteCommentsBoxStyles={description:{},errorMessage:{},field:{backgroundColor:n.themeColors.white,color:n.themeColors.neutralPrimary,border:"1px solid ".concat(n.themeColors.neutralSecondaryAlt),"::placeholder":{color:n.themeColors.neutralSecondaryAlt},":disabled":{backgroundColor:n.themeColors.neutralLighterAlt,borderColor:n.themeColors.neutralLighterAlt,"::placeholder":{color:n.themeColors.neutralTertiaryAlt}}},fieldGroup:{border:"0px",outline:"0px"},icon:{},prefix:{},root:{marginTop:"7px",marginBottom:"16px",marginLeft:"8px",marginRight:"8px"},subComponentStyles:{label:{}},suffix:{},wrapper:{},revealButton:{},revealIcon:{},revealSpan:{}},n.includeCitedContentOptionStyles=Object(l.__assign)(Object(l.__assign)({},n.rewriteCommentsBoxStyles),{root:{marginTop:"24px",marginBottom:"8px",marginLeft:"8px",marginRight:"8px"}}),n.citationSourceLineStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,textAlign:n.isRightToLeft?"right":"left",fontFamily:Io},n.poweredByBingStyles={marginTop:"1px",marginLeft:n.isRightToLeft?"0px":"8px",marginRight:n.isRightToLeft?"8px":"0px",fontSize:10,color:n.themeColors.neutralSecondaryAlt,whiteSpace:"nowrap"},n.citationLinkStyles={display:"block",fontSize:12,fontWeight:600,color:n.themeColors.neutralSecondary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.citationLinkFeedbackStyles=Object(l.__assign)(Object(l.__assign)({},n.citationLinkStyles),{fontWeight:0,color:n.themeColors.neutralDark}),n.citationDropdownIconName="ChevronDown",n.citationCheckmarkIconName="CheckMark",n.citationCheckmarkIconStyles={root:{fontSize:16,color:n.themeColors.neutralSecondary,background:"transparent",padding:"0px",margin:n.isRightToLeft?"0px 0px 0px 8px":"0px 8px 0px 0px"}},n.citationOverflowActionButtonStyles=Object(l.__assign)(Object(l.__assign)({},n.overflowActionButtonStyles),{root:Object(l.__assign)(Object(l.__assign)({},n.overflowActionButtonRootStyles),{width:"140px"})}),n.citationNoIconOverflowActionButtonStyles=Object(l.__assign)(Object(l.__assign)({},n.overflowActionButtonStyles),{root:Object(l.__assign)(Object(l.__assign)({},n.overflowActionButtonRootStyles),{padding:n.isRightToLeft?"8px 36px 8px 12px":"8px 12px 8px 36px",width:"140px"})}),n.citationFooterOverflowMenuStyleProvider=new zo(n.isRightToLeft),n.deleteIconName="Delete",n.deleteIconStyles={root:{paddingRight:"8px",fontSize:16,color:n.themeColors.neutralDark}},n.copyCitationIconName="Copy",n.copyCitationIconStyles={root:{paddingRight:"8px",fontSize:16,color:n.themeColors.neutralDark}},n.inTextCitationIconName="Add",n.inTextCitationIconStyles={root:{paddingRight:"8px",fontSize:16,color:n.themeColors.neutralDark}},n.feedbackIconStyles={root:{fontSize:16,color:n.themeColors.neutralSecondaryAlt,margin:"0px"}},n.feedbackIconProps={iconName:"Feedback",styles:n.feedbackIconStyles},n}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return this.defaultHeaderStyles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{backgroundColor:this.themeColors.white,display:"flex",minWidth:"248px",maxWidth:"380px",flexDirection:"column",outline:"transparent solid 1px"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerStyles",{get:function(){return{margin:"2px 8px 2px 8px",display:"flex",justifyContent:"space-between",height:"44px"}},enumerable:!1,configurable:!0}),t}(Uo),Yo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suggestionTitleStyles={style:Object(l.__assign)(Object(l.__assign)({},t.defaultTitleStyles),{marginBottom:"0px",color:t.themeColors.neutralDark})},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{backgroundColor:this.themeColors.white,display:"flex",minWidth:"370px",maxWidth:"380px",flexDirection:"column",outline:"transparent solid 1px"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return Object(l.__assign)(Object(l.__assign)({},this.defaultHeaderStyles),{display:"flex",justifyContent:"space-between"})},enumerable:!1,configurable:!0}),t}(Qo),Xo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return Object(l.__assign)(Object(l.__assign)({},this.defaultHeaderStyles),{display:"flex",justifyContent:"space-between"})},enumerable:!1,configurable:!0}),t}(Qo),Jo=function(e){this.styleProviderOptions=e,this.themeColors=Lo().palette,this.contextualMenuStyles={root:{direction:this.styleProviderOptions.isRightToLeft?"rtl":"ltr",borderRadius:4,boxShadow:"0px 8px 24px 0px rgba(0, 0, 0, 0.1), 0px 8px 16px 0px rgba(0, 0, 0, 0.12)",backgroundColor:this.themeColors.white,width:"auto",borderWidth:0,outline:"transparent solid 1px",marginLeft:this.styleProviderOptions.alignInnerTextWithAnchor?this.styleProviderOptions.isRightToLeft?Qo.critiqueMargin:-Qo.critiqueMargin:void 0,marginTop:4,marginBottom:4},beakCurtain:{borderRadius:4},calloutMain:{borderRadius:4}},this.focusTrapStyles={backgroundColor:this.themeColors.white},this.styleProviderOptions.allowContentOverflow?this.contextualMenuStyles.calloutMain=Object(l.__assign)(Object(l.__assign)({},this.contextualMenuStyles.calloutMain),{overflow:"inherit"}):this.focusTrapStyles=Object(l.__assign)(Object(l.__assign)({},this.focusTrapStyles),{overflow:"hidden"}),this.styleProviderOptions.customScrollbarUsed&&(this.contextualMenuStyles.calloutMain=Object(l.__assign)(Object(l.__assign)({},this.contextualMenuStyles.calloutMain),{overflow:"hidden"}))},Ko=o(934),$o={":after":{outline:"none !important",border:"1px solid ".concat(Lo().palette.neutralPrimaryAlt," !important"),borderRadius:"4px",boxShadow:"none !important"},":hover":{border:"none !important"}},ei={selectors:(qo={},qo[Oo.l]={background:"Highlight",boxShadow:"none !important"},qo)},ti=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.overflowButtonStyles={root:Object(l.__assign)({minHeight:"32px",minWidth:"32px",height:"32px",width:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent"},$o),rootHovered:{borderRadius:"2px",backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{width:"32px",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},ko)},t}return Object(l.__extends)(t,e),t}(Po),oi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contextStyles={style:{display:"block",margin:"2px 16px 8px 16px",fontSize:12,minHeight:16,color:t.themeColors.neutralSecondaryAlt,fontFamily:Io}},t.bottomAlignedOverflowMenuStyleProvider=new ti(!1),t.footerActionsStyleWrapper={display:"flex"},t.footerActionsLeftStyle={marginTop:"6px",marginLeft:t.isRightToLeft?"0px":"6px",marginRight:t.isRightToLeft?"6px":"0px",display:"flex"},t.footerActionsRightStyle={display:"flex",marginLeft:t.isRightToLeft?"6px":"auto",marginRight:t.isRightToLeft?"auto":"6px",marginTop:"6px",alignItems:"stretch"},t.footerButtonStyles={root:Object(l.__assign)({minHeight:"32px",height:"32px",width:"32px",border:"none",padding:"0px",backgroundColor:"transparent"},$o),rootHovered:{backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{width:"32px",outline:"transparent solid 1px",minHeight:"32px"},rootDisabled:{backgroundColor:t.themeColors.white},rootFocused:Object(l.__assign)({},ko),label:{fontSize:14,color:t.themeColors.neutralSecondaryAlt,fontFamily:Io,fontWeight:"normal",margin:"0px"},labelDisabled:{color:t.themeColors.neutralTertiaryAlt}},t.footerIconStyles={root:{fontSize:16,color:t.themeColors.neutralSecondary,background:"transparent",padding:"8px 0px 0px 0px",margin:"0px"}},t.disabledFooterIconStyles={root:{fontSize:16,color:t.themeColors.neutralQuaternaryAlt,background:"transparent",padding:"8px 0px 0px 0px",margin:"0px"}},t.actionButtonStyles={root:Object(l.__assign)({minHeight:"32px",height:"32px",width:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent"},$o),rootHovered:{borderRadius:"2px",backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{width:"16px",height:"16px",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},ko),rootDisabled:{backgroundColor:"transparent"},menuIcon:{height:"16px",width:"16px"}},t.nextButtonStyles={root:{minHeight:"24px",height:"24px",minWidth:"45px",border:"none",margin:"4px 2px 0px 10px",padding:"0px",background:t.themeColors.themePrimary,borderRadius:"4px"},rootHovered:{backgroundColor:t.themeColors.themeDarkAlt},rootPressed:{backgroundColor:t.themeColors.themeDarker},label:{fontSize:"12px",fontWeight:"normal",lineHeight:"16px"},rootFocused:Object(l.__assign)({},ei)},t.viewOriginalButtonFocusSelectorStyle={":after":{outline:"none !important",border:"none !important",boxShadow:"0 0 0 1px ".concat(t.themeColors.themePrimary," inset !important"),inset:"0px !important"},":hover":{border:"none !important"}},t.viewOriginalButtonStyles=Object(Ko.c)((function(e){return void 0===e&&(e=!1),e?{root:Object(l.__assign)({minHeight:"32px",height:"32px",width:"32px",margin:"0px",padding:"0px",border:"none",backgroundColor:t.themeColors.themeLight},t.viewOriginalButtonFocusSelectorStyle),rootHovered:{backgroundColor:t.themeColors.themeLighter},rootPressed:{backgroundColor:t.themeColors.themeLighter},flexContainer:{width:"16px",height:"16px",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},ko),menuIcon:{height:"16px",width:"16px"}}:t.actionButtonStyles})),t.defaultIconStyles={root:{background:"transparent",fontSize:"14px",height:"14px",width:"14px",margin:"0px",padding:"1px"}},t.acceptIconStyles=Object(Ko.c)((function(e){return void 0===e&&(e=!1),{root:Object(l.__assign)(Object(l.__assign)({},t.defaultIconStyles.root),{color:e?t.themeColors.neutralTertiaryAlt:t.themeColors.greenDark})}})),t.rejectIconStyles=Object(Ko.c)((function(e){return void 0===e&&(e=!1),{root:Object(l.__assign)(Object(l.__assign)({},t.defaultIconStyles.root),{color:e?t.themeColors.neutralTertiaryAlt:t.themeColors.orange})}})),t.viewOriginalIconStyles=Object(Ko.c)((function(e){return void 0===e&&(e=!1),{root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px",margin:"0px",color:e?t.themeColors.themePrimary:void 0}}})),t.giveFeedbackIconStyles={root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px",margin:"0px",color:t.themeColors.neutralSecondaryAlt}},t.overflowActionIconStyles={root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px"}},t.overflowActionButtonStyles={root:{margin:"0px 4px",padding:"8px 8px 8px 2px",backgroundColor:"transparent",borderWidth:"0px",minHeight:"36px",height:"36px",minWidth:"130px",width:"max-content"},rootHovered:{backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},rootDisabled:{backgroundColor:t.themeColors.white},rootFocused:Object(l.__assign)({},ko),flexContainer:{outline:"transparent solid 1px",alignItems:"center",height:"20px"},label:{fontSize:14,color:t.themeColors.neutralSecondaryAlt,fontFamily:Io,fontWeight:"normal",margin:"0px"},labelDisabled:{color:t.themeColors.neutralTertiaryAlt},textContainer:{textAlign:t.isRightToLeft?"right":"left"}},t.openPaneIconStyle={root:{fontSize:"18px",background:"transparent",padding:"0px 6px",margin:"0px"}},t.openPaneButtonStyle={root:Object(l.__assign)({minHeight:"32px",height:"32px",minWidth:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent"},$o),rootHovered:{borderRadius:"2px",backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{minWidth:"32px",alignItems:"center",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},ko),label:{fontWeight:600,fontFamily:Io,fontSize:"14px",lineHeight:"20px",color:t.themeColors.themePrimary,whiteSpace:"normal",overflowWrap:"anywhere",padding:"6px 0px",paddingRight:"6px",margin:"0px"}},t.externalWrapperStyles={display:"flex",flexDirection:"column",height:"auto",width:"max-content"},t.promptStyles={display:"flex",flexDirection:"column",padding:"8px 16px 12px 16px",textAlign:"left",color:t.themeColors.neutralPrimary,fontFamily:Io,fontSize:12,minHeight:16,backgroundColor:t.themeColors.themeLighterAlt,width:"".concat(t.cardWidth-32,"px")},t.promptIconStyleWrapper={width:"20px",marginRight:"6px"},t.promptIconStyle={root:{background:"transparent",width:"20px",height:"20px"}},t.promptBodyIconStyle={root:{background:"transparent",width:"14px",height:"14px"}},t.promptStyleWrapper={display:"flex"},t.promptTextStyleWrapper={display:"flex",flexDirection:"column"},t.promptTextHeadingStyle={fontWeight:600,paddingBottom:"4px"},t.promptTextBodyStyle={fontWeight:400},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"cardWidth",{get:function(){return 250},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{width:"".concat(this.cardWidth,"px"),display:"flex",flexDirection:"column",borderRadius:4}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return{display:"flex",flexDirection:"column",padding:"2px 0px 0px",position:"static",width:"".concat(this.cardWidth-32,"px"),minHeight:"17px",flex:"none",order:0,flexGrow:0,margin:"10px 16px 6px 16px",fontFamily:Io,fontSize:"12px",lineHeight:"16px",color:this.themeColors.neutralPrimaryAlt}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerStyles",{get:function(){return{display:"flex",flexDirection:"column",width:"".concat(this.cardWidth,"px"),height:"44px"}},enumerable:!1,configurable:!0}),t}(Uo),ii={":after":{outline:"none !important",border:"1px solid ".concat(Lo().palette.neutralPrimaryAlt," !important"),borderRadius:"4px",boxShadow:"none !important"},":hover":{border:"none !important"}},ni={":after":{border:"4px solid ".concat(Lo().palette.neutralLighter," !important"),borderRadius:"4px",outline:"none !important",boxShadow:"none",marginTop:"1px"},":hover":{outline:"none !important"}},ri={selectors:(Go={},Go[Oo.l]={color:"windowText !important",":hover":{color:"Highlight !important",border:"none !important",outline:"none !important"},":focus-within":{color:"Highlight !important"},":active":{color:"Highlight !important"}},Go)},si={selectors:(Zo={},Zo[Oo.l]={border:"4px solid windowText !important",borderRadius:"2px",background:"transparent",color:"windowText !important",":hover":{background:"transparent",outline:"none !important"},":after":{outline:"none !important",border:"1px solid Highlight !important",borderRadius:"4px",boxShadow:"none !important",margin:"0px"},":focus-within":{background:"transparent !important",color:"Highlight !important"},":active":{background:"transparent"}},Zo)},ai={selectors:(Vo={},Vo[Oo.l]={color:"windowText !important",":hover":{background:"transparent",border:"none !important",outline:"none !important",color:"Highlight !important"},":after":{outline:"none !important",background:"transparent !important",border:"1px solid Highlight !important",borderRadius:"4px",boxShadow:"none !important"},":focus-within":{background:"transparent !important",color:"Highlight !important"}},Vo)},li={":active":{backgroundColor:Eo.neutralLighter},":hover":{backgroundColor:Eo.neutralLighterAlt}},ci={position:"absolute",height:"100%",width:"calc(100% - 12px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},ui=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.triageButtonStyles={root:{display:"block",margin:"4px 16px 4px 16px",height:"32px",maxHeight:"32px",padding:"0px",border:"none",backgroundColor:Eo.white},rootHovered:{backgroundColor:Eo.neutralLighterAlt},rootExpanded:{backgroundColor:Eo.neutralLighterAlt},rootPressed:{backgroundColor:Eo.neutralLighter},rootDisabled:{backgroundColor:Eo.neutralLighterAlt},flexContainer:{justifyContent:t.isRightToLeft?"right":"left",border:"1px solid ".concat(t.themeColors.neutralQuaternary),boxSizing:"border-box",borderRadius:"4px"},textContainer:{flexGrow:0,textAlign:t.isRightToLeft?"right":"left",width:"186px",height:"32px"},menuIcon:{fontSize:14,height:"14px",width:"14px",padding:"1px",margin:"8px",color:Eo.neutralSecondaryAlt},rootFocused:Object(l.__assign)({},ko)},t.triageCalloutStyles={root:{width:"206px",marginLeft:t.isRightToLeft?"0px":"6px",marginRight:t.isRightToLeft?"6px":"0px",marginTop:"32px",background:t.themeColors.white,borderRadius:"4px !important",boxShadow:"0px 14px 28.8px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",selectors:{"div::-webkit-scrollbar":{width:"7px",height:"107px",minWidth:"7px !important"},"div::-webkit-scrollbar-thumb":{borderRadius:"100px",border:"1px solid ".concat(t.themeColors.white," !important"),background:t.themeColors.neutralQuaternaryAlt}}},calloutMain:{borderRadius:"4px !important",maxHeight:"236px !important"}},t.triageContextualMenuStyles={root:{borderRadius:"4px",minWidth:"161px"}},t.triageContextualMenuSelectedItemStyles={item:{position:"static",height:"40px",backgroundColor:Eo.white,selectors:li},label:Object(l.__assign)({},ri),root:Object(l.__assign)(Object(l.__assign)({display:"flex",textAlign:t.isRightToLeft?"right":"left",border:"4px solid ".concat(Eo.neutralLighter," !important"),height:"40px"},ni),si)},t.triageContextualMenuItemStyles={item:{height:"40px",backgroundColor:Eo.white,selectors:li},label:Object(l.__assign)({},ri),root:Object(l.__assign)(Object(l.__assign)({display:"flex",textAlign:t.isRightToLeft?"right":"left",borderRadius:"4px",backgroundColor:"transparent"},ii),ai),divider:{margin:"1px 0"}},t.menuItemSpanStyles=Object(l.__assign)(Object(l.__assign)({},ci),{marginLeft:t.isRightToLeft?"0px":"6px",marginRight:t.isRightToLeft?"6px":"0px"}),t.menuSelectedItemSpanStyles=Object(l.__assign)(Object(l.__assign)({},ci),{marginLeft:t.isRightToLeft?"0px":"4px",marginRight:t.isRightToLeft?"4px":"0px"}),t}return Object(l.__extends)(t,e),t}(oi),pi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.columnCount=1,t.showMoreLinkClassName=Object(Oo.db)({font:"Segoe UI",fontSize:"12",color:t.themeColors.themePrimary,lineHeight:16}),t.imageSuggestionGalleryClassName=Object(Oo.db)({padding:"6px 14px 0px 14px"}),t.galleryButtonRootStyles=Object(Ko.c)((function(e){return{height:54,width:180,marginBottom:6,marginLeft:e?0:6,marginRight:0,padding:0,border:"2px solid transparent !important"}})),t.galleryButtonStyles=Object(Ko.c)((function(e){return{root:t.galleryButtonRootStyles(0===e),rootFocused:{border:"2px solid ".concat(t.themeColors.black," !important")},rootHovered:{border:"2px solid ".concat(t.themeColors.themePrimary," !important")},rootPressed:{border:"4px solid ".concat(t.themeColors.themePrimary," !important")},rootChecked:{border:"4px solid ".concat(t.themeColors.themePrimary," !important")}}})),t.externalWrapperStyles={display:"flex",flexDirection:"row",width:"auto"},t.promptStyles={display:"flex",flexDirection:"column",padding:"16px 12px",textAlign:"left",width:"130px",color:t.themeColors.neutralPrimary,fontFamily:Io,fontSize:12,minHeight:16,backgroundColor:t.themeColors.themeLighterAlt},t.promptIconStyleWrapper={width:"20px",marginBottom:"6px"},t.promptStyleWrapper={display:"flex",flexDirection:"column"},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"cardWidth",{get:function(){return 0===this.columnCount?250:212+186*(this.columnCount-1)},enumerable:!1,configurable:!0}),t}(oi),di=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultHeaderStyles={display:"block",marginTop:"8px",marginRight:"16px",marginLeft:"16px",height:"32px",fontSize:14,color:t.themeColors.neutralDark,fontFamily:Io,fontWeight:600},t.suggestionButtonStyles={root:{display:"block",border:"none",padding:"0px 0px 0px 0px",width:"183px",maxWidth:"183px",minHeight:"32px",maxHeight:"32px",backgroundColor:t.themeColors.white,marginLeft:"16px",marginRight:"8px"},rootHovered:{backgroundColor:t.themeColors.white,borderColor:t.themeColors.white},rootPressed:{backgroundColor:t.themeColors.white,borderColor:t.themeColors.white},flexContainer:{height:"32px",justifyContent:t.isRightToLeft?"right":"left",boxSizing:"border-box"},textContainer:{flexGrow:0,padding:"6px 0px 6px 0px",textAlign:t.isRightToLeft?"right":"left",width:"183px",height:"32px"},label:{fontSize:14,color:t.themeColors.neutralDark,fontFamily:Io,margin:"0px",fontWeight:400,whiteSpace:"nowrap"}},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return this.defaultHeaderStyles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{minWidth:"199px",height:"241px",display:"flex",flexDirection:"column",outline:"#E0E0E0 solid 1px",outlineOffset:"-4px",borderRadius:"4px",backgroundColor:this.themeColors.white}},enumerable:!1,configurable:!0}),t.prototype.compoundButtonIconName=function(e){},t}(No);var gi,hi,mi=o(1334),yi=function(e){function t(o){var i=e.call(this,o)||this;return i.state={menuOpen:!1,disabled:!1},i.buttonId="OverflowMenu"+t.ids,t.ids+=1,i.onButtonClick=i.onButtonClick.bind(i),i.closeMenu=i.closeMenu.bind(i),i.buttonRef=C.createRef(),i}return Object(l.__extends)(t,e),t.prototype.enableButton=function(){this.setState((function(){return{disabled:!1}}))},t.prototype.disabledButton=function(){this.setState((function(){return{disabled:!0}}))},t.prototype.focusButton=function(){this.buttonRef.current&&this.buttonRef.current.focus()},t.prototype.openMenu=function(){this.setState((function(){return{menuOpen:!0}})),this.props.onShow&&this.props.onShow()},t.prototype.closeMenu=function(e){this.setState((function(){return{menuOpen:!1}})),e&&this.focusButton(),this.props.onDismiss&&this.props.onDismiss()},t.prototype.render=function(){return this.state.menuOpen?C.createElement("div",null,this.renderOverflowMenuButton(),this.renderOverflowMenuCallout()):C.createElement("div",null,this.renderOverflowMenuButton())},t.prototype.onButtonClick=function(){this.state.menuOpen?this.closeMenu(!0):this.openMenu()},t.prototype.renderOverflowMenuButton=function(){var e={text:this.props.text?this.props.text:void 0,id:this.buttonId,ariaLabel:this.props.ariaLabel?this.props.ariaLabel:this.props.resources.OverflowButtonAccessibilityLabel,role:this.props.role?this.props.role:"button",styles:this.props.styleProvider.overflowButtonStyles,onClick:this.onButtonClick,iconProps:{iconName:this.props.iconName?this.props.iconName:this.props.styleProvider.overflowIconName,styles:this.props.styleProvider.iconStyles},componentRef:this.buttonRef,disabled:this.state.disabled};return C.createElement(mi.a,Object(l.__assign)({},e,{"data-automation-id":"OverflowMenu_Automation_".concat(t.ids)}))},t.prototype.renderOverflowMenuCallout=function(){var e={role:"menu",styles:this.props.styleProvider.overflowMenuStyles,target:"#"+this.buttonId,isBeakVisible:!1,directionalHint:this.props.styleProvider.isRightToLeft?v.a.bottomRightEdge:v.a.bottomLeftEdge,onDismiss:this.closeMenu,setInitialFocus:!0},t={isCircularNavigation:!0,handleTabKey:Y.b.all};return C.createElement(b.a,Object(l.__assign)({},e),C.createElement(Q.a,Object(l.__assign)({},t),this.props.children))},t.ids=0,t}(C.PureComponent),fi=function(e){function t(t){var o=e.call(this,t)||this;return o.suggestionsFocusZoneRef=C.createRef(),o.onAction=o.onAction.bind(o),o.restoreFocus=o.restoreFocus.bind(o),o.footerOpenOverflowMenuRef=C.createRef(),o}return Object(l.__extends)(t,e),t.prototype.render=function(){var e=this.renderHeader();return C.createElement("div",Object(l.__assign)({style:this.props.styleProvider.suggestionGroupStyles},this.rootAttributes(!!e)),e,this.renderSuggestions(),this.renderFooter())},t.prototype.maximumSuggestions=function(){return 3},t.prototype.headerId=function(){return t.createHeaderId(this.props.group.type)},t.createHeaderId=function(e){return"header-".concat(e)},t.prototype.rootAttributes=function(e){var t={};return this.props.parameters.definition&&this.props.parameters.definition.suggestionGroups&&this.props.parameters.definition.suggestionGroups.length>1&&(t.role="listitem"),e?t["aria-labelledby"]=this.headerId():t["aria-label"]=this.headerText(),t},t.prototype.renderHeader=function(){return C.createElement("div",{id:this.headerId(),role:"note","aria-label":this.headerText(),style:this.props.styleProvider.headerStyles},this.headerText())},t.prototype.getSuggestionsToRender=function(){return this.props.group.suggestions},t.prototype.getSuggestionsRole=function(){return this.maximumSuggestions()>1?"list":"group"},t.prototype.getSuggestionItemRole=function(){return this.maximumSuggestions()>1?"listitem":null},t.prototype.renderSuggestions=function(){var e=this,t=this.getSuggestionsToRender();if(t){var o=this.maximumSuggestions(),i=t.filter((function(e){return!!e})).map((function(t,o){return e.renderSuggestionItem(t,o)})).filter((function(e,t){return!!e&&t<o}));if(i.length>0){var n=this.getSuggestionsRole();return C.createElement(Q.a,{componentRef:this.suggestionsFocusZoneRef},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:n,"aria-label":this.suggestionListDescription()},i))}}return null},t.prototype.renderSuggestionItem=function(e,t){var o=this.renderSuggestion(e,t);if(!o)return null;var i=this.getSuggestionItemRole();return C.createElement("div",{key:e.id,role:i||void 0},o)},t.prototype.renderSuggestion=function(e,t){return null},t.prototype.renderFooter=function(){return null},t.prototype.renderProactivePrompt=function(){return null},t.prototype.renderOverflowActions=function(){return[]},t.prototype.renderOverflowMenu=function(){var e=this.renderOverflowActions();if(0===e.length)return null;var t={styleProvider:this.props.styleProvider.bottomAlignedOverflowMenuStyleProvider,resources:this.props.resources,ref:this.footerOpenOverflowMenuRef};return C.createElement(yi,Object(l.__assign)({},t,{key:"overflow-menu"}),C.createElement("div",{style:this.props.styleProvider.footerOverflowContainerStyles},e))},t.prototype.renderPreviewPillbox=function(){return C.createElement("div",{style:this.props.styleProvider.previewHeaderStyles},this.props.resources.PreviewHeaderLabel)},t.prototype.restoreFocus=function(){this.props.hostElementRef&&this.props.hostElementRef.current&&this.props.hostElementRef.current.focus()},t.prototype.shouldDismissOnAction=function(e){return![co.GiveFeedback,co.Report,co.ShowExplanation,co.Toggle,co.AddToDictionary].includes(e)},t.prototype.executeDefaultAction=function(){var e=this.getSuggestionsToRender();if(e){var t=e[0];t&&this.onAction(null,co.Apply,lo.Try,this.props.group,t,void 0)}},t.prototype.executeActionFromString=function(e){var t,o=e.toLowerCase(),i={actionSourceId:n.VoiceDictationPhrase};switch(o){case"ignore":case"ignore once":return void this.onAction(null,co.IgnoreOnce,lo.Try,this.props.group,void 0,void 0,void 0,i);case"ignore all":return void this.onAction(null,co.IgnoreAll,lo.Try,this.props.group,void 0,void 0,void 0,i);default:var r=this.getSuggestionsToRender(),s=null==r?void 0:r.find((function(e){var t;return(null===(t=null==e?void 0:e.title)||void 0===t?void 0:t.toLowerCase())===o}));return s||"SharedRepeatedWordCritique"!==(null===(t=this.props.group)||void 0===t?void 0:t.type)||1!==(null==r?void 0:r.length)||"delete"!==o||(s=r[0]),void(s?this.onAction(null,co.Apply,lo.Try,this.props.group,s,void 0,void 0,i):this.props.dismiss?this.props.dismiss(i):u.a.sendTraceTag(526513923,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unknown command and unable to dismiss"))}},t.prototype.invokeBadgeId=function(e){},t.prototype.onAction=function(e,t,o,i,r,s,a,l){if(this.props.parameters.onAction){var c=this.props.parameters.definition,u=r?r.telemetryData:null,p=i.telemetryData,d={actionType:t,engagement:o,objectName:i?i.type:"Unknown",objectId:i?i.id:"Unknown",objectFulfillment:s||(r?r.type:"Unknown"),contentReference:{range:i?i.contentDescriptor:void 0,contentId:c?c.contentId:void 0,contentHash:c?c.contentHash:void 0},data:u||p,suggestionGroup:i,suggestion:r,descriptorData:a},g=null!=l?l:{actionSourceId:n.Unknown};this.props.dependencies.actionLogger.logAction(d,g),this.props.parameters.onAction(d)&&(e&&(e.preventDefault(),e.stopPropagation()),this.shouldDismissOnAction(t)&&this.props.dismiss(g))}},t}(C.Component),bi=o(873),vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.headerText=function(){return""},t.prototype.maximumSuggestions=function(){return 5},t.prototype.suggestionListDescription=function(){return""},t.prototype.renderHeader=function(){return null},t.prototype.renderSuggestion=function(e,t){var o=this,i={allowDisabledFocus:!0,text:e.title,styles:this.props.styleProvider.suggestionButtonStyles,iconProps:{iconName:this.props.styleProvider.compoundButtonIconName(e),styles:this.props.styleProvider.suggestionButtonIconStyles},onClick:function(t){return o.onAction(t,co.Apply,lo.Try,o.props.group,e)}};return C.createElement(bi.a,Object(l.__assign)({key:e.id},i))},t.id="ActionSet",t}(fi),Si=o(1324),xi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.renderBold=function(e,t){switch(t){case uo.Normal:e.fontWeight="normal";break;case uo.Bold:e.fontWeight="bold"}},t.prototype.renderHidden=function(e){e.position="absolute",e.height="1px",e.width="1px",e.overflow="hidden",e.clip="rect(1px 1px 1px 1px)"},t.prototype.renderUnderline=function(e,t){var o=!1;switch(t){case po.Single:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmxpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iVGlsZS1Db3B5IiBzdHJva2U9IiMwMDAwMDAiPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwLjUgTDUsMC41IiBpZD0iTGluZS0yLUNvcHktMTAiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",o=!0;break;case po.Double:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmRvdWJsZV9saW5lPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImRvdWJsZV9saW5lIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIGlkPSJUaWxlLUNvcHkiIHN0cm9rZT0iIzAwMDAwMCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",o=!0;break;case po.SpellingSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjRweCIgdmlld0JveD0iMCAwIDUgNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTYuMiAoODE2NzIpIC0gaHR0cHM6Ly9za2V0Y2guY29tIC0tPgogICAgPHRpdGxlPnNwZWxsaW5nX3NxdWlnZ2xlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkZsYWdzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTAxMC4wMDAwMDAsIC0yOTYuMDAwMDAwKSIgaWQ9InNwZWxsaW5nX3NxdWlnZ2xlIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAxMC4wMDAwMDAsIDI5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDMgQzEuMjUsMyAxLjI1LDEgMi41LDEgQzMuNzUsMSAzLjc1LDMgNSwzIiBpZD0iUGF0aCIgc3Ryb2tlPSIjRUIwMDAwIiBzdHJva2Utd2lkdGg9IjEiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",o=!0;break;case po.GrammarSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmdyYW1tYXJfZG91YmxlX2xpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZ3JhbW1hcl9kb3VibGVfbGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iR3JhbW1hci1UaWxlLUNvcHkiIHN0cm9rZT0iIzMzNTVGRiI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",o=!0;break;case po.CritiqueSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIycHgiIHZpZXdCb3g9IjAgMCAxMCAyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Ny4xICg4MzA4OCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+aW5zaWdodF90ZXh0dXJlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imluc2lnaHRfdGV4dHVyZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTItQ29weSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIyIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDEgTDUsMSIgaWQ9IkxpbmUtNCIgc3Ryb2tlPSIjNzE2MEU4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",o=!0}o&&(e.backgroundRepeat="repeat-x",e.backgroundPosition="bottom left",e.borderBottom="solid 1px transparent")},t.prototype.getRunText=function(e,t){var o=this.props.text.length,i=Math.max(0,Math.min(o,e)),n=Math.max(0,Math.min(o,t));return i<n?this.props.text.substr(i,n-i):(u.a.sendTraceTag(595683267,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Canvas contextual trying to fetch invalid substring (start '".concat(e,"', end '").concat(t,"', length '").concat(o,"')")),"")},t.prototype.renderTextRun=function(e,t,o){var i={};return o&&(this.renderBold(i,o.fontWeight),this.renderUnderline(i,o.underlineType),o.hidden&&this.renderHidden(i),o.italic&&(i.fontStyle="italic"),o.cssColor&&(i.color=o.cssColor)),C.createElement("span",{key:e,style:i},this.getRunText(e,t))},t.prototype.render=function(){var e=[];if(this.props.formatting&&this.props.formatting.length>0)for(var t=0,o=0,i=this.props.text.length;t<i;)if(o<this.props.formatting.length){var n=this.props.formatting[o];if(n){var r=n.start,s=r+n.length,a=Math.max(t,Math.min(i,r)),l=Math.max(t,Math.min(i,s));if(a>=l){o+=1;continue}t<a&&(e.push(this.renderTextRun(t,a)),t=a),t<l&&(e.push(this.renderTextRun(t,l,n)),t=l)}o+=1}else t<i&&(e.push(this.renderTextRun(t,i)),t=i);return C.createElement("span",{"aria-label":this.props.ariaLabel,role:this.props.ariaRole,"aria-level":this.props.ariaLevel,style:this.props.style?this.props.style.style:{}},0!==e.length?e:this.props.text)},t}(C.PureComponent),Ci=o(433),Ti=o(1321),Ai=o(614),wi=o(411),Oi=o(971),ki=function(e){function t(t){var o=e.call(this,t)||this;return o.dismissFooterOverflow=o.dismissFooterOverflow.bind(o),o.onShowHideContext=o.onShowHideContext.bind(o),o}return Object(l.__extends)(t,e),t.prototype.suggestionListDescription=function(){return this.props.resources.CritiqueSuggestionListDefaultAccessibilityLabel},t.prototype.shouldHideActionButton=function(e,t){return!this.hasActionType(e,t)},t.prototype.getActionButtonIconProps=function(e){},t.prototype.shouldDisableActionButton=function(e,t){return!1},t.prototype.getActionButtonToRender=function(e,t){return C.createElement(bi.a,Object(l.__assign)({},t))},t.prototype.renderActionButton=function(e,t,o,i,n,r){var s=this;if(this.shouldHideActionButton(e,o))return null;var a=void 0;if(!n&&!(a=this.getActionString(e)))return null;var c={iconProps:this.getActionButtonIconProps(e),text:a,styles:t,disabled:this.shouldDisableActionButton(e,o),role:i||"button",onClick:function(t){return s.onAction(t,e,lo.Try,s.props.group,o,void 0,r)}};return this.getActionButtonToRender(e,Object(l.__assign)(Object(l.__assign)({},c),{key:e.toString(),"data-automation-id":"CritiqueActionButton_".concat(a,"_").concat(this.props.group.id)}))},t.prototype.showingSnippet=function(){return!(!this.props.group.snippet||!this.state.showingContext)},t.prototype.renderShowHideContextButton=function(){var e=this;if(!this.allowShowHideContextButton())return null;var t=this.state.showingContext?this.props.resources.HideContextButtonText:this.props.resources.ShowContextButtonText,o={iconProps:this.getActionButtonIconProps(co.ShowHideContext),text:t,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:function(t){return e.onShowHideContext(t)}};return C.createElement(bi.a,Object(l.__assign)({role:"menuitem",key:"ShowHideContext"},o,{"data-automation-id":"CritiqueActionButton_".concat(t,"_").concat(this.props.group.id)}))},t.prototype.renderSnippet=function(e,t,o){return this.showingSnippet()?C.createElement(xi,{text:null!=t?t:this.props.group.snippet,ariaLabel:null!=t?t:this.props.group.snippet,ariaRole:"heading",ariaLevel:2,formatting:null!=o?o:this.props.group.snippetFormatting,style:null!=e?e:this.props.styleProvider.contextStyles}):null},t.prototype.renderNextPrev=function(){return this.props.parameters.definition.setSize>0?[this.renderNavigationButton(!1),this.renderNavigationButton(!0)]:[]},t.prototype.renderHeader=function(){return C.createElement("div",null,e.prototype.renderHeader.call(this),this.renderSnippet())},t.prototype.renderNavigationButton=function(e){var t=this,o=this.props.isRightToLeft?!e:e,i=o?co.Next:co.Previous,n=e?this.props.parameters.definition.positionInSet>=this.props.parameters.definition.setSize-1:this.props.parameters.definition.positionInSet<=0,r={disabled:n,styles:this.props.styleProvider.footerButtonStyles,iconProps:{iconName:o?this.props.styleProvider.footerRightIconName:this.props.styleProvider.footerLeftIconName,styles:n?this.props.styleProvider.disabledFooterIconStyles:this.props.styleProvider.footerIconStyles},ariaLabel:this.getAriaLabel(i),onClick:function(e){return t.onAction(e,i,lo.Try,t.props.group,void 0,void 0)}},s="CritiqueNavButton_".concat(o?"Right":"Left","_").concat(this.props.group.id);return C.createElement(bi.a,Object(l.__assign)({key:i.toString()},r,{"data-automation-id":s}))},t.prototype.getAriaLabel=function(e){switch(e){case co.Next:return this.props.resources.NextButtonText;case co.Previous:return this.props.resources.PreviousButtonText}},t.prototype.getActionString=function(e){switch(e){case co.IgnoreOnce:return this.props.resources.IgnoreButtonText;case co.IgnoreAll:return this.props.resources.IgnoreAllButtonText;case co.Options:return this.props.resources.OptionsButtonText;case co.Deleted:return this.props.resources.DeleteButtonText;case co.LearnMore:return this.getActionStringForLearnMore();case co.Accepted:return this.props.resources.AcceptButton;case co.Rejected:return this.props.resources.RejectButton;case co.AcceptAll:return this.props.resources.AcceptAllButton;case co.RejectAll:return this.props.resources.RejectAllButton;case co.Next:return this.props.resources.NextButton;case co.Previous:return this.props.resources.PreviousButton;case co.Undo:return this.props.resources.UndoButton;case co.GiveFeedback:return this.props.resources.GiveFeedbackButtonText}},t.prototype.hasActionType=function(e,t){return t?!!t.supportedActions&&-1!==t.supportedActions.findIndex((function(t){return t===e})):!!this.props.group.supportedActions&&-1!==this.props.group.supportedActions.findIndex((function(t){return t===e}))},t.prototype.getActionStringForLearnMore=function(){return this.props.resources.LearnMoreButtonText},t.prototype.onAction=function(t,o,i,n,r,s,a){this.dismissFooterOverflow(),e.prototype.onAction.call(this,t,o,i,n,r,s,a)},t.prototype.onShowHideContext=function(e){this.setState((function(e){return{showingContext:!e.showingContext}})),this.onAction(e,co.Toggle,lo.Try,this.props.group,void 0,"Context")},t.prototype.allowShowHideContextButton=function(){return!(!this.props.group.snippet||!this.props.group.snippetFormatting)},t.prototype.dismissFooterOverflow=function(){this.footerOpenOverflowMenuRef.current&&this.footerOpenOverflowMenuRef.current.closeMenu(!0)},t}(fi),Ii=o(2801);!function(e){e[e.Default=0]="Default",e[e.ReportRewriteSuggestions=1]="ReportRewriteSuggestions",e[e.DisplayingFeedbackOptions=2]="DisplayingFeedbackOptions",e[e.Confirmation=3]="Confirmation"}(gi||(gi={})),function(e){e[e.Default=0]="Default",e[e.DisplayingFeedbackOptions=1]="DisplayingFeedbackOptions",e[e.Confirmation=2]="Confirmation",e[e.DisplayingSimilarSources=3]="DisplayingSimilarSources"}(hi||(hi={}));var _i=function(e){function t(t){var o,i,n=this;return(n=e.call(this,t)||this).privacyStatementLabel=Object(c.h)("IsO365CommercialHost")?n.props.resources.SuggestionFeedbackCommercialPrivacyNotice:n.props.resources.SuggestionFeedbackConsumerPrivacyNotice,n.handleSuggestionFocus=n.handleSuggestionFocus.bind(n),n.handleSuggestionBlur=n.handleSuggestionBlur.bind(n),n.onRewriteSelectFeedbackSuggestion=n.onRewriteSelectFeedbackSuggestion.bind(n),n.onRewriteSelectFeedbackOption=n.onRewriteSelectFeedbackOption.bind(n),n.onShowHideDescription=n.onShowHideDescription.bind(n),n.onShowHideSimilarText=n.onShowHideSimilarText.bind(n),n.onRewriteReportSuggestionCancel=n.onRewriteReportSuggestionCancel.bind(n),n.onRewriteReportSuggestionNext=n.onRewriteReportSuggestionNext.bind(n),n.onRewriteReportSuggestionSend=n.onRewriteReportSuggestionSend.bind(n),n.onRewriteReportSuggestionDone=n.onRewriteReportSuggestionDone.bind(n),n.onSimilaritySelectFeedbackOption=n.onSimilaritySelectFeedbackOption.bind(n),n.onSimilarityFeedbackCancel=n.onSimilarityFeedbackCancel.bind(n),n.onSimilarityFeedbackSubmit=n.onSimilarityFeedbackSubmit.bind(n),n.onSimilarityFeedbackOkay=n.onSimilarityFeedbackOkay.bind(n),n.onSimilarityShareCitedContentCheckbox=n.onSimilarityShareCitedContentCheckbox.bind(n),n.onSimilaritySourceDone=n.onSimilaritySourceDone.bind(n),n.onSimilaritySourceCancel=n.onSimilaritySourceCancel.bind(n),n.rewriteReportSuggestionsChoiceGroupRef=C.createRef(),n.rewriteFeedbackOptionChoiceGroupRef=C.createRef(),n.rewriteCommentsTextBoxRef=C.createRef(),n.rewriteReportDoneButtonRef=C.createRef(),n.similarityCommentsTextBoxRef=C.createRef(),n.similarityFeedbackOptionChoiceGroupRef=C.createRef(),n.similarityFeedbackReportOkayButtonRef=C.createRef(),n.similaritySourceOptionRef=Array.from({length:null!==(i=null===(o=n.props.group.sources)||void 0===o?void 0:o.length)&&void 0!==i?i:0},(function(){return C.createRef()})),n.state={showingContext:n.props.parameters.showSnippet,showingDescription:n.props.parameters.showDescription,hoveredSuggestionId:null,focusedSuggestionId:null,openSuggestionOverflowId:null,rewriteState:gi.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1,selectedCitationStyle:n.props.parameters.citationStyle?n.props.parameters.citationStyle:"MLA",similarityChoiceGroupSelected:!1,similarityState:hi.Default,similarityShareCitedContentCheckbox:!1,showingSimilarText:!1,similaritySelectedSource:"0"},n}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(e,o){if(this.props.group.type===t.neuralRewrite&&o.rewriteState!==this.state.rewriteState)switch(this.state.rewriteState){case gi.ReportRewriteSuggestions:this.rewriteReportSuggestionsChoiceGroupRef.current&&this.rewriteReportSuggestionsChoiceGroupRef.current.focus();break;case gi.DisplayingFeedbackOptions:this.rewriteFeedbackOptionChoiceGroupRef.current&&this.rewriteFeedbackOptionChoiceGroupRef.current.focus();break;case gi.Confirmation:this.rewriteReportDoneButtonRef.current&&this.rewriteReportDoneButtonRef.current.focus();break;default:this.suggestionsFocusZoneRef.current&&this.suggestionsFocusZoneRef.current.focus()}else if(this.props.group.type===t.similarity&&o.similarityState!==this.state.similarityState)switch(this.state.similarityState){case hi.DisplayingFeedbackOptions:this.similarityFeedbackOptionChoiceGroupRef.current&&this.similarityFeedbackOptionChoiceGroupRef.current.focus();break;case hi.Confirmation:this.similarityFeedbackReportOkayButtonRef.current&&this.similarityFeedbackReportOkayButtonRef.current.focus();break;default:this.suggestionsFocusZoneRef.current&&this.suggestionsFocusZoneRef.current.focus()}},t.prototype.hasNoSuggestions=function(){return!this.props.group.suggestions||0===this.props.group.suggestions.length},t.prototype.render=function(){return this.props.group.type===t.neuralRewrite&&this.hasNoSuggestions()?this.renderEmptyNeuralRewrite():this.isSimilarityFeedbackCard()?this.renderFeedbackCard():e.prototype.render.call(this)},t.prototype.isSimilarityFeedbackCard=function(){return this.props.group.type===t.similarity&&this.state.similarityState===hi.DisplayingFeedbackOptions},t.prototype.renderFeedbackCard=function(){var e=this.renderHeader();return C.createElement("div",Object(l.__assign)({style:this.props.styleProvider.suggestionGroupFeedbackStyles},this.rootAttributes(!!e),{role:"alert"}),e,this.renderSuggestions(),this.renderFooter(),this.renderProactivePrompt())},t.prototype.headerText=function(){switch(this.props.group.type){case t.neuralRewrite:if(this.props.group.isContentPending)return this.props.resources.SuggestionsGroupLoadingSuggestionsText;switch(this.state.rewriteState){case gi.Default:return this.props.resources.NeuralRewriteHeaderLabel;case gi.ReportRewriteSuggestions:return this.props.resources.NeuralRewriteFeedbackDialogChooseSuggestionTitle;case gi.DisplayingFeedbackOptions:return this.props.resources.NeuralRewriteFeedbackDialogChooseOptionTitle;case gi.Confirmation:return this.props.resources.NeuralRewriteFeedbackConfirmationDialogTitle;default:return"<unknown>"}case t.similarity:switch(this.state.similarityState){case hi.Default:return this.props.resources.PlagiarismHeaderLabel;case hi.DisplayingFeedbackOptions:return this.props.resources.ProvideFeedbackHeaderText;case hi.Confirmation:return this.props.resources.NeuralRewriteFeedbackConfirmationDialogTitle;case hi.DisplayingSimilarSources:return this.props.resources.SelectSourceHeaderText;default:return"<unknown>"}case t.sensitiveContent:return this.props.resources.SensitiveContentHeaderLabel;default:return this.props.group.title?this.props.group.title:"<unknown>"}},t.prototype.showingSnippet=function(){switch(this.props.group.type){case t.similarity:return this.state.similarityState===hi.DisplayingSimilarSources||!(!this.props.group.snippet||!this.state.showingSimilarText);default:return(this.props.group.type!==t.neuralRewrite||this.state.rewriteState===gi.Default)&&e.prototype.showingSnippet.call(this)}},t.prototype.renderSnippet=function(o,i,n){var r=this.props.group.type===t.similarity&&this.state.similarityState===hi.DisplayingSimilarSources,s=this.props.group.type===t.similarity?window.CSS&&window.CSS.supports&&window.CSS.supports("display","-webkit-box")?this.props.styleProvider.webkitTwoLineContextStyles:this.props.styleProvider.twoLineContextStyles:this.props.styleProvider.contextStyles;return r&&(s=window.CSS&&window.CSS.supports&&window.CSS.supports("display","-webkit-box")?this.props.styleProvider.webkitChooseSourceSourceSnippetStyles:this.props.styleProvider.chooseSourceSourceSnippetStyles),e.prototype.renderSnippet.call(this,s,i,n)},t.prototype.renderSnippetForFeedback=function(){var e;return C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},null===(e=this.props.group.snippet)||void 0===e?void 0:e.substr(0,t.characterLimitForUserTextToSend))},t.prototype.renderNeuralRewriteHeader=function(){var e=this.state.rewriteState===gi.Confirmation,t=this.state.rewriteState===gi.DisplayingFeedbackOptions,o=this.state.rewriteState===gi.Confirmation,i=this.state.rewriteState===gi.Default;return C.createElement("div",{style:this.props.styleProvider.headerStyles},C.createElement("div",null,C.createElement("div",{id:this.headerId(),role:"heading",style:e?this.props.styleProvider.largeHeaderStyles:void 0},this.headerText()),t||o?C.createElement("div",{style:this.props.styleProvider.subheaderStyles},t?this.props.resources.NeuralRewriteFeedbackDialogDescription:this.props.resources.NeuralRewriteFeedbackConfirmationDialogSubTitle):null),i?this.renderPreviewPillbox():null)},t.prototype.getSimilarityHeaderLabel=function(){return this.props.resources.SimilarityFormatHeaderLabel.replace("{0}",this.props.resources.PlagiarismHeaderLabel).replace("{1}",this.props.resources.PoweredByBingHeaderLabel)},t.prototype.getSimilarityHeaderStyle=function(){return this.state.similarityState===hi.Confirmation?this.props.styleProvider.largeHeaderStyles:this.state.similarityState===hi.DisplayingSimilarSources?this.props.styleProvider.chooseSourceHeaderStyles:this.state.similarityState===hi.DisplayingFeedbackOptions?this.props.styleProvider.similarityHeaderFeedbackStyles:this.props.styleProvider.similarityHeaderStyles},t.prototype.renderSimilarityHeader=function(){var e=this.state.similarityState===hi.DisplayingFeedbackOptions,t=this.state.similarityState===hi.Confirmation,o=this.state.similarityState===hi.Default;return C.createElement("div",{style:this.props.styleProvider.headerStyles},C.createElement("div",{"aria-live":"polite"},C.createElement("div",{id:this.headerId(),role:"heading","aria-level":1,style:this.getSimilarityHeaderStyle()},this.headerText()),e||t?C.createElement("div",{style:this.props.styleProvider.subheaderStyles},e?this.props.resources.SimilarityFeedbackDialogChooseOptionTitle:this.props.resources.NeuralRewriteFeedbackConfirmationDialogSubTitle):null),o?this.renderPreviewPillbox():null)},t.prototype.renderSimilaritySourceTitle=function(e){var t=this.state.similarityState===hi.DisplayingSimilarSources;return C.createElement("span",{style:t?this.props.styleProvider.chooseSourceSourceTitleStyles:this.props.styleProvider.similaritySourceTitleStyles},e)},t.prototype.getDomainFromUrl=function(e){if(e)try{return new URL(e).hostname}catch(e){}return e},t.prototype.renderCitationToBeShared=function(){return C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},C.createElement("div",{style:this.props.styleProvider.citationLinkFeedbackStyles},this.getDomainFromUrl(this.props.group.url)))},t.prototype.renderSimilaritySourceUrl=function(e,t){var o=this.state.similarityState===hi.DisplayingSimilarSources;return C.createElement("div",{style:o?this.props.styleProvider.chooseSourceSourceUrlStyles:this.props.styleProvider.similaritySourceUrlStyles},this.getDomainFromUrl(e),t?C.createElement("div",{style:this.props.styleProvider.poweredByBingStyles,"aria-hidden":"true"},this.props.resources.PoweredByBingHeaderLabel):null)},t.prototype.renderHeader=function(){switch(this.props.group.type){case t.similarity:switch(this.state.similarityState){case hi.DisplayingFeedbackOptions:case hi.Confirmation:case hi.DisplayingSimilarSources:return this.renderSimilarityHeader();case hi.Default:return C.createElement("div",{"aria-label":this.getSimilarityHeaderLabel(),role:"group"},this.renderSimilarityHeader(),this.renderSnippet(void 0,this.props.group.snippet,this.props.group.snippetFormatting),this.renderSimilaritySourceTitle(this.props.group.description),this.renderSimilaritySourceUrl(this.props.group.url,!0))}case t.neuralRewrite:return C.createElement("div",null,this.renderNeuralRewriteHeader(),this.renderSnippet(void 0,this.props.group.snippet,this.props.group.snippetFormatting));default:return e.prototype.renderHeader.call(this)}},t.prototype.suggestionListDescription=function(){switch(this.props.group.type){case t.neuralRewrite:case t.similarity:return this.headerText();default:return e.prototype.suggestionListDescription.call(this)}},t.prototype.handleSuggestionFocus=function(e){this.setState((function(){return{focusedSuggestionId:e}}))},t.prototype.handleSuggestionBlur=function(){this.setState((function(){return{focusedSuggestionId:null}}))},t.prototype.handleSuggestionHoverOn=function(e){this.setState((function(){return{hoveredSuggestionId:e}}))},t.prototype.handleSuggestionHoverOff=function(e){this.state.hoveredSuggestionId===e&&this.setState((function(){return{hoveredSuggestionId:null}}))},t.prototype.isSuggestionAlreadyReported=function(e){return this.props.group.type===t.neuralRewrite&&t.neuralRewriteReportedSuggestions.indexOf(e)>=0},t.prototype.isSuggestionDisabled=function(e){return this.props.group.type===t.neuralRewrite&&t.neuralRewriteDisabledSuggestions.indexOf(e)>=0},t.prototype.showingDescription=function(){return(this.props.group.type!==t.neuralRewrite||this.state.rewriteState===gi.Default)&&this.state.showingDescription},t.prototype.getSuggestionStyle=function(e){return e?this.props.styleProvider.disabledSuggestionTitleStyles:this.props.styleProvider.suggestionTitleStyles},t.prototype.getSuggestionContainerStyle=function(e,t){return e?this.props.styleProvider.disabledSuggestionContainerStyles:t?this.props.styleProvider.hoveredSuggestionContainerStyles:this.props.styleProvider.suggestionContainerStyles},t.prototype.suggestionHasActionType=function(e,t){return!!e.supportedActions&&-1!==e.supportedActions.findIndex((function(e){return e===t}))},t.prototype.suggestionGroupHasActionType=function(e,t){return!!e.supportedActions&&-1!==e.supportedActions.findIndex((function(e){return e===t}))},t.prototype.getSuggestionsRole=function(){return"menu"},t.prototype.getSuggestionItemRole=function(){return null},t.prototype.getSuggestionTitle=function(e){if(this.props.group.type===t.similarity)switch(e.id){case t.similarityBlockQuoteSuggestion:return this.props.resources.BlockQuotationButtonText;case t.similarityFullCitationSuggestions:return this.props.resources.FullCitationButtonText;case t.similarityInlineCitationSuggestions:return this.props.resources.InlineCitationButtonText}return this.props.group.type===t.sensitiveContent?this.props.resources.RemoveButtonText:e.title?e.title:void 0},t.prototype.renderSuggestionIcon=function(e){switch(this.props.group.type){case t.sensitiveContent:return C.createElement(Ci.a,{iconName:this.props.styleProvider.deleteIconName,styles:this.props.styleProvider.deleteIconStyles});case t.similarity:switch(e.id){case t.similarityFullCitationSuggestions:return C.createElement(Ci.a,{iconName:this.props.styleProvider.copyCitationIconName,styles:this.props.styleProvider.copyCitationIconStyles});case t.similarityInlineCitationSuggestions:return C.createElement(Ci.a,{iconName:this.props.styleProvider.inTextCitationIconName,styles:this.props.styleProvider.inTextCitationIconStyles});case t.similarityBlockQuoteSuggestion:default:return null}default:return null}},t.prototype.renderSuggestionContents=function(e,t,o){return C.createElement("div",null,this.renderSuggestionIcon(e),C.createElement(xi,{text:t,formatting:o?void 0:e.titleFormatting,style:this.getSuggestionStyle(o)}),e.description&&this.showingDescription()?C.createElement("div",null,C.createElement(xi,{text:e.description,style:this.props.styleProvider.suggestionDescriptionStyles})):null)},t.prototype.getObjectFulfillment=function(e){if(this.props.group.type===t.similarity&&null!==e.id)return e.id},t.prototype.getDescriptorData=function(e){if(this.props.group.type===t.similarity)return e?parseInt(e,10):parseInt(this.state.similaritySelectedSource,10)},t.prototype.renderSuggestion=function(e,o){var i=this,n=this.getSuggestionTitle(e);if(!n)return null;if(this.props.group.isContentPending)return C.createElement("div",{style:this.props.styleProvider.suggestionShimmerFlexStyles,"aria-hidden":!0},C.createElement(_e.a,{styles:this.props.styleProvider.suggestionShimmerTitleStyles}));var r=!this.suggestionHasActionType(e,co.Apply)||this.isSuggestionDisabled(n),s=this.maximumSuggestions();this.props.group.suggestions&&this.props.group.suggestions.length<s&&(s=this.props.group.suggestions.length);var a={allowDisabledFocus:!0,disabled:r,role:"menuitem","aria-posinset":o+1,"aria-setsize":s,onClick:function(t){return i.onAction(t,co.Apply,lo.Try,i.props.group,e,i.getObjectFulfillment(e),i.getDescriptorData())}};if(this.props.group.type===t.neuralRewrite&&r){var c=Object(l.__assign)(Object(l.__assign)({},a),{styles:this.props.styleProvider.rewriteReportedSuggestionButtonStyles,text:this.props.resources.NeuralRewriteReportedSuggestionTitle,iconProps:{iconName:"Info"}});return C.createElement("div",{style:this.getSuggestionContainerStyle(!1,!1)},C.createElement(bi.a,Object(l.__assign)({},c)))}var u=Object(l.__assign)(Object(l.__assign)({},a),{styles:this.props.styleProvider.suggestionButtonStyles,onFocus:function(){return i.handleSuggestionFocus(e.id)}}),p=this.state.hoveredSuggestionId===e.id,d=this.state.openSuggestionOverflowId===e.id,g={onMouseEnter:function(){return i.handleSuggestionHoverOn(e.id)},onMouseLeave:function(){return i.handleSuggestionHoverOff(e.id)},onFocus:function(){return i.handleSuggestionFocus(e.id)},onBlur:this.handleSuggestionBlur,style:this.getSuggestionContainerStyle(r,p||d)};return C.createElement("div",Object(l.__assign)({},g),C.createElement(bi.a,Object(l.__assign)({},u,{"data-automation-id":"CritiqueSuggestionButton_".concat(e.id)}),this.renderSuggestionContents(e,n,r)))},t.prototype.renderEmptyNeuralRewrite=function(){return C.createElement("div",{style:this.props.styleProvider.suggestionGroupStyles},C.createElement("div",Object(l.__assign)({style:this.props.styleProvider.suggestionStyles,role:"group"},this.rootAttributes(!1)),C.createElement("div",{id:"header-emptyNeuralRewrite",role:"heading","aria-level":1,style:this.props.styleProvider.headerStyles},this.props.resources.CritiqueNoSuggestionsHeader),C.createElement("div",{style:this.props.styleProvider.suggestionContainerStyles},C.createElement(xi,{ariaLabel:this.props.resources.NeuralRewriteNoSuggestionsText,ariaRole:"document",text:this.props.group.errorMessage?this.props.group.errorMessage:this.props.resources.NeuralRewriteNoSuggestionsText,style:this.props.styleProvider.noSuggestionStyles})),this.renderCloseButtonFooter()))},t.prototype.onRewriteSelectFeedbackSuggestion=function(e,t){t&&this.setState({rewriteReportedSuggestionId:t.key,rewriteChoiceGroupSelected:!0})},t.prototype.renderNeuralRewriteReportSuggestions=function(){var e=this,t=this.getSuggestionsToRender();if(!t)return null;var o=this.maximumSuggestions(),i=t.filter((function(t){return!!t&&!!t.id&&!!e.getSuggestionTitle(t)})).map((function(t){var o=t,i=o.id,n=e.getSuggestionTitle(o);if(e.isSuggestionDisabled(n))return{key:i,disabled:!0,text:e.props.resources.NeuralRewriteReportedSuggestionTitle,onRenderField:function(t,o){return C.createElement("div",{style:e.props.styleProvider.suggestionChoiceItemStyles},o(t))}};var r=e.isSuggestionAlreadyReported(n);return{key:i,disabled:r,text:"",ariaLabel:n,onRenderField:function(t,i){return C.createElement("div",{style:e.props.styleProvider.suggestionChoiceItemStyles},i(t),e.renderSuggestionContents(o,n,r))}}})).filter((function(e,t){return t<o}));return 0===i.length?null:C.createElement(Ti.a,{"aria-label":this.props.resources.NeuralRewriteFeedbackDialogChooseSuggestionTitle,onChange:this.onRewriteSelectFeedbackSuggestion,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:i,componentRef:this.rewriteReportSuggestionsChoiceGroupRef})},t.prototype.onRewriteSelectFeedbackOption=function(e,t){t&&this.setState({rewriteChoiceGroupSelected:!0})},t.prototype.renderNeuralRewriteFeedbackOptions=function(){return C.createElement(Ti.a,{"aria-label":this.props.resources.NeuralRewriteFeedbackDialogChooseOptionTitle,componentRef:this.rewriteFeedbackOptionChoiceGroupRef,onChange:this.onRewriteSelectFeedbackOption,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:[{key:t.neuralRewriteFeedbackOptionHelpful,text:this.props.resources.SuggestionFeedbackHelpfulLabel},{key:t.neuralRewriteFeedbackOptionWrong,text:this.props.resources.SuggestionFeedbackWrongLabel},{key:t.neuralRewriteFeedbackOptionOffensive,text:this.props.resources.SuggestionFeedbackOffensiveLabel},{key:t.neuralRewriteFeedbackOptionOther,text:this.props.resources.SuggestionFeedbackOtherLabel}]})},t.rewriteFeedbackOptionShouldDisableSuggestion=function(e){return e!==t.neuralRewriteFeedbackOptionHelpful},t.prototype.getSensitiveContentSuggestion=function(){return[{type:"CritiqueItem",id:"Remove",supportedActions:[co.Apply]}]},t.prototype.getSuggestionsToRender=function(){switch(this.props.group.type){case t.sensitiveContent:return this.getSensitiveContentSuggestion();default:return e.prototype.getSuggestionsToRender.call(this)}},t.prototype.renderSuggestions=function(){if(this.props.group.type===t.neuralRewrite)switch(this.state.rewriteState){case gi.ReportRewriteSuggestions:return this.renderNeuralRewriteReportSuggestions();case gi.DisplayingFeedbackOptions:return this.renderNeuralRewriteFeedbackOptions();case gi.Confirmation:return null}else if(this.props.group.type===t.similarity)switch(this.state.similarityState){case hi.DisplayingFeedbackOptions:return this.renderSimilarityFeedbackOptions();case hi.DisplayingSimilarSources:return this.renderSimilaritySourceOptions();case hi.Confirmation:return null}return e.prototype.renderSuggestions.call(this)},t.prototype.getActionStringForLearnMore=function(){return this.props.group.type===t.neuralRewrite?this.props.resources.AboutSuggestionsButtonText:e.prototype.getActionStringForLearnMore.call(this)},t.prototype.shouldDismissOnAction=function(o){return(this.props.group.type!==t.similarity||o!==co.GiveFeedback)&&((this.props.group.type!==t.similarity||o!==co.SelectSource)&&e.prototype.shouldDismissOnAction.call(this,o))},t.prototype.shouldHideActionButton=function(o,i){return(this.props.group.type!==t.similarity||o!==co.IgnoreOnce)&&e.prototype.shouldHideActionButton.call(this,o,i)},t.prototype.shouldDisableActionButton=function(e,o){return this.props.group.type===t.similarity&&e===co.IgnoreOnce&&!this.hasActionType(e,o)},t.prototype.renderNeuralRewriteFeedbackButton=function(){var e=this;if(this.props.group.isContentPending)return null;var t={text:this.props.resources.GiveFeedbackButtonText,styles:this.props.styleProvider.footerButtonStyles,onClick:function(){return e.setState({rewriteState:gi.ReportRewriteSuggestions,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}};return C.createElement(bi.a,Object(l.__assign)({key:"GiveFeedback"},t,{"data-automation-id":"CritiqueActionButton_GiveFeedback_".concat(this.props.group.id)}))},t.prototype.renderCloseButton=function(){var e=this,t={styles:this.props.styleProvider.footerButtonStyles,iconProps:{iconName:"Cancel",styles:this.props.styleProvider.footerIconStyles,ariaLabel:this.props.resources.CloseButtonLabel},onClick:function(){return e.props.dismiss({actionSourceId:n.Unknown})}};return C.createElement(bi.a,Object(l.__assign)({key:"CloseButton"},t,{"data-automation-id":"CritiqueCloseButton_".concat(this.props.group.id)}))},t.prototype.onShowHideDescription=function(e){this.setState((function(e){return{showingDescription:!e.showingDescription}})),this.onAction(e,co.Toggle,lo.Try,this.props.group,void 0,"Description")},t.prototype.allowDescriptionToggleButton=function(){if(this.props.group.suggestions)for(var e=0,t=this.props.group.suggestions;e<t.length;e++){var o=t[e];if(o&&o.description)return!0}return!1},t.prototype.renderShowHideDescriptionButton=function(){if(!this.allowDescriptionToggleButton())return null;var e=null,o={text:e=this.props.group.type===t.neuralRewrite?this.state.showingDescription?this.props.resources.HideExplanationButtonText:this.props.resources.ShowExplanationButtonText:this.state.showingDescription?this.props.resources.HideSynonymsButtonText:this.props.resources.ShowSynonymsButtonText,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:this.onShowHideDescription};return C.createElement(bi.a,Object(l.__assign)({role:"menuitem",key:"ShowHideDescription"},o,{"data-automation-id":"CritiqueActionButton_".concat(e,"_").concat(this.props.group.id)}))},t.prototype.renderDefaultAction=function(){switch(this.props.group.type){case t.similarity:case t.sensitiveContent:return this.renderActionButton(co.IgnoreOnce,this.props.styleProvider.footerButtonStyles);case t.neuralRewrite:return this.renderNeuralRewriteFeedbackButton();default:return null}},t.prototype.getCitationSourceButtonTitle=function(e){switch(e){case"APA":return this.props.resources.CitationApaTitle;case"MLA":return this.props.resources.CitationMlaTitle;case"Chicago":return this.props.resources.CitationChicagoTitle;default:return}},t.prototype.renderCitationSourceButton=function(e,t,o){var i=this,n=this.getCitationSourceButtonTitle(e);if(!n)return null;var r={text:n,role:"option","aria-selected":this.state.selectedCitationStyle===e,"aria-posinset":t+1,"aria-setsize":o.length,styles:this.state.selectedCitationStyle!==e?this.props.styleProvider.citationNoIconOverflowActionButtonStyles:this.props.styleProvider.citationOverflowActionButtonStyles,iconProps:this.state.selectedCitationStyle!==e?void 0:{iconName:this.props.styleProvider.citationCheckmarkIconName,styles:this.props.styleProvider.citationCheckmarkIconStyles},onClick:function(t){i.setState({selectedCitationStyle:e}),i.onAction(t,co.Toggle,lo.Try,i.props.group,void 0,e)}};return C.createElement(bi.a,Object(l.__assign)({key:e},r,{"data-automation-id":"CritiqueActionButton_".concat(n,"_").concat(this.props.group.id)}))},t.prototype.onSimilaritySelectFeedbackOption=function(e,t){t&&this.setState({similarityChoiceGroupSelected:!0})},t.prototype.onSimilarityFeedbackCancel=function(e){this.setState({similarityState:hi.Default,similarityChoiceGroupSelected:!1})},t.prototype.onSimilarityFeedbackOkay=function(e){this.setState({similarityState:hi.Default,similarityChoiceGroupSelected:!1})},t.prototype.onSimilaritySourceDone=function(e){var t,o,i;this.props.group.sources&&(this.props.group.description=null===(t=this.props.group.sources[e])||void 0===t?void 0:t.description,this.props.group.url=null===(o=this.props.group.sources[e])||void 0===o?void 0:o.url,this.props.group.snippet=null===(i=this.props.group.sources[e])||void 0===i?void 0:i.snippet,this.setState({similaritySelectedSource:e.toString(),similarityState:hi.Default}))},t.prototype.onSimilaritySourceCancel=function(e){this.setState({similarityState:hi.Default})},t.prototype.onSimilarityShareCitedContentCheckbox=function(e){var t=this.state.similarityShareCitedContentCheckbox;this.onAction(null,co.Toggle,lo.None,this.props.group,void 0,"Context"),this.setState({similarityShareCitedContentCheckbox:!t})},t.prototype.renderSimilarityFeedbackOptions=function(){return C.createElement(Ti.a,{"aria-label":this.headerText(),componentRef:this.similarityFeedbackOptionChoiceGroupRef,onChange:this.onSimilaritySelectFeedbackOption,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:[{key:t.similarityFeedbackHelpfulLabel,text:this.props.resources.SimilarityFeedbackHelpfulLabel},{key:t.similarityFeedbackWrongSourceLabel,text:this.props.resources.SimilarityFeedbackWrongSourceLabel},{key:t.similarityFeedbackOriginalContentLabel,text:this.props.resources.SimilarityFeedbackOriginalContentLabel},{key:t.similarityFeedbackOffensiveLabel,text:this.props.resources.SimilarityFeedbackOffensiveContentLabel},{key:t.similarityFeedbackOtherLabel,text:this.props.resources.SimilarityFeedbackOtherLabel}]})},t.prototype.renderSimilaritySourceOverflowActions=function(e,o){if(this.props.group.type!==t.similarity)return null;var i={styleProvider:this.props.styleProvider.bottomAlignedOverflowMenuStyleProvider,resources:this.props.resources,ref:this.similaritySourceOptionRef[e],ariaLabel:this.props.resources.DefaultSplitButtonOverflowAccessibilityLabel.replace("{0}",o)};return C.createElement(yi,Object(l.__assign)({},i),this.renderSimilarityFeedbackButton(),C.createElement("div",null,this.renderNavigateToSourceButton(e.toString())))},t.prototype.renderSimilaritySourceOption=function(e,t){var o=this;if(!this.props.group.sources)return null;var i=this.props.group.sources.length,n=t+1,r={role:"menuitem","aria-posinset":n,"aria-setsize":i,styles:this.props.styleProvider.suggestionButtonStyles,onClick:function(){return o.onSimilaritySourceDone(t)},onFocus:function(){return o.handleSuggestionFocus(e.id)}},s=this.state.hoveredSuggestionId===e.id,a=this.state.openSuggestionOverflowId===e.id,c={onMouseEnter:function(){var i,n;o.handleSuggestionHoverOn(e.id),null===(n=null===(i=o.similaritySourceOptionRef[t])||void 0===i?void 0:i.current)||void 0===n||n.enableButton()},onMouseLeave:function(){var i,n;o.handleSuggestionHoverOff(e.id),o.state.focusedSuggestionId!==e.id&&(null===(n=null===(i=o.similaritySourceOptionRef[t])||void 0===i?void 0:i.current)||void 0===n||n.disabledButton())},onFocus:function(){var n,r,s,a;o.handleSuggestionFocus(e.id);for(var l=0;l<i;l++)l===t?null===(r=null===(n=o.similaritySourceOptionRef[l])||void 0===n?void 0:n.current)||void 0===r||r.enableButton():null===(a=null===(s=o.similaritySourceOptionRef[l])||void 0===s?void 0:s.current)||void 0===a||a.disabledButton()},onBlur:this.handleSuggestionBlur,style:this.getSuggestionContainerStyle(!1,s||a)},u=this.props.resources.SimilaritySourceOptionLabel.replace("{0}",n.toString()),p=this.renderSimilaritySourceOverflowActions(t,u);return C.createElement("div",Object(l.__assign)({},c),C.createElement(bi.a,Object(l.__assign)({},r,{"data-automation-id":"SimilaritySourceButton_".concat(e.id)}),C.createElement("div",{style:this.props.styleProvider.similaritySourceChoiceStyle},C.createElement("div",{"aria-label":u,role:"group"},this.renderSimilaritySourceTitle(e.description),this.renderSimilaritySourceUrl(e.url,!1),this.renderSnippet(void 0,e.snippet,e.snippetFormatting)))),p)},t.prototype.renderSimilaritySourceOptions=function(){var e=this;if(!this.props.group.sources)return null;var t=this.props.group.sources.filter((function(e){return!!e})).map((function(t,o){return e.renderSimilaritySourceOption(t,o)})).filter((function(e){return!!e}));return C.createElement(Q.a,{componentRef:this.suggestionsFocusZoneRef},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:"menu","aria-label":this.props.resources.SimilaritySourceOptionsLabel},t))},t.prototype.renderSimilarityFeedbackButton=function(){var e=this;if(this.props.group.type!==t.similarity||this.props.group.isContentPending)return null;if(!this.suggestionGroupHasActionType(this.props.group,co.Report))return null;var o={text:this.props.resources.GiveFeedbackButtonText,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:function(t){e.onAction(t,co.GiveFeedback,lo.None,e.props.group),e.setState({similarityState:hi.DisplayingFeedbackOptions})}};return C.createElement(bi.a,Object(l.__assign)({key:"GiveFeedback"},o,{"data-automation-id":"CritiqueActionButton_GiveFeedback_".concat(this.props.group.id)}))},t.prototype.renderSimilarityFeedbackIconButton=function(){var e=this;if(this.props.group.type!==t.similarity||this.props.group.isContentPending)return null;if(!this.suggestionGroupHasActionType(this.props.group,co.Report))return null;var o={ariaLabel:this.props.resources.GiveFeedbackButtonText,iconProps:this.props.styleProvider.feedbackIconProps,styles:this.props.styleProvider.footerButtonStyles,onClick:function(t){e.onAction(t,co.GiveFeedback,lo.None,e.props.group),e.setState({similarityState:hi.DisplayingFeedbackOptions})}};return C.createElement(bi.a,Object(l.__assign)({key:"GiveFeedback"},o,{"data-automation-id":"CritiqueActionButton_GiveFeedback_".concat(this.props.group.id)}))},t.prototype.renderNavigateToSourceButton=function(e){var t=this,o={text:this.props.resources.NavigateToSourceButton,styles:this.props.styleProvider.overflowActionButtonStyles,role:"menuitem",onClick:function(){var o,i;t.props.group.sources?window.open(null!==(i=null===(o=t.props.group.sources[parseInt(e,10)])||void 0===o?void 0:o.url)&&void 0!==i?i:void 0):window.open(t.props.group.url?t.props.group.url:void 0)}};return C.createElement(bi.a,Object(l.__assign)({},o))},t.prototype.renderOverflowActions=function(){var e=[];switch(this.props.group.type){case t.similarity:e=[this.renderShowHideSimilarTextButton(),this.renderNavigateToSourceButton(this.state.similaritySelectedSource),this.renderActionButton(co.LearnMore,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")];break;case t.sensitiveContent:e=[this.renderShowHideContextButton()];break;case t.neuralRewrite:e=[this.renderShowHideContextButton(),this.renderShowHideDescriptionButton(),this.renderActionButton(co.LearnMore,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")]}return e.filter((function(e){return!!e}))},t.prototype.renderShowHideSimilarTextButton=function(){var e=this;if(!this.allowShowHideSimilarTextButton())return null;var t=this.state.showingSimilarText?this.props.resources.HideSimilarTextButton:this.props.resources.ShowSimilarTextButton,o={text:t,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:function(t){return e.onShowHideSimilarText(t)}};return C.createElement(bi.a,Object(l.__assign)({role:"menuitem",key:"ShowHideSimilarText"},o,{"data-automation-id":"CritiqueActionButton_".concat(t,"_").concat(this.props.group.id)}))},t.prototype.allowShowHideSimilarTextButton=function(){return!!this.props.group.snippet},t.prototype.onShowHideSimilarText=function(e){this.setState((function(e){return{showingSimilarText:!e.showingSimilarText}})),this.onAction(e,co.Toggle,lo.None,this.props.group,void 0,"Context")},t.prototype.renderCitationStyleOptions=function(){var e=this;if(this.props.group.type!==t.similarity)return null;var o=this.state.selectedCitationStyle?this.state.selectedCitationStyle:this.props.resources.CitationMlaTitle,i={text:o,iconName:this.props.styleProvider.citationDropdownIconName,styleProvider:this.props.styleProvider.citationFooterOverflowMenuStyleProvider,resources:this.props.resources,ref:this.footerOpenOverflowMenuRef,ariaLabel:this.props.resources.SimilarityCitationStyleLabel.replace("{0}",o),role:"menu"},n=[this.props.resources.CitationMlaTitle,this.props.resources.CitationApaTitle,this.props.resources.CitationChicagoTitle].filter((function(e){return!!e})).map((function(t,o,i){return e.renderCitationSourceButton(t,o,i)}));return C.createElement(yi,Object(l.__assign)({},i),C.createElement("div",{style:this.props.styleProvider.footerOverflowContainerStyles},n))},t.prototype.onRewriteReportSuggestionCancel=function(e){this.setState({rewriteState:gi.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})},t.prototype.onRewriteReportSuggestionNext=function(e){this.setState({rewriteState:gi.DisplayingFeedbackOptions,rewriteChoiceGroupSelected:!1})},t.prototype.onRewriteReportSuggestionSend=function(e){if(this.state.rewriteReportedSuggestionId&&this.props.group.suggestions)if(this.rewriteFeedbackOptionChoiceGroupRef.current&&this.rewriteFeedbackOptionChoiceGroupRef.current.checkedOption){for(var o=null,i=this.state.rewriteReportedSuggestionId,n=0,r=this.props.group.suggestions;n<r.length;n++){var s=r[n];if(s&&s.id===i){o=s;break}}if(o&&this.getSuggestionTitle(o)){var a=this.getSuggestionTitle(o),l=this.rewriteFeedbackOptionChoiceGroupRef.current.checkedOption.key,c={option:l,comments:this.rewriteCommentsTextBoxRef.current&&this.rewriteCommentsTextBoxRef.current.value?this.rewriteCommentsTextBoxRef.current.value:void 0};this.onAction(null,co.Report,lo.Try,this.props.group,o,void 0,JSON.stringify(c)),this.isSuggestionAlreadyReported(a)||t.neuralRewriteReportedSuggestions.push(a),t.rewriteFeedbackOptionShouldDisableSuggestion(l)&&!this.isSuggestionDisabled(a)&&t.neuralRewriteDisabledSuggestions.push(a),this.setState({rewriteState:gi.Confirmation,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}else u.a.sendTraceTag(594871320,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because we couldn't find the reported suggestion, or could grab the text on it")}else u.a.sendTraceTag(594871319,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because apparently no option radio was selected");else u.a.sendTraceTag(594911240,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because we don't know what was reported, or we don't have any suggestions")},t.prototype.onRewriteReportSuggestionDone=function(e){this.setState({rewriteState:gi.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})},t.prototype.renderCloseButtonFooter=function(){var e=this.renderCloseButton();return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerDefaultActionStyles},e))},t.prototype.renderShowSources=function(){var e=this;if(this.props.group.type!==t.similarity||!this.props.group.sources||this.props.group.sources.length<=1)return null;var o={text:this.props.resources.SimilaritySourcesLabel,styles:this.props.styleProvider.similaritySourcesStyles,onClick:function(t){e.onAction(t,co.SelectSource,lo.None,e.props.group),e.setState({similarityState:hi.DisplayingSimilarSources})}};return C.createElement(Ai.a,Object(l.__assign)({},o))},t.prototype.renderDefaultFooter=function(){var e=this.renderDefaultAction(),t=this.renderCitationStyleOptions(),o=this.renderSimilarityFeedbackIconButton(),i=this.renderOverflowMenu(),n=this.renderNextPrev(),r=this.renderShowSources();return null!=e||null!=i||n.length>0?[C.createElement("div",{key:"footer"},r,C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerDefaultActionStyles},e,t,o,i),C.createElement("div",{style:this.props.styleProvider.footerNextPrevStyles},n)))]:null},t.prototype.renderRewriteFooter=function(){switch(this.state.rewriteState){case gi.Default:return this.props.group.isContentPending?null:this.renderDefaultFooter();case gi.ReportRewriteSuggestions:case gi.DisplayingFeedbackOptions:case gi.Confirmation:var e=this.state.rewriteState===gi.DisplayingFeedbackOptions,t=this.state.rewriteState!==gi.Confirmation,o=this.state.rewriteState===gi.ReportRewriteSuggestions,i=this.state.rewriteState===gi.DisplayingFeedbackOptions,n=this.state.rewriteState===gi.Confirmation;return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},e?C.createElement(Ii.a,{id:"commentsBox",type:"AppInputProps",ref:this.rewriteCommentsTextBoxRef,label:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,hideLabel:!0,placeholder:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,styles:this.props.styleProvider.rewriteCommentsBoxStyles,multiline:!0,resizable:!1}):null,e?this.renderPrivacyStatement():null,C.createElement("div",{style:this.props.styleProvider.footerDialogButtonGroupStyles},t?C.createElement(wi.a,{text:this.props.resources.CancelButton,onClick:this.onRewriteReportSuggestionCancel}):null,o?C.createElement(Ai.a,{text:this.props.resources.NextButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionNext,disabled:!this.state.rewriteChoiceGroupSelected}):null,i?C.createElement(Ai.a,{text:this.props.resources.SendButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionSend,disabled:!this.state.rewriteChoiceGroupSelected}):null,n?C.createElement(Ai.a,{text:this.props.resources.DoneButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionDone,componentRef:this.rewriteReportDoneButtonRef}):null));default:return null}},t.prototype.renderPrivacyStatement=function(){return C.createElement(C.Fragment,null,C.createElement(xi,{ariaLabel:this.privacyStatementLabel,style:this.props.styleProvider.privacyStatementStyle,text:this.privacyStatementLabel}),C.createElement(Oi.a,{target:"_blank",href:this.props.resources.NeuralRewriteFeedbackDialogPrivacyStatementURL,styles:this.props.styleProvider.linkStyle,underline:!0},this.props.resources.NeuralRewriteFeedbackDialogPrivacyStatementLabel))},t.prototype.getUserTextToSend=function(){var e;return null===(e=this.props.group.snippet)||void 0===e?void 0:e.substr(0,t.characterLimitForUserTextToSend)},t.prototype.onSimilarityFeedbackSubmit=function(e){if(this.props.group.suggestions)if(this.similarityFeedbackOptionChoiceGroupRef.current&&this.similarityFeedbackOptionChoiceGroupRef.current.checkedOption){var t=this.similarityFeedbackOptionChoiceGroupRef.current.checkedOption.key,o=this.similarityCommentsTextBoxRef.current&&this.similarityCommentsTextBoxRef.current.value?this.similarityCommentsTextBoxRef.current.value:void 0,i=this.state.similarityShareCitedContentCheckbox?this.getUserTextToSend():void 0,n=this.state.similarityShareCitedContentCheckbox?this.getDomainFromUrl(this.props.group.url):void 0;this.onAction(null,co.Report,lo.Try,this.props.group,void 0,void 0,JSON.stringify({option:t,comments:o,snippet:i,url:n})),this.setState({similarityState:hi.Confirmation})}else u.a.sendTraceTag(590136730,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because apparently no option radio was selected");else u.a.sendTraceTag(590136729,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because we don't know what was reported, or we don't have any suggestions")},t.prototype.renderSimilarSourcesFooter=function(){return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},C.createElement("div",null,C.createElement(wi.a,{text:this.props.resources.BackButton,styles:this.props.styleProvider.similaritySourceBackButtonStyles,onClick:this.onSimilaritySourceCancel})))},t.prototype.renderSimilarityFooter=function(){switch(this.state.similarityState){case hi.Default:return this.renderDefaultFooter();case hi.DisplayingSimilarSources:return this.renderSimilarSourcesFooter();case hi.DisplayingFeedbackOptions:case hi.Confirmation:var e=this.state.similarityState===hi.DisplayingFeedbackOptions,t=this.state.similarityState===hi.DisplayingFeedbackOptions,o=this.state.similarityState===hi.DisplayingFeedbackOptions,i=this.state.similarityState!==hi.Confirmation,n=this.state.similarityState===hi.DisplayingFeedbackOptions,r=this.state.similarityState===hi.Confirmation;return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},e?C.createElement(Ii.a,{ref:this.similarityCommentsTextBoxRef,id:"commentsBox",type:"AppInputProps",label:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,hideLabel:!0,placeholder:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,styles:this.props.styleProvider.rewriteCommentsBoxStyles,multiline:!0,resizable:!1,disabled:!this.state.similarityChoiceGroupSelected}):null,t?C.createElement(C.Fragment,null,C.createElement(Si.a,{label:this.props.resources.SimilarityFeedbackIncludeDocumentTextAndSourceUrl,checked:this.state.similarityShareCitedContentCheckbox,styles:this.props.styleProvider.includeCitedContentOptionStyles,onChange:this.onSimilarityShareCitedContentCheckbox}),C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},this.renderSnippetForFeedback(),this.renderCitationToBeShared())):null,o?this.renderPrivacyStatement():null,C.createElement("div",{style:this.props.styleProvider.footerDialogButtonGroupStyles},i?C.createElement(wi.a,{text:this.props.resources.CancelButton,onClick:this.onSimilarityFeedbackCancel}):null,n?C.createElement(Ai.a,{text:this.props.resources.SubmitButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onSimilarityFeedbackSubmit,disabled:!this.state.similarityChoiceGroupSelected}):null,r?C.createElement(Ai.a,{text:this.props.resources.DoneButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onSimilarityFeedbackOkay,componentRef:this.similarityFeedbackReportOkayButtonRef}):null));default:return null}},t.prototype.renderFooter=function(){switch(this.props.group.type){case t.neuralRewrite:return this.renderRewriteFooter();case t.similarity:return this.renderSimilarityFooter();default:return this.renderDefaultFooter()}},t.prototype.onAction=function(t,o,i,n,r,s,a){e.prototype.onAction.call(this,t,o,i,n,r,s,a)},t.neuralRewrite="NeuralRewriteCritique",t.similarity="PlagiarismCritique",t.sensitiveContent="SensitiveContent",t.neuralRewriteFeedbackOptionHelpful="Helpful",t.neuralRewriteFeedbackOptionWrong="Wrong",t.neuralRewriteFeedbackOptionOffensive="Offensive",t.neuralRewriteFeedbackOptionOther="Other",t.characterLimitForUserTextToSend=150,t.neuralRewriteReportedSuggestions=[],t.neuralRewriteDisabledSuggestions=[],t.similarityFeedbackHelpfulLabel="Helpful",t.similarityFeedbackWrongSourceLabel="WrongSource",t.similarityFeedbackOffensiveLabel="Offensive",t.similarityFeedbackOriginalContentLabel="OriginalContent",t.similarityFeedbackOtherLabel="Other",t.similarityBlockQuoteSuggestion="BlockQuotation",t.similarityFullCitationSuggestions="FullCitation",t.similarityInlineCitationSuggestions="InlineCitation",t}(ki),Di=o(713),Ei=o(2620),Mi=o(2737),ji=function(){return(ji=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Ri(e,t,o){return{fontSize:t.xxsmall,fontFamily:O.a,cssColor:o?e.addOnAction:e.addOnFooterMessage,underlineType:o?w.c.Single:w.c.None,wrapMode:o?w.b.NoWrap:w.b.Normal}}function Bi(e,t,o){return ji(ji({},Ri(e,t,o)),{fontSize:t.xsmall,fontWeight:o?w.a.SemiBold:w.a.Normal})}function Li(e){return{background:{resting:"transparent"},title:{resting:e.addOnAction||e.background.resting}}}function Pi(e){return e.premiumEmphasis}var Fi=function(){return(Fi=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Ni(e,t){return e.hover?Fi(Fi({},e),t?{resting:e.hover}:{hover:void 0}):e}function Hi(e,t){return Fi(Fi({},e),{resting:t,hover:void 0})}function zi(e){var t;return null!==(t=null==e?void 0:e.borderThickness)&&void 0!==t?t:1}function Ui(e){var t;return null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:0}var Wi,qi=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Gi=function(){return(Gi=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Zi=function(e){function t(t){var o=e.call(this,t)||this;return o.state={buttonHover:!1,buttonFocus:!1,overflowHover:!1,overflowFocus:!1,menuOpened:!1,overflowTimeout:void 0,highlightTimeout:void 0},o.buttonRef=C.createRef(),o.onButtonHoverIn=o.handleEvent.bind(o,"buttonHover",!0),o.onButtonHoverOut=o.handleEvent.bind(o,"buttonHover",!1),o.onButtonFocus=o.handleEvent.bind(o,"buttonFocus",!0),o.onButtonBlur=o.handleEvent.bind(o,"buttonFocus",!1),o.onOverflowHoverIn=o.handleEvent.bind(o,"overflowHover",!0),o.onOverflowHoverOut=o.handleEvent.bind(o,"overflowHover",!1),o.onOverflowFocus=o.handleEvent.bind(o,"overflowFocus",!0),o.onOverflowBlur=o.handleEvent.bind(o,"overflowFocus",!1),o.onMenuOpened=o.handleEvent.bind(o,"menuOpened",!0),o.onMenuDismissed=o.handleEvent.bind(o,"menuOpened",!1),o}return qi(t,e),t.shouldShowHighlight=function(e,t){return e.buttonHover||e.overflowHover||e.menuOpened||!t&&void 0!==e.highlightTimeout},t.shouldSetHighlightTimerForEvent=function(e){return"buttonHover"===e||"overflowHover"===e},t.shouldShowOverflow=function(e,t){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened||!t&&void 0!==e.overflowTimeout},t.setTimerHighlightedInstance=function(e){this.timerHighlightedInstance!==e&&(void 0!==e&&void 0!==this.timerHighlightedInstance&&void 0!==this.timerHighlightedInstance.state.highlightTimeout&&this.timerHighlightedInstance.cancelUnhighlightTimer(!1),this.timerHighlightedInstance=e)},t.prototype.render=function(){var e,o,i,n,r,s,a,l,c,u={marginHorizontal:null===(e=this.props.style)||void 0===e?void 0:e.marginHorizontal,marginVertical:null===(o=this.props.style)||void 0===o?void 0:o.marginVertical,flexibleSize:null===(i=this.props.style)||void 0===i?void 0:i.flexibleSize,height:null===(n=this.props.style)||void 0===n?void 0:n.height,minHeight:null===(r=this.props.style)||void 0===r?void 0:r.minHeight,maxHeight:null===(s=this.props.style)||void 0===s?void 0:s.maxHeight};if(this.drawBorderOnRoot()){var p=null!==(a=this.props.buttonProps.theme)&&void 0!==a?a:fe.a.defaultTheme;u.borderColor=null!==(l=p.border)&&void 0!==l?l:t.shouldShowHighlight(this.state)?p.background.hover:p.background.resting,u.borderStyle="solid",u.borderWidth=zi(this.props.style),u.borderRadius=Ui(this.props.style)}return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Stretch,style:u},C.createElement(be.a,Gi({ref:this.buttonRef},this.computeButtonProps())),(c=this.props).menuProps&&c.menuProps.items&&c.menuProps.items.length>0?C.createElement(Ie,Gi({},this.computeOverflowMenuProps())):null)},t.prototype.focus=function(){this.buttonRef.current&&this.buttonRef.current.focus()},t.prototype.componentWillUnmount=function(){t.timerHighlightedInstance===this&&t.setTimerHighlightedInstance(void 0),this.cancelOverflowTimer(!1),this.cancelUnhighlightTimer(!1),e.prototype.componentWillUnmount&&e.prototype.componentWillUnmount.call(this)},t.prototype.cancelOverflowTimer=function(e){void 0!==this.state.overflowTimeout&&(clearTimeout(this.state.overflowTimeout),e||this.setState({overflowTimeout:void 0}))},t.prototype.cancelUnhighlightTimer=function(e){void 0!==this.state.highlightTimeout&&(clearTimeout(this.state.highlightTimeout),e||this.setState({highlightTimeout:void 0}))},t.prototype.computeButtonProps=function(){var e=zi(this.props.style),o=Ui(this.props.style),i=Gi(Gi({},this.props.style),{paddingEnd:e,borderRadius:{topStart:o,bottomStart:o}});this.drawBorderOnRoot()?i.borderThickness=0:i.borderThickness={start:e,top:e,bottom:e},this.props.menuProps||delete i.paddingEnd,delete i.marginHorizontal,delete i.marginVertical,delete i.height,delete i.minHeight,delete i.maxHeight;var n,r,s=this.props.buttonProps,a=(null==s?void 0:s.icon)?{type:s.icon.type}:void 0;return Gi(Gi({},s),{icon:a,style:i,theme:(n=s.theme?s.theme:be.a.defaultTheme,r=t.shouldShowHighlight(this.state),Fi(Fi({},n),{background:Ni(n.background,r),title:Ni(n.title,r),subtitle:n.subtitle&&Ni(n.subtitle,r)})),onHoverIn:this.onButtonHoverIn,onHoverOut:this.onButtonHoverOut,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize})},t.prototype.computeOverflowMenuProps=function(){var e=zi(this.props.style),o=Ui(this.props.style),i={paddingStart:e,borderRadius:{topEnd:o,bottomEnd:o}};this.drawBorderOnRoot()?i.borderThickness=0:i.borderThickness={top:e,end:e,bottom:e};var n,r,s,a,l,c=this.props.menuProps;return Gi(Gi({},c),{icon:{type:"Overflow",filled:!0},hidden:!t.shouldShowOverflow(this.state),style:i,theme:(r=c.theme?c.theme:be.a.defaultTheme,s=this.props.theme,a=t.shouldShowHighlight(this.state),l=this.state.overflowHover||this.state.menuOpened,Fi(Fi({},r),{background:s&&s.splitMenuHoverBackground&&a&&l?Hi(r.background,s.splitMenuHoverBackground):Ni(r.background,a),title:s&&s.splitMenuHoverForeground&&a&&l?Hi(r.title,s.splitMenuHoverForeground):Ni(r.title,a),icon:s&&s.splitMenuHoverForeground&&a&&l?Hi(r.icon,s.splitMenuHoverForeground):r.icon&&Ni(r.icon,a)})),accessibilityLabel:(n=this.props,n.menuProps&&n.menuProps.accessibilityLabel?n.menuProps.accessibilityLabel:n.buttonProps.title&&n.strings&&n.strings.defaultSplitButtonOverflowAccessibilityLabel?n.strings.defaultSplitButtonOverflowAccessibilityLabel.replace("{0}",n.buttonProps.title):void 0),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,onHoverIn:this.onOverflowHoverIn,onHoverOut:this.onOverflowHoverOut,onFocus:this.onOverflowFocus,onBlur:this.onOverflowBlur,onMenuOpen:this.onMenuOpened,onMenuDismiss:this.onMenuDismissed})},t.prototype.setOverflowTimer=function(){var e=this;if(!(t.hideOverflowLagInMs<=0))return this.cancelOverflowTimer(!0),setTimeout((function(){e.setState({overflowTimeout:void 0})}),t.hideOverflowLagInMs)},t.prototype.setUnhighlightTimer=function(){var e=this;if(!(t.unhoverLagInMs<=0))return this.cancelUnhighlightTimer(!0),setTimeout((function(){t.timerHighlightedInstance===e&&t.setTimerHighlightedInstance(void 0),e.setState({highlightTimeout:void 0})}),t.unhoverLagInMs)},t.prototype.handleEvent=function(e,o){var i=this;t.shouldSetHighlightTimerForEvent(e)&&o&&t.setTimerHighlightedInstance(this),this.setState((function(n){if(n[e]!==o){var r=Gi({},n);return r[e]=o,o&&("overflowHover"===e&&(r.buttonHover=!1),"buttonHover"===e&&(r.overflowHover=!1)),r.highlightTimeout=t.shouldShowHighlight(n)&&!t.shouldShowHighlight(r)?i.setUnhighlightTimer():void 0,r.overflowTimeout=t.shouldShowOverflow(n)&&!t.shouldShowOverflow(r)?i.setOverflowTimer():void 0,r}}))},t.prototype.drawBorderOnRoot=function(){return!this.props.menuProps||!t.shouldShowOverflow(this.state)},t.hideOverflowLagInMs=5,t.unhoverLagInMs=5,t.timerHighlightedInstance=void 0,t}(C.PureComponent),Vi=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Qi=function(){return(Qi=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Yi=function(e){function t(t){var o=e.call(this,t)||this;return o.firstSuggestionRef=C.createRef(),o.firstSuggestionButtonRef=C.createRef(),o.footerRef=C.createRef(),o.state={definition:t.definition},o}return Vi(t,e),t.prototype.setDefinition=function(e){this.setState({definition:e})},t.prototype.componentDidMount=function(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})},t.prototype.render=function(){return C.createElement(H.a,{style:A.pb(this.getTheme(),this.props.style),align:z.b.Stretch},this.renderHeader(),this.renderBody(),this.renderFooterTitle(),C.createElement(ht,{automationId:this.props.automationId,definition:this.state.definition,theme:this.props.theme,fontTable:this.props.fontTable,spacing:this.props.spacing,style:this.props.style,strings:this.props.strings,settings:this.props.settings,onAction:this.props.onAction,ref:this.footerRef}),this.renderAddOnFooter())},t.prototype.focus=function(){var e;this.firstSuggestionRef.current?this.firstSuggestionRef.current.focus():this.firstSuggestionButtonRef.current?this.firstSuggestionButtonRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()},t.prototype.executeBadgedAction=function(e){if(this.props.onAction){var t=Qe(this.getDefinition(),this.props.strings),o={actionSourceId:n.VoiceDictationBadge,maxBadgeId:t.reduce((function(e,t){return Math.max(e,t.badgeId)}),0)},i=t.filter((function(t){return t.badgeId===e}));i.length>0?(o.executedBadgeId=i[0].badgeId,this.props.onAction(i[0].action,i[0].suggestionIndex,void 0,o)):this.props.onAction($.a.Dismiss,void 0,void 0,o)}},t.prototype.getBooleanSetting=function(e){return!!this.props.settings&&"true"===this.props.settings[e]},t.prototype.getDefinition=function(){return this.state.definition},t.prototype.renderContext=function(e){if(!e.showContext||!e.contextText||!e.contextText.length)return null;var o=Object(ne.a)(this.props.strings.textFormatting,e.critiqueType,e.contextText,e.contextDecorations),i=$e(e,$.a.ReadContext),n=i?Qi(Qi({},A.j),{flexibleSize:!0}):A.j,r=C.createElement(H.a,{style:n,accessibleLive:z.a.Polite},C.createElement(se.a,{text:Object(Di.c)(e.contextText,t.contextMaxLength),style:A.H(this.getTheme(),this.getFontTable()),formatting:Object(ne.b)(e.contextText.length,this.getTheme(),e.contextDecorations),accessibilityLabel:o}));if(!i)return r;var s=this.getBooleanSetting("NoTooltipForReadContext")?void 0:Je(e,this.props.strings,$.a.ReadContext);return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center},r,Ge(this.getDefinition(),this.getTheme(),$.a.ReadContext,A.lb(this.getFontTable()),this.props.strings,{action:"readcontext",context:o||e.contextText},void 0,void 0,s,void 0,void 0,void 0,this.props.automationId,this.props.onAction))},t.prototype.getCardHeaderText=function(){var e=this.getDefinition(),t=void 0;switch(e.critiqueType){case $.c.Classification:t=this.props.strings.critique("sensitiveContentCardHeader");break;case $.c.Spelling:case $.c.RepeatedWord:t=this.props.strings.critique("spellingCardHeader");break;case $.c.Grammar:t=this.props.strings.critique("grammarCardHeader");break;case $.c.NeuralRewrite:t=this.props.strings.critique("neuralRewriteCardHeader");break;case $.c.SimilarityChecker:t=this.props.strings.critique("similarityCheckerCardHeader");break;case $.c.TonalRewrite:t=this.props.strings.critique("tonalRewriteCardHeader");break;case $.c.AccColorChecker:t=this.props.strings.critique("accColorCheckerCardHeader");break;default:t=this.props.definition.header}return e.showDictationCommandUx&&!t&&(t=this.props.strings.critique("dictationCorrectionsGroupTitle")),t},t.prototype.getCardSubheaderText=function(){var e,t,o=this.getDefinition(),i=void 0;if(o.isBehindPaywall)return null===(t=(e=this.props.strings).premiumPreview)||void 0===t?void 0:t.call(e,"premiumPreviewSubheader");switch(o.critiqueType){case $.c.Spelling:i=void 0;break;case $.c.RepeatedWord:i=this.props.strings.critique("repeatedWordCardSubheader");break;case $.c.NeuralRewrite:i=this.props.strings.critique("neuralRewriteCardSubheader");break;case $.c.SimilarityChecker:i=this.props.strings.critique("similarityCheckerCardSubheader");break;case $.c.AccColorChecker:i=this.props.strings.critique("accColorCheckerCardSubheader").concat("\n").concat(this.props.strings.critique("accColorCheckerSecondCardSubheader"));break;default:i=o.subheader}return o.showDictationCommandUx&&!i&&(i=this.props.strings.critique("dictationCorrectionCommandCardTitle")),i},t.prototype.renderPreviewMarker=function(){return C.createElement(se.a,{text:this.props.strings.critique("previewHeaderLabel"),style:A.kb(this.getTheme(),this.getFontTable())})},t.prototype.renderCardHeader=function(e){var t=e.critiqueType===$.c.NeuralRewrite||e.critiqueType===$.c.SimilarityChecker||e.critiqueType===$.c.TonalRewrite?this.renderPreviewMarker():void 0,o=this.getCardHeaderText(),i=o?C.createElement(se.a,{text:o,style:A.ab(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}):null,n=i?this.getDefinition().showPremiumIcon?C.createElement(H.a,{direction:z.c.LeftToRight},C.createElement(ae.a,{type:"PremiumDiamond",primaryColor:this.getTheme().header}),C.createElement(H.a,{style:{minWidth:6}}),i):i:null;return t?C.createElement(H.a,{align:z.b.Stretch,direction:z.c.LeftToRight},n,C.createElement(H.a,{style:{flexibleSize:!0,minWidth:16}}),t):n},t.prototype.renderCardFooterTitle=function(e){e.showDictationCommandUx&&this.props.strings.critique("dictationSpelloutCommandCardTitle");return null},t.prototype.renderCardSubheader=function(){var e=this.getCardSubheaderText();return e?C.createElement(se.a,{text:e,style:A.vb(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}):null},t.prototype.renderHeader=function(){var e=this.getDefinition();return C.createElement(H.a,{style:A.Cb,align:z.b.Stretch},this.renderCardHeader(e),this.renderCardSubheader(),this.renderContext(e))},t.prototype.getAllSuggestionOverflowActions=function(){switch(this.getDefinition().critiqueType){case $.c.Spelling:return[$.a.Accept,$.a.ReadAloud,$.a.SpellOut,$.a.ChangeAll,$.a.AddToAutoCorrect,$.a.AutoCorrectOptions];case $.c.Grammar:case $.c.Refinement:case $.c.NeuralRewrite:return[$.a.Accept,$.a.ReadAloud,$.a.SpellOut];case $.c.SimilarityChecker:return[$.a.LearnMore,$.a.ReadAloud,$.a.SpellOut];case $.c.AccColorChecker:return[$.a.LearnMore];default:return[]}},t.prototype.shouldShowSuggestionDescription=function(e){return ot(this.getDefinition(),$.a.Accept,e)&&this.getDefinition().showDescription&&e.subtitle&&e.subtitle.length>0},t.prototype.getSuggestionButtonProps=function(e,t,o,i){var n,r=this,s=this.getDefinition(),a=this.getSuggestionButtonKind(s.critiqueType,e),l=s.critiqueType===$.c.Topic?"#".concat(e.title):e.title,c=l.length,u=et(s,o,e),p=Ze(s,this.props.strings,this.getTheme(),u,o,t),d=void 0!==i?{type:i}:void 0,g={title:l,titleStyle:void 0!==a&&o!==$.a.MoreSources?A.Bb(this.getFontTable(),c):Object(ne.b)(c,this.getTheme(),e.titleDecorations),tag:e.tag,tagStyle:A.L(this.getFontTable()),icon:d,disabled:u,onClick:function(){var e,i;null===(i=(e=r.props).onAction)||void 0===i||i.call(e,o,t)},theme:A.G(this.getTheme(),a),strings:(n=this.props.strings.common,{oneOfManyChoiceButtonAccessibilityLabelAugment:n("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:n("voiceOverSplitButton2AccessibilityHint")}),accessibilityRole:"menuitem",accessibilityLabel:this.getSuggestionAccessibilityLabel(e),automationLabel:"CritiqueSuggestionButton_"+e.id,badgeProps:p};return this.shouldShowSuggestionDescription(e)&&(g.subtitle=e.subtitle,g.subtitleStyle=A.xb(this.getFontTable())),g},t.prototype.getSuggestionButtonKind=function(e,t){if(!(t.titleDecorations&&t.titleDecorations.length>0)){var o=this.getDefinition();if(o.isBehindPaywall)return o.actions&&-1!==o.actions.indexOf($.a.RevealSuggestions)?"refinement":"suggestion";switch(e){case $.c.Grammar:return"grammar";case $.c.Refinement:case $.c.Topic:return"refinement";default:return"suggestion"}}},t.prototype.getSuggestionAccessibilityLabel=function(e){var t=this.getDefinition(),o=e.tagAccessibilityLabel||e.tag||"";return t.critiqueType!==$.c.Spelling&&t.critiqueType!==$.c.NeuralRewrite||!t.showDescription||!e.subtitle||0===e.subtitle.trim().length?o?this.props.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",o).replace("{1}",e.title):void 0:o&&t.critiqueType===$.c.Spelling?this.props.strings.critique("spellingSuggestionTagAndDescriptionAccessibilityLabel").replace("{0}",o).replace("{1}",e.title).replace("{2}",e.subtitle):(t.critiqueType===$.c.Spelling?this.props.strings.critique("spellingSuggestionDescriptionAccessibilityLabel"):this.props.strings.critique("neuralRewriteSuggestionAccessibilityLabel")).replace("{0}",e.title).replace("{1}",e.subtitle)},t.prototype.renderSplitButtonSuggestion=function(e,t,o,i,n,r){var s,a=this.getTheme();return C.createElement(Zi,{key:e,ref:t,buttonProps:o,menuProps:i,style:A.Lb,theme:{splitMenuHoverBackground:a.suggestionMenuHoverBackground,splitMenuHoverForeground:a.suggestionMenuHoverForeground},strings:(s=this.props.strings.common,{defaultSplitButtonOverflowAccessibilityLabel:s("defaultSplitButtonOverflowAccessibilityLabel"),voiceOverSplitButton2AccessibilityHint:s("voiceOverSplitButton2AccessibilityHint")}),accessibilityPositionInSet:void 0!==n?n:1,accessibilitySetSize:void 0!==r?r:1})},t.prototype.renderSingleSuggestion=function(e,t,o,i,n,r,s,a){return[this.renderSplitButtonSuggestion(e,o,this.getSuggestionButtonProps({title:t,actions:n?[]:[i]},e,i,r),void 0,s,a)]},t.prototype.renderActionListAsSuggestions=function(e){var t=this,o=this.getDefinition();return e.filter((function(e){return Je(o,t.props.strings,e)})).map((function(e,i,n){return t.renderSingleSuggestion(i,Je(o,t.props.strings,e),0===i?t.firstSuggestionRef:void 0,e,void 0,Ke(e),i+1,n.length)[0]}))},t.prototype.renderSpecialSuggestions=function(e,t){var o,i,n,r=this;if(e.critiqueType===$.c.RepeatedWord)return this.renderSingleSuggestion(0,this.props.strings.critique("deleteRepeatedWord"),this.firstSuggestionRef,t[0],!1,"Delete");if(e.critiqueType===$.c.SimilarityChecker)return this.renderActionListAsSuggestions(t);if(e.isBehindPaywall){var s=!e.actions||-1===(null===(o=e.actions)||void 0===o?void 0:o.indexOf($.a.RevealSuggestions));return this.renderSingleSuggestion(0,(null===(n=(i=this.props.strings).premiumPreview)||void 0===n?void 0:n.call(i,"premiumPreviewSuggestionTitle"))||"",this.firstSuggestionRef,$.a.RevealSuggestions,s,"Wand")}return[C.createElement(Ee,{key:0,shimmerCount:A.Pb,styles:A.yb(this.getSpacing()),render:function(){var e=r.renderSingleSuggestion(0,r.props.strings.common("suggestionsGroupLoadingSuggestionsText"),void 0,$.a.Accept,!0);return e.length>0?e[0]:null}})]},t.prototype.renderSuggestions=function(){var e=this,t=this.getDefinition(),o=Ye(t,this.props.strings);if(o)return this.renderSpecialSuggestions(t,o);var i=Ve(t),n=i.map((function(o,n){var r=e.renderSplitButtonSuggestion(n,0===n?e.firstSuggestionRef:void 0,e.getSuggestionButtonProps(o,n,$.a.Accept,e.getSuggestionIcon(t.critiqueType,o,i.length)),qe(t,e.getTheme(),e.props.strings,e.getFontTable(),e.getAllSuggestionOverflowActions(),e.getBooleanSetting("NoTooltipForFooterOverflow"),void 0,n,e.props.automationId,e.props.onAction),n+1,i.length);return n>0&&o.tag!==i[n-1].tag?C.createElement(C.Fragment,null,C.createElement(Ce.a,{key:n,color:e.props.theme&&e.props.theme.separator,style:A.Ob}),r):r}));return 0===n.length?this.renderSingleSuggestion(0,t.critiqueType===$.c.NeuralRewrite?this.props.strings.critique("neuralRewriteNoSuggestionsText"):this.props.strings.common("suggestionsGroupNoSuggestionsText"),void 0,$.a.Accept,!0):n},t.prototype.getSuggestionIcon=function(e,t,o){return e===$.c.Classification&&1===o?"Delete":e===$.c.Grammar&&this.props.critiqueSource===i.Inference?"Cloud":e!==$.c.NeuralRewrite||ot(this.getDefinition(),$.a.Accept,t)?void 0:"Info"},t.prototype.renderSourceUrlAsHyperlink=function(e,t){return C.createElement(K.a,{url:e,theme:A.ub(this.getTheme()),style:A.sb(this.getFontTable()),text:t})},t.prototype.renderSourceUrlAsText=function(e){return C.createElement(se.a,{text:e,style:A.tb(this.getTheme(),this.getFontTable())})},t.prototype.renderSource=function(){var e=this.getDefinition(),t=this.props.sourceIndex||0;if(e.sources){var o=e.sources[t].sourceUrl,i=e.sources[t].sourceTitle;if(o&&i){var n=Object(Di.a)(o);return C.createElement(H.a,{style:A.Kb,align:z.b.Stretch},C.createElement(se.a,{text:i,style:A.rb(this.getFontTable(),this.getTheme())}),C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Baseline},C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Baseline,style:{flexibleSize:!0}},e.sourceUrlClickable?this.renderSourceUrlAsHyperlink(o,n):this.renderSourceUrlAsText(n)),C.createElement(se.a,{text:this.props.strings.critique("poweredByBing"),style:A.jb(this.getFontTable())})))}}},t.prototype.generateButtonProps=function(e,t,o){var i=this;return{onClick:function(){i.props.onAction&&i.props.onAction($.a.ApplyColor,o)},hoverRing:!0,style:A.E(),theme:A.F(e),automationLabel:"ColorPickerButton_".concat(this.props.automationId),tooltip:t}},t.prototype.renderColors=function(){var e=this,t=(this.getDefinition().suggestions||[]).map((function(t,o){return C.createElement(be.a,Qi({key:t.id,ref:0===o?e.firstSuggestionButtonRef:void 0},e.generateButtonProps(t.title,t.subtitle,o)))}));return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Start,justifyContent:z.d.Start,style:A.h},t)},t.prototype.renderHelpLink=function(){var e=this.getDefinition();if(e.helpLink)return C.createElement(H.a,{direction:z.c.LeftToRight,style:A.Fb,align:z.b.Stretch},C.createElement(K.a,{text:e.helpLink.text,url:e.helpLink.url,theme:A.cb(this.getTheme()),style:A.bb(this.getFontTable())}))},t.prototype.renderBodySuggestions=function(){var e=this.getDefinition();return C.createElement(H.a,{align:z.b.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:e.critiqueType!==$.c.SimilarityChecker?this.props.strings.critique("suggestionsGroupAccessibilityLabel"):void 0},this.renderSuggestions())},t.prototype.renderBody=function(){var e=this.getDefinition();return C.createElement(H.a,{align:z.b.Stretch},e.critiqueType===$.c.SimilarityChecker?this.renderSource():void 0,C.createElement(J,null,e.critiqueType===$.c.AccColorChecker?this.renderColors():this.renderBodySuggestions()),this.renderHelpLink())},t.prototype.renderFooterTitle=function(){var e=this.getDefinition(),t=this.renderCardFooterTitle(e);return t?C.createElement(H.a,{style:A.Cb,align:z.b.Stretch},t):null},t.prototype.renderAddOnFooter=function(){var e=this;if(!this.props.addOnFooterData)return null;var t,o,i=this.props.addOnFooterData,n={onClick:function(){var t,o;null===(o=(t=e.props).onAction)||void 0===o||o.call(t,$.a.AddOnFooterAction)},style:A.a,theme:Li(this.getTheme()),automationLabel:"AddonFooterButton_".concat(i.actionText,"_").concat(this.props.automationId)};return C.createElement(H.a,{style:(o=this.getTheme(),{paddingHorizontal:A.g,paddingVertical:9,backgroundColor:o.addOnFooterBackground}),direction:z.c.LeftToRight,align:z.b.Center,accessible:!0,accessibilityLabel:i.message},i.icon&&C.createElement(C.Fragment,null,C.createElement(ae.a,{type:i.icon,primaryColor:Pi(this.getTheme()),fontSize:(t=this.getFontTable(),t.xsmall)}),C.createElement(H.a,{style:{width:8}})),this.getAddOnFooterFormattedText(),C.createElement(H.a,{style:{width:4}}),C.createElement(be.a,Qi({},n),C.createElement(se.a,{text:i.actionText,style:Ri(this.getTheme(),this.getFontTable(),!0)})))},t.prototype.getAddOnFooterFormattedText=function(){if(this.props.addOnFooterData){var e=this.props.addOnFooterData;return C.createElement(se.a,{text:e.message,style:Ri(this.getTheme(),this.getFontTable(),!1),formatting:e.footerDecorations?Object(ne.b)(e.message.length,this.getTheme(),e.footerDecorations):void 0})}},t.prototype.getTheme=function(){return this.props.theme?this.props.theme:A.k},t.prototype.getFontTable=function(){return this.props.fontTable?this.props.fontTable:A.l},t.prototype.getSpacing=function(){return this.props.spacing?this.props.spacing:A.m},t.contextMaxLength=120,t}(C.Component),Xi=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Ji=function(){return(Ji=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!function(e){e[e.Default=0]="Default",e[e.ReportRewriteSuggestions=1]="ReportRewriteSuggestions",e[e.Feedback=2]="Feedback"}(Wi||(Wi={}));var Ki=function(e){function t(t){var o=e.call(this,t)||this;return o.reportSuggestionsRadioGroupRef=C.createRef(),o.innerCritiqueRef=C.createRef(),o.onRewriteSelectFeedbackSuggestion=o.onRewriteSelectFeedbackSuggestion.bind(o),o.onRewriteReportSuggestionCancel=o.onRewriteReportSuggestionCancel.bind(o),o.onRewriteReportSuggestionNext=o.onRewriteReportSuggestionNext.bind(o),o.onCritiqueCardClick=o.onCritiqueCardClick.bind(o),o.onFeedbackCardBack=o.onFeedbackCardBack.bind(o),o.onFeedbackCardDismiss=o.onFeedbackCardDismiss.bind(o),o.onFeedbackCardReport=o.onFeedbackCardReport.bind(o),o.state={definition:t.definition,rewriteState:Wi.Default,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1},o}return Xi(t,e),t.isRewriteFeedbackNegative=function(e){return e!==Mi.a.FeedbackOptionHelpful},t.prototype.setDefinition=function(e){this.setState({definition:e})},t.prototype.executeBadgedAction=function(e){this.innerCritiqueRef.current&&this.innerCritiqueRef.current.executeBadgedAction(e)},t.prototype.componentDidUpdate=function(e,t){if(e.definition!==this.props.definition&&this.setState({definition:this.props.definition}),t.rewriteState!==this.state.rewriteState)switch(this.state.rewriteState){case Wi.ReportRewriteSuggestions:this.reportSuggestionsRadioGroupRef.current&&this.reportSuggestionsRadioGroupRef.current.focus();break;default:this.innerCritiqueRef.current&&this.innerCritiqueRef.current.focus()}},t.prototype.focus=function(){this.innerCritiqueRef.current&&this.innerCritiqueRef.current.focus()},t.prototype.render=function(){var e=this,t=this.getDefinition();if(!t||!t.suggestions)return null;switch(this.state.rewriteState){case Wi.Default:var o=t.suggestions.map((function(o){if(e.isSuggestionReportedNegative(o.title))return Ji(Ji({},o),{actions:o.actions.filter((function(e){return e!==$.a.Accept})),title:e.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"),subtitle:void 0,titleDecorations:void 0});if(void 0===o.titleDecorations&&t.contextText){var i=function(e,t){var o=t.length,i=function(e,t){for(var o=e.length,i=t.length,n=0,r=0,s=0;s<Math.min(o,i)&&e.charAt(s)===t.charAt(s);s++)n++,Di.b(e.charCodeAt(s))&&(r=n);return r}(e,t),n=Math.min(function(e,t){for(var o=e.length,i=t.length,n=0,r=0,s=0;s<Math.min(o,i)&&e.charAt(o-s-1)===t.charAt(i-s-1);s++)n++,Di.b(e.charCodeAt(o-s-1))&&(r=n);return r}(e,t),Math.min(o,e.length)-i),r=i+n,s=o-r,a=Math.min(130,s),l=Math.min(150-a,r),c=Math.min(l,i),u=Math.min(l,n),p=function(e,t,o){var i,n,r=e/2;t<r&&o<r?(i=t,n=o):t<r?(i=t,n=Math.min(o,e-i)):o<r?(n=o,i=Math.min(t,e-n)):(i=r,n=r);return{actualLeftContextLength:i,actualRightContextLength:n}}(l,c,u),d=p.actualLeftContextLength,g=p.actualRightContextLength,h=t.substring(i-d,i),m=t.substring(i,o-n),y=t.substring(o-n,o-n+g),f=h,b=m,v=y;if(i>d){var S=$i(h,0,h.length,!0);f="..."+h.substring(S,h.length)}if(m.length>a){var x=$i(m,0,a/2,!1),C=$i(m,a/2,m.length,!0);b=m.substring(0,x)+"..."+m.substring(C,m.length)}if(n>g){var T=$i(y,0,y.length,!1);v=y.substring(0,T)+"..."}return{truncatedPrefix:f,truncatedSubstring:b,truncatedSuffix:v,target:m,commonPrefixLength:i,commonSuffixLength:n}}(t.contextText,o.title),n=i.commonPrefixLength,r=i.commonSuffixLength;return Ji(Ji({},o),{titleDecorations:[{start:n,length:o.title.length-n-r,decorationType:$.d.Rewrite}]})}return o})),i=Ji(Ji({},this.props),{definition:Ji(Ji({},t),{suggestions:o}),onAction:this.onCritiqueCardClick});return C.createElement(Yi,Ji({},i,{ref:this.innerCritiqueRef}));case Wi.Feedback:return this.renderFeedback();case Wi.ReportRewriteSuggestions:return C.createElement(H.a,{direction:z.c.TopToBottom,style:A.pb(this.getTheme(),this.props.style),align:z.b.Stretch},this.renderHeader(),this.renderReportSuggestions(),this.renderFooter())}},t.prototype.getDefinition=function(){return this.state.definition},t.prototype.getTheme=function(){return this.props.theme||A.k},t.prototype.getFontTable=function(){return this.props.fontTable||A.l},t.prototype.getSpacing=function(){return this.props.spacing||A.m},t.prototype.onCritiqueCardClick=function(e,t){e===$.a.Feedback&&this.setState({rewriteState:Wi.ReportRewriteSuggestions,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1}),this.props.onAction&&this.props.onAction(e,t)},t.prototype.onFeedbackCardDismiss=function(){this.setState({rewriteState:Wi.Default})},t.prototype.onFeedbackCardBack=function(){this.setState({rewriteState:Wi.ReportRewriteSuggestions,rewriteChoiceGroupSelected:!0})},t.prototype.renderFeedback=function(){var e=this.getDefinition(),t=this.getIndexOfReportedSuggestion(),o=Ji(Ji({},this.props),{style:void 0,reportedSuggestionIndex:t,showCheckbox:!0,definition:e,onBack:this.onFeedbackCardBack,onDismiss:this.onFeedbackCardDismiss,onReport:this.onFeedbackCardReport});return C.createElement(Mi.a,Ji({},o))},t.prototype.isSuggestionReportedNegative=function(e){return t.suggestionsReportedNegative.indexOf(e)>=0},t.prototype.isSuggestionAlreadyReported=function(e){return t.reportedSuggestions.indexOf(e)>=0},t.prototype.renderReportSuggestions=function(){var e=this,t=this.getDefinition();if(!t||!t.suggestions)return null;var o=t.suggestions.filter((function(e){return!(!e||!e.id&&t.critiqueType!==$.c.Grammar||!e.title)})).map((function(o){var i,n=o,r=n.title,s=e.isSuggestionReportedNegative(r),a=e.isSuggestionAlreadyReported(r);return t.critiqueType===$.c.Grammar&&(n.id=null===(i=t.suggestions)||void 0===i?void 0:i.indexOf(n).toString()),{key:n.id,disabled:a,text:s?e.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"):r}})).filter((function(e,t){return t<A.Gb}));return 0===o.length?null:C.createElement(Ei.a,{onChange:this.onRewriteSelectFeedbackSuggestion,styles:A.Mb,radioChoiceTextStyles:A.ob(this.getTheme()),options:o,ref:this.reportSuggestionsRadioGroupRef,defaultSelectedKey:this.state.rewriteReportedSuggestionId,accessibilityLabel:this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionTitle")})},t.prototype.onRewriteSelectFeedbackSuggestion=function(e){e&&this.setState({rewriteReportedSuggestionId:e.key,rewriteChoiceGroupSelected:!0})},t.prototype.renderHeader=function(){var e=this.getTheme(),t=this.getFontTable(),o=this.props.definition.critiqueType===$.c.Grammar?this.props.strings.feedback("grammarFeedbackDialogChooseSuggestionTitle"):this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionTitle");return C.createElement(H.a,{direction:z.c.TopToBottom,style:A.Db,align:z.b.Stretch,accessibleLive:z.a.Polite},C.createElement(se.a,{text:o,style:A.vb(e,t),accessibilityRole:"heading"}),C.createElement(se.a,{text:this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionDescription"),style:A.M(e,t),accessibilityRole:"text"}))},t.prototype.renderFooterButton=function(e,t,o,i,n){return C.createElement(be.a,{title:e,titleStyle:A.X(this.getFontTable(),e.length),onClick:t,theme:A.nb(this.getTheme(),i),disabled:o,style:A.B,ref:n,automationLabel:"CritiqueActionButton_".concat(e,"_").concat(this.props.automationId)})},t.prototype.renderFooter=function(){return C.createElement(H.a,{direction:z.c.TopToBottom,justifyContent:z.d.SpaceBetween,style:A.t,align:z.b.Stretch},C.createElement(H.a,{direction:z.c.LeftToRight,justifyContent:z.d.End,style:A.A,align:z.b.Stretch},this.renderFooterButton(this.props.strings.common("cancelButton"),this.onRewriteReportSuggestionCancel),C.createElement(H.a,{style:{minWidth:this.getSpacing().small}}),this.renderFooterButton(this.props.strings.common("nextButton"),this.onRewriteReportSuggestionNext,!this.state.rewriteChoiceGroupSelected,!0)))},t.prototype.onRewriteReportSuggestionCancel=function(){this.setState({rewriteState:Wi.Default,rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})},t.prototype.onRewriteReportSuggestionNext=function(){this.setState({rewriteState:Wi.Feedback,rewriteChoiceGroupSelected:!1})},t.prototype.getIndexOfReportedSuggestion=function(){var e=this.state.rewriteReportedSuggestionId,t=this.getDefinition();if(t.suggestions)for(var o=0;o<t.suggestions.length;o++){var i=t.suggestions[o];if(i&&i.id===e)return i&&i.title?o:-1}},t.prototype.onFeedbackCardReport=function(e,o){var i=this.getDefinition();if(this.state.rewriteReportedSuggestionId&&i.suggestions){var n=this.getIndexOfReportedSuggestion();if(void 0!==n){var r=i.suggestions[n].title;this.props.onAction&&this.props.onAction($.a.Report,n,{action:"feedback",type:i.critiqueType,option:e.option,comments:e.comments,payload:e.payload}),this.isSuggestionAlreadyReported(r)||i.critiqueType===$.c.Grammar||t.reportedSuggestions.push(r),void 0!==e.option&&t.isRewriteFeedbackNegative(e.option)&&!this.isSuggestionReportedNegative(r)&&i.critiqueType!==$.c.Grammar&&t.suggestionsReportedNegative.push(r),this.setState({rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}}},t.reportedSuggestions=[],t.suggestionsReportedNegative=[],t}(C.Component);function $i(e,t,o,i){if(i){for(;!Di.b(e.charCodeAt(t))&&t<o;)++t;return t}for(var n=o;!Di.b(e.charCodeAt(o))&&o>t;)--o;return o+1<=n&&++o,o}function en(e){var t,o=tn(e.strings,null!==(t=e.credits)&&void 0!==t?t:0),i=o.text,n=o.textDecorations;return C.createElement(se.a,{text:i,accessibilityLabel:i,style:Bi(e.theme,e.fontTable,!1),formatting:Object(ne.b)(i.length,e.theme,n)})}function tn(e,t){var o,i=e(1===t?"premiumPreviewAddOnHeaderTextSingular":"premiumPreviewAddOnHeaderText"),n=[];return t?(n=[{decorationType:$.d.PremiumPreviewCredits,start:i.indexOf("{0}"),length:t.toString().length}],o=i.replace("{0}",t.toString())):o=e("premiumPreviewAddOnHeaderNoCredits"),{text:o,textDecorations:n}}var on=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),nn=function(){return(nn=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},rn=function(e){function t(t){var o=e.call(this,t)||this;return o.onClick=function(e,t,i,n){var r,s,a=o.props,l=a.children,c=a.definition;if(null===(s=(r=l.props).onAction)||void 0===s||s.call(r,e,t,i,n),e===$.a.RevealSuggestions){var u=o.props.definition.credits;c.credits=u?u-1:0,o.setState({isRevealed:!0})}},o.state={isRevealed:!1},o}return on(t,e),t.prototype.render=function(){var e=this.props.style;return C.createElement(H.a,{align:z.b.Stretch,style:A.pb(this.getTheme(),e)},this.renderAddOnHeader(),this.renderCritiqueChild())},t.prototype.renderCritiqueChild=function(){return this.state.isRevealed?this.props.children:C.createElement(Yi,{definition:this.premiumCritiqueDefinition(),onAction:this.onClick,strings:this.props.strings,theme:this.props.theme})},t.prototype.renderAddOnHeader=function(){var e,t=this.props.strings.premiumPreview,o=this.props.definition.credits,i=t("premiumPreviewUpgradeEditor"),n=tn(t,o).text,r=this.props,s=r.onAction,a=r.automationId,l={onClick:function(){null==s||s($.a.GoPremium)},style:A.a,theme:Li(this.getTheme()),automationLabel:"AddonHeaderButton_".concat(i,"_").concat(a)};return C.createElement(H.a,{style:(e=this.getTheme(),{paddingHorizontal:A.g,paddingVertical:10,backgroundColor:e.addOnHeaderBackground,borderRadius:6}),direction:z.c.LeftToRight,align:z.b.Center,accessible:!0,accessibilityLabel:n},C.createElement(ae.a,{type:"PremiumDiamond",primaryColor:Pi(this.getTheme()),fontSize:this.getFontTable().medium}),C.createElement(H.a,{style:{width:8}}),C.createElement(en,{fontTable:this.getFontTable(),strings:t,theme:this.getTheme(),credits:o||0}),C.createElement(H.a,{style:{width:4}}),C.createElement(be.a,nn({},l),C.createElement(se.a,{text:i,style:Bi(this.getTheme(),this.getFontTable(),!0)})))},t.prototype.premiumCritiqueDefinition=function(){var e=this,t=[$.a.Previous,$.a.Next,$.a.OpenEditorPane].filter((function(t){var o;return-1!==(null===(o=e.props.definition.actions)||void 0===o?void 0:o.indexOf(t))}));this.props.definition.credits&&t.push($.a.RevealSuggestions);var o=this.props.definition,i=o.critiquePosition,n=o.critiqueSetSize,r=o.brandingMode;return{critiqueType:o.critiqueType,header:o.header,definitionType:"CritiqueDefinition",suggestions:[],actions:t,critiquePosition:i,critiqueSetSize:n,brandingMode:r,isBehindPaywall:!0}},t.prototype.getTheme=function(){var e=this.props.theme;return e||A.k},t.prototype.getFontTable=function(){var e=this.props.fontTable;return e||A.l},t}(C.Component),sn=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),an=function(){return(an=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},ln=function(e){function t(t){var o=e.call(this,t)||this;return o.handleClick=o.handleClick.bind(o),o.state={textColor:"#185ABD"},o}return sn(t,e),t.prototype.handleClick=function(){this.props.onAction($.a.OpenCustomDictionary),this.setState({textColor:"#13458F"})},t.prototype.render=function(){var e=this;return C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Center,style:A.d},C.createElement(ae.a,{type:"Completed"}),C.createElement(H.a,{direction:z.c.LeftToRight,align:z.b.Start,style:{marginStart:8}},C.createElement(se.a,{text:'"'.concat(this.props.addedWord,'" ').concat(this.props.messageText).concat(" "),style:A.e})),C.createElement(be.a,{automationLabel:"AddToDictionaryPopUp",accessibilityRole:"button",style:A.b,onClick:this.handleClick,theme:A.c,accessibilityLabel:this.props.ariaLabel,onHoverIn:function(){return e.setState({textColor:"#1651AA"})},onHoverOut:function(){return e.setState({textColor:"#185ABD"})}},C.createElement(se.a,{text:" ".concat(this.props.yourDictionaryText),style:an(an({},A.f),{cssColor:this.state.textColor})})),C.createElement(se.a,{text:".",style:A.e}))},t}(C.PureComponent),cn={backButton:"BackButton",cancelButton:"CancelButton",closeButton:"CloseButton",defaultOverflowButtonAccessibilityLabel:"defaultOverflowButtonAccessibilityLabel",defaultSplitButtonOverflowAccessibilityLabel:"DefaultSplitButtonOverflowAccessibilityLabel",doneButton:"DoneButton",nextButton:"NextButton",oneOfManyChoiceButtonAccessibilityLabelAugment:"OneOfManyChoiceButtonAccessibilityLabelAugment",submitButton:"SubmitButton",suggestionsGroupLoadingSuggestionsText:"SuggestionsGroupLoadingSuggestionsText",suggestionsGroupNoSuggestionsText:"SuggestionsGroupNoSuggestionsText",voiceOverSplitButton2AccessibilityHint:"VoiceOverSplitButton2AccessibilityHint"},un={accAssistant:"AccAssistant",accColorCheckerCardHeader:"AccColorCheckerCardHeader",accColorCheckerCardSubheader:"AccColorCheckerCardSubheader",accColorCheckerSecondCardSubheader:"AccColorCheckerSecondCardSubheader",accessibilityLabelForEditorButton:"AccessibilityLabelForEditorButton",addInTextCitation:"InlineCitationButtonText",addToAutoCorrect:"addToAutoCorrect",addToDictionary:"addToDictionary",allowAccIssue:"AllowAccIssue",allowAllAccIssues:"AllowAllAccIssues",autoCorrectOptions:"autoCorrectOptions",changeAll:"changeAll",copyFullCitation:"FullCitationButtonText",deleteRepeatedWord:"DeleteRepeatedWord",dictationCorrectionCommandCardTitle:"DictationCorrectionCommandCardTitle",dictationCorrectionsGroupTitle:"DictationCorrectionsGroupTitle",dictationSpelloutCommandCardTitle:"DictationSpelloutCommandCardTitle",editorButtonText:"EditorButtonText",editorButtonCiqPreviewTooltipContent:"EditorButtonCiqPreviewTooltipContent",editorButtonTooltipContent:"EditorButtonTooltipContent",explanationFlyoutAccessibilityLabel:"ExplanationFlyoutAccessibilityLabel",footerExplanationButtonAccessibilityLabel:"FooterExplanationButtonAccessibilityLabel",footerSeeMoreActionsAccessibilityLabel:"OverflowButtonAccessibilityLabel",giveFeedbackButtonText:"GiveFeedbackButtonText",grammarCardHeader:"GrammarCardHeader",hideContext:"HideContextButtonText",hideExplanationButtonText:"HideExplanationButtonText",hideSynonyms:"HideSynonymsButtonText",ignoreAll:"IgnoreAllButtonText",ignoreOnce:"IgnoreButtonText",ignoreRule:"ignoreRule",learnMore:"LearnMoreButtonText",microsoftEditorBranding:"MicrosoftEditorBranding",microsoftEditorBrandingAccessibilityLabel:"MicrosoftEditorBrandingAccessibilityLabel",moreColors:"MoreColors",moreSources:"MoreSources",neuralRewriteCardHeader:"NeuralRewriteCardHeader",neuralRewriteCardSubheader:"NeuralRewriteCardSubheader",neuralRewriteNoSuggestionsText:"NeuralRewriteNoSuggestionsText",neuralRewriteSuggestionAccessibilityLabel:"NeuralRewriteSuggestionAccessibilityLabel",nextIssue:"NextButtonText",nextIssueWithCount:"NextIssueWithCount",options:"OptionsButtonText",poweredByBing:"PoweredByBing",previewHeaderLabel:"PreviewHeaderLabel",previousIssue:"PreviousButtonText",previousIssueWithCount:"PreviousIssueWithCount",readAloud:"",readAloudOriginalSentenceAccessibilityLabel:"",repeatedWordCardSubheader:"RepeatedWordCardSubheader",sensitiveContentCardHeader:"SensitiveContentCardHeader",showContext:"ShowContextButtonText",showExplanationButtonText:"ShowExplanationButtonText",showMenuButtonText:"ShowMenuButtonText",showSynonyms:"ShowSynonymsButtonText",similarityCheckerCardHeader:"SimilarityCheckerCardHeader",similarityCheckerCardSubheader:"SimilarityCheckerCardSubheader",spellOut:"spellOut",spellingCardHeader:"SpellingCardHeader",spellingSuggestionDescriptionAccessibilityLabel:"spellingSuggestionDescriptionAccessibilityLabel",spellingSuggestionTagAndDescriptionAccessibilityLabel:"SpellingSuggestionTagAndDescriptionAccessibilityLabel",suggestionWithTagAccessibilityLabel:"SuggestionWithTagAccessibilityLabel",suggestionsGroupAccessibilityLabel:"suggestionsGroupAccessibilityLabel",tonalRewriteCardHeader:"TonalRewriteCardHeader",turnOffAccChecker:"TurnOffAccChecker"},pn={contrastIssueExplanation:"ContrastIssueExplanation",contrastIssueExplanationTitle:"ContrastIssueExplanationTitle",exampleText:"ExampleText",explanationTableAccessibilityLabel:"ExplanationTableAccessibilityLabel",explanationTableAfter:"ExplanationTableAfter",explanationTableBefore:"ExplanationTableBefore",explanationTableSeparator:"ExplanationTableSeparator",goodContrast:"GoodContrast",poorContrast:"PoorContrast"},dn={accColorsFeedbackDialogChooseOptionTitle:"AccColorsFeedbackDialogChooseOptionTitle",accColorsFeedbackHelpfulLabel:"AccColorsFeedbackHelpfulLabel",accColorsFeedbackNotHelpfulLabel:"AccColorsFeedbackNotHelpfulLabel",accColorsFeedbackOtherLabel:"AccColorsFeedbackOtherLabel",grammarFeedbackConfirmationDialogTitle:"NeuralRewriteFeedbackConfirmationDialogTitle",grammarFeedbackDialogCheckboxLabel:"GrammarFeedbackDialogCheckboxLabel",grammarFeedbackDialogChooseOptionTitle:"GrammarFeedbackDialogChooseOptionTitle",grammarFeedbackDialogChooseSuggestionTitle:"GrammarFeedbackDialogChooseSuggestionTitle",grammarFeedbackDialogDescription:"GrammarFeedbackDialogDescription",grammarSuggestionLabel:"GrammarSuggestionLabel",neuralRewriteFeedbackConfirmationDialogSubTitle:"NeuralRewriteFeedbackConfirmationDialogSubTitle",neuralRewriteFeedbackConfirmationDialogTitle:"NeuralRewriteFeedbackConfirmationDialogTitle",neuralRewriteFeedbackDialogCheckboxLabel:"NeuralRewriteFeedbackDialogCheckboxLabel",neuralRewriteFeedbackDialogChooseOptionTitle:"NeuralRewriteFeedbackDialogChooseOptionTitle",neuralRewriteFeedbackDialogChooseSuggestionDescription:"NeuralRewriteFeedbackDialogChooseSuggestionDescription",neuralRewriteFeedbackDialogChooseSuggestionTitle:"NeuralRewriteFeedbackDialogChooseSuggestionTitle",neuralRewriteFeedbackDialogDescription:"NeuralRewriteFeedbackDialogDescription",neuralRewriteFeedbackDialogPrivacyStatementLabel:"NeuralRewriteFeedbackDialogPrivacyStatementLabel",neuralRewriteFeedbackDialogPrivacyStatementURL:"NeuralRewriteFeedbackDialogPrivacyStatementURL",neuralRewriteFeedbackDialogTextBoxPlaceholder:"NeuralRewriteFeedbackDialogTextBoxPlaceholder",originalSentenceLabel:"OriginalSentenceLabel",provideAccColorsFeedbackHeaderText:"ProvideAccColorsFeedbackHeaderText",provideFeedbackHeaderText:"ProvideFeedbackHeaderText",rewriteSuggestionLabel:"RewriteSuggestionLabel",similarityFeedbackConfirmationDialogSubTitle:"SimilarityFeedbackConfirmationDialogSubTitle",similarityFeedbackConfirmationDialogTitle:"SimilarityFeedbackConfirmationDialogTitle",similarityFeedbackDialogChooseOptionTitle:"SimilarityFeedbackDialogChooseOptionTitle",similarityFeedbackHelpfulLabel:"SimilarityFeedbackHelpfulLabel",similarityFeedbackIncludeDocumentTextAndSourceUrl:"SimilarityFeedbackIncludeDocumentTextAndSourceUrl",similarityFeedbackOffensiveContentLabel:"SimilarityFeedbackOffensiveContentLabel",similarityFeedbackOriginalContentLabel:"SimilarityFeedbackOriginalContentLabel",similarityFeedbackOtherLabel:"SimilarityFeedbackOtherLabel",similarityFeedbackWrongSourceLabel:"SimilarityFeedbackWrongSourceLabel",similarityfeedbackOptionsAccessibilityLabel:"SimilarityfeedbackOptionsAccessibilityLabel",suggestionFeedbackConsumerPrivacyNotice:"SuggestionFeedbackConsumerPrivacyNotice",suggestionFeedbackHelpfulLabel:"SuggestionFeedbackHelpfulLabel",suggestionFeedbackOffensiveLabel:"SuggestionFeedbackOffensiveLabel",suggestionFeedbackOtherLabel:"SuggestionFeedbackOtherLabel",suggestionFeedbackWrongLabel:"SuggestionFeedbackWrongLabel"},gn={neuralRewriteReportedSuggestionTitle:"NeuralRewriteReportedSuggestionTitle"},hn={premiumPreviewAddOnHeaderNoCredits:"premiumPreviewAddOnHeaderNoCredits",premiumPreviewAddOnHeaderText:"premiumPreviewAddOnHeaderText",premiumPreviewAddOnHeaderTextSingular:"premiumPreviewAddOnHeaderTextSingular",premiumPreviewSubheader:"premiumPreviewSubheader",premiumPreviewSuggestionTitle:"premiumPreviewSuggestionTitle",premiumPreviewUpgradeEditor:"premiumPreviewUpgradeEditor"},mn={contextAccessibilityLabelForCorrection:"ContextAccessibilityLabelForCorrection",contextAccessibilityLabelForGrammar:"ContextAccessibilityLabelForGrammar",contextAccessibilityLabelForRefinement:"ContextAccessibilityLabelForRefinement",contextAccessibilityLabelForRepeatedWord:"ContextAccessibilityLabelForRepeatedWord",contextAccessibilityLabelForSpelling:"ContextAccessibilityLabelForSpelling"},yn={clearSearchLabel:"ClearSearchLabel",somethingWentWrongLabel:"SomethingWentWrongLabel",tryAgainLabel:"TryAgainLabel",seeMoreHyperLinkLabel:"SeeMoreHyperLinkLabel"},fn={undoInsertSummary:"UndoInsertSummary",refreshSummary:"RefreshSummary",giveFeedback:"GiveFeedbackButtonText"};function bn(e){return{common:function(t){return e[cn[t]]},critique:function(t){return e[un[t]]},critiqueExplanation:function(t){return e[pn[t]]},feedback:function(t){return"suggestionFeedbackFactuallyIncorrectLabel"===t||"writersUnblockDialogCheckboxLabel"===t||"writersUnblockFeedbackConfirmationDialogSubTitle"===t||"writersUnblockFeedbackConfirmationDialogTitle"===t||"writersUnblockFeedbackDialogChooseOptionTitle"===t||"writersUnblockFeedbackDialogDescription"===t?"":e[dn[t]]},neuralRewrite:function(t){return e[gn[t]]},premiumPreview:function(t){return e[hn[t]]},textFormatting:function(t){return e[mn[t]]},inlineSuggestions:function(t){return"suggestionsGroupSearchResultAccessibilityLabel"===t?"":e[yn[t]]},summarization:function(t){return e[fn[t]]}}}function vn(e,t){if(t&&e&&e.length)return e.map((function(e){return e?{start:e.start,length:e.length,decorationType:On(e)}:void 0})).filter((function(e){return!!e}))}function Sn(e){return e?e.filter((function(e){return!!e})).map((function(e){return{id:(t=e).id||void 0,title:t.title||"",titleDecorations:vn(t.titleFormatting,t.title),subtitle:t.description||void 0,actions:Cn(t.supportedActions)};var t})):[]}function xn(e,t,o,i){var n=[$.a.Accept,$.a.Feedback,$.a.IgnoreOnce,$.a.Next,$.a.Previous,$.a.ToggleContext,$.a.ToggleDescription];return t===$.c.Spelling&&Tn(e,co.AddToDictionary)&&n.push($.a.AddToDictionary),t===$.c.Grammar||t===$.c.Refinement?Tn(e,co.Options)&&n.push($.a.Options):n.push($.a.IgnoreAll),(Tn(e,co.OpenEditorPane)||o)&&n.push($.a.OpenEditorPane),t===$.c.Refinement&&"b1634cf9-5f68-42f4-82ca-e668f893d28f"!==i&&(n=n.filter((function(e){return e!==$.a.Feedback}))),t===$.c.DictationCorrection&&(n=Cn(e)),n}function Cn(e){return e?e.map((function(e){return function(e){switch(e){case co.Apply:case co.Accepted:return $.a.Accept;case co.IgnoreOnce:return $.a.IgnoreOnce;case co.IgnoreAll:return $.a.IgnoreAll;case co.Options:return $.a.Options;case co.Next:return $.a.Next;case co.Back:return $.a.Previous;case co.OpenEditorPane:return $.a.OpenEditorPane;case co.InvokeOnAddOnFooter:return $.a.AddOnFooterAction;case co.ShowExplanation:return $.a.ShowExplanation;case co.AddToDictionary:return $.a.AddToDictionary}return null}(e)})).filter((function(e){return null!=e})):[]}function Tn(e,t){return!!e&&t&&-1!==e.findIndex((function(e){return e===t}))}function An(e){switch(e){case $.a.Accept:return co.Apply;case $.a.IgnoreOnce:return co.IgnoreOnce;case $.a.IgnoreAll:return co.IgnoreAll;case $.a.Options:return co.Options;case $.a.Next:return co.Next;case $.a.Previous:return co.Previous;case $.a.ToggleContext:case $.a.ToggleDescription:return co.Toggle;case $.a.Report:return co.Report;case $.a.OpenEditorPane:return co.OpenEditorPane;case $.a.AddOnFooterAction:return co.InvokeOnAddOnFooter;case $.a.ShowExplanation:return co.ShowExplanation;case $.a.AddToDictionary:return co.AddToDictionary;case $.a.Feedback:return co.GiveFeedback;case $.a.RevealSuggestions:return co.RevealSuggestions}return null}function wn(e){if(e&&e.actionText&&e.labelText)return{message:e.labelText,actionText:e.actionText}}function On(e){switch(e.underlineType){case po.SpellingSquiggle:return $.d.Spelling;case po.GrammarSquiggle:return $.d.Grammar;case po.CritiqueSquiggle:return $.d.Refinement}return e.cssColor===Ro?$.d.Rewrite:$.d.None}function kn(e){if((null==e?void 0:e.url)&&(null==e?void 0:e.text))return{url:e.url,text:e.text}}var In=o(1802),_n=o(2774),Dn=function(e){function t(t){var o,i,n=this;return(n=e.call(this,t)||this).enableFeedbackForGrammar=Object(c.b)("Microsoft.Office.WordOnline.GrammarFeedbackIsEnabled",!1),n.innerCritique=C.createRef(),n.onInnerCritiqueClick=n.onInnerCritiqueClick.bind(n),Object(In.b)(new _n.a),null===(i=(o=t.dependencies).loadUpsellDependencies)||void 0===i||i.call(o),n.state={showingContext:n.props.parameters.showSnippet,showingDescription:n.props.parameters.showDescription,showingCustomDictionaryPopUpMessage:!1},n}return Object(l.__extends)(t,e),t.prototype.critiqueComponent=function(){var e=this.convertCritiqueType();return e===$.c.NeuralRewrite||this.enableFeedbackForGrammar&&e===$.c.Grammar||"b1634cf9-5f68-42f4-82ca-e668f893d28f"===this.props.group.critiqueSubType?Ki:Yi},t.prototype.isSoftPaywallEnabled=function(){var e;return Object(c.b)("Microsoft.Office.WordOnline.FA000000029.EditorSoftPaywallEnabled",!1)&&!!(null===(e=this.getSoftPaywallProvider())||void 0===e?void 0:e.softPaywallData.isEnabled)},t.prototype.getSoftPaywallProvider=function(){var e,t;return null===(t=(e=this.props.dependencies).getSoftPaywallData)||void 0===t?void 0:t.call(e)},t.prototype.getPremiumPreviewCredits=function(){var e=this.getSoftPaywallProvider();if(void 0!==e){var t=e.softPaywallData;if(void 0!==t){var o=Number(t.credits);return o>0?o:0}u.a.sendTraceTag(520218528,p.a.msoulscat_Wac_Telemetry,d.a.Error,"SoftPaywall data initialization failed")}else u.a.sendTraceTag(520218529,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Resolving SoftPaywall failed in CritiqueAdapter")},t.prototype.spendCredit=function(){var e=this.getSoftPaywallProvider();void 0!==e?(e.spendCredit(),u.a.sendTraceTag(520218526,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Soft paywall spend credit action"+JSON.stringify({critiqueType:this.props.group.critiqueSubType,credits:this.getPremiumPreviewCredits()}))):u.a.sendTraceTag(520218527,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Resolving SoftPaywall failed while spending credit")},t.prototype.renderSharedCritique=function(){var e,t,o=this.convertCritiqueType();if(null==o)return null;var i=this.critiqueComponent(),n=this.getCritiqueProps(o),r=C.createElement("div",{id:this.headerId(),"aria-label":this.getCardHeaderText()},C.createElement(i,Object(l.__assign)({ref:this.innerCritique},n)));if(!this.isSoftPaywallEnabled())return r;var s=null===(t=(e=this.props.dependencies).getPremiumPreviewCritiquesList)||void 0===t?void 0:t.call(e),a=(null==s?void 0:s.isCritiqueTypeUnderPaywall(this.props.group.critiqueSubType||"",this.props.group.title||"",this.props.uiCulture.split("-")[0]))||o===$.c.Refinement;return n.definition.credits=this.getPremiumPreviewCredits(),a&&void 0!==n.definition.credits&&this.props.group.suggestions&&0!==this.props.group.suggestions.length?(u.a.sendTraceTag(512501390,p.a.msoulscat_Wac_Telemetry,d.a.Info,"SoftPaywall Critique rendered "+JSON.stringify({critiqueType:this.props.group.critiqueSubType,credits:this.getPremiumPreviewCredits()})),C.createElement(rn,Object(l.__assign)({},n,{strings:bn(this.props.resources)}),C.createElement(i,Object(l.__assign)({ref:this.innerCritique},n)))):(void 0===n.definition.credits&&u.a.sendTraceTag(520218525,p.a.msoulscat_Wac_Telemetry,d.a.Error,"SoftPaywall credits initialization failed"),r)},t.prototype.renderAddToDictionaryPopUp=function(){var e,t=this.props.group.snippetFormatting[0].start,o=t+this.props.group.snippetFormatting[0].length,i=null===(e=this.props.group.snippet)||void 0===e?void 0:e.substring(t,o),n=Object(In.a)().getStringsFor("AddToDictionaryStrings"),r=Object(In.a)().getStringsFor("SettingsStrings"),s={addedWord:null!=i?i:"",messageText:n("AddToDictionaryPopUpMessagePlainText"),yourDictionaryText:r("esdk_AddToDictionaryPopUpMessageLink"),ariaLabel:n("AddToDictionaryPopUpMessageAriaLabel"),onAction:this.props.parameters.openCustomDictionaryDialog};return C.createElement("div",null,C.createElement(ln,Object(l.__assign)({},s)))},t.prototype.render=function(){return C.createElement(C.Fragment,null,this.state.showingCustomDictionaryPopUpMessage?this.renderAddToDictionaryPopUp():this.renderSharedCritique())},t.prototype.getCardHeaderText=function(){switch(this.props.group.type){case"SharedSpellingCritique":return this.props.resources.spellingCardTitle;case"SharedRepeatedWordCritique":return this.props.resources.RepeatedWordCardTitle;default:return this.headerText()}},t.prototype.getCritiqueProps=function(e){var t,o;return{automationId:this.props.group.id||void 0,critiqueSource:"Inference"===(null===(t=this.props.group.icon)||void 0===t?void 0:t.resourceId)?i.Inference:void 0,settings:{RenderFooterIcons:this.props.parameters.renderFooterIcons?"true":"false",RenderNeuralRewriteFeedbackCustomerContentData:"true",EnableFeedback:this.enableFeedbackForGrammar||e===$.c.NeuralRewrite?"true":"false"},definition:{definitionType:"CritiqueDefinition",critiqueType:e,header:this.props.group.cardHeader||"",contextText:this.props.group.snippet||void 0,explanation:this.props.group.explanation||void 0,explanationTitle:this.props.group.description||void 0,subheader:this.headerText(),contextDecorations:vn(this.props.group.snippetFormatting,this.props.group.snippet),suggestions:Sn(this.getSuggestionsToRender()),showContext:this.state.showingContext,showDescription:this.state.showingDescription,actions:xn(this.props.group.supportedActions,e,this.props.parameters.showEditorButton,this.props.group.critiqueSubType),brandingMode:this.getBrandingMode(),isContentPending:this.props.group.isContentPending,critiqueSetSize:this.props.parameters.definition?this.props.parameters.definition.setSize:void 0,critiquePosition:this.props.parameters.definition?this.props.parameters.definition.positionInSet:void 0,helpLink:kn(null===(o=this.props.parameters.definition)||void 0===o?void 0:o.helpLink),showDictationCommandUx:this.props.parameters.showDictationCommandUx},addOnFooterData:wn(this.props.parameters.addOnFooterData),onAction:this.onInnerCritiqueClick,style:this.getInnerCritiqueStyle(e),theme:Wo(),strings:bn(this.props.resources)}},t.prototype.getBrandingMode=function(){if(this.props.parameters.showEditorButton||this.props.parameters.showEditorBranding)return $.b.IconAndTextButton},t.prototype.getInnerCritiqueStyle=function(e){return{minWidth:e===$.c.NeuralRewrite?370:248,maxWidth:380}},t.prototype.convertCritiqueType=function(){switch(this.props.group.type){case"SharedSpellingCritique":return $.c.Spelling;case"SharedRepeatedWordCritique":return $.c.RepeatedWord;case"SharedGrammarCritique":return $.c.Grammar;case"SharedSuggestionCritique":return $.c.Refinement;case"SharedRewriteCritique":return $.c.NeuralRewrite;case"SharedDictationCorrectionCritique":return $.c.DictationCorrection}return null},t.prototype.onInnerCritiqueClick=function(e,t,o,i){var r,s,a=void 0;switch(e){case $.a.ToggleContext:this.onShowHideContext(),a="Context";break;case $.a.ToggleDescription:this.onShowHideDescription(),a="Description";break;case $.a.AddOnFooterAction:a=this.props.parameters.addOnFooterData.actionText;break;case $.a.Dismiss:this.props.dismiss&&this.props.dismiss(null!=i?i:{actionSourceId:n.Unknown});break;case $.a.AddToDictionary:this.setState({showingCustomDictionaryPopUpMessage:!0});break;case $.a.GoPremium:u.a.sendTraceTag(512501389,p.a.msoulscat_Wac_Telemetry,d.a.Info,"SoftPaywall GoPremium clicked "+JSON.stringify({critiqueType:this.props.group.critiqueSubType,credits:this.getPremiumPreviewCredits()})),null===(s=(r=this.props.dependencies).dimeCallback)||void 0===s||s.call(r);break;case $.a.RevealSuggestions:this.spendCredit()}var l=An(e);if(null!=l){var c=function(e,t){if(t&&e===co.Report&&"feedback"===t.action){var o=t;return JSON.stringify(o)}}(l,o),g=this.props.group.suggestions&&void 0!==t&&t<this.props.group.suggestions.length?this.props.group.suggestions[t]:void 0;this.onAction(null,l,lo.Try,this.props.group,g||void 0,a,c,i)}else u.a.sendTraceTag(590116176,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Unknown actionId")},t.prototype.headerText=function(){return this.props.group.title?this.props.group.title:""},t.prototype.onShowHideContext=function(){this.setState((function(e){return{showingContext:!e.showingContext}}))},t.prototype.onShowHideDescription=function(){this.setState((function(e){return{showingDescription:!e.showingDescription}}))},t.prototype.suggestionListDescription=function(){return""},t.prototype.invokeBadgeId=function(e){this.innerCritique.current&&this.innerCritique.current.executeBadgedAction(e)},t}(fi),En=o(1316),Mn=function(e){function t(o){var i=e.call(this,o)||this;return i.viewOriginalButtonRef=C.createRef(),i.state={showingContext:i.props.parameters.showSnippet,selectedSuggestion:t.getSelectedSuggestion(i.props),shouldScrollToSelectedMenuItem:!0,isContextualSuggestion:!0===i.props.parameters.showDesignerButton,isFormattingSuggestion:!0===i.props.parameters.isFormattingSuggestion,isViewingOriginal:!1},i}return Object(l.__extends)(t,e),t.getDerivedStateFromProps=function(e,o){var i=t.getSelectedSuggestion(e);return i!==o.selectedSuggestion?{selectedSuggestion:i}:null},t.getSelectedSuggestion=function(e){var t,o,i;return e.group.previewData?null===(t=this.getPreviewData(e))||void 0===t?void 0:t.getSelectedOption():(null===(i=null===(o=e.group)||void 0===o?void 0:o.suggestions)||void 0===i?void 0:i.length)?e.group.suggestions[0]:void 0},t.getPreviewData=function(e){var t;return null===(t=e.group)||void 0===t?void 0:t.previewData},t.prototype.getActionString=function(t){return t===co.ViewOriginal?this.state.isViewingOriginal?this.props.resources.ViewSuggestionTooltip:this.props.resources.ViewOriginalTooltip:t===co.Next?1===this.props.parameters.definition.setSize?this.props.resources.DoneButton:this.props.resources.NextButton:t===co.OpenDesignerPane?this.props.resources.DesignerButtonText:t===co.SnoozeAll?this.props.resources.HideSuggestionsButton:e.prototype.getActionString.call(this,t)},t.prototype.headerText=function(){var e;return null!==(e=this.props.group.title)&&void 0!==e?e:this.props.resources.DesignerMenuText},t.prototype.renderSuggestions=function(){return null},t.prototype.renderFooter=function(){return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerActionsStyleWrapper},C.createElement("div",{style:this.props.styleProvider.footerActionsLeftStyle},this.renderLeftActions()),C.createElement("div",{style:this.props.styleProvider.footerActionsRightStyle},this.renderRightActions())))},t.prototype.render=function(){return C.createElement("div",{style:this.props.styleProvider.externalWrapperStyles},e.prototype.render.call(this),this.renderProactivePrompt())},t.prototype.getProactivePromptSideIconProps=function(){return{iconName:"MeetingInsights_20",styles:this.props.styleProvider.promptIconStyle}},t.prototype.getProactivePromptBodyIconProps=function(){return{iconName:"More",styles:this.props.styleProvider.promptBodyIconStyle}},t.prototype.getProactivePromptBodyText=function(){if(this.props.parameters.proactivePromptHintType)switch(this.props.parameters.proactivePromptHintType){case ho.None:return u.a.shipAssertTag(523637135,p.a.msoulscat_Wac_WordDesigner,!1,"getProactivePromptBodyText with no hint"),"";case ho.HideFromReviewCard:return this.props.resources.HideSuggestionsProactiveHintBody;case ho.HideFromReviewCardAndRibbon:return this.props.resources.HideSuggestionsWithRibbonProactiveHintBody}return this.props.resources.HideSuggestionsProactiveHintBody},t.prototype.getProactivePromptCaptionText=function(){if(this.props.parameters.proactivePromptHintType)switch(this.props.parameters.proactivePromptHintType){case ho.None:return u.a.shipAssertTag(523637136,p.a.msoulscat_Wac_WordDesigner,!1,"getProactivePromptCaptionText with no hint"),"";case ho.HideFromReviewCard:return this.props.resources.HideSuggestionsProactiveHintCaption;case ho.HideFromReviewCardAndRibbon:return this.props.resources.HideSuggestionsWithRibbonProactiveHintCaption}return this.props.resources.HideSuggestionsProactiveHintCaption},t.prototype.renderProactivePrompt=function(){if(!0===this.props.parameters.shouldShowProactivePrompt){var e=this.getProactivePromptBodyText(),t=e.substring(0,e.indexOf("{0}")),o=e.substring(e.indexOf("{0}")+"{0}".length,e.length);return C.createElement("div",{key:"prompt",style:this.props.styleProvider.promptStyles},C.createElement("div",{style:this.props.styleProvider.promptStyleWrapper},C.createElement("div",{style:this.props.styleProvider.promptIconStyleWrapper},C.createElement(Ci.a,Object(l.__assign)({},this.getProactivePromptSideIconProps()))),C.createElement("div",{style:this.props.styleProvider.promptTextStyleWrapper},C.createElement("div",{style:this.props.styleProvider.promptTextHeadingStyle},this.getProactivePromptCaptionText()),C.createElement("div",{style:this.props.styleProvider.promptTextBodyStyle},t,C.createElement(Ci.a,Object(l.__assign)({},this.getProactivePromptBodyIconProps())),o))))}},t.prototype.getActionButtonIconProps=function(e){switch(e){case co.Accepted:return{iconName:"Accept",styles:this.props.styleProvider.acceptIconStyles(this.shouldDisableActionButton(e))};case co.Rejected:return{iconName:"Clear",styles:this.props.styleProvider.rejectIconStyles(this.shouldDisableActionButton(e))};case co.ViewOriginal:return{iconName:this.state.isViewingOriginal?"ViewOriginalFormattingBlue_16":"ViewOriginalFormattingGray_16",styles:this.props.styleProvider.viewOriginalIconStyles(this.state.isViewingOriginal)};case co.Undo:return{iconName:"Undo",styles:this.props.styleProvider.defaultIconStyles};case co.OpenDesignerPane:return{iconName:"Designer_20",styles:this.props.styleProvider.openPaneIconStyle};case co.SnoozeAll:return{iconName:"Hide_16",styles:this.props.styleProvider.overflowActionIconStyles};case co.AcceptAll:case co.RejectAll:case co.ShowHideContext:return{iconName:"Empty_16",styles:this.props.styleProvider.overflowActionIconStyles};case co.GiveFeedback:return{iconName:"Feedback",styles:this.props.styleProvider.giveFeedbackIconStyles}}},t.prototype.renderLeftActions=function(){var e=this,t={isViewingOriginal:this.state.isViewingOriginal,setIsViewingOriginal:function(t){return e.setState({isViewingOriginal:t},(function(){var t;return null===(t=e.viewOriginalButtonRef.current)||void 0===t?void 0:t.focus()}))}};return[this.renderActionButton(co.Accepted,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(co.Rejected,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(co.ViewOriginal,this.props.styleProvider.viewOriginalButtonStyles(this.state.isViewingOriginal),void 0,void 0,!0,t),this.renderActionButton(co.Next,this.props.styleProvider.nextButtonStyles),this.renderActionButton(co.Undo,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderOverflowMenu()]},t.prototype.renderRightActions=function(){return this.state.isContextualSuggestion?[this.renderActionButton(co.GiveFeedback,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(co.OpenDesignerPane,this.props.styleProvider.openPaneButtonStyle,void 0,void 0,!0)]:this.renderNextPrev()},t.prototype.getActionButtonAriaDescription=function(e){switch(e){case co.Accepted:return this.props.resources.AcceptTooltip;case co.Rejected:return this.props.resources.RejectTooltip;case co.OpenDesignerPane:return this.props.resources.DesignerButtonTooltipContent}},t.prototype.renderOverflowActions=function(){var e=[this.renderShowHideContextButton()];return this.state.isContextualSuggestion&&!this.state.isFormattingSuggestion||e.push(this.renderActionButton(co.AcceptAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e.push(this.renderActionButton(co.RejectAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e.push(this.renderActionButton(co.SnoozeAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e},t.prototype.shouldDisableActionButton=function(e,t){return this.state.isViewingOriginal?e!==co.ViewOriginal&&e!==co.GiveFeedback&&e!==co.OpenDesignerPane:e===co.Rejected&&!this.hasActionType(e,t)},t.prototype.shouldDismissOnAction=function(t){return!(!this.props.parameters.shouldSkipTwoStepReview||t!==co.Accepted&&t!==co.Rejected)||e.prototype.shouldDismissOnAction.call(this,t)&&t!==co.Apply&&t!==co.Accepted&&t!==co.Rejected&&t!==co.Undo&&t!==co.ViewOriginal&&t!==co.ShowMore},t.prototype.getTooltipString=function(e){if(!this.shouldDisableActionButton(e))switch(e){case co.Accepted:return this.props.resources.AcceptButton;case co.Rejected:return this.props.resources.RejectButton;case co.OpenDesignerPane:return this.props.resources.DesignerButtonTooltipContent;case co.Undo:return this.props.resources.UndoButton;case co.ViewOriginal:return this.state.isViewingOriginal?this.props.resources.ViewSuggestionTooltip:this.props.resources.ViewOriginalTooltip;case co.GiveFeedback:return this.props.resources.GiveFeedbackButtonText;case co.SnoozeAll:return this.props.resources.HideSuggestionsButtonTooltip;default:return}},t.prototype.renderOverflowMenu=function(){return C.createElement(En.a,{directionalHint:v.a.bottomCenter,content:this.props.resources.OverflowButtonAccessibilityLabel},e.prototype.renderOverflowMenu.call(this))},t.prototype.getActionButtonToRender=function(e,t){var o=this.getActionString(e),i=this.getActionButtonAriaDescription(e),n=this.getTooltipString(e),r=C.createElement(bi.a,Object(l.__assign)({},t,{ariaLabel:o,ariaDescription:i,componentRef:e===co.ViewOriginal?this.viewOriginalButtonRef:void 0}));return e===co.Next&&(r=C.createElement(Ai.a,Object(l.__assign)({},t,{ariaLabel:o,ariaDescription:i}))),void 0===n?r:C.createElement(En.a,{directionalHint:v.a.bottomCenter,content:n},r)},t.prototype.renderNavigationButton=function(t){var o=t?this.props.resources.NextButton:this.props.resources.PreviousButton;return C.createElement(En.a,{directionalHint:v.a.bottomCenter,content:o},e.prototype.renderNavigationButton.call(this,t))},t.critique="DesignerCritiqueV2",t.imageCritique="DesignerImageCritique",t.pqCritique="DesignerPQCritique",t}(ki),jn=o(457),Rn=o(945),Bn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollToSelectedItem=function(e){e&&t.state.shouldScrollToSelectedMenuItem&&(e.scrollIntoView({block:"center"}),t.setState({shouldScrollToSelectedMenuItem:!1}))},t}return Object(l.__extends)(t,e),t.prototype.renderSuggestions=function(){var e,t,o;if(!(null===(e=this.props.group.suggestions)||void 0===e?void 0:e.length))return null;var i=null===(t=this.state.selectedSuggestion)||void 0===t?void 0:t.title,n=Object(l.__assign)({maxWidth:"175px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",lineHeight:"32px",padding:"0px 7px"},this.getTriageItemStyle(null===(o=this.state.selectedSuggestion)||void 0===o?void 0:o.titleFormatting)),r=Object(l.__assign)(Object(l.__assign)({},this.props.styleProvider.triageButtonStyles),{label:n});return C.createElement(En.a,{directionalHint:v.a.bottomCenter,content:this.state.isViewingOriginal?void 0:this.props.resources.ChangeRoleTooltip},C.createElement(wi.a,{text:i,styles:r,disabled:this.state.isViewingOriginal,menuProps:this.getTriageMenuProps(),menuAs:this.getTriageMenu,"aria-description":this.props.resources.ChangeRoleTooltip,autoFocus:!0}))},t.prototype.getTriageMenuProps=function(){var e,t=this,o=this.getTriageItems(),i={key:"separator-designer",itemType:jn.a.Divider,itemProps:{styles:this.props.styleProvider.triageContextualMenuItemStyles}},n=null===(e=Mn.getPreviewData(this.props))||void 0===e?void 0:e.getSeparatorIndexes();if(n)for(var r=0,s=0,a=n;s<a.length;s++){var l=a[s];o.splice(l+r,0,i),r+=1}else o.splice(2,0,i);return{coverTarget:!0,items:o,contextualMenuItemAs:function(e){return C.createElement("span",{style:e.item.checked?t.props.styleProvider.menuSelectedItemSpanStyles:t.props.styleProvider.menuItemSpanStyles,ref:e.item.checked?t.scrollToSelectedItem:void 0},e.item.text)},styles:this.props.styleProvider.triageContextualMenuStyles,directionalHint:this.props.isRightToLeft?v.a.topRightEdge:v.a.topLeftEdge,calloutProps:{styles:this.props.styleProvider.triageCalloutStyles},onMenuOpened:function(){t.setState({shouldScrollToSelectedMenuItem:!0})}}},t.prototype.getTriageMenu=function(e){return C.createElement(Rn.a,Object(l.__assign)({},e))},t.prototype.getTriageItems=function(){var e=this;return this.props.group.suggestions.filter((function(e){return!!e})).map((function(t){return{key:t.id,text:t.title,data:t,role:"menuitemradio",checked:t===e.state.selectedSuggestion,itemProps:{styles:t===e.state.selectedSuggestion?e.props.styleProvider.triageContextualMenuSelectedItemStyles:e.props.styleProvider.triageContextualMenuItemStyles},style:e.getTriageItemStyle(t.titleFormatting),onClick:function(){e.onAction(null,co.Apply,lo.Try,e.props.group,t)}}}))},t.prototype.getTriageItemStyle=function(e){if(e)for(var t=0,o=e;t<o.length;t++){var i=o[t];if(i)return{fontFamily:i.font,fontWeight:i.fontWeight===uo.Bold?"bold":"normal",fontStyle:i.italic?"italic":void 0,fontSize:i.fontSize?"".concat(i.fontSize,"pt"):void 0,color:i.cssColor,textDecoration:i.underlineType>po.None?"underline":void 0,textDecorationStyle:i.underlineType>po.None?i.underlineType===po.Single?"solid":"double":void 0,backgroundColor:"transparent",backgroundImage:"url('".concat(i.backgroundImg,"')"),backgroundSize:"cover"}}},t}(Mn),Ln=o(2754),Pn=o(2619),Fn=function(e){var t=Object(Oo.db)({height:"100%",width:"100%",objectFit:"cover",objectPosition:"center"}),o=Object(C.useRef)(Date.now()),i=Object(C.useRef)(!1);return C.createElement(Ln.a,Object(l.__assign)({},e,{title:e.imgAltText,focusOnHover:!1}),C.createElement("img",{src:e.thumbnailSrc,alt:e.imgAltText,"aria-hidden":!0,className:t,onError:function(){return u.a.shipAssertTag(526722326,p.a.msoulscat_Wac_WordDesigner,!1,"Image thumbnail failed to load")},onLoad:function(){var e=Date.now()-o.current;!i.current&&e>1e3&&u.a.sendTraceTag(526722327,p.a.msoulscat_Wac_WordDesigner,d.a.Info,"Image thumbnail loaded after ".concat(e,"ms")),i.current=!0}}))},Nn=function(e){var t,o=null===(t=e.suggestion)||void 0===t?void 0:t.contentData,i=Object(Oo.db)({height:"105%",width:"105%"}),n=Object(Oo.db)({display:"-webkit-box",position:"absolute",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:"2",WebkitBoxOrient:"vertical",width:"calc(100% - 30px)",fontSize:"8px",fontFamily:null==o?void 0:o.font,fontWeight:(null==o?void 0:o.bold)===uo.Bold?"bold":"normal",fontStyle:(null==o?void 0:o.italic)?"italic":void 0,color:null==o?void 0:o.color});return C.createElement(Ln.a,Object(l.__assign)({},e,{title:null==o?void 0:o.title,focusOnHover:!1}),C.createElement("img",{src:null==o?void 0:o.backgroundImg,alt:null==o?void 0:o.title,"aria-hidden":!0,className:i}),C.createElement("span",{className:n},null==o?void 0:o.title))},Hn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onGalleryButtonExecute=function(e){var o=e.galleryButton;o&&t.onAction(null,co.Apply,lo.Try,t.props.group,o.suggestion)},t}return Object(l.__extends)(t,e),t.prototype.getSuggestionGalleryButtons=function(){var e,t,o,i,n=this.props.group.suggestions;if(!n)return[];var r=n.length;if(!r)return[];for(var s=[],a=Math.ceil(r/this.props.styleProvider.columnCount),l=0;l<a;l++)for(var c=0;c<(null!==(e=this.props.styleProvider.columnCount)&&void 0!==e?e:1);c++){var u=c*a+l;if(u>r)break;var p=n[u];if(!p)break;s.push({type:"AppGalleryButtonProps",id:null!==(t=p.id)&&void 0!==t?t:"AppGalleryButton".concat(u),style:this.props.styleProvider.galleryButtonStyles(c),thumbnailSrc:null===(o=p.image)||void 0===o?void 0:o.src,imgAltText:null===(i=p.image)||void 0===i?void 0:i.imageAltText,suggestion:p})}return s},t.prototype.render=function(){var t,o=null===(t=this.props.group.suggestions)||void 0===t?void 0:t.length,i=o&&o>3?2:1;return this.props.styleProvider.columnCount=i,e.prototype.render.call(this)},t.prototype.renderSuggestions=function(){var e,t,o,i=this;if(!(null===(e=this.props.group.suggestions)||void 0===e?void 0:e.length))return null;var n=this.getSuggestionGalleryButtons();return C.createElement("div",{className:this.props.styleProvider.imageSuggestionGalleryClassName},C.createElement(Q.a,{isCircularNavigation:!1},C.createElement(Pn.a,{id:"DesignerGallerySuggestions",role:"menu",columns:null!==(t=this.props.styleProvider.columnCount)&&void 0!==t?t:1,selectedId:null===(o=this.state.selectedSuggestion)||void 0===o?void 0:o.id,onGalleryButtonExecute:this.onGalleryButtonExecute,getGalleryButtonComponent:this.props.group.type===Mn.pqCritique?Nn:Fn,gallerySections:[{galleryButtons:n}],defaultWidth:this.props.styleProvider.cardWidth})),this.shouldHideActionButton(co.ShowMore)?null:C.createElement(Oi.a,{className:this.props.styleProvider.showMoreLinkClassName,onClick:function(){return i.onAction(null,co.ShowMore,lo.Try,i.props.group,void 0)}},this.props.resources.ShowMoreImagesLink))},t}(Mn),zn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.headerText=function(){return"Try saying:"},t.prototype.maximumSuggestions=function(){return 6},t.prototype.suggestionListDescription=function(){return""},t.prototype.renderHeader=function(){return C.createElement("div",null,e.prototype.renderHeader.call(this))},t.prototype.renderSuggestion=function(e,t){var o=this,i={allowDisabledFocus:!1,text:e.title,styles:this.props.styleProvider.suggestionButtonStyles,iconProps:{iconName:this.props.styleProvider.compoundButtonIconName(e),styles:this.props.styleProvider.suggestionButtonIconStyles},onClick:function(t){return o.onAction(t,co.Apply,lo.Try,o.props.group,e)}};return C.createElement(bi.a,Object(l.__assign)({key:e.id},i))},t.id="Intent-DiscoveryCommand",t}(fi),Un=function(e){function t(t){var o=e.call(this,t)||this;return o.state={hasError:!1},o}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.state.hasError&&this.props.onError&&this.props.onError(this.state.error,this.state.info)},t.prototype.render=function(){return this.state.hasError?this.props.fallbackRender?this.props.fallbackRender():null:this.props.children},t.prototype.componentDidCatch=function(e,t){this.setState({hasError:!0,error:e,info:t})},t}(C.Component),Wn=function(e){function t(t){var o=e.call(this,t)||this;return o.isInsertLoopsComponentEnabled=Object(c.b)("Microsoft.Office.WordOnline.InsertFluidComponent",!1),o.dismiss=o.dismiss.bind(o),o.calloutOnDismissHandler=o.calloutOnDismissHandler.bind(o),o.updateOnScrollOrResize=o.updateOnScrollOrResize.bind(o),o.dismissOnLostFocus=o.dismissOnLostFocus.bind(o),o.onAcceptPreviewStart=o.createTrackChangeToggleAction("AcceptMouseOver"),o.onAcceptPreviewEnd=o.createTrackChangeToggleAction("AcceptMouseOut"),o.onRejectPreviewStart=o.createTrackChangeToggleAction("RejectMouseOver"),o.onRejectPreviewEnd=o.createTrackChangeToggleAction("RejectMouseOut"),o.onUndo=o.createAutoReplaceAction(co.Undo),o.onAccepted=o.onTrackChangeAction.bind(o,co.Accepted,lo.Keep),o.onRejected=o.onTrackChangeAction.bind(o,co.Rejected,lo.Keep),o.onContextIQItemFocused=o.onContextIQItemFocused.bind(o),o.sortEntityTitle=o.sortEntityTitle.bind(o),o.state={parameters:t.parameters,focusInside:!t.parameters.keepCurrentFocus,profileImageUrlCache:{}},o.async=new h.a(o),o.hasListeners=!1,o.pendingUpdate=!1,o.disposables=[],o.targetWindow=null,o.calloutWrapperElement=C.createRef(),o.calloutBodyElement=C.createRef(),o.focusTrapZone=C.createRef(),o.defaultActionableIntent=null,o.commonActionData={actionSourceId:n.Unknown},o.prevPreviewDataCIQ=null,o}return Object(l.__extends)(t,e),t.prototype.updateOnScrollOrResize=function(e){var t=e.target;this.calloutWrapperElement.current&&Object(m.a)(this.calloutWrapperElement.current,t)||this.pendingUpdate||(this.pendingUpdate=!0,this.forceUpdate())},t.prototype.dismissOnLostFocus=function(e){var t,o;if(!this.state.focusInside&&!(null===(o=(t=this.state.parameters).shouldIgnoreFocusEvent)||void 0===o?void 0:o.call(t,e.target))){var i=e.target;this.calloutWrapperElement.current&&!Object(m.a)(this.calloutWrapperElement.current,i)&&this.dismiss({actionSourceId:n.Unknown})}},t.prototype.ensureListeners=function(){var e=this;this.async.setTimeout((function(){null==e.targetWindow&&e.updateWindowIfNeeded(),null!=e.targetWindow&&(e.hasListeners&&e.removeListeners(),e.props.parameters.preventDismissOnScroll&&e.disposables.push(Object(y.a)(e.targetWindow,"scroll",e.updateOnScrollOrResize,!0)),e.props.parameters.preventDismissOnResize&&e.disposables.push(Object(y.a)(e.targetWindow,"resize",e.updateOnScrollOrResize,!0)),e.disposables.push(Object(y.a)(e.targetWindow.document.documentElement,"click",e.dismissOnLostFocus,!0)),e.disposables.push(Object(y.a)(e.targetWindow.document.documentElement,"focus",e.dismissOnLostFocus,!0)),e.hasListeners=!0)}),0)},t.prototype.removeListeners=function(){this.disposables.forEach((function(e){return e()})),this.disposables=[],this.hasListeners=!1},t.prototype.getTargetElement=function(){return this.props.parameters.targetElement||this.props.parameters.containerElement},t.prototype.updateWindowIfNeeded=function(){var e=Object(f.a)(this.getTargetElement());if(e!==this.targetWindow){var t=this.hasListeners;t&&this.removeListeners(),this.targetWindow=e||null,t&&this.ensureListeners()}},t.prototype.componentDidMount=function(){this.props.parameters.onShow&&this.props.parameters.onShow(),this.ensureListeners()},t.prototype.componentWillUnmount=function(){this.async.dispose(),this.pendingUpdate=!1,this.targetWindow=null,this.hasListeners&&this.removeListeners(),this.props.parameters.onDismiss&&this.props.parameters.onDismiss(this.commonActionData)},t.prototype.componentDidUpdate=function(){this.ensureListeners()},t.prototype.render=function(){var e,t;return this.pendingUpdate=!1,C.createElement("div",{ref:this.calloutWrapperElement},C.createElement(b.a,{role:"dialog","aria-labelledby":this.headerId(),setInitialFocus:!1,onDismiss:this.calloutOnDismissHandler,target:this.getTargetElement(),styles:this.props.styleProvider.contextualMenuStyles,isBeakVisible:!1,preventDismissOnEvent:null!==(e=this.props.parameters.preventDismissOnEvent)&&void 0!==e?e:void 0,preventDismissOnLostFocus:!this.state.focusInside,preventDismissOnScroll:this.props.parameters.preventDismissOnScroll,preventDismissOnResize:this.props.parameters.preventDismissOnResize,bounds:null!==(t=this.props.parameters.bounds)&&void 0!==t?t:void 0,directionalHint:!0===this.props.parameters.isMultiParagraphSuggestion?v.a.topLeftEdge:void 0},C.createElement(S.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:this.state.focusInside,disableFirstFocus:this.props.parameters.keepCurrentFocus,componentRef:this.focusTrapZone,style:this.props.styleProvider.focusTrapStyles},C.createElement("div",{ref:this.calloutBodyElement},this.createContentGroups(this.state.parameters.definition)))))},t.prototype.focus=function(){this.focusTrapZone.current&&(this.setState({focusInside:!0}),this.focusTrapZone.current.focus())},t.prototype.calloutOnDismissHandler=function(){this.dismiss({actionSourceId:n.Unknown})},t.prototype.dismiss=function(e){e&&(this.commonActionData=e),vo.unmountComponentAtNode(this.props.parameters.containerElement)},t.prototype.setDefinition=function(e){e?this.setState((function(t){var o=Object(l.__assign)({},t.parameters);return o.definition=e,{parameters:o}})):u.a.sendTraceTag(595658962,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Tried to set null definition for an open menu")},t.prototype.updatePosition=function(){this.forceUpdate()},t.prototype.executeDefaultAction=function(){this.defaultActionableIntent&&this.defaultActionableIntent.executeDefaultAction()},t.prototype.executeActionFromString=function(e){this.defaultActionableIntent&&e&&this.defaultActionableIntent.executeActionFromString(e)},t.prototype.invokeBadgeId=function(e){null!=e?this.defaultActionableIntent&&this.defaultActionableIntent.invokeBadgeId(e):u.a.sendTraceTag(526653642,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Tried to invoke null badge ID for an open menu")},t.prototype.getElementBounds=function(){if(!this.calloutBodyElement.current)return null;try{var e=this.calloutBodyElement.current.getBoundingClientRect();return{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}}catch(e){return null}},t.prototype.onAutoReplaceAction=function(e,t,o){this.props.parameters.onAction&&this.props.parameters.onAction({actionType:e,engagement:t,objectName:"Intent-AutoReplace",objectFulfillment:o})},t.prototype.createAutoReplaceAction=function(e,t){return this.onAutoReplaceAction.bind(this,e,lo.Try,t)},t.prototype.createAutoReplaceContent=function(e){var t=e.contentData,o={onAction:this.onUndo,originalText:t.originalText,strings:{undoAccessibilityLabel:"Undo"}};return C.createElement(no,Object(l.__assign)({},o))},t.prototype.createTrackChangeContent=function(e){var t,o,i,n=e.contentData,r=(null===(t=n.changeDescriptor)||void 0===t?void 0:t.localizedDate)||"",s={definition:{definitionType:"TrackChangeDefinition",authorName:n.authorName||"",authorColor:n.authorColor||"",changeDescriptor:{formatting:null===(o=n.changeDescriptor)||void 0===o?void 0:o.formatting,text:(null===(i=n.changeDescriptor)||void 0===i?void 0:i.text)||"",localizedDate:r},theme:n.theme,acceptDisabled:!!n.acceptDisabled,rejectDisabled:!!n.rejectDisabled},strings:{acceptHoveredHeading:this.props.resources.TrackChangeCardAcceptSuggestionLabel,regularHeading:this.props.resources.TrackChangeCardAcceptOrRejectSuggestionLabel,rejectHoveredHeading:this.props.resources.TrackChangeCardRejectSuggestionLabel},style:{minWidth:240,maxWidth:240},onAcceptHoverIn:this.onAcceptPreviewStart,onRejectHoverIn:this.onRejectPreviewStart,onAcceptHoverOut:this.onAcceptPreviewEnd,onRejectHoverOut:this.onRejectPreviewEnd,onAcceptClick:this.onAccepted,onRejectClick:this.onRejected},a=r?"on ".concat(r):"";return C.createElement("div",{id:this.headerId(),"aria-label":"".concat(s.definition.authorName," ").concat(s.definition.changeDescriptor.text," ").concat(a)},C.createElement(bo.a,Object(l.__assign)({},s)))},t.prototype.getInlineFileSuggestionSourceType=function(e){switch(e){case"ClassicAttachment":return a.ClassicAttachment;case"OneDriveForBusiness":return a.OneDriveForBusiness;case"SharepointOnline":return a.SharepointOnline;default:return a.Undefined}},t.prototype.convertAddressResultToSuggestion=function(e){var t;return{id:null!==(t=e.entityId)&&void 0!==t?t:"",title:e.text,type:g.EntityType.Address}},t.prototype.convertTopicResultToSuggestion=function(e){return{id:e.Id,title:e.text,type:g.EntityType.Topic}},t.prototype.convertFileResultToSuggestion=function(e){return{type:e.entityType,sourceType:this.getInlineFileSuggestionSourceType(e.FileSourceType),fileName:e.FileName,hitFileName:e.FileName,fileExtension:e.FileExtension||"",url:e.AccessUrl||"",lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:e.FileSize||0}},t.prototype.getPersonImageUrl=function(e){if(e&&this.state.profileImageUrlCache[e])return this.state.profileImageUrlCache[e]},t.prototype.convertPersonResultToSuggestion=function(e){var t,o=e.EmailAddresses&&(null===(t=e.EmailAddresses)||void 0===t?void 0:t.length)>0?e.EmailAddresses[0]:void 0;return{type:e.entityType,displayName:e.DisplayName||"",primaryEmailAddress:o||"",imageUrl:this.getPersonImageUrl(o),initials:Object(x.a)(e.text,this.props.isRightToLeft)}},t.prototype.convertLoopSuggestion=function(e){var t;return{type:e.entityType,id:e.text,title:e.text,iconName:null===(t=e.icon)||void 0===t?void 0:t.iconName}},t.prototype.isSupportedLoopEntity=function(e){switch(e.text){case"Checklist":case"Task list":return!0;default:return!1}},t.prototype.getFlagType=function(e){switch(e){case g.EntityType.People:return r.Person;case g.EntityType.Address:return r.Location;case g.EntityType.Topic:return r.Topic;default:return r.Location}},t.prototype.getEntityTitle=function(e){switch(e){case g.EntityType.File:return this.props.resources.FileEntityLabel;case g.EntityType.People:return this.props.resources.PeopleEntityLabel;case g.EntityType.Loop:return this.props.resources.LoopEntityLabel;case g.EntityType.Address:return"Address";case g.EntityType.Topic:return this.props.resources.TopicsEntityLabel;default:return""}},t.prototype.sortEntityTitle=function(e,t){for(var o={},i=[this.getEntityTitle(g.EntityType.People),this.getEntityTitle(g.EntityType.File),this.getEntityTitle(g.EntityType.Loop),this.getEntityTitle(g.EntityType.Address),this.getEntityTitle(g.EntityType.Topic)],n=0;n<i.length;n++)o[i[n]]=n;return o[e]-o[t]||e.localeCompare(t)},t.prototype.fromInlineActionId=function(e){switch(e){case s.Retry:return co.Retry;case s.ClearSearch:return co.ClearSearch;default:return null}},t.prototype.convertContextIQContentData=function(e){for(var t=[],o=0,i=e;o<i.length;o++){var n=i[o];switch(n.entityType){case g.EntityType.File:t.push(this.convertFileResultToSuggestion(n));break;case g.EntityType.People:var r=this.convertPersonResultToSuggestion(n);this.fetchProfileImageUrl(r),t.push(r);break;case g.EntityType.Address:t.push(this.convertAddressResultToSuggestion(n));break;case g.EntityType.Topic:t.push(this.convertTopicResultToSuggestion(n));break;case g.EntityType.Loop:this.isInsertLoopsComponentEnabled&&this.isSupportedLoopEntity(n)&&t.push(this.convertLoopSuggestion(n))}}return t},t.prototype.fetchProfileImageUrl=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,o,i;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return!e.primaryEmailAddress||this.state.profileImageUrlCache[e.primaryEmailAddress]?[2]:this.state.parameters.getPersonImageUrl?[4,this.state.parameters.getPersonImageUrl(e.primaryEmailAddress,e.displayName)]:[3,2];case 1:(t=n.sent())&&(o=Object(l.__assign)(Object(l.__assign)({},this.state.profileImageUrlCache),((i={})[e.primaryEmailAddress]=t,i)),this.setState({profileImageUrlCache:o})),n.label=2;case 2:return[2]}}))}))},t.prototype.onContextIQItemFocused=function(e){this.state.parameters.editingElement&&this.state.parameters.editingElement.setAttribute("aria-activedescendant",e)},t.prototype.createContextIQContent=function(e){var t,o,i=this,n=r.Location,s=this.convertContextIQContentData(e.contentData),a={},c={};if(s.forEach((function(e){var t=i.getEntityTitle(e.type);n=i.getFlagType(e.type),a[t]?(a[t].push(e),c[t]++):(a[t]=[e],c[t]=1)})),!e.isContentPending&&this.prevPreviewDataCIQ!==e.previewData){this.prevPreviewDataCIQ=e.previewData;var g=""===e.previewData;this.props.dependencies.actionLogger.logNumCIQResults(c,g,null!==(t=e.isFirstInvoke)&&void 0!==t&&t,e.previewData?e.previewData.length:0)}var h={brandingMode:$.b.IconAndTextButton,actions:this.props.parameters.showEditorButton?[$.a.OpenEditorPane]:[]};"Intent-ContextIQFlags"===e.type?o=Object(l.__assign)(Object(l.__assign)({},h),{flag:n}):"Intent-ContextIQUserInit"===e.type&&(o=Object(l.__assign)(Object(l.__assign)({},h),{userInitiated:!0}));var m,y={results:Object.keys(a).sort(this.sortEntityTitle).map((function(e){return{title:e,suggestions:a[e]}})),queryString:e.previewData?e.previewData:"@",onItemSelected:function(t){i.contextIQAction({actionType:co.Apply,engagement:lo.Keep,objectName:e.type,objectFulfillment:void 0,descriptorData:t,data:{entityType:t.type,queryLength:e.previewData?e.previewData.length:0}})},onAction:function(t){var o=i.fromInlineActionId(t);null!=o?i.contextIQAction({actionType:o,engagement:lo.Try,objectName:e.type}):u.a.sendTraceTag(537536654,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unknown InlineActionId")},isLoading:e.isContentPending,isError:!!e.errorMessage,strings:bn(this.props.resources),theme:(m=Lo().palette,{background:{resting:m.white,hover:m.neutralLighterAlt,pressed:m.neutralLighter,disabled:m.neutralLighterAlt},text:{resting:m.neutralDark,disabled:m.neutralTertiary},altText:{resting:m.neutralSecondaryAlt},action:m.themePrimary,highlighting:m.neutralLighterAlt,branding:{type:"IconAndTextButton",background:{resting:m.white,hover:m.neutralLighterAlt,pressed:m.neutralLighter,disabled:m.white},icon:{resting:m.themePrimary,disabled:m.neutralTertiary},title:{resting:m.themePrimary,disabled:m.neutralTertiary},tooltip:{textColor:m.neutralDark},focusRing:m.neutralSecondaryAlt},scroll:{thumbColor:m.neutralTertiary}}),keyboardHandlerTarget:this.state.parameters.keyboardHandlerTarget?this.state.parameters.keyboardHandlerTarget:void 0,onItemFocused:this.onContextIQItemFocused,menuType:o,onFooterAction:function(t){var o=An(t);o&&i.contextIQAction({actionType:o,engagement:lo.None,objectName:e.type})}};return C.createElement(to,Object(l.__assign)({},y))},t.prototype.createSummarizationCommandBarContent=function(){var e=this,t=function(e){switch(e){case $.a.UndoInsertSummarization:return co.UndoInsertSummarization;case $.a.RefreshSummary:return co.RefreshSummary;case $.a.Feedback:default:return co.GiveFeedback}},o=function(e){switch(e){case $.a.UndoInsertSummarization:case $.a.RefreshSummary:return lo.Try;default:return lo.None}},i={actions:[$.a.UndoInsertSummarization,$.a.Feedback],onAction:function(i){e.props.parameters.onAction&&e.props.parameters.onAction({actionType:t(i),engagement:o(i),objectName:"Intent-SummarizationCommandBar"})},strings:bn(this.props.resources)};return C.createElement(fo,Object(l.__assign)({},i))},t.prototype.createContentGroups=function(e){var t=this;if(e&&e.suggestionGroups){var o=e.suggestionGroups.map((function(e,o){return t.createGroup(e,o)})).filter((function(e){return!!e}));return 1===o.length?o[0]:C.createElement("div",{role:"list","aria-label":this.props.resources.GroupListLabel},o)}return u.a.sendTraceTag(595854147,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Failure to create content groups because data model is missing or empty"),null},t.prototype.createGroup=function(e,t){if(!e)return u.a.sendTraceTag(595854149,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"group is null or undefined"),null;if(this.props.dependencies.hostServices&&!this.props.dependencies.hostServices.isGroupEnabled(e))return u.a.sendTraceTag(595637723,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Group type '".concat(e.type,"' is not enabled and thus skipped")),null;switch(e.type){case vi.id:return this.createIntentComponent(t,e,vi,Ho);case _i.sensitiveContent:return this.createIntentComponent(t,e,_i,Qo);case Mn.critique:return this.createIntentComponent(t,e,Bn,ui);case Mn.imageCritique:case Mn.pqCritique:return this.createIntentComponent(t,e,Hn,pi);case"SharedSpellingCritique":case"SharedRepeatedWordCritique":case"SharedGrammarCritique":case"SharedSuggestionCritique":case"SharedRewriteCritique":case"SharedDictationCorrectionCritique":return this.createIntentComponent(t,e,Dn,Qo);case _i.neuralRewrite:return this.createIntentComponent(t,e,_i,Yo);case _i.similarity:return this.createIntentComponent(t,e,_i,Xo);case zn.id:return this.createIntentComponent(t,e,zn,di);case"Intent-TrackChange":return this.createTrackChangeContent(e);case"Intent-AutoReplace":return this.createAutoReplaceContent(e);case"Intent-ContextIQFlags":case"Intent-ContextIQUserInit":return this.createContextIQContent(e);case"Intent-SummarizationCommandBar":return this.createSummarizationCommandBarContent();default:return u.a.sendTraceTag(595854148,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unknown group: ".concat(e.type)),null}},t.prototype.createIntentComponent=function(e,t,o,i){var n=this.createIntentProps(t,i,e);return this.createIntentView(e,n,o)},t.prototype.createIntentProps=function(e,t,o){return{parameters:this.state.parameters,dismiss:this.dismiss,group:e,resources:this.props.resources,isRightToLeft:this.props.isRightToLeft,uiCulture:this.props.uiCulture,styleProvider:new t(this.props.isRightToLeft),hostElementRef:this.focusTrapZone,dependencies:this.props.dependencies,position:o}},t.prototype.createIntentView=function(e,t,o){var i=this,n=o;return C.createElement(n,Object(l.__assign)({key:e,ref:function(t){return i.assignDefaultActionableIntent(e,t)}},t))},t.prototype.assignDefaultActionableIntent=function(e,t){0===e&&(this.defaultActionableIntent=t)},t.prototype.onTrackChangeAction=function(e,t,o){this.props.parameters.onAction&&this.props.parameters.onAction({actionType:e,engagement:t,objectName:"Intent-TrackChange",objectFulfillment:o})},t.prototype.createTrackChangeToggleAction=function(e){return this.onTrackChangeAction.bind(this,co.Toggle,lo.See,e)},t.prototype.headerId=function(){var e,t,o;return 1===(null===(t=null===(e=this.props.parameters.definition)||void 0===e?void 0:e.suggestionGroups)||void 0===t?void 0:t.length)&&(null===(o=this.props.parameters.definition.suggestionGroups[0])||void 0===o?void 0:o.type)?fi.createHeaderId(this.props.parameters.definition.suggestionGroups[0].type):""},t.prototype.contextIQAction=function(e){var t,o;null===(o=(t=this.props.parameters).onAction)||void 0===o||o.call(t,e),this.props.dependencies.actionLogger.logAction(e,{actionSourceId:n.Unknown})},t}(C.PureComponent);function qn(e){var t,o,i;if(1===(null===(o=null===(t=e.definition)||void 0===t?void 0:t.suggestionGroups)||void 0===o?void 0:o.length)&&(null===(i=e.definition.suggestionGroups[0])||void 0===i?void 0:i.type)){var n=e.definition.suggestionGroups[0].type;return"SharedGrammarCritique"===n||"SharedSpellingCritique"===n||"SharedSuggestionCritique"===n||"SharedRepeatedWordCritique"===n}return!1}var Gn,Zn,Vn=o(3),Qn=function(){function e(){}var t;return e.prototype.logAction=function(t,o){var i,n;if(t){var r=Object(l.__assign)({},t);r.actionName=co[t.actionType],r.engagementName=lo[t.engagement];var s=[{name:"actionType",int64:r.actionType},{name:"engagement",int64:r.engagement},{name:"actionName",string:r.actionName},{name:"engagementName",string:r.engagementName},{name:"objectName",string:r.objectName},{name:"objectId",string:r.objectId},{name:"objectFulfillment",string:r.objectFulfillment},{name:"actionSourceId",int64:o.actionSourceId}];void 0!==o.executedBadgeId&&s.push({name:"executedBadgeId",int64:o.executedBadgeId}),void 0!==o.maxBadgeId&&s.push({name:"maxBadgeId",int64:o.maxBadgeId});var a=r.objectName&&null!==(n=null===(i=e.userActionCommandMap[r.objectName])||void 0===i?void 0:i[r.engagement])&&void 0!==n?n:e.canvasContextualActionName;if(r.data){var c=r.data;Object.keys(c).forEach((function(e){var t=c[e],o=typeof t;"string"===o?s.push({name:e,string:t}):"boolean"===o?s.push({name:e,bool:t}):"number"===o&&Number.isInteger(t)?s.push({name:e,int64:t}):"number"===o?s.push({name:e,double:t}):u.a.sendTraceTag(528498709,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"ActionLogger: Data type '".concat(o,"' is not supported and therefore skipped."))}))}Object(Vn.sendUserActionEvent)({actionName:a,dataFields:s})}},e.prototype.logNumCIQResults=function(t,o,i,n){var r=e.contextIQCardNumberOfResults,s=[{name:"isInZeroState",bool:o},{name:"isFirstInvoke",bool:i},{name:"queryLength",int64:n}];Object.keys(t).forEach((function(e){s.push({name:e,int64:t[e]})})),Object(Vn.sendUserActionEvent)({actionName:r,dataFields:s})},t=e,e.canvasContextualActionName="CanvasContextualSuggestion",e.contextIQCardSeen="ContextIQCardSeen",e.contextIQCardTried="ContextIQCardTried",e.contextIQCardKept="ContextIQCardKept",e.contextIQCardNumberOfResults="ContextIQCardNumberOfResults",e.userActionCommandMap=((Gn={})["Intent-ContextIQUserInit"]=((Zn={})[lo.See]=t.contextIQCardSeen,Zn[lo.Try]=t.contextIQCardTried,Zn[lo.Keep]=t.contextIQCardKept,Zn),Gn),e}(),Yn=function(){function e(e){this.params=e,this.actionLogger=new Qn}return e.prototype.createContextualUi=function(e){return e&&e.containerElement&&this.params?function(e,t,o,i){return new Promise((function(r,s){var a=(new wo).loadStrings(t),l=function(t,o){var i=t?{message:t.message,stack:t.stack}:{};u.a.sendTraceTag(595637724,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Crash while rendering. Error: ".concat(JSON.stringify(i)," Info: ").concat(JSON.stringify(o))),s(t),(new h.a).setImmediate((function(){e.onDismiss&&e.onDismiss({actionSourceId:n.Unknown}),vo.unmountComponentAtNode(e.containerElement)}))};a.then((function(n){var s,a,c;vo.render(C.createElement(Un,{onError:l},C.createElement(Wn,{ref:function(e){r(e)},parameters:e,styleProvider:new Jo({isRightToLeft:o,alignInnerTextWithAnchor:qn(e),allowContentOverflow:"Intent-TrackChange"===(null===(s=e.definition)||void 0===s?void 0:s.id),customScrollbarUsed:"Intent-ContextIQFlags"===(null===(a=e.definition)||void 0===a?void 0:a.id)||"Intent-ContextIQUserInit"===(null===(c=e.definition)||void 0===c?void 0:c.id)}),resources:n,isRightToLeft:o,uiCulture:t,dependencies:i})),e.containerElement)})).catch((function(e){return s(e)}))}))}(e,this.getUiCulture(),this.params.isRightToLeft,this.createDependencies(e.hostServices)):Promise.reject(new Error("Arguments are not provided or incorrect."))},e.prototype.logAction=function(e,t){e&&this.actionLogger.logAction(e,null!=t?t:{actionSourceId:n.Unknown})},e.prototype.createDependencies=function(e){var t=this.params,o=t.dimeCallback,i=t.loadUpsellDependencies,n=t.getSoftPaywallData,r=t.getPremiumPreviewCritiquesList;return{actionLogger:this.actionLogger,hostServices:e,dimeCallback:o,loadUpsellDependencies:i,getSoftPaywallData:n,getPremiumPreviewCritiquesList:r}},e.prototype.getUiCulture=function(){return this.params.uiCulture||"en-US"},e}(),Xn=o(1286),Jn={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{},font:{extensions:["ttf","otf","woff"]},fluid:{extensions:["b","fluid"]},genericfile:{},html:{extensions:["htm","html","mht"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},officescript:{extensions:["osts"]},splist:{extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mcworld","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx","classifier"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},stream:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}},Kn=[16,20,24,32,40,48,64,96];function $n(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20210115.001/assets/item-types/"),Kn.forEach((function(o){!function(e,t,o){var i=Object.keys(Jn),n={};i.forEach((function(o){var i=e+t+"/"+o;n[o+t+"_png"]=C.createElement("img",{src:i+".png",alt:""}),n[o+t+"_svg"]=C.createElement("img",{src:i+".svg",alt:""}),n[o+t+"_1.5x_png"]=C.createElement("img",{src:e+t+"_1.5x/"+o+".png",height:"100%",width:"100%",alt:""}),n[o+t+"_1.5x_svg"]=C.createElement("img",{src:e+t+"_1.5x/"+o+".svg",height:"100%",width:"100%",alt:""}),n[o+t+"_2x_png"]=C.createElement("img",{src:e+t+"_2x/"+o+".png",height:"100%",width:"100%",alt:""}),n[o+t+"_3x_png"]=C.createElement("img",{src:e+t+"_3x/"+o+".png",height:"100%",width:"100%",alt:""}),n[o+t+"_4x_png"]=C.createElement("img",{src:e+t+"_4x/"+o+".png",height:"100%",width:"100%",alt:""})})),Object(Oo.hb)({fontFace:{},style:{width:t,height:t,overflow:"hidden"},icons:n,mergeImageProps:!0},o)}(e,o,t)}))}var er=function(){function e(){}return e.createController=function(e){return Object(Xn.a)(void 0,{disableWarnings:!0}),$n(void 0,{disableWarnings:!0}),new Yn(e)},e}(),tr=o(66),or=function(){function e(e){this._documentScoreHandler=e,this.skittleArgs={isThinking:!1},this.kpiConfigOfferLevel=void 0,this.scaleCritiquePercentage=function(e,t,o){return 0===t?0:Math.round(e*o/t)}}return Object.defineProperty(e.prototype,"documentScore",{get:function(){return this._documentScoreHandler.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_relativeSpellingScore",{get:function(){return this._documentScoreHandler.documentScoreWithoutSpelling-this.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_relativeGrammarScore",{get:function(){return this._documentScoreHandler.documentScoreWithoutGrammar-this.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_relativeRefinementsScore",{get:function(){return this._documentScoreHandler.documentScoreWithoutRefinements-this.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIncipient",{get:function(){return this.wordCount<100},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progressBarData",{get:function(){return this.scaleCritiquesPercentage(this.documentScore,this.relativeCritiqueScores)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordCount",{get:function(){return this._documentScoreHandler.wordCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"critiquesCount",{get:function(){return this._documentScoreHandler.critiquesCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relativeCritiqueScores",{get:function(){return{grammarPercent:this._relativeGrammarScore,refinementsPercent:this._relativeRefinementsScore,spellingPercent:this._relativeSpellingScore}},enumerable:!1,configurable:!0}),e.prototype.scaleCritiquesPercentage=function(e,t){var o=t.spellingPercent,i=t.grammarPercent,n=t.refinementsPercent,r=o+i,s=o+i+n,a=this.scaleCritiquePercentage(r,s,100-e),l=100-e-a;return{spellingPercent:this.scaleCritiquePercentage(o,r,a),grammarPercent:this.scaleCritiquePercentage(i,r,a),refinementsPercent:this.scaleCritiquePercentage(n,s-r,l)}},e}();Object(tr.k)(or,{wordCount:tr.h,isIncipient:tr.h,critiquesCount:tr.h,documentScore:tr.h,progressBarData:tr.h,skittleArgs:tr.p});var ir,nr=function(){function e(){var e=this;this.currentFocused=document.createElement("div"),this.currentHovered=document.createElement("div"),this.isFocusForced=!1,this.forceFocus=function(t){e.isFocusForced=t},this.handleElementHoveredOrFocused=function(t){t.stopPropagation(),"mouseover"!==t.type&&"mouseenter"!==t.type||(e.currentHovered=t.currentTarget),"mouseout"!==t.type&&"mouseleave"!==t.type||(e.currentHovered=null),"focus"!==t.type&&"click"!==t.type||(e.currentFocused=t.currentTarget),"blur"===t.type&&(e.currentFocused=null)},this.reset=function(){e.currentFocused=e.currentHovered=null}}return Object.defineProperty(e.prototype,"currentHoveredOrFocused",{get:function(){var e;return null!==(e=this.currentFocused)&&void 0!==e?e:this.currentHovered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHoveredOrFocused",{get:function(){return!!this.currentHoveredOrFocused||this.isFocusForced},enumerable:!1,configurable:!0}),e}();Object(tr.k)(nr,{currentFocused:tr.p,currentHovered:tr.p,currentHoveredOrFocused:tr.h,isHoveredOrFocused:tr.h,forceFocus:tr.g,isFocusForced:tr.p,handleElementHoveredOrFocused:tr.g,reset:tr.g}),function(e){e[e.Collapsed=0]="Collapsed",e[e.Disabled=1]="Disabled",e[e.Short=2]="Short",e[e.FullSize=3]="FullSize"}(ir||(ir={}));var rr=function(){function e(e){this._store=e,this.verticalScrollValue=0,this.fullSizeLimit=30,this.shortSizeLimit=600,this.viewportHeight=window.innerHeight}return Object.defineProperty(e.prototype,"cardSize",{get:function(){return this.viewportHeight<180?ir.Disabled:this.verticalScrollValue<this.fullSizeLimit?ir.FullSize:this.verticalScrollValue<this.shortSizeLimit&&this._store.isIncipient?ir.Collapsed:this.verticalScrollValue<this.shortSizeLimit?ir.Short:ir.Collapsed},enumerable:!1,configurable:!0}),e}();Object(tr.k)(rr,{cardSize:tr.h,verticalScrollValue:tr.p,fullSizeLimit:tr.p,shortSizeLimit:tr.p,viewportHeight:tr.p});var sr=o(2626),ar=o(1085),lr=function(){this.css=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Oo.db.apply(void 0,e)},this.keyframes=Oo.ab},cr=o(1082),ur=o(1806),pr="(-ms-high-contrast: active), (forced-colors: active)",dr="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",gr="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)",hr="@media screen and "+pr,mr="@media screen and "+dr,yr="@media screen and "+gr,fr=(new(function(){function e(){}return Object.defineProperty(e.prototype,"isHighContrastActive",{get:function(){return window.matchMedia(pr).matches},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighContrastBlack",{get:function(){return window.matchMedia(dr).matches},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighContrastWhite",{get:function(){return window.matchMedia(gr).matches},enumerable:!1,configurable:!0}),e}()),o(1805)),br=o(1086),vr=o(883),Sr=function(e){fr.a.isKey(e,br.a.escape)&&(e.currentTarget.focus(),e.stopPropagation())};var xr=function(e){var t=e.shouldRenderAsPremium,o=e.styleProvider,i=!e.hasHeader&&!e.ariaLabel,n="IdeasCardHeader_".concat(e.id),r=function(){var e,t=Object(vr.b)();return{boxShadow:t.cardShadow,backgroundColor:t.buttonBackground,emptyCells:"hide","&:not(:empty)":(e={},e[yr]={border:"1px solid #000"},e[mr]={border:"1px solid #fff"},e)}}(),s=o.css(function(){var e,t=Object(vr.b)();return{borderRadius:"4px",boxShadow:t.cardShadow,backgroundColor:t.buttonBackground,msHighContrastAdjust:"auto",position:"relative",emptyCells:"hide","&:not(:empty)":(e={},e[yr]={border:"1px solid #000"},e[mr]={border:"1px solid #fff"},e)}}(),t?r:[]);return i?C.createElement("div",{className:s,"data-card":1,"data-automation-id":n,"data-ignore-user-engagement":e.ignoreUserEngagement},e.children):C.createElement(Q.a,{className:s,"data-card":1,"data-automation-id":n,"data-ignore-user-engagement":e.ignoreUserEngagement,isCircularNavigation:!0,onKeyDown:Sr,direction:3},e.children)},Cr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._styles={header:{marginBottom:"12px",padding:"0"},title:{display:"flex",alignItems:"center",fontSize:"14px",fontWeight:"600"}},t}return Object(l.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.id,o=e.title;return C.createElement("div",{className:this.props.styleProvider.css(this._styles.header),id:t},o&&this.renderTitle())},t.prototype.renderTitle=function(){var e=this.props,t=e.icon,o=e.styleProvider;return C.createElement("h1",{"aria-level":1,className:o.css(this._styles.title)},t,this.props.title)},t}(C.Component),Tr=function(){return{diamondIcon:{width:"27px",color:Object(vr.b)().infoIcon,fontSize:"20px",margin:"15px 15px 0px 15px"},diamondIconHeader:{color:"inherit",margin:"0px 0px 0px 0px"}}},Ar=function(e){var t=e.styleProvider.css(Tr().diamondIcon,e.isHeader?Tr().diamondIconHeader:[]);return C.createElement(Ci.a,{"aria-hidden":!0,iconName:"Diamond",className:t})};function wr(){var e=Object(vr.b)();return{diamondHeader:{color:e.disabledText,":hover i":{color:e.accentButtonText}},header:{color:e.buttonText}}}var Or=function(e){return e.shouldRenderAsPremium?C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(wr().diamondHeader)},C.createElement(Cr,Object(l.__assign)({},e,{icon:C.createElement(Ar,{isHeader:!0,styleProvider:e.styleProvider})}))):C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(wr().header)},C.createElement(Cr,Object(l.__assign)({},e)))},kr={padding:"0"},Ir=function(e){var t,o,i=e.id,n=e.styleProvider,r=e.ariaHidden,s=null!==(t=e.ariaLabel)&&void 0!==t?t:void 0,a=null!==(o=e.contentRole)&&void 0!==o?o:cr.a.Group;return C.createElement("div",{"aria-hidden":r,"aria-label":s,id:i,"data-automation-id":i,onFocus:e.onFocus,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,role:a,tabIndex:-1},C.createElement("div",{className:n.css(kr)},e.children))},_r=Object(tr.p)({isTABNavigationUsed:!1});function Dr(){return _r.isTABNavigationUsed}var Er,Mr,jr,Rr,Br=Object(tr.g)((function(){var e=document.querySelector("body");_r.isTABNavigationUsed=!!e&&e.classList.contains("ms-Fabric--isFocusVisible")})),Lr=function(e){var t,o={description:e.description,title:e.title,hasHeader:e.hasHeader},i=Object(l.__assign)({margin:"24px 0 10px 0",":first-of-type":{marginTop:"6px"}},e.style),n=e.styleProvider,r=e.theme,s=e.visibilityChanged,a=e.visibilityChangedCallbackMode,c=C.useCallback((function(t){var o,i=t.target;i&&function(e){if(Br(),Dr()){if(!(e.getBoundingClientRect().top>=180)){var t=window.scrollY,o=Math.max(t-180,0);window.requestAnimationFrame((function(){window.scrollTo(0,o)}))}}}(i),null===(o=e.onFocus)||void 0===o||o.call(e)}),[e.onFocus]),u=null!==(t=e.contentRole)&&void 0!==t?t:cr.a.Group,p=C.createElement("div",{className:"ideas-card ".concat(n.css(i))},e.hasHeader&&C.createElement(Or,Object(l.__assign)({shouldRenderAsPremium:e.shouldRenderAsPremium,id:e.headerId,styleProvider:e.styleProvider,theme:r},o)),C.createElement(xr,{id:e.headerId,hasHeader:e.hasHeader,ariaLabel:e.ariaLabel,ignoreUserEngagement:e.ignoreUserEngagement,shouldRenderAsPremium:e.shouldRenderAsPremium,styleProvider:e.styleProvider,theme:r},C.createElement(Ir,Object(l.__assign)({id:"shell"+e.headerId,styleProvider:e.styleProvider,shouldRenderAsPremium:e.shouldRenderAsPremium,ariaLabel:e.ariaLabel,ariaHidden:!e.hasHeader&&!e.ariaLabel||void 0,contentRole:u,onFocus:c,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},o),e.children)));return s?C.createElement(ur.a,{visibilityChanged:s,visibilityChangedCallbackMode:a},p):p},Pr=o(2621);!function(e){e.communicationShade30="#004578",e.communicationShade20="#005a9e",e.communicationShade10="#106ebe",e.communicationPrimary="#0078d4",e.communicationTint10="#2b88d8",e.communicationTint20="#c7e0f4",e.communicationTint30="#deecf9",e.communicationTint40="#eff6fc"}(Er||(Er={})),function(e){e.black="#000000",e.gray400="#c4c4c4",e.gray300="#dbdbdb",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(Mr||(Mr={})),function(e){e.pinkRed10="#750b1c",e.red30="#a4262c",e.red10="#d13438",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(jr||(jr={})),function(e){e.activeReviewMode="#0e336a",e.aliceBlueBackground="#f3f7fc",e.barBackground="#d2e0f4",e.barGradientColor="#13458f",e.countColor="#1651aa",e.textColor="#6d6b69",e.grayBackground="#f3f3f3",e.gray1="#d2d2d2",e.gray2="#262626",e.gray3="#757470",e.gray4="#ebebeb",e.gray5="#3c3b3b",e.blueMagenta1="#5a4ebc",e.waterBlue="#D2E0F4",e.wordBlue="#2E6AC5",e.wordBlueDarkAlt="#295fb1",e.wordBlueDark="#225095",e.wordPrimary="#185ABD",e.lightPink="#FDE5E5",e.lightGreen="#D4EDD4",e.darkGreen="#0b5a08"}(Rr||(Rr={}));function Fr(){var e,t=Object(vr.b)();return{mainWrapper:(e={borderRadius:"4px",boxShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12), 0px 2px 4px 0px rgba(0, 0, 0, 0.08)",boxSizing:"border-box",height:"".concat(96,"px"),marginTop:"1px",overflow:"hidden",position:"relative",top:"0",transition:"height 400ms cubic-bezier(0.1, 0.9, 0.2, 1), top 400ms cubic-bezier(0.1, 0.45, 0.2, 1)",userSelect:"none",width:"100%",":focus":Dr()?{outline:"1px solid ".concat(t.focusBorder," !important")}:{},":focus > :first-child > :first-child":{backgroundColor:t.buttonBackgroundHovered}},e[Oo.l]={outline:"1px solid transparent"},e),skittleMainWrapper:{height:"auto"},mainWrapperCollapsed:{boxShadow:"none",height:"48px",left:"12px",top:"-52px",position:"fixed",width:"calc(100% - 24px)"},mainWrapperShort:{height:"48px"},mainWrapperProgress:{boxShadow:"0px 0.3px 0.9px 0px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px 0px rgba(0, 0, 0, 0.132)"},progressCardWrapper:{alignItems:"flex-start",display:"flex",height:"100%",position:"relative"},pyroCardStyles:{margin:"0px",":first-of-type":{marginTop:"0px"}},disabledOffset:{marginTop:"-".concat(96,"px")}}}var Nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.render=function(){var e,t=this.props.isVisible,o=this.props.styleProvider,i=Object(In.a)().getStringsFor("ProofingStrings"),n={mainContainer:{alignItems:"center",backgroundColor:(e=Object(vr.b)()).buttonBackground,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",opacity:"0",position:"absolute",top:"0",transition:"opacity 200ms linear, z-index 0ms 200ms",width:"100%",zIndex:"-1",":hover,&:focus":{backgroundColor:e.buttonBackgroundHovered},":active":{backgroundColor:e.buttonBackgroundPressed},fontFamily:Pr.c},mainContainerVisible:{opacity:"1",transition:"opacity 200ms linear, z-index 0ms 0ms",zIndex:"103"},startWritingLabel:{color:Rr.wordBlue,fontSize:"20px",fontWeight:"600",height:"24px",lineHeight:"18px",letterSpacing:"0px",maxWidth:"94%",overflow:"hidden",textAlign:"center",textOverflow:"ellipsis",whiteSpace:"nowrap"},editorScoreLabel:{color:e.buttonText,fontSize:"14px",lineHeight:"17px",position:"absolute",height:"19px",left:"17px",top:"13px"},incipientDocumentLabel:{color:"#262626",fontSize:"12px",maxWidth:"300px",textAlign:"center",width:"88%"},hundredWordsLabel:{color:e.bodySubtext,fontSize:"14px",lineHeight:"16px",position:"absolute",height:"19px",left:"17px",top:"34px"}},r=o.css(n.mainContainer,t?n.mainContainerVisible:[]);return T.a.createElement("div",{className:r},T.a.createElement("div",{"aria-hidden":!0,"data-is-focusable":!1,className:o.css(n.editorScoreLabel)},i("ProgressCardTitle")),T.a.createElement("div",{"aria-hidden":!0,"data-is-focusable":!1,className:o.css(n.hundredWordsLabel)},i("IncipientDocumentLabel")))},t}(C.Component),Hr=o(2734),zr=o(1084),Ur=o(714),Wr=o(2622),qr=function(){function e(){}return e.isElement=function(e){return"getAttribute"in e},e.isNode=function(e){return"parentElement"in e},e.createRect=function(e,t,o){var i={bottom:0,height:t,left:0,right:0,top:0,width:e,x:null!=o?o:0,y:0,toJSON:function(){return""}};return t<0?(i.top=i.y+t,i.bottom=i.y):(i.top=i.y,i.bottom=i.y+t),e<0?(i.right=i.x,i.left=i.x+e):(i.right=i.x+e,i.left=i.x),i},e}(),Gr=function(e,t){void 0===t&&(t=6);var o,i=function(e){var t=document.getElementById("ideasApp"),o=null==t?void 0:t.getBoundingClientRect();return o?qr.createRect(o.width-2*e,window.innerHeight,e):void 0}(t);return e&&i?o=i.width<e?i.width:e:e?o=e:i&&(o=i.width),{bounds:i,calloutMaxHeight:void 0,calloutMaxWidth:o,minPagePadding:void 0}};function Zr(){var e,t,o,i,n,r=Object(vr.b)();return{flexContainer:{backgroundColor:r.buttonBackground,alignItems:"center",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",height:"100%",width:"100%",":hover":{backgroundColor:r.buttonBackgroundHovered},":active":{backgroundColor:r.buttonBackgroundPressed}},focusStyle:{":hover > :last-child > *":{backgroundColor:r.bodyStandoutBackground}},suggestionsContainer:{alignItems:"flex-start",cursor:"default",display:"flex",flexDirection:"row",height:"47px",justifyContent:"center",margin:"13px 16px 0px 17px",width:"100%"},suggestionsContainerShort:{alignItems:"flex-start",cursor:"default",display:"flex",flexDirection:"row",height:"22px",justifyContent:"flex-end",marginLeft:"6px",order:2,width:"35px"},editorScoreWrapper:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"44px",width:"36%"},editorScoreWrapperShort:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"20px",width:"35px"},focusableScoreWrapper:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"38px",padding:"0px 1px"},focusableScoreWrapperShort:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"22px",padding:"0px 1px"},progressNumberContainer:{color:r.accentButtonText,fontFamily:Pr.a,fontSize:"40px",fontWeight:"600",height:"44px",letterSpacing:"-1.15px",lineHeight:"43px",overflow:"hidden",pointerEvents:"none",textAlign:"right","@media screen and (-ms-high-contrast: none)":{paddingTop:"2.5px"}},progressNumberContainerShort:{color:r.accentButtonText,fontFamily:Pr.a,fontSize:"17px",fontWeight:"600",height:"20px",letterSpacing:"0px",lineHeight:"25px",textAlign:"right",paddingRight:"1px",order:2,overflow:"hidden",pointerEvents:"none","@media screen and (-ms-high-contrast: none)":{paddingTop:"1px"}},percentageContainer:{color:r.accentButtonText,fontFamily:Pr.a,fontSize:"16px",fontWeight:"bold",lineHeight:"23.5px",letterSpacing:"0px",marginLeft:"1px",pointerEvents:"none",textAlign:"right"},percentageContainerShort:{color:r.accentButtonText,fontFamily:Pr.a,fontSize:"11px",fontWeight:"bold",height:"16px",letterSpacing:"0px",lineHeight:"22px",marginLeft:"1px",order:3,pointerEvents:"none",textAlign:"right"},progressNumber:{height:"100%"},progressLabel:{color:r.buttonText,fontSize:"14px",lineHeight:"17px",height:"17px",width:"64%"},progressLabelShort:{height:"0px",width:"0px",visibility:"hidden"},progressBarWrapper:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"center",height:"12px",margin:"12px 16px 12px 16px",width:"100%"},progressBarWrapperShort:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"center",order:1,height:"44px",margin:"2px",width:"calc(100% - 72px)"},progressBarUnit:(e={background:"".concat(r.accentButtonText," !important"),borderRadius:"4px",transition:"flex-grow 300ms",height:"8px",margin:"0.5px",forcedColorAdjust:"none",":hover":{cursor:"pointer"}},e[yr]={background:"none",backgroundColor:Mr.black},e[mr]={background:"none",backgroundColor:Mr.white},e),progressBarSecondaryUnit:(t={background:"none",backgroundColor:r.variantBorder},t[hr]={opacity:.5},t),attentionUnitStyle:{":hover,&:focus":(o={},o[hr]={opacity:1},o)},calloutPopUp:{backgroundColor:r.bodyBackground,borderRadius:"3px",boxShadow:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",padding:"6px 10px 8px 10px",pointerEvents:"none","> .ms-Callout-beakCurtain":{borderRadius:"2px"}},calloutPopUpTextStyle:{color:r.buttonText,fontFamily:Pr.c,fontSize:"12px"},calloutPopUpNumberStyle:{fontFamily:Pr.a,fontSize:"12px",fontWeight:"bold"},SkittleFocusStyle:{cursor:"pointer"},skittleCloseButton:{display:"inline-block",width:"24px",height:"24px"},skittleCritiqueCountWrapper:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"flex-start",height:"16px",margin:"0px 12px 7px 12px",width:"100%",fontFamily:Pr.c,fontSize:"10px",letterSpacing:"0px",color:r.buttonText},skittleCritiqueCount:{color:r.accentButtonText,fontFamily:Pr.d,fontWeight:"bold",margin:"0px 2px 0px 2px"},skittleShimmer:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",transform:"translateX(-100%)",animationDuration:"2s",animationTimingFunction:"ease-in-out",animationDirection:"normal",animationIterationCount:"infinite",animationName:"shimmerAnimation",background:"linear-gradient(to right, rgb(243, 242, 241) 0%, rgb(237, 235, 233) 50%, rgb(243, 242, 241) 100%) 0px 0px / 90% 100% no-repeat rgb(243, 242, 241)"},skittleProgressBarWrapper:(i={backgroundColor:r.variantBorder,borderRadius:"4px",height:"6px",alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-start",margin:"8px 12px 5px 12px",width:"100%",overflow:"hidden"},i[Oo.l]={outline:"1px solid transparent",outlineOffset:"-1px"},i),skittleProgressBar:(n={background:r.accentButtonText,borderRadius:"4px",height:"6px",transition:"width 0.3s",minWidth:"6px"},n[Oo.l]={outline:"3px solid transparent",outlineOffset:"-3px"},n),skittleSuggestionsContainer:{alignItems:"flex-start",display:"flex",flexDirection:"row",margin:"8px 12px 6px 12px",width:"100%",justifyContent:"space-between",cursor:"pointer"},skittleEditorScoreWrapper:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"36%"},skittleScoreWrapper:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"25px"},skittleNumberContainer:{height:"25px",fontSize:"26px",letterSpacing:"-1px",lineHeight:"30px"},skittlePercentageContainer:{size:"14px"},editorIconStyles:{display:"flex",margin:"0px 0px 5px 57px"}}}function Vr(){var e={backgroundColor:"".concat(Object(vr.b)().bodyBackground," !important")};return{beak:e,beakCurtain:e,calloutMain:e}}var Qr=o(2625),Yr=o(42),Xr=function(e){function t(t){var o=e.call(this,t)||this;return o.element=Object(C.createRef)(),o}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"styles",{get:function(){return Zr()},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.styleProvider,o=e.barLength,i=e.ariaLabel,n=e.isSecondary,r=e.color,s=e.isVisible,a={backgroundColor:"".concat(r," !important")},l=this.element.current===this.props.orchestrator.currentHoveredOrFocused,c=o?{flexGrow:o,minWidth:"8px"}:{margin:"0"},u=s&&o>0,p=!u||void 0,d=this.styles;return T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{"aria-hidden":p,"aria-label":Object(Qr.a)(i,Math.round(o)),"aria-readonly":!0,className:t.css(d.progressBarUnit,c,n?d.progressBarSecondaryUnit:[],d.attentionUnitStyle,l?a:[]),"data-is-focusable":u,onClick:this.props.orchestrator.handleElementHoveredOrFocused,onBlur:this.props.orchestrator.handleElementHoveredOrFocused,onFocus:this.props.orchestrator.handleElementHoveredOrFocused,onMouseOver:this.props.orchestrator.handleElementHoveredOrFocused,onMouseOut:this.props.orchestrator.handleElementHoveredOrFocused,ref:this.element,role:cr.a.TextBox},this.renderBarUnitPopUp()))},t.prototype.renderBarUnitPopUp=function(){var e=this.props,t=e.styleProvider,o=e.calloutContent,i=e.color,n=e.barLength,r=this.styles,s=t.css(r.calloutPopUp),a=t.css(r.calloutPopUpTextStyle),c=t.css(r.calloutPopUpNumberStyle,{color:i}),u=this.element.current===this.props.orchestrator.currentHoveredOrFocused,p=0===n||!u||this.props.cardSize===ir.Collapsed;return T.a.createElement(b.a,Object(l.__assign)({className:s,styles:Vr(),role:cr.a.Dialog,hidden:p,target:this.element.current,setInitialFocus:!0,directionalHint:v.a.bottomCenter,beakWidth:20},Gr(236)),T.a.createElement("span",{className:a},o),T.a.createElement("span",{className:c}," ",Math.round(n),"%"))},t}(C.Component),Jr=Object(Yr.a)(Xr),Kr=function(e,t,o,i,n){var r,s=t===(null===(r=i.currentHoveredOrFocused)||void 0===r?void 0:r.id),a=Zr(),c=o.css(a.calloutPopUp),u=o.css(a.calloutPopUpTextStyle),p=!s||n===ir.Collapsed;return T.a.createElement(b.a,Object(l.__assign)({styles:Vr(),className:c,role:cr.a.Dialog,target:document.getElementById(t),setInitialFocus:!0,hidden:p,directionalHint:v.a.bottomCenter,beakWidth:20},Gr(268)),T.a.createElement("div",{className:u},e))},$r="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgNUMxNy43MDgzIDUgMTcuOTAzNiA1LjAzOTA2IDE4LjA4NTkgNS4xMTcxOUMxOC4yNjgyIDUuMTk1MzEgMTguNDI3NyA1LjMwMjczIDE4LjU2NDUgNS40Mzk0NUMxOC43MDEyIDUuNTc2MTcgMTguODA4NiA1LjczNTY4IDE4Ljg4NjcgNS45MTc5N0MxOC45NjQ4IDYuMTAwMjYgMTkuMDAzOSA2LjI5NTU3IDE5LjAwMzkgNi41MDM5MUMxOS4wMDM5IDYuNzEyMjQgMTguOTY0OCA2LjkwNzU1IDE4Ljg4NjcgNy4wODk4NEMxOC44MDg2IDcuMjY1NjIgMTguNzAxMiA3LjQyMTg4IDE4LjU2NDUgNy41NTg1OUMxOC40Mjc3IDcuNjk1MzEgMTguMjY4MiA3LjgwMjczIDE4LjA4NTkgNy44ODA4NkMxNy45MDM2IDcuOTU4OTggMTcuNzA4MyA3Ljk5ODA1IDE3LjUgNy45OTgwNUgxMS42NjAyTDEwLjIxNDggMTBIMTQuNTAyQzE0LjcxMDMgMTAgMTQuOTA1NiAxMC4wMzkxIDE1LjA4NzkgMTAuMTE3MkMxNS4yNzAyIDEwLjE5NTMgMTUuNDI5NyAxMC4zMDI3IDE1LjU2NjQgMTAuNDM5NUMxNS42OTY2IDEwLjU3NjIgMTUuODAwOCAxMC43MzU3IDE1Ljg3ODkgMTAuOTE4QzE1Ljk1NyAxMS4xMDAzIDE1Ljk5NjEgMTEuMjk1NiAxNS45OTYxIDExLjUwMzlDMTUuOTk2MSAxMS43MTIyIDE1Ljk1NyAxMS45MDc2IDE1Ljg3ODkgMTIuMDg5OEMxNS44MDA4IDEyLjI2NTYgMTUuNjk2NiAxMi40MjE5IDE1LjU2NjQgMTIuNTU4NkMxNS40Mjk3IDEyLjY5NTMgMTUuMjcwMiAxMi44MDI3IDE1LjA4NzkgMTIuODgwOUMxNC45MDU2IDEyLjk1OSAxNC43MTAzIDEyLjk5OCAxNC41MDIgMTIuOTk4SDguMDI3MzRMNi41ODIwMyAxNUgxMS41MDM5QzExLjcwNTcgMTUgMTEuODk3OCAxNS4wMzkxIDEyLjA4MDEgMTUuMTE3MkMxMi4yNjI0IDE1LjE5NTMgMTIuNDIxOSAxNS4zMDI3IDEyLjU1ODYgMTUuNDM5NUMxMi42OTUzIDE1LjU3NjIgMTIuODAyNyAxNS43MzU3IDEyLjg4MDkgMTUuOTE4QzEyLjk1OSAxNi4xMDAzIDEyLjk5OCAxNi4yOTU2IDEyLjk5OCAxNi41MDM5QzEyLjk5OCAxNi43MTIyIDEyLjk1OSAxNi45MDc2IDEyLjg4MDkgMTcuMDg5OEMxMi44MDI3IDE3LjI2NTYgMTIuNjk1MyAxNy40MjE5IDEyLjU1ODYgMTcuNTU4NkMxMi40MjE5IDE3LjY5NTMgMTIuMjYyNCAxNy44MDI3IDEyLjA4MDEgMTcuODgwOUMxMS44OTc4IDE3Ljk1OSAxMS43MDU3IDE3Ljk5OCAxMS41MDM5IDE3Ljk5OEgzLjU3NDIyTDIuNTY4MzYgMTguNzIwN0MyLjUxNjI4IDE4Ljc1MzMgMi40NjA5NCAxOC43Njk1IDIuNDAyMzQgMTguNzY5NUMyLjM0Mzc1IDE4Ljc2OTUgMi4yOTE2NyAxOC43NTY1IDIuMjQ2MDkgMTguNzMwNUwxLjEyMzA1IDE5LjU2MDVDMS4xMDM1MiAxOS41NzM2IDEuMDcwOTYgMTkuNTgwMSAxLjAyNTM5IDE5LjU4MDFDMC44NTYxMiAxOS41ODAxIDAuNzEyODkxIDE5LjUzMTIgMC41OTU3MDMgMTkuNDMzNkMwLjQ3ODUxNiAxOS4zMzU5IDAuNDE5OTIyIDE5LjIyODUgMC40MTk5MjIgMTkuMTExM1YxOS4wODJMMC44MzAwNzggMTcuNzI0NkMwLjc0NTQ0MyAxNy42NTk1IDAuNzAzMTI1IDE3LjU3ODEgMC43MDMxMjUgMTcuNDgwNUMwLjcwMzEyNSAxNy40NjA5IDAuNzA5NjM1IDE3LjQzMTYgMC43MjI2NTYgMTcuMzkyNkwxLjY2OTkyIDE0LjIyODVMMTEuNjUwNCAwLjUzNzEwOUMxMS43MTU1IDAuNDkxNTM2IDExLjc2NDMgMC40NjIyNCAxMS43OTY5IDAuNDQ5MjE5QzExLjgyMjkgMC40MzYxOTggMTEuODY4NSAwLjQyOTY4OCAxMS45MzM2IDAuNDI5Njg4QzExLjk4NTcgMC40Mjk2ODggMTIuMDgzMyAwLjQ2MjI0IDEyLjIyNjYgMC41MjczNDRDMTIuMzY5OCAwLjU5MjQ0OCAxMi41NDIzIDAuNjgwMzM5IDEyLjc0NDEgMC43OTEwMTZDMTIuOTM5NSAwLjkwMTY5MyAxMy4xNTQzIDEuMDMxOSAxMy4zODg3IDEuMTgxNjRDMTMuNjE2NSAxLjMzMTM4IDEzLjg0NDQgMS40OTA4OSAxNC4wNzIzIDEuNjYwMTZDMTQuMjkzNiAxLjgyOTQzIDE0LjUwMiAyLjAwNTIxIDE0LjY5NzMgMi4xODc1QzE0Ljg5MjYgMi4zNjMyOCAxNS4wNTIxIDIuNTM5MDYgMTUuMTc1OCAyLjcxNDg0QzE1LjIwODMgMi43NjA0MiAxNS4yMzQ0IDIuODAyNzMgMTUuMjUzOSAyLjg0MThDMTUuMjczNCAyLjg4MDg2IDE1LjI4MzIgMi45MTY2NyAxNS4yODMyIDIuOTQ5MjJDMTUuMjgzMiAyLjk4ODI4IDE1LjI2NjkgMy4wMzA2IDE1LjIzNDQgMy4wNzYxN0wxMy44Mzc5IDVIMTcuNVpNMi41NzgxMiAxNC42ODc1TDEuODI2MTcgMTcuMTk3M0wyLjQwMjM0IDE3LjYwNzRMNC41NzAzMSAxNi4wNjQ1TDEzLjQyNzcgMy44NjcxOUwxMS40NzQ2IDIuNDgwNDdWMi40OTAyM0wyLjU3ODEyIDE0LjY4NzVaIiBmaWxsPSIjMTg1QUJEIi8+Cjwvc3ZnPgo=",es="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgNUMxNy43MDgzIDUgMTcuOTAzNiA1LjAzOTA2IDE4LjA4NTkgNS4xMTcxOUMxOC4yNjgyIDUuMTk1MzEgMTguNDI3NyA1LjMwMjczIDE4LjU2NDUgNS40Mzk0NUMxOC43MDEyIDUuNTc2MTcgMTguODA4NiA1LjczNTY4IDE4Ljg4NjcgNS45MTc5N0MxOC45NjQ4IDYuMTAwMjYgMTkuMDAzOSA2LjI5NTU3IDE5LjAwMzkgNi41MDM5MUMxOS4wMDM5IDYuNzEyMjQgMTguOTY0OCA2LjkwNzU1IDE4Ljg4NjcgNy4wODk4NEMxOC44MDg2IDcuMjY1NjIgMTguNzAxMiA3LjQyMTg4IDE4LjU2NDUgNy41NTg1OUMxOC40Mjc3IDcuNjk1MzEgMTguMjY4MiA3LjgwMjczIDE4LjA4NTkgNy44ODA4NkMxNy45MDM2IDcuOTU4OTggMTcuNzA4MyA3Ljk5ODA1IDE3LjUgNy45OTgwNUgxMS42NjAyTDEwLjIxNDggMTBIMTQuNTAyQzE0LjcxMDMgMTAgMTQuOTA1NiAxMC4wMzkxIDE1LjA4NzkgMTAuMTE3MkMxNS4yNzAyIDEwLjE5NTMgMTUuNDI5NyAxMC4zMDI3IDE1LjU2NjQgMTAuNDM5NUMxNS42OTY2IDEwLjU3NjIgMTUuODAwOCAxMC43MzU3IDE1Ljg3ODkgMTAuOTE4QzE1Ljk1NyAxMS4xMDAzIDE1Ljk5NjEgMTEuMjk1NiAxNS45OTYxIDExLjUwMzlDMTUuOTk2MSAxMS43MTIyIDE1Ljk1NyAxMS45MDc2IDE1Ljg3ODkgMTIuMDg5OEMxNS44MDA4IDEyLjI2NTYgMTUuNjk2NiAxMi40MjE5IDE1LjU2NjQgMTIuNTU4NkMxNS40Mjk3IDEyLjY5NTMgMTUuMjcwMiAxMi44MDI3IDE1LjA4NzkgMTIuODgwOUMxNC45MDU2IDEyLjk1OSAxNC43MTAzIDEyLjk5OCAxNC41MDIgMTIuOTk4SDguMDI3MzRMNi41ODIwMyAxNUgxMS41MDM5QzExLjcwNTcgMTUgMTEuODk3OCAxNS4wMzkxIDEyLjA4MDEgMTUuMTE3MkMxMi4yNjI0IDE1LjE5NTMgMTIuNDIxOSAxNS4zMDI3IDEyLjU1ODYgMTUuNDM5NUMxMi42OTUzIDE1LjU3NjIgMTIuODAyNyAxNS43MzU3IDEyLjg4MDkgMTUuOTE4QzEyLjk1OSAxNi4xMDAzIDEyLjk5OCAxNi4yOTU2IDEyLjk5OCAxNi41MDM5QzEyLjk5OCAxNi43MTIyIDEyLjk1OSAxNi45MDc2IDEyLjg4MDkgMTcuMDg5OEMxMi44MDI3IDE3LjI2NTYgMTIuNjk1MyAxNy40MjE5IDEyLjU1ODYgMTcuNTU4NkMxMi40MjE5IDE3LjY5NTMgMTIuMjYyNCAxNy44MDI3IDEyLjA4MDEgMTcuODgwOUMxMS44OTc4IDE3Ljk1OSAxMS43MDU3IDE3Ljk5OCAxMS41MDM5IDE3Ljk5OEgzLjU3NDIyTDIuNTY4MzYgMTguNzIwN0MyLjUxNjI4IDE4Ljc1MzMgMi40NjA5NCAxOC43Njk1IDIuNDAyMzQgMTguNzY5NUMyLjM0Mzc1IDE4Ljc2OTUgMi4yOTE2NyAxOC43NTY1IDIuMjQ2MDkgMTguNzMwNUwxLjEyMzA1IDE5LjU2MDVDMS4xMDM1MiAxOS41NzM2IDEuMDcwOTYgMTkuNTgwMSAxLjAyNTM5IDE5LjU4MDFDMC44NTYxMiAxOS41ODAxIDAuNzEyODkxIDE5LjUzMTIgMC41OTU3MDMgMTkuNDMzNkMwLjQ3ODUxNiAxOS4zMzU5IDAuNDE5OTIyIDE5LjIyODUgMC40MTk5MjIgMTkuMTExM1YxOS4wODJMMC44MzAwNzggMTcuNzI0NkMwLjc0NTQ0MyAxNy42NTk1IDAuNzAzMTI1IDE3LjU3ODEgMC43MDMxMjUgMTcuNDgwNUMwLjcwMzEyNSAxNy40NjA5IDAuNzA5NjM1IDE3LjQzMTYgMC43MjI2NTYgMTcuMzkyNkwxLjY2OTkyIDE0LjIyODVMMTEuNjUwNCAwLjUzNzEwOUMxMS43MTU1IDAuNDkxNTM2IDExLjc2NDMgMC40NjIyNCAxMS43OTY5IDAuNDQ5MjE5QzExLjgyMjkgMC40MzYxOTggMTEuODY4NSAwLjQyOTY4OCAxMS45MzM2IDAuNDI5Njg4QzExLjk4NTcgMC40Mjk2ODggMTIuMDgzMyAwLjQ2MjI0IDEyLjIyNjYgMC41MjczNDRDMTIuMzY5OCAwLjU5MjQ0OCAxMi41NDIzIDAuNjgwMzM5IDEyLjc0NDEgMC43OTEwMTZDMTIuOTM5NSAwLjkwMTY5MyAxMy4xNTQzIDEuMDMxOSAxMy4zODg3IDEuMTgxNjRDMTMuNjE2NSAxLjMzMTM4IDEzLjg0NDQgMS40OTA4OSAxNC4wNzIzIDEuNjYwMTZDMTQuMjkzNiAxLjgyOTQzIDE0LjUwMiAyLjAwNTIxIDE0LjY5NzMgMi4xODc1QzE0Ljg5MjYgMi4zNjMyOCAxNS4wNTIxIDIuNTM5MDYgMTUuMTc1OCAyLjcxNDg0QzE1LjIwODMgMi43NjA0MiAxNS4yMzQ0IDIuODAyNzMgMTUuMjUzOSAyLjg0MThDMTUuMjczNCAyLjg4MDg2IDE1LjI4MzIgMi45MTY2NyAxNS4yODMyIDIuOTQ5MjJDMTUuMjgzMiAyLjk4ODI4IDE1LjI2NjkgMy4wMzA2IDE1LjIzNDQgMy4wNzYxN0wxMy44Mzc5IDVIMTcuNVpNMi41NzgxMiAxNC42ODc1TDEuODI2MTcgMTcuMTk3M0wyLjQwMjM0IDE3LjYwNzRMNC41NzAzMSAxNi4wNjQ1TDEzLjQyNzcgMy44NjcxOUwxMS40NzQ2IDIuNDgwNDdWMi40OTAyM0wyLjU3ODEyIDE0LjY4NzVaIiBmaWxsPSIjODJBQkYxIi8+Cjwvc3ZnPgo=";var ts=o(2623),os=o(866),is=function(e){var t=e.buttonStyle,o=e.dismissMenuProps,i=e.buttonIconStyle,n=o.styleProvider,r=o.orchestrator,s=o.cardSize,a=Object(In.a)().getStringsFor("ProofingStrings")("SkittleCloseButton");return T.a.createElement(T.a.Fragment,null,Kr(a,"SkittleCloseButton",n,r,s),T.a.createElement(os.a,{iconProps:{iconName:ts.a.Cancel,style:i},id:"SkittleCloseButton",ariaLabel:a,className:t}))},ns=function(e){var t=e.buttonStyle,o=e.dismissMenuProps,i=e.buttonIconStyle,n=e.dismissMenuState,r=e.onDismiss,s=o.styleProvider,a=o.orchestrator,l=o.cardSize,c=o.onClosePermanent,u=Object(In.a)().getStringsFor("ProofingStrings"),p=u("SkittleClosePermanentButton"),d=Object(vr.b)(),g={menuItem:{color:d.buttonText,fontSize:"16px",width:"16px"},buttonIcon:i,callout:{backgroundColor:d.bodyBackground}},h=[{key:"1",ariaLabel:p,text:p,onClick:c,iconProps:{style:g.menuItem,iconName:ts.a.Blocked}}];return T.a.createElement(T.a.Fragment,null,Kr(u("SkittleOptions"),"SkittleOptionsButton",s,a,l),T.a.createElement(os.a,{iconProps:{iconName:ts.a.More,style:g.buttonIcon},id:"SkittleOptionsButton",ariaLabel:u("SkittleOptions"),className:t}),T.a.createElement(Rn.a,{items:h,target:"#SkittleOptionsButton",directionalHint:v.a.bottomRightEdge,hidden:n.isMenuHidden,onDismiss:r,calloutProps:{styles:{calloutMain:g.callout}},isBeakVisible:!1,theme:Object(vr.c)()}))},rs=function(e){var t=Object(C.useState)(!0),o={isMenuHidden:t[0],setIsMenuHidden:t[1]},i=e.orchestrator,n=i.isHoveredOrFocused,r=i.forceFocus,s=i.reset;Object(C.useEffect)((function(){var e;return null===(e=document.getElementById("SkittleOptionsButton"))||void 0===e?void 0:e.addEventListener("click",(function(){r(!0),o.setIsMenuHidden(!1),s(),Object(Hr.a)().logEvent(525169620,"OptionsClicked",zr.a.EditorScore,Ur.a.Info)}))}),[]);var a=Object(C.useCallback)((function(){r(!1),s(),o.setIsMenuHidden(!0)}),[]),c=!n&&o.isMenuHidden?{display:"none"}:[],u=Object(Oo.db)(Zr().skittleCloseButton,c),p={color:Object(vr.b)().bodySubtext,fontSize:"16px",width:"28px"},d={buttonStyle:u,dismissMenuProps:e,buttonIconStyle:p,dismissMenuState:o,onDismiss:a},g={buttonStyle:u,dismissMenuProps:e,buttonIconStyle:p};return T.a.createElement("div",null,T.a.createElement(ns,Object(l.__assign)({},d)),T.a.createElement(is,Object(l.__assign)({},g)))},ss=function(e){function t(t){var o=e.call(this,t)||this;return o._maxCritiqueCountNumber=99,o._animationTimeout=500,o._editorScoreRef=Object(C.createRef)(),o._str=Object(In.a)().getStringsFor("ProofingStrings"),o.slideUpKeyframes=o.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-44px"}}),o.slideUpShortKeyframes=o.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-20px"}}),o.skittleSlideUpKeyframes=o.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-25px"}}),o._slideUpStyles={slideUp:{animationDuration:"300ms",animationName:o.slideUpKeyframes,animationTimingFunction:"ease-out",marginTop:"-44px"},slideUpShort:{animationDuration:"300ms",animationName:o.slideUpShortKeyframes,animationTimingFunction:"ease-out",marginTop:"-20px"},slideUpSkittle:{animationDuration:"300ms",animationName:o.skittleSlideUpKeyframes,animationTimingFunction:"ease-out",marginTop:"-25px"}},o.renderSkittleBar=function(){var e=o.props,t=e.documentScore,i=e.styleProvider,n=e.isThinking,r={width:"".concat(t,"%")},s=Object(vr.b)(),a=Zr(),l=n?{backgroundSize:"200% 100%",background:"linear-gradient(97.75deg, ".concat(s.accentButtonBackground," 5.99%, ").concat(s.accentButtonText," 48.17%, ").concat(s.accentButtonBackground," 94.01%)"),animationDuration:"2s",animationTimingFunction:"ease",animationIterationCount:"infinite",animationName:i.keyframes({"0%":{backgroundPosition:"200% 100%"},"100%":{backgroundPosition:"0% 100%"}})}:[];return T.a.createElement("div",{className:i.css(a.skittleProgressBarWrapper)},T.a.createElement("div",{className:i.css(a.skittleProgressBar,l,r)}))},o.renderSkittleFooter=function(){var e=o.props,t=e.styleProvider,i=e.critiquesCount,n=i>1?o._str("SkittleCritiquesFooterPlural"):o._str("SkittleCritiquesFooterSingular"),r=i>o._maxCritiqueCountNumber?o._maxCritiqueCountNumber+"+":i,s=Zr();return T.a.createElement("div",{className:t.css(s.skittleCritiqueCountWrapper)},i?T.a.createElement(T.a.Fragment,null,Object(Wr.a)(n,"",{item:r,className:t.css(s.skittleCritiqueCount)})):T.a.createElement(T.a.Fragment,null,o._str("SkittleCritiquesAllGood")))},o.renderSkittleSuppressionMenu=function(){var e=o.props,t=e.orchestrator,i=e.styleProvider,n=e.cardSize;return T.a.createElement(T.a.Fragment,null,T.a.createElement(rs,{orchestrator:t,onClosePermanent:o.onClosePermanent,onClose:o.onCloseInSession,styleProvider:i,cardSize:n}))},o.renderProgressBarUnits=function(){var e=o.props,t=e.documentScore,i=e.isVisible,n=e.cardSize,r=e.styleProvider,s=e.orchestrator,a=e.progressBarData,c=a.spellingPercent,u=a.grammarPercent,p=a.refinementsPercent,d={isVisible:i,cardSize:n,styleProvider:r,orchestrator:s},g=Object(vr.c)();return T.a.createElement(T.a.Fragment,null,T.a.createElement(Jr,Object(l.__assign)({},d,{barLength:t,ariaLabel:o._str("CompletedProgressAriaLabel"),calloutContent:o._str("CompletedProgressCalloutContent"),color:g.semanticColors.accentButtonText,isSecondary:!1})),T.a.createElement(Jr,Object(l.__assign)({},d,{barLength:c,ariaLabel:o._str("SpellingProgressAriaLabel"),calloutContent:o._str("SpellingProgressCalloutContent"),color:"#ef0000",isSecondary:!0})),T.a.createElement(Jr,Object(l.__assign)({},d,{barLength:u,ariaLabel:o._str("GrammarProgressAriaLabel"),calloutContent:o._str("GrammarProgressCalloutContent"),color:"#3368ff",isSecondary:!0})),T.a.createElement(Jr,Object(l.__assign)({},d,{barLength:p,ariaLabel:o._str("RefinementsProgressAriaLabel"),calloutContent:o._str("RefinementsProgressCalloutContent"),color:"#7160eb",isSecondary:!0})))},o.onClickButtonHandler=function(e){var t,i;o.props.orchestrator.handleElementHoveredOrFocused(e),null===(i=(t=o.props).onClick)||void 0===i||i.call(t)},o.onCloseIconButtonHandler=function(e){o.props.orchestrator.handleElementHoveredOrFocused(e),o.onCloseInSession()},o.onOptionsIconButtonHandler=function(e){o.props.orchestrator.handleElementHoveredOrFocused(e)},o.onCloseInSession=function(){return o.onClosed(!1)},o.onClosePermanent=function(){return o.onClosed(!0)},o.onClosed=function(e){var t,i,n,r;Object(sr.a)().logCategoryRejectedAcrossLevels(ar.a.Skittle),Object(Hr.a)().logEvent(537518217,"SkittleDismissed",zr.a.EditorScore,Ur.a.Info,{permanent:e}),e?null===(i=(t=o.props).onClosePermanently)||void 0===i||i.call(t):null===(r=(n=o.props).onClose)||void 0===r||r.call(n)},o.state={isAnimating:!1,oldDocumentScore:t.documentScore},o}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.orchestrator.reset();var e=document.getElementById("SkittleCloseButton");this.setupEventListeners(!0,e,this.onCloseIconButtonHandler);var t=document.getElementById("SkittleOptionsButton");this.setupEventListeners(!0,t,this.onOptionsIconButtonHandler);var o=this._editorScoreRef.current;this.setupEventListeners(!0,o,this.onClickButtonHandler)},t.prototype.componentWillUnmount=function(){var e=document.getElementById("SkittleCloseButton");this.setupEventListeners(!1,e,this.onCloseIconButtonHandler);var t=document.getElementById("SkittleOptionsButton");this.setupEventListeners(!0,t,this.onOptionsIconButtonHandler);var o=this._editorScoreRef.current;this.setupEventListeners(!1,o,this.onClickButtonHandler)},t.prototype.setupEventListeners=function(e,t,o){if(t){var i=this.props.orchestrator,n=(e?t.addEventListener:t.removeEventListener).bind(t);n("click",o),n("blur",i.handleElementHoveredOrFocused),n("focus",i.handleElementHoveredOrFocused),n("mouseover",i.handleElementHoveredOrFocused),n("mouseleave",i.handleElementHoveredOrFocused)}},t.prototype.componentDidUpdate=function(e){var t=this,o=this.props,i=o.documentScore,n=o.cardSize;i===this.state.oldDocumentScore||this.state.isAnimating||n!==e.cardSize||(window.requestAnimationFrame((function(){t.setState({isAnimating:!0})})),window.setTimeout((function(){window.requestAnimationFrame((function(){t.setState({isAnimating:!1,oldDocumentScore:i})}))}),this._animationTimeout))},t.prototype.getSkittleAdditionalButtons=function(e){return e?this.renderSkittleSuppressionMenu():T.a.createElement(T.a.Fragment,null)},t.prototype.render=function(){var e=this.props,t=e.cardSize,o=e.styleProvider,i=e.isSkittle,n=Zr(),r=t!==ir.FullSize,s=r?n.progressBarWrapperShort:n.progressBarWrapper,a=r?n.suggestionsContainerShort:n.suggestionsContainer,l=r?n.progressLabelShort:n.progressLabel,c=r?n.editorScoreWrapperShort:n.editorScoreWrapper,u=i?n.skittleSuggestionsContainer:a,p=i?n.skittleEditorScoreWrapper:c,d=i?n.SkittleFocusStyle:n.focusStyle;return T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{id:"ProgressBar",className:o.css(n.flexContainer,d),role:cr.a.Button},T.a.createElement("div",{className:o.css(u)},!i&&T.a.createElement("div",{"aria-hidden":!0,className:o.css(l)},this._str("ProgressCardTitle")),T.a.createElement("div",{className:o.css(p)},this.renderEditorScore()),i&&this.renderEditorIcon(),this.getSkittleAdditionalButtons(!!i)),!i&&T.a.createElement("div",{className:o.css(s)},this.renderProgressBarUnits()),i&&this.renderSkittleBar(),i&&this.renderSkittleFooter()))},t.prototype.renderEditorScore=function(){var e=this.props,t=e.isVisible,o=e.cardSize,i=e.styleProvider,n=e.documentScore,r=e.orchestrator,s=e.isSkittle,a=this.state.isAnimating,l=!t||void 0,c=o!==ir.FullSize,u=Zr(),p=c?u.progressNumberContainerShort:u.progressNumberContainer,d=c?u.percentageContainerShort:u.percentageContainer,g=c?this._slideUpStyles.slideUpShort:this._slideUpStyles.slideUp,h=a?g:[],m=c?u.focusableScoreWrapperShort:u.focusableScoreWrapper,y=s?u.skittleScoreWrapper:[],f=s?u.skittleNumberContainer:[],b=s?u.skittlePercentageContainer:[],v=s&&a?this._slideUpStyles.slideUpSkittle:[];return T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{id:"ProgressCardScore","aria-hidden":l,"aria-label":Object(Qr.a)(this._str("ReviewProgressAriaLabel"),n)+this._str("EditorScoreTooltip"),"data-is-focusable":t,className:i.css(m,y),ref:this._editorScoreRef,role:cr.a.Note},T.a.createElement("div",{"aria-hidden":!0,className:i.css(p,f)},T.a.createElement("div",{className:i.css(u.progressNumber,h,v)},this.state.oldDocumentScore),T.a.createElement("div",{className:i.css(u.progressNumber)},n)),T.a.createElement("div",{"aria-hidden":!0,className:i.css(d,b)},"%")),Kr(this._str("EditorScoreTooltip"),"ProgressCardScore",i,r,o))},t.prototype.renderEditorIcon=function(){var e=this.props,t=e.orchestrator,o=e.styleProvider,i=t.isHoveredOrFocused?{display:"none"}:[];return T.a.createElement("div",{className:o.css(Zr().editorIconStyles,i),"aria-hidden":!0},T.a.createElement("img",{src:Object(vr.d)()?es:$r}))},t}(C.Component),as=Object(Yr.a)(ss),ls=function(e){function t(t){var o=e.call(this,t)||this;return o._progressCardRef=Object(C.createRef)(),o._str=Object(In.a)().getStringsFor("ProofingStrings"),o.focusedByMouse=!1,o.styleProvider=new lr,o.onClickHandler=function(e){var t=o.props,i=t.orchestrator,n=t.onClick;t.isSkittle&&(i.handleElementHoveredOrFocused(e),null==n||n())},o.onRightClickHandler=function(e){o.props.isSkittle&&(e.stopPropagation(),e.preventDefault())},o.renderProgressCard=function(){var e=Fr(),t=o.props,i=t.orchestrator,n=t.isSkittle,r=t.onClose,s=t.onClick,a=t.onClosePermanently,l=o.props.store,c=l.documentScore,u=l.isIncipient,p=l.critiquesCount,d=l.progressBarData,g=l.skittleArgs.isThinking,h=o.props.sizeStore.cardSize;return T.a.createElement("div",{"aria-hidden":!!u||void 0,className:o.styleProvider.css(e.progressCardWrapper),id:"progress-container"},T.a.createElement(as,{documentScore:c,cardSize:h,progressBarData:d,critiquesCount:p,orchestrator:i,styleProvider:o.styleProvider,isSkittle:n,isThinking:g,isVisible:!u,onClose:r,onClick:s,onClosePermanently:a}))},o.handleMouseEvent=function(e){var t=o.props,i=t.orchestrator,n=t.isSkittle,r=t.onMouseEnter,s=Object(sr.a)(),a=n?ar.a.Skittle:ar.a.EditorScore;switch(o.focusedByMouse=!1,e.type){case"mouseenter":r&&r(),s.logCategoryTriedAcrossLevels(a);break;case"mouseover":s.logCategoryTriedAcrossLevels(a);break;case"mousedown":o.focusedByMouse=!0,s.logCategoryKeptAcrossLevels(a)}n&&i.handleElementHoveredOrFocused(e)},o.scrollToTop=function(e){var t=o.props,i=t.orchestrator,n=t.isSkittle;o.focusedByMouse||n||window.scrollTo(0,0),n&&i.handleElementHoveredOrFocused(e)},o.visibilityChanged=function(e){var t=o.props.isSkittle;if(e.visible){var i=Object(sr.a)(),n=t?ar.a.Skittle:ar.a.EditorScore;i.logCategorySeenAcrossLevels(n),e.stopMonitoring=!0}},o.handleWindowResize=function(){o.props.sizeStore.viewportHeight=window.innerHeight},o}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.props.sizeStore.cardSize===ir.Collapsed&&this.props.orchestrator.reset()},t.prototype.componentDidMount=function(){var e=this.props.isSkittle;this.setupEventListeners(!0),window.addEventListener("resize",this.handleWindowResize);var t=Object(sr.a)(),o=e?ar.a.Skittle:ar.a.EditorScore;t.logCategoryOfferedAcrossLevels(o)},t.prototype.componentWillUnmount=function(){this.setupEventListeners(!1),window.removeEventListener("resize",this.handleWindowResize)},t.prototype.setupEventListeners=function(e){var t=this._progressCardRef.current;if(t){var o=(e?t.addEventListener:t.removeEventListener).bind(t);o("mousedown",this.handleMouseEvent),o("mouseover",this.handleMouseEvent),o("mouseenter",this.handleMouseEvent),o("mouseleave",this.handleMouseEvent),o("mouseup",this.handleMouseEvent),o("focus",this.scrollToTop),o("blur",this.props.orchestrator.handleElementHoveredOrFocused),o("click",this.onClickHandler),o("contextmenu",this.onRightClickHandler)}},t.prototype.render=function(){var e=Fr(),t=this.props,o=t.orchestrator,i=t.isSkittle,n=this.props.store.isIncipient,r=this.props.sizeStore.cardSize,s=r===ir.Disabled,a=r===ir.Collapsed,l=r===ir.Short,c=cr.a.TextBox,u=i?cr.a.Button:cr.a.Group,p=n?c:u,d=this.styleProvider.css(e.mainWrapper,i?e.skittleMainWrapper:[],a||s?e.mainWrapperCollapsed:[],l?e.mainWrapperShort:[],n?[]:e.mainWrapperProgress);return T.a.createElement("div",{className:this.styleProvider.css(s?e.disabledOffset:[])},T.a.createElement(Lr,{ariaLabel:this._str("ProgressCardAriaLabel"),headerId:"progressCard-header",hasHeader:!1,styleProvider:this.styleProvider,shouldRenderAsPremium:!1,style:e.pyroCardStyles,visibilityChanged:this.visibilityChanged,visibilityChangedCallbackMode:"onchanged"},T.a.createElement("div",{id:"ProgressCardWrapper",className:d,role:p,"data-is-focusable":!0,"aria-label":this.getAriaLabel(),ref:this._progressCardRef},this.renderProgressCard(),!i&&this.renderIncipientDocumentLabel(),i&&Kr(this._str("SkittleCardCallot"),"ProgressCardWrapper",this.styleProvider,o,r))))},t.prototype.getAriaLabel=function(){var e=this.props.store,t=e.documentScore,o=e.isIncipient,i=this.props.isSkittle?this._str("SkittleCardCallot"):"";return o?this._str("IncipientDocumentAriaLabel"):Object(Qr.a)(this._str("ReviewProgressAriaLabel"),t)+i},t.prototype.renderIncipientDocumentLabel=function(){var e=this.styleProvider,t=this.props.store.isIncipient;return T.a.createElement(Nr,{isVisible:t,styleProvider:e})},t}(C.Component),cs=Object(Yr.a)(ls),us={position:"fixed",right:"19px",marginTop:"19px",width:"148px",transition:"visibility 0s, opacity 0.3s linear 0.3s",transformOrigin:"top right"},ps="visible",ds="hidden",gs="1",hs="0",ms=35,ys=o(528),fs=function(){function e(e){var t,o=this;this._ulsLogger=e,this._skittleContainer=null,this._zoomContainerElement=null,this._contentContainerElement=null,this._scrollParentContainerElement=null,this.shouldSkittleRender=!1,this.canSkittleRender=void 0,this.isSkittleRendered=!1,this._orchestrator=new nr,this._documentScoreHandler=Object(tr.p)({documentScore:0,critiquesCount:0}),this._store=(t=this._documentScoreHandler,new or(t)),this._sizeStore=new rr(this._store),this.reposition=function(){o._skittleContainer&&o._zoomContainerElement&&(o._skittleContainer.style.transform=o._zoomContainerElement.style.transform,o.calculateCanSkittleRender())},this.calculateCanSkittleRender=function(){if(o._contentContainerElement&&o._skittleContainer&&o._scrollParentContainerElement){var e=o._contentContainerElement.getBoundingClientRect().width,t=o._scrollParentContainerElement.getBoundingClientRect().width,i=o._skittleContainer.getBoundingClientRect().width,n=(t-e)/2-ms>i;n!==o.canSkittleRender&&(o.canSkittleRender=n,o.shouldSkittleRender&&(o.canSkittleRender?o.tryShow():o.unconditionallyHide()))}}}return e.prototype.render=function(t){var o,i,n=this;if(t)if(this._skittleContainer)this._ulsLogger.sendTraceTag(529073374,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle already rendered!");else{this._zoomContainerElement=document.getElementsByClassName("PageContentOrigin").item(0),this._contentContainerElement=null!==(o=document.getElementsByClassName("Page").item(0))&&void 0!==o?o:document.getElementsByClassName("OutlineContainerDisplayWrapper").item(0),this._scrollParentContainerElement=document.getElementById("WACViewPanelContainer"),this._skittleContainer=document.createElement("div"),this._skittleContainer.id=e.skittleContainerId,this._skittleContainer.className=Object(ys.eb)(us),this._documentScoreHandler.documentScore=t.documentScore,this._documentScoreHandler.critiquesCount=t.critiqueNumber,this._store.skittleArgs.isThinking=t.isThinking;var r={store:this._store,orchestrator:this._orchestrator,sizeStore:this._sizeStore,isSkittle:!0,onClick:function(){t.onClick(),n._orchestrator.reset()},onClose:t.onClose,onClosePermanently:t.onClosePermanently,onMouseEnter:t.onMouseEnter};null===(i=this._scrollParentContainerElement)||void 0===i||i.appendChild(this._skittleContainer),vo.render(C.createElement(cs,Object(l.__assign)({},r)),this._skittleContainer),this.show(),this._ulsLogger.sendTraceTag(529073375,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle rendered!")}else this._ulsLogger.sendTraceTag(529073373,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Bad Skittle arguments!")},e.prototype.update=function(e){this._documentScoreHandler.documentScore=e.documentScore,this._documentScoreHandler.critiquesCount=e.critiqueNumber,this._store.skittleArgs.isThinking=e.isThinking,this._ulsLogger.sendTraceTag(529073376,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle updated!")},e.prototype.dispose=function(){this._skittleContainer&&this._scrollParentContainerElement?(this._scrollParentContainerElement.removeChild(this._skittleContainer),vo.unmountComponentAtNode(this._skittleContainer),this.removeEventListeners(),this._scrollParentContainerElement=this._zoomContainerElement=this._contentContainerElement=this._skittleContainer=null,this._ulsLogger.sendTraceTag(529073378,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle disposed!")):this._ulsLogger.sendTraceTag(529073377,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle already disposed!")},e.prototype.show=function(){this.shouldSkittleRender=!0,this.addEventListeners(),this.calculateCanSkittleRender(),this.tryShow()},e.prototype.tryShow=function(){this._skittleContainer&&this.canSkittleRender&&!this.isSkittleRendered&&(this._skittleContainer.style.visibility=ps,this._skittleContainer.style.opacity=gs,this._skittleContainer.style.overflow=ps,this.isSkittleRendered=!0,this._ulsLogger.sendTraceTag(529073379,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle shown!"))},e.prototype.hide=function(){this.shouldSkittleRender=!1,this.removeEventListeners(),this.unconditionallyHide()},e.prototype.unconditionallyHide=function(){this._skittleContainer&&(this._skittleContainer.style.visibility=ds,this._skittleContainer.style.opacity=hs,this._skittleContainer.style.overflow=ds,this.isSkittleRendered=!1,this._ulsLogger.sendTraceTag(529073408,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle hidden!"))},e.prototype.addEventListeners=function(){window.addEventListener("resize",this.calculateCanSkittleRender)},e.prototype.removeEventListeners=function(){window.removeEventListener("resize",this.calculateCanSkittleRender)},e.skittleContainerId="skittleContainer",e}(),bs=o(2738),vs=o(2775),Ss=o(2627),xs=o(2776),Cs=function(){function e(e){this._params=e,this.setEditorTheme=function(){var e=Do.b.getInstance().getThemeMode()===Do.a.Dark?vr.a.Dark:vr.a.Light;Object(vr.e)(e)},this._ulsLogger=this._params.ulsLogger}return e.prototype.init=function(){var e,t=new bs.a({logGroupName:"IdeasInWord",tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},defaultEventName:"",logToConsole:!0,logToKusto:!0},{sendTelemetryEvent:function(e){var t={otelEvent:e};Object(Vn.sendOtelEvent)(t)}},!0),o=new vs.a(t),i=new Ss.a(t,o),n=new xs.a(o,i);this.setEditorTheme(),Object(Oo.ib)(this.setEditorTheme),Object(sr.b)(n),Object(Hr.b)(t),Object(In.b)(new _n.a),Object(In.a)().loadLocale(null!==(e=this._params.uiCulture)&&void 0!==e?e:"en-US"),this._ulsLogger.sendTraceTag(557061700,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Editor initialized!")},e}(),Ts=new(function(){function e(){}return e.prototype.getWordContextualControllerInstance=function(e){if(e)return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(595858313,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested."),er.createController(e)},e.prototype.getSkittleControllerV2Instance=function(e){return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(529073372,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested for Skittle Controller."),new fs(e.ulsLogger)},e.prototype.getEditorInitializerInstance=function(e){return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(557061699,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested for Editor Initializer."),new Cs(e)},e}());o.d(t,"FactoryGlobal",(function(){return Ts}))}}]);
//# sourceMappingURL=canvasContextual.min.js.map