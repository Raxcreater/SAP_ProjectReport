'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1015:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.globalThis=void 0;D=c(1188);L.globalThis=D},1026:function(D,L,c){function l(O,M=self){M.addEventListener("message",function W(R){if(R&&R.data){var {id:V,type:ba,path:ha}=Object.assign({path:[]},R.data),ca=(R.data.Bjh||[]).map(v);try{const ra=ha.slice(0,-1).reduce((za,la)=>za[la],O),da=ha.reduce((za,la)=>za[la],O);switch(ba){case "GET":var ia=
da;break;case "SET":ra[ha.slice(-1)[0]]=v(R.data.value);ia=!0;break;case "APPLY":ia=da.apply(ra,ca);break;case "CONSTRUCT":const za=new da(...ca);ia=Object.assign(za,{[A]:!0});break;case "ENDPOINT":const {port1:la,port2:na}=new MessageChannel;l(O,na);ia=m(la,[la]);break;case "RELEASE":ia=void 0;break;default:return}}catch(ra){ia={value:ra,[I]:0}}Promise.resolve(ia).catch(ra=>({value:ra,[I]:0})).then(ra=>{const [da,za]=w(ra);M.postMessage(Object.assign(Object.assign({},da),{id:V}),za);"RELEASE"===
ba&&(M.removeEventListener("message",W),"MessagePort"===M.constructor.name&&M.close())})}});M.start&&M.start()}function e(O){if(O)throw Error("Proxy has been released and is not useable");}function a(O,M=[],T=function(){}){let R=!1;const W=new Proxy(T,{get(V,ba){e(R);if(ba===H)return()=>r(O,{type:"RELEASE",path:M.map(ha=>ha.toString())}).then(()=>{"MessagePort"===O.constructor.name&&O.close();R=!0});if("then"===ba){if(0===M.length)return{then:()=>W};V=r(O,{type:"GET",path:M.map(ha=>ha.toString())}).then(v);
return V.then.bind(V)}return a(O,[...M,ba])},set(V,ba,ha){e(R);const [ca,ia]=w(ha);return r(O,{type:"SET",path:[...M,ba].map(ra=>ra.toString()),value:ca},ia).then(v)},apply(V,ba,ha){e(R);V=M[M.length-1];if(V===G)return r(O,{type:"ENDPOINT"}).then(v);if("bind"===V)return a(O,M.slice(0,-1));const [ca,ia]=k(ha);return r(O,{type:"APPLY",path:M.map(ra=>ra.toString()),Bjh:ca},ia).then(v)},construct(V,ba){e(R);const [ha,ca]=k(ba);return r(O,{type:"CONSTRUCT",path:M.map(ia=>ia.toString()),Bjh:ha},ca).then(v)}});
return W}function k(O){O=O.map(w);return[O.map(M=>M[0]),Array.prototype.concat.apply([],O.map(M=>M[1]))]}function m(O,M){J.set(O,M);return O}function w(O){for(const [M,T]of F)if(T.vph(O)){const [R,W]=T.serialize(O);return[{type:"HANDLER",name:M,value:R},W]}return[{type:"RAW",value:O},J.get(O)||[]]}function v(O){switch(O.type){case "HANDLER":return F.get(O.name).deserialize(O.value);case "RAW":return O.value}}function r(O,M,T){return new Promise(R=>{const W=z();O.addEventListener("message",function ha(ba){ba.data&&
ba.data.id&&ba.data.id===W&&(O.removeEventListener("message",ha),R(ba.data))});O.start&&O.start();O.postMessage(Object.assign({id:W},M),T)})}function z(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}D=c(0);const A=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),H=Symbol("Comlink.releaseProxy"),I=Symbol("Comlink.thrown"),K=O=>"object"===typeof O&&null!==O||"function"===typeof O,F=new Map([["proxy",{vph:O=>K(O)&&O[A],serialize(O){const {port1:M,
port2:T}=new MessageChannel;l(O,M);return[T,[T]]},deserialize(O){O.start();return a(O,[],void 0)}}],["throw",{vph:O=>K(O)&&I in O,serialize({value:O}){return[O instanceof Error?{$fa:!0,value:{message:O.message,name:O.name,stack:O.stack}}:{$fa:!1,value:O},[]]},deserialize(O){if(O.$fa)throw Object.assign(Error(O.value.message),O.value);throw O.value;}}]]),J=new WeakMap;c.d(L,"a",function(){return N});class N{static gCj(O){N.n9a=O;N.N7j=a(O,[],void 0)}static get Endpoint(){return N.n9a}static get hCj(){return N.N7j}}
Object(D.a)(N,"WorkerUtils",null,[])},1043:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"WaterlineOverrideSettings",null,[])},1044:function(D,L,c){function l(z){return{scriptUrl:z,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}c.r(L);c.d(L,"UlsWorkerService",function(){return v});c.d(L,"ulsWorkerInsideInit",function(){return r});c.d(L,"ulsWorkerInsideScript",function(){return l});D=c(0);var e=c(857),a=c(986),k=c(22),m=c(2),w=c(865);class v{constructor(z,
A,G,H,I){this.Y5j=new a.a(z,A,G,H,I)}$W(z){this.Y5j.$W(z)}}Object(D.a)(v,"UlsWorkerService",null,[]);const r=({config:z,connection:A})=>{"Thread"===A.createMode&&e.setConfig(z);z=k.a.instance.Pa("Common.IRefreshableAppSettings");const G=new v(w.a.SCd,!0,m.AFrameworkApplication.Ve,null!==z&&void 0!==z?z:m.AFrameworkApplication.K,z);return e.Endpoint.G4e(A,()=>G)}},1045:function(D,L,c){D=c(0);var l=c(451),e=c(544),a=c(577),k=c(246);class m extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=
this.FileId=null}el(){return 97}static U$(G,H,I){const K=new m;K.FileId=G;K.HighWaterline=H;K.LowWaterline=I;return K}}Object(D.a)(m,"GetActivitiesRequest",k.a,[]);class w extends k.a{constructor(G,H,I){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;this.Waterline=H;this.Settings=I}el(){return 107}static U$(G,H,I){return new w(G,H,I)}}Object(D.a)(w,"GetRelevantActivitiesRequest",k.a,[]);class v extends k.a{constructor(G,H){super();this.WaterlineOverrideSettings=this.FileId=null;
this.FileId=G;this.WaterlineOverrideSettings=H}el(){return 96}static U$(G,H){return new v(G,H)}}Object(D.a)(v,"GetWywaActivitiesRequest",k.a,[]);class r{}Object(D.a)(r,"RelevantActivitiesSettings",null,[]);class z extends k.a{constructor(){super();this.FileId=null}el(){return 109}static U$(G){const H=new z;H.FileId=G;return H}}Object(D.a)(z,"UpdateWaterlineRequest",k.a,[]);c.d(L,"a",function(){return A});class A{constructor(G,H,I,K,F){this.oVj=G;this.Nod=H;this.fJe=I;this.Rlc=K;this.nDg=F}requestWYWAActivities(G){G=
v.U$(this.Nod(),G);return l.a.then(this.haa(G,"wywa"),H=>H)}requestActivities(G,H){G=m.U$(this.Nod(),G,H);return l.a.then(this.haa(G,"activities"),I=>I)}DJn(){const G=z.U$(this.Nod());return l.a.then(this.haa(G,"waterline"),H=>H)}requestRelevantActivities(G,H){H=Object.assign(new r,{FirstDocumentOpen:H,MockDataEnabled:!1});G=w.U$(this.Nod(),G,H);return l.a.then(this.haa(G,"relevant"),I=>I)}updateActivityState(G){return l.a.I5c(this.nDg,H=>H.Yuo(G.itemIds,G.activityStatesToSet,G.activityStatesToReset,
G.resetUnseenCount))}requestActivityFeed(){return l.a.I5c(this.nDg,G=>G.getActivityFeed(null))}haa(G,H){const I={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.I5c(this.oVj,K=>K.my(this.fJe,I,e.a.Zvh(G,this.Rlc),H)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.Ae))return null;({group:K}=a.a.q0(K.args.data.Ae));return K&&K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(D.a)(A,"SharedActivityRepository",null,[])},1188:function(D,L,c){D.exports=c(1189)()?globalThis:
c(1190)},1189:function(D){D.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1190:function(D){function L(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}D.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(c){return L()}try{return __global__?__global__:L()}finally{delete Object.prototype.HPo}}()},
1191:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.lwi=void 0;var l=c(929);L.lwi=function(e){return function(a){var k=e[a];switch(typeof k){case "boolean":return(0,l.getBooleanFeatureGate)(a,k);case "number":return(0,l.s0h)(a,k);case "string":return(0,l.getStringFeatureGate)(a,k);default:throw Error("Wrong defaultValue type");}}}},1192:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.qwi=void 0;var l=c(930);L.qwi=function(){return function(e){return(0,l.isChangeGateEnabled)(e)}}},
1193:function(D,L,c){function l(k){var m=(0,a.K1f)(void 0);(0,a.K1f)(function(){var w=void 0!==m?m():{};return e.__assign(e.__assign({},w),k)});return m}Object.defineProperty(L,"__esModule",{value:!0});L.mcn=L.jcn=void 0;var e=c(71),a=c(930);L.jcn=l;L.mcn=function(k,m){return l(m)}},1194:function(D,L,c){function l(k){function m(){return{}}for(var w,v,r={},z=0,A=Object.keys(k);z<A.length;z++){var G=A[z];r[G]=null===(w=k[G])||void 0===w?void 0:w.toString()}var H=null!==(v=(0,a.b2f)(void 0))&&void 0!==
v?v:m;(0,a.b2f)(function(){return e.__assign(e.__assign({},H()),r)});return H}Object.defineProperty(L,"__esModule",{value:!0});L.ncn=L.kcn=void 0;var e=c(71),a=c(929);L.kcn=l;L.ncn=function(k,m){return l(m)}},1379:function(D,L,c){c.d(L,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.IMo=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.WOo=1]="VoiceDictationBadge";a[a.XOo=2]="VoiceDictationPhrase"})(e||(e={}))},1475:function(D,L,c){c.r(L);c.d(L,
"Box4PasteSteward",function(){return ca});D=c(0);var l=c(22),e=c(2),a=c(16),k=c(138),m=c(62),w=c(7),v=c(8),r=c(29),z=c(82),A=c(11),G=c(135),H=c(10),I=c(3),K=c(37),F=c(5),J=c(99),N=c(192),O=c(40),M=c(94),T=c(43),R=c(47),W=c(36),V=c(476),ba=c(495),ha=c(1703);class ca extends ha.a{constructor(ia,ra,da,za,la,na,Ca,Na=null,Ta=null){super(ia,Ca,Na,Ta);this._formatting=null;this.iJa=!1;this.ssb=null;this.sTb=-1;this.Ytb=0;this.Gyc=new z.a;this.eSm=4294967295;r.a(4223754,307,T.OutlineElementReader.Oh(ia));
this.ysb=ra;this.ysb.k_b(this);this.tL=da;this.tL.k_b(this);this.Vp=za;this.xn=la;this.hPm=na;this.VGe=J.ListReader.lj(this.Dc);ca.fem();ca.Sdm();ca.Bem()}get nva(){return null!=this.rsg?this.rsg:this.rsg=l.a.instance.Pa("Box4.IInternalLinkManager")}get oCd(){return this._formatting}get e1b(){return this.VGe&&!this.tL.jCa}get bAb(){return 0<this.Ytb}reset(){super.reset();this._formatting=this.Xhf(!1)}mVe(ia){r.a(4223762,307,T.OutlineElementReader.Oh(this.Dc)||M.OutlineReader.Kw(this.Dc));this.Yac(!1);
var ra=new F.GraphIterator;ra.ed(this.Dc);ia=ha.a.ih.GN(this.Dc,this.yLc(ia));this.Zvd(ra,!1);r.a(4223763,307,ia===this.Dc.currentNode);r.a(4223764,307,H.ParagraphReader.ic(ia));-1!==this._formatting.mt&&ca.paragraphEditor.zD(ia,this._formatting.mt);if(ca.paragraphEditor.Vp&&!this.O0.laj&&this._formatting.textIndent&&({unit:za,returnValue:da}=ca.N3d(this._formatting.textIndent),ra=!1,da||!J.ListReader.HZ)){if(0>da){ra=!0;var da=-1*da}var za=ca.r3e(da,za);ra?ca.paragraphEditor.Vp.Kmb(ia,za):ca.paragraphEditor.Vp.jca(ia,
za)}(ca.Kd.zg||K.a.instance.J(3)&&A.App.Bw.ejc)&&ia.setValue(w.a.BFb,!0);this._formatting.lineSpacing&&ca.paragraphEditor.sC(ia,this._formatting.lineSpacing);if(this._formatting.eic){ra=[];za=[];da=[];const Ca=this._formatting.eic.split(" ");let Na=1,Ta=0;for(let Fa=0;Fa<Ca.length;Fa++){var la=ca.vPk(Ca[Fa]),na=ca.uPk(Ca[Fa]);if(-1!==la)Na=la;else if(-1!==na)Ta=na;else{({unit:la,returnValue:na}=ca.N3d(Ca[Fa]));la=ca.r3e(na,la);if(0<=la&&la<=this.eSm)ra.push(la),za.push(Na),da.push(Ta);else{r.b(555103310,
307,15,"Invalid custom tab value. tabStops: "+this._formatting.eic+" index: "+Fa);break}Na=1;Ta=0}}0<ra.length&&ca.paragraphEditor.C$j(ia,ra,za,da)}this._formatting.paragraph=ia;this.iJa=!0}Zvd(ia,ra){r.a(8128518,307,!ra);this.nU&&(0<this.nU&&this.Vp.kGc(ia,this.nU),0>this.nU&&this.Vp.SQa(ia,this.nU,0));ia&&this.xn.Fae(ia,this.bAb);this.nU=0}dge(ia){this.Gyc.add(ia)}o0e(){this.nU=0}Cba(ia,ra=null){r.a(4223772,307,H.ParagraphReader.rh(this.Dc));const da=this.Dc.currentNode;this._formatting.Oag(da);
if(!this.O0.Yag(this.Dc,ra,!1)){var za=da.qa.last,la=W.a.Dw(da);this.iJa&&(za.formatting=this._formatting.WP.Xf(za),da.Cn(),this.iJa=!1);ia=this.O0.gpf(ia,ra);this.O0.tGa(this.Dc.currentNode,this._formatting.Nba,ra);this.characterPropertiesEditor.replaceTextRange(la,ia,void 0,void 0,I.a.paste)}}iFa(ia){this.O0.lUd&&this.O0.eTd(ia)?(this.hG(),this.iG(ia)):(r.a(4223773,307,H.ParagraphReader.rh(this.Dc)),ia=W.a.Dw(this.Dc.currentNode),this.characterPropertiesEditor.Qfa(ia,ra=>new V.a(ra)))}Skb(){this.O0.npf(this.Dc)}rwa(ia){if(ca.E8k(ia)){const ra=
this.Dc.currentNode;H.ParagraphReader.ic(ra)&&(ra.Xcc=ia.Ybf)}else this.ysb.rwa(ia)}dFa(ia){this._formatting=ia;this.iJa=!0}oQa(ia){r.a(4223774,307,H.ParagraphReader.rh(this.Dc));r.a(4223775,307,!this.ssb);r.a(4223776,307,0>this.sTb);this.ssb=ia;this.sTb=H.ParagraphReader.textLength(this.Dc.currentNode)}nQa(){r.a(4223777,307,H.ParagraphReader.rh(this.Dc));r.a(4223778,307,!!this.ssb);r.a(4223779,307,0<=this.sTb);let ia=W.a.createTextRange(this.Dc.currentNode,this.sTb,H.ParagraphReader.textLength(this.Dc.currentNode)),
ra="",da="";this.nva&&({HWf:ra,DQh:da}=this.nva.Qag(G.HyperlinkReader.ZNa(this.ssb))).returnValue&&(this.ssb=ra,da&&(this.characterPropertiesEditor.replaceTextRange(ia,da),ia=W.a.createTextRange(this.Dc.currentNode,this.sTb,H.ParagraphReader.textLength(this.Dc.currentNode))));ca.hyperlinkEditor.eH(ia,this.ssb,!1);this.iJa=!0;this.ssb=null;this.sTb=-1}iG(ia){this.mVe(ia);this._formatting.sge(this.Dc.currentNode);this.O0.tGa(this.Dc.currentNode,this._formatting.Nba,ia)}hG(){r.a(4223808,307,H.ParagraphReader.rh(this.Dc));
ca.hyperlinkEditor.Pbl(this.Dc.currentNode);O.OutlineElementNavigator.$d(this.Dc)}Pkb(){}Okb(){}tQa(){}x3a(){}lFa(){r.a(4223809,307,T.OutlineElementReader.Oh(this.Dc)||M.OutlineReader.Kw(this.Dc));let ia=!1;this.bAb||(ia=this.e1b||!0);ia||(this.nU+=1);this.Ytb++}jFa(){this.Ytb--;let ia=!1;this.bAb||(ia=this.e1b||!0,this.xn.lVi(this.Gyc));ia||--this.nU}sQa(ia){r.a(4223810,307,T.OutlineElementReader.Oh(this.Dc)||M.OutlineReader.Kw(this.Dc));r.a(4223811,307,!!ia.listStyleType);this.xn.Eae(this.IDm(ia))}kFa(){r.a(4223813,
307,T.OutlineElementReader.Oh(this.Dc));e.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(J.ListReader.lj(this.Dc)){const ia=H.ParagraphReader.Il(this.Dc.currentNode),ra=this.hPm.LCb(this.Dc);ba.a.hh.jO||this.xn.Dae(ra,ia,null)}}A3a(ia){this.ysb.A3a(ia)}Bba(ia){this.tL.Bba(ia)}yba(){this.tL.yba()}Aba(ia){this.tL.Aba(ia)}zba(){this.tL.zba()}xba(ia){this.tL.xba(ia)}wba(){this.tL.wba()}static get paragraphEditor(){return null!=ca.Zug?
ca.Zug:ca.Zug=l.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ca.rqg?ca.rqg:ca.rqg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Kd(){return null!=ca.jyg?ca.jyg:ca.jyg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Neg(){return null!=ca.Pyg?ca.Pyg:ca.Pyg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get $hc(){return ca.oNe}static set $hc(ia){ca.oNe=ia}static get hh(){return N.a.getInstance()}static fem(){const ia=
K.a.instance.J(6);ca.O3a[1]=ia?R.StyleReader.wordStyleIdHeading1:R.StyleReader.styleIdHeading1;ca.O3a[2]=ia?R.StyleReader.wordStyleIdHeading2:R.StyleReader.styleIdHeading2;ca.O3a[3]=ia?R.StyleReader.wordStyleIdHeading3:R.StyleReader.styleIdHeading3;ca.O3a[4]=ia?R.StyleReader.b7a:R.StyleReader.Mxa;ca.O3a[5]=ia?R.StyleReader.c7a:R.StyleReader.qSa;ca.O3a[6]=ia?R.StyleReader.d7a:R.StyleReader.rSa;ca.O3a[7]=ia?null:R.StyleReader.Q5a}static Sdm(){ca.Sva.unspecified=0;ca.Sva.defaultUnordered=1;ca.Sva.defaultOrdered=
1;ca.Sva.none=0;ca.Sva.disc=1;ca.Sva.circle=2;ca.Sva.square=3;ca.Sva.decimal=1;ca.Sva.lowerAlpha=2;ca.Sva.lowerRoman=3;ca.Sva.upperAlpha=4;ca.Sva.upperRoman=5}static Bem(){ca.oNe=ca.Neg.Yn()}static vPk(ia){let ra=-1;if(!ia)return ra;ia=ia.toLowerCase();switch(ia){case "left":ra=1;break;case "center":ra=3;break;case "right":ra=4;break;case "decimal":ra=6;break;case "bar":ra=7}return ra}static uPk(ia){let ra=-1;if(!ia)return ra;ia=ia.toLowerCase();switch(ia){case "blank":ra=0;break;case "dotted":ra=
1;break;case "dashed":ra=2;break;case "lined":ra=3}return ra}static tzb(ia){const ra=a.a.substring(ia,0,2),da=a.a.substring(ia,2,4);return a.a.substring(ia,4,6)+da+ra}static N3d(ia){let ra=0;const da=ia.length;var za=a.a.substring(ia,0,da-2);za=parseFloat(za);ia=a.a.substr(ia,da-2,2);switch(ia){case "in":ra=3;break;case "px":ra=7;break;case "cm":ra=1;break;case "pt":ra=5;break;default:v.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",
ia),za=0}return{returnValue:za,unit:ra}}static r3e(ia,ra){let da=0;switch(ra){case 3:da=k.a.Xy(ia);break;case 7:da=m.a.jy(ia,0);break;case 1:da=k.a.q_e(ia);break;case 5:da=k.a.Xy(k.a.HQf(ia));break;default:v.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ia,ra)}return da}static E8k(ia){return!!ia&&!!ia.Ybf&&""!==ia.Ybf}}ca.O3a=Array(8);ca.Sva={};ca.oNe=null;Object(D.a)(ca,"Box4PasteSteward",ha.a,[])},1499:function(D,L,c){D=
c(0);var l=c(2),e=c(1944),a=c(8);const k=(w,v)=>{const r={};let z=null;switch(w){case 0:z="HtmlProcessor";var A=v.a;null!=A&&(r.SessionID=A);var G=v.b.toString();null!=G&&(r.Elements=G);var H=v.c.toString();null!=H&&(r.PrunedElements=H);var I=v.d.toString();null!=I&&(r.TransparentElements=I);var K=v.e.toString();null!=K&&(r.VoidElements=K);var F=v.f.toString();null!=F&&(r.UnknownElements=F);break;case 1:z="WordConverter";var J=v.a;null!=J&&(r.SessionID=J);var N=v.b.toString();null!=N&&(r.BulletsConverted=
N);var O=v.c.toString();null!=O&&(r.NumberedConverted=O);break;case 2:z="FormattingSteward";var M=v.a;null!=M&&(r.SourceApp=M);var T=v.b;null!=T&&(r.Browser=T);var R=v.c;null!=R&&(r.OperationId=R);var W=v.d.toString();null!=W&&(r.Lang=W);var V=v.e.toString();null!=V&&(r.TextDir=V);var ba=v.f.toString();null!=ba&&(r.Bold=ba);var ha=v.g.toString();null!=ha&&(r.Math=ha);var ca=v.h.toString();null!=ca&&(r.Italics=ca);var ia=v.i.toString();null!=ia&&(r.Underline=ia);var ra=v.j.toString();null!=ra&&(r.Strikethrough=
ra);var da=v.k.toString();null!=da&&(r.Subscript=da);var za=v.l.toString();null!=za&&(r.Superscript=za);var la=v.m.toString();null!=la&&(r.Fontsize=la);var na=v.n.toString();null!=na&&(r.Fontface=na);var Ca=v.o.toString();null!=Ca&&(r.GrowFontsize=Ca);var Na=v.p.toString();null!=Na&&(r.ShrinkFontsize=Na);var Ta=v.q.toString();null!=Ta&&(r.FontColor=Ta);var Fa=v.r.toString();null!=Fa&&(r.FontHighlight=Fa);var qa=v.s.toString();null!=qa&&(r.ParagraphStyle=qa);var ja=v.t.toString();null!=ja&&(r.TextAlign=
ja);var X=v.u.toString();null!=X&&(r.TextIndent=X);var ua=v.v.toString();null!=ua&&(r.MarginLeft=ua);var Ha=v.w.toString();null!=Ha&&(r.ParagraphSpaceBefore=Ha);var Ea=v.x.toString();null!=Ea&&(r.ParagraphSpaceAfter=Ea);var wa=v.y.toString();null!=wa&&(r.LineSpace=wa);var sa=v.z.toString();null!=sa&&(r.CellShadingColor=sa);var fa=v.ba.toString();null!=fa&&(r.StyleDefinition=fa);var Ma=v.bb.toString();null!=Ma&&(r.TabStops=Ma);break;case 3:z="SemanticEvents";var Ua=v.a;null!=Ua&&(r.SessionID=Ua);var Qa=
v.b.toString();null!=Qa&&(r.Text=Qa);var Ja=v.c.toString();null!=Ja&&(r.LineBreak=Ja);var Wa=v.d.toString();null!=Wa&&(r.Image=Wa);var Ya=v.e.toString();null!=Ya&&(r.File=Ya);var sb=v.f.toString();null!=sb&&(r.FormattingChange=sb);var ob=v.g.toString();null!=ob&&(r.Anchor=ob);var fc=v.h.toString();null!=fc&&(r.Paragraph=fc);var Eb=v.i.toString();null!=Eb&&(r.Math=Eb);var Ib=v.j.toString();null!=Ib&&(r.List=Ib);var Nb=v.k.toString();null!=Nb&&(r.ListItem=Nb);var pb=v.l.toString();null!=pb&&(r.RenderAugmentation=
pb);var Aa=v.m.toString();null!=Aa&&(r.Span=Aa);break;case 4:z="SemanticTableEvents";var xb=v.a;null!=xb&&(r.SessionID=xb);var gb=v.b.toString();null!=gb&&(r.Tables=gb);var Xa=v.c.toString();null!=Xa&&(r.TableRow=Xa);var Va=v.d.toString();null!=Va&&(r.TableCell=Va);var Gb=v.e.toString();null!=Gb&&(r.TablePart=Gb);break;case 5:z="HtmlEvents";var Xb=v.a;null!=Xb&&(r.OperationId=Xb);var rc=v.b;null!=rc&&(r.SourceApp=rc);var qb=v.c;null!=qb&&(r.Browser=qb);var Zb=null==v.d?null:v.d.toString();null!=Zb&&
(r.Text=Zb);var Rb=null==v.e?null:v.e.toString();null!=Rb&&(r.A=Rb);var Ra=null==v.f?null:v.f.toString();null!=Ra&&(r.Abbr=Ra);var ab=null==v.g?null:v.g.toString();null!=ab&&(r.Acronym=ab);var fb=null==v.h?null:v.h.toString();null!=fb&&(r.Address=fb);var bb=null==v.i?null:v.i.toString();null!=bb&&(r.Applet=bb);var Ub=null==v.j?null:v.j.toString();null!=Ub&&(r.Area=Ub);var Oa=null==v.k?null:v.k.toString();null!=Oa&&(r.B=Oa);var Fc=null==v.l?null:v.l.toString();null!=Fc&&(r.Base=Fc);var xc=null==v.m?
null:v.m.toString();null!=xc&&(r.Basefont=xc);var pd=null==v.n?null:v.n.toString();null!=pd&&(r.Bdo=pd);var lb=null==v.o?null:v.o.toString();null!=lb&&(r.Big=lb);var Tb=null==v.p?null:v.p.toString();null!=Tb&&(r.Blockquote=Tb);var pc=null==v.q?null:v.q.toString();null!=pc&&(r.Body=pc);var Db=null==v.r?null:v.r.toString();null!=Db&&(r.Br=Db);var Ob=null==v.s?null:v.s.toString();null!=Ob&&(r.Button=Ob);var jb=null==v.t?null:v.t.toString();null!=jb&&(r.Caption=jb);var tb=null==v.u?null:v.u.toString();
null!=tb&&(r.Center=tb);var ac=null==v.v?null:v.v.toString();null!=ac&&(r.Cite=ac);var zc=null==v.w?null:v.w.toString();null!=zc&&(r.Code=zc);var yc=null==v.x?null:v.x.toString();null!=yc&&(r.Col=yc);var cd=null==v.y?null:v.y.toString();null!=cd&&(r.Colgroup=cd);var Cd=null==v.z?null:v.z.toString();null!=Cd&&(r.Dd=Cd);var ud=null==v.ba?null:v.ba.toString();null!=ud&&(r.Del=ud);var $d=null==v.bb?null:v.bb.toString();null!=$d&&(r.Dfn=$d);var gc=null==v.bc?null:v.bc.toString();null!=gc&&(r.Dir=gc);var kc=
null==v.bd?null:v.bd.toString();null!=kc&&(r.Div=kc);var Wc=null==v.be?null:v.be.toString();null!=Wc&&(r.Dl=Wc);var td=null==v.bf?null:v.bf.toString();null!=td&&(r.Dt=td);var Fe=null==v.bg?null:v.bg.toString();null!=Fe&&(r.Em=Fe);var Cf=null==v.bh?null:v.bh.toString();null!=Cf&&(r.Fieldset=Cf);var ie=null==v.bi?null:v.bi.toString();null!=ie&&(r.Font=ie);var Ae=null==v.bj?null:v.bj.toString();null!=Ae&&(r.Form=Ae);var xe=null==v.bk?null:v.bk.toString();null!=xe&&(r.Frame=xe);var ng=null==v.bl?null:
v.bl.toString();null!=ng&&(r.Frameset=ng);var Af=null==v.bm?null:v.bm.toString();null!=Af&&(r.H=Af);var De=null==v.bn?null:v.bn.toString();null!=De&&(r.Head=De);var Rf=null==v.bo?null:v.bo.toString();null!=Rf&&(r.Hr=Rf);var Je=null==v.bp?null:v.bp.toString();null!=Je&&(r.Html=Je);var le=null==v.bq?null:v.bq.toString();null!=le&&(r.I=le);var dh=null==v.br?null:v.br.toString();null!=dh&&(r.Iframe=dh);var lj=null==v.bs?null:v.bs.toString();null!=lj&&(r.Img=lj);var sh=null==v.bt?null:v.bt.toString();
null!=sh&&(r.Input=sh);var We=null==v.bu?null:v.bu.toString();null!=We&&(r.Ins=We);var Fh=null==v.bv?null:v.bv.toString();null!=Fh&&(r.Isindex=Fh);var cc=null==v.bw?null:v.bw.toString();null!=cc&&(r.Kbd=cc);var tc=null==v.bx?null:v.bx.toString();null!=tc&&(r.Label=tc);var bd=null==v.by?null:v.by.toString();null!=bd&&(r.Legend=bd);var vd=null==v.bz?null:v.bz.toString();null!=vd&&(r.Li=vd);var Tc=null==v.ca?null:v.ca.toString();null!=Tc&&(r.Link=Tc);var nb=null==v.cb?null:v.cb.toString();null!=nb&&
(r.Map=nb);var Fb=null==v.cc?null:v.cc.toString();null!=Fb&&(r.Math=Fb);var Kc=null==v.cd?null:v.cd.toString();null!=Kc&&(r.Menu=Kc);var sc=null==v.ce?null:v.ce.toString();null!=sc&&(r.Meta=sc);var Oc=null==v.cf?null:v.cf.toString();null!=Oc&&(r.Noframes=Oc);var Ke=null==v.cg?null:v.cg.toString();null!=Ke&&(r.Noscript=Ke);var Re=null==v.ch?null:v.ch.toString();null!=Re&&(r.Object=Re);var lf=null==v.ci?null:v.ci.toString();null!=lf&&(r.Ol=lf);var Jh=null==v.cj?null:v.cj.toString();null!=Jh&&(r.Optgroup=
Jh);var zg=null==v.ck?null:v.ck.toString();null!=zg&&(r.Option=zg);var Kd=null==v.cl?null:v.cl.toString();null!=Kd&&(r.P=Kd);var Td=null==v.cm?null:v.cm.toString();null!=Td&&(r.Param=Td);var Gd=null==v.cn?null:v.cn.toString();null!=Gd&&(r.Pre=Gd);var rf=null==v.co?null:v.co.toString();null!=rf&&(r.Q=rf);var hf=null==v.cp?null:v.cp.toString();null!=hf&&(r.S=hf);var Ui=null==v.cq?null:v.cq.toString();null!=Ui&&(r.Samp=Ui);var Ik=null==v.cr?null:v.cr.toString();null!=Ik&&(r.Script=Ik);var th=null==v.cs?
null:v.cs.toString();null!=th&&(r.Select=th);var Mi=null==v.ct?null:v.ct.toString();null!=Mi&&(r.Small=Mi);var of=null==v.cu?null:v.cu.toString();null!=of&&(r.Span=of);var ci=null==v.cv?null:v.cv.toString();null!=ci&&(r.Strike=ci);var Fl=null==v.cw?null:v.cw.toString();null!=Fl&&(r.Strong=Fl);var xg=null==v.cx?null:v.cx.toString();null!=xg&&(r.Style=xg);var Uf=null==v.cy?null:v.cy.toString();null!=Uf&&(r.Sub=Uf);var tg=null==v.cz?null:v.cz.toString();null!=tg&&(r.Sup=tg);var sg=null==v.da?null:v.da.toString();
null!=sg&&(r.Tables=sg);var jh=null==v.db?null:v.db.toString();null!=jh&&(r.Tbody=jh);var eh=null==v.dc?null:v.dc.toString();null!=eh&&(r.Td=eh);var li=null==v.dd?null:v.dd.toString();null!=li&&(r.Textarea=li);var Oj=null==v.de?null:v.de.toString();null!=Oj&&(r.Tfoot=Oj);var yk=null==v.df?null:v.df.toString();null!=yk&&(r.Th=yk);var dj=null==v.dg?null:v.dg.toString();null!=dj&&(r.Thead=dj);var bl=null==v.dh?null:v.dh.toString();null!=bl&&(r.Title=bl);var mh=null==v.di?null:v.di.toString();null!=mh&&
(r.Tr=mh);var Qk=null==v.dj?null:v.dj.toString();null!=Qk&&(r.Tt=Qk);var Zf=null==v.dk?null:v.dk.toString();null!=Zf&&(r.U=Zf);var Pl=null==v.dl?null:v.dl.toString();null!=Pl&&(r.Ul=Pl);var rh=null==v.dm?null:v.dm.toString();null!=rh&&(r.Var=rh);var tf=null==v.dn?null:v.dn.toString();null!=tf&&(r.Unknown=tf);break;case 6:z="List";var Ql=v.a;null!=Ql&&(r.SessionID=Ql);var ji=v.b.toString();null!=ji&&(r.MaxListLevel=ji)}r.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(r)};c.d(L,"a",
function(){return m});class m{static get sna(){null==m.Xsb&&(m.Xsb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return m.Xsb}static get Wki(){null==m.mze&&(m.mze=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return m.mze}static m_(w){a.ULS.sendTraceTag(524038472,307,50,w)}static rYh(w){const v={};v.a=w;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;return v}static dKm(w){m.sna||m.m_(k(0,w))}static NTh(w){const v={};v._sessionID=
w;return v}static iof(w){const v={};v.a=w;v.b=0;v.c=0;return v}static LOm(w){m.sna||m.m_(k(1,w))}static qYh(w,v){const r={};r.c=e.a[w];r.a=v;return r}static cKm(w,v){m.Wki&&w&&(w.b=v,m.m_(k(5,w)))}static b4h(w){const v={};v.a=w;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;v.g=0;v.h=0;v.i=0;v.j=0;v.k=0;v.l=0;v.m=0;return v}static jNm(w){m.sna||m.m_(k(3,w))}static c4h(w){const v={};v.a=w;v.b=0;v.c=0;v.d=0;v.e=0;return v}static kNm(w){m.sna||m.m_(k(4,w))}static Zif(w,v){const r={};r.b=e.a[w];r.c=v;r.d=0;r.e=0;r.f=
0;r.g=0;r.h=0;r.i=0;r.j=0;r.k=0;r.l=0;r.m=0;r.n=0;r.o=0;r.p=0;r.q=0;r.r=0;r.s=0;r.t=0;r.w=0;r.x=0;r.y=0;r.z=0;r.u=0;r.v=0;r.ba=0;r.bb=0;return r}static HJm(w,v){m.Wki&&w&&(w.a=v,m.m_(k(2,w)))}static VIl(w){const v={};v.a=w;v.b=-1;return v}static HKm(w){!m.sna&&w&&0<=w.b&&m.m_(k(6,w))}}m.Xsb=null;m.mze=null;Object(D.a)(m,"UsageEditor",null,[])},1517:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(2),e=c(5);class a{static get $nb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static agb(k,
m=!1){const w=e.GraphIterator.$a(k);w.zd();return(m?w.Rb(4):w.j7(4))?4:e.GraphIterator.$a(k).Ab(36)?16:e.GraphIterator.$a(k).Ab(14)?2:e.GraphIterator.$a(k).Ab(38)?32:1}}Object(D.a)(a,"ConstructTypeHelper",null,[])},1529:function(D,L,c){c.d(L,"a",function(){return na});D=c(0);var l=c(22),e=c(62),a=c(138);L=c(77);var k=c(7),m=c(17),w=c(8),v=c(123),r=c(68),z=c(717),A=c(196),G=c(38),H=c(5),I=c(213),K=c(94),F=c(32),J=c(89),N=c(21),O=c(396),M=c(1475),T=c(233),R=c(270),W=c(715),V=c(14),ba=c(48),ha=c(40),
ca=c(130),ia=c(43),ra=c(285),da=c(155),za=c(570),la=c(55);class na{static get E9l(){return na.TOj}static get M9l(){return na.XOj}static get K9l(){return na.WOj}static get Yg(){return null!=na.gng?na.gng:na.gng=T.ContextSetEditor.instance}static get rk(){return null!=na.bxg?na.bxg:na.bxg=l.a.instance.resolve("Box4.ITableEditor")}static get tC(){return null!=na.Uwg?na.Uwg:na.Uwg=l.a.instance.Pa("Box4.Styles.ITableCellspacingReader")}static vmn(Ca,Na){const Ta=Ca.currentNode;N.forEachCell(Ca,Na.rowSpan,
Na.colSpan,(Fa,qa,ja)=>{const X=Fa.currentNode;X!==Ta&&(X.pg=!0,na.VEh(Fa),!ja&&1<=Na.colSpan&&(X.colSpan=Na.colSpan),na.I5i(Fa,Na.jia,qa,ja,Na.rowSpan,Na.colSpan))})}static dnn(Ca,Na){N.forEachCell(Ca,Na.rowSpan,Na.colSpan,Ta=>{na.Gmk(Ta);na.VEh(Ta)})}static Gmk(Ca){Ca=Ca.currentNode;Ca.pg=!0;Ca.z3=!0;Ca.knb=!0}static VEh(Ca){Ca&&(Ca.Rb(1),Object(v.a)(z.a,Ca.currentNode)&&Ca.Jg())}static xnk(Ca,Na,Ta){0<Na&&(Ca=Object(r.a)(A.TableCellNode,Ca.currentNode))&&(Ca.width=Ta?Na:e.a.Ml(Na,0))}static Jlk(Ca,
Na,Ta){if(Ca=Object(r.a)(O.TableNode,Ca.currentNode))0<Na&&(Ca.fe=e.a.jy(Na,0)),0<Ta&&(Ca.$u=e.a.jy(Ta,0))}static vnk(Ca,Na){void 0!==Na&&null!==Na&&Ca.currentNode.properties.setValue(k.a.Bpa,na.M9l[Na+""])}static Fmk(Ca,Na){void 0!==Na&&null!==Na&&""!==Na&&(Na=parseInt(M.Box4PasteSteward.tzb(Na),16),Ca.currentNode.properties.setValue(m.a.wF,Na))}static Chk(Ca){if(Ca){if(w.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(la.a)("AdjustingColumnWidthAfterPaste",!0),16==
Ca.type){var Na=new H.GraphIterator;Na.set(Ca);if(Na.Ab(14)){var Ta=J.a(Na),Fa=F.TableCellReader.YN(Ca);if(Na.kd(14)){Ca=Na.currentNode;var qa=G.TableReader.tfa(Na);if(qa){var ja=Array.clone(qa);Na=G.TableReader.hLd(Na);var X=0,ua=0;for(var Ha=0;Ha<qa.length;Ha++)Ha>=Ta&&Ha<Ta+Fa?Na[Ha]>qa[Ha]&&(X+=Na[Ha]-qa[Ha],ja[Ha]=Na[Ha]):ua+=qa[Ha]>Na[Ha]?qa[Ha]-Na[Ha]:0;(null==ua||0>=ua||isNaN(ua))&&w.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==X||0>=X||isNaN(X))&&w.ULS.sendTraceTag(521187335,
3022,50,"spaceToShrink is invalid");if(ua<X)for(Ta=0;Ta<qa.length;Ta++)ja[Ta]=Na[Ta];else for(Ha=0;Ha<qa.length;Ha++)if((Ha<Ta||Ha>=Ta+Fa)&&qa[Ha]>Na[Ha]){let Ea=(qa[Ha]-Na[Ha])/ua;ja[Ha]-=Ea*X;(null==ja[Ha]||0>=ja[Ha]||isNaN(ja[Ha]))&&w.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Ea)}Ta=da.a.W8+(na.tC?na.tC.Oua(Ca):0);for(qa=0;qa<ja.length;qa++)if(null==ja[qa]||0>=ja[qa]||isNaN(ja[qa]))w.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),
ja[qa]=e.a.Ml(Ta,0);Ca.zF=ja}else w.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else w.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static VYl(Ca){var Na=new H.GraphIterator;Na.ed(Ca);if((Ca=I.OutlineNavigator.XZf(Na))&&K.OutlineReader.Kw(Na)){Na=Ca.Nf(k.a.Ao);const Ta=Ca.Nf(k.a.marginLeft);Ca=Ca.Nf(k.a.marginRight);return Na-Ta-Ca}return 0}static Num(Ca){return!(void 0===Ca||null===Ca||1===Ca)}static BVn(Ca,Na,Ta,Fa,qa){if(void 0===Na||null===Na||
""!==Na){switch(Na){case "thin":Na=a.a.v4d(.25);break;case "initial":case "medium":Na=a.a.v4d(.5);break;case "thick":Na=a.a.v4d(1);break;default:Na=na.MUl(Na,Ta,Fa)}qa.currentNode.properties.setValue(Ca,Na)}}static AVn(Ca,Na,Ta){void 0!==Na&&null!==Na&&Na&&Ta.currentNode.properties.setValue(Ca,na.K9l[Na+""])}static yVn(Ca,Na,Ta){void 0!==Na&&null!==Na&&""!==Na&&(Na=parseInt(M.Box4PasteSteward.tzb(Na),16),Ta.currentNode.properties.setValue(Ca,Na))}static MUl(Ca,Na,Ta){let Fa=0;const qa=({unit:Ca}=
M.Box4PasteSteward.N3d(Ca)).returnValue;switch(Ca){case 5:Fa=a.a.v4d(qa);break;case 1:Fa=a.a.UBk(qa);break;case 3:Fa=a.a.mci(qa);break;case 7:Fa=e.a.bhn(qa,Ta)}if(6===Na||7===Na||10===Na)Fa/=3;return Math.round(Fa)}static NUl(Ca,Na){let Ta=0;const Fa=({unit:Ca}=M.Box4PasteSteward.N3d(Ca)).returnValue;switch(Ca){case 5:Ta=a.a.Jwa(Fa);break;case 1:Ta=a.a.p_e(Fa);break;case 3:Ta=a.a.gva(Fa);break;case 7:Ta=e.a.Ml(Fa,Na)}return Ta}static O$d(Ca,Na,Ta,Fa,qa,ja,X){if(qa&&(!X||16===qa.ef||X||14!==qa.ef)&&
12!==Ta){if(X)switch(Fa){case 5:Fa=k.a.iia;var ua=k.a.Wa;var Ha=k.a.Va;var Ea=0;break;case 4:Fa=k.a.hia;ua=k.a.qb;Ha=k.a.pb;Ea=1;break;case 0:Fa=k.a.fia;ua=k.a.Ua;Ha=k.a.Ta;Ea=0;break;case 3:Fa=k.a.gia;ua=k.a.ob;Ha=k.a.nb;Ea=1;break;default:return}else switch(Fa){case 5:Fa=k.a.Snb;ua=k.a.a6a;Ha=k.a.ENb;Ea=0;break;case 4:Fa=k.a.Rnb;ua=k.a.$5a;Ha=k.a.DNb;Ea=1;break;case 0:Fa=k.a.Pnb;ua=k.a.Y5a;Ha=k.a.BNb;Ea=0;break;case 3:Fa=k.a.Qnb;ua=k.a.Z5a;Ha=k.a.CNb;Ea=1;break;default:return}void 0!==qa.currentNode&&
null!==qa.currentNode&&(na.Num(Ta)?(na.yVn(Fa,Ca,qa),na.AVn(ua,Ta,qa),na.BVn(Ha,Na,Ta,Ea,qa)):ja||X||qa.currentNode.properties.setValue(ua,"nil"))}}static I5i(Ca,Na,Ta,Fa,qa,ja){Fa||(na.Dih(Na,Ca,!1,!1),na.MVe(Na,Ca,!0,!1));Fa===ja-1&&na.MVe(Na,Ca,!0,!1);Ta||na.djh(Na,Ca,!0,!1);Ta===qa-1&&na.kih(Na,Ca,!0,!1)}static jih(Ca,Na,Ta,Fa){Ca&&(na.djh(Ca,Na,Ta,Fa),na.MVe(Ca,Na,Ta,Fa),na.kih(Ca,Na,Ta,Fa),na.Dih(Ca,Na,Ta,Fa))}static djh(Ca,Na,Ta,Fa){na.O$d(Ca.borderTopColor,Ca.borderTopWidth,Ca.borderTopStyle,
5,Na,Ta,Fa)}static MVe(Ca,Na,Ta,Fa){na.O$d(Ca.borderRightColor,Ca.borderRightWidth,Ca.borderRightStyle,4,Na,Ta,Fa)}static kih(Ca,Na,Ta,Fa){na.O$d(Ca.borderBottomColor,Ca.borderBottomWidth,Ca.borderBottomStyle,0,Na,Ta,Fa)}static Dih(Ca,Na,Ta,Fa){na.O$d(Ca.borderLeftColor,Ca.borderLeftWidth,Ca.borderLeftStyle,3,Na,Ta,Fa)}static P$d(Ca,Na,Ta){if(Ta&&16===Ta.ef&&""!==Ca){switch(Na){case 3:Na=k.a.QGa;var Fa=0;break;case 2:Na=k.a.DO;Fa=1;break;case 0:Na=k.a.OGa;Fa=0;break;case 1:Na=k.a.AM;Fa=1;break;default:return}(Ca=
na.NUl(Ca,Fa))&&Ta.currentNode.properties.setValue(Na,Ca)}}static glk(Ca,Na){Na&&(na.onk(Na,Ca),na.zmk(Na,Ca),na.nlk(Na,Ca),na.Ulk(Na,Ca))}static onk(Ca,Na){na.P$d(Ca.OBk,3,Na)}static zmk(Ca,Na){na.P$d(Ca.NBk,2,Na)}static nlk(Ca,Na){na.P$d(Ca.LBk,0,Na)}static Ulk(Ca,Na){na.P$d(Ca.MBk,1,Na)}static slk(Ca,Na,Ta,Fa){var qa=0;const ja=Array(Ca.length);var X=0;Fa&&(X=(X=a.a.N6c(na.VYl(Na)))?X:1);for(Fa=0;Fa<Ca.length;Fa++)ja[Fa]=0<X?X/100*Ca[Fa]:e.a.Ml(Ca[Fa],0),qa+=ja[Fa];Ca=Ta.getValue(m.a.oz);Fa=new H.GraphIterator;
Fa.ed(Na);Na=0;if(F.TableCellReader.e_(Fa)){if(Ca=N.returnToContainingCell(Fa))Na=Ca.width;X=J.a(Fa);Fa=N.returnToContainingTable(Fa);if(-1!==X&&X<=Fa.zF.length){let ua=0;for(let Ha=X;Ha<X+Ca.colSpan&&Ha<Fa.zF.length;Ha++)ua+=Fa.zF[Ha];Na=Math.min(Na,ua);Na===ua&&(Na-=e.a.Ml(na.lXm,0))}}else if(Ca)for(X=0;X<Ca.length;X++)Na+=Ca[X];if(0<Na&&qa>Na&&qa)for(qa=Na/qa,Na=0;Na<ja.length;Na++)ja[Na]*=qa;Ta.setValue(m.a.oz,ja)}static Amk(Ca,Na){Ca.currentNode.setValue(k.a.e0,e.a.Ml(Na,1))}static r1n(Ca){var Na,
Ta;w.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(la.a)("SettingTableSelectionBounds",!0);var Fa=Ca.hb,qa=Ca.Lg;Ca=na.Yg.XP(qa,16);if(qa=na.Yg.yS(qa,14))if(qa=qa.node,!qa||14!==qa.type)w.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Ca)w.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(Ta=null===(Na=null===Fa||void 0===Fa?void 0:Fa.kb)||void 0===Na?void 0:Na.Me)||void 0===Ta?0:Ta.Qa)&&Fa.kb.Me.Qa.contextId===
V.a.c0&&R.TableBorderSelectionCache.bOa()&&0<R.TableBorderSelectionCache.bOa().length)){R.TableBorderSelectionCache.$Oc(qa);Na=R.TableBorderSelectionCache.z8;Na.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;Na.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;Na.topMostRowSelected=Number.MAX_SAFE_INTEGER;Na.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(Ta=0;Ta<Ca.length;Ta++){if(Ca.getContext(Ta).contextId!==V.a.tableCell)return;Fa=Ca.getContext(Ta).node;if(!F.TableCellReader.Er(Fa)){var ja=new H.GraphIterator;
ja.set(Fa);if(ja.Ab(14)&&N.getContainingTable(ja)===qa){ja.kd(14);ja=F.TableCellReader.TCa(ja,Fa);if(!ja)return;Array.add(R.TableBorderSelectionCache.bOa(),new W.a(Fa,ja.rowIndex,ja.xo,Fa.rowSpan,Fa.colSpan));Na.leftMostColumnSelected=Math.min(Na.leftMostColumnSelected,ja.xo);Na.rightMostColumnSelected=Math.max(Na.rightMostColumnSelected,ja.xo);Na.topMostRowSelected=Math.min(Na.topMostRowSelected,ja.rowIndex);Na.bottomMostRowSelected=Math.max(Na.bottomMostRowSelected,ja.rowIndex)}}}R.TableBorderSelectionCache.z8=
Na}}else w.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static j1i(Ca){if(Ca&&14===Ca.type){w.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(la.a)("ScalingColumnWidthForCCP",!0);var Na=new H.GraphIterator;Na.set(Ca);if(Na.zd()&&G.TableReader.Jw(Na)){var Ta=Ca.zF,Fa=G.TableReader.hLd(Na),qa=N.returnToContainingCell(Na),ja=N.getContainingTable(Na);if(qa&&ja){var X=J.a(Na),ua=F.TableCellReader.YN(qa);if(Na.kd(14)){var Ha=G.TableReader.tfa(Na);Na=0;for(let Ea=X;Ea<
X+ua;Ea++)Na+=Ha[Ea];X=da.a.LI(qa,ja,k.a.AM,k.a.za,0);qa=da.a.LI(qa,ja,k.a.DO,k.a.Aa,0);Na-=e.a.Ml(X+qa,0);(null==Na||0>=Na||isNaN(Na))&&w.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",X,qa);qa=0;for(ja=0;ja<Ta.length;ja++)qa+=Ta[ja];qa=Na/qa;(null==qa||0>=qa||isNaN(qa))&&w.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");ja=0;for(X=0;X<Ta.length;X++)Ta[X]*=qa,Ta[X]<Fa[X]&&(Ta[X]=Fa[X]),ja+=Ta[X];ja>Na&&(Ta=Array.clone(Fa));Fa=da.a.W8+(na.tC?
na.tC.Oua(Ca):0);for(Na=0;Na<Ta.length;Na++)if(null==Ta[Na]||0>=Ta[Na]||isNaN(Ta[Na]))w.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),Ta[Na]=e.a.Ml(Fa,0);Fa=new ba.GraphTransaction(4);Fa.Eb(Ca);Ca.zF=Ta;Fa.dispose()}}}else w.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else w.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static qIn(Ca){if(!Ca||!G.TableReader.Kyf(Ca)||1!=Ca.Sp())return w.ULS.sendTraceTag(525361986,3022,50,
"Outline iterator should contain a single table"),null;w.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(la.a)("ReplaceTableContentForExternalPaste",!0);let Na=new H.GraphIterator;Na.set(Ca.currentNode);Na.Ab(14);ha.OutlineElementNavigator.Ee(Na);let Ta=new H.GraphIterator;Ta.set(Ca.currentNode);Ta.Ab(14);if(!Ta.kd(14)||!Na||14!=Na.currentNode.type)return null;if(Ca=N.getContainingTableCell(Na))if(Ca=F.TableCellReader.TCa(Ta,Ca)){if(R.TableBorderSelectionCache.PMc())var Fa=
this.jTl();else{Fa=G.TableReader.$f(Na.currentNode)-(G.TableReader.$f(Ta.currentNode)-Ca.rowIndex);var qa=G.TableReader.Wg(Na.currentNode)-(G.TableReader.Wg(Ta.currentNode)-Ca.xo);this.nck(Ta,Fa,qa);Fa=new ra.a(Ca.xo,G.TableReader.Wg(Ta.currentNode)-1,Ca.rowIndex,G.TableReader.$f(Ta.currentNode)-1)}if(!Fa)return null;qa=Fa.bottomMostRowSelected-Fa.topMostRowSelected+1;var ja=Fa.rightMostColumnSelected-Fa.leftMostColumnSelected+1;qa=Math.min(qa,G.TableReader.$f(Na.currentNode));ja=Math.min(ja,G.TableReader.Wg(Na.currentNode));
for(let X=0;X<qa;X++){N.moveToCell(Ta,X+Fa.topMostRowSelected,Fa.leftMostColumnSelected);N.moveToCell(Na,X,0);for(let ua=0;ua<ja;ua++)X==Ca.rowIndex-Fa.topMostRowSelected&&ua==Ca.xo-Fa.leftMostColumnSelected||this.azi(Na,Ta),N.moveToNextColumn(Ta),N.moveToNextColumn(Na);Ta.ut(14);Na.ut(14)}N.moveToCell(Ta,Ca.rowIndex,Ca.xo);Ca.rowIndex-Fa.topMostRowSelected<G.TableReader.$f(Na.currentNode)&&Ca.xo-Fa.leftMostColumnSelected<G.TableReader.Wg(Na.currentNode)?N.moveToCell(Na,Ca.rowIndex-Fa.topMostRowSelected,
Ca.xo-Fa.leftMostColumnSelected):Na=null;this.azi(Na,Ta);Ta.ut(14);N.moveToCell(Ta,Fa.topMostRowSelected,Fa.leftMostColumnSelected);Ta.Vd();return Ta.currentNode}}static xfn(Ca){if(Ca&&G.TableReader.Kyf(Ca)&&1==Ca.Sp()){w.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(la.a)("PasteTableBelowTable",!0);var Na=new H.GraphIterator;Na.set(Ca.currentNode);Ca=ca.a.$a(Ca.currentNode);Na.jo()&&Ca.jo()&&(ha.OutlineElementNavigator.u_(Ca,!1,!0),ia.OutlineElementReader.Oh(Ca)&&1==Ca.Sp()&&
(ha.OutlineElementNavigator.Ee(Na),ha.OutlineElementNavigator.Ee(Ca),Na&&Ca&&Na.currentNode!=Ca.currentNode&&G.TableReader.isTable(Na)&&G.TableReader.isTable(Ca)&&this.YTm(Na,Ca)&&(w.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),Na.Jg(),Na.Jg())))}else w.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static azi(Ca,Na){if(Na&&F.TableCellReader.isTableCell(Na)){var Ta=Na.Sp();if(Ca&&F.TableCellReader.isTableCell(Ca)&&Ca.$z())for(;Ca.$z();)Ca.Vd(),
Na.Qf(Ca.currentNode,Ca.role),Ca.Jg();else Ta--;for(;0<Ta--;)Na.Vd(),Na.Jg()}}static YTm(Ca,Na){if(!G.TableReader.isTable(Ca)||!G.TableReader.isTable(Na))return!1;var Ta=G.TableReader.Wg(Ca.currentNode),Fa=G.TableReader.Wg(Na.currentNode);if(Ta!=Fa)return w.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;Ta=G.TableReader.$f(Ca.currentNode);Fa=G.TableReader.$f(Na.currentNode);let qa=new ba.GraphTransaction(4);qa.Eb(Na.currentNode);Na.currentNode.setValue(m.a.Oxa,
Ta+Fa);for(qa.dispose();Ca.$z();){Ca.Vd();Na.Qf(Ca.currentNode,1);Ta=new H.GraphIterator;Ta.set(Ca.currentNode);Ca.Jg();Ta.Vd();do Ta.currentNode&&16==Ta.currentNode.type&&(Ta.currentNode.gE=Na.currentNode);while(Ta.ht())}return!0}static nck(Ca,Na,Ta){w.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(la.a)("AddRowAndColumnForExternalCCP",!0);na.qza=za.a.m5b;0<Na&&(N.moveToLastRow(Ca),w.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+Na),this.rk.insertRows(Ca,
!1,Na,this.qza),w.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Ca.kd(14));0<Ta&&(w.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+Ta),this.rk.insertColumns(Ca,G.TableReader.Wg(Ca.currentNode),!1,Ta,this.qza),w.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static jTl(){return R.TableBorderSelectionCache?R.TableBorderSelectionCache.z8:null}}na.lXm=8;na.DDh="Table Grid";na.qza=null;na.TOj=L.a.B4("MsoNormalTable","Normal Table","MsoTableGrid",na.DDh,
"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5",
"Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2",
"Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6",
"Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1",
"MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2",
"MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4",
"List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3",
"MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4",
"MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful",
"List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1",
"List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");na.XOj=L.a.B4("0","center","1","top","2","center","3","bottom");na.WOj=L.a.B4("0","nil","1","none","2","nil","3","single","5","dotted","4",
"dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(D.a)(na,"Box4TableStewardHelper",null,[])},1533:function(D,L,c){c.d(L,"a",function(){return R});D=c(0);var l=c(82),e=c(133),a=c(22),k=c(171),m=c(2),w=c(201),v=c(7),r=c(97),z=c(67),A=c(11),G=c(48),H=c(598),I=c(233),K=c(248),F=c(10),J=c(261),N=c(20),O=c(14),M=c(299),T=c(3);class R{static get Yg(){return I.ContextSetEditor.instance}static get ag(){return K.a.instance}static get Mc(){return e.a.instance}static Gw(){return R.Om||
(R.Om=a.a.instance.Za("Box4.IExternalSelectionManager"))}static get jC(){return null!=R.bvg?R.bvg:R.bvg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static oXl(){this.mN||(this.mN=new l.a,this.mN.add(T.a.Av),this.mN.add(T.a.font),this.mN.add(T.a.bY),this.mN.add(T.a.dta),this.mN.add(T.a.bold),this.mN.add(T.a.setItalic),this.mN.add(T.a.superscript),this.mN.add(T.a.subscript),this.mN.add(T.a.AYa),this.mN.add(T.a.ata),this.mN.add(T.a.xBa),this.mN.add(T.a.s_e),this.mN.add(T.a.yBa),this.mN.add(T.a.zYa),
this.mN.add(T.a.gO),this.mN.add(T.a.xO),this.mN.add(T.a.clearFormatting),this.mN.add(T.a.mdb),this.mN.add(T.a.sDc));return this.mN}static g8b(W){return R.oXl().contains(W)?!0:!1}static Nv(W,V,ba,ha,ca){var ia=!0;if(!V.view.ue)return 2;var ra=V.view,da=ra.Bb;da&&da.hb.kb||(R.Mc.fc(r.a.vf,{["Reason"]:z.a.noSelection}),ia=!1);R.Yg.RBa(N.ImageReader.UQc,ra.Bb.Lg)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.A2e}),ia=!1);if(R.Yg.RBa(N.ImageReader.q1a,ra.Bb.Lg))return R.Mc.fc(r.a.vf,{["Reason"]:z.a.oEc}),8;var za=
!R.g8b(W);R.ag.m8b(ra.Bb.Lg,za)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.hE}),ia=!1);R.Yg.RBa(N.ImageReader.ZSd,ra.Bb.Lg)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.v2e}),ia=!1);R.Yg.RBa(M.c,ra.Bb.Lg)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.w2e}),ia=!1);R.Yg.RBa(J.a.yvf,ra.Bb.Lg)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.u2e}),ia=!1);R.Yg.lya(F.ParagraphReader.MT,ra.Bb.Lg)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.BN}),ia=!1);R.Gw()&&R.Gw().instance&&R.Gw().instance.PT(ra.Bb.Lg)&&(R.Mc.fc(r.a.vf,{["Reason"]:z.a.externalSelection}),ia=!1);
var la=null;da&&da.hb.kb&&(la=da.hb.kb);if(1===ba||!ia||!la)return ia?32:8;ia=W===T.a.N$b||W===T.a.h0b||W===T.a.hfc||W===T.a.h4b;ra=W===T.a.VJb||W===T.a.qAb||W===T.a.pec;za=W===T.a.YRa||W===T.a.ZRa||W===T.a.sC;const na=new G.GraphTransaction(15);na.Eb(la.Qa.node);la=new l.a;let Ca=!1;if(ia||ra||za)k.a.mark(7121),V=R.Yg.XQh(V.Yj);else{k.a.mark(7119);V=H.OutlineElementGeneralizer.ima(da.hb,!0);if(!V)return R.Mc.fc(r.a.ama,{["Reason"]:z.a.jGd}),na.dispose(),8;da=W===T.a.Z0a||W===T.a.Hhb;V.Hw&&da&&(Ca=
R.v6l(la,V))}(W===T.a.leftJustify||W===T.a.N$b||W===T.a.centerJustify||W===T.a.h0b||W===T.a.rightJustify||W===T.a.hfc||W===T.a.fullJustify||W===T.a.h4b)&&V.Hw&&1<V.length&&R.w6l(V)&&(ca||(ca={}),Object.getType(ca)===Object&&(ca.InContextSet=!0));m.AFrameworkApplication.ya.Tf(V,W,ba,!0,ha,ca);Ca&&R.CYm(la,V,ca);na.dispose();A.App.xa.updateCommandUI();ia||ra||za?k.a.mark(7122):k.a.mark(7120);return 32}static v6l(W,V){if(!V.Hw)return!1;let ba=!1,ha=!1;for(let ia=0;ia<V.length;ia++)if(V.getContext(ia).gl){var ca=
V.getContext(ia).node;ca&&(ca=R.jC.sgb(ca),2===ca.specialIndentType?(ba=!0,W.add(ia)):1!==ca.specialIndentType&&ca.specialIndentType||(ha=!0))}return ha&&ba}static CYm(W,V,ba){if(V.Hw)for(let ca=0;ca<W.count;ca++){var ha=V.getContext(W.J(ca));if(!ha.gl)continue;ha=ha.node;const ia=R.jC.sgb(ha);2!==ia.specialIndentType||w.a.b_(ba.value,ia.UA)||ha.setValue(v.a.fe,ia.UA-ia.wca)}}static A4f(W,V){let ba=!0;V.contextId!==O.a.paragraph?ba=!1:R.ag.$1a(V)?(R.Mc.fc(r.a.Zm,{["Reason"]:z.a.hE}),ba=!1):R.Gw()&&
R.Gw().instance&&R.Gw().instance.PT(V)?(R.Mc.fc(r.a.Zm,{["Reason"]:z.a.externalSelection}),ba=!1):V.gl&&(V=V.node,F.ParagraphReader.ic(V)&&V.GP&&(R.Mc.fc(r.a.Zm,{["Reason"]:z.a.BN}),ba=!1));return{returnValue:1!==W&&ba,Lx:ba?32:8}}static w6l(W){if(!W.Hw)return!1;let V=1;for(let ha=0;ha<W.length;ha++){var ba=W.getContext(ha);if(ba&&ba.gl&&ba.contextId===O.a.paragraph&&(ba=ba.node))if(ba=F.ParagraphReader.Vv(ba),!ha)V=ba;else if(ba!==V)return!0}return!1}}R.Om=null;R.mN=null;Object(D.a)(R,"FormattingActionHelper",
null,[])},1535:function(D,L,c){c.d(L,"a",function(){return e});c.d(L,"b",function(){return a});var l=c(2);const e=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===
(k=l.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1545:function(D,L,c){c.r(L);D=c(0);var l=c(8),e=c(1408),a=c(1557),k;(function(Fa){Fa[Fa.external=0]="external";Fa[Fa.msa=1]="msa";Fa[Fa.aad=2]="aad"})(k||(k={}));Object(D.b)("AuthorityType",k);class m{}Object(D.a)(m,"OAuthResult",null,[]);class w{constructor(Fa){this.XUj=Fa}initialize(){return Promise.resolve(0)}xXd(){return Promise.resolve(0)}uia(){l.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new m,{IsSuccess:!0,Token:this.XUj}))}Ege(){return Promise.resolve(Object.assign(new m,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}nee(){return!1}nMc(){return"MockAuthTokenStrategy"}}Object(D.a)(w,"MockAuthTokenStrategy",null,[212]);var v=c(1601);class r{static get(Fa,qa,ja){if(!ja)return Fa;
let X=0;return Promise.race([Fa,new Promise(ua=>{X=window.setTimeout(()=>{ua(qa)},ja)})]).then(ua=>{window.clearTimeout(X);return Promise.resolve(ua)}).catch(()=>{window.clearTimeout(X);return Promise.resolve(qa)})}}Object(D.a)(r,"PromiseWithTimeout",null,[]);var z=c(2),A=c(595);class G{constructor(Fa,qa,ja,X,ua){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=Fa;this.scope=qa;this.silentLogin=ja;this.options=X;this.correlationId=ua}}Object(D.a)(G,
"TokenRequestParameters",null,[226]);var H=c(15),I=c(22);class K{constructor(){this.mah=null;let Fa=z.AFrameworkApplication.K.lb(z.AFrameworkApplication.wia),qa=z.AFrameworkApplication.K.lb(z.AFrameworkApplication.Qge);this.wXb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Fa&&""!==Fa?Fa:"Unspecified",qa&&""!==qa?qa:"Unspecified")}initialize(){return new Promise(Fa=>{I.a.instance.Za("Common.App.WopiIdentity.IWopiIdentity").execute(qa=>{this.mah=qa;Fa(0)})})}le(Fa){const qa=
["HTTPS:","API:"];let ja=!1;const X=Fa.toLocaleUpperCase();for(const ua of qa)if(X.startsWith(ua)){ja=!0;break}return ja||this.Cpm(Fa)?Fa+"/.default":Fa}Cpm(Fa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Fa)}xXd(){return Promise.resolve(0)}uia(Fa,qa,ja,X,ua,Ha,Ea){if(H.a.qPa){ua=A.OAuthManagerSettings.IFo;if(!ua)return qa=Object.assign(new m,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(qa);
if(!Array.contains(ua,Fa))return qa=Object.assign(new m,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Fa}),Promise.resolve(qa)}Fa=this.le(ja);ja=new G(ja,Fa,!X,null,z.AFrameworkApplication.userSessionId);return this.mah.getAccessToken(ja,qa,Ea).then(wa=>Object.assign(new m,{IsSuccess:!0,Token:wa.accessToken}),wa=>Object.assign(new m,{IsSuccess:!1,ErrorCode:wa}))}Ege(){return Promise.resolve(Object.assign(new m,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}nee(){return!1}nMc(){return this.wXb}}Object(D.a)(K,"ParentFrameTokenStrategy",null,[212]);var F=c(52),J=c(752),N=c(82);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.ZOi=this.Vkh=null}}Object(D.a)(O,"PromiseWrapper",null,[]);class M{constructor(Fa=0){this.Bx=0;this.Ovc=!1;this.Hx=new N.a;this._timeout=Fa}enqueue(Fa){return new Promise((qa,ja)=>{this.Hx.add(Object.assign(new O,
{ZOi:Fa,resolve:qa,reject:ja}));this.process()})}process(){if(this.Ovc||this.Bx===this.Hx.count)return!1;const Fa=this.Hx.J(this.Bx++);try{this.Ovc=!0,Fa.ZOi().then(qa=>{this.Ovc=!1;this.Q1e(Fa,qa,null,!0)}).catch(qa=>{this.Ovc=!1;this.Q1e(Fa,null,qa,!1)})}catch(qa){this.Ovc=!1,this.Q1e(Fa,null,qa,!1)}return!0}Q1e(Fa,qa,ja,X){if(X){const ua=()=>{Fa.resolve(qa);this.process()};0<this._timeout?window.setTimeout(()=>{ua()},this._timeout):ua()}else{const ua=()=>{Fa.reject(ja);this.process()};0<this._timeout?
window.setTimeout(()=>{ua()},this._timeout):ua()}}}Object(D.a)(M,"PromiseQueue",null,[]);class T{constructor(){this.correlationId=this.resolve=null}}Object(D.a)(T,"ResolveWithCorrelation",null,[]);var R=c(68),W=c(156),V=c(936),ba=c(88);class ha extends W.a{constructor(Fa,qa,ja,X,ua,Ha){super(!1,!1,!0);this.rHg=this.Wya=null;this.Wra=Fa;this.uZj=ja;this.gu=X;this.R5j=ua;this.Nsb=Ha;this.PG=document.createElement("iframe");this.PG.id="SharedAuthInteractiveFrame";this.PG.setAttribute("name","SharedAuthInteractiveFrame");
this.PG.setAttribute("title","SharedAuthInteractiveFrame");this.PG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.PG.style.border="0";this.PG.style.height="48px";this.PG.style.width="190px";$addHandler(this.PG,"error",Object(F.a)(this,this.o9m,"onSharedAuthFrameError"));Fa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Wra,qa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",z.AFrameworkApplication.userType);
this.PG.src=Fa;this.CJj=new Promise(Ea=>{this.rHg=Ea});this.sHg=!1}gSa(){this.Wya={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.uZj,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(F.a)(this,this.nTk,"createFrame"),["resolveDialogStyles"]:this.rHg}};this.Ed=5;this.Wh(CommonUIStrings.l_SignIn,Object(F.a)(this,this.y4n,"sharedAuthConsentDialogHandler"),this.Wya)}Vpj(Fa=!1,qa=5){this.Wya&&this.Wya.bodyControls&&
(!0!==Object(R.a)(Object,this.Wya.bodyControls).frameLoaded&&(Object(R.a)(Object,this.Wya.bodyControls).frameLoaded=!0),Fa!==Object(R.a)(Object,this.Wya.bodyControls).frameLoadSuccess&&(Object(R.a)(Object,this.Wya.bodyControls).frameLoadSuccess=Fa),qa!==this.Wya.dialogButtonsOption&&(this.Wya.dialogButtonsOption=null,this.Ed=qa),this.update(this.Wya))}Aao(Fa,qa){const ja=new V.a(ba.a.C4n);ja.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,
["messageCorrelationId"]:Fa,["dialogStyles"]:qa};this.gu.$4a(ja,this.PG.contentWindow,this.Wra)}gQh(){this.Vpj(!1,6)}get h9i(){return this.PG}get r4k(){return this.CJj.then(Fa=>{this.sHg=!0;return Fa})}get s4k(){return this.sHg}o9m(){this.gQh()}nTk(){return this.PG}y4n(Fa){0===Fa&&(this.R5j.reject(Object.assign(new m,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.Nsb(null))}}Object(D.a)(ha,"SharedAuthConsentDialog",W.a,[227]);var ca=c(943),ia=c(80),
ra=c(114),da=c(35),za=c(119),la=c(134);class na{constructor(){this.PG=null;this.Ofd=0;this.QUb=this.cYb=this.bne=this.Nsb=this.l$=this.p9g=null;this.gu=new ca.a(null,null);this.wXb="SharedAuthTokenStrategy Unloaded";this.Wra=A.OAuthManagerSettings.A4n;this.u5g=A.OAuthManagerSettings.z4n;this.RIg=A.OAuthManagerSettings.enableConsoleLogging;this.MKj=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.Y2j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",
!1);this.Eab={};this.eQj=new M(1500)}nMc(){return this.wXb}initialize(){var {OAuthManager:Fa}=c(1545);if("loadFrame"in this.Eab)return this.Eab.loadFrame.Vkh;if(!this.Wra)return ia.Health.instance.recordKpiFailure(Fa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Fa=this.Qde("loadFrame");this.Ofd=da.a.Ye();var qa=this.Wra+this.u5g+"?replyUrl="+window.location.protocol+"//"+
window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.PG=document.createElement("iframe");this.nsf(this.PG);this.PG.style.cssText="height:0;width:0;display:none;";this.PG.id="SharedAuthFrame";this.PG.setAttribute("name","SharedAuthFrame");this.PG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.PG.setAttribute("title","SharedAuthFrame");this.PG.src=qa;document.body.appendChild(this.PG);qa=da.a.Ye()-
this.Ofd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",qa,this.PG.src);return Fa}xXd(Fa){this.bne=Fa;const qa=new V.a(ba.a.k9i);qa.Values=this.Bkh(Fa);Fa=this.Qde("initFrame");this.gu.$4a(qa,this.PG.contentWindow,this.Wra);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Fa}uia(Fa,qa,ja,X,ua,Ha){const Ea=new V.a(ba.a.D4n),wa=this.i3h();Ea.Values=this.mlj(Fa,
qa,ja,X,ua,Ha,wa);Fa=this.Qde(wa);X&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.eQj.enqueue(()=>new Promise(sa=>{this.Yqo(Ha,Ea,sa,wa)})):(this.gu.$4a(Ea,this.PG.contentWindow,this.Wra),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",qa));return Fa}Yqo(Fa,qa,ja,X){const ua=this.Eab[X];ua&&(this.cYb=qa,this.Nsb=Object.assign(new T,{resolve:ja,correlationId:X}),this.l$=
new ha(this.Wra,this.u5g,Fa,this.gu,ua,ja),this.l$.gSa())}i3h(){return za.a.create().toString()}mlj(Fa,qa,ja,X,ua,Ha,Ea){const wa={};wa.appName=Fa;wa.appId=qa;wa.target=ja;wa.withPopup=X;wa.claims=ua;wa.promptMessage=Ha;wa.messageCorrelationId=Ea;return wa}nsf(Fa){$addHandler(Fa,"load",Object(F.a)(this,this.Q4m,"onIFrameLoaded"));$addHandler(Fa,"error",Object(F.a)(this,this.Gkb,"onIFrameError"));this.gu.GXa(this.Wra);this.gu.Jv(ba.a.n9i);this.gu.oC(ba.a.n9i,Object(F.a)(this,this.P8m,"onScriptLoaded"));
this.gu.Jv(ba.a.m9i);this.gu.oC(ba.a.m9i,Object(F.a)(this,this.O8m,"onScriptInitialized"));this.gu.Jv(ba.a.i9i);this.gu.oC(ba.a.i9i,Object(F.a)(this,this.s4m,"onGetTokenResponse"));this.gu.Jv(ba.a.o9i);this.gu.oC(ba.a.o9i,Object(F.a)(this,this.P5m,"onLoginResponse"));this.gu.Jv(ba.a.l9i);this.gu.oC(ba.a.l9i,Object(F.a)(this,this.m5m,"onInteractiveFlowReady"));this.gu.Jv(ba.a.j9i);this.gu.oC(ba.a.j9i,Object(F.a)(this,this.B4m,"onHideDialog"));this.gu.Jv(ba.a.g9i);this.gu.oC(ba.a.g9i,Object(F.a)(this,
this.KKf,"onCloseDialog"))}Qde(Fa){const qa=new O;qa.startTime=da.a.Ye();const ja=new Promise((X,ua)=>{qa.resolve=X;qa.reject=ua});qa.Vkh=ja;this.Eab[Fa]=qa;return ja}Q4m(){const Fa=da.a.Ye()-this.Ofd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Fa)}Gkb(Fa){const {OAuthManager:qa}=c(1545),ja=da.a.Ye()-this.Ofd,X=Object.assign(new la.a,{durationMs:ja});ia.Health.instance.recordKpiFailure(qa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,X);l.ULS.sendTraceTag(572346567,
3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ja,this.RIg?JSON.stringify(Fa):"")}P8m(Fa){const {OAuthManager:qa}=c(1545),ja=this.Eab.loadFrame;var X=da.a.Ye()-ja.startTime,ua=Fa.Values.AuthLibrary.toString();Fa=Fa.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Fa,ua,X);ua&&(this.wXb="SharedAuthTokenStrategy "+ua);ua=Boolean.parse(Fa);ua||(Fa=ra.a.AF(),void 0!==Fa&&null!==Fa&&(Fa.set("AuthLibrary",
this.nMc()),X=Object.assign(new la.a,{durationMs:X,extendedProperties:Fa}),ia.Health.instance.recordKpiFailure(qa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,X)));ja.resolve(ua?0:1)}O8m(Fa){if(Fa.Values.interactive&&this.cYb&&this.cYb.Values.messageCorrelationId){const ja=this.cYb.Values.messageCorrelationId.toString();if(Fa.Values.interactive&&this.l$){this.l$.r4k.then(X=>{this.gu.$4a(this.cYb,this.l$.h9i.contentWindow,this.Wra);this.l$.Aao(ja,X);this.l$.Vpj(!0);this.cYb=null});return}}Fa=this.Eab.initFrame;
const qa=da.a.Ye()-Fa.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",qa);Fa.resolve(0)}s4m(Fa){if(Fa.Values.messageCorrelationId&&Fa.Values.messageCorrelationId.toString()){var qa=Fa.Values.messageCorrelationId.toString(),ja=this.Eab[qa];if(ja){var X=da.a.Ye()-ja.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",X);Fa.Values.isSuccess&&Fa.Values.isSuccess?ja.resolve(Fa.Values.response):ja.reject(Fa.Values.response);
this.Llj(qa)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}m5m(){if(this.l$.s4k)this.l$.gQh();else if(this.bne&&this.l$){const Fa=new V.a(ba.a.k9i);Fa.Values=this.Bkh(this.bne,!0);this.gu.$4a(Fa,this.l$.h9i.contentWindow,this.Wra)}}B4m(){this.l$&&this.l$.yPd()}KKf(Fa){Fa.Values.cancelled&&
Fa.Values.cancelled&&Fa.Values.messageCorrelationId&&this.Llj(Fa.Values.messageCorrelationId.toString());this.l$&&this.l$.hide()}Bkh(Fa,qa=!1){const ja={};ja.appIds=this.atl();ja.upn=Fa.loginHint;ja.authority=Fa.authority;ja.authorityType=Object(e.a)(k,Fa.authorityType);ja.tenantId=Fa.tenantId;ja.correlationId=z.AFrameworkApplication.userSessionId;ja.enableConsoleLogging=this.RIg;ja.enablePopupFlash=this.MKj;ja.skipUpnCheck=this.Y2j;ja.interactive=qa;return ja}atl(){const Fa=[],qa=A.OAuthManagerSettings.bVe;
for(let ja in qa)Array.add(Fa,qa[ja]);return Fa}Ege(Fa,qa,ja,X,ua,Ha){const Ea=new V.a(ba.a.B4n),wa=this.i3h();Ea.Values=this.mlj(Fa,qa,ja,X,ua,Ha,wa);this.p9g=Ea;Fa=this.Qde(wa);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",qa);this.m9n();return Fa}nee(){return!0}m9n(){this.QUb||(this.QUb=new J.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.QUb.id=16,this.QUb.YTd=!1,this.QUb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,
()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.gu.$4a(this.p9g,this.PG.contentWindow,this.Wra)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ta.Pb.Bsa(this.QUb,!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}P5m(Fa){if(Fa.Values.messageCorrelationId&&Fa.Values.messageCorrelationId.toString()){var qa=this.Eab[Fa.Values.messageCorrelationId.toString()];
if(qa){var ja=da.a.Ye()-qa.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ja);Fa.Values.isSuccess&&Fa.Values.isSuccess?qa.resolve(Fa.Values.response):qa.reject(Fa.Values.response)}else l.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}Llj(Fa){this.Nsb&&
this.Nsb.correlationId===Fa&&(this.Nsb.resolve(null),this.Nsb=null)}}Object(D.a)(na,"SharedAuthTokenStrategy",null,[212]);class Ca{constructor(Fa){this.S5=Fa;this.wXb="UnsupportedAuthTokenStrategy Reason="+a.a[this.S5]}initialize(){return Promise.resolve(0)}xXd(){return Promise.resolve(0)}uia(){return Promise.resolve(Object.assign(new m,{IsSuccess:!1,ErrorCode:a.a[this.S5],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.S5]+"]"}))}Ege(){return Promise.resolve(Object.assign(new m,{IsSuccess:!1,
ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}nee(){return!1}nMc(){return this.wXb}}Object(D.a)(Ca,"UnsupportedAuthTokenStrategy",null,[212]);var Na=c(1466);c.d(L,"OAuthManager",function(){return Ta});class Ta{constructor(Fa=null){this.Sia=0;this.Tca=null;this.xvb=0;const qa=da.a.Ye();this.LPj=this.z3k(Fa).then(ja=>ja?this.Abm():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.qK(),Math.floor(da.a.Ye()-qa)),ja=ra.a.AF(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.qK()),ja=Object.assign(new la.a,{durationMs:Math.floor(da.a.Ye()-qa),extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,"StrategyPickFailed",!1,!0,ja)),Promise.resolve(1))).then(ja=>0!==ja?Promise.resolve(ja):this.rEm())}A3k(){var Fa=A.OAuthManagerSettings.gVm;Fa&&0<Fa.length?(this.Sia=1,this.Tca=new w(Fa)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?
z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.Sia=2,this.Tca=new Ca(this.Sia)):(Fa=v.a.getAuthContext().loginHint)&&Fa.length?A.OAuthManagerSettings.aOc?(this.Sia=1,this.Tca=new K):(this.Sia=1,this.Tca=new na):(this.Sia=3,this.Tca=new Ca(this.Sia)):(this.Sia=4,this.Tca=new Ca(this.Sia))}qK(){return this.Tca?this.Tca.nMc()||"Unknown":"None"}z3k(Fa=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const qa=da.a.Ye();return z.AFrameworkApplication.K.ZDl().then(ja=>{ja?(this.A3k(),
Fa&&(this.Tca=Fa),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",A.OAuthManagerSettings.clientVersion,A.OAuthManagerSettings.appVersion,A.OAuthManagerSettings.V7k,this.qK(),Math.floor(da.a.Ye()-qa))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(da.a.Ye()-qa));return Promise.resolve(ja)},
()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(da.a.Ye()-qa));return Promise.resolve(!1)})}Abm(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.qK());const Fa=da.a.Ye();return r.get(this.Tca.initialize(),2,A.OAuthManagerSettings.$Sf).then(qa=>{if(0===qa)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.qK(),Math.floor(da.a.Ye()-
Fa));else if(1===qa){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.qK(),Math.floor(da.a.Ye()-Fa));var ja=ra.a.AF();void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.qK()),ja=Object.assign(new la.a,{durationMs:Math.floor(da.a.Ye()-Fa),extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,"StrategyInitFailed",!1,!0,ja))}else 2===qa&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.qK(),Math.floor(da.a.Ye()-Fa)),ja=ra.a.AF(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.qK()),ja=Object.assign(new la.a,{durationMs:Math.floor(da.a.Ye()-Fa),extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,"StrategyInitTimedOut",!1,!0,ja)));return Promise.resolve(qa)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.qK(),Math.floor(da.a.Ye()-Fa));return Promise.resolve(1)})}rEm(){l.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.qK());const Fa=da.a.Ye();return r.get(this.Tca.xXd(v.a.getAuthContext()),2,A.OAuthManagerSettings.$Sf).then(qa=>{if(0===qa)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.qK(),Math.floor(da.a.Ye()-Fa));else if(1===qa){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.qK(),Math.floor(da.a.Ye()-Fa));var ja=ra.a.AF();void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.qK()),ja=
Object.assign(new la.a,{durationMs:Math.floor(da.a.Ye()-Fa),extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,"StrategyLoadFailed",!1,!0,ja))}else 2===qa&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.qK(),Math.floor(da.a.Ye()-Fa)),ja=ra.a.AF(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.qK()),ja=Object.assign(new la.a,{durationMs:Math.floor(da.a.Ye()-Fa),extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,
"StrategyLoadTimedOut",!1,!0,ja)));return Promise.resolve(qa)},()=>{l.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.qK(),Math.floor(da.a.Ye()-Fa));return Promise.resolve(1)})}uia(Fa,qa,ja=null){return this.tjc(Fa,qa,!1,null,"",ja)}nlj(Fa,qa,ja,X,ua=null){return this.tjc(Fa,qa,!0,ja,X,ua)}tjc(Fa,qa,ja,X,ua,Ha,Ea=0){Ea+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
Fa,this.ALb(Fa,qa),this.qK(),Ea);var wa=ra.a.AF();void 0!==wa&&null!==wa&&(wa.set("AuthLibrary",this.qK()),wa.set("AppName",Fa),wa.set("Target",this.ALb(Fa,qa)),ia.Health.instance.recordKpiUsage(Ta.kpiName,0,"WacOAuthFC",wa));if(!A.OAuthManagerSettings.isEnabled){var sa;return this.pCf((sa=new m,sa.IsSuccess=!1,sa.Token=null,sa.ErrorCode="NotEnabled",sa.ErrorMessage="OAuthManager is disabled.",sa),Fa)}const fa=A.OAuthManagerSettings.bVe[Fa];if(void 0===fa||null===fa){l.ULS.sendTraceTag(41961345,3E3,
15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Fa);var Ma;return this.pCf((Ma=new m,Ma.IsSuccess=!1,Ma.Token=null,Ma.ErrorCode="DisallowedApp",Ma.ErrorMessage="Disallowed appName: "+Fa,Ma),Fa)}const Ua=da.a.Ye(),Qa=this;wa=this.LPj.then(sb=>Qa.fjm(Fa,fa,qa,ja,X,ua,Ha,sb));sa=ja?0:A.OAuthManagerSettings.$Sf;let Ja;Ma=(Ja=new m,Ja.IsSuccess=!1,Ja.Token=null,Ja.ErrorCode="authTokenStrategy_timeout",Ja.ErrorMessage="Auth Strategy timed out after ["+
sa+"] ms when fetching token",Ja);let Wa=this,Ya=this;return r.get(wa,Ma,sa).then(sb=>Ea<=Ta.zSm&&(sb.ErrorCode===Ta.nij||sb.ErrorCode===Ta.Cgo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ea,Math.floor(da.a.Ye()-Ua)),Wa.tjc(Fa,qa,ja,X,ua,Ha,Ea)):sb.ErrorCode===Ta.Tpi&&!ja&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ea,Ta.fJh),Ta.qal&&Wa.Tca.nee()&&Wa.Tca.Ege(Fa,fa,
qa,ja,X,ua).then(ob=>Promise.resolve(Wa.eYd(ob,Fa,qa,fa,Ua))).catch(()=>{let ob;const fc=(ob=new m,ob.IsSuccess=!1,ob.Token=null,ob.ErrorCode="authTokenStrategy_failure",ob.ErrorMessage="LoginPopup failed, GetToken could not be called",ob);return Promise.resolve(Wa.eYd(fc,Fa,qa,fa,Ua))}),Ta.fJh)?Wa.tjc(Fa,qa,!0,X,ua,Ha,Ea):Promise.resolve(Wa.eYd(sb,Fa,qa,fa,Ua))).catch(()=>{let sb;const ob=(sb=new m,sb.IsSuccess=!1,sb.Token=null,sb.ErrorCode="authTokenStrategy_failure",sb.ErrorMessage="Auth Strategy failed with an unknown error",
sb);return Promise.resolve(Ya.eYd(ob,Fa,qa,fa,Ua))})}fjm(Fa,qa,ja,X,ua,Ha,Ea,wa){return 1===wa||2===wa?this.pCf(Object.assign(new m,{IsSuccess:!1,Token:null,ErrorCode:1===wa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Fa):this.Tca.uia(Fa,qa,ja,X,ua,Ha,Ea).then(sa=>Promise.resolve(this.WAi(sa,!0,Fa))).catch(sa=>Promise.resolve(this.WAi(sa,!1,Fa)))}eYd(Fa,qa,ja,X,ua){const Ha={};ua=da.a.Ye()-ua;Ha.IsSuccess=Fa.IsSuccess;Ha.ErrorCode=Fa.IsSuccess?"Success":Fa.ErrorCode||
"";Ha.ErrorMessage=Fa.IsSuccess?"Success":this.ALb(qa,Fa.ErrorMessage||"");Ha.Target=this.ALb(qa,ja||"");Ha.TimeInMS=Math.floor(ua);Ha.AuthLibrary=this.qK();Ha.AppName=qa;Ha.AuthorityType=Object(e.a)(k,v.a.EId());Ha.UserType=this.kZl(v.a.getAuthContext());Ha.IsAuthSupportedInSession=a.a[this.Sia];Ha.RequestCount=++this.xvb;Ha.AppId=X;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ha));Fa.IsSuccess||(ja=ra.a.AF(),void 0!==ja&&null!==ja&&(ja.set("AppName",qa),ja.set("AuthLibrary",this.qK()),ja.set("ErrorCode",
Fa.ErrorCode),ja.set("ErrorMessage",this.ALb(qa,Fa.ErrorMessage)),qa=Object.assign(new la.a,{durationMs:ua,extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,"TryGetTokenFailure",!1,!0,qa)));return Fa}pCf(Fa,qa){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",qa,this.ALb(qa,Fa.ErrorMessage));const ja=ra.a.AF();void 0!==ja&&null!==ja&&(ja.set("AppName",qa),ja.set("AuthLibrary",this.qK()),ja.set("ErrorCode",Fa.ErrorCode),
ja.set("ErrorMessage",this.ALb(qa,Fa.ErrorMessage)),qa=Object.assign(new la.a,{extendedProperties:ja}),ia.Health.instance.recordKpiFailure(Ta.kpiName,"FailureBeforeGetToken",!1,!0,qa));return Promise.resolve(Fa)}xji(Fa){return Fa===Na.a.yfe}ALb(Fa,qa){return this.xji(Fa)&&qa?"REDACTED":qa}kZl(Fa){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!Fa.loginHint||1>Fa.loginHint.length?"empty":-1<Fa.loginHint.indexOf("guest#")?"guest":-1<Fa.loginHint.indexOf("ext#")?"external":0>Fa.upn.indexOf("@")?
"no-at":"supported"}qkm(){return 1===this.Sia}WAi(Fa,qa,ja){let X=null,ua=null,Ha=null,Ea=null;Fa?Fa.ErrorCode||Fa.ErrorMessage?(ua=Fa.ErrorCode?Fa.ErrorCode:Ta.fLh,Ha=Fa.ErrorMessage?Fa.ErrorMessage:"No message"):Fa.Token?qa?X=Fa.Token:(ua=Ta.UBn,Ha="A rejected promise returned a token."):(ua=Ta.fLh,Ha=JSON.stringify(Fa)):(ua=Ta.cYm,Ha="No result came from Auth Token Strategy");Fa&&Fa.Telemetry&&!this.xji(ja)&&(Ea=Fa.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ea)));if(ua===Ta.CVm||
ua===Ta.yno)ua=Ta.nij,Ha="Auth Library Timed Out";ua===Ta.ppk&&-1<Ha.indexOf(Ta.Y7j)&&(ua=Ta.Tpi);if(ua||Ha)X=null;return Object.assign(new m,{IsSuccess:!!X,Token:X,ErrorCode:ua,ErrorMessage:Ha,Telemetry:Ea})}static get fJh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get qal(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ta.yno="token_renewal_error";
Ta.fLh="Exception";Ta.cYm="NoResult";Ta.UBn="RejectToken";Ta.CVm="monitor_window_timeout";Ta.nij="Timeout";Ta.Cgo="authTokenStrategy_timeout";Ta.ppk="login_required";Ta.Y7j="AADSTS50058";Ta.Tpi="Cookies Disabled";Ta.kpiName="OAuthManager";Ta.zSm=2;Object(D.a)(Ta,"OAuthManager",null,[164])},1546:function(D,L,c){c.r(L);D=c(0);var l=c(2),e=c(106),a=c(22),k=c(62),m=c(375),w=c(48),v=c(5);class r{A7e(lb,Tb,pc){return 1===pc?32:r.L1k(Tb.node)}static L1k(lb){const Tb=new v.GraphIterator;Tb.set(lb);Tb.jo();
lb=new w.GraphTransaction(7);lb.ev(Tb);Tb.Jg();lb.dispose();return 32}}Object(D.a)(r,"DeleteOutlineLevelContentStrategy",null,[]);var z=c(108),A=c(184),G=c(65),H=c(233),I=c(19),K=c(24),F=c(10),J=c(109),N=c(40),O=c(213),M=c(94),T=c(36);class R{constructor(lb){this.Yl=null;this.wka=lb}get dyb(){return null!=this.Ulg?this.Ulg:this.Ulg=a.a.instance.Pa("Box4.IAutoCorrectRules")}get qW(){return null!=this.Wlg?this.Wlg:this.Wlg=a.a.instance.Pa("Box4.IAutoCorrectScheduler")}get kM(){return null!=this.Fug?
this.Fug:this.Fug=a.a.instance.Pa("Box4.Pages.IPageContentEditor")}get JK(){return null!=this.cug?this.cug:this.cug=a.a.instance.Pa("Box4.IOutlineEditor")}get Kh(){return this.Yl||(this.Yl=this.wka())}Cri(lb,Tb,pc){if(this.JK&&R.Jn){var Db=H.ContextSetEditor.Pjf(Tb);lb=Db.node;I.SelectionEditor.Dk(Db)&&(Db=T.a.Uc(lb,F.ParagraphReader.textLength(lb)));var Ob=J.FormattingReader.language(J.FormattingReader.zr(Db));Db=v.GraphIterator.$a(pc.jd);R.mh.i1c(Db);var jb=lb=null;if(Db)for(let tb=Db.Rb(1);tb&&
!jb;tb=Db.yi(1))M.OutlineReader.Cva(tb)&&(jb=tb);if(Db&&!jb){if(!this.kM||!this.JK)return;lb=new w.GraphTransaction(7);lb.ev(Db);jb=this.kM.PBd(Db);this.JK.i6(Db,!0);Ob&&(N.OutlineElementNavigator.Ee(Db),Db=T.a.Uc(Db.currentNode,0),R.Jn.yae(J.FormattingReader.zr(Db),Ob))}Ob=K.SelectionFactory.Un(jb,!0);pc.Bb.setSelection(Ob);I.SelectionEditor.pf(Tb)&&(pc=v.GraphIterator.$a(Tb.node),pc.jo(),O.OutlineNavigator.XZf(pc),this.dyb&&this.qW&&M.OutlineReader.cA(pc,Tb,!0)&&(Tb=this.dyb.Ocf(Tb,-1,!1,G.a.xx))&&
this.qW.w1i(Tb));this.Kh&&this.Kh.aG();lb&&lb.dispose()}}static get Jn(){return null!=R.Mpg?R.Mpg:R.Mpg=a.a.instance.Pa("Box4.IFormattingEditor")}static get instance(){return null!=R.osg?R.osg:R.osg=R.Jl()}static Jl(){return new R(()=>a.a.instance.Pa("Box4.IUndoManager"))}static get mh(){return A.PageNavigator.instance}}Object(D.a)(R,"TitleViewEditor",null,[]);var W=c(54),V=c(445),ba=c(646),ha=c(21),ca=c(14),ia=c(299),ra=c(3);class da{constructor(){this.sJj=new r;this.A7e=(lb,Tb,pc,Db,Ob)=>this.sJj.A7e(lb,
Tb,pc,Db,Ob)}Wb(lb){const Tb=this.xEh.K7e.bind(this.xEh),pc=this.A7e,Db=this.nEh.Q1k.bind(this.nEh);this.dWf(lb,Tb,pc,Db);lb.pa(ra.a.backspace,ca.a.Vc,Db);lb.pa(ra.a.backspace,ca.a.Fd,Db);lb.pa(ra.a.backspace,ca.a.endOfParagraph,e.ActionManager.FZ);lb.pa(ra.a.backspace,ca.a.outline,pc);lb.pa(ra.a.backspace,ca.a.view,Tb);lb.Xc(ra.a.backspace,1124);lb.pa(ra.a.Nta,ca.a.Vc,e.ActionManager.FZ);lb.pa(ra.a.Nta,ca.a.Fd,Db);lb.pa(ra.a.Nta,ca.a.endOfParagraph,e.ActionManager.FZ);lb.pa(ra.a.Nta,ca.a.outline,
pc);lb.pa(ra.a.Nta,ca.a.view,Tb);lb.gb(ra.a.kCd,ca.a.view,Tb,1124);lb.pa(ra.a.gH,ca.a.Vc,Db);lb.pa(ra.a.gH,ca.a.Fd,Db);lb.pa(ra.a.gH,ca.a.endOfParagraph,e.ActionManager.FZ);lb.pa(ra.a.gH,ca.a.outline,pc);lb.pa(ra.a.gH,ca.a.view,Tb);lb.Xc(ra.a.gH,1124);lb.gb(ra.a.R5e,ca.a.view,Tb,1124);lb.gb(ra.a.Cla,ca.a.view,da.Cla,1028)}dWf(){}static get mh(){return A.PageNavigator.instance}static get ih(){return null!=da.fug?da.fug:da.fug=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get kM(){return null!=
da.Cug?da.Cug:da.Cug=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get JK(){return null!=da.bug?da.bug:da.bug=a.a.instance.resolve("Box4.IOutlineEditor")}static get $b(){return null!=da.Vog?da.Vog:da.Vog=a.a.instance.Pa("Box4.IFeatureHelper")}static Cla(lb,Tb,pc,Db,Ob){Db=Tb.view;if(!Db.Bb||!Db.Bb.hb.kb||I.SelectionEditor.om(Db.Bb.hb.kb))return 8;if(1===pc)return 32;pc=Db.Bb.hb;const jb=pc.kb;var tb=jb.Qa,ac=null,zc=!1;if(pc.YI){if(tb.contextId===ca.a.outline&&1===pc.length){for(lb=
v.GraphIterator.$a(tb.node);lb.Vd();)lb.Jg();da.JK.i6(lb,!0);N.OutlineElementNavigator.Ee(lb);lb=K.SelectionFactory.we(lb.currentNode,0);Db.Bb.setSelection(lb);return 32}var yc=tb.node;ac=null;if(ia.c(tb)){var cd=yc.xe(Db.Sb);cd&&(cd=cd.YYo)&&0<=cd.width&&0<=cd.height&&(ac=new V.a(k.a.Ml(cd.x,0),k.a.Ml(cd.y,1)));ac||(ac=ba.a(yc))}else ac=ba.a(tb.node);tb=v.GraphIterator.$a(tb.node);tb.jo();da.mh.i1c(tb);yc=da.kM.PBd(tb);ba.b(yc,ac.x,ac.y);da.JK.i6(tb,!0);ac=K.SelectionFactory.Un(yc,!0)}else if(1===
pc.length){zc=pc.last;tb=W.a.Fzb(zc);if(da.$b&&da.$b.isFeatureEnabled(23)&&H.ContextSetEditor.instance.n6f(tb).returnValue)return 2;zc=zc.Tc;zc=!pc.Lw&&(I.SelectionEditor.Dk(zc)||F.ParagraphReader.em(zc)||I.SelectionEditor.x7(zc))}zc&&(zc=I.SelectionEditor.Vj(jb,!1,!1,void 0,!1),Db.Bb.setSelection(zc),l.AFrameworkApplication.ya.Tf(Tb,ra.a.newLine,2,!1,null,Ob),ac=Db.Bb.hb.kb,Db.Bb.setSelection(jb));Ob||(Ob=new m.DictionaryPropertySet);Ob.setValue(z.a.SGc,!0);l.AFrameworkApplication.ya.Tf(Tb,ra.a.gH,
2,!0,null,Ob);if(ac&&ac.Qa.isValid)return Db.Bb.setSelection(ac),32;pc.YI&&R.instance.Cri(lb,Tb.Yj,Db);I.SelectionEditor.om(Db.Bb.hb.kb)||l.AFrameworkApplication.ya.Tf(Tb,ra.a.newLine,2,!1,null,Ob);return 32}static K1k(lb,Tb){if(1===Tb)return 32;Tb=new w.GraphTransaction(7);Tb.Eb(lb);da.ih.pRa(lb);Tb.dispose();return 32}}Object(D.a)(da,"ADeleteActor",null,[]);var za=c(11),la=c(248),na=c(256),Ca=c(159),Na=c(1471),Ta=c(61),Fa=c(16),qa=c(123),ja=c(68),X=c(124),ua=c(700),Ha=c(64);class Ea{get ag(){return la.a.instance}Q1k(lb,
Tb,pc,Db,Ob){Db=null===Ob||void 0===Ob?void 0:Ob.L7c;if(1===pc)return 32;var jb=lb===ra.a.backspace;if(this.ag.qh){if(this.ag.Jji(Tb)&&Ea.tta&&(pc=Tb.clone(),pc.Tb+=1,--pc.Fb,this.ag.S9b(pc)))return Ea.tta.bUi([pc]),32;if(this.ag.Ewf(Tb,jb))return 2}if(Ea.Gw()&&Ea.Gw().instance&&Ea.Gw().instance.PT(Tb))return 4;var tb=Tb.node;let ac=Tb.cpBegin;pc=Tb.cpEnd;let zc=Tb.Fb,yc=Tb.Tb;const cd=F.ParagraphReader.text(tb),Cd=cd.length;let ud=!1;if(ac===pc){if(jb&&!ac||!jb&&ac===Cd)return 2;jb?({cp:ac,returnValue:ud}=
this.ag.Zyi(tb,ac),ud||({cp:ac,ala:zc,returnValue:ud}=this.ag.Yyi(Tb,ac,zc)),ud||(ac--,Fa.a.az(cd,ac)&&ac--),lb=ra.a.YWe):({cp:pc,returnValue:ud}=this.ag.YVm(tb,pc),ud||({cp:pc,ala:yc,returnValue:ud}=this.ag.XVm(Tb,pc,yc)),ud||(pc++,Fa.a.az(cd,pc)&&pc++),lb=ra.a.YDh)}Tb=ac===pc?T.a.Uc(tb,ac):T.a.createTextRange(tb,ac,pc);ud&&this.ag.qh&&(jb?Tb.Fb=zc:Tb.Tb=yc);if(!this.ag.S9b(Tb))return 2;this.IYb(tb);jb=new w.GraphTransaction(15);jb.Kk=lb;jb.Eb(tb);tb=Object(qa.a)(ua.a,Ob)&&Ob.r_a;if(!Ea.Kd.zg||tb||
Ha.a.er&&Ea.vBa.JUd(W.a.instance.hb.kb))this.oEh(Tb,Db);else{tb=Ea.Kd.gYa();try{const $d=Ea.Dh.w4c(Tb);let gc;if(({type:gc}=$d.gNd()).returnValue){const kc=Object(ja.a)(105,Ob);kc&&kc.ia(X.a.Muf,!1)||!Ha.a.er&&4===gc?Ea.Kd.T3a=gc:Ea.Kd.Ds(gc)}Ob=0;for(let kc=$d.length-1;0<=kc;--kc){let Wc;const td=({kVd:Wc}=$d.getContext(kc)).returnValue;Wc?(Ea.hyperlinkEditor.jkb(td,null),Ob+=Ea.Dj.Xmb(td,2),Ea.Dj.qBd=pc+Ob):this.oEh(td,Db)}}finally{tb&&tb.dispose()}}jb.dispose();return 32}IYb(){}static get Kd(){return null!=
Ea.Uxg?Ea.Uxg:Ea.Uxg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Dj(){return null!=Ea.Fxg?Ea.Fxg:Ea.Fxg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Dh(){return null!=Ea.oyg?Ea.oyg:Ea.oyg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=Ea.sqg?Ea.sqg:Ea.sqg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static Gw(){return Ea.Om||(Ea.Om=a.a.instance.Za("Box4.IExternalSelectionManager"))}static get tta(){Ea.Wrb||
(Ea.Wrb=a.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return Ea.Wrb.instance}static get vBa(){return null!=Ea.gmg?Ea.gmg:Ea.gmg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}Ea.Om=null;Ea.Wrb=null;Object(D.a)(Ea,"ADeleteParagraphContentStrategy",null,[]);var wa=c(187),sa=c(799),fa=c(238),Ma=c(91),Ua=c(82),Qa=c(85);class Ja extends Ea{constructor(){super()}get characterPropertiesEditor(){return null!=this.pmg?this.pmg:this.pmg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Eq(){return null!=
this.emg?this.emg:this.emg=a.a.instance.Za("Box4.ContentControlConfigSettings")}get Qac(){return null!=this.Otg?this.Otg:this.Otg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get B2(){return null!=this.Lmg?this.Lmg:this.Lmg=a.a.instance.resolve("Box4.IContentControlChpHelper")}oEh(lb,Tb){this.d1k(lb,Tb)}Qhk(lb,Tb,pc,Db){this.Eq.instance&&this.Eq.instance.qh&&(lb.cpBegin===Tb.cpBegin?lb.Fb=Tb.Fb:pc&&(lb.Fb=pc.Jb&&pc.Jb.length?0:-1),lb.Tb=Db)}IYb(lb){const {DeleteActor:Tb}=c(1546);Tb.IYb(lb)}d1k(lb,
Tb){var pc=lb.node;const Db=fa.b([new wa.a(lb.cpBegin,lb.cpEnd)],this.xYl(lb));var Ob=new Qa.a,jb=[];Ja.zIk(pc,Db,Ob,jb);for(const tb of Ob.keys)1<Ob.J(tb)&&sa.a.sCi(Ta.a.Gf(tb));this.eDn(pc,jb);this.Qac.uDc(pc);pc=lb.Tb;Ob=!!this.Eq.instance&&this.Eq.instance.qh;for(jb=Db.length-1;0<=jb;jb--)pc=this.deleteRange(lb,Db[jb],pc,Ob,Tb)}xYl(lb){const Tb=[],pc=lb.node;var Db=Ma.f(pc,tb=>tb.$ka);for(var Ob of Db)Db=Ob.Nb.cp,Tb.push(new wa.a(Db,Db+1));Ob=F.ParagraphReader.PNa(pc);for(var jb of Ob)jb.US&&
Ja.vom(jb,lb)||Tb.push(jb);jb=!!this.Eq.instance&&this.Eq.instance.lna;this.Eq.instance&&this.Eq.instance.qh||!jb||!pc.Ms||(Ja.Qwh&&Ja.Qwh.cCn(lb),this.B2&&Tb.push(...this.B2.qhf(pc).toArray()));return fa.a(Tb)}eDn(lb,Tb){const pc=new Ua.a;for(const Db of Tb)for(Tb=0;Tb<Db.length;){Tb=this.NYh(Db,Tb,0);if(-1===Tb)break;let Ob=this.NYh(Db,Tb+1,3);if(-1===Ob)break;if(Db.J(Tb).US)for(;Ob>=Tb;){const jb=Db.J(Ob);pc.add(jb.Je);Db.remove(jb);Ob--}Tb=Ob+1}lb.Roa(pc)}NYh(lb,Tb,pc){for(;Tb<lb.length;Tb++){const Db=
lb.J(Tb);if(1===Db.FQ&&Db.fm===pc)return Tb}return-1}deleteRange(lb,Tb,pc,Db,Ob){const jb=Tb.begin,tb=Tb.end;Tb=null;Db&&(Tb=lb.node.qa.ei(jb));jb<tb&&(Db=T.a.createTextRange(lb.node,jb,tb),this.Qhk(Db,lb,Tb,pc),this.characterPropertiesEditor.replaceTextRange(Db,"",void 0,void 0,ra.a.NBc,!1,Ob));return pc=Tb&&Tb.Jb&&Tb.Jb.length?Tb.Jb.length:-1}static get Qwh(){return null!=Ja.Vmg?Ja.Vmg:Ja.Vmg=a.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator")}static vom(lb,Tb){return lb.begin>=
Tb.cpBegin&&lb.end<=Tb.cpEnd}static zIk(lb,Tb,pc,Db){let Ob=0;lb=lb.qa;for(const jb of Tb)for(;Ob<lb.length;){Tb=lb.J(Ob);if(Tb.cp>=jb.begin&&Tb.cp<jb.end&&(Tb.ff&&Tb.ff.fNk&&Db.push(Tb.ff),Tb.Ph))for(let tb=0;tb<Tb.Ph.length;tb++){const ac=Tb.Ph.J(tb).an.toString();pc.ub(ac)?pc.Z(ac,pc.J(ac)+1):pc.Z(ac,1)}++Ob}}}Object(D.a)(Ja,"DeleteParagraphContentStrategy",Ea,[]);class Wa{static get vG(){return na.a.instance}static k2k(lb,Tb,pc){if(1===pc)return 32;lb=Tb.node;return Wa.vG.Ixd(lb)?da.K1k(lb,pc):
32}}Object(D.a)(Wa,"DeleteUnsupportedObjectStrategy",null,[]);var Ya=c(171),sb=c(332),ob=c(133),fc=c(303),Eb=c(8),Ib=c(1007),Nb=c(43),pb=c(130),Aa=c(654),xb=c(446),gb=c(550),Xa=c(598),Va=c(837),Gb=c(180),Xb=c(149),rc=c(277),qb=c(531),Zb=c(38),Rb=c(140);class Ra{constructor(lb,Tb,pc,Db,Ob){this.kFo=lb;this.x8=pc;this.vd=Db;this.actionId=Tb;this.L7c=Ob}}Object(D.a)(Ra,"DeleteActionData",null,[]);var ab=c(988),fb=c(192),bb=c(862),Ub=c(37);class Oa{constructor(lb,Tb,pc,Db,Ob,jb,tb,ac,zc,yc){this.pEh=
lb;this.ag=Tb;this.vG=pc;this.hyperlinkEditor=Db;this.OI=Ob;this.xl=jb;this.qKi=tb;this.characterPropertiesEditor=ac;this.Kd=zc;this.vBa=yc}Aoo(lb){return!I.SelectionEditor.Ek(lb)&&!I.SelectionEditor.Paa(lb)}zTl(lb,Tb,pc){var Db;let Ob,jb,tb;if(!Tb&&lb&&lb.Nx&&(Db=lb.Qa)&&I.SelectionEditor.pf(Db)&&this.xl.ic(Db.node)&&(Ob=Db.node.qa.ei(Db.cpBegin))&&Ob.ql&&(jb=this.fwl(Ob))&&jb.hyperlink.cG&&(tb=this.nTl(lb,jb.cp)))return tb;if(!lb)return null;if(Ha.a.$l&&(Db=this.Uro(lb,Tb)))return Db;if(!pc)return lb;
Tb=I.SelectionEditor.lNa(lb,!Tb,{hB:!1,Ns:!0,fD:!0,XE:!0});return K.SelectionFactory.Vz(lb,Tb.Qa,!1)}fwl(lb){const Tb=lb.paragraph.qa;let pc=null;lb=lb.cp;for(let Db=0;Db<Tb.length;Db++){const Ob=Tb.J(Db);if(Ob.cp>=lb)break;Ob.ql&&(pc=null);Ob.hyperlink&&(pc=Ob)}return pc}qTl(lb,Tb){var pc=lb.Qa.node;if(Tb){if(Tb=I.SelectionEditor.iSa(lb.Qa.node,lb.Qa.cpBegin,!0),lb=K.SelectionFactory.Vz(lb,T.a.Uc(lb.Qa.node,Tb),!1),pc=pc.qa.ei(Tb),pc.Raa||pc.m3)lb.Qa.Fb=0}else if(Tb=I.SelectionEditor.iSa(lb.Qa.node,
lb.Qa.cpBegin,!1),lb=K.SelectionFactory.Vz(lb,T.a.Uc(lb.Qa.node,Tb),!1),pc=pc.qa.ei(Tb),pc.Raa||pc.m3)lb.Qa.Fb=pc.jw+pc.zM;lb.I8b=!0;return lb}Uro(lb,Tb){var pc=lb.Qa;let Db=null;if(!lb.Nx||!pc||!I.SelectionEditor.pf(pc))return null;if(this.xl.ic(pc.node)&&(Db=Tb?pc.node.qa.ei(pc.cpBegin):pc.node.qa.qCb(pc.cpBegin-1))&&Db.C3)return this.qTl(lb,Tb);pc=v.GraphIterator.$a(lb.Qa.node);pc.Ab(8);N.OutlineElementNavigator.$d(pc);let Ob=!1;const jb=[];if(Tb?Db&&Db.Uh:0===lb.Qa.cpBegin){do(lb=Tb?N.OutlineElementNavigator.Jr(pc,
!0,!0,!1):N.OutlineElementNavigator.u_(pc,!0,!0,!1))&&(null===lb||void 0===lb?0:lb.BOa)?(jb.push(T.a.create(N.OutlineElementNavigator.Ee(pc))),N.OutlineElementNavigator.$d(pc)):Ob=!0;while(!Ob);if(0<jb.length)return Tb=new Gb.Selection(Tb?jb:jb.reverse(),Tb),Tb.I8b=!0,Tb}return null}nTl(lb,Tb){var pc=I.SelectionEditor.NCa(lb,{hB:!1,Ns:!1,fD:!0,XE:!0});if(!pc||!pc.Nx||pc.Qa.node!==lb.Qa.node)return null;pc=pc.Qa;if(pc.cpBegin!==pc.cpEnd)return null;const Db=this.xl.text(pc.node);for(let Ob=pc.cpBegin-
1;Ob>=Tb;Ob--)if(!Fa.a.uv(Db.charCodeAt(Ob)))return K.SelectionFactory.Vz(lb,T.a.Uc(pc.node,Ob+1),!1);return K.SelectionFactory.Vz(lb,T.a.Uc(pc.node,Tb),!1)}K7e(lb,Tb,pc,Db,Ob){var jb,tb;if(1===pc)return 32;(pc=null===(tb=null===(jb=Tb.view)||void 0===jb?void 0:jb.Bb)||void 0===tb?void 0:tb.Lg)&&H.ContextSetEditor.instance.VCh(pc).filter(F.ParagraphReader.MT).forEach(ac=>{var zc;return null===(zc=F.ParagraphReader.RNa(ac.node))||void 0===zc?void 0:zc.kbe("delete_selection")});tb=!1;lb===ra.a.R5e?
(lb=ra.a.gH,tb=!0):lb===ra.a.kCd?(lb=ra.a.backspace,tb=!0):lb===ra.a.Nta&&(Tb=new gb.a(za.App.xa.jb.wc));if(!Tb.view.ue)return 2;Xb.GrippersManager.instance.mB(!1);jb=lb===ra.a.gH;pc=rc.a.hXh(Tb);if(tb&&this.ag.qh&&pc&&I.SelectionEditor.om(pc)&&this.ag.Ewf(pc.Qa,!jb,!0))return 2;tb=this.zTl(pc,jb,tb);return this.m2k(lb,Tb,Db,Ob,tb,jb)}m2k(lb,Tb,pc,Db,Ob,jb){var tb;const ac=Tb.view,zc=ac.Bb;var yc=Db,cd=Db;lb===ra.a.Nta&&(cd=yc=null,Ob=new Gb.Selection(Db,!0));if(!Ob)return 32;const Cd=this.v5n(yc,
jb);if(this.ag.qh&&Oa.tta&&1===zc.hb.length&&I.SelectionEditor.om(Ob)&&Ob.Nx&&Oa.tta.wRn(Ob.Qa,jb))return 32;let ud;jb?Ya.a.mark(ud=5009):Ya.a.mark(ud=5011);yc=new w.GraphTransaction(15);yc.Kk=lb;yc.Eb(ac.jd);let $d=null,gc=({ZPn:$d}=this.eyl(lb,Db,zc,Ob,$d)).returnValue;var kc=null;({Pce:kc}=H.ContextSetEditor.instance.n6f(gc)).returnValue&&(gc=kc);if(!gc)return yc.dispose(),32;kc=!1;l.AFrameworkApplication.Ce("b1jb9393;09icj321");if(null===(tb=l.AFrameworkApplication.K)||void 0===tb?0:tb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))tb=gc.node,kc=null===tb||void 0===tb?void 0:tb.Ms;const Wc=new Ra(Tb,lb,pc,cd,kc);this.ag.qh&&Oa.tta&&(cd=H.ContextSetEditor.instance.vN(gc),Oa.tta.bUi(cd));this.Mjj(gc);const td=this.SRh(gc,Ob,jb);let Fe=null;jb?Fe=new Va.a(Ob):td&&(Fe=new Va.a(td));let Cf=!1;cd=Oa.ij;if(I.SelectionEditor.pf(gc)){const ie=ab.a.q5b(ac.jd,Cd);cd.Sd(()=>{this.Z0k(Tb,pc,Db,gc,jb,Fe,Ob,ie,zc,Cd,Wc,td)},"DVS:DAIPC")}else!this.Kd.zg||Ha.a.er&&this.vBa.JUd(Ob)?cd.Sd(()=>{Cf=this.DLi(lb,ac.jd,gc,zc,Cd,Wc,Fe,$d)},"DVS:PUD"):
(cd.Sd(()=>{this.zoo(lb,ac.jd,gc,jb,Ob,zc,Cd,Wc,Fe)},"DVS:TCDC"),Cf=!0);this.bll(zc);this.cZi(gc);yc.dispose();Ya.a.mark(ud+1);return lb===ra.a.Nta?Cf?32:8:32}DLi(lb,Tb,pc,Db,Ob,jb,tb,ac){Tb=ab.a.q5b(Tb,Ob);this.Aoo(pc)&&Tb.n6a(pc);lb=Oa.Mc.Xo(lb);lb.properties.Z("CountOfParagraphsDeleted",this.xl.C3e(pc).toString());pc=this.o6k(pc,Db,Ob,Tb,jb,tb,ac);lb.end();return pc}zoo(lb,Tb,pc,Db,Ob,jb,tb,ac,zc){var yc=0,cd=null;const Cd=H.ContextSetEditor.instance.vN(pc),ud=Cd[Cd.length-1];if(ud.contextId===
ca.a.paragraph||ud.contextId===ca.a.endOfParagraph){var $d=v.GraphIterator.$a(ud.node);$d.zd();N.OutlineElementNavigator.$d($d);N.OutlineElementNavigator.Jr($d,!0,!1)&&(cd=N.OutlineElementNavigator.Ee($d))&&(yc=this.xl.textLength(cd))}else yc=this.xl.textLength(ud.node)-ud.cpEnd;$d=Object(ja.a)(105,ac.vd);if($d=!!$d&&$d.ia(X.a.Muf,!1))this.BLi(lb,Tb,pc,jb,tb,ac,zc,!1,$d);else{$d=this.Kd.gYa();try{this.BLi(lb,Tb,pc,jb,tb,ac,zc,!0)}finally{$d&&$d.dispose()}}if(Ha.a.$l&&Ob.I8b)yc=this.SRh(pc,Ob,Db),
this.xl.ic(yc.Qa.node)&&W.a.instance.setSelection(yc);else{if(Db){if(pc.Hw){lb=Cd.length-1;do Ob=Cd[lb],lb--;while(!Ob.node.isConnected&&0<=lb)}else Ob=pc;if(!this.xl.ic(Ob.node))return;switch(ud.contextId){case ca.a.paragraph:case ca.a.endOfParagraph:yc=cd&&cd.isConnected?0:yc;break;case ca.a.Vc:case ca.a.Fd:break;default:yc=0}yc=K.SelectionFactory.we(Ob.node,this.xl.textLength(Ob.node)-yc);Ob.xk===yc.Qa.cpBegin&&(yc.Qa.Fb=Ob.Fb)}else{yc=Ob.Qa.node;if(!this.xl.ic(yc))return;cd=Ob.Qa.contextId===
ca.a.paragraph?0:Ob.Qa.contextId===ca.a.endOfParagraph?this.xl.textLength(yc):Ob.Qa.cpBegin;yc=K.SelectionFactory.we(yc,cd)}W.a.instance.setSelection(yc)}}BLi(lb,Tb,pc,Db,Ob,jb,tb,ac,zc=!1){pc=this.wpl(Db,pc);pc=Oa.Dh.w4c(pc);({type:cd}=pc.gNd()).returnValue&&(ac&&4!==cd?this.Kd.Ds(cd):Ha.a.er||(this.Kd.T3a=cd));for(ac=pc.length-1;0<=ac;--ac){var yc=void 0;var cd=({kVd:yc}=pc.getContext(ac)).returnValue;yc?(yc=zc&&cd.contextId===ca.a.endOfParagraph&&ac===pc.length-1,this.hyperlinkEditor.jkb(cd,2),
yc||Oa.Dj.Xmb(cd,2)):this.DLi(lb,Tb,cd,Db,Ob,jb,tb,null)}}wpl(lb,Tb){if(Object(qa.a)(xb.a,Tb)){lb=Xa.OutlineElementGeneralizer.ima(lb.hb,!0);for(let pc=0;pc<lb.length;pc++)if(lb.getContext(pc).contextId===ca.a.table)return lb}return Tb}eyl(lb,Tb,pc,Db,Ob){lb===ra.a.Nta?(lb=sb.a.aCa(Tb),Ob=qb.SelectionReferenceFactory.instance.Kzb()):(Ob=null,lb=1===pc.hb.length?W.a.Fzb(Db):pc.Lg);return{returnValue:lb,ZPn:Ob}}eAk(lb){return!lb.gl||lb.contextId!==ca.a.paragraph||!this.xl.ic(lb.node)||this.Kd.zg||this.ag.iUd(lb)?
!1:!0}Mjj(lb){if(lb.Hw)for(let Tb=0;Tb<lb.length;Tb++)this.Mjj(lb.getContext(Tb));else this.eAk(lb)&&(lb.node.Jxd=!0)}cZi(lb){if(lb.Hw)for(let Tb=0;Tb<lb.length;Tb++)this.cZi(lb.getContext(Tb));else lb.gl&&(lb=lb.node)&&this.xl.ic(lb)&&(lb.Jxd=!1)}SRh(lb,Tb,pc){if(lb.gl&&I.SelectionEditor.pf(lb)&&!pc){const Db=lb.node;let Ob=lb.cpBegin,jb=-1;if(({cp:Ob}=this.ag.Zyi(Db,Ob)).returnValue)return K.SelectionFactory.we(Db,Ob);if(({cp:Ob,ala:jb}=this.ag.Yyi(lb,Ob,jb)).returnValue)return Tb=K.SelectionFactory.we(Db,
Ob),Tb.Qa.Fb=jb,Tb.Qa.Tb=jb,Tb}Tb=Ha.a.$l?I.SelectionEditor.lNa(Tb,!pc,{hB:!Tb.I8b||Tb.Nx,Ns:!1,fD:!1,XE:!0,bta:I.SelectionEditor.om(Tb)}):I.SelectionEditor.lNa(Tb,!pc,{hB:!0,Ns:!1,fD:!1,XE:!0});this.ag.qh&&I.SelectionEditor.Ek(lb)&&(Tb.Qa.Tb=Tb.Qa.Fb=pc?lb.Tb:lb.Fb);return Tb}Z0k(lb,Tb,pc,Db,Ob,jb,tb,ac,zc,yc,cd,Cd){const ud=Oa.ij;!I.SelectionEditor.cA(Db.node,Db,Ob)||this.ag.qh&&this.ag.Jji(Db)?ud.Sd(()=>{this.D1k(Db,Ob,jb,tb,ac,zc,yc,cd)},"DVS:IPM"):ud.Sd(()=>{const {response:$d,dY:gc}=this.C1k(lb,
Tb,pc,Db,Ob,tb,ac,zc,cd,Cd);Oa.VAi(ac,32===$d);gc&&Oa.Uoa(zc,jb)},"DVS:ISE")}w3l(lb,Tb){fb.a.uX&&(Tb.vd||(Tb.vd=new m.DictionaryPropertySet),Tb.vd.setValue(X.a.Rna,"delete"),Tb.vd.setValue(X.a.vga,"backspace"));var pc=lb.IS;const Db=Oa.hd.dO(pc),Ob=Aa.a.CBm;if(null===Ob||void 0===Ob?0:Ob.Ium(pc,Db)){fb.a.uX&&Tb.vd.setValue(X.a.vga,"backspace-autocorrect");pc=Ob.qkj+" ";const jb=T.a.Uc(lb,0);this.characterPropertiesEditor.replaceTextRange(jb,pc);lb=K.SelectionFactory.we(lb,pc.length);W.a.instance.setSelection(lb);
Eb.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",Ob.qkj)}return l.AFrameworkApplication.ya.Tf(Tb.kFo,Db.Rt?ra.a.uJ:ra.a.qB,2,!1,Tb.x8,Tb.vd)}U2l(lb,Tb,pc,Db,Ob){let jb=!1;0<this.qKi.Z2(lb).yt&&(Ob=l.AFrameworkApplication.ya.Tf(Tb,ra.a.pec,2,!1,pc,Db),jb=!0);return{vT:jb,response:Ob}}a3l(lb,Tb,pc,Db,Ob){let jb=!1;0<this.qKi.QF(lb).yt&&(Ob=l.AFrameworkApplication.ya.Tf(Tb,ra.a.$_c,2,!1,pc,Db),jb=!0);return{vT:jb,response:Ob}}f4l(lb,Tb,pc,Db,Ob){let jb=!1;Oa.Vp.Gyb(lb)&&
(Ob=l.AFrameworkApplication.ya.Tf(Tb,ra.a.GE,2,!1,pc,Db),jb=!0);return{vT:jb,response:Ob}}G1l(lb,Tb,pc,Db,Ob,jb,tb,ac,zc,yc){const cd=new pb.a;cd.ed(Tb);let Cd=!1;if(N.OutlineElementNavigator.TEa(cd,!1,!lb,!1)){yc=!0;zc=32;Cd=!0;(new v.GraphIterator).ed(cd);N.OutlineElementNavigator.Ee(cd);const $d=cd.currentNode;F.ParagraphReader.rta($d)&&F.ParagraphReader.RNa($d).kbe("delete_ip");var ud=new v.GraphIterator;ud.set(tb);(ud=this.xl.isEmpty(ud))&&Ob&&I.SelectionEditor.x7(Ob.Qa)?(pc.n6a(jb),N.OutlineElementNavigator.Ee(Tb),
Oa.ih.pRa(Tb.currentNode)):$d.VI?(pc.n6a(jb),N.OutlineElementNavigator.$d(cd),cd.Jg()):lb&&ud?this.ag.bmi(tb)&&!({dY:yc}=this.qOi(lb,tb,$d,Ob,yc)).returnValue&&(pc.n6a(jb),Oa.xn.axa(Tb),this.pEh.Mjn(tb),Tb.Jg()):Zb.TableReader.isTable(cd)?(pc.n6a(jb),lb&&(ha.moveToFirstRow(cd),ha.moveToFirstColumn(cd),O.OutlineNavigator.Y7(cd),N.OutlineElementNavigator.Ee(cd),ac.setSelection((new Va.a(K.SelectionFactory.we(cd.currentNode,0))).restore())),zc=2,yc=!1):this.xl.ic($d)&&(1==this.xl.textLength($d)&&(ac=
Ma.e($d),1==ac.length&&8==ac[0].li&&(ac=T.a.createTextRange($d,0,1),this.characterPropertiesEditor.replaceTextRange(ac,"",void 0,void 0,ra.a.NBc))),({dY:yc}=this.qOi(lb,tb,$d,Ob,yc)).returnValue||(Db.actionId==ra.a.backspace&&pc.djc(tb),this.pEh.$0k(lb,pc,jb,Tb,tb,cd)))}return{vT:Cd,response:zc,dY:yc}}qOi(lb,Tb,pc,Db,Ob){if(this.Kd.zg){if(Oa.uta){const jb=Object(qa.a)(Rb.AParagraphNode,pc)?Oa.uta.zRc(pc):!1,tb=Object(qa.a)(Rb.AParagraphNode,Tb)?Oa.uta.zRc(Tb):!1;if(jb!==tb)return{returnValue:!1,dY:Ob};
if(!Ha.a.er&&tb)return this.ag.qh&&Oa.Unk(Tb,pc,lb)&&this.Kd.Ds(4),{returnValue:!1,dY:Ob}}lb=lb?Tb:pc;if(!Object(qa.a)(Rb.AParagraphNode,lb))return{returnValue:!1,dY:Ob};Tb=lb.qa.last;pc=l.AFrameworkApplication.userName;if(!Tb.aj||Tb.aj.authorName!==pc)return Oa.Dj.sMb(lb,2),Db&&(W.a.instance.setSelection(Db),Ob=!1),{returnValue:!0,dY:Ob}}return{returnValue:!1,dY:Ob}}o3l(lb,Tb,pc,Db,Ob,jb,tb,ac){Nb.OutlineElementReader.Iom(Tb,lb)||({response:tb,dY:ac}=Oa.d7k(pc,Db,lb,jb,Ob,tb,ac));return{vT:!1,response:tb,
dY:ac}}C1k(lb,Tb,pc,Db,Ob,jb,tb,ac,zc,yc){let cd=!1,Cd=2;const ud=Db.node;let $d=void 0,gc=!1;const kc=Oa.ij;if(!Ob){if(ud.IS)return kc.Sd(()=>{Cd=this.w3l(ud,zc)},"DVS:HLOE"),{response:Cd,dY:cd};kc.Sd(()=>{({response:Cd,vT:gc}=this.U2l(ud,lb,Tb,pc,Cd))},"DVS:HIOD");if(gc)return{response:Cd,dY:cd};kc.Sd(()=>{({response:Cd,vT:gc}=this.a3l(ud,lb,Tb,pc,Cd))},"DVS:HWPF");if(gc)return{response:Cd,dY:cd};$d=this.sZh(ud);kc.Sd(()=>{({response:Cd,vT:gc}=this.f4l($d,lb,Tb,pc,Cd))},"DVS:HPOB");if(gc)return{response:Cd,
dY:cd}}null!==$d&&void 0!==$d?$d:$d=this.sZh(ud);kc.Sd(()=>{({response:Cd,vT:gc,dY:cd}=this.G1l(Ob,$d,tb,zc,yc,Db,ud,ac,Cd,cd))},"DVS:HAOE");if(gc)return{response:Cd,dY:cd};kc.Sd(()=>{({response:Cd,vT:gc,dY:cd}=this.o3l(Ob,$d,Tb,pc,tb,jb,Cd,cd))},"DVS:HFLOE");return{response:Cd,dY:cd}}E5n(lb){return I.SelectionEditor.Ek(lb)||this.vG.lpi(lb)||I.SelectionEditor.Paa(lb)}v5n(lb,Tb){return lb&&lb.hasProperty(z.a.SGc)?!lb.ia(z.a.SGc,!1):!Tb}static get hd(){return null!=Oa.wtg?Oa.wtg:Oa.wtg=a.a.instance.resolve("Box4.List.IListReader")}static get xn(){return null!=
Oa.mtg?Oa.mtg:Oa.mtg=a.a.instance.resolve("Box4.List.IListEditor")}static get ih(){return null!=Oa.oug?Oa.oug:Oa.oug=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get Vp(){return Ib.a.SCb}static get Dj(){return null!=Oa.Jxg?Oa.Jxg:Oa.Jxg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Dh(){return null!=Oa.qyg?Oa.qyg:Oa.qyg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Mc(){return ob.a.instance}static get tta(){Oa.Wrb||
(Oa.Wrb=a.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return Oa.Wrb.instance}static get uta(){return null!=Oa.Zmg?Oa.Zmg:Oa.Zmg=a.a.instance.Pa("Box4.IContentControlReader")}static get ij(){return fc.a.instance}bll(lb){if(1===lb.hb.length&&(lb=lb.hb.J(0),I.SelectionEditor.om(lb))){var Tb=lb.Qa;lb=Tb.node;Tb=Tb.cpBegin;var pc=this.xl.text(lb);Tb<pc.length&&0<Tb&&" "===pc.charAt(Tb-1)&&" "===pc.charAt(Tb)&&this.characterPropertiesEditor.replaceTextRange(T.a.createTextRange(lb,Tb-1,
Tb),"\u00a0")}}nqk(lb,Tb){if(!Tb.hyperlink.vib){const pc=new w.GraphTransaction(15);try{pc.Eb(lb.node),this.OI.VQ(lb,Tb)}finally{pc&&pc.dispose()}Tb.hyperlink.cG&&this.Kd.Ds(2)}}static d7k(lb,Tb,pc,Db,Ob,jb,tb){if(pc=I.SelectionEditor.lNa(Db,!pc,{hB:!1,Ns:!1,fD:!1,XE:!0})){Db=K.SelectionFactory.Vz(Db,pc.Qa);jb=32;for(pc=0;pc<Db.length;++pc){Ob.n6a(Db.J(pc));const ac=l.AFrameworkApplication.ya.Tf(Db.J(pc),ra.a.gH,2,!0,lb,Tb);2!==ac&&(jb=ac)}32===jb&&(tb=!0)}return{response:jb,dY:tb}}o6k(lb,Tb,pc,Db,
Ob,jb,tb){let ac=!1;this.F5n(lb)?(ac=Oa.c9e(lb,!0,Tb,pc,Db,Ob))&&Oa.yHa(jb,Tb,tb):this.E5n(lb)?(ac=Oa.c9e(lb,!1,Tb,pc,Db,Ob))&&Oa.yHa(jb,Tb,tb):(Db.normalize(),Oa.yHa(jb,Tb,tb));return ac}static yHa(lb,Tb,pc){pc&&pc.Uoa()||Oa.Uoa(Tb,lb)}static c9e(lb,Tb,pc,Db,Ob,jb){var tb;Db||M.OutlineReader.gPa(lb)||(pc=Oa.I6c(pc))&&Ob.$1n(pc);l.AFrameworkApplication.Ce("b1jb9393;09icj321");if(null===(tb=l.AFrameworkApplication.K)||void 0===tb?0:tb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))jb.vd?jb.vd.L7c=jb.L7c:jb.vd={L7c:jb.L7c};tb=null;Oa.vgn&&(tb=lb instanceof xb.a?lb.getContext(0).node:lb.node,tb=Oa.OMl(tb));lb=32===l.AFrameworkApplication.ya.Tf(lb,jb.actionId,2,Tb,jb.x8,jb.vd);Oa.VAi(Ob,lb,tb);return lb}static get vgn(){if(null!=Oa.ovg)var lb=Oa.ovg;else{var Tb;lb=null===(Tb=l.AFrameworkApplication.K)||void 0===Tb?void 0:Tb.getBooleanFeatureGate("Microsoft.Office.WordOnline.persistFormattingProperties",!1);lb=Oa.ovg=lb}return lb}static get Jn(){return null!=Oa.Ppg?Oa.Ppg:
Oa.Ppg=a.a.instance.resolve("Box4.IFormattingEditor")}static get Enb(){return null!=Oa.zwg?Oa.zwg:Oa.zwg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static OMl(lb){const Tb=new bb.a;if(lb){let pc=null;lb=K.SelectionFactory.Un(lb,!0);if(!lb)Eb.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let Db=0;Db<lb.length;Db++)if(J.FormattingReader.x2e(lb.J(Db))){pc=lb.J(Db);break}pc&&((lb=J.FormattingReader.zr(pc))&&lb.cache&&lb.cache.$y&&(lb=lb.Xf(null),Oa.Jn.sU(lb)),lb&&(Tb.formatting=
lb.Hj,Tb.languageId=J.FormattingReader.language(lb)),Ub.a.instance.J(7)&&(Tb.Zpa=Oa.Enb.Xn(pc.node)))}return Tb}static VAi(lb,Tb,pc){Tb?lb.normalize(pc):lb.cancel()}static Uoa(lb,Tb){Tb&&Oa.ij.Sd(()=>{const pc=Tb.restore();pc&&lb.setSelection(pc)},"DVS:RS")}D1k(lb,Tb,pc,Db,Ob,jb,tb,ac){let zc;!Tb&&({hyperlink:zc}=this.OI.R8b(lb)).returnValue?(pc=new Va.a(Db),this.nqk(lb,zc),Ob.normalize(),Oa.Uoa(jb,pc)):Oa.c9e(lb,!1,jb,tb,Ob,ac)&&(Tb&&this.Kd.zg?(Tb=Oa.Dj.qBd)?(jb.setSelection(K.SelectionFactory.we(lb.node,
Tb)),Oa.Dj.qBd=null):Oa.Uoa(jb,pc):Oa.Uoa(jb,pc))}static Unk(lb,Tb,pc){pc?(pc=lb,lb=Tb):pc=Tb;Tb=Oa.uta.o9b(pc,!1);lb=Oa.uta.o9b(lb,!0);return!(Tb&&lb)}F5n(lb){return lb.Hw||M.OutlineReader.gPa(lb)||this.xl.em(lb)}static I6c(lb){return(lb=Xa.OutlineElementGeneralizer.ima(lb.hb,!0))&&1===lb.length&&(lb=lb.getContext(0).node,Zb.TableReader.yX(lb))?lb:null}sZh(lb){const Tb=new v.GraphIterator;Tb.set(lb);Tb.zd();N.OutlineElementNavigator.$d(Tb);return Tb}}Oa.Wrb=null;Object(D.a)(Oa,"ADeleteViewStrategy",
null,[]);class Fc{$0k(lb,Tb,pc,Db,Ob,jb){const tb=jb.currentNode;N.OutlineElementNavigator.$d(jb);lb?(Tb.djc(jb.currentNode),Fc.ag.Ski(pc,Ob,tb,!1)||Fc.ih.merge(Db,jb,!1,!1)):Fc.ag.Ski(pc,tb,Ob,!0)||Fc.ih.merge(jb,Db,!1,!1)}Mjn(lb){lb&&F.ParagraphReader.ic(lb)&&(Na.a.U_c(lb),Fc.z9k.mUe(lb))}static get ih(){return null!=Fc.iug?Fc.iug:Fc.iug=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get z9k(){return null!=Fc.Jng?Fc.Jng:Fc.Jng=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get ag(){return la.a.instance}}
Object(D.a)(Fc,"DeleteParagraphNodeStrategy",null,[322]);class xc extends Oa{constructor(lb,Tb,pc,Db,Ob,jb,tb,ac,zc){super(new Fc,lb,Tb,pc,Db,Ob,jb,tb,ac,zc)}}Object(D.a)(xc,"DeleteViewStrategy",Oa,[]);c.d(L,"DeleteActor",function(){return pd});class pd extends da{constructor(lb,Tb,pc,Db,Ob,jb,tb,ac,zc,yc,cd,Cd){super();this.deleteParagraph=(ud,$d)=>{ud=$d.node;Na.a.U_c(ud);this.Mse.mUe(ud);this.ul&&this.ul.instance&&Ca.App.Xie&&this.ul.instance.FMf(ud);ud.Ms&&(this.zm.bCn(ud,!this.qh),this.qh&&this.xLg.instance&&
this.xLg.instance.Snj(ud));return 0};this.gDd=(ud,$d,gc)=>{2==gc&&(ud=l.AFrameworkApplication.breadcrumbFolderUrl,ud&&0!=ud.length||(ud=l.AFrameworkApplication.breadcrumbBrandUrl),za.App.IBb(ud));return 32};this.Y0k=(ud,$d,gc)=>{({DeleteActor:ud}=c(1546));if(1===gc)return 32;gc=za.App.xa.tq.jg("ModelUpdate","DeleteAnchoredObject");$d=$d.node;const kc=new v.GraphIterator;kc.set($d);kc.Ab(12);const Wc=kc.ko(12);if(la.a.instance.xRc(Wc))return 2;ud.IYb(Wc);ud=new w.GraphTransaction(7);ud.Eb($d);kc.Jg();
ud.dispose();gc.stop();return 32};this.tJj=new Ja;this.uJj=new xc(la.a.instance,na.a.instance,jb,tb,ac,zc,yc,cd,Cd);this.zm=lb;this.wqc=Tb;this.xLg=pc;this.Mse=Db;this.ul=Ob}get qh(){return this.wqc.instance?this.wqc.instance.qh:!1}get xEh(){return this.uJj}get nEh(){return this.tJj}dWf(lb,Tb,pc,Db){const Ob=Wa.k2k,jb=this.Y0k;lb.pa(ra.a.backspace,ca.a.anchoredObject,jb);lb.pa(ra.a.backspace,ca.a.unsupportedObject,Ob);lb.pa(ra.a.gH,ca.a.anchoredObject,jb);lb.pa(ra.a.gH,ca.a.unsupportedObject,Ob);
lb.pa(ra.a.backspace,ca.a.paragraph,this.deleteParagraph);lb.pa(ra.a.gH,ca.a.paragraph,this.deleteParagraph);lb.pa(ra.a.Nta,ca.a.paragraph,this.deleteParagraph);lb.pa(ra.a.gDd,ca.a.view,this.gDd);lb.Xc(ra.a.Nta,64);super.dWf(lb,Tb,pc,Db)}static IYb(lb){var Tb;(null===(Tb=za.App.yd)||void 0===Tb?0:Tb.Xp)&&za.App.yd.Vq.WG(lb)}}Object(D.a)(pd,"DeleteActor",da,[])},1549:function(D,L,c){D=c(0);class l{constructor(w,v,r,z){this.sIj=w;this.e0j=v;this.c0j=r;this.f0j=z}get OAd(){return this.sIj}get g9d(){return this.e0j}get e9d(){return this.c0j}get resultType(){return this.f0j}}
Object(D.a)(l,"SearchContext",null,[1105]);class e{YBd(w,v,r,z){var A=r-v;let G;if(100<=A)A=v,G=r;else{A=Math.max(0,v+Math.ceil(A/2)-50);G=Math.min(w.length,A+100);A=Math.max(0,G-100);let I;if(A&&" "!==w.charAt(A-1)){I=Math.min(v,A+10);for(var H=A;H<I;++H)if(" "===w.charAt(H)){A=H+1;break}}if(G!==w.length&&" "!==w.charAt(G))for(I=Math.max(r,G-10),H=G-1;H>=I;--H)if(" "===w.charAt(H)){G=H;break}}w=w.substring(A,G);return new l(w,v-A,r-A,z)}ZBd(w){return this.YBd(w.O0h(),w.begin,w.end,"")}}Object(D.a)(e,
"SearchContextFactory",null,[1079]);var a=c(140),k=c(1535);c.d(L,"a",function(){return m});class m extends e{constructor(){super()}ZBd(w){let v=w.begin,r=w.end;const z=({begin:v,end:r}=m.ENl(w,v,r)).returnValue;w=k.a(w.type);return this.YBd(z,v,r,w)}static get instance(){return null!=m.srg?m.srg:m.srg=new m}static ENl(w,v,r){w=w.O0h();return m.LUi(w,v,r)}static LUi(w,v,r){const z=a.AParagraphNode.uU(w);if(z.length<w.length){w=w.substring(0,v);const A=a.AParagraphNode.uU(w);w=w.length-A.length;v-=
w;r-=w}return{returnValue:z,begin:v,end:r}}}Object(D.a)(m,"EditorSearchContextFactory",e,[])},1551:function(D,L,c){D=c(0);var l=c(2),e=c(22),a=c(310),k=c(721),m=c(24),w=c(11),v=c(139),r=c(54),z=c(658),A=c(213),G=c(260),H=c(94),I=c(36),K=c(10),F=c(3),J=c(7),N=c(596),O=c(1024);class M{create(){return new O.a}}Object(D.a)(M,"FootnoteEndnoteContainerNodeFactory",null,[204]);var T=c(551);c.d(L,"a",function(){return R});class R{constructor(W,V,ba,ha,ca,ia,ra,da,za){this.Nsd=null;R.ga=W;this.bF=ba;this.rGe=
ha;this.WHj=ia;this.Zc=ra;this.ib=ca;this.kVj=da;this.dJj=za;R.Eh=V}SZd(W,V){this.Hbl(W);W.Rb(7);this.bF.vji(W,V)||W.yf(7)}Hbl(W){if(this.rGe.Wli(W)){var V=!1,ba=!1;if(W.Rb(7)){do{const ha=W.currentNode;if(37===ha.type)switch(ha.getValue(J.a.V6)){case 0:ba=!0;break;case 1:V=!0}}while(W.yi(7))}ba||this.rch(W,0);V||this.rch(W,1)}}rch(W,V){const ba=this.WHj.create(1074135124);ba.setValue(J.a.V6,V);W.Qf(ba,7)}LRn(W){W&&this.t2i(W.fma)}t2i(W){W&&(W=m.SelectionFactory.we(W.Nb.paragraph,W.Nb.cp+1),this.ib.setSelection(W))}ZWm(W){let V=
this.kVj(W);void 0!==V&&null!==V?this.bF.nna(V)&&(V=this.bF.n1h(V)):V=W;return this.dJj(V)}bbo(){this.Nsd?R.Eh.notificationBar.removeEntry(this.Nsd):this.Nsd=R.Eh.notificationBar.sla(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);R.Eh.notificationBar.BA(this.Nsd)}Flk(W,V){W=this.Zc.ZCa(W,37,37);let ba=!1;if(W.Vd()){do{const ha=W.currentNode;this.bF.Cyf(ha)?this.uih(ha,V):ba=!0}while(W.Rj())}ba&&this.bbo()}uih(W,V){N.e(W,ba=>{R.dol(ba,V);return!0},12)}c6l(W,
V){W=this.bF.dKd(W,V);return W?(W=this.Zc.ng(W))?W.$z():!1:!1}XWh(W,V){W=this.bF.dKd(W,V);W=this.Zc.ng(W);if(W.Vd()){do if(V=W.currentNode,1===V.getValue(J.a.gma))return V;while(W.Rj())}return null}static VKc(){return new R(l.AFrameworkApplication.ya,w.App.xa,T.a.instance,v.PageReader.instance,r.a.instance,new M,new z.a,A.OutlineNavigator.VWm,G.WordSectionNavigator.$6e)}static get instance(){return null!=R.Crg?R.Crg:R.Crg=R.VKc()}static get paragraphEditor(){return null!=R.Xug?R.Xug:R.Xug=e.a.instance.resolve("Box4.IParagraphEditor")}static dol(W,
V){V.ehb?R.paragraphEditor.Vp.jca(W,H.OutlineReader.ZN(W)):R.paragraphEditor.Vp.jca(W,0);W=I.a.createTextRange(W,0,K.ParagraphReader.textLength(W));R.ga.Tf(W,F.a.font,2,!0,new a.a,new k.a(V.fontName));R.ga.Tf(W,F.a.Av,2,!0,new a.a,new k.a(V.fontSize))}}R.ga=null;R.Eh=null;Object(D.a)(R,"FootnoteEndnoteEditor",null,[541])},1557:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(l||(l={}));Object(D.b)("SupportStatus",l)},1567:function(D,L,c){c.d(L,"a",function(){return K});D=c(0);var l=c(375),e=c(61),a=c(22),k=c(108),m=c(8),w=c(123),v=c(68),r=c(14),z=c(109),A=c(550),G=c(140),H=c(135),I=c(10);class K{constructor(F,J,N,O,M,T=null,R="",W=!0,V=!1){this.h_a=this.Bde=this.lmb=this.gPi=this.G8d=null;this.XQc=!1;this.Qrf=null;this.rJf=0;this.context=F;this.ye=F.view;this.Jy=
J;this.vd=M;this.LQ=N;this.x8=O;this.pxa=this.failed=!1;this.S2d=null;this.D1a=this.i9b=!1;this.Rbo=K.W2e(F);this.browserName=R;this.prj=W;this.xSc=V;this.fTa=!1;this.g1b=0;if(F=Object(w.a)(105,M)?M:null){this.gPi=new l.DictionaryPropertySet;this.gPi.Hs(F);N=F.ia(k.a.hYc,e.a.nil);this.DDc=N!=e.a.nil?N.toString():e.a.create().toString();if(F.ia(k.a.iLi,!1)){this.i9b=!0;this.D1a=F.ia(k.a.D1a,!1);this.S2d=T;for(T=this.ye.Bb.Lg;T.Hw;)T=T.getContext(0);if(M=Object(v.a)(G.AParagraphNode,T.node)){N=0;O=
I.ParagraphReader.textLength(M);switch(T.contextId){case r.a.Fd:N=T.cpBegin;O=T.cpEnd;break;case r.a.endOfParagraph:N=O}this.G8d=z.FormattingReader.$Jd(T.node,N,T.Fb);m.ULS.shipAssertTag(6305503,307,!!this.G8d);M=H.HyperlinkReader.fLc(M);for(const ba of M)ba.cpEnd<=N||ba.cpBegin>=O||K.hyperlinkEditor.VQ(T.node,ba.hyperlink)}}this.pxa=F.ia(k.a.pxa,!1);this.fTa=F.ia(k.a.fTa,!1);this.lmb=F.ia(k.a.lmb,null)}else this.DDc=e.a.create().toString();J&64&&(this.pxa=!0)}static get hyperlinkEditor(){return null!=
K.iqg?K.iqg:K.iqg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static W2e(F){if(F){if(F.Hw){for(let J=0;J<F.length;J++)if(K.W2e(F.getContext(J)))return!0;return!1}if(Object(w.a)(A.a,F))return K.W2e(F.Yj);if(I.ParagraphReader.ic(F.node)&&F.node.DN)return!0}return!1}}Object(D.a)(K,"ClipboardActionArguments",null,[])},1568:function(D,L,c){c.d(L,"a",function(){return J});D=c(0);var l=c(22),e=c(61),a=c(48),k=c(650),m=c(139),w=c(658),v=c(184),r=c(11),z=c(118),A=c(7),G=c(870),H=c(770),I=c(551),K=c(1503),
F=c(1551);class J{constructor(N,O,M,T,R,W){this.bF=N;this.hJa=M;this.rGe=T;this.hre=R;this.Zc=W}ngm(N,O,M){const T=this.rZh(O,N.node),R=N.node.Jc;if(!R)return null;const W=new a.GraphTransaction(15);W.Eb(N.node);W.Kk=M;M=this.ogm(T,O);J.pgm(M,R,N,O);W.dispose();return M}rZh(N,O){const M=this.Zc.Bk();M.set(O);M.Ab(7);M.kd(7);this.hJa.SZd(M,N);return M}ogm(N,O){const M=H.a.createNode();M.properties.setValue(A.a.V6,O);N.Qf(M,8);this.hre.nSk(M,O);return M}static get characterPropertiesEditor(){return null!=
J.omg?J.omg:J.omg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Oca(){return J.RC||(J.RC=new k.WACStyleSet)}static set Oca(N){J.RC=N}static VKc(){const {FootnoteEndnoteDefaultContentInserter:N}=c(1635);return new J(I.a.instance,K.a.instance,F.a.instance,m.PageReader.instance,N.instance,new w.a)}static get instance(){return null!=J.hsg?J.hsg:J.hsg=J.VKc()}static get mh(){return J.DB||(J.DB=v.PageNavigator.instance)}static set mh(N){J.DB=N}static pgm(N,O,M,T){r.App.yd.Xp&&r.App.yd.Vq.WG(M.node);
const R=new z.a;R.setValue(A.a.W3b,N.id);R.setValue(A.a.V6,T);const W=O.av(R,e.a.create());J.characterPropertiesEditor.Qfa(M,V=>G.a.getInstance(V,W,N.id),J.LTh(M.node,T))}static LTh(N,O){let M=null;(N=J.mh.Wt(N))&&(N=J.Oca.VL(N))&&(M=N.Qua(O?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return M}}J.RC=null;J.DB=null;Object(D.a)(J,"FootnoteEndnoteInserter",null,[684])},1573:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{static SHn(e,
a){l.SFe=e;l.aJe=a}static PHn(e,a){l.ZIe=e;l.iXa=a}static g3h(){return l.ZIe===l.iXa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.iXa,l.SFe,l.aJe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.ZIe,l.iXa,l.SFe,l.aJe)}}l.ZIe=0;l.iXa=0;l.SFe=null;l.aJe=null;Object(D.a)(l,"ReplaceAllContext",null,[])},1593:function(D,L,c){c.r(L);D=c(0);var l=c(1952),e=c(61),a=c(2),k=c(330),m=c(22),w=c(1878),v=c(11),r=c(8),z=c(231),A=c(1954),G=c(13),H=c(18),I=c(1549);class K{constructor(Rb=
"",Ra="",ab=!1,fb=!1){this.fsm=ab;this.Avm=fb;this.actionId=Rb;this.EGa=Ra}}Object(D.a)(K,"SearchEntryPointContext",null,[]);class F{constructor(Rb){this.Rda=null;this.Ku=!1;this.MM=Rb}initialize(){this.qZ();this.jz();this.r6(0)}jz(){this.Rda.jz()}dispose(){this.MM=null}gMc(){return!1}get DF(){return this.Rda?this.Rda.DF:0}r6(Rb){this.Rda.r6(Rb)}get isVisible(){return this.Ku}dTe(Rb){this.Rda&&this.Rda.aQo(Rb)}LVi(Rb){this.Rda&&this.Rda.XYo(Rb)}jqj(Rb){this.Rda&&this.Rda.m1o(Rb)}rsh(){this.Rda&&this.Rda.jRo()}k$d(Rb){this.Rda&&
this.Rda.k$d(Rb)}}Object(D.a)(F,"FindReplacePane",null,[482,9]);var J=c(57),N=c(1377),O=c(1035),M=c(157),T=c(160),R=c(1025),W=c(83),V=c(84),ba=c(80),ha=c(55),ca=c(27),ia=c(442),ra=c(1470),da=c(392),za=c(1482),la=c(704),na=c(85),Ca=c(1065);class Na{constructor(Rb){this.rak=(Ra,ab)=>{this.Osd.ub(Ra)?this.Osd.Z(Ra,ab):this.Osd.add(Ra,ab);(Ra=this.Nsl(Ra))&&this.Ofi(ab,Ra,this.lxh(da.a.getTypeName()))};this.Osd=new na.a;this.$U=new na.a;this.annotationType=ra.RoleDetectionAnnotation.getTypeName();Rb.$xn(this.rak)}mD(Rb,
Ra){let ab;const fb=Rb.parentPath.substr(Rb.parentPath.lastIndexOf("\\")+1),bb=Rb.content;if(!bb||this.fvm(bb))""!==fb&&({value:ab}=this.Osd.Gc(fb,ab)).returnValue&&this.Ofi(ab,Rb,this.lxh(Ra)),Ra===da.a.getTypeName()?(Ra=null,({value:Ra}=this.$U.Gc(fb,Ra)).returnValue?this.$U.Z(fb,Rb):this.$U.add(fb,Rb)):Ra===za.a.getTypeName()&&this.$U.remove(fb)}Ofi(Rb,Ra,ab){const fb=this.$Hl(Ra);Ra=this.Osl(Ra);0<Ra&&Rb(ab,fb,Ra)}Osl(Rb){try{return Number.parseInvariant(Rb.id.substr(2))}catch(Ra){r.ULS.sendTraceTag(554747009,
367,10,Ra.toString())}return-1}Nsl(Rb){let Ra;return({value:Ra}=this.$U.Gc(Rb,Ra)).returnValue?Ra:null}DYc(Rb){if(Rb)for(const Ra of Rb)this.mD(Ra,"AugLoop_Core_AddOperation")}$Hl(Rb){if(Rb=Rb.content)switch(Rb.roleType){case ra.RoleType.Heading1:return 1;case ra.RoleType.Heading2:return 2;case ra.RoleType.Heading3:return 3;case ra.RoleType.Heading4:return 4;case ra.RoleType.Heading5:return 5;case ra.RoleType.Heading6:return 6;case ra.RoleType.Heading7:return 7;case ra.RoleType.Heading8:return 8;
case ra.RoleType.Heading9:return 9}return-1}fvm(Rb){Rb=Rb.roleType;return Rb===ra.RoleType.Heading1||Rb===ra.RoleType.Heading2||Rb===ra.RoleType.Heading3||Rb===ra.RoleType.Heading4||Rb===ra.RoleType.Heading5||Rb===ra.RoleType.Heading6||Rb===ra.RoleType.Heading7||Rb===ra.RoleType.Heading8||Rb===ra.RoleType.Heading9}lxh(Rb){if(Rb===da.a.getTypeName()||Rb===la.a.getTypeName())return Ca.a.MSe;if(Rb===za.a.getTypeName())return Ca.a.jDd;throw Error.create("Invalid operation type");}}Object(D.a)(Na,"RoleDetectionAnnotationHandler",
null,[220]);var Ta=c(162),Fa=c(74),qa=c(1124),ja=c(54),X=c(82),ua=c(52),Ha=c(194),Ea=c(184),wa=c(559);class sa extends Ha.a{constructor(Rb,Ra){super(Rb,Ra,v.App.z4);this.VVd=null;this.ihb=this.p_b=0;this.headingsReady=!1;this.WQa=this.Ccb=0;this.Rui=!1;this.kXg=this.hNg=this.xJg=null}get BVd(){return!0}get ILh(){return this.xJg}get f_d(){return this.kXg}usj(){this.headingsReady&&(this.hNg.style.display="none",this.ihb||this.p_b?(this.ILh.style.display="none",this.container.style.display="block"):
(this.container.style.display="none",this.ILh.style.display="block"))}get $Z(){return super.$Z|240}static f5e(Rb,Ra,ab){var fb=v.App.xa.jb.Yc;if(fb&&(fb=Ea.PageNavigator.instance.dQ(fb))){const bb=new sa(new wa.a,m.a.instance.resolve("Box4.IHtmlViewRootFactory"));bb.ihb=0;bb.p_b=0;bb.VVd=null;bb.Icb(Rb);bb.xJg=Ra;bb.hNg=ab;bb.MB(fb);bb.headingsReady=!0;bb.usj();bb.kXg=null;return bb}return null}}Object(D.a)(sa,"WordNavigationPaneHeadingsView",Ha.a,[498,232,38,9]);class fa{constructor(Rb){this.$U=
new na.a;this.zYg=Rb}mD(Rb,Ra){Ra===da.a.getTypeName()?(Ra=null,({value:Ra}=this.$U.Gc(Rb.id,Ra)).returnValue?this.$U.Z(Rb.id,Rb):this.$U.add(Rb.id,Rb)):Ra===za.a.getTypeName()&&this.$U.remove(Rb.id);this.zYg&&this.zYg()}DYc(Rb){if(Rb)for(const Ra of Rb)this.mD(Ra,da.a.getTypeName())}n4b(){var Rb;const Ra=[];if(0<(null===(Rb=this.$U)||void 0===Rb?void 0:Rb.count))for(const ab of this.$U.values)Ra.push(ab);return Ra}}Object(D.a)(fa,"ContractEntityAnnotationHandler",null,[220]);var Ma=c(3);class Ua{constructor(Rb){this.ga=
Rb}N1m(){this.cancelSearch()}Q3m(Rb){this.ga.Ub(H.a.sNd,2,Rb)}DMf(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Ma.a.Iyb,2)}R8m(){this.ga.processAction(Ma.a.findOnPage,2)}onSearchQueryChanged(Rb){this.ga.Ub(Ma.a.VGd,2,Rb)}w$m(){this.ga.processAction(H.a.replace,2)}x$m(){this.ga.processAction(H.a.replaceAll,2)}s$m(){this.ga.processAction(G.a.Tcf,2)}t$m(){this.ga.processAction(G.a.gdf,2)}v$m(){this.ga.processAction(Ma.a.c5d,2)}u$m(){this.ga.processAction(Ma.a.s_d,2)}Pdc(Rb){this.ga.Ub(H.a.Pdc,
2,Rb)}}Object(D.a)(Ua,"FindReplaceActions",null,[497]);var Qa=c(333);class Ja{}Ja.EO=Qa.a.ofb;Ja.Icc=0;Ja.Lta="FindReplaceTaskPaneData";Ja.aR=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(D.a)(Ja,"FindReplaceConstants",null,[]);var Wa=c(765);class Ya{glj(Rb){var Ra,ab,fb;return ia.a.wgb(null===(fb=null===(ab=null===(Ra=v.App.xa)||void 0===Ra?void 0:Ra.jb)||void 0===ab?void 0:ab.Yc)||void 0===fb?void 0:fb.Bd,Rb)}clearSelection(){if(this.HBe){const Rb=this.glj(this.HBe);Rb&&Rb.Bea()}this.HBe=
this.v4g=null}CRn(Rb){this.clearSelection();if(Rb){const Ra=this.glj(Rb.parentPath);if(Ra){const ab=Rb.content;ab&&(this.v4g=Rb.id,Ra.Oha([new Wa.a(ab.range.start,ab.range.start+ab.range.length)]),Ra.QDf(0,1));this.HBe=Rb.parentPath}}}}Object(D.a)(Ya,"RangeAnnotationContentSelector",null,[]);var sb=c(1573);class ob{constructor(Rb){this.xTj=Rb}get Mj(){return this.xTj.value}rLl(Rb){Rb=this.Mj.c0a(Rb);return this.Oom(Rb)?null:Rb}Oom(Rb){return Rb.id===this.Mj.OCa.id}static get instance(){return null!=
ob.Vqg?ob.Vqg:ob.Vqg=ob.kE()}static kE(){const Rb=new z.a(()=>w.FindManager.instance.Mj);return new ob(Rb)}}Object(D.a)(ob,"SearchResultOrder",null,[]);var fc=c(10),Eb=c(277);class Ib{constructor(Rb){this.bCe=Rb}get PRa(){return this.bCe.value}getSelectedText(){var Rb=this.PRa.lfa;if(Rb){const Ra=Rb.cpBegin,ab=Rb.cpEnd-Ra;if(0<ab&&(Rb=Rb.node,fc.ParagraphReader.ic(Rb)))return Rb.characterData.substr(Ra,ab)}return null}static getInstance(){return Ib.Jl()}static Jl(){const Rb=new z.a(()=>Eb.a.instance);
return new Ib(Rb)}}Object(D.a)(Ib,"SelectionHelper",null,[]);var Nb=c(28),pb=c(134),Aa=c(415),xb=c(851),gb=c(254),Xa=c(394),Va=c(1799),Gb=c(395);class Xb extends Ha.a{constructor(Rb,Ra,ab){super(Rb,Ra,v.App.z4);this.n4a=ab;this.k$h=!1}get BVd(){return!0}get $Z(){return super.$Z|248}static f5e(Rb){var Ra=v.App.xa.jb.Yc;const ab=Gb.a.instance.Qc(3);return Ra&&(Ra=Ea.PageNavigator.instance.dQ(Ra))?(Rb=new Xb(new wa.a,m.a.instance.resolve("Box4.IHtmlViewRootFactory"),Rb),ab.Dgc(Rb.Sb),Rb.MB(Ra),ab.dispose(),
Rb.k$h=!0,Rb):null}}Object(D.a)(Xb,"WordNavigationPaneReactHeadingsView",Ha.a,[232,38,9]);class rc extends F{constructor(Rb,Ra,ab,fb,bb,Ub,Oa,Fc,xc,pd,lb,Tb,pc){var Db,Ob,jb;super(Rb);this.Jrb=Ja.EO;this.E4j="FindReplaceTaskPaneProps";this.Vb=J.FocusManager.instance();this.XTa=this.OKa=this.RY=this.mNe=null;this.xQb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.F$c=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.skd=(null===(Db=a.AFrameworkApplication.K)||void 0===
Db?void 0:Db.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(Ob=a.AFrameworkApplication.K)||void 0===Ob?void 0:Ob.$("NavPaneReactHeadings"));this.iVj=null===(jb=a.AFrameworkApplication.K)||void 0===jb?void 0:jb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.Uoj=()=>{this.isVisible&&this.pCd===A.a.intelligentPlaceholder&&this.ym()};this.xA=new N.a;this.dMg=Ra;this.CIa=A.a.headings;this.Hzc=l.a.initial;this.Vqa=new X.a;this.$O=
"";this.Ypc={matchCase:!1,matchWholeWord:!1};this.$Ie="";this.NKe=null;this.Y1=ab;this.f6g=!1;this.cbb=fb;this.ib=bb;this.xVj=Ub;this.IAa=Oa;this.VH=Fc;this.rld=!0;this.I5=this.H5=!1;this.wf=xc;this.LG=pd;this.Gb=lb;this.Q4=Tb;this.kFg=pc;this.Wme&&this.IAa.GBn(()=>{this.ym()})}get VNe(){return 1}get Wme(){return this.xQb&&this.F$c&&!!this.wf}get Xme(){return this.xQb&&this.iVj&&!!this.wf}get headingsReady(){return this.skd?this.LG.headingsReady:this.ufd?this.ufd.headingsReady:!1}set headingsReady(Rb){this.skd?
this.LG.headingsReady=Rb:this.ufd&&(this.ufd.headingsReady=Rb)}get pCd(){return this.CIa}dbj(){this.CIa=A.a.headings;this.ym()}D9n(){this.CIa=A.a.contracts;this.ym()}Waj(){this.CIa=A.a.find;ha.a("NavigationPaneFind");this.ym()}Nbj(){this.CIa=A.a.replace;this.ym()}qbj(){this.CIa=A.a.intelligentPlaceholder;this.ym()}S3c(Rb){this.f6g=Rb;this.ym()}gMc(){return this.pCd===A.a.replace}get DF(){return this.Hzc}r6(Rb){this.Hzc=Rb;this.ym()}dTe(Rb){this.uck(Rb);this.ym()}uck(Rb){const Ra=this.xVj(Rb[Rb.length-
1]);if(Ra){let ab=-1;for(let fb=0;fb<this.Vqa.count;fb++)if(Ra.id===this.Vqa.J(fb).id){ab=fb;break}-1===ab?r.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Vqa.VA(ab,this.Kxh(Rb))}else this.Vqa.addRange(this.Kxh(Rb))}LVi(Rb){for(const Ra of Rb)for(Rb=this.Vqa.count-1;0<=Rb;Rb--)if(this.Vqa.J(Rb).id===Ra.id){this.Vqa.removeAt(Rb);break}this.ym()}jqj(Rb){for(const Ra of Rb)for(Rb=this.Vqa.count-1;0<=Rb;Rb--)if(this.Vqa.J(Rb).id===Ra.id){this.Vqa.Z(Rb,this.Jxh(Ra));
break}this.ym()}rsh(){this.Vqa.clear();this.NKe=null;this.ym()}k$d(Rb){this.NKe=Rb?Rb.id:null;this.ym()}Kxh(Rb){if(!Rb)return new X.a;const Ra=new X.a;for(const ab of Rb)Ra.add(this.Jxh(ab));return Ra}Jxh(Rb){const Ra=this.cbb.ZBd(Rb);return{id:Rb.id,searchBeginIndex:Ra.g9d,searchEndIndex:Ra.e9d,searchResult:Ra.OAd}}Ahe(){}dBo(){var Rb={};this.MM.Pdc(Rb);Rb=Rb[O.a.Value];this.mNe=ca.c(Rb)?"":Rb;this.ym()}ONa(){return this.$O}cDb(){return this.$Ie}d2f(Rb){this.$O=Rb;this.ym()}clearSearch(){}initialize(){this.kqd=
window.performance.now();const Rb=this.Vb.le(this.Jrb);Rb.parent=M.AFrame.Hp;Rb.BK=!0;this.qZ();this.r6(l.a.initial)}wO(){this.isVisible?(r.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),T.UISurfaces.wu().then(Rb=>{Rb.setSelectedTaskPane(this.Jrb,this.VNe);this.D8();this.rld&&this.r7i(!0);return null}).catch(Rb=>{rc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Rb)})):(this.Y3c(),this.rld&&this.r7i(!1))}r7i(Rb){const Ra=
this.dMg();Ra?this.$O=Ra:Rb&&this.$O||(this.$O="");this.MM.onSearchQueryChanged(this.$O)}Tma(){T.UISurfaces.wu().then(Rb=>{Rb.hideTaskPane(this.Jrb,this.VNe);return null}).catch(Rb=>{rc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Rb)})}qZ(){this.Y1.yMa();this.RY=this.Y1.D1b(this.Vb);this.dak()}Y3c(){T.UISurfaces.wu().then(Rb=>{this.kqd=window.performance.now();Rb.showTaskPane(this.Jrb,this.Pz());Rb=[Object.assign(new Nb.a,{name:"Tab",string:this.CIa})];const Ra=window.performance.now()-
this.kqd;ha.a("NavigationPaneOpen",!0,Ra,Rb);return null}).catch(Rb=>{rc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Rb)})}ym(){T.UISurfaces.wu().then(Rb=>{Rb.updateTaskPane(this.Jrb,this.Pz());return null}).catch(Rb=>{rc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Rb)})}Pz(){const Rb={activeTab:A.a.initial};this.xA.gMb(Rb);return Object.assign(new R.a,{title:Ja.aR,hideHeader:!1,width:320,location:this.VNe,contentProps:Rb,onOpen:()=>{this.Ku=
!0;this.eBn();this.myn();this.rld&&this.D8();v.App.xa.updateCommandUI();v.App.xa.MXa(this.Uoj)},onClose:()=>{try{const Ra=window.performance.now();this.kca();this.Ku=!1;this.Hto();this.juo();this.MM.DMf();this.mNe="";this.Hzc=l.a.initial;v.App.xa.wec(this.Uoj);v.App.xa.updateCommandUI();const ab=window.performance.now()-Ra;ha.a("NavigationPaneClose",!0,ab)}catch(Ra){rc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ra)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,
isModernPane:!0})}eBn(){this.Wme&&!this.OKa&&ia.a.nm().then(()=>{this.OKa=new Na(this.IAa);this.wf.mb(this.OKa,this.OKa.annotationType);this.wf.getAnnotationsByType(this.OKa.annotationType).then(Rb=>{this.OKa.DYc(Rb)})})}juo(){this.Wme&&this.OKa&&(this.wf.sc(this.OKa,this.OKa.annotationType),this.OKa=null)}upo(){if(this.Xme){var Rb=new Va.ContractEntitySignal;Rb=Object.assign(new xb.a,{parentPath:["Signal",gb.a.getTypeNameFor(Rb)],items:[Object.assign(new Xa.a,{body:Rb})]});this.Q4.getAugLoopRuntimeManager().submitOperation(Object.assign(new Aa.a,
{operation:Rb}))}}myn(){this.Xme&&!this.XTa&&ia.a.nm().then(()=>{this.XTa=new fa(this.ym);this.wf.mb(this.XTa,Va.ContractEntityAnnotation.getTypeName());this.upo();this.wf.getAnnotationsByType(Va.ContractEntityAnnotation.getTypeName()).then(Rb=>{this.XTa.DYc(Rb)})})}Hto(){this.Xme&&this.XTa&&(this.wf.sc(this.XTa,Va.ContractEntityAnnotation.getTypeName()),this.XTa=null)}dak(){this.xA.MK(this.FCl());this.xA.MK(this.HCl());this.xA.MK(this.aFl());this.xA.MK(this.iyl());this.xA.MK(this.SGl());this.xA.MK(this.jrl());
this.xA.MK(this.onLinkExecute());this.xA.MK(this.onPivotTabExecute());this.xA.MK(this.WTl());this.xA.MK(this.CWl());this.xA.MK(this.yGl());this.xA.MK(this.rXl());this.xA.MK(this.kRl())}rXl(){return Rb=>{Rb.autoDetectedHeadingsToggleDisabled=this.IAa?!this.IAa.Lpk():!0}}CWl(){return Rb=>{Rb.type=this.E4j}}onLinkExecute(){return Rb=>{Rb.onLinkExecute=()=>{this.MM.R8m()}}}onPivotTabExecute(){return Rb=>{Rb.onPivotTabExecute=Ra=>{switch(Ra){case A.a.headings:this.dbj();break;case A.a.replace:this.Nbj();
break;case A.a.contracts:this.D9n();break;case A.a.intelligentPlaceholder:this.qbj();break;default:this.Waj()}ca.b(this.$O)&&(this.$O=this.dMg(),this.$O||(this.$O=""),ca.b(this.$O)||(this.MM.onSearchQueryChanged(this.$O),this.ym()))}}}WTl(){return Rb=>{Rb.showOutOfSyncNotification=this.f6g}}HCl(){return Rb=>{Rb.findSearchBoxContent={onSearchQueryChanged:Ra=>{this.$O=Ra;this.ym();this.MM.onSearchQueryChanged(Ra)},findOptions:this.Ypc,matchCase:this.H5,matchWholeWord:this.I5,findSearchText:this.$O,
onClearButtonExecute:()=>{void 0!==this.$O&&null!==this.$O&&""!==this.$O&&(this.$O="",this.ib.setSelection(null),this.MM.N1m())},onMatchCaseExecute:()=>{this.Ypc.matchCase=!this.Ypc.matchCase;this.H5=!this.H5;this.ym();this.MM.s$m()},onMatchWholeWordExecute:()=>{this.Ypc.matchWholeWord=!this.Ypc.matchWholeWord;this.I5=!this.I5;this.ym();this.MM.t$m()},onMenuClose:()=>{if(this.RY)this.RY.onMenuClose()},onMenuOpen:()=>{if(this.RY)this.RY.onMenuOpen()}}}}jrl(){return Rb=>{Rb.activeTab=this.pCd}}yGl(){return Rb=>
{Rb.autoDetectedHeadingsToggleState=this.IAa?this.IAa.OWe:!1;this.LG.iIc=Rb.autoDetectedHeadingsToggleState;!Rb.autoDetectedHeadingsToggleState&&this.IAa&&this.IAa.Tic(!1)}}FCl(){return Rb=>{const Ra={onReplaceAllExecute:()=>{this.MM.x$m()},onReplaceExecute:()=>{this.MM.w$m()},onReplaceQueryChanged:ab=>{this.$Ie=ab;this.ym()},replaceSearchText:this.$Ie};Rb.findReplaceContent={searchResults:this.Vqa.toArray(),replaceSearchBoxContent:Ra,onNextSearchResultExecute:()=>{this.MM.u$m()},onPrevSearchResultExecute:()=>
{this.MM.v$m()},onSearchResultSelected:ab=>{const {FindReplaceUIManager:fb}=c(1593);this.MM.Q3m(ab);fb.uui(1)},selectedResultId:this.NKe,summaryLabel:this.mNe,explanationText:this.ZBl(this.Hzc),haveTooManySearchResults:this.Hzc===l.a.tooManyResults}}}ZBl(Rb){switch(Rb){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return sb.a.g3h();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;
default:return""}}kRl(){return Rb=>{Rb.replaceFollowUpsWithCommentsIsEnabled=!0}}SGl(){return Rb=>{var Ra=this.VH.Zrl();const ab=[];for(const fb of Ra)Ra=this.VH.xId(fb.Jc,fb.id),ab.push({id:fb.id.toString(),intelligentPlaceholderAnchorText:Ra});Rb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:ab,onIntelligentPlaceholderInputExecute:fb=>{this.$O=fb;this.CIa=A.a.find;this.ym();this.MM.onSearchQueryChanged(fb)},onSearchResultSelected:fb=>{this.ym();fb=e.a.Gf(fb);this.VH.MRn(fb)}}}}aFl(){return Rb=>
{let Ra=()=>{};this.IAa&&(Ra=Object(ua.a)(this.IAa,this.IAa.Tic,"toggleAutoDetectedHeadings"));Rb.headingsContent={onHeaderInputExecute:ab=>{this.$O=ab;this.CIa=A.a.find;this.ym();ha.a("NavigationPaneFind");this.MM.onSearchQueryChanged(ab)},renderHeadingContent:(ab,fb,bb)=>{this.Gb.Xb(new W.a(0,1,100,()=>{var Ub=window.performance.now()-this.kqd;if(this.skd){var Oa=this.LG.l8;this.headingsReady=!0;this.ym();bb.style.display="none";Oa.first&&(ab.style.display="block");this.Gb.Xb(new W.a(1,1,0,()=>
{Xb.f5e(this)}))}else this.ufd=sa.f5e(ab,fb,bb),this.ym();Oa=window.performance.now()-this.kqd;ha.a("NavigationPaneHeadingsLoaded",!0,Oa,[Object.assign(new Nb.a,{name:"NavPaneReactHeadings",bool:this.skd})]);Ub=[Object.assign(new Nb.a,{name:"HeadingFetchStart",double:Ub}),Object.assign(new Nb.a,{name:"HeadingFetchFinished",double:Oa})];ha.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Ub)}))},autoDetectedHeadingsToggle:Ra,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,
headingsList:this.LG.l8,onHeadingChevronClick:ab=>{this.LG.vel(ab);this.ym()},onClickHeading:ab=>{if(this.Gb.Zu){r.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",ab);const fb=window.performance.now();this.Gb.Xb(new W.a(0,1,0,()=>{this.LG.onClickHeading(ab);this.ym();const bb=window.performance.now()-fb;ha.a("NavigationPaneAsyncOnClickHeadingItem",!0,bb)}))}else this.LG.onClickHeading(ab),this.ym()},onClickBookmark:ab=>
{if(this.Gb.Zu){r.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",ab);const fb=window.performance.now();this.Gb.Xb(new W.a(0,1,0,()=>{this.LG.onClickBookmark(ab);this.ym();const bb=window.performance.now()-fb;ha.a("NavigationPaneAsyncOnClickHeadingItem",!0,bb)}))}else this.LG.onClickBookmark(ab),this.ym()},onShareHeadingClick:ab=>{this.LG.onShareHeadingClick(ab)},bookmarkIconUrl:Ta.a.Yh("BookmarkDefault.png")}}}hyl(){var Rb,
Ra=null===(Rb=this.XTa)||void 0===Rb?void 0:Rb.n4b();if(Ra){Rb=Array(Ra.length);let ab=0;for(const fb of Ra)(Ra=fb.content)&&(Rb[ab++]={id:fb.id,type:Ra.type,value:Ra.value});return Rb}return null}iyl(){return Rb=>{Rb.contractsContent={onHeaderInputExecute:Ra=>{this.$O=Ra;this.CIa=A.a.find;this.ym();ha.a("NavigationPaneFind");this.MM.onSearchQueryChanged(Ra)},contractEntities:this.hyl(),selectedEntityId:this.kFg.v4g,onEntitySelected:Ra=>{var ab;const fb=null===(ab=this.XTa)||void 0===ab?void 0:ab.n4b();
if(fb)for(const bb of fb)if(bb.id===Ra){this.kFg.CRn(bb);break}this.ym()}}}}J6i(Rb){this.rld=Rb}nzo(Rb){this.Gb.Xb(new W.a(0,1,0,()=>{this.LG.Rcg(Rb)&&this.ym()}))}x2l(Rb){this.Gb.Xb(new W.a(0,1,0,()=>{const Ra=this.LG.YJb;this.LG.I1k(Rb)?this.ym():0===this.LG.YJb&&0<Ra&&this.ym()}))}acg(Rb,Ra){this.Gb.Xb(new W.a(0,1,0,()=>{const ab=this.LG.YJb;this.LG.acg(Rb,Ra)?this.ym():0<this.LG.YJb&&0===ab&&this.ym()}))}b1k(Rb){this.Gb.Xb(new W.a(0,1,0,()=>{const Ra=this.LG.YJb;this.LG.c1k(Rb)?this.ym():0===
this.LG.YJb&&0<Ra&&this.ym()}))}x2n(Rb){this.LG.gno(Rb);this.ym()}ycg(Rb){this.LG.ycg(Rb)&&this.ym()}y7e(Rb){this.LG.y7e(Rb)&&this.ym()}Mon(){return 0<this.LG.YJb}D8(){this.Vb.Dg(this.Jrb);r.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}kca(){if(this.i2a()){var Rb;(Rb=Fa.InteractiveViewManager.instance.od)?(Rb=Rb.vI,r.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Rb=this.Vb.QS,r.ULS.sendTraceTag(40469192,312,50,
"Taskpane now hidden with focus on default scope."));this.Vb.Dg(Rb)}}i2a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===this.Jrb}static getInstance(){return rc.Jl()}static Jl(){return new rc(new Ua(a.AFrameworkApplication.ya),Object(ua.a)(Ib.getInstance(),Ib.getInstance().getSelectedText,"getSelectedText"),qa.a.instance,I.a.instance,ja.a.instance,Object(ua.a)(ob.instance,ob.instance.rLl,"getNextSearchResult"),m.a.instance.Pa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
m.a.instance.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),m.a.instance.Pa("Box4.AugmentationLoop.IAnnotationStorage"),m.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),V.a.instance,m.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new Ya)}static recordQosError(Rb,Ra,ab){const fb=Object.assign(new pb.a,{extendedProperties:new Map});ab&&fb.extendedProperties.set("exception",ab);ba.Health.instance.recordQosError(Rb,Ra,!1,!0,!1,!1,fb)}}Object(D.a)(rc,
"ReactFindReplacePane",F,[481,482,9]);var qb=c(1535);c.d(L,"FindReplaceUIManager",function(){return Zb});class Zb{constructor(Rb,Ra,ab=null,fb=null,bb=null,Ub=null){this.Sbd=this.w1=0;this.I5=this.H5=this.wwb=!1;this.Wl=this.LXg=this.Nia=null;this.nEa=this.Vze=!1;this.hj=Rb;this.Lp=ab;this.cbb=fb;this.wUg=bb;this.je=Ub;Zb.L_b=new K}get Wxf(){return this.Vze}set Wxf(Rb){Rb!==this.Vze&&(this.Vze=Rb,this.jrh())}mbe(Rb){this.w1=Rb;this.update();this.w1||this.DF!==l.a.searchComplete&&this.DF!==l.a.tooManyResults?
0<this.w1&&this.DF===l.a.noMatchesFound?this.r6(l.a.searchComplete):this.w1>Zb.Vij&&this.DF!==l.a.tooManyResults&&(r.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.r6(l.a.tooManyResults)):this.r6(l.a.noMatchesFound)}K$d(Rb){this.Sbd=Rb;this.nEa&&this.update();this.wUg&&!this.wUg.value.B0c&&this.z1f()}reset(){}edf(){this.je&&(this.Wl=this.je.jg("UserAction","Find"));if(this.nEa||!this.DF)this.nEa=!1,r.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.r6(l.a.searching)}F3b(){var Rb;
this.nEa=!0;let Ra=this.w1?l.a.searchComplete:l.a.noMatchesFound;if(this.DF!==l.a.tooManyResults&&w.FindManager.instance){const ab=w.FindManager.instance.Mj;0<ab.ria&&(ab.ria>Zb.Vij?Ra=l.a.tooManyResults:this.mAo(ab))}this.r6(Ra);this.update();this.Wl&&(this.Wl.stop(),this.Wl=null);Zb.Z1i=e.a.create().toString();Zb.uui(0,this.geb,this.ONa().length,this.w1);Object(qb.b)()&&(null===(Rb=this.hj)||void 0===Rb?0:Rb.isVisible)&&(Rb={},a.AFrameworkApplication.ya.Ub(G.a.E6d,2,Rb),Rb[k.a.On]&&a.AFrameworkApplication.ya.Ub(G.a.BRd,
2,{CommandValueId:{query:this.ONa(),matchCase:this.H5,matchWholeWordOnly:this.I5,totalResultLimit:-1}}))}mAo(Rb){const Ra=Rb.OCa;let ab=Ra;const fb=[];do fb[fb.length]=ab,ab=Rb.c0a(ab);while(Ra!==ab);this.hj.dTe(fb);this.Nia&&this.hj.k$d(this.Nia)}update(){this.hj&&this.hj.dBo()}get DF(){return this.hj.DF}get geb(){return this.hj.pCd}Rmb(Rb){this.Wxf=Rb}jrh(){if(this.Wxf)switch(this.DF){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.hj.S3c(!0)}else this.hj.S3c(!1)}r6(Rb){if(this.hj.isVisible){switch(Rb){case l.a.noMatchesFound:case l.a.searchComplete:this.DF===
l.a.tooManyResults&&(Rb=l.a.tooManyResults)}this.hj&&(this.hj.r6(Rb),this.jrh());this.update();this.z1f()}}mNa(Rb,Ra){const ab=this.nEa&&this.DF!==l.a.tooManyResults;switch(Rb){case 0:ab&&this.hj.dTe(Ra);break;case 1:ab&&this.hj.LVi(Ra);break;case 4:ab&&this.hj.jqj(Ra);break;case 2:this.hj.rsh();break;case 3:this.Nia=Ra[0],ab&&0<this.w1&&this.hj.k$d(this.Nia)}}get matchCase(){return this.H5}set matchCase(Rb){this.H5!==Rb&&(this.H5=Rb,this.uoj())}get matchWholeWord(){return this.I5}set matchWholeWord(Rb){this.I5!==
Rb&&(this.I5=Rb,this.uoj())}uoj(){this.hj.Ahe()}ONa(){return this.hj.ONa()}cDb(){return this.hj.cDb()}d2f(Rb){this.hj.d2f(Rb)}clearSearch(){this.hj.clearSearch()}get Obj(){return 0<this.w1&&this.DF!==l.a.replaceAllInProgress&&this.DF!==l.a.replaceAllComplete}iVn(Rb){let Ra="";Rb?Ra=0<this.w1?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.ONa(),this.cDb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.ONa(),this.cDb()):
Rb||0<this.w1&&(Ra=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.z1f(Ra)}dispose(){this.hj.dispose()}gMc(){return this.hj.gMc()}b_n(Rb,Ra=!0){Rb!==this.geb&&(Rb===A.a.headings?(r.ULS.sendTraceTag(9056651,367,50,""),this.hj.dbj()):Rb===A.a.find?this.hj.Waj():Rb===A.a.replace?this.hj.Nbj():Rb===A.a.intelligentPlaceholder&&(Ra||this.hj.J6i(Ra),this.hj.qbj()))}mB(Rb,Ra=!0){this.hj.J6i(Ra);Rb?(this.wwb||this.xsf(),this.hj.wO(),this.w1||this.DF===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.hj.r6(l.a.searchComplete):this.r6(l.a.initial)):this.hj.Tma()}xsf(){this.wwb||(this.hj.initialize(),this.wwb=!0)}z1f(Rb=""){var Ra=this.zRl();Ra&&(Rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Rb,Ra));this.cbb&&Ra&&this.Nia&&this.DF!==l.a.tooManyResults&&this.DF!==l.a.replaceAllInProgress&&(Ra=this.cbb.ZBd(this.Nia),Rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Rb,Ra.OAd));(Ra=this.YBl())&&(Rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Rb,Ra));this.Lp&&Rb&&this.LXg!==Rb&&(this.LXg=Rb,this.Lp.sendNotification(Rb,!0))}zRl(){let Rb="";switch(this.DF){case l.a.startSearch:Rb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:Rb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.Sbd,this.w1);break;case l.a.tooManyResults:this.nEa&&(Rb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.Sbd,this.w1));break;case l.a.noMatchesFound:Rb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:Rb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:Rb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Rb}YBl(){let Rb="";switch(this.DF){case l.a.initial:Rb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.zCl());break;case l.a.noMatchesFound:Rb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:Rb=sb.a.g3h();break;case l.a.tooManyResults:Rb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Rb}zCl(){let Rb="";this.H5&&this.I5?Rb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.H5?Rb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.I5&&(Rb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Rb}static getInstance(Rb){return Zb.Jl(Rb)}static Jl(Rb){const Ra=rc.getInstance();return new Zb(Ra,Rb,m.a.instance.resolve("Common.Utils.IAriaNotifier"),I.a.instance,new z.a(()=>w.FindManager.instance.UKb),v.App.xa.tq)}static uui(Rb,Ra=-1,ab=-1,fb=-1){r.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Rb,["SearchComplete.ResultsCount"]:fb,
["SearchOpsCorrelation"]:Zb.Z1i,["ActionId"]:Zb.L_b.actionId,["SourceControlId"]:Zb.L_b.EGa,["IsNavPanOpenedAlready"]:Zb.L_b.fsm,["IsSearchFromNavPane"]:Zb.L_b.Avm,["CurrentTab"]:Ra,["QueryLength"]:ab})}static Nxk(Rb,Ra,ab){Ra=void 0!==Ra&&null!==Ra?void 0===Ra.SourceControlId||null===Ra.SourceControlId?"Unknown":Ra.SourceControlId:Rb===H.a.lnb?"FindKeyboardShorcut":Rb===H.a.nnb?"ReplaceKeyboardShorcut":"Unknown";switch(Rb){case H.a.dhc:Rb="ShowHeadingsPane";break;case H.a.lnb:Rb="ShowFindPane";break;
case H.a.nnb:Rb="ShowReplacePane";break;case H.a.hhc:Rb="ShowIntelligentPlaceholderPane";break;case H.a.i6a:Rb="ToggleNavigationPane";break;default:Rb="Unknown"}Zb.L_b=new K(Rb,Ra,ab,!0)}}Zb.Vij=100;Zb.Z1i=null;Zb.L_b=null;Object(D.a)(Zb,"FindReplaceUIManager",null,[461,165,9])},1594:function(D,L,c){c.r(L);D=c(0);var l=c(157),e=c(86),a=c(65),k=c(2),m=c(22),w=c(57),v=c(1068),r=c(131),z=c(11),A=c(8),G=c(18),H=c(333),I=c(499),K=c(1503),F=c(1761),J=c(23),N=c(293),O=c(6),M=c(478),T=c(19),R=c(273),W=c(54),
V=c(551),ba=c(1636);class ha{constructor(Ya,sb,ob,fc,Eb,Ib,Nb,pb){this.wXg=this.R0g=this.lLg=this.GG=this.B7a=this.TPb=this.Jue=this.Dqe=this.kse=this.$M=this.M5=this.P5=null;this.nhe=()=>{const Aa=this.Xja.sCb(this.GG),xb=this.Xja.JDl(this.GG);this.Dqe.innerText=Aa.toString();this.Jue.innerText=xb.toString();F.a.ULb(this.P5,1===Aa?!1:!0);F.a.ULb(this.M5,Aa===xb?!1:!0)};this.CXn=()=>{const Aa=this.Vb.getRegion(H.a.p_a);let xb;if(this.AV)if(this.$M&&!this.$M.disabled)xb=this.$M;else if(this.P5.disabled){if(this.M5.disabled)return;
xb=this.M5}else xb=this.P5;else if(this.M5.disabled)if(this.P5.disabled)if(this.$M&&!this.$M.disabled)xb=this.$M;else return;else xb=this.P5;else xb=this.M5;xb.focus();Aa.Xj.vy(xb)};this.Ioa=(Aa,xb)=>{(Aa=xb.Ll.kb)&&this.$M&&F.a.ULb(this.$M,T.SelectionEditor.om(Aa)?!0:!1)};this.C0e=()=>{if(!this.M5.disabled){const Aa=this.Xja.oib(this.GG)?G.a.VHf:G.a.UHf;this.ga.processAction(Aa,2)}return!0};this.D0e=()=>{if(!this.P5.disabled){const Aa=this.Xja.oib(this.GG)?G.a.XHf:G.a.WHf;this.ga.processAction(Aa,
2)}return!0};this.B0e=()=>{this.$M&&!this.$M.disabled&&this.ga.processAction(G.a.fri,2);return!0};this.Vb=Ya;this.ga=fc;this.qg=Eb;this.ie=Ib;this.ib=Nb;this.Xja=ob;this.B6=document.createElement("div");this.B6.classList.add("FootnoteEndnoteActionBarControl");this.AV=pb;this.B6.style.zIndex=String(R.a.AEd);this.B6.style.position="relative";this.Soc=document.createElement("div");this.Soc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.AV=pb;this.B6.appendChild(this.Soc);this.OQk();
this.B6.appendChild(this.TPb);this.B6.appendChild(this.B7a);this.JY=e.KeyInputManager.lc(a.a.A0,0);this.Adm();this.zdm()}efa(Ya){A.ULS.shipAssertTag(4520065,308,this.Xja.nna(Ya));if(this.GG!==Ya){this.GG=Ya;this.nhe();Ya=this.Xja.oib(this.GG);this.lTk(Ya);this.GG.ffh(this.nhe);let sb,ob;this.AV&&(sb=this.Xja.sCb(this.GG)-1,ob=this.Xja.sCb(this.GG)+1);Ya?(this.M5.title=this.AV&&!this.M5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,ob.toString()):WordEditorIntl.WordEditorStrings.L_NextFootnote,
this.P5.title=this.AV&&!this.P5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,sb.toString()):WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.M5.title=this.AV&&!this.M5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,ob.toString()):WordEditorIntl.WordEditorStrings.L_NextEndnote,this.P5.title=this.AV&&!this.P5.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,sb.toString()):WordEditorIntl.WordEditorStrings.L_PrevEndnote);
this.VFa()}}uAb(){this.GG&&(this.$M&&this.$M.parentNode===this.TPb&&this.TPb.removeChild(this.$M),this.zia(),this.GG.HFn(this.nhe),this.GG=null)}dispose(){this.Vb.le(H.a.p_a).Mr(this.JY)}lTk(Ya){3===this.ga.mode&&(Ya=Ya?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.$M=this.I3e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Ya,null),J.a.Tq(this.$M,J.a.pea,Ya),this.TPb.appendChild(this.$M))}OQk(){this.TPb=
document.createElement("div");this.TPb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.B7a=document.createElement("div");this.B7a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.P5=this.I3e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.B7a.appendChild(this.P5);this.Dqe=M.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");
this.B7a.appendChild(this.Dqe);this.kse=M.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.kse.innerText=" / ";this.B7a.appendChild(this.kse);this.Jue=M.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.B7a.appendChild(this.Jue);this.M5=this.I3e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.B7a.appendChild(this.M5)}I3e(Ya,sb,ob,fc){Ya=F.a.dZa(Ya,sb,ob,fc,void 0===fc||null===fc);Ya.setAttribute(J.a.wh,
J.a.l2);return Ya}Adm(){const Ya=this.Vb.le(H.a.p_a);Ya.parent=r.AppFrame.Hp;Ya.bindAction(this.JY,G.a.eaa);Ya.hea(this.CXn)}zdm(){var Ya=new N.DOMFocusListing(()=>this.B6);Ya.XFa=!1;Ya.Go(2);Ya.Go(1);Ya=this.Vb.nxd(this.B6,this.Vb.le(H.a.p_a),Ya);Ya.jRa();Ya.HX=!0}VFa(){this.$M&&(this.qg.mb(O.a.click,this.$M,this.B0e),this.lLg=this.ie.Qlb(this.$M,this.B0e,a.a.us));this.qg.mb(O.a.click,this.P5,this.D0e);this.R0g=this.ie.Qlb(this.P5,this.D0e,a.a.us);this.qg.mb(O.a.click,this.M5,this.C0e);this.wXg=
this.ie.Qlb(this.M5,this.C0e,a.a.us);this.ib.DA(this.Ioa)}zia(){this.$M&&(this.qg.sc(O.a.click,this.$M,this.B0e),this.ie.Cob(this.$M,this.lLg));this.qg.sc(O.a.click,this.P5,this.D0e);this.ie.Cob(this.P5,this.R0g);this.qg.sc(O.a.click,this.M5,this.C0e);this.ie.Cob(this.M5,this.wXg);this.ib.$ba(this.Ioa)}static EDl(){return ha.FDl()}static FDl(){return new ha(w.FocusManager.instance(),ba.a.instance,V.a.instance,k.AFrameworkApplication.ya,z.App.xa.kA,z.App.xa.uy,W.a.instance,!!z.App.instance&&z.App.instance.Pva)}}
Object(D.a)(ha,"FootnoteEndnoteActionBarControl",null,[686]);var ca=c(208),ia=c(13),ra=c(1551),da=c(1723);class za{constructor(Ya,sb,ob,fc,Eb,Ib,Nb,pb,Aa,xb,gb,Xa){this.RD=null;this.QR=!1;this.Ev=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.GVb=Ya;this.L2b=sb;this.slc=ob;this.aXj=fc;this.hFe=Eb;this.Sl=Ib;this.K9a=Nb;this.qg=pb;this.y_g=Aa;this.RJj=gb;this.kr=this.GVb.ownerDocument.createElement("div");this.kr.id="FootnoteEndnoteControlOverlay";this.kr.className="EditingSurfaceOverlay";
this.KH=this.jyl();this.R_(!1);this.GVb.appendChild(this.kr);this.GVb.appendChild(this.KH);this.L2b.bind();this.eg=null;this.ga=Xa;this.hJa=xb}yKn(){const Ya=this.y_g();Ya&&Ya.mi&&(Ya.tmb=0,Ya.qvd())}tnj(Ya){if(this.LBc){const sb=this.LBc.fma;sb&&(sb.Gvf=Ya)}}get Iw(){return this.QR}get LBc(){return this.RD}get dialog(){return this.eg}get Wn(){return null!=this.Wpg?this.Wpg:this.Wpg=m.a.instance.Za("Common.IZoomManager")}n4e(){this.eg=da.a.NDl()}T0c(){this.eg=null}show(Ya=!0){this.QR||(this.tnj(!0),
this.RJj(),this.R_(!0),this.jz(),Ya&&this.setFocus())}setFocus(){this.QR&&(this.L2b.setInitialSelection(),this.aXj())}update(){this.QR&&(this.RD.isConnected?this.slc.nhe():this.dismiss())}dismiss(Ya=!1,sb=!1){this.QR&&(this.tnj(!1),this.d9(),this.yKn(),this.R_(!1),this.hFe(sb),this.eg&&(this.ga.processAction(ia.a.tGc,2),this.eg=null),!Ya&&this.RD&&this.RD.isConnected&&this.hJa.LRn(this.RD),this.uAb())}iJn(Ya){const sb=null!==this.Wn.instance?this.Wn.instance.jj:1;this.KH.style.width=Ya.pwh*sb+"px";
this.Ev.style.width=Ya.zEc*sb+"px";this.KH.style.marginLeft=Ya.S0b*sb+"px";this.Sl?this.Ev.style.marginRight=Ya.S2e*sb+"px":this.Ev.style.marginLeft=Ya.b1b*sb+"px";if(Ya=this.y_g())Ya=Ya.NK,this.KH.style.bottom=Ya.offsetHeight-Ya.clientHeight+"px"}efa(Ya){A.ULS.shipAssertTag(4520073,308,this.K9a.nna(Ya));this.RD!==Ya&&(this.RD=Ya,this.L2b.efa(Ya),this.slc.efa(this.RD))}dispose(){this.dismiss();this.L2b.dispose();this.slc.dispose()}jz(){this.qg&&this.qg.mb(O.a.click,this.kr,this.onClick)}d9(){this.qg&&
this.qg.sc(O.a.click,this.kr,this.onClick)}jyl(){let Ya;Ya=document.createElement("div");Ya.classList.add("FootnoteEndnoteControl");this.Ev=document.createElement("div");this.Ev.classList.add("FootnoteEndnoteContent");this.Ev.appendChild(this.L2b.B6);this.Ev.appendChild(this.slc.B6);Ya.appendChild(this.Ev);return Ya}R_(Ya){Ya=(this.QR=Ya)?"":"none";this.kr.style.display=Ya;this.KH.style.display=Ya}uAb(){this.RD&&(this.L2b.uAb(),this.slc.uAb(),this.RD=null)}static yLd(){const Ya=z.App.xa.jb.wc;return Ya&&
Ya.mi?Ya:null}static IDl(Ya,sb,ob,fc,Eb){return new za(Ya,sb,ob,fc,Eb,k.AFrameworkApplication.isRtl,V.a.instance,ca.a.instance,za.yLd,ra.a.instance,za.h6k,k.AFrameworkApplication.ya)}static h6k(){k.AFrameworkApplication.ya.Ub(ia.a.nhb,2,!0)}}Object(D.a)(za,"FootnoteEndnoteControl",null,[685]);var la=c(808),na=c(5),Ca=c(213),Na=c(40),Ta=c(10),Fa=c(24),qa=c(91),ja=c(1635),X=c(371),ua=c(955),Ha=c(583),Ea=c(1422),wa=c(74),sa=c(123);class fa extends X.a{constructor(Ya,sb,ob,fc,Eb,Ib,Nb,pb,Aa,xb,gb,Xa,
Va,Gb,Xb,rc,qb){super(H.a.ofa,ob,fc,Eb,Nb,pb,Aa,xb,gb,Xa,Va,Gb,Xb,rc,qb);this.nFg=Ya;this.xWa=Ib;this.xWa.s5c=this;sb(this);this.features.D8f=!0}get wji(){return!0}cof(){const Ya=this.nFg.lff(this);return ua.ViewReference.sE(this,Ya)}X8e(Ya){Object(sa.a)(fa,Ya)||this.nFg.U8e()}jMc(){return Ha.a.zyi}onResize(){super.onResize();this.xWa.qKh()}MB(Ya,sb=null){super.MB(Ya,sb);this.xWa.cKh(this.jd.Wi)}detach(){this.xWa.pKh();super.detach()}WHd(){this.onResize()}static bZa(){const {FootnoteEndnoteControlManager:Ya}=
c(1594);return new fa(Ya.instance,Ea.a.g2e,z.App.xa.jb,wa.InteractiveViewManager.instance,()=>m.a.instance.resolve("Box4.IUndoManager"),m.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.ya,m.a.instance.resolve("Box4.IHtmlViewRootFactory"),m.a.instance.resolve("Box4.IInteractiveEventNotifier"),m.a.instance.Za("Box4.ITextMetricsAdapter"),m.a.instance.resolve("Box4.IRotatingCoordinateConverter"),m.a.instance.Za("Common.IZoomManager"),m.a.instance.Pa("Box4.IContentControlViewElementManager"),
m.a.instance.Pa("Box4.CpConversionManagerImpl"),m.a.instance.Pa("Box4.ContentControlConfigSettings"),m.a.instance.Pa("Box4.IContentControlReader"),m.a.instance.Pa("Box4.IContentControlBoundaryNavigator"))}}Object(D.a)(fa,"FootnoteEndnoteEditView",X.a,[]);class Ma{constructor(Ya,sb,ob,fc=!1){this.Qrb=null;this.Nye=this.iCg=!1;this.qnl=()=>{const Eb=String.format("{0} {1}",this.Nye?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.nu.sendNotification(Eb,!0)};this.Vb=Ya;this.Xja=sb;this.lda=ob();this.Ogd=fc;this.B6=document.createElement("div");this.B6.classList.add("FootnoteEndnoteEditControl");this.Soc=document.createElement("div");this.Soc.classList.add("FootnoteEndnoteEditControlDividerElement");this.$wb=(new la.a(this.B6,"WACViewPanel_FootnoteEndnoteEditControl")).FH;this.B6.appendChild(this.Soc);this.B6.appendChild(this.$wb)}get nu(){return null!=
this.Llg?this.Llg:this.Llg=m.a.instance.resolve("Common.Utils.IAriaNotifier")}efa(Ya){A.ULS.shipAssertTag(4520077,308,this.Xja.nna(Ya));this.Qrb!==Ya&&(this.Qrb=Ya,this.EWe(this.Qrb),this.Nye=this.Xja.oib(this.Qrb),this.Ogd?(this.lda.XLb(J.a.gwd),this.Vb.le(H.a.ofa).z$(this.qnl)):this.lda.l5i(this.Nye?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,J.a.gwd))}uAb(){const Ya=V.a.instance.oib(this.Qrb)?
"Footnote":"Endnote";A.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Ya,["CalloutHeight"]:this.B6.scrollHeight});this.reb();this.Qrb=null}bind(){this.iCg||(this.lda.Icb(this.$wb),this.iCg=!0)}setInitialSelection(){const Ya=this.iTl();Ya?this.lda.setSelection(Ya):this.lda.T2c()}dispose(){this.reb()}EWe(Ya){this.reb();this.lda.MB(Ya,Ya.Wi)}reb(){this.lda.detach()}iTl(){let Ya=0;var sb=null,ob=na.GraphIterator.$a(this.Qrb);Ca.OutlineNavigator.Y7(ob);if((ob=Na.OutlineElementNavigator.Ee(ob))&&Ta.ParagraphReader.ic(ob)){if(sb=
Ma.EHl(ob)){Ya=sb.Nb.cp+1;sb=ja.FootnoteEndnoteDefaultContentInserter.BDh;const fc=sb.length;Ya+fc<=Ta.ParagraphReader.textLength(ob)&&ob.characterData.substr(Ya,fc)===sb&&(Ya+=fc)}sb=Fa.SelectionFactory.we(ob,Ya)}return sb}static KDl(){return Ma.LDl()}static LDl(){return new Ma(w.FocusManager.instance(),V.a.instance,()=>fa.bZa(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static EHl(Ya){Ya=qa.i(Ya,10);return 0<Ya.length?Ya[Ya.length-1]:null}}Object(D.a)(Ma,"FootnoteEndnoteEditControl",
null,[682]);var Ua=c(1158);class Qa{constructor(Ya,sb){this.dAa=Ya;this.Sl=sb}N5b(Ya,sb){Ya=this.dAa.N5b(Ya);var ob=sb.clientWidth;const fc=sb.scrollLeft,Eb=Ya.pwh;let Ib=Ya.S0b,Nb=Ya.S0b,pb=Qa.$Ef,Aa=Qa.aFf,xb=Eb,gb=Ya.zEc;this.Sl?Aa=Ya.S2e-Nb:pb=Ya.b1b-Ib;ob<Eb&&(Ib=Math.max(Ib-fc,0),xb=ob-Ib,this.Sl?(ob=sb.scrollWidth-fc-ob,Nb=sb.scrollWidth-Ya.S0b-Eb,Aa=Math.max(Ya.S2e-ob-Nb,Qa.aFf),gb=xb-Aa-Qa.$Ef):(pb=Math.max(Ya.b1b-fc-Ib,Qa.$Ef),gb=xb-pb-Qa.aFf));return new Ua.a(Ib,xb,pb,Aa,gb)}}Qa.$Ef=25;
Qa.aFf=50;Object(D.a)(Qa,"FootnoteEndnoteViewPositionProvider",null,[]);class Ja{constructor(Ya,sb=0,ob=0){this.clientWidth=Ya;this.scrollLeft=sb;this.scrollWidth=ob?ob:Ya}}Object(D.a)(Ja,"PageViewScrollContainerSizeInfo",null,[]);c.d(L,"FootnoteEndnoteControlManager",function(){return Wa});class Wa{constructor(Ya,sb,ob,fc,Eb,Ib,Nb,pb){this.OD=null;this.D8=()=>{this.Zo.XG(H.a.ofa);this.Zo.XG(H.a.p_a);this.Zo.ex(l.AFrame.So);this.Vb.fAc(H.a.ofa);this.Vb.Dg(H.a.ofa)};this.KXn=Aa=>{this.Zo.ex(H.a.ofa);
this.Zo.ex(H.a.p_a);this.Zo.XG(l.AFrame.So);this.Vb.TFc(H.a.ofa);(Aa||this.Vb.currentScope&&(this.Vb.currentScope.name===H.a.ofa||this.Vb.currentScope.name===H.a.p_a))&&this.Vb.Dg(l.AFrame.So)};this.Vb=Ya;this.Zo=sb;this.fNj=ob;this.gNj=fc;this.eNj=Eb;this.dAa=Ib;this.Yqa=Nb;this.VY=pb;this.JY=e.KeyInputManager.lc(a.a.A0,0);this.psf();this.uS()}get control(){return this.OD}get dialog(){return this.control.dialog}get Lhi(){return this.control.Iw}n4e(){this.control.n4e()}T0c(){this.control.T0c()}bind(Ya){this.FMk(Ya)}v5f(Ya){if(this.control.LBc!==
Ya.WYa)this.control.dismiss();else if(this.Lhi)return;this.r2b();this.control.efa(Ya.WYa);this.control.show(Ya.Ebe)}r2b(){if(this.VY){const Ya=new v.a(!0);this.VY.PFa(Ya)}}aY(){this.control.setFocus()}a7c(){this.control.update()}U8e(Ya,sb=!1){this.r2b();this.control.dismiss(Ya,sb)}gJn(Ya){const sb=Wa.yLd().NK;Ya=this.dAa.N5b(Ya,new Ja(sb.clientWidth,sb.scrollLeft,sb.scrollWidth));this.control.iJn(Ya)}dispose(){this.control.dispose();this.Vb.le(H.a.ofa).Mr(this.JY)}lff(Ya){A.ULS.shipAssertTag(4520074,
308,!!this.control);A.ULS.shipAssertTag(4520075,308,!!this.control.LBc);return this.mff(this.control.LBc.id,Ya)}FMk(Ya){const sb=this.gNj(),ob=this.eNj();this.OD=this.fNj(Ya,sb,ob,this.D8,this.KXn)}psf(){const Ya=this.Vb.le(H.a.ofa);Ya.parent=3===k.AFrameworkApplication.ya.mode?r.AppFrame.oE:r.AppFrame.bec;this.Vb.tSe(H.a.ofa);Ya.bindAction(this.JY,G.a.eaa)}uS(){this.Zo.uS(H.a.ofa);this.Zo.uS(H.a.p_a)}mff(Ya,sb){return()=>{const ob=Wa.yLd().jd.Jc.Db(Ya);this.Yqa.h3b();if(!ob.isConnected)return A.ULS.sendTraceTag(4520076,
308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.v5f(new I.a(ob,!0));return sb}}static Jl(){const Ya=new Qa(m.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new Wa(w.FocusManager.instance(),z.App.xa.Bv,za.IDl,Ma.KDl,ha.EDl,Ya,K.a.instance,m.a.instance.resolve("Box4.IPasteFloatieEventSource"),m.a.instance.resolve("Common.IAppSettingsManager"))}static yLd(){const Ya=z.App.xa.jb.wc;return Ya&&Ya.mi?Ya:null}static get instance(){return null!=
Wa.$rg?Wa.$rg:Wa.$rg=Wa.Jl()}}Object(D.a)(Wa,"FootnoteEndnoteControlManager",null,[669])},1614:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);var l=c(8),e=c(52),a=c(157),k=c(2),m=c(6),w=c(146),v=c(141),r=c(22);class z{constructor(A,G){this.Et=null;this.Rnd=!1;this.R$a=0;this.iTg="";this.foe={};this.ODe=A;this.Vb=G;this.VYg=Object(e.a)(this,this.oMf,"onModalMouseWheel");this.bSg=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Pb.Bna;this.ww=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Pb.vX}onMenuOpen(){0<
this.R$a?this.R$a++:(this.R$a++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,this.mPi,"pushTransientFocusScope"),0)}):this.mPi(),this.showModal())}mPi(){this.Vb&&this.Vb.LK(a.AFrame.Noa,!0)}Yul(){const A=v.f(),G=appChrome.selectors.getShyState();return String.format("{0}{1}",A,this.bSg&&G.isActive&&1===G.state?"_ShyRibbon":"")}FXl(A){var G=0;if(this.ww){if(this.foe[A])return this.foe[A];
(G=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");G=G?G.offsetTop:0;this.foe[A]=G}return G}showModal(){if(!this.Et)if(this.Et=this.createElement("div"),this.Et.setAttribute("id","ReactModalDiv"),this.Et.style.position="absolute",this.Et.style.bottom="0px",this.Et.style.left="0px",this.Et.style.right="0px",this.Et.style.backgroundColor="white",this.Et.style.opacity="0.0",this.ww){var A=
document.getElementById("regionComposerRoot");A&&A.appendChild(this.Et)}else this.ODe.appendChild(this.Et);A=this.Yul();if(A!==this.iTg){const G=this.FXl(A),H=appChrome.selectors.getShyState();this.bSg&&H.isActive&&1===H.state&&v.a("getRibbonHeight")?this.Et.style.top=String.format("{0}px",G+appChrome.api.getRibbonHeight(v.f())):this.Et.style.top=String.format("{0}px",G);this.iTg=A}this.Et.style.display="block";this.Et.style.visibility="visible";this.Et.style.zIndex="1000";this.Rnd||(window.addEventListener("wheel",
this.VYg,!0),this.UTd()?w.a.instance.mb(m.a.nM,this.Et,Object(e.a)(this,this.r1d,"onModalPointerUp")):w.a.instance.mb(m.a.pointerDown,this.Et,Object(e.a)(this,this.q1d,"onModalPointerDown")),this.Rnd=!0)}onMenuClose(){this.R$a--;0<this.R$a||(0>this.R$a?this.R$a=0:this.Bai())}JKf(){this.R$a=0;this.T8e();this.Bai()}createElement(A){A=document.createElement(A);A.setAttribute("unselectable","on");return A}Aai(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===a.AFrame.Noa&&!k.AFrameworkApplication.uc.Zu&&
this.Vb.RQ(a.AFrame.Noa,!1);this.Et&&(this.Et.style.zIndex="-1",this.Et.style.visibility="hidden",this.Et.style.display="none");this.Rnd&&(window.removeEventListener("wheel",this.VYg,!0),this.UTd()?w.a.instance.sc(m.a.nM,this.Et,Object(e.a)(this,this.r1d,"onModalPointerUp")):w.a.instance.sc(m.a.pointerDown,this.Et,Object(e.a)(this,this.q1d,"onModalPointerDown")),this.Rnd=!1)}Bai(){this.UTd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Aai()},0)}):this.Aai()}q1d(){this.HGc();this.bGh();
this.JKf();this.Jmb();return!0}r1d(){this.HGc();this.bGh();this.JKf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Jmb()},0)});return!0}Jmb(){4===k.AFrameworkApplication.ta.Pb.$n&&k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ta.Jmb():this.Vb.Dg(a.AFrame.So)}oMf(A){A.stopPropagation()}HGc(){const A=r.a.instance.Pa("Common.IReactContextualUILauncher");A&&A.HGc()}T8e(){const A=r.a.instance.Pa("Common.IReactContextualUILauncher");
A&&A.T8e()}bGh(){k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Pb.jPa&&(this.UTd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}UTd(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(D.a)(z,"ReactModalDiv",null,[])},1619:function(D,L,c){c.d(L,"a",function(){return e});c.d(L,"b",function(){return a});c.d(L,"c",function(){return k});var l=
c(2);const e=(m,w)=>{const v=RegExp("mailto:(.*)").exec(m.url);w.email=v&&2===v.length?v[1]:m.url;w.resolveState=m.Zw.charAt(35)===c(1712).ACommentFormatTranslator.Pok?1:0},a=(m,w)=>{w.contentId=m.Zw},k=(m,w,v)=>{w.contentId=m.Zw;w.isCurrentUser=v.email===l.AFrameworkApplication.K.lb("UserPrincipalName")}},1620:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(1014),e=c(7);class a{constructor(k,m){this.UM=this.Uuc=null;this.eb=k;this.q8a=m}get key(){return"COMMENT"}get Cw(){return WordEditorIntl.WordEditorStrings.L_Comment}get xla(){return this.UM}reset(k){this.UM=
k.node}jHa(k){let m=null;if(this.Uuc&&this.Phi(k,this.xla,this.Uuc))return m=Object.assign(new l.a,{kG:this.key,contentObject:this.Uuc}),{returnValue:!0,jF:m};this.Uuc=null;const w=this.q8a.H4e(this.xla);if(this.q8a.nuf(w)){let v=w.Vd();for(;v;){if(this.Phi(k,this.xla,v))return this.Uuc=v,m=Object.assign(new l.a,{kG:this.key,contentObject:v,description:this.cgb()}),{returnValue:!0,jF:m};v=w.Rj()}}return{returnValue:!1,jF:m}}Phi(k,m,w){if(this.gaj(w))return!1;const v=this.q8a.Q5b(w,!0),r=this.q8a.Q5b(w,
!1);return v&&r&&this.eb.yRc(m,v,r)&&(m=this.q8a.Bua(v,w.id,!0))&&(v!==this.xla||m.Nb.cp<=k)&&(w=this.q8a.Bua(r,w.id,!1))&&(r!==this.xla||w.Nb.cp>k||w.Nb.cp>=k)?!0:!1}gaj(k){return k.ia(e.a.dG,!1)}cgb(){return null}}Object(D.a)(a,"CommentDetailsProvider",null,[245,246])},1626:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);L=c(174);var l=c(113);class e extends L.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(e,"DocumentTypeClassifierAnnotation",L.a,[])},1629:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);var l=c(2),e=c(1127),a=c(80),k=c(8),m=c(52),w=c(97),v=c(67),r=c(359);class z{constructor(A,G,H,I,K,F){this.OGe=null;this.K0g=0;this.P1=!1;this.rd=I;this.Oe=G;this.Z4=K;this.Lwe=H;this.Wmc=l.AFrameworkApplication.j5f();this.Soe=A.appSettings.ChromeClipboardAccessOperationTimeout;this.OH=0;this.VGj=F;this.jLj=A.$("EnableExternalPasteSupportOnMobileIsEnabled");this.Fl=e.a.getInstance(r.a.xYa);
this.P1=A.$("ShouldLogCcpExtendedHealthKpis")}get KQa(){return this.Z4.KQa}process(A,G){if(!this.OH)return this.ufn(G);if(1===this.OH)return this.prepareForPaste(A,G);if(2===this.OH)return this.OH=3,this.OGe(A,G);3===this.OH&&this.Z4.v7i(A,G);return!1}ufn(A){let G=!0;this.jLj&&(G=!(A.Jy&1));this.Oe.t3&&G||A.Jy&512?(this.OGe=A.Jy&2?Object(m.a)(this.Z4,this.Z4.paste,"paste"):Object(m.a)(this.Z4,this.Z4.WKi,"pasteInternal"),this.OH=2):(this.Wmc?(this.OH=1,this.K0g=Date.now()):this.OH=2,this.OGe=Object(m.a)(this.Z4,
this.Z4.paste,"paste"));r.a.cMm(A);return!0}prepareForPaste(A,G){A=!0;if(this.Lwe.value.iNi())this.OH=2;else{const H=Date.now()-this.K0g;H>this.Soe&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",H),this.rd.fc(w.a.ama,{["Reason"]:v.a.GIi}),G.LQ&&(G.LQ.fail("Prepare for paste timed out",!1),this.P1?this.Fl.logKpiFailure({kpiName:r.a.WLa,errorName:"PreparePasteTimedOut",optionalVeto:{name:r.a.rlb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",
[r.a.rlb],!1,!0,!0,!1,null)),G.failed=!0,A=!1,this.VGj.OKn())}return A}}Object(D.a)(z,"ClipboardOperationPasteProcessor",null,[607])},1630:function(D,L,c){c.d(L,"a",function(){return W});D=c(0);L=c(241);var l=c(1127),e=c(2),a=c(80),k=c(55),m=c(108),w=c(8),v=c(123),r=c(68),z=c(1408),A=c(52),G=c(37),H=c(3),I=c(97),K=c(67),F=c(1070),J=c(19),N=c(54),O=c(1567),M=c(1631),T=c(359),R=c(134);class W extends L.a{constructor(V,ba,ha,ca,ia,ra,da,za,la,na,Ca,Na,Ta,Fa,qa,ja,X,ua,Ha,Ea,wa,sa,fa,Ma,Ua,Qa,Ja,Wa=!0){super();
this.Xia=this.JB=null;this.aL=this.Ez=0;this.Abb=this.OKe=this.Q9=this.gg=null;this.zV=!1;this.gS=!0;this.PMg=!1;this.init(V);this.il("ClipboardOperation");this.Lhb(la,ba,ia,ra,da);this.rd=na;this.He=Ca;this.Oe=Na;this.Ic=Ta;this.eEg=Fa;this.gEg=qa;this.fEg=ja;this.fpe=X;this.ZQb=ua;this.gpe=Ha;this.Wmc=za;this.Kmc=Ea;this.tAa=wa;this.I6j=Wa;this.PC=sa;this.Ud=fa;this.Yl=Ma;this.VY=Ua;this._context=ca;this.Wda=Qa;this.dXb=Ja;this.Fl=l.a.getInstance(T.a.xYa);da&&Object(v.a)(105,da)&&(this.Q9=Object(r.a)(611,
da.ia(m.a.hta,null)));this.Q9||(this.Q9=this.Wda.F4c());this.zpb=void 0===ha||null===ha?"NotAvailable":Object(z.a)(M.a,ha);this.Q9.Lkk(this.zpb.split(", "));V=this._context;if(this.dXb){if(!W.sph(V,this.fpe,this.rd,this.Q9,Wa)){this.nr=8;this.finish();return}this.gg=V.view;this.zV=3===this.gg.CGb;this.Ez=0;this.aL=ha;this.Abb=X.KQa}else{if(!V.view.ue){this.rd.fc(I.a.vf,{["Reason"]:K.a.fIb});this.Q9.fail("Not in interactive view",!0);this.nr=8;this.finish();return}this.gg=V.view;if(!this.gg.Bb){this.rd.fc(I.a.vf,
{["Reason"]:K.a.noSelection});this.Q9.fail("No selection manager",!0);this.nr=8;this.finish();return}this.zV=3===this.gg.CGb;this.Ez=0;this.aL=ha;this.Abb=X.KQa;if(Wa&&!(this.Abb&&this.Abb.kb&&this.Abb.length)){this.rd.fc(I.a.vf,{["Reason"]:K.a.noSelection});this.Q9.fail("No selection when one required",!0);this.nr=8;this.finish();return}}X=J.SelectionEditor.om(this.Abb.kb);X=!(this.aL&16&&X);X=Ha.slm(ha,this.Lg)&&X;1!==this.behavior&&X||(X||this.Q9.fail("Clipboard operation disabled for selection",
!0),this.nr=X?32:8,this.hpa());!this.PMg&&this.Oe.zi&&(k.b("IPadCCP"),this.PMg=!0)}get Lg(){this.OKe||(this.OKe=N.a.F_b(this.Abb));return this.OKe}Wba(){super.Wba();this.Abb=null}run(){this.Ez||this.setup();1===this.Ez&&this.process();2===this.Ez&&this.teardownSync();3===this.Ez&&this.teardownAsync();4===this.Ez&&this.finish()}setup(){if(this.aL&256&&this.Wmc){this.xF||this.ZQb.mEk(this,this.aL,this.zpb);this.xF.run();if(this.xF.inProgress)return;this.gS=this.xF.poa;this.Tyd();if(!this.gS){this.Q9.fail("No access to system clipboard",
!0);this.nr=8;this.Ez=4;this.OXd();return}}else w.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.aL,this.zpb,this.Oe.tF,this.actionId);this.aL&32&&!this.He.ISd(this.gg.Bb.Lg)?(w.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.rd.fc(I.a.vf,{["Reason"]:K.a.A6e}),this.Q9.fail("Cut not allowed",!0),this.Kmc.show(),this.nr=8,this.Ez=4):(this.aL&16||this.aL&32)&&G.a.instance.J(3)&&this.PC.KUd(this.gg.Bb.hb.kb)?(this.Q9.fail("Selected content deleted in coauthoring",
!0),this.Ud.UMb(),this.nr=8,this.Ez=4):(this.aL&4096&&(this.VY.Ydc(Object.assign(new F.a,{CQc:!0,WX:this.zpb})),this.Yl.undo()),this.gpe.Tjn(this.aL),!this.gg.jd&&e.AFrameworkApplication.K&&e.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")?(this.Q9.fail("Interactive view has null target node",!0),this.nr=8,this.Ez=4):(this.JB=this.Ic.Qc(15),this.JB.Kk=this.actionId,this.JB.Eb(this.gg.jd),this.Ez=1))}process(){if(!this.xF){w.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",
this.aL,this.zpb,this.Oe.tF);w.ULS.shipAssertTag(6305507,307,!this.Xia);this.Xia=new O.a(this._context,this.aL,this.Q9,this.x8,this.GD,void 0,this.Oe.tF,this.I6j,this.zV);let V;V=this.aL&65536?Object(A.a)(this.eEg,this.eEg.process,"process"):this.aL&64?Object(A.a)(this.gEg,this.gEg.process,"process"):this.aL&1?Object(A.a)(this.fpe,this.fpe.process,"process"):Object(A.a)(this.fEg,this.fEg.process,"process");this.aL&16&&this.gg.Bb.Uxa.dQh();this.tAa.create(this,V,this.Xia).il("ClipboardAction")}w.ULS.shipAssertTag(6305536,
307,!!this.xF);this.xF.run();this.xF.inProgress||(this.Tyd(),this.Ez=this.wg?2:3)}teardownSync(){this.Xia.i9b&&(this.JB.Kk=H.a.typing);this.Xia.XQc&&this.JB.OEa(this.Xia.Qrf,this.Xia.rJf);this.JB.dispose();this.nr=this.Xia.failed?8:32;this.Ez=4}teardownAsync(){if(this.xF){if(this.xF.run(),this.xF.inProgress)return}else if(this.Xia.i9b&&(this.JB.Kk=H.a.typing),this.JB.nGa(this),this.Xia.XQc&&this.JB.OEa(this.Xia.Qrf,this.Xia.rJf),this.JB.dispose(),this.ORe)return;this.nr=this.Xia.failed?8:32;this.Ez=
4}finish(){this.VY.Ydc(Object.assign(new F.a,{CQc:!1}));this.hpa();32===this.response?w.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.aL,this.zpb,this.Oe.tF):w.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.aL,this.zpb,this.Oe.tF);this.Wda.cfa(this.Q9);(W.qun||W.J4f)&&this.EIm()}OXd(){const V=!!(this.aL&1),ba=this._context.view;
ba&&T.a.OXd(V,ba.Bb,this.Oe.tF)}EIm(){if(!(this.aL&4||this.aL&64)){var V=new Map;V.set("isCopy",String.format("{0}",!!(this.aL&16)));V.set("isIPad",String.format("{0}",this.Oe.zi));W.J4f?(V.set("SkipAria","false"),V.set("ErrorLevel","info"),this.Fl.logKpiUsage({kpiName:T.a.hyd,kpiType:0,optionalProperties:{extendedProperties:V},blockFutureEmissionDurationInMs:0})):a.Health.instance.recordKpiUsage(T.a.hyd,0,T.a.iyd,V);this.gS||(W.J4f?(V.set("SkipAria","false"),V.set("ErrorLevel","info"),this.Fl.logKpiFailure({kpiName:T.a.hyd,
errorName:T.a.zqh,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:V}},blockFutureEmissionDurationInMs:0})):(V=Object.assign(new R.a,{extendedProperties:V}),a.Health.instance.recordKpiFailure(T.a.hyd,T.a.zqh,!0,!0,V)))}}static get qun(){null==W.FIe&&(W.FIe=!!e.AFrameworkApplication.K&&e.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return W.FIe}static get J4f(){null==W.P1&&(W.P1=!!e.AFrameworkApplication.K&&e.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));
return W.P1}static pVf(V,ba,ha,ca){V&&V.fc(I.a.vf,{["Reason"]:ha});ba&&ba.fail(ca,!0)}static sph(V,ba,ha=null,ca=null,ia=!0){return V.view.ue?V.view.Bb?!ia||ba.KQa&&ba.KQa.kb&&ba.KQa.length?!0:(W.pVf(ha,ca,K.a.noSelection,"Paste target is invalid"),!1):(W.pVf(ha,ca,K.a.noSelection,"No selection manager"),!1):(W.pVf(ha,ca,K.a.fIb,"Not in interactive view"),!1)}}W.FIe=null;W.P1=null;Object(D.a)(W,"ClipboardOperation",L.a,[])},1631:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.paste=
1]="paste";e[e.textOnly=2]="textOnly";e[e.overtype=4]="overtype";e[e.copy=16]="copy";e[e.deleteSelection=32]="deleteSelection";e[e.move=64]="move";e[e.useSystemClipboard=256]="useSystemClipboard";e[e.forceInternalClipboard=512]="forceInternalClipboard";e[e.reformatPastedContent=4096]="reformatPastedContent";e[e.pasteAsPlainText=8192]="pasteAsPlainText";e[e.showPlaceholderGlossary=65536]="showPlaceholderGlossary";e[e.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste";
e[e.noSpacesAdjustment=262144]="noSpacesAdjustment"})(l||(l={}));Object(D.b)("ClipboardActionFlags",l)},1634:function(D,L,c){var l=this&&this.$E||(Object.create?function(a,k,m,w){void 0===w&&(w=m);var v=Object.getOwnPropertyDescriptor(k,m);if(!v||("get"in v?!k.rz:v.writable||v.configurable))v={enumerable:!0,get:function(){return k[m]}};Object.defineProperty(a,w,v)}:function(a,k,m,w){void 0===w&&(w=m);a[w]=k[m]}),e=this&&this.__exportStar||function(a,k){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(k,
m)||l(k,a,m)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1790),L);e(c(1791),L);D.exports.IntentIds||Object.defineProperty(D.exports,"IntentIds",{enumerable:!0,get:function(){return D.exports.IntentIds}});D.exports.ObjectSchemaType||Object.defineProperty(D.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return D.exports.ObjectSchemaType}});D.exports.ObjectSemantic||Object.defineProperty(D.exports,"ObjectSemantic",{enumerable:!0,get:function(){return D.exports.ObjectSemantic}});D.exports.SearchSuggestionAnnotation||
Object.defineProperty(D.exports,"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return D.exports.SearchSuggestionAnnotation}});D.exports.SearchSuggestionSignal||Object.defineProperty(D.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return D.exports.SearchSuggestionSignal}});D.exports.SequenceType||Object.defineProperty(D.exports,"SequenceType",{enumerable:!0,get:function(){return D.exports.SequenceType}})},1635:function(D,L,c){c.r(L);c.d(L,"FootnoteEndnoteDefaultContentInserter",
function(){return I});D=c(0);var l=c(22),e=c(61),a=c(2),k=c(40),m=c(658),w=c(36),v=c(7),r=c(17),z=c(52),A=c(1168),G=c(875),H=c(1568);class I{constructor(K,F,J,N,O=null){this.Zc=K;this.NGj=F;this.Sl=J;I.Bh=N;this.LFg=O||I.dUk}get JK(){return null!=this.Ztg?this.Ztg:this.Ztg=l.a.instance.resolve("Box4.IOutlineEditor")}nSk(K,F){var J=this.Zc.Bk();J.set(K);this.JK.Qhb(J,null,!0);I.Bh.kMb(J.currentNode,this.Sl);K=k.OutlineElementNavigator.Ee(J);I.zca.$ae(F?Box4Intl.Box4Strings.L_StyleWordFootnoteText:
Box4Intl.Box4Strings.L_StyleWordEndnoteText,K);J=this.LFg(J.currentNode);I.characterPropertiesEditor.replaceTextRange(J,I.BDh);this.qgm(K,F)}qgm(K,F){var J=this.NGj(131073);J.setValue(v.a.Qq,1===F?36:35);J.setValue(v.a.$ka,!0);J.setValue(r.a.Y8,!0);const N=K.Jc.av(J,e.a.create());J=this.LFg(K);I.characterPropertiesEditor.Qfa(J,O=>G.a.getInstance(O,N,!0),H.a.LTh(K,F))}static Jl(){return new I(new m.a,Object(z.a)(A.a.instance,A.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,
l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get zca(){return null!=I.twg?I.twg:I.twg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=I.vmg?I.vmg:I.vmg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=I.lsg?I.lsg:I.lsg=I.Jl()}static dUk(K){return w.a.Uc(K,0)}}I.BDh=" ";I.Bh=null;Object(D.a)(I,"FootnoteEndnoteDefaultContentInserter",null,[719])},1636:function(D,L,c){c.d(L,"a",function(){return m});
D=c(0);var l=c(658),e=c(551),a=c(1503),k=c(1568);class m{constructor(w,v){this.Yqa=v}yNd(w,v,r){return(w=this.Yqa.V_h(w.node,r?w.cpBegin:w.cpEnd,v))?w.a3():null}q8h(w,v){return(w=this.Yqa.KPl(w.node,w.cpBegin,v))?w.a3():null}static VKc(){return new m(e.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=m.Lrg?m.Lrg:m.Lrg=m.VKc()}}Object(D.a)(m,"FootnoteEndnoteNavigator",null,[683])},1647:function(D,L,c){c.d(L,"a",function(){return m});D=c(0);var l=c(1705),e=c(2),a=c(41),
k=c(22);class m{constructor(w,v,r,z,A,G){this.Cra=w;this.Dra=v;this.Owe=r;this.sY=z;this.Acd=A;this.rQb=G}get ebj(){return!this.Dra&&!this.Owe}get OBi(){return 2===this.rQb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get LKh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get ubi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get jhb(){return CommonUIStrings.l_OICErrorHelpLink}get nai(){return"OICFailure"}get icon(){return 3}get Ptd(){return 2===
this.rQb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}etn(w){this.YBi(w)}YCm(w){this.YBi(w)}YBi(w){let v=10;1===w?(k.a.instance.resolve("Common.IOfficeTrialExperience").NAf(this.rQb),v=3):2===w&&((!this.Owe||this.Owe(this.sY))&&this.Dra&&l.a.instance.uVk(this.Dra,this.Cra,this.sY),v=5);(0===w||1===w)&&this.Cra&&this.Cra(this.sY);e.AFrameworkApplication.Fec(a.a.uIi,this.Acd,v);this.dispose()}dispose(){this.sY=
this.Dra=this.Cra=null}}Object(D.a)(m,"AOICErrorDialogWithTrial",null,[9])},1703:function(D,L,c){D=c(0);var l=c(2),e=c(15),a=c(22),k=c(594),m=c(1499),w=c(29);class v{constructor(fa,Ma=null){this.yVj=fa;this.eW=Ma||m.a.Zif(e.a.ryb,"")}get ey(){return this.yVj}get Hc(){return this.eW}z2f(fa){this.Hc.d++;return this.ey.z2f(fa)}Agc(fa){this.Hc.e++;return this.ey.Agc(fa)}mG(fa){this.Hc.f++;return this.ey.mG(fa)}Mmb(fa){this.Hc.h++;return this.ey.Mmb(fa)}o4(fa){this.Hc.i++;return this.ey.o4(fa)}K8(fa){this.Hc.j++;
return this.ey.K8(fa)}kpa(fa){this.Hc.k++;return this.ey.kpa(fa)}mca(fa){this.Hc.l++;return this.ey.mca(fa)}jae(fa){this.Hc.m++;return this.ey.jae(fa)}e5a(fa,Ma=!1){this.Hc.n++;return this.ey.e5a(fa,Ma)}Nof(){this.Hc.o++;return this.ey.Nof()}o6f(){this.Hc.p++;return this.ey.o6f()}Us(fa){this.Hc.q++;return this.ey.Us(fa)}xxa(fa){this.Hc.r++;return this.ey.xxa(fa)}mgc(fa){this.Hc.g++;return this.ey.mgc(fa)}$2c(fa){return this.ey.$2c(fa)}Pmb(fa){this.Hc.s++;return this.ey.Pmb(fa)}Qae(fa){this.Hc.s++;
return this.ey.Qae(fa)}r5e(fa){this.Hc.ba++;return this.ey.r5e(fa)}Q$d(fa){this.Hc.s++;return this.ey.Q$d(fa)}Nmb(fa){this.Hc.s++;return this.ey.Nmb(fa)}pMb(fa){this.Hc.t++;return this.ey.pMb(fa)}fbe(fa){this.Hc.u++;return this.ey.fbe(fa)}Pha(fa){this.Hc.v++;return this.ey.Pha(fa)}p3f(fa){this.Hc.bb++;return this.ey.p3f(fa)}tGa(fa){return this.ey.tGa(fa)}C8(fa){this.Hc.z++;return this.ey.C8(fa)}lZf(){return this.ey.lZf()}Qha(fa,Ma){this.Hc.w++;this.Hc.x++;return this.ey.Qha(fa,Ma)}sC(fa){this.Hc.y++;
return this.ey.sC(fa)}clearFormatting(){return this.ey.clearFormatting()}clone(){return new v(this.ey.clone(),this.Hc)}}Object(D.a)(v,"FormattingStewardUsageCollector",null,[254]);class r extends v{constructor(fa,Ma=null){super(fa,Ma)}get Z7(){return this.ey}get mt(){return this.Z7.mt}set mt(fa){this.Z7.mt=fa}get textIndent(){return this.Z7.textIndent}get marginLeft(){return this.Z7.marginLeft}get eic(){return this.Z7.eic}get BFa(){return this.Z7.BFa}get lineSpacing(){return this.Z7.lineSpacing}get pJ(){return this.Z7.pJ}get leftIndent(){return this.Z7.leftIndent}get Nba(){return this.Z7.Nba}get paragraph(){return this.Z7.paragraph}set paragraph(fa){this.Z7.paragraph=
fa}get WP(){return this.Z7.WP}get kic(){return this.Z7.kic}sge(fa){return this.Z7.sge(fa)}Oag(fa){return this.Z7.Oag(fa)}clone(){const fa=this.ey.clone();return new r(fa,this.Hc)}}Object(D.a)(r,"FormattingStewardUsageCollector",v,[649,254]);var z=c(10),A=c(99),G=c(311),H=c(862),I=c(40),K=c(213),F=c(94),J=c(43),N=c(61),O=c(375),M=c(148),T=c(16),R=c(80),W=c(62),V=c(17),ba=c(7),ha=c(44),ca=c(134),ia=c(524),ra=c(376),da=c(37),za=c(96),la=c(47),na=c(59),Ca=c(193),Na=c(1561),Ta=c(170),Fa=c(36),qa=c(1370),
ja=c(874);class X{constructor(fa,Ma,Ua,Qa,Ja,Wa,Ya,sb,ob,fc,Eb=null){this.MD=this._paragraph=null;this.hmd=0;this.xDg=this.imd=null;this.N9=0;this.Kub=this.kic=this.leftIndent=this.pJ=this.ttc=this.BFa=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=fa;this.ze=Ma;this.sL=Ua;this.Kz=Qa;this.cF=Ja;this.bTb=Wa;this.uja=Ya;this.LRb=sb;this.EUa=ob;this.Orb=fc;Eb?(w.a(4223818,307,!!Eb.MD),this.MD=Eb.MD.ita(this.paragraph),this.hmd=Eb.Pcc,this.imd=Eb.rPf,Eb.BFa&&(this.BFa=new qa.a,this.BFa.afterSpacing.value=
Eb.BFa.afterSpacing.value,this.BFa.beforeSpacing.value=Eb.BFa.beforeSpacing.value),Eb.lineSpacing&&(this.ttc=Eb.lineSpacing.clone()),this.N9=Eb.N9,this.kic=Eb.kic.clone(),this._textIndent=Eb.textIndent,this._marginLeft=Eb.marginLeft,this._tabStops=Eb.eic,this.pJ=Eb.pJ,this.leftIndent=Eb.leftIndent,Eb.Nba&&(this.Kub=Eb.Nba)):(this.MD=new Ca.a(this.paragraph,0),this.MD.formatting=new Ta.a(this.MD,N.a.nil),Ma=Fa.a.Dw(fa),Ma=this.cF.zr(Ma),this.GWn(Ma),this.R8n(fa)?(this.bTb.aYn(this.MD.formatting,Ma),
fa.hasProperty(V.a.Vh)?this.N9=fa.getValue(V.a.Vh):this.N9=0):this.N9=-1,this.hmd=0,this.BFa=this.imd=null,this.Orb&&(this.BFa=this.bTb.jDa(fa),this.ttc=this.bTb.VNa(fa),this.pJ=this.bTb.P5b(fa),this.leftIndent=this.bTb.oT(fa)),this.kic=new O.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(fa){w.a(4223816,307,!!fa&&z.ParagraphReader.ic(fa));this._paragraph=fa}get WP(){return this.MD.formatting}get Pcc(){return this.hmd}get rPf(){return this.imd}get Rv(){return this.xDg}get mt(){return this.N9}set mt(fa){w.a(4223817,
307,1===fa||2===fa||3===fa||6===fa);this.N9=fa}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get eic(){return this._tabStops}get lineSpacing(){return this.ttc}get Nba(){return this.Kub}get nc(){return this.Kz}GWn(fa){const Ma=this.cF.language(fa);Ma&&this.ze.A2f(this.MD.formatting,Ma,0,fa.cache.DFb,!1)}R8n(fa){if(!da.a.instance.J(7))return!0;fa=this.nc.qf(this.nc.Xn(fa));return fa===la.StyleReader.D8c||fa===la.StyleReader.wordStyleIdNormal||fa===la.StyleReader.fpb||
fa===la.StyleReader.styleIdNormal}z2f(fa){(fa=k.a.sg(fa))&&this.ze.yae(this.MD.formatting,fa.LCID);return!0}Agc(){return!1}mG(fa){this.ze.mG(this.MD.formatting,fa);return!0}Mmb(fa){this.ze.setItalic(this.MD.formatting,fa);return!0}o4(fa){this.ze.o4(this.MD.formatting,fa);return!0}K8(fa){this.ze.K8(this.MD.formatting,fa);return!0}kpa(fa){this.ze.kpa(this.MD.formatting,fa);return!0}mca(fa){this.ze.mca(this.MD.formatting,fa);return!0}jae(fa){if(0>=fa)return!1;this.ze.Av(this.MD.formatting,fa);return!0}e5a(fa,
Ma){if(!fa||""===fa)return!1;if(({CPh:Ua}=M.FontUtils.Tlj(fa)).returnValue)return this.ze.S_(this.MD.formatting,Ua.fontName),!0;var Ua=!1;const Qa=M.FontUtils.kQa(fa);Ma&&this.Vib(Qa,this.uja)&&(this.uja.Oea(fa),Ua=!0);if(this.Vib(Qa,this.LRb)||this.Vib(Qa,this.EUa))Ua=!0;Ua&&this.ze.S_(this.MD.formatting,Qa);return Ua}Vib(fa,Ma){return!!Ma&&Ma.isEnabled&&Ma.Vib(fa)}Nof(){this.ze.N8h(this.MD.formatting);return!0}o6f(){this.ze.fcj(this.MD.formatting);return!0}Us(fa){var {Box4PasteSteward:Ma}=c(1475);
if(null===fa||""===fa)return!1;fa=Ma.tzb(fa);Ma=null;this.Nba&&this.Nba.hasOwnProperty(ba.a.listLevel.id.toString())&&(Ma=this.Nba[ba.a.listLevel.id.toString()]);this.ze.Us(this.MD.formatting,fa,Ma);return!0}xxa(fa){const {Box4PasteSteward:Ma}=c(1475);if(!fa||""===fa||!X.n0l().contains(fa))return!1;this.ze.xxa(this.MD.formatting,Ma.tzb(fa));return!0}mgc(fa){this.ze.mgc(this.MD.formatting,fa);return!0}$2c(fa){let Ma=0;switch(T.a.jh(fa)){case "small-caps":Ma=1;break;case "uppercase":Ma=2}this.ze.Pl(this.MD.formatting,
ha.a.capitalization,Ma);return!0}C8(fa){const {Box4PasteSteward:Ma}=c(1475);if(!fa||""===fa)return!1;this.kic.setValue(V.a.wF,parseInt(Ma.tzb(fa),16));return!0}Nmb(fa){return 0>=fa?!1:this.Qae(this.nc.W4h(fa))}Pmb(fa){this.clearFormatting();this.hmd=fa;return!0}r5e(fa){var {Box4PasteSteward:Ma}=c(1475),Ua=new Map;Ua.set("Source","CreateStyleCCP_FormattingSteward");R.Health.instance.recordKpiUsage(za.a.Ntj,0,za.a.eD,Ua);Ua=na.a.aVl(fa);fa=[];fa.push(Ua);(fa=na.a.jSe(fa,this.paragraph))?(Ma.$hc=this.nc.Yn(),
w.b(593078085,3017,50,"Custom style created via paste.")):(Ma=new Map,Ma.set("Source","CreateStyleCCP_FormattingSteward"),Ma.set("IsStyleNull",(!Ua).toString()),Ma=Object.assign(new ca.a,{extendedProperties:Ma}),R.Health.instance.recordKpiFailure(za.a.Ntj,"UnableToCreateStyle",!1,!0,Ma));return fa}Qae(fa){const {Box4PasteSteward:Ma}=c(1475);return fa&&0<fa.length&&Ma.$hc&&Ma.$hc.fh(fa)?(this.imd=fa,!0):!1}Q$d(fa){const {Box4PasteSteward:Ma}=c(1475);return fa&&0<fa.length&&Ma.$hc&&Ma.$hc.fh(fa)?(this.xDg=
fa,!0):!1}Oag(fa){if(this.Rv){fa=this.nc.jx(fa);if(!fa)return w.a(41968715,307,!1),!1;(fa=fa.fh(this.Rv))&&this.ze.$mb(this.MD.formatting,fa);return!0}return!1}Qha(){return!1}sC(fa){if(!fa)return!1;const Ma=parseFloat(T.a.substring(fa,0,T.a.jh(fa).indexOf("px")));if(!isNaN(Ma))return this.ttc=new ja.a(3,W.a.jy(Ma,1)),!0;fa=parseFloat(T.a.substring(fa,0,T.a.jh(fa).indexOf("%")));return isNaN(fa)?!1:(this.ttc=new ja.a(2,fa/100),!0)}pMb(fa){let Ma=0;if(!fa||""===fa)return!1;switch(fa){case "left":Ma=
1;break;case "center":Ma=2;break;case "right":Ma=3;break;case "justify":Ma=6}if(!Ma)return!1;this.mt=Ma;return!0}fbe(fa){this._textIndent=fa;return!0}Pha(fa){this._marginLeft=fa;return!0}p3f(fa){this._tabStops=fa;return!0}tGa(fa){this.Kub=JSON.parse(fa);return this.Nba?!0:!1}clearFormatting(){this.MD.formatting=new Ta.a(this.MD,N.a.nil);return!0}lZf(){this.N9=0;return!0}sge(fa){var {Box4PasteSteward:Ma}=c(1475);if(!da.a.instance.J(7))return!1;if(0<this.Pcc&&Ma.O3a[this.Pcc]){w.a(4223819,307,1<=this.Pcc);
w.a(4223820,307,7>=this.Pcc);Ma=this.nc.jx(fa);if(!Ma)return w.a(4223821,307,!1),!1;Ma=Ma.fh(c(1475).Box4PasteSteward.O3a[this.Pcc]);this.sL.QK(Ma,fa,!1);return!0}if(this.rPf){Ma=this.nc.jx(fa);if(!Ma)return w.a(41968716,307,!1),!1;Ma=Ma.fh(this.rPf);this.sL.QK(Ma,fa,!1);return!0}return!1}clone(){return new X(this.paragraph,this.ze,this.sL,this.Kz,this.cF,this.bTb,this.uja,this.LRb,this.EUa,this.Orb,this)}static n0l(){X.gZ||(X.gZ=new ia.a(ra.a.Ri()),X.gZ.add(Na.a.yellow),X.gZ.add(Na.a.hDm),X.gZ.add(Na.a.Dnk),
X.gZ.add(Na.a.fpl),X.gZ.add(Na.a.blue),X.gZ.add(Na.a.red),X.gZ.add(Na.a.eXm),X.gZ.add(Na.a.teal),X.gZ.add(Na.a.green),X.gZ.add(Na.a.purple),X.gZ.add(Na.a.BRm),X.gZ.add(Na.a.P_m),X.gZ.add(Na.a.gray),X.gZ.add(Na.a.lco),X.gZ.add(Na.a.black));return X.gZ}}X.gZ=null;Object(D.a)(X,"FormattingSteward",null,[649,254]);class ua{Yag(){return!1}gpf(fa){return fa}npf(){}tGa(){}Eae(){}eTd(){return!1}get lUd(){return!1}sC(){}Qha(){}Xae(){}get laj(){return!1}}Object(D.a)(ua,"NoOpPasteStewardBridge",null,[141]);
var Ha=c(82);class Ea{constructor(fa,Ma){this.UYm=fa;this.VYm=Ma||"Normal"}}Object(D.a)(Ea,"NoteTagInfoBox4",null,[]);const wa=fa=>{const Ma=new Ha.a;for(const Ua of fa)fa=new Ea(Ua.UYm,Ua.VYm),Ma.add(fa);return Ma};c.d(L,"a",function(){return sa});class sa{constructor(fa,Ma,Ua=null,Qa=null){this.Oml=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.e0g=0;this.Dc=fa;this.D5=Ma;this.O0=Qa||new ua;this.Hc=Ua||m.a.Zif(e.a.ryb,"")}get characterPropertiesEditor(){return null!=
this.nmg?this.nmg:this.nmg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.mpg?this.mpg:this.mpg=a.a.instance.Pa("Box4.IFontService")}get lCa(){return null!=this.rng?this.rng:this.rng=a.a.instance.Pa("Box4.CustomFontService")}get R$k(){return null!=this.Png?this.Png:this.Png=a.a.instance.Pa("Box4.IEmbeddedFontService")}reset(){}get $Fc(){return this.Xhf(!1)}Xhf(fa){w.a(4223770,307,J.OutlineElementReader.Oh(this.Dc));const Ma=I.OutlineElementNavigator.Ee(this.Dc);
I.OutlineElementNavigator.$d(this.Dc);w.a(4223771,307,!!Ma&&z.ParagraphReader.ic(Ma));fa=new X(Ma,sa.Jn,sa.HM,sa.nc,sa.W6,sa.pol,this.fontService,this.lCa,this.R$k,this.Oml,void 0,fa);return new r(fa,this.Hc)}Cba(){}iFa(){}Skb(){}rwa(){}dFa(){}oQa(){}nQa(){}iG(){}hG(){}Pkb(){}Okb(){}tQa(){}x3a(){}lFa(){}jFa(){}sQa(){}kFa(){}A3a(){}Yac(fa){J.OutlineElementReader.Oh(this.Dc)?(sa.ih.bna(this.Dc,!0),I.OutlineElementNavigator.Jr(this.Dc,!1,!1)):F.OutlineReader.Kw(this.Dc)?K.OutlineNavigator.Y7(this.Dc)?
fa?(this.Dc.Jg(),sa.JK.i6(this.Dc,!1)):sa.ih.PKb(this.Dc):sa.JK.i6(this.Dc,!1):w.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Dc.ef)}yLc(fa){let Ma=null;if(fa&&fa.g8&&fa.cultureName)try{Ma=Object.assign(new H.a,{languageId:k.a.sg(fa.cultureName).LCID})}catch(Ua){w.a(8128526,307,!1,"Setting up culture {0} encountered {1}",fa.cultureName,Ua)}Ma||null==this.D5||(Ma=Object.assign(new H.a,{languageId:this.D5}));return Ma}get nU(){return this.e0g}set nU(fa){this.e0g=fa}Zvd(){}dge(){}o0e(){}get e1b(){return!1}get bAb(){return!1}IDm(fa){let Ma=
1;if(fa.Lki){var Ua=0;switch(fa.listStyleType){case 1:Ma=0;break;case 7:Ma=1;break;case 8:Ma=2;break;case 9:Ma=3;break;case 10:Ma=4;break;case 11:Ma=5}}else switch(Ua=1,fa.listStyleType){case 1:Ma=0;break;case 3:Ma=1;break;case 4:Ma=2;break;case 5:Ma=3}let Qa;Ua=(Qa=A.ListReader.HZ)?G.a.KP(Ua,Ma,wa(fa.roa),fa.listId,fa.listLevel,fa.levelText,fa.font):G.a.KP(Ua,Ma,wa(fa.roa));3!==fa.Gr&&(Ua.H4=fa.Gr);fa.Lki&&!fa.Fgi&&(Ua.gB=Qa&&0<fa.listId&&0<=fa.listLevel&&!fa.Ucc?fa.Khc:fa.mZk);!Ua.Rt||3!==Ua.listStyle&&
5!==Ua.listStyle||(Ua.mt="right");(fa=fa.CBf)&&Ua.propertySet.Hs(fa);Ua.e4b=!0;this.O0.Eae(this.Dc);return Ua}Bba(){}yba(){}Aba(){}zba(){}xba(){}wba(){}static get ih(){return null!=sa.qug?sa.qug:sa.qug=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get JK(){return null!=sa.eug?sa.eug:sa.eug=a.a.instance.resolve("Box4.IOutlineEditor")}static get Jn(){return null!=sa.Opg?sa.Opg:sa.Opg=a.a.instance.resolve("Box4.IFormattingEditor")}static get HM(){return null!=sa.Nyg?sa.Nyg:sa.Nyg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get nc(){return null!=
sa.rzg?sa.rzg:sa.rzg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get W6(){return null!=sa.Spg?sa.Spg:sa.Spg=a.a.instance.resolve("Box4.IFormattingReader")}static get pol(){return null!=sa.Tpg?sa.Tpg:sa.Tpg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}sa.If=null;Object(D.a)(sa,"Box4PasteStewardBase",null,[638,179,180])},1705:function(D,L,c){D=c(0);var l=c(52),e=c(8),a=c(2),k=c(41),m=c(353),w=c(22);class v{constructor(N,O,M,T){this.$Ce=null;this.Acd=T;this.Cra=N;this.Dra=
O;this.sY=M;this.K5g=this.yHb.J6n;N=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.lUj=N[0];this.kUj=N[1]}get yHb(){return this.$Ce||(this.$Ce=w.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get jhb(){return CommonUIStrings.l_OICErrorHelpLink}get A3c(){return this.K5g}get gwi(){return this.lUj}get fwi(){return this.kUj}get ewi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.K5g?
3:2}get ZHc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get zAd(){return!!this.Dra}get $Hc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}XUf(N){this.jWc(N)}pBf(N){this.jWc(N)}jWc(N){let O=10;this.Dra&&1===N&&(this.Dra(this.sY),O=1);this.Cra&&this.Cra(this.sY);this.WQ(O)}nIb(){m.Redirect.showHelp("OICFailure");this.WQ(2)}HJf(){this.yHb.hri();this.WQ(4)}WQ(N){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Acd,N);a.AFrameworkApplication.Fec(k.a.sIi,this.Acd,N)}dispose(){this.sY=this.Cra=this.Dra=null}}Object(D.a)(v,"AOICErrorDialog",null,[9]);var r=c(30),z=c(144);class A extends v{constructor(N,O,M,T){super(N,O,M,T);this.P$a=this.eF=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=this.errorMessage;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));this.eF=document.createElement("a");this.eF.href="#";this.eF.innerText=this.jhb;N.appendChild(this.eF);
r.a.addHandler(this.eF,"click",Object(l.a)(this,this.nIb,"oicErrorHelpLinkHandler"));O=new z.StandardDialog;O.mg=this.id;this.A3c?(M=document.createElement("span"),T=document.createElement("span"),M.innerText=this.gwi,T.innerText=this.fwi,this.P$a=document.createElement("a"),this.P$a.href="#",this.P$a.innerText=this.ewi,N.appendChild(document.createElement("br")),N.appendChild(M),N.appendChild(this.P$a),N.appendChild(T),r.a.addHandler(this.P$a,"click",Object(l.a)(this,this.HJf,"oicErrorMacOfferLinkHandler"))):
this.zAd&&(N.appendChild(document.createElement("br")),N.appendChild(document.createElement("br")),M=document.createElement("span"),M.innerText=this.ZHc,N.appendChild(M));this.zAd?(O.Ed=1,O.Ue(1,this.$Hc)):O.Ed=0;O.xv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.pBf,"legacyOICErrorDialogHandler"),N);O.k4("errorMessageText")}dispose(){this.eF&&(r.a.removeHandler(this.eF,"click",Object(l.a)(this,this.nIb,"oicErrorHelpLinkHandler")),this.eF=null);this.P$a&&(r.a.removeHandler(this.P$a,"click",
Object(l.a)(this,this.HJf,"oicErrorMacOfferLinkHandler")),this.P$a=null);super.dispose()}}Object(D.a)(A,"OICErrorDialog",v,[]);class G{constructor(N,O,M){this.Cra=O;this.Dra=N;this.sY=M}get id(){return"OICErrorDialogWithDownload"}get MKh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get jhb(){return CommonUIStrings.l_OICErrorHelpLink}get ZHc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get $Hc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}XUf(N){this.jWc(N)}pBf(N){this.jWc(N)}jWc(N){let O=
10;1===N&&(this.Dra(this.sY),O=1);this.Cra&&this.Cra(this.sY);this.WQ(O)}nIb(){m.Redirect.showHelp("OICFailure");this.WQ(2)}WQ(N){a.AFrameworkApplication.Fec(k.a.tIi,3,N)}dispose(){this.sY=this.Dra=this.Cra=null}}Object(D.a)(G,"AOICErrorDialogWithDownload",null,[9]);class H extends G{constructor(N,O,M){super(N,O,M);this.eF=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=this.MKh;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));this.eF=
document.createElement("a");this.eF.href="#";this.eF.innerText=this.jhb;N.appendChild(this.eF);r.a.addHandler(this.eF,"click",Object(l.a)(this,this.nIb,"oicErrorHelpLinkHandler"));N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));O=document.createElement("span");O.innerText=this.ZHc;N.appendChild(O);O=new z.StandardDialog;O.mg=this.id;O.Ed=1;O.Ue(1,this.$Hc);O.xv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.pBf,"legacyOICErrorDialogHandler"),N);O.k4("errorMessageText")}dispose(){this.eF&&
(r.a.removeHandler(this.eF,"click",Object(l.a)(this,this.nIb,"oicErrorHelpLinkHandler")),this.eF=null);super.dispose()}}Object(D.a)(H,"OICErrorDialogWithDownload",G,[]);var I=c(156);class K extends v{constructor(N,O,M,T){super(N,O,M,T);O={["errorMessage"]:this.errorMessage};O.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.jhb,["onExecute"]:R=>{this.nIb(R)}};this.A3c?(O.macOfficePreLinkText=this.gwi,O.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.ewi,
["onExecute"]:R=>{this.HJf(R)}},O.macOfficePostText=this.fwi):this.zAd&&(O.errorFileDownloadOffer=this.ZHc);N=new I.a(!1,!1,!0);this.zAd?(N.Ed=1,N.Ue(1,this.$Hc)):N.Ed=0;N.mg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};N.Wh(this.dialogTitle,Object(l.a)(this,this.XUf,"reactOICErrorDialogHandler"),O)}}Object(D.a)(K,"ReactOICErrorDialog",v,[]);class F extends G{constructor(N,O,M){super(N,O,M);O={["errorMessage"]:this.MKh,["errorFileDownloadOffer"]:this.ZHc};O.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.jhb,["onExecute"]:T=>{this.nIb(T)}};N=new I.a(!1,!1,!0);N.Ed=1;N.Ue(1,this.$Hc);N.mg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};N.Wh(this.dialogTitle,Object(l.a)(this,this.XUf,"reactOICErrorDialogHandler"),O)}}Object(D.a)(F,"ReactOICErrorDialogWithDownload",G,[]);c.d(L,"a",function(){return J});class J{constructor(){this.tra=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Pb.ZA}tVk(N,O,M){this.tra?new K(N,O,null,M):new A(N,O,null,
M)}uVk(N,O,M){this.tra?new F(N,O,M):new H(N,O,M)}vVk(N,O,M,T,R){const {ReactOICErrorDialogWithTrial:W}=c(1805),{OICErrorDialogWithTrial:V}=c(1806);this.tra?new W(N,O,M,null,T,R):new V(N,O,M,null,T,R)}static get instance(){return J._instance||(J._instance=new J)}}J._instance=null;Object(D.a)(J,"OICErrorDialogFactory",null,[1E3])},1706:function(D,L,c){c.r(L);D=c(0);var l=c(330),e=c(1783),a=c(938),k=c(375),m=c(2),w=c(61),v=c(1127),r=c(22),z=c(106),A=c(86),G=c(65),H=c(1410),I=c(133),K=c(35),F=c(15),J=
c(275),N=c(108),O=c(8),M=c(231),T=c(123),R=c(68),W=c(318),V=c(14),ba=c(36),ha=c(3),ca=c(11),ia=c(131),ra=c(550),da=c(54),za=c(1630),la=c(1629),na=c(359),Ca=c(241);class Na extends Ca.a{constructor(sa,fa,Ma,Ua,Qa,Ja){super();this.init(sa);this.il("DummyClipboardOperation");this.Lhb(m.AFrameworkApplication.ya,fa,Ua,Qa,Ja);this._context=Ma;this.nr=8;this.hpa()}run(){this.j$a=!0;this.s2c(this._context);this.c4a();this.nr=32}}Object(D.a)(Na,"DummyClipboardOperation",Ca.a,[]);Ca=c(1531);class Ta extends Ca.a{constructor(sa,
fa,Ma,Ua,Qa){super(sa,fa,Qa);this.ak=Ma;this.vLe=Ua}wjc(sa){let fa;if(this.lS&&!sa)return O.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Xta:null};fa=null;if(this.vLe&&!this.lS){const Ma=this.properties.ia(N.a.bLi,"");Ma&&(fa=this.ak.olb(Ma))}fa||(fa=this.ak.olb(sa));return{returnValue:!0,Xta:fa}}}Object(D.a)(Ta,"HtmlStringImportStrategy",Ca.a,[]);var Fa=c(1784);class qa extends Fa.a{constructor(sa,fa,Ma,Ua,Qa){super(sa,fa,Ma,Ua,Qa)}F1h(){return this.properties.ia(N.a.Ycc,
"")}wjc(sa){m.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.Y5g){if(this.ak)return sa=this.ak.EPf(sa,!0),{returnValue:!0,Xta:sa};O.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.wjc(sa)}OTc(sa){sa=super.OTc(sa);return sa.length&&" "!==sa?sa:"\u00a0"}}Object(D.a)(qa,"MultiLinePlainTextImportStrategy",Fa.a,[]);class ja extends Ca.a{constructor(sa,fa,Ma){super(sa,fa,Ma)}wjc(sa){({ClipboardActor:fa}=
c(1706));if(this.lS&&!sa)return O.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Xta:null};var fa=fa.vfn;fa.innerText=sa;return{returnValue:!0,Xta:fa}}}Object(D.a)(ja,"PlainTextImportStrategy",Ca.a,[]);var X=c(97),ua=c(67);class Ha{constructor(sa){this.isReady=this.Bxf=!1;this.Uda=sa}iNi(){this.Bxf||(this.Bxf=!0,this.isReady=!1,this.Uda.prepareForPaste(()=>{this.isReady=!0}));return this.isReady}alj(){this.Bxf=!1;const sa=this.Uda.paste();return sa?sa.hasChildNodes()?{returnValue:!0,
JAd:sa}:(O.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),Ha.Mc.fc(X.a.s0,{["Reason"]:ua.a.Obf}),{returnValue:!1,JAd:sa}):(O.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Ha.Mc.fc(X.a.lBb,{["Reason"]:ua.a.U8f}),{returnValue:!1,JAd:sa})}static get Mc(){return I.a.instance}}Object(D.a)(Ha,"SystemClipboardImportStrategy",null,[610]);var Ea=c(261);c.d(L,"ClipboardActor",function(){return wa});class wa{get Eqi(){return this.SJa}set Eqi(sa){this.SJa=sa}constructor(sa,fa,Ma,Ua,
Qa,Ja,Wa,Ya,sb,ob,fc,Eb,Ib,Nb,pb,Aa,xb,gb){this.fad=null;this.SJa=0;this.efd=this.wzc=!1;this.bqb=l.a.On;this.X3c=()=>{const Xa=Array(1);Xa.push("PasteRecoveryFloatie");var Va=this.xYj.QNa();Va=Object.assign(new e.a,{x:Va.x,y:Va.y});this.cL.showFloatie(Va,Xa,1);return 32};this.aEb=()=>{this.cL.c_&&this.cL.Ew();return 32};this.VPi=(Xa,Va,Gb,Xb,rc)=>{if(1===Gb)return 32;rc[a.a.On]=!1;return 32};this.g9k=(Xa,Va,Gb,Xb,rc,qb)=>{O.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Zb=
qb.DataTransfer;qb=Zb.getData("text/html");Zb=Zb.getData("text/plain");let Rb=!1;const Ra=new k.DictionaryPropertySet;0<qb.length?(O.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ra.setValue(N.a.PQ,qb),Rb=!0):0<Zb.length&&(O.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ra.setValue(N.a.Ycc,Zb),Rb=!0);if(Rb){const ab=this.Dx.J(Va);return this.kzd.create(Xa,Va,ab,new M.a(()=>this.qGc(ab,Ra)),Gb,Xb,rc,Ra)}return null};this.kUf=(Xa,Va,
Gb,Xb,rc)=>{if(Va="object"===typeof rc?rc:null)this.eXb?this.EVn(Xa,this.SJa,Va):Xa===ha.a.k6d?(Xa=this.SJa!==ha.a.reformatPastedContent&&this.SJa!==ha.a.eRa&&this.SJa!==ha.a.Uwa,Va[this.bqb]=this.SJa===ha.a.reformatPastedContent||Xa):Xa===ha.a.l6d?Va[this.bqb]=this.SJa===ha.a.eRa:Xa===ha.a.gUf&&(Va[this.bqb]=this.SJa===ha.a.Uwa);return 32};this.yW=(Xa,Va,Gb,Xb,rc,qb)=>{if((m.AFrameworkApplication.protectFile||m.AFrameworkApplication.pM)&&!m.AFrameworkApplication.TAb||Ea.a.dga(Gb)&&Ea.a.B8b())return new Na(Xa,
Va,Gb,Xb,rc,qb);let Zb=this.Dx.J(Va);1!==Xb&&Zb&1&&(this.SJa=Va);if(1!==Xb){var Rb=Object(T.a)(105,qb)?qb:null;qb?(Zb&1&&(this.fad=Rb),Rb=Rb?Rb.ia(N.a.WX,0):0,Va===ha.a.paste&&Rb===ha.a.uYa?Zb=this.Dx.J(ha.a.r2):Va===ha.a.n8&&Rb===ha.a.Cyb&&(Zb=this.Dx.J(ha.a.Y3d))):!qb&&Zb&4096&&(qb=this.fad,Rb=Object(T.a)(105,qb)?qb:null)&&(Rb=Rb.ia(N.a.hYc,w.a.nil),O.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Rb))}return this.kzd.create(Xa,Va,Zb,new M.a(()=>this.qGc(Zb,
qb)),Gb,Xb,rc,qb)};this.Rln=(Xa,Va,Gb,Xb,rc)=>this.xZe(Xa,Va,Gb,rc);this.Qln=(Xa,Va,Gb,Xb,rc)=>this.xZe(Xa,Va,Gb,rc);this.Pln=(Xa,Va,Gb,Xb,rc)=>this.xZe(Xa,Va,Gb,rc);this.OZd=(Xa,Va,Gb,Xb,rc,qb)=>{qb=ba.a.Uc(da.a.instance.hb.kb.Qa.node,qb);return this.yW(Xa,Va,Gb,Xb,rc,qb)};this.ZGj=sa;this.Uda=fa;this.rd=Ma;this.ak=Ua;this.ga=Ja;this.Fad=ob;this.ZQb=fc;this.ke=Eb;this.fg=Ib;this.Vb=sb;this.dXb=Nb;this.eXb=pb;this.xYj=Aa;this.cL=xb;this.Ize=gb;this.Fl=v.a.getInstance(na.a.xYa);Ya&&(this.wzc=Ya.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),
this.efd=this.eXb&&Ya.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Dx=new W.a;this.Dx.Z(ha.a.paste,257);this.Dx.Z(ha.a.n8,8449);this.Dx.Z(ha.a.r2,1);this.Dx.Z(ha.a.e1a,1);this.Dx.Z(ha.a.Uxb,1);this.Dx.Z(ha.a.$Aa,1);this.Dx.Z(ha.a.oRd,513);this.Dx.Z(ha.a.reformatPastedContent,4097);this.Dx.Z(ha.a.eRa,12289);this.Dx.Z(ha.a.Uwa,131073);this.Dx.Z(ha.a.MPf,7);this.Dx.Z(ha.a.LPf,1);this.Dx.Z(ha.a.Y3d,8193);this.Dx.Z(ha.a.copy,272);this.Dx.Z(ha.a.iCc,16);this.Dx.Z(ha.a.cut,304);this.Dx.Z(ha.a.CYe,
48);this.Dx.Z(ha.a.NZd,64);this.Dx.Z(ha.a.OZd,64);this.Dx.Z(ha.a.showPlaceholderGlossary,65536);this.Dx.Z(ha.a.a$e,1);this.efd&&this.Dx.Z(ha.a.ulb,this.Dx.J(ha.a.Y3d))}get xSa(){return null!=this.Owg?this.Owg:this.Owg=r.a.instance.Pa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.ixg?this.ixg:this.ixg=r.a.instance.Pa("Common.Utils.Telemetry.ITelemetry")}get kzd(){return this.ZGj.value}get Kio(){return this.Uda}Wb(){this.ga.gb(ha.a.Bpn,V.a.application,this.VPi,97);
this.ga.gb(ha.a.Cpn,V.a.application,this.VPi,97);this.ga.gb(ha.a.k6d,V.a.application,this.kUf,97);this.ga.gb(ha.a.l6d,V.a.application,this.kUf,97);this.ga.gb(ha.a.gUf,V.a.application,this.kUf,97);this.ga.tS(ha.a.CYe,V.a.view,this.yW,1028);this.ga.acb(ha.a.iCc,V.a.view,this.yW);this.ga.tS(ha.a.a$e,V.a.view,this.g9k,1028);this.ga.tS(ha.a.r2,V.a.view,this.yW,1028);this.ga.tS(ha.a.e1a,V.a.view,this.yW,1028);this.ga.tS(ha.a.Uxb,V.a.view,this.yW,1028);this.ga.tS(ha.a.$Aa,V.a.view,this.yW,1028);this.dXb&&
this.ga.gb(ha.a.uYa,V.a.view,this.Pln,1028);this.eXb&&this.ga.gb(ha.a.Cyb,V.a.view,this.Qln,1028);this.ga.tS(ha.a.paste,V.a.view,this.yW,1028);this.ga.tS(ha.a.n8,V.a.view,this.yW,1028);this.ga.tS(ha.a.Y3d,V.a.view,this.yW,1028);this.ga.tS(ha.a.LPf,V.a.view,this.yW,1028);this.ga.tS(ha.a.MPf,V.a.view,this.yW,1028);this.ga.tS(ha.a.reformatPastedContent,V.a.view,this.yW,1028);this.ga.tS(ha.a.eRa,V.a.view,this.yW,1028);this.ga.pa(ha.a.$Kb,V.a.view,z.ActionManager.Mf);this.ga.pa(ha.a.hLi,V.a.view,z.ActionManager.Mf);
this.ga.pa(ha.a.eLi,V.a.view,z.ActionManager.Mf);this.ga.pa(ha.a.fLi,V.a.view,z.ActionManager.Mf);this.ga.pa(ha.a.gLi,V.a.view,z.ActionManager.Mf);this.ga.pa(ha.a.dLi,V.a.view,z.ActionManager.Mf);this.ga.acb(ha.a.NZd,V.a.view,this.yW);this.ga.acb(ha.a.OZd,V.a.view,this.OZd);this.ga.acb(ha.a.oRd,V.a.view,this.yW);this.ga.acb(ha.a.showPlaceholderGlossary,V.a.view,this.yW);this.efd&&(this.ga.gb(ha.a.GCc,V.a.view,this.Rln,1028),this.ga.tS(ha.a.ulb,V.a.view,this.yW,1028));this.ga.pa(ha.a.cCh,V.a.view,
z.ActionManager.Mf);this.ga.pa(ha.a.BCh,V.a.view,z.ActionManager.Mf);this.Ize&&(this.ga.gb(ha.a.X3c,V.a.view,this.X3c,96),this.ga.gb(ha.a.aEb,V.a.view,this.aEb,96))}c4(){if(this.Vb){const sa=this.Vb.le(ia.AppFrame.oE);this.efd&&sa.bindAction(A.KeyInputManager.lc(G.a.upb,A.KeyInputManager.Rh|4),ha.a.GCc)}else O.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}EVn(sa,fa,Ma){switch(fa){case ha.a.eRa:case ha.a.n8:case ha.a.ulb:fa=ha.a.l6d;break;case ha.a.Uwa:fa=
ha.a.gUf;break;default:fa=ha.a.k6d}Ma[this.bqb]=sa===fa}HOl(){const sa=Object(T.a)(105,this.fad)?this.fad:null;return sa?sa.ia(N.a.hYc,w.a.nil):w.a.nil}xZe(sa,fa,Ma,Ua){if(1===Ma){if(!Object(T.a)(ra.a,fa)||!this.Fad||Ea.a.dga(fa)&&Ea.a.B8b())return 8;Ma=new M.a(()=>this.qGc(this.Dx.J(ha.a.r2),Ua));const Qa=this.Fad.create(Ma,Object(R.a)(105,Ua));Ma=new la.a(m.AFrameworkApplication.K,H.a.instance,Ma,I.a.instance,Qa,this.ZQb);return za.a.sph(fa,Ma)?32:8}if(2===Ma){if(this.N5n(ca.App.CXa))return this.uYa(sa);
ca.App.gec(()=>{this.uYa(sa)});return 32}return 2}uYa(sa){if(!this.ke)return O.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var fa=this.ke.hgb();if(!fa)return O.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;fa=fa.In;if(!fa)return O.ULS.sendTraceTag(592454659,307,10,"No document"),8;O.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",sa);this.Fl.logKpiUsage({kpiName:na.a.WLa});this.fg.ial(sa);sa=K.a.dBb(fa,"paste");fa=this.fg.b5k();O.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",fa);if(sa)return O.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.Fl.logKpiSuccess({kpiName:na.a.WLa}),32;this.N2l();O.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.Fl.logKpiFailure({kpiName:na.a.WLa,errorName:"ExecCommandFailed"});return 8}N2l(){this.xSa&&(this.xSa.WMb(),na.a.OXd(!0,da.a.instance,F.a.tF));if(this.telemetry){const sa=this.telemetry.F4c();sa.MZb("CallExecCommandPasteOperation");sa.fail("call to execCommand('paste') failed",
!0);this.telemetry.cfa(sa)}}N5n(sa){let fa=!1;this.Vb?this.Vb.currentScope?fa=!this.Vb.$uf(this.Vb.currentScope.name):O.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):O.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(fa){O.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Vb.currentScope.name);if(1>sa)return O.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Vb.nPh();return!1}return!0}qGc(sa,fa){return sa&256?new Ha(this.Kio):sa&2?sa&4096?new Ta(fa,
this.rd,this.ak,ca.App.instance.QQc,ca.App.instance.eSa):new ja(fa,this.rd,ca.App.instance.eSa):fa.hasProperty(N.a.Ycc)?new qa(fa,this.rd,this.ak,this.wzc,ca.App.instance.eSa):new Ta(fa,this.rd,this.ak,ca.App.instance.QQc,ca.App.instance.eSa)}static get vfn(){return J.a.sMd("Box4PasteScratchPad")}rph(sa,fa,Ma,Ua){return!m.AFrameworkApplication.protectFile&&!m.AFrameworkApplication.pM||m.AFrameworkApplication.TAb?(sa=this.yW(null,sa?ha.a.cut:ha.a.copy,fa,1,Ma,Ua))?sa.response:8:8}}Object(D.a)(wa,"ClipboardActor",
null,[])},1712:function(D,L,c){c.r(L);D=c(0);var l=c(16),e=c(1946),a=c(1762);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(D.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);class m{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(D.a)(m,"DeltaAttributes",null,[]);var w=c(1562),v=c(10),r=c(78),z=c(17),A=c(8),G=c(1619);c.d(L,"ACommentFormatTranslator",
function(){return H});class H{constructor(I){this.lg=I}Mkk(I,K){const F=v.ParagraphReader.text(K);let J=null,N=null,O=null,M=0;var T=0,R=!1;let W="";for(K.qa||F&&F.length&&"\n"!==F||A.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");M<K.qa.length;){const ba=K.qa.J(M),ha=ba.cp;var V=ba.formatting?ba.formatting.Vm:null;W+=l.a.substring(F,R?T+1:T,ha);ba.ql&&J&&(T=new e.a,T.fullName=W.startsWith("@")?W.substr(1):W,G.a(J,T),R=new k,G.c(J,R,T),I.Isf(W,T,R,
!0),W="",J=null);ba.ql&&N&&(T=O||new m,T.link=N.url,I.fei(W,T),W="",N=null);J&&N||""===W||(this.lg.hyb&&O?(I.uei(W,O),O=null):I.Sfa(W),W="");ba.hyperlink&&(ba.hyperlink.Zw?J=ba.hyperlink:ba.hyperlink.url&&(N=ba.hyperlink));this.lg.hyb&&V&&(O=new m,O.weight=V.ia(z.a.bold,!1)?w.a.ZEf:0,O.italic=V.ia(z.a.italic,!1),O.underline=V.ia(z.a.underline,!1),O.strikethrough=V.ia(z.a.strikethrough,!1),V.hasProperty(z.a.highlight)&&(T=V.getValue(z.a.highlight),O.highlight=r.a.jE(T)),V.hasProperty(z.a.fontColor)&&
(V=V.getValue(z.a.fontColor),O.color=r.a.jE(V)));T=ha;R=!!ba.blob;M++}}}H.Ook="_@_";H.Pok="Z";Object(D.a)(H,"ACommentFormatTranslator",null,[261])},1723:function(D,L,c){D=c(0);var l=c(156),e=c(16),a=c(23),k=c(22),m=c(2),w=c(239),v=c(159);class r{static get Hg(){return l.a.Sy(r.am,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}r.am="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(D.a)(r,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(18),A=c(3);c.d(L,"a",function(){return G});class G extends l.a{constructor(H,I,K){super();this.JMg=!1;this.sV=null;this.nnl=F=>{switch(F){case 1:this.ga.processAction(z.a.MPh,2);break;case 2:this.ga.processAction(z.a.NPh,2);break;case 0:this.ga.processAction(z.a.OPh,2)}};this.ku=I;this.eL=!1;this.WSb=G.Uml;this.Eh=H;this.ga=K;this.mg="FootnoteEndnoteFormattingOptionsDialog";this.Ed=2;this.Hg=r.Hg;this.Ue(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ue(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Wh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.nnl,null);this.ehb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.sV}set fontName(H){this.sV=H;if(H=document.getElementById("FontSizeComboBox"))H.focus(),this.Eh.updateCommandUI()}get fontSize(){return this.WSb}get ehb(){return this.JMg}set ehb(H){this.JMg=H;this.whn()}QX(){this.kxd("FontStyleComboBox",
"FontPlaceholder",z.a.MHd.toString(),z.a.EPi.toString(),z.a.xYc.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.kxd("FontSizeComboBox","FontPlaceholder",z.a.NHd.toString(),A.a.sZc.toString(),z.a.yYc.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.UZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),I=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.UZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.oCc("NoStyle","IndentPlaceholderStyles",
z.a.QPh.toString(),z.a.FPi.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.oCc("FirstLineIndent","IndentPlaceholderStyles",z.a.PPh.toString(),z.a.NTf.toString(),I,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}kxd(H,I,K,F,J,N,O){K=w.c(H,K,!0,!0,F,J,e.a.Cf(N),!0,O);this.CBd(H,I,K,"Medium")}oCc(H,I,K,F,J,N,O){K=w.g(H,K,F,e.a.Cf(J),e.a.Cf(N),O);this.CBd(H,I,K,"Large",N)}CBd(H,I,K,F,J=null){I=document.getElementById(I);
this.ku.BLa(H,K);K=this.ku.fgb(H,F);J&&a.a.Ovd(K,String.format("{0}Label",H),J);I.appendChild(K);this.ku.pU(H)}whn(){this.ku.pU("NoStyle");this.ku.pU("FirstLineIndent")}dispose(){this.eL||(this.ku.LE("FontStyleComboBox"),this.ku.LE("FontSizeComboBox"),this.ku.LE("NoStyle"),this.ku.LE("FirstLineIndent"),this.eL=!0);this.Eh.updateCommandUI();super.dispose()}static get HSa(){return k.a.instance.resolve("Common.IStandaloneRootController").L8}static ODl(){return new G(v.App.Fn,G.HSa,m.AFrameworkApplication.ya)}static NDl(){return G.ODl()}}
G.Uml=-1;Object(D.a)(G,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1751:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.Fi=this.djd=0;this.gMg=a;this.w4j=e}bkb(){return this.djd-this.Fi>=this.w4j}reset(){this.Fi=this.djd=this.gMg()}update(){this.djd=this.gMg()}}Object(D.a)(l,"TimeBasedTaskYieldStrategy",null,[334])},1762:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.contentId=""}}Object(D.a)(l,"AtMentionOptionalAttributes",
null,[])},1790:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.ObjectSchemaType=L.ObjectSemantic=L.SequenceType=L.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(L.IntentIds||(L.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(L.SequenceType||(L.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(L.ObjectSemantic||(L.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(L.ObjectSchemaType||(L.ObjectSchemaType={}))},1791:function(D,L,c){Object.defineProperty(L,"__esModule",
{value:!0});L.SearchSuggestionAnnotation=L.SearchSuggestionSignal=void 0;const l=c(232);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}L.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1799:function(D,L,c){var l=this&&this.$E||(Object.create?function(a,k,m,w){void 0===w&&(w=m);var v=Object.getOwnPropertyDescriptor(k,m);if(!v||("get"in v?!k.rz:v.writable||v.configurable))v={enumerable:!0,
get:function(){return k[m]}};Object.defineProperty(a,w,v)}:function(a,k,m,w){void 0===w&&(w=m);a[w]=k[m]}),e=this&&this.__exportStar||function(a,k){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(k,m)||l(k,a,m)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1800),L);e(c(1801),L);e(c(1802),L);e(c(1803),L);D.exports.ContractEntityAnnotation||Object.defineProperty(D.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return D.exports.ContractEntityAnnotation}});
D.exports.ContractEntitySignal||Object.defineProperty(D.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return D.exports.ContractEntitySignal}})},1800:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1801:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1802:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.ContractEntityAnnotation=void 0;const l=c(232);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}L.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1803:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.ContractEntitySignal=void 0;const l=c(232);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}L.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1805:function(D,L,c){c.r(L);c.d(L,"ReactOICErrorDialogWithTrial",function(){return k});D=c(0);var l=c(52);L=c(1647);var e=c(353),a=c(156);class k extends L.a{constructor(m,w,v,r,z,A){super(m,w,v,r,z,A);w={["errorMessage"]:this.LKh,["offerString"]:this.OBi};m=new a.a(!1,!1,!0);this.ebj?(m.Ed=1,w.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.jhb,["onExecute"]:()=>{e.Redirect.showHelp(this.nai)}}):
(m.Ed=4,m.Ue(2,this.ubi));m.Ue(1,this.Ptd);m.mg=this.id;w={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:w};m.Wh(this.dialogTitle,Object(l.a)(this,this.etn,"reactOICErrorDialogWithTrialHandler"),w)}}Object(D.a)(k,"ReactOICErrorDialogWithTrial",L.a,[])},1806:function(D,L,c){c.r(L);c.d(L,"OICErrorDialogWithTrial",function(){return a});D=c(0);var l=c(52);L=c(1647);var e=c(144);class a extends L.a{constructor(k,m,w,v,r,z){super(k,m,w,v,r,z);k=document.createElement("span");k.innerText=this.LKh;
k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));m=document.createElement("span");m.innerText=this.OBi;k.appendChild(m);m=new e.StandardDialog;this.ebj?(m.Ed=1,m.BSe(this.jhb,this.nai)):(m.Ed=4,m.Ue(2,this.ubi));m.Ue(1,this.Ptd);m.mg=this.id;m.xv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.YCm,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(D.a)(a,"OICErrorDialogWithTrial",L.a,[])},1809:function(D,L,c){var l=this&&this.$E||(Object.create?function(a,
k,m,w){void 0===w&&(w=m);Object.defineProperty(a,w,{enumerable:!0,get:function(){return k[m]}})}:function(a,k,m,w){void 0===w&&(w=m);a[w]=k[m]}),e=this&&this.__exportStar||function(a,k){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(k,m)||l(k,a,m)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1810),L);e(c(1811),L);D.exports.SearchProviderAnnotation||Object.defineProperty(D.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return D.exports.SearchProviderAnnotation}});
D.exports.SearchProviderSignal||Object.defineProperty(D.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return D.exports.SearchProviderSignal}})},1810:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1811:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.SearchProviderAnnotation=L.SearchProviderSignal=void 0;const l=c(232);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}L.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1812:function(D,
L,c){var l=this&&this.$E||(Object.create?function(a,k,m,w){void 0===w&&(w=m);var v=Object.getOwnPropertyDescriptor(k,m);if(!v||("get"in v?!k.rz:v.writable||v.configurable))v={enumerable:!0,get:function(){return k[m]}};Object.defineProperty(a,w,v)}:function(a,k,m,w){void 0===w&&(w=m);a[w]=k[m]}),e=this&&this.__exportStar||function(a,k){for(var m in a)"default"===m||Object.prototype.hasOwnProperty.call(k,m)||l(k,a,m)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1813),L);e(c(1814),L);D.exports.Result||
Object.defineProperty(D.exports,"Result",{enumerable:!0,get:function(){return D.exports.Result}});D.exports.TextExtractiveSummaryAnnotation||Object.defineProperty(D.exports,"TextExtractiveSummaryAnnotation",{enumerable:!0,get:function(){return D.exports.TextExtractiveSummaryAnnotation}})},1813:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.Result=void 0;D=L.Result||(L.Result={});D.BlockedByPostfilter="BlockedByPostfilter";D.BlockedByPostfilterProcessError="BlockedByPostfilterProcessError";
D.BlockedByPrefilter="BlockedByPrefilter";D.BlockedByQualityCheck="BlockedByQualityCheck";D.InvalidRequestForm="InvalidRequestForm";D.Success="Success";D.UnknownError="UnknownError"},1814:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.TextExtractiveSummaryAnnotation=L.ExtractiveSummarizationArray=L.ExtractiveSummarization=void 0;const l=c(232);class e{constructor(m){l.SchemaObject.assign(e,this,m)}static getTypeName(){return"AugLoop_TextExtractiveSummarization_ExtractiveSummarization"}static getBaseTypes(){return[]}static typeGuard(m){return l.SchemaObject.matchesTypesFor(m,
[e.getTypeName()])}}L.ExtractiveSummarization=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(m){l.SchemaObject.assign(a,this,m)}static getTypeName(){return"AugLoop_TextExtractiveSummarization_ExtractiveSummarizationArray"}static getBaseTypes(){return[]}static typeGuard(m){return l.SchemaObject.matchesTypesFor(m,[a.getTypeName()])}}L.ExtractiveSummarizationArray=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(m){l.SchemaObject.assign(k,this,m)}get metadata(){return this.M_}set metadata(m){this.M_=
m}static getTypeName(){return"AugLoop_TextExtractiveSummarization_TextExtractiveSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(m){return l.SchemaObject.matchesTypesFor(m,[k.getTypeName()])}}L.TextExtractiveSummaryAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1874:function(D,L,c){function l(ma){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ma?
J.zAn():J.main();fi.main(ma);yk.main(ma);z.a.instance.Kc(new Ip,0,ma);z.a.instance.Kc(new Qm,0,ma);mo(ma);Lj(ma)}var e=c(0),a=c(8),k=c(1545),m=c(1557),w=c(2),v=c(80),r=c(595),z=c(177),A=c(33),G=c(35),H=c(15),I=c(77),K=c(22),F=c(134);class J{get name(){return"Common.App.OAuth.OAuthPackage"}xc(ma){ma.register(164,"Common.App.OAuth.IOAuthManager").singleInstance().Xd(()=>new k.OAuthManager)}init(){const ma=K.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Sro(ma)}Sro(ma){const cb=w.AFrameworkApplication.K.lb("FileSource");
if(w.AFrameworkApplication.K.$("IsO365ConsumerHost")||w.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===cb){var zb=r.OAuthManagerSettings.A3e;if(zb&&zb.IsEnabled){var Wb=zb.Application,nc=r.OAuthManagerSettings.authority;if(void 0!==Wb&&null!==Wb&&Wb.length&&void 0!==nc&&null!==nc&&nc.length){var Uc=m.a[ma.Sia],Md=H.a.tF,ge=ma.qK();try{var Pd=new Map;void 0!==Pd&&null!==Pd?(Pd.set("SupportStatus",Uc),Pd.set("Browser",Md),Pd.set("AuthStrategy",ge)):Pd=null}catch(Xe){Pd=null}v.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT",
"WacOAuthFC",Pd);var te=G.a.Ye();ma.uia("Core",Wb).then(Xe=>{const Yf=Math.floor(G.a.Ye()-te);Uc=m.a[ma.Sia];Md=H.a.tF;ge=ma.qK();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Yf,Xe.IsSuccess,Uc,Xe.ErrorCode,cb,Md,ge);Pd&&(Pd.set("SupportStatus",Uc),Pd.set("Browser",Md),Pd.set("AuthStrategy",ge));var Jg=Object.assign(new F.a,{durationMs:Yf,
extendedProperties:Pd});if(Xe.IsSuccess){if(v.Health.instance.recordKpiSuccess("WacCorePFT",Jg),Xe="Bearer "+Xe.Token,w.AFrameworkApplication.Ve.Peg=Xe,Jg=zb.Endpoint){var $h=G.a.Ye();w.AFrameworkApplication.Ve.eZb(Jg,1,null,{["Authorization"]:Xe},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(ei=>{var rl=Math.floor(G.a.Ye()-$h),Bi=null;ei.yo?ei="Canceled":ei.Di?ei="Faulted":(Bi=ei.result,ei=Bi.succeeded?"Completed":"Failed");rl={["TaskResult"]:ei,["BrowserTokenDurationMS"]:Yf,
["BrowserValidationDurationMS"]:rl};Bi&&(rl.HttpStatus=Bi.args.data.jf,Bi.succeeded&&(Bi=A.a(Bi.args.data.Ae),rl.ServerValidationDurationMS=Bi.ElapsedMilliseconds,rl.ServerValidationResult=Bi.ValidatedToken,rl.KMSI=Bi.KMSI,rl.Scopes=Bi.Scopes,rl.TokenExpirationS=Math.floor(parseInt(Bi.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===ei?50:15,I.a.toJSON(rl))})}}else v.Health.instance.recordKpiFailure("WacCorePFT",Xe.ErrorCode,!1,!1,Jg)}).catch(Xe=>{var Yf=Math.floor(G.a.Ye()-
te);Yf=Object.assign(new F.a,{durationMs:Yf,extendedProperties:Pd});v.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Xe.toString(),!1,!1,Yf)})}}}}dispose(){}static main(){z.a.instance.Kc(new J)}static zAn(){z.a.instance.Kc(new J,0,!0)}}Object(e.a)(J,"OAuthPackage",null,[1,2]);var N=c(303),O=c(412),M=c(16);class T{constructor(){this.ipd=new O.a}Fro(ma,cb){if(!ma)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ma=M.a.jh(ma);if(this.ipd.ub(ma))return a.ULS.sendTraceTag(40478032,
306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ma),!1;this.ipd.Z(ma,cb);return!0}klf(ma){if(!ma)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ma=M.a.jh(ma);return this.ipd.ub(ma)?this.ipd.J(ma):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",ma),null)}}Object(e.a)(T,"SdxPaneSuppressionManager",null,[]);var R=c(231),W=c(269),V=c(11);class ba{constructor(ma){this.xEe=0;this.JVj=ma}bkb(){return this.xEe>=
this.JVj}reset(){this.xEe=0}update(){this.xEe++}}Object(e.a)(ba,"NodeCountBasedTaskYieldStrategy",null,[334]);var ha=c(1751);class ca{constructor(){this.m2c=new Set}iec(ma){this.m2c.add(ma)}Yto(ma){this.m2c.delete(ma)}e9m(){return()=>{this.m2c.forEach(ma=>{ma.onSessionClose()})}}f9m(){return()=>{this.m2c.forEach(ma=>{ma.onSessionConnect()})}}g9m(){return()=>{this.m2c.forEach(ma=>{ma.onSessionDisconnect()})}}}Object(e.a)(ca,"AlSessionLifeEventNotifier",null,[291]);var ia=c(1365),ra=c(71),da=c(69),
za=c(83),la=c(61),na=c(7),Ca=c(1470),Na=c(174),Ta=c(392),Fa=c(1482),qa=c(704),ja=c(254),X=c(430),ua=c(680),Ha=c(453),Ea=c(510);class wa{constructor(){this.token=null}}Object(e.a)(wa,"ReleaseAnnotationParameters",null,[]);class sa{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(sa,"SetAnnotationMetadataParameters",null,[]);class fa{constructor(){this.id=this.parentPath=null;this.value=0}}Object(e.a)(fa,"SetAnnotationStateParameters",null,[]);var Ma=c(524),Ua=c(376),Qa=c(82),Ja=c(85),
Wa=c(596),Ya=c(1187),sb=c(319),ob=c(750),fc=c(10),Eb=c(442);class Ib extends Sys.EventArgs{constructor(ma,cb){super();this.annotation=ma;this.pcb=cb}}Object(e.a)(Ib,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Nb=c(982);class pb{constructor(ma){this.ZUe=this.annotations=null;if(!ma)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=null;else if(ma.items&&0<ma.items.length){const cb=pb.JLd(ma.parentPath);this.annotations=Array(ma.items.length);let zb=0;
for(const Wb of ma.items){const nc=Object.assign(new Nb.a,{id:Wb.id,parentPath:cb,content:Wb.body,annotationType:ja.a.getTypeNameFor(Wb.body),parentRevId:ma.parentRevId});this.annotations[zb++]=nc}this.ZUe=ja.a.getTypeNameFor(ma)}}static JLd(ma){return ma?ma.join("\\"):""}}Object(e.a)(pb,"AnnotationOperation",null,[]);class Aa extends Sys.EventArgs{constructor(ma,cb){super();this.annotationType=ma;this.activated=cb}}Object(e.a)(Aa,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class xb extends Sys.EventArgs{constructor(ma,
cb){super();this.annotation=ma;this.opType=cb}}Object(e.a)(xb,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class gb{constructor(){this.newState=this.oldState=0;this.handlers=new Qa.a}}Object(e.a)(gb,"AnnotationResultStateUpdateData",null,[]);var Xa=c(482),Va=c(976);class Gb{constructor(){this.WUe=this.Ejk=this.XUe=null}}Object(e.a)(Gb,"AnnotationCallbacks",null,[]);class Xb{constructor(ma,cb,zb,Wb,nc,Uc){this.DYb=null;this.Gvc=new O.a(0);this.Rzc=new O.a;this.u$c=new O.a;this.Cmd=new Xa.a;this.JMf=
null;this.Lh=ma;this.IJa=cb;this.UH=zb;this.JD=Wb;this.BV=nc;this.Wc=Uc}hGo(ma,cb,zb,Wb){this.JD.U7b(ma)&&this.Lh.Sd(()=>{if(!this.DYb){this.DYb=new O.a;var nc=fc.ParagraphReader.Yv(Eb.a.getRootNode(),!0,!0);for(const Uc of nc)Uc&&(nc=Uc.ia(na.a.Pc,0))&&(this.DYb.add(nc,Uc.id),this.Gvc.Z(Uc.id.toString(),nc))}this.IJa.IMf(ma,(Uc,Md)=>{if(Uc){var ge=this.JD.m_h(ma);Uc.contentDescriptor.vv===ge&&((ge=this.kEl(Uc))?Uc.ocb?(ge=this.Q3e(Uc,ge))&&(Md?zb(Md,Uc.contentDescriptor):cb(ge,Uc.contentDescriptor)):
Wb(Uc.contentDescriptor):this.D0k(Uc,Object.assign(new Gb,{XUe:cb,Ejk:zb,WUe:Wb})))}})},"PAS:FEPAOT")}kEl(ma){if(3===ma.contentDescriptor.vv){let cb;return({value:cb}=this.DYb.Gc(ma.contentDescriptor.paragraphId)).returnValue?cb:null}if(4===ma.contentDescriptor.vv)return la.a.nil;a.ULS.sendTraceTag(592525442,Xb.Gi,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}ypm(ma,cb){if(3===ma.contentDescriptor.vv)return cb=this.BV.value.Db(cb).getValue(na.a.wj),ma.contentDescriptor.wj===
cb;if(4===ma.contentDescriptor.vv&&cb===la.a.nil)return!0;a.ULS.sendTraceTag(592525443,Xb.Gi,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}D0k(ma,cb){if(3===ma.contentDescriptor.vv){const zb=ma.contentDescriptor.paragraphId;this.Rzc.ub(zb)||this.Rzc.add(zb,new Qa.a);this.Rzc.J(zb).add(Wb=>{12===Wb.type&&this.DYb.add(zb,Wb.id);ma.ocb?(Wb=this.Q3e(ma,Wb.id))&&cb.XUe(Wb,ma.contentDescriptor):cb.WUe(ma.contentDescriptor)})}else if(4===ma.contentDescriptor.vv)if(ma.ocb){const zb=
this.Q3e(ma,la.a.nil);zb&&cb.XUe(zb,ma.contentDescriptor)}else cb.WUe(ma.contentDescriptor);else a.ULS.sendTraceTag(592525444,Xb.Gi,15,"DelayCallbackForAnnotation: Unsupported content type")}Q3e(ma,cb){if(this.ypm(ma,cb)){if(cb=this.JD.pYm(ma.ocb,ma.contentDescriptor,cb.toString()))return this.u$c.Z(cb.id,ma.w4a),cb}else this.Wc.isFeatureEnabled(89)&&this.UH.vAc(ma);return null}Mpj(ma,cb){const zb=this.JD.lJd(ma);zb&&(cb===Fa.a.getTypeName()?this.lqo(ma,zb):this.$po(ma,zb))}lqo(ma,cb){this.JD.U7b(ma.annotationType)&&
(this.UH.lRa(this.BV.value,cb,ma.annotationType),this.u$c.remove(ma.id))}$po(ma,cb){if(this.JD.U7b(ma.annotationType)){cb=Object.assign(new Va.a,{ocb:this.JD.Ijk(ma),contentDescriptor:cb,annotationType:ma.annotationType});cb=this.UH.addAnnotation(this.BV.value,cb);this.u$c.Z(ma.id,cb);const zb=this.JD.A7h(ma.annotationType);zb&&this.Cmd.contains(zb)&&(this.Lh.Sd(()=>{var Wb=fc.ParagraphReader.Yv(Eb.a.getRootNode(),!0,!0);if(Wb&&0<Wb.count){const nc=new Qa.a;for(const Uc of Wb)(Wb=Xb.FLd(Uc))&&nc.add(Wb);
0<nc.count&&this.UH.rdh(this.BV.value,zb,nc.toArray())}},"PAS:TAOCPA"),this.Cmd.remove(zb))}}Nkb(ma){if(this.DYb)if(ma){var cb=ma.ia(na.a.Pc,0);if(cb&&(this.Gvc.Z(ma.id.toString(),cb),({value:cb}=this.Rzc.Gc(cb)).returnValue))for(const zb of cb)zb(ma)}else a.ULS.sendTraceTag(592525445,Xb.Gi,10,"OnParagraphNodeConnected: Invalid node")}JFi(ma,cb){if(ma){var zb=ma.id.toString();ma=ma.ia(na.a.Pc,0);var Wb=0;({value:Wb}=this.Gvc.Gc(zb)).returnValue&&(3===cb?(this.Rzc.remove(Wb),this.Gvc.remove(zb)):2===
cb?this.Gvc.Z(zb,ma):a.ULS.sendTraceTag(592525447,Xb.Gi,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,Xb.Gi,10,"UpdatePersistedAnnotations: Invalid node")}eRl(ma){let cb;return({value:cb}=this.u$c.Gc(ma)).returnValue?cb:la.a.nil}WBo(ma,cb,zb){ma?cb?this.IJa.J1h(ma,Wb=>{if(Wb){const Md=Xb.FLd(cb,zb);if(Md){var nc=Array(Wb.length),Uc=!1;for(let ge=0;ge<Wb.length;ge++)if(Uc||Md!==Wb[ge])nc[ge]=Wb[ge];else{const Pd=Xb.FLd(cb);if(!Pd)return;
Uc=!0;nc[ge]=Pd;Wb[ge]=Pd}Uc&&this.UH.rdh(this.BV.value,ma,nc)}}}):a.ULS.sendTraceTag(588863697,Xb.Gi,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,Xb.Gi,10,"UpdateWorkflowParagraphVersion: null workflowType")}Y_n(ma){ma?this.Cmd.add(ma):a.ULS.sendTraceTag(588863698,Xb.Gi,10,"SetPendingWorkflow: null workflowType")}iGk(ma){ma?this.Cmd.remove(ma):a.ULS.sendTraceTag(588105731,Xb.Gi,10,"ClearPendingWorkflow: null workflowType")}static FLd(ma,cb=0){if(!ma)return null;
cb||(cb=ma.ia(na.a.wj,0));ma=fc.ParagraphReader.eQ(ma);if(cb&&ma)return String.format("{0}{1}{2}",ma,Xb.cen,cb);a.ULS.sendTraceTag(588091606,Xb.Gi,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",cb?"valid":"0",ma?"valid":"0");return null}}Xb.Gi=389;Xb.cen="-";Object(e.a)(Xb,"PersistedAnnotationStorage",null,[314]);class rc{constructor(){this.config=this.token=null}}Object(e.a)(rc,"UpdateAnnotationConfigParameters",null,[]);var qb=c(132),Zb=c(1166),Rb=c(356),Ra=c(1376),ab=c(853),
fb=c(277),bb=c(1074);class Ub{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf=null,Jg){this.Wab=Jg;this.sa=new da.a;this.wya=new Ja.a;this.j9=new Ja.a;this.KD=new Ja.a;this.Cme=new Ja.a;this.uoc=new Ma.a(Ua.a.Ri());this.UFe=new Qa.a;this.mQb=new Ja.a;this.yme=new Ja.a;this.v$c=new Ja.a;this.nQb=new Ja.a;this.Plc=new Ja.a;this.w$c=new Ja.a;this.Gbd=new Ja.a;this.Dkd=[];this.Ekd=[];this.Stc=null;this.KVj=new Ma.a(Ua.a.Ri());this.Ame=new Map;this.roc=new Map;this.Xmc=null;this.Qia=new Ja.a;this.LFc=
null;this.U_g=this.hPg=0;this.IWa=null;this.cZk=()=>{if(this.Dkd.length||this.Ekd.length)try{0<this.Dkd.length&&this.cRm(),0<this.Ekd.length&&this.uto()}finally{this.vGk()}else this.Gb.Se(this.Stc),this.Stc=null};this.rGk=()=>{const $h=new Qa.a;for(const ei of this.KD.values)if($h.add(ei),$h.count===Ub.TVj)break;for(const ei of $h)this.e2b(ei),this.KLb(ei,Fa.a.getTypeName());this.KD.count||(this.Gb.Se(this.Xmc),this.Xmc=null)};this.jLf=($h,ei)=>{for(const rl of ei.Sj)$h=rl.intent,!$h.type&&this.u5n($h.intent,
rl.cpBegin,rl.cpEnd,rl.SGb)&&this.e2b($h.intent)};this.AQj=ma.$("AugLoopAnnotationsAttachingIsEnabled");this.e1j=ma.XB("SendReleaseMessageAnnotationList")||[];this.Wc=te;this.YHa=Yf;this.IJa=Uc;this.UH=Md;this.vp=zb;this.JD=ge;this.Y9=Pd;this.BV=Wb;this.Lh=cb;this.Gb=nc;K.a.instance.resolve("Box4.ICharacterPropertiesEditor").cfh(this.jLf);this.tv=Xe;this.SDj=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.qQj=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1);this.eSj=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.kRg=ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.Wab&&this.W3l();this.Ww=fb.a.instance}get VTi(){return this.nQb}set VTi(ma){this.nQb=ma}mb(ma,cb){a.ULS.sendTraceTag(41521862,Ub.Gi,50,"New registration for annotation type: {0}.",cb);this.addHandler(ma,cb);this.JRe(cb).catch(zb=>{a.ULS.sendTraceTag(594396739,Ub.Gi,10,"Failed to activate annotation type {0}: {1}",
cb,zb.toString())})}addHandler(ma,cb){if(ma&&cb&&""!==cb){var zb=null;({value:zb}=this.nQb.Gc(cb,zb)).returnValue?zb.add(ma):(zb=new Qa.a,zb.add(ma),this.nQb.add(cb,zb))}else a.ULS.sendTraceTag(41521861,Ub.Gi,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ma,!cb,""===cb)}sc(ma,cb){a.ULS.sendTraceTag(41521863,Ub.Gi,50,"Unregister handler for annotation type: {0}.",cb);let zb=null;({value:zb}=this.nQb.Gc(cb,zb)).returnValue&&(zb.remove(ma),
zb.count||(a.ULS.sendTraceTag(41521864,Ub.Gi,50,"Unregister all handlers for annotation type: {0}.",cb),this.nQb.remove(cb),this.B0m(cb)))}I7i(ma){this.LFc||(this.LFc=this.tv.Qc(2),this.LFc.Eb(ma))}vGk(){var ma;null===(ma=this.LFc)||void 0===ma?void 0:ma.dispose();this.LFc=null}Syh(){this.Stc||(this.Stc=new za.a(4,2,100,this.cZk,141),this.Gb.Xb(this.Stc))}cRm(){let ma;ma=Array.dequeue(this.Dkd);const cb=Eb.a.DLc(this.BV.value,ma);if(cb)if(cb.Wi){this.I7i(cb);var zb=null;if(({value:zb}=this.Plc.Gc(ma,
zb)).returnValue){this.Plc.remove(ma);for(const Wb of zb)this.dRm(cb,Wb)}else a.ULS.sendTraceTag(50663568,Ub.Gi,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.KVj.add(ma);else a.ULS.sendTraceTag(50436127,Ub.Gi,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}dRm(ma,cb){var zb=cb.content.range;zb=new Ya.a(0,zb.start,zb.start+zb.length,la.a.create(),cb,Wb=>{this.Cme.Z(cb.id,Wb.toString())});this.vp.W2a(ma,zb);this.sa.m7&&this.sa.raiseEvent(Ub.Abc,new xb(cb,
Ta.a.getTypeName()))}Ewi(ma){const cb=Eb.a.rDb(ma.parentPath);let zb=null;({value:zb}=this.Plc.Gc(cb,zb)).returnValue||(zb=new Qa.a,this.Plc.add(cb,zb),this.Dkd.push(cb));zb.add(ma);this.Syh()}fRm(ma,cb){this.Lh.Sd(()=>{let zb;if(({value:zb}=this.j9.Gc(ma,zb)).returnValue){var Wb=this.P$i(ma);for(const nc of zb){let Uc;({value:Uc}=this.KD.Gc(nc,Uc)).returnValue&&cb(Uc)&&Ub.QEb(Uc)&&(this.Ewi(Uc),Wb&&this.sa.raiseEvent(Ub.Abc,new xb(Uc,Fa.a.getTypeName())))}}},"AS:MIFAT")}vto(ma,cb){this.Lh.Sd(()=>
{let zb;if(({value:zb}=this.j9.Gc(ma,zb)).returnValue)for(const Wb of zb){let nc;({value:nc}=this.KD.Gc(Wb,nc)).returnValue&&cb(nc)&&Ub.QEb(nc)&&this.Ebg(nc)}},"AS:UIFAT")}H0m(ma){var cb=Eb.a.UL(ma);let zb=null;if(({value:zb}=this.wya.Gc(cb,zb)).returnValue){cb=0;for(var Wb=new Qa.a;zb.count>cb;){var nc=zb.J(cb),Uc=null;({value:Uc}=this.KD.Gc(nc,Uc)).returnValue&&Ub.QEb(Uc)?this.JD.u3c(ma,Uc)?this.e2b(Uc,!this.Wc.isFeatureEnabled(89)):(nc=Uc.content.range,Uc=new Ya.a(0,nc.start,nc.start+nc.length,
la.a.create(),Uc),Wb.add(Uc),cb++):cb++}0<Wb.count&&this.vp.$Df(ma,Wb)}}uto(){let ma="";ma=Array.dequeue(this.Ekd);const cb=Eb.a.DLc(this.BV.value,ma);if(cb&&12===cb.type){this.I7i(cb);var zb=null;({value:zb}=this.w$c.Gc(ma,zb)).returnValue?(this.vp.Gbg(Wb=>zb.contains(Wb.intent),cb,0),this.w$c.remove(ma)):a.ULS.sendTraceTag(50663570,Ub.Gi,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,Ub.Gi,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}Ebg(ma){let cb;
({value:cb}=this.Cme.Gc(ma.id,cb)).returnValue||(cb=Eb.a.rDb(ma.parentPath));this.Cme.remove(ma.id);var zb=null;({value:zb}=this.w$c.Gc(cb,zb)).returnValue||(zb=new Qa.a,this.w$c.add(cb,zb),this.Ekd.push(cb));zb.add(ma);this.Syh();zb=null;({value:zb}=this.Plc.Gc(cb,zb)).returnValue&&zb.remove(ma)}$ak(ma){const cb=ma.id;var zb=ma.annotationType;const Wb=ma.parentPath;if(this.JD.Eib(ma)){var nc=Eb.a.wgb(this.BV.value,Wb);if(nc&&(nc=nc.ia(na.a.wj,0).toString(),ma.parentRevId&&nc!==ma.parentRevId))return!1}nc=
null;({value:nc}=this.j9.Gc(zb,nc)).returnValue||(nc=new Qa.a,this.j9.add(zb,nc));nc.add(cb);zb=null;({value:zb}=this.wya.Gc(Wb,zb)).returnValue||(zb=new Qa.a,this.wya.add(Wb,zb));zb.add(cb);this.KD.add(cb,ma);this.gGo(ma);return!0}gGo(ma){const cb=this.JD.cSh(ma);if(0===cb.length)this.gGh(ma);else{let zb=!1;this.IJa.e7m(cb,ma.annotationType,(Wb,nc)=>{this.KD.ub(ma.id)?(nc=this.JD.Uib(ma,Eb.a.Rsl(ma)),!Wb&&nc?this.Ncg(ma,10,!1):Wb&&this.Ncg(ma,Wb),zb||(this.gGh(ma),zb=!0)):nc.fSa=!0})}}gGh(ma){const cb=
Ub.QEb(ma);cb&&this.Ewi(ma);!cb&&this.sa.m7&&this.sa.raiseEvent(Ub.Abc,new xb(ma,Ta.a.getTypeName()))}lnj(ma,cb,zb,Wb){let nc=!0;this.Lh.Sd(()=>{if(Wb.startsWith(Eb.a.BAb)){var Uc=ma.id,Md=null;if(cb===Fa.a.getTypeName())this.e2b(ma);else if(({value:Md}=this.KD.Gc(Uc,Md)).returnValue)a.ULS.sendTraceTag(41418891,Ub.Gi,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Uc,ma.annotationType),this.KD.Z(Uc,ma);else if(!this.$ak(ma)){nc=!1;return}zb&&cb===Ta.a.getTypeName()&&
Wb!==Eb.a.BAb&&this.UFe.add(ma.annotationType)}this.KLb(ma,cb)},"AS:UAS");return nc}lWn(ma){if(ma)for(const cb of ma)this.KLb(cb,qa.a.getTypeName()),ma=cb.content,this.Gbd.ub(ma.categoryName)?this.Gbd.Z(ma.categoryName,cb):this.Gbd.add(ma.categoryName,cb);else a.ULS.sendTraceTag(592802119,Ub.Gi,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}Jek(ma){this.sa.addHandler(Ub.Abc,ma)}Oeh(ma){this.sa.addHandler(Ub.BCi,ma)}T7b(ma){return this.mQb.ub(ma)}Iek(ma){this.sa.addHandler(Ub.b0d,
ma)}vFn(ma){this.sa.removeHandler(Ub.b0d,ma)}P$i(ma){return!Eb.a.kf(ma)&&ob.a(ma)&&this.sa.m7}e2b(ma,cb=!0){if(this.KD.ub(ma.id)){var zb=this.KD.J(ma.id);this.KD.remove(ma.id);var Wb=null;({value:Wb}=this.wya.Gc(ma.parentPath,Wb)).returnValue?(Wb.remove(ma.id),Ub.QEb(zb)&&this.Ebg(zb)):a.ULS.sendTraceTag(50734169,Ub.Gi,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Wb=null;({value:Wb}=this.j9.Gc(ma.annotationType,Wb)).returnValue?Wb.remove(ma.id):a.ULS.sendTraceTag(50734170,
Ub.Gi,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.P$i(ma.annotationType)?this.sa.raiseEvent(Ub.Abc,new xb(zb,Fa.a.getTypeName())):this.KLb(ma,Fa.a.getTypeName());cb&&this.Y9.Mpj(zb,Fa.a.getTypeName())}}Xff(ma,cb,zb=!1){const Wb=new Qa.a;var nc;if(!({value:nc}=this.j9.Gc(ma,nc)).returnValue)return Wb;for(const Uc of nc)this.KD.ub(Uc)?(ma=this.KD.J(Uc),(nc=this.JD.lJd(ma))&&(cb.equals(nc)||zb&&cb.overlaps(nc))&&Wb.add(ma)):a.ULS.sendTraceTag(577843217,
Ub.Gi,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Uc);return Wb}umm(ma){return ja.a.getTypeNameFor(ma)===Rb.a.getTypeName()}Qhi(ma){var cb,zb;return(null===(zb=null===(cb=this.Wab)||void 0===cb?void 0:cb.i_h)||void 0===zb?void 0:zb.call(cb))===Zb.a.Skc&&ma&&0===ma.priority?this.Wab.A5c(ma.context.substr(ma.startInContext,ma.range.length)):!1}IOi(ma,cb){this.Lh.Sd(()=>{a.ULS.O8(Ub.Gi,100)&&a.ULS.sendTraceTag(41418894,Ub.Gi,100,"Operation of type {0} with path {1} received",
ja.a.getTypeNameFor(ma),ma.parentPath.join("\\"));try{const zb=new pb(ma);for(const Wb of zb.annotations)if(Wb.annotationType===ab.FlagResultAnnotation.getTypeName()){const nc=Wb.content.results.map(Uc=>({id:Wb.id,body:Uc,source:"",revId:"",contextId:""}));this.IOi({items:nc,parentPath:ma.parentPath,parentRevId:ma.parentRevId,H_:ma.H_},cb)}else zb.ZUe===Ta.a.getTypeName()&&this.$7n(Wb)?(w.AFrameworkApplication.Ce("g8469255;j5hhe441"),this.kRg&&(this.IWa||(this.IWa=bb.a.egf()),this.hPg++,this.IWa.Vbh("AnnotationSkippedDueToInvalidContextCount",
this.hPg.toString()))):this.P8h(Wb,cb,zb.ZUe,!0)}catch(zb){a.ULS.sendTraceTag(41418898,Ub.Gi,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",zb.message,zb.stack)}},"AS:PO")}$7n(ma){var cb;w.AFrameworkApplication.Ce("01dfc961;05c12706");if(this.eSj&&ob.a(ma.annotationType)){var zb;let nc=zb=null;if(this.Ww){zb=this.Ww.lfa;var Wb=null===zb||void 0===zb?void 0:zb.node;zb=Eb.a.rDb(ma.parentPath);if(Eb.a.DLc(this.BV.value,zb)!==Wb)return!1;ma=ma.content;zb=ma.context.substring(ma.startInContext,
ma.startInContext+ma.range.length);nc=null===(cb=null===Wb||void 0===Wb?void 0:Wb.characterData)||void 0===cb?void 0:cb.substring(ma.range.start,ma.range.start+ma.range.length);this.kRg&&ma&&0===ma.priority&&(cb=0<ma.range.start?Wb.characterData.charAt(ma.range.start-1):null,Wb=ma.range.start+ma.range.length<Wb.characterData.length?Wb.characterData.charAt(ma.range.start+ma.range.length):null,"en-us"==ma.language.toLocaleLowerCase()&&nc&&zb&&nc===zb&&(cb&&cb.match("[A-Za-z0-9]")||Wb&&Wb.match("[A-Za-z0-9]"))&&
(this.IWa||(this.IWa=bb.a.egf()),this.U_g++,this.IWa.Vbh("partialWordAnnotationsCount",this.U_g.toString())))}return nc&&zb&&nc!==zb?!0:!1}return!1}P8h(ma,cb,zb,Wb){if(this.umm(ma.content)&&this.Qhi(ma.content))this.XSa(ma,70);else{var nc=ma.parentPath;zb!==Fa.a.getTypeName()&&Wb||this.FUi(ma);Wb&&zb===Ta.a.getTypeName()&&ob.a(ma.annotationType)&&ma.content.isHotCritique&&this.qQj?this.roc.set(ma.id,{annotation:ma,time:Date.now()}):(Wb=ma.annotationType,Eb.a.kf(Wb)||Wb!==X.a.getTypeName()?!Eb.a.kf(Wb)&&
ob.a(Wb)&&ma.content&&0==ma.content.priority&&qb.a.x3?(ma=Eb.a.rDb(nc))&&ma==qb.a.irl()&&a.ULS.sendTraceTag(539870169,Ub.Gi,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):zb!==Fa.a.getTypeName()&&this.uoc.contains(nc)?a.ULS.sendTraceTag(41418897,Ub.Gi,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",nc,ma.id):this.jnj(ma,nc,zb,cb):a.ULS.sendTraceTag(595342670,Ub.Gi,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",
nc))}}DCn(ma){if(ma&&ma.annotationType&&this.JD.U7b(ma.annotationType)){var cb;if(({value:cb}=this.j9.Gc(ma.annotationType,cb)).returnValue&&(ma=this.JD.lJd(ma)))for(const zb of cb){let Wb;({value:Wb}=this.KD.Gc(zb,Wb)).returnValue&&(cb=this.JD.lJd(Wb))&&(ma.equals(cb)||ma.overlaps(cb))&&this.e2b(Wb)}}}KLb(ma,cb){this.Lh.Sd(()=>{let zb=null;if(({value:zb}=this.VTi.Gc(ma.annotationType,zb)).returnValue)for(const Wb of zb)Wb.mD(ma,cb)},"AS:SATH")}qGk(){a.ULS.sendTraceTag(50860999,Ub.Gi,50,"ClearStorage: Initiated Clearing Storage");
this.Xmc||(this.Xmc=new za.a(4,2,100,this.rGk,142),this.Gb.Xb(this.Xmc))}activateAnnotation(ma,cb){let zb;if(({value:zb}=this.v$c.Gc(ma,zb)).returnValue){if(zb.contains(cb))return Promise.resolve(null);zb.add(cb)}else{let Wb;this.v$c.add(ma,(Wb=new Qa.a,Wb.add(cb),Wb))}return this.JRe(ma)}JRe(ma){a.ULS.sendTraceTag(41521865,Ub.Gi,50,"ActivateAnnotation: Activating annotation type {0}.",ma);if(this.mQb.ub(ma))return Promise.resolve(null);var cb=null;if(({value:cb}=this.yme.Gc(ma,cb)).returnValue)return cb;
this.X8j(ma);cb=null;this.YHa&&(cb=this.YHa());if(cb){const zb=new Ea.a;zb.annotationType=ma;this.SDj&&(this.Qia.ub(ma)||this.Qia.Z(ma,new gb),zb.stateUpdateHandler=(Wb,nc)=>{this.Qia.J(ma).oldState=Wb;this.Qia.J(ma).newState=nc;for(const Uc of this.Qia.J(ma).handlers)Uc(ma,Wb,nc)});cb=cb.activateAnnotation(zb);this.yme.add(ma,cb);return cb.then(Wb=>{this.yme.remove(ma);this.mQb.add(ma,Wb.token);this.knj(Wb.token,ma);this.sa.raiseEvent(Ub.b0d,new Aa(ma,!0));this.U3l(ma);return Wb})}return Promise.reject(Error.create("Error during annotation activation"))}U3l(ma){const cb=
this.JD.A7h(ma);cb&&this.IJa.J1h(cb,zb=>{if(this.Y9.JMf){var Wb=fc.ParagraphReader.Yv(Eb.a.getRootNode(),!0,!0);if(Wb&&0<Wb.count){let nc=0;for(const Uc of Wb){Wb=Xb.FLd(Uc);if(!Wb)continue;let Md=!1;for(;nc<zb.length;){if(Wb===zb[nc]){Md=!0;break}nc++}if(!Md){this.Y9.JMf(cb);break}nc++}}}})}X8j(ma){this.Y9.hGo(ma,(cb,zb)=>{0<this.Xff(ma,zb,!0).count||this.lnj(cb,Ta.a.getTypeName(),!0,cb.parentPath)},(cb,zb)=>{if(3!==zb.vv)a.ULS.sendTraceTag(591541786,Ub.Gi,15,"Annotation moved to unsupported location type: {0}",
zb.vv);else if(cb.vv!==zb.vv)a.ULS.sendTraceTag(591541787,Ub.Gi,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",cb.vv,zb.vv);else{cb=this.Xff(ma,cb);for(const nc of cb){const Uc=nc.content;cb=Eb.a.wgb(this.BV.value,nc.parentPath);if(!cb){a.ULS.sendTraceTag(591541788,Ub.Gi,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.vp.Gbg(Md=>Md.intent===Uc,cb,0))break;var Wb=zb.Msa;Wb=new Ya.a(0,Wb,Wb+zb.Lsa,null,Uc);this.vp.W2a(cb,
Wb)}}},cb=>{for(const zb of this.Xff(ma,cb))this.e2b(zb,!1)})}releaseAnnotation(ma,cb){let zb;if(({value:zb}=this.v$c.Gc(ma,zb)).returnValue){zb.contains(cb)&&zb.remove(cb);if(0<zb.count)return Promise.resolve(!1);this.v$c.remove(ma)}a.ULS.sendTraceTag(593790408,Ub.Gi,50,"ReleaseAnnotation: Releasing annotation type {0}.",ma);return this.v3i(ma)}B0m(ma){var cb=null;if(({value:cb}=this.j9.Gc(ma,cb)).returnValue){a.ULS.sendTraceTag(41418899,Ub.Gi,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ma);for(const zb of cb)if(cb=null,({value:cb}=this.KD.Gc(zb,cb)).returnValue){const Wb=cb.parentPath;let nc=null;({value:nc}=this.wya.Gc(Wb,nc)).returnValue&&(nc.remove(zb),nc.count||this.wya.remove(Wb));this.KD.remove(zb);Ub.QEb(cb)&&this.Ebg(cb)}this.j9.remove(ma)}Array.contains(this.e1j,ma)&&this.v3i(ma)}v3i(ma){let cb=null,zb=null;this.YHa&&(zb=this.YHa());if(zb){if(({value:cb}=this.mQb.Gc(ma,cb)).returnValue){const Wb=new wa;Wb.token=cb;this.mQb.remove(ma);this.sa.raiseEvent(Ub.b0d,new Aa(ma,
!1));return zb.releaseAnnotation(Wb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}Rri(){this.Lh.Sd(()=>{if(this.AQj){var ma=Eb.a.getRootNode();if(ma){var cb=new Ja.a;Wa.e(ma,zb=>{var Wb=Eb.a.UL(zb),nc=null;if(({value:nc}=this.wya.Gc(Wb,nc)).returnValue)for(const Uc of nc)Wb=null,({value:Wb}=this.KD.Gc(Uc,Wb)).returnValue&&(Wb.parent=zb,Wb.eRc=!0,Wb.iJb=2,cb.ub(Wb.annotationType)||cb.Z(Wb.annotationType,new Qa.a),cb.J(Wb.annotationType).add(Uc),
nc=null,({value:nc}=this.j9.Gc(Wb.annotationType,nc)).returnValue&&nc.remove(Wb.id));return!0},12);for(const zb of this.j9.keys)if(ma=null,({value:ma}=this.j9.Gc(zb,ma)).returnValue)for(const Wb of ma)if(ma=null,({value:ma}=this.KD.Gc(Wb,ma)).returnValue){let nc=null;ma.parentPath===Eb.a.BAb?(ma.iJb=1,ma.parent=null):({value:nc}=this.KD.Gc(ma.parentPath,nc)).returnValue?(ma.iJb=3,ma.parent=nc):(ma.iJb=0,ma.parent=null,a.ULS.sendTraceTag(41554060,Ub.Gi,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ma.id));ma.eRc=!0;cb.ub(ma.annotationType)||cb.Z(ma.annotationType,new Qa.a);cb.J(ma.annotationType).add(Wb)}else a.ULS.sendTraceTag(41997840,Ub.Gi,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Wb);else a.ULS.sendTraceTag(41997841,Ub.Gi,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",zb);this.j9=cb;this.UFe.clear()}else a.ULS.sendTraceTag(41554058,Ub.Gi,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Ub.Gi,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}Hjk(ma){this.IOi(ma,!0)}a$m(ma,cb){this.Lh.Sd(()=>{const zb=cb?cb+String.format("\\{0}",ma.id):Eb.a.UL(ma);a.ULS.sendTraceTag(41418900,Ub.Gi,50,"OnTileDeleted: Tile delete event received for tile {0}.",zb);this.uoc.contains(zb)||this.uoc.add(zb);var Wb=null;if(({value:Wb}=this.wya.Gc(zb,Wb)).returnValue){a.ULS.sendTraceTag(41418901,Ub.Gi,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Wb.count,
zb);for(const nc of Wb)Wb=null,({value:Wb}=this.KD.Gc(nc,Wb)).returnValue&&(this.KLb(Wb,Fa.a.getTypeName()),this.sa.m7&&this.sa.raiseEvent(Ub.Abc,new xb(Wb,Fa.a.getTypeName())),this.KD.remove(nc));this.wya.remove(zb)}},"AS:OTD")}$9m(ma){ma=Eb.a.UL(ma);this.uoc.remove(ma)&&a.ULS.sendTraceTag(41418902,Ub.Gi,50,"OnTileAdded: Deleted tile {0} was re-added.",ma)}Zzo(ma){if(ma){a.ULS.sendTraceTag(50436131,Ub.Gi,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ma.count);var cb=new Ja.a;
for(var zb of ma)ma=null,({value:ma}=cb.Gc(zb.parentPath,ma)).returnValue||(ma=new Ja.a,cb.add(zb.parentPath,ma)),ma.Z(zb.id,zb);for(const Wb of cb){cb=Eb.a.wgb(this.BV.value,Wb.key);if(!cb){a.ULS.sendTraceTag(50436160,Ub.Gi,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}zb=new sb.a([0]);for(let nc=0,Uc=cb.qa.length;nc<Uc;nc++)ma=cb.qa.J(nc),ma.Sj&&zb.cTa(ma.Sj,void 0,(Md,ge)=>{if(ge){var Pd=null,te=ge.intent;te&&({value:Pd}=Wb.value.Gc(te.id,Pd)).returnValue&&(te=new ua.a,
te.start=ge.Nb.cp,te.length=Md.Nb.cp-te.start,Pd.content.range=te,Pd.cwa=!1)}})}}else a.ULS.sendTraceTag(50436130,Ub.Gi,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ma){a.ULS.sendTraceTag(593049729,Ub.Gi,50,"GetAnnotationsByType: Method called for type {0}.",ma);return this.JRe(ma).then(()=>{const cb=new Qa.a;this.Lh.Sd(()=>{if(Eb.a.kf(ma)||ma!==X.a.getTypeName()){this.UFe.contains(ma)&&this.Rri();var zb=null;if(({value:zb}=this.j9.Gc(ma,zb)).returnValue){a.ULS.sendTraceTag(41418903,
Ub.Gi,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ma);var Wb=new Qa.a;for(const nc of zb)zb=null,({value:zb}=this.KD.Gc(nc,zb)).returnValue&&(zb.cwa&&Wb.add(zb),cb.add(zb));Wb&&0<Wb.count&&Ub.QEb(Wb.J(0))&&this.Zzo(Wb)}}else for(Wb of this.Gbd.values)cb.add(Wb);cb.count||a.ULS.sendTraceTag(41418904,Ub.Gi,50,"GetAnnotationsByType: No annotations found for type {0}!",ma)},"AS:GABT");return cb},cb=>{a.ULS.sendTraceTag(41418905,Ub.Gi,10,"Exception occurred while fetching annotations of type {0}: {1}",
ma,cb);return null})}Pfb(ma){let cb=null;return({value:cb}=this.KD.Gc(ma,cb)).returnValue?cb:null}pSh(ma){let cb=null;if(this.wya.ub(ma))for(const zb of this.wya.J(ma))if(ma=this.Pfb(zb))cb||(cb=new Qa.a),cb.add(ma);return cb}XGb(ma){return(ma=this.Pfb(ma))?(ma.eRc||this.Rri(),ma):null}XSa(ma,cb){this.O1n(ma,cb);this.Ncg(ma,cb);this.KLb(ma,qa.a.getTypeName())}jvo(ma,cb){this.Wyo(ma,cb);this.WZn(ma,Eb.a.Qsl(ma));this.KLb(ma,qa.a.getTypeName())}kvo(ma,cb){ma=this.JD.cSh(ma);for(const zb of ma)this.UH.xcg(this.BV.value,
zb,cb)}O1n(ma,cb){let zb=null;this.YHa&&(zb=this.YHa());zb&&(ma=this.Ssl(ma,cb))&&zb.setAnnotationState(ma)}Ncg(ma,cb,zb=!0){if(ma&&Ub.Kgi(ma)){var Wb=this.Pfb(ma.id);!ma.content||Wb&&ma.content===Wb.content||Eb.a.setAnnotationState(ma,cb);Wb&&Wb.content&&Eb.a.setAnnotationState(Wb,cb);zb&&this.sa.m7&&(70===cb||60===cb)&&this.sa.raiseEvent(Ub.BCi,new Ib(ma,cb))}}Ssl(ma,cb){let zb=null;ma&&(zb=Object.assign(new fa,{id:ma.id,value:cb}),Eb.a.kf(ma.parentPath)||(zb.parentPath=ma.parentPath.split("\\")));
return zb}WZn(ma,cb){const zb=this.YHa?this.YHa():null;zb&&(ma=this.Psl(ma,cb))&&zb.setAnnotationMetadata(ma)}Wyo(ma,cb){if(ma&&Ub.Kgi(ma)){var zb=this.Pfb(ma.id);!ma.content||zb&&ma.content==zb.content||Eb.a.d4i(ma,cb);zb&&zb.content&&Eb.a.d4i(zb,cb)}}Psl(ma,cb){if(!ma)return null;const zb=new sa;zb.id=ma.id;zb.value=cb;Eb.a.kf(ma.parentPath)||(zb.parentPath=ma.parentPath.split("\\"));return zb}u5n(ma,cb,zb,Wb){const nc=ma.content;if(this.JD.Eib(ma)&&nc){const Uc=nc.range.start+nc.range.length;if(0<
Wb&&Uc<=zb||0>Wb&&Uc<=zb+Wb)return!1;if(0<Wb&&nc.range.start>=cb||0>Wb&&nc.range.start>=zb)return nc.range.start+=Wb,!1}return!this.Wc.isFeatureEnabled(60)&&nc&&nc.M_?(ma=this.JD.Uib(ma,60),!(60===nc.M_.state&&ma)):!0}$bh(ma,cb){this.Qia.ub(cb)||this.Qia.Z(cb,new gb);this.Qia.J(cb).handlers.add(ma);ma(cb,this.Qia.J(cb).oldState,this.Qia.J(cb).newState)}oUi(ma,cb){this.Qia.ub(cb)&&this.Qia.J(cb).handlers.contains(ma)&&this.Qia.J(cb).handlers.remove(ma)}static Kgi(ma){ma=ja.a.getBaseTypesFor(ma.content);
return Array.contains(ma,Na.a.getTypeName())}static QEb(ma){if(void 0===ma.content||null===ma.content||""===Eb.a.rDb(ma.parentPath))return!1;const cb=ja.a.getBaseTypesFor(ma.content);return Array.contains(cb,Ha.a.getTypeName())&&ma.annotationType!==Ca.RoleDetectionAnnotation.getTypeName()}ivo(ma){ma?(this.Ame.AugLoop_Text_Critique=ma,ma=this.T7b("AugLoop_Text_Critique")?this.mQb.J("AugLoop_Text_Critique"):null,this.knj(ma,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Ub.Gi,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}knj(ma,cb){if(ma&&this.Ame[cb]){const zb=new rc;zb.token=ma;zb.config=this.Ame[cb];this.YHa&&(this.YHa().updateAnnotationConfig(zb),a.ULS.sendTraceTag(540615553,Ub.Gi,50,"Annotation configuration has been updated for annotation type: {0}.",cb))}}FUi(ma){let cb=null;({value:cb}=this.KD.Gc(ma.id,cb)).returnValue&&(ma.annotationType=cb.annotationType);this.roc.has(ma.id)&&this.roc.delete(ma.id)}jnj(ma,cb,zb,Wb){this.DCn(ma);this.lnj(ma,zb,Wb,cb)&&this.Y9.Mpj(ma,zb)}lRa(ma){const cb=
ma.parentPath,zb=Fa.a.getTypeName();this.FUi(ma);this.XSa(ma,70);this.uoc.contains(cb)||this.jnj(ma,cb,zb,!0)}aJl(ma){const cb=new Qa.a;ma=this.j9.Gc(ma).value;if(null===ma)return cb;for(const zb of ma)ma=this.KD.Gc(zb).value,null!==ma&&cb.push(ma);return cb}W3l(){Object(ra.__awaiter)(this,void 0,void 0,function*(){yield Object(Ra.b)();this.zUi()})}zUi(){const ma=this.aJl(Rb.a.getTypeName());for(const cb of ma)this.Qhi(cb.content)&&this.lRa(cb)}}Ub.Gi=389;Ub.Abc="OnAnnotationOperation";Ub.BCi="OnAnnotationLocalStateChange";
Ub.b0d="OnAnnotationActivationChange";Ub.TVj=20;Object(e.a)(Ub,"AnnotationStorage",null,[316]);class Oa{constructor(){this.g$d=null;this.C3c=!1}}Object(e.a)(Oa,"AugmentationLoopStateManager",null,[313]);var Fc=c(185),xc=c(577),pd=c(68),lb=c(93),Tb=c(599),pc=c(246);class Db extends pc.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=
this.SeedBatchesInParallelIsEnabled=!1}el(){return 102}static construct(ma,cb,zb,Wb,nc,Uc){const Md=new Db;Md.ExpectedEndRevisionId=ma;Md.OriginString=cb;Md.Authorization=zb;Md.AugLoopSeedUrl=Wb;Md.FileId=nc;Md.SeedBatchesInParallelIsEnabled=Uc;Md.AddDocumentKindTypeToPathIsEnabled=!0;Md.CheckOnDemandNodeVersionEnabled=!0;Md.AddSubDocumentKindTypeToPathIsEnabled=!0;return Md}}Object(e.a)(Db,"FullFileAugLoopSeedingRequest",pc.a,[]);class Ob{constructor(){this.authToken=this.url=this.NIi=null}}Object(e.a)(Ob,
"ReseedingTaskInfo",null,[]);class jb{constructor(ma,cb,zb,Wb,nc,Uc){this.t9=null;this.uLg=!1;this.WRb=null;this.oJe=0;this.WYc=(Md,ge)=>{Md=ge.M$;this.WRb&&lb.AT(Md,Pd=>Pd===this.WRb)&&(ge.httpStatusCode!==Fc.a.tB||ge.sH||2!==ge.zQf?ge.httpStatusCode!==Fc.a.tB||ge.sH||1!==ge.zQf?this.ZZi(()=>{a.ULS.sendTraceTag(50861003,jb.Gi,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
ge.httpStatusCode,ge.sH,ge.zQf,ge.qu)}):(this.iN.C3c=!1,this.t9.RKb(this.WYc),this.wf.qGk(),a.ULS.sendTraceTag(50861002,jb.Gi,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Md=Object(pd.a)(Ob,this.WRb),this.jQi(ge.dNn,Md.NIi,Md.url,Md.authToken)):this.ZZi(()=>{a.ULS.sendTraceTag(50861001,jb.Gi,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.hhl=Md=>{if(void 0===Md||null===Md||void 0===Md.data||null===Md.data||void 0===Md.data.Ae||
null===Md.data.Ae)a.ULS.sendTraceTag(41445393,jb.Gi,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Md.data.jf!==Fc.a.tB)a.ULS.sendTraceTag(41445394,jb.Gi,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Md.data.jf);else try{let ge;({group:ge}=xc.a.q0(Md.data.Ae)).returnValue?ge.Responses&&ge.Responses.length?(Md=null,ge&&ge.Responses&&ge.Responses.length&&(Md=ge.Responses[0])?(this.E1.G6a(Md),Md.StatusCode?
a.ULS.sendTraceTag(41445398,jb.Gi,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Md.StatusCode):a.ULS.sendTraceTag(41445399,jb.Gi,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Md.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,jb.Gi,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,jb.Gi,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,jb.Gi,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(ge){a.ULS.sendTraceTag(41445400,jb.Gi,10,"FileSeedingSuccessCallback: {0}",ge.message)}};this.ghl=Md=>{void 0===Md||null===Md||void 0===Md.data||null===Md.data||void 0===Md.data.Ae||null===Md.data.Ae?a.ULS.sendTraceTag(41445401,jb.Gi,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,jb.Gi,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Md.data.jf)};this.OEj=ma.$("AugLoopServerSideSeedingIsEnabled");this.MEj=ma.$("AugLoopReseedingIsEnabled");this.NEj=ma.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.cWg=ma.pc("MaxReseedingRetries",1);this.rg=cb;this.Hfd=zb;this.iN=Wb;this.E1=nc;this.wf=Uc;V.App.xa&&V.App.xa.jb&&V.App.xa.jb.Yc&&V.App.xa.jb.Yc.contentReplicator&&(this.t9=V.App.xa.jb.Yc.contentReplicator)}Vem(ma,
cb,zb){if(this.OEj){var Wb=this.iN.g$d;Wb&&Wb.trim().length?this.uLg?this.MEj&&(a.ULS.sendTraceTag(50861E3,jb.Gi,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.oJe=0,this.t9?(this.iN.C3c=!0,this.t9.mZb(this.WYc),this.WRb=Object.assign(new Ob,{NIi:ma,url:cb,authToken:zb}),this.t9.qE(null,null,this.WRb)):a.ULS.sendTraceTag(592814793,jb.Gi,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,jb.Gi,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),
this.jQi(Wb,ma,cb,zb),this.uLg=!0):a.ULS.sendTraceTag(41445391,jb.Gi,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,jb.Gi,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}ZZi(ma){this.oJe<this.cWg?(a.ULS.sendTraceTag(594384E3,jb.Gi,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.oJe,this.cWg),this.t9.qE(null,null,this.WRb)):(this.iN.C3c=!1,this.t9.RKb(this.WYc),ma())}jQi(ma,cb,zb,Wb){const nc=Db.construct(ma,cb,Wb,zb,w.AFrameworkApplication.rootQuerySignature,this.NEj);a.ULS.sendTraceTag(595178454,jb.Gi,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Hfd.wEb.execute(()=>{this.vck(nc)})}vck(ma){a.ULS.sendTraceTag(595178453,jb.Gi,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.rg.qj(V.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Tb.b(ma),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.hhl,this.ghl,ma);a.ULS.sendTraceTag(42016906,jb.Gi,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}jb.Gi=389;Object(e.a)(jb,"FullFileAugLoopSeedingService",null,[]);class tb{constructor(){}}Object(e.a)(tb,"RuntimeManagerInitializationTracker",null,[]);var ac=c(932);class zc{getAugLoopRuntimeManager(){return ac.a.getAugLoopRuntimeManager()}}
Object(e.a)(zc,"AlFactoryWrapper",null,[311]);class yc{nm(){return Eb.a.nm()}}Object(e.a)(yc,"UtilsWrapper",null,[312]);var cd=c(594),Cd=c(62),ud=c(17),$d=c(44),gc=c(108),kc=c(1943),Wc=c(5),td=c(109),Fe=c(168),Cf=c(36),ie=c(373),Ae=c(433),xe=c(110),ng=c(192),Af=c(64);class De{static get hh(){return ng.a.getInstance()}constructor(ma,cb,zb,Wb,nc){this.Ma=ma;this.If=zb;this.so=Wb;this.me=nc;this.jna=this.Ma.$("WordDesignerCaptionDetectionEnabled")}$Xn(ma,cb){ma.listType=this.TIl(cb);ma.outlineLevel=
fc.ParagraphReader.Cma(cb);ma.indentation=De.Cjf(this.so.oT(cb));ma.alignment=De.Jff(fc.ParagraphReader.Vv(cb));ma.isInsideTable=this.isInsideTable(cb);ma.isInsideTOC=cb.es;ma.rightIndentation=De.Cjf(this.so.l0a(cb));var zb=this.so.P5b(cb);ma.specialIndentType=De.nUl(zb);ma.specialIndentBy=De.Cjf(zb);ma.listType!==kc.e.NoList&&this.EZn(cb,ma);this.H1n(cb,ma);zb=[];this.jna&&(zb=this.Hln(cb));ma.formattedRanges=this.VDl(cb,zb);this.jna&&null!=zb&&(ma.objectReferences=0<zb.length?zb:void 0)}VDl(ma,
cb){var zb=ma.qa?ma.qa.length:0,Wb=td.FormattingReader.zr(Cf.a.create(ma));let nc=xe.a.EF,Uc=0,Md=xe.a.qI/2;Wb&&(Md=td.FormattingReader.Um(Wb,ud.a.fontSize,xe.a.qI)/2,nc=td.FormattingReader.Um(Wb,ud.a.font,xe.a.EF),Uc=td.FormattingReader.language(Wb));Wb="Normal";var ge=this.me.Xn(ma);ge&&(Wb=ge.getValue($d.a.ja)||"Normal",ge.hasProperty(ud.a.font)&&(nc=ge.getValue(ud.a.font)));if(zb){--zb;ge=[];let ei=null,rl=void 0,Bi=null;this.jna&&ma.hasProperty(ud.a.An)&&(Bi=ma.getValue(ud.a.An));const en=ma.properties.ia(na.a.Wea,
null);for(let Jm=0;Jm<zb;Jm++){var Pd=ma.qa.J(Jm),te=ma.Jc,Xe=null;this.jna&&(Xe=De.vnf(ma,Bi,Jm));Pd.zf&&(ei=De.Dwo(te,Pd.zf,ei));Pd.hyperlink&&Pd.hyperlink.url?rl=Pd.hyperlink.url:Pd.ql&&(rl=void 0);var Yf=ma.qa.J(Jm+1).cp-1;te=Pd.cp;Yf=Yf-Pd.cp+1;let fn=!1,Rm=!1,Km=!1,Bm=Md,sk=0,Jn=0,yg=Wb,Cm=void 0,Ni=Uc,Ci=nc,gg;if(Pd.formatting){var Jg=Pd.formatting;fn=td.FormattingReader.Um(Jg,ud.a.bold,!1);Rm=td.FormattingReader.Um(Jg,ud.a.italic,!1);Km=td.FormattingReader.Um(Jg,ud.a.underline,!1);Bm=td.FormattingReader.Um(Jg,
ud.a.fontSize,2*Md)/2;sk=td.FormattingReader.Um(Jg,$d.a.capitalization,0);Jn=td.FormattingReader.Um(Jg,ud.a.fontColor,0);Ni=td.FormattingReader.language(Jg)||Uc;Ci=td.FormattingReader.Um(Jg,ud.a.font,nc);yg=Wb;var $h=Jg.Vm;$h&&($h=$h.ia($d.a.Rv,null))&&!$h.equals(la.a.nil)&&Jg.paragraph.Jc&&(Jg=Jg.paragraph.Jc.Db($h))&&(yg=(new Fe.a(Jg)).getValue($d.a.ja))}this.jna&&(gg=this.Vkf(Xe),null!=gg&&this.$dh(cb,Xe,gg,ge.length,kc.b.Inline));ei&&(Cm=0<ei.count);Pd={isDeleted:this.Umm(en,Pd,Jm,rl),fontFamily:Ci,
fontWeight:fn?kc.d.Bold:kc.d.Normal,fontSize:Bm,italic:Rm,underline:Km?kc.h.SingleLine:kc.h.None,capitalization:De.Gxh(sk),color:Jn,styleName:yg,isFollowUp:Cm,languageId:De.wxh(Ni),start:te,length:Yf,link:rl,isReference:De.isReference(Pd)?!0:void 0,objectType:null!==gg&&void 0!==gg?gg:void 0};Xe=0<ge.length?ge[ge.length-1]:void 0;De.uAk(Xe,Pd)?Xe.length+=Pd.length:ge.push(Pd)}return ge}return[{fontFamily:nc,fontWeight:kc.d.Normal,fontSize:Md,italic:!1,underline:kc.h.None,capitalization:De.Gxh(0),
color:0,styleName:Wb,isFollowUp:void 0,languageId:De.wxh(Uc),start:0,length:ma.characterData.length}]}Umm(ma,cb,zb,Wb){if(this.XA()){if(cb.blob||cb.formatting&&cb.formatting.cache&&cb.formatting.cache.DFb||Wb)return!0;if(ma&&zb<ma.length)return ma[zb]}return Af.a.$l&&cb.C3?!0:cb.gi?!0:!1}XA(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static uAk(ma,cb){return!!ma&&!!cb&&ma.start+ma.length===cb.start&&ma.isDeleted===
cb.isDeleted&&ma.fontFamily===cb.fontFamily&&ma.fontWeight===cb.fontWeight&&ma.fontSize===cb.fontSize&&ma.italic===cb.italic&&ma.underline===cb.underline&&ma.capitalization===cb.capitalization&&ma.color===cb.color&&ma.highlightColor===cb.highlightColor&&ma.styleName===cb.styleName&&void 0===ma.link&&void 0===cb.link&&ma.languageId===cb.languageId&&!ma.isReference&&!cb.isReference&&!ma.isFollowUp&&!cb.isFollowUp&&void 0===ma.objectType&&void 0===cb.objectType}TIl(ma){const cb=new Wc.GraphIterator;
cb.set(ma);cb.Ab(11);cb.kd(11);return(ma=this.If.Qu(cb))?De.yPk(ma.listType):kc.e.NoList}EZn(ma,cb){const zb=this.If.YB(ma);if(zb){zb.hasProperty(na.a.listID)&&(cb.listId=zb.getValue(na.a.listID).toString());const Wb=this.UZh(ma,zb,ud.a.font);ma=this.UZh(ma,zb,ud.a.fontSize);Wb&&(cb.bulletAndNumberFontFamily=Wb);ma&&(cb.bulletAndNumberFontSize=ma)}}isInsideTable(ma){const cb=new Wc.GraphIterator;cb.set(ma);return cb.Ab(14)}H1n(ma,cb){cb.spacingBeforeParagraph=this.B4h(ma,na.a.k8,na.a.jha,na.a.oj);
cb.spacingAfterParagraph=this.B4h(ma,na.a.j8,na.a.iha,na.a.ra);cb.lineSpacing=this.VNa(ma)}B4h(ma,cb,zb,Wb){if(fc.ParagraphReader.Um(ma,cb,!1))return 0;cb=fc.ParagraphReader.Um(ma,zb,-1);if(0<=cb)return cb*ie.a.bJb/100;ma=fc.ParagraphReader.Um(ma,Wb,-1);return 0<=ma?ma/20:0}UZh(ma,cb,zb){if(De.hh.jO){if(ma=this.hBl(ma),null!=ma&&null!=ma.cache)return ma.cache.getValue(zb)}else if(cb.hasProperty(zb))return cb.getValue(zb)}hBl(ma){var cb;ma=null===(cb=ma.qa)||void 0===cb?void 0:cb.last;return null!=
ma&&ma.Uh?ma.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}VNa(ma){const cb=fc.ParagraphReader.Um(ma,na.a.va,ie.a.va);ma=fc.ParagraphReader.Um(ma,na.a.ua,ie.a.lineSpacing);switch(cb){case 0:return ma/240;case 1:return ma/20;default:return 0}}static Dwo(ma,cb,zb){for(let Wb=0;Wb<cb.length;Wb++){const nc=cb.J(Wb),Uc=nc.Wj,Md=ma.Db(Uc);Md&&Md.ia(na.a.dG,!1)&&(zb||(zb=new Ma.a(new Ae.a)),nc.Oc?zb.add(Uc):zb.remove(Uc))}return zb}static wxh(ma){return(ma=
cd.a.sg(ma))&&ma.name?ma.name.toLowerCase():void 0}static Cjf(ma){return ma?2===ma.unit?Math.floor(Cd.a.Pyb(ma.value)/20):Math.floor(ma.value/20):0}static nUl(ma){if(!ma)return kc.g.Initial;switch(ma.specialIndentType){case 1:return kc.g.FirstLine;case 2:return kc.g.Hanging;default:return kc.g.Initial}}static Gxh(ma){switch(ma){case 2:return kc.c.AllCaps;case 1:return kc.c.SmallCaps;default:return kc.c.NoCaps}}static Jff(ma){switch(ma){case 1:return kc.a.Left;case 3:return kc.a.Right;case 2:return kc.a.Center;
case 6:return kc.a.Justified;case 0:return kc.a.None;default:return kc.a.Other}}static yPk(ma){switch(ma){case 15:return kc.e.Any;case 1:return kc.e.Bullet;case 42:return kc.e.Invalid;case 13:return kc.e.Lim;case 14:return kc.e.Nil;case 16:return kc.e.NoList;case 0:return kc.e.Numbered;default:return kc.e.Invalid}}static isReference(ma){return ma.blob&&(7===ma.blob.li||10===ma.blob.li)||ma.Ph&&0<ma.Ph.length||ma.zf&&0<ma.zf.length||ma.Jb&&0<ma.Jb.length?!0:!1}static vnf(ma,cb,zb){return null==cb?
null:cb[zb]&&!cb[zb].equals(la.a.nil)&&ma.Jc?ma.Jc.Db(cb[zb]):null}Vkf(ma){if(null==ma)return null;if(ma.hasProperty(na.a.Qq)){var cb=ma.getValue(na.a.Qq);if(De.bMi.has(cb))return De.bMi.get(cb)}if(ma.hasProperty(na.a.W3b)&&null!=ma.getValue(na.a.W3b))return kc.f.FootnoteEndnote;if(ma.hasProperty(na.a.pageBreak)&&ma.getValue(na.a.pageBreak))return kc.f.PageBreak;if(ma.hasProperty(na.a.fGb)&&ma.getValue(na.a.fGb))return kc.f.Tab;cb=!1;ma.hasProperty(gc.a.B7)?cb=ma.getValue(gc.a.B7):ma.hasProperty(na.a.ega)&&
(cb=ma.getValue(na.a.ega));return cb&&ma.hasProperty(na.a.imageType)&&1==ma.getValue(na.a.imageType)?kc.f.Image:null}static Ipm(ma){return ma.hasProperty(na.a.E6b)&&0<=ma.getValue(na.a.E6b)?!0:!1}hoi(ma){return De.Hho.has(ma)}zAh(ma,cb,zb,Wb){return null==ma||null==cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):Wb===kc.b.Inline&&null==zb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),
null):Wb===kc.b.Floating&&null!=zb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>zb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):De.Ipm(ma)?null:this.hoi(cb)?{referencedPath:["session","doc","main",ma.id.toString()],formattedRangeIndex:zb,anchorMode:null!==Wb&&void 0!==Wb?Wb:kc.b.Unspecified,anchoredObjectType:Wb==kc.b.Floating?cb:
void 0}:null}$dh(ma,cb,zb,Wb,nc){cb=this.zAh(cb,zb,Wb,nc);null!=cb&&null!=ma&&ma.push(cb)}Hln(ma){const cb=[];if(null==ma)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),cb;let zb=null;ma.hasProperty(na.a.g6)&&(zb=ma.getValue(na.a.g6));if(null!=zb)for(let Wb=0;Wb<zb.length;++Wb){const nc=De.vnf(ma,zb,Wb),Uc=this.Vkf(nc);null!=Uc&&this.$dh(cb,nc,Uc,null,kc.b.Floating)}return cb}Bwh(ma){if(null==ma||!ma.hasProperty(ud.a.An))return!1;const cb=
ma.getValue(ud.a.An);for(let Wb=0;Wb<cb.length;Wb++){var zb=De.vnf(ma,cb,Wb);zb=this.Vkf(zb);if(this.hoi(zb))return!0}return!1}}De.bMi=new Map([[5,kc.f.Image],[11,kc.f.TextBox],[7,kc.f.Chart],[6,kc.f.SmartArt],[10,kc.f.Drawing],[2,kc.f.EquationObject],[4,kc.f.Ink],[19,kc.f.PageBreak],[23,kc.f.FootnoteEndnote],[24,kc.f.FootnoteEndnote],[35,kc.f.FootnoteEndnoteReferenceMark],[36,kc.f.FootnoteEndnoteReferenceMark],[0,kc.f.Other]]);De.Hho=new Set([kc.f.Image,kc.f.TextBox,kc.f.Chart,kc.f.SmartArt,kc.f.Drawing,
kc.f.Ink]);Object(e.a)(De,"FormattingExtractor",null,[310]);var Rf=c(1046);class Je extends Sys.EventArgs{constructor(ma){super();this.y6b=ma}}Object(e.a)(Je,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class le extends Sys.EventArgs{constructor(ma){super();this.y7=ma}}Object(e.a)(le,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class dh{constructor(ma,cb,zb){this.OVc=ma;this.graphNode=cb;this.fullPath=zb}}Object(e.a)(dh,"NodeEvent",null,[327]);class lj{constructor(){this.pye=this.dwe=!1;this.ntb=
null;this.sa=new da.a;this.P9=new O.a(0);this.F9a=new Rf.a(Ua.a.Ri());this.$tb=new Rf.a(Ua.a.Ri());this.Ckd=[]}Ceh(ma){this.sa.addHandler("IsCollectingNodeEventsChangedKey",ma)}YFk(){this.P9=new O.a(0);this.y6b=!1}get y6b(){return this.dwe}set y6b(ma){this.dwe!==ma&&(this.dwe=ma,this.sa.raiseEvent("HasNodeEventsChangedKey",new Je(ma),this))}get y7(){return this.pye}set y7(ma){this.pye!==ma&&(this.pye=ma,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new le(ma),this))}CLb(ma,cb){this.F9a.ub(ma)||
this.F9a.Z(ma,cb)}FPn(ma,cb){this.$tb.Z(ma,cb)}Ksl(ma){let cb=null;this.$tb.ub(ma)&&(cb=this.$tb.J(ma),this.$tb.remove(ma));return cb}u7d(ma,cb){if(ma)if(this.y7){var zb=3!==cb&&4!==cb&&5!==cb||!this.F9a.ub(String.format("{0}",ma.id))?Eb.a.UL(ma):this.F9a.J(String.format("{0}",ma.id));if(({value:Wb}=this.P9.Gc(zb)).returnValue)if(Wb||3!==cb)if(5===Wb&&3===cb){if(ma=zb.split("\\").pop(),this.$tb.ub(ma)){var Wb=this.$tb.J(ma);Wb===zb?(this.ZCf(zb,cb),this.P9.add(zb,cb)):(this.$tb.Z(ma,zb),this.F9a.Z(ma,
Wb),this.Oui(zb),this.P9.remove(zb),this.ZCf(zb,cb),this.P9.add(Wb,5))}}else Wb&&(4!==Wb||0!==cb&&3!==cb&&5!==cb)&&(this.ZCf(zb,cb),this.P9.add(zb,cb));else this.Oui(zb),this.P9.remove(zb);else this.NOm(zb,cb),this.Ckd.push(ma),this.P9.add(zb,cb);this.y6b=0<this.P9.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}NOm(ma,cb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",
ma,cb)}ZCf(ma,cb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ma,cb)}Oui(ma){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ma)}UMk(){let ma=null;var cb=!1;let zb=null;for(;this.Ckd.length&&!cb;){zb=Array.dequeue(this.Ckd);if(!zb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.F9a.ub(String.format("{0}",zb.id))?(ma=this.F9a.J(String.format("{0}",zb.id)),this.F9a.remove(String.format("{0}",
zb.id)),this.Ckd.push(zb)):ma=Eb.a.UL(zb);cb=this.P9.ub(ma)}if(!cb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.YFk(),null;cb=this.P9.J(ma);this.P9.remove(ma);this.y6b=0<this.P9.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ma,cb);return new dh(cb,zb,ma)}hwn(ma){this.ntb=ma}VMk(){if(!this.ntb)return null;for(var ma=0;ma<this.ntb.length;ma++){var cb=this.ntb.J(ma);cb=Eb.a.UL(cb.node);if(this.P9.ub(cb))return null}ma=this.ntb;
this.ntb=null;return ma}oGk(){this.ntb=null}Eeo(){this.y7=!0}hom(ma){return this.P9.ub(ma.id.toString())}}Object(e.a)(lj,"NodeEventsCollection",null,[309]);var sh=c(1443),We=c(1375),Fh=c(308),cc=c(127);class tc extends We.a{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe){super();this.$fd=new sh.a;this.q9a=!1;this.gpc=null;this.Wga=(Yf,Jg)=>{(Yf=Jg.node)&&this.x5a(Yf)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),Eb.a.Z6n(Yf,this.Pja.y7,this.xQb,this.V0j)&&(this.Pja.u7d(Yf,0),
this.ooj(Yf)));this.Pja.y7&&this.Y9.Nkb(Yf)};this.KCi=(Yf,Jg)=>{Yf=Jg.node;this.Pja.CLb(String.format("{0}",Yf.id),Eb.a.UL(Yf))};this.KIb=(Yf,Jg)=>{(Yf=Jg.node)&&this.x5a(Yf)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Pja.y7&&this.Pja.u7d(Yf,3));this.Pja.y7&&this.Y9.JFi(Yf,3)};this.P3=(Yf,Jg)=>{Yf=Jg.node;Jg=Jg.property;Yf&&this.iEj.has(Jg)&&this.x5a(Yf)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Pja.y7&&(this.Pja.u7d(Yf,2),Jg===
na.a.wj&&this.ooj(Yf)));this.Pja.y7&&Jg===na.a.Pc&&this.Y9.JFi(Yf,2)};this.LCi=(Yf,Jg)=>{(Yf=Jg.node)&&fc.ParagraphReader.ic(Yf)&&!this.Koc.has(Yf)&&!this.ote.has(Yf)&&(this.Koc.add(Yf),this.OX())};this.LFi=(Yf,Jg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Yf=Jg.node)&&this.wf.H0m(Yf)};this.OIf=()=>{this.E3c()?this.qU():this.q9a&&!this.Pja.y7&&this.WSa()};this.EB=cb;this.Pja=zb;this.V0j=cc.b(Wb.g$d);this.xQb=ma.$("AugLoopOperationsAreEnabled");this.wf=nc;this.Y9=Uc;this.JD=Md;
this.Gb=ge;this.vp=Pd;this.UH=te;this.Koc=new Set;this.ote=new Set;Xe.epa(this,7);this.iEj=new Set([ud.a.Co,ud.a.bold,ud.a.italic,ud.a.underline,ud.a.font,ud.a.fontSize,ud.a.fontColor,$d.a.capitalization,ud.a.Vh,ud.a.An,na.a.k8,na.a.jha,na.a.oj,na.a.j8,na.a.iha,na.a.ra,na.a.va,na.a.ua,na.a.listID,na.a.lM,na.a.fe,na.a.gha,na.a.$u,na.a.wj])}get index(){return 7}get bXc(){return this.gpc}set bXc(ma){this.gpc=ma;this.Y9.JMf=ma?()=>{this.gpc()}:null}init(){this.E3c()&&this.qU();this.Pja.Ceh(this.OIf)}qU(){this.EB?
(this.q9a=!0,this.EB.mu(this.Wga),this.EB.mW(this.KCi),this.EB.Mv(this.KIb),this.EB.Ap(this.P3),this.EB.mfh(this.LFi),this.EB.Vek(this.LCi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}WSa(){this.EB?(this.q9a=!1,this.EB.vU(this.Wga),this.EB.Yba(this.KCi),this.EB.yha(this.KIb),this.EB.YX(this.P3),this.EB.BWi(this.LFi),this.EB.BFn(this.LCi)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}YPd(ma){ma&&
this.$fd.add(ma.id,ma.ia(na.a.wj,0))}ooj(ma){this.$fd.ub(ma.id)?(this.Y9.WBo(ia.a.Xce,ma,this.$fd.J(ma.id)),this.$fd.remove(ma.id)):(this.Y9.iGk(ia.a.Xce),this.bXc&&this.bXc())}x5a(ma){const cb=V.App.xa.jb.wc;return!!cb&&cb.$r&&!!cb.jd&&!!cb.jd.Jc&&!!ma&&!!ma.Jc&&ma.Jc.id===cb.jd.Jc.id}run(){if(0!==this.Koc.size){var ma=[];for(const cb of this.Koc)ma.push(cb),this.ote.add(cb),100<=ma.length&&(this.GJh(ma),ma=[]);0<ma.length&&this.GJh(ma);this.Koc.clear()}}GJh(ma){const cb=new za.a(4,1,500,()=>{for(const zb of ma)this.ote.delete(zb),
this.updateAnnotationRangeData(zb)},158);this.Gb.Xb(cb)}updateAnnotationRangeData(ma){var cb=this.vp.X_a(ma,0,Wb=>this.B8n(Wb.intent));if(0<cb.count)for(const Wb of cb){cb=this.Y9.eRl(Wb.intent.id);var zb=ma.Ola;const nc=fc.ParagraphReader.eQ(ma);Wb.end<Wb.begin||(zb=Fh.a.sFc(nc,zb,Wb.begin,Wb.end-Wb.begin,Wb.begin,Wb.end-Wb.begin,ma),this.UH.NWf(ma.Jc,cb,zb))}}B8n(ma){return!!ma&&this.JD.Eib(ma)&&!!ma.content}E3c(){return!this.q9a&&this.Pja.y7}}Object(e.a)(tc,"ParagraphNodeEventHandler",We.a,[305]);
var bd=c(984),vd=c(393),Tc=c(568),nb=c(113);class Fb extends Tc.a{constructor(){super();this.H_=Object.assign(new nb.a,{T_:Fb.getTypeName(),B_:Fb.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(Fb,"DeltaUpdateOperation",Tc.a,[]);var Kc=c(394);class sc{constructor(){this.referencedPath=null}}Object(e.a)(sc,"ItemReference",null,[]);class Oc extends Kc.a{constructor(){super();this.op=this.deltas=this.delta=
this.parentPath=null}}Object(e.a)(Oc,"ItemWithPath",Kc.a,[]);var Ke=c(964);class Re extends Ke.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new nb.a,{T_:Re.getTypeName(),B_:Re.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(e.a)(Re,"MoveOperation",Ke.a,[]);var lf=c(471);class Jh extends lf.a{constructor(){super();this.selectedRanges=null;this.H_=
Object.assign(new nb.a,{T_:Jh.getTypeName(),B_:Jh.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Jh,"SelectionSignal",lf.a,[]);class zg extends Jh{constructor(){super();this.content=null;this.H_=Object.assign(new nb.a,{T_:zg.getTypeName(),B_:zg.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}
Object(e.a)(zg,"SelectionContentSignal",Jh,[]);class Kd{constructor(){this.range=this.tileReference=null}}Object(e.a)(Kd,"TextTileRange",null,[]);var Td=c(1613),Gd=c(415),rf=c(151),hf=c(40),Ui=c(19);class Ik{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge){this._augLoopRuntimeManager=this.ded=null;this.DLe=!1;this.gka=this.JBe=this.Apd=null;this.fkl=()=>{if(V.App.lostSession||vd.SessionStatusManager.instance&&vd.SessionStatusManager.instance.zo)w.AFrameworkApplication.Ce("a596e684;c81e6109"),w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(ac.a.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Gb.Se(this.ded));this.Lh.Sd(()=>{var Pd;const te=fb.a.instance.lfa;this.XA()&&this.KJn();for(this.Kyc.reset();this.MVa.y6b&&!this.Kyc.bkb();){let Jg;Jg=this.MVa.UMk();if(!Jg||!Jg.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");
this.Kyc.update();continue}if(!this.I6n(Jg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",Jg.graphNode.id);this.Kyc.update();continue}const $h=Jg.graphNode.id.toString();var Xe=-1,Yf=!0;te&&Ui.SelectionEditor.pf(te)&&$h==te.node.id.toString()&&(Xe=te.cpBegin,Yf=!1);let ei=null;if(this.Lvb.contains($h))switch(Jg.OVc){case 3:this.Lvb.remove($h);ei=3;break;default:ei=Jg.OVc}else switch(Jg.OVc){case 0:case 1:this.Lvb.add($h);ei=0;break;case 2:this.Lvb.add($h);
ei=0;break;case 3:this.Lvb.remove($h);ei=3;break;default:ei=Jg.OVc}if(null!=ei){Xe=this.L0h(Jg.graphNode,Jg.fullPath,ei,Xe,Yf);if(4==ei||5==ei){if(Xe.prevParentPath.join()!==Xe.parentPath.join()){Yf=Object.assign(new Fa.a,{parentPath:Xe.prevParentPath,items:Xe.items});const rl=Object.assign(new Ta.a,{parentPath:Xe.parentPath,items:Xe.items,prevId:Xe.prevId,nextId:Xe.nextId});$h!==Xe.prevId&&$h!==Xe.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",
ei,$h,Xe.prevId,Xe.nextId,Jg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,{operation:Yf}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,{operation:rl}));Jg.graphNode.type===rf.a.table&&this.f3i(Jg.graphNode,Xe.parentPath).forEach(Bi=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,{operation:Bi}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,{operation:Xe}));if(this.R$c&&this.gka&&this.gka[0]==
$h)switch(ei){case 3:this.gka=null;break;case 0:case 1:case 2:case 4:case 5:this.gka[1]=null===(Pd=this.bub.QCb(Jg.graphNode))||void 0===Pd?void 0:Pd.rKc(Jg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",ja.a.getTypeNameFor(Xe),$h);switch(ei){case 0:case 4:case 5:this.wf.$9m(Jg.graphNode);break;case 3:this.wf.a$m(Jg.graphNode,Xe.parentPath.join("\\"))}}this.Kyc.update()}(Pd=this.MVa.VMk())&&this.fYi(Pd)},"TV:FPEFO")};
this.Ioa=(Pd,te)=>{var Xe;if(te.Ll&&te.Ll.length){if(this.R$c)if(Pd=Eb.a.ELl(te.Ll),!Pd)this.gka=null;else if(!this.gka||this.gka[0]!=Pd.id.toString()){const Yf=this.MVa.hom(Pd)?null:null===(Xe=this.bub.QCb(Pd))||void 0===Xe?void 0:Xe.rKc(Pd);this.gka=[Pd.id.toString(),Yf]}this.DLe&&this.MVa.hwn(te.Ll.kb)}};this.Ma=ma;this.MVa=cb;this.Gb=zb;this.Kyc=Wb;this.LEj=this.Ma.$("AugLoopOperationsAreEnabled");this.Lvb=new Ma.a(Ua.a.Ri());this.wf=nc;this.Lh=Uc;this.bub=Md;this.ib=ge;this.R$c=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",
!1);this.ib.DA(this.Ioa);Eb.a.nm().then(()=>{this._augLoopRuntimeManager=ac.a.getAugLoopRuntimeManager();w.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ma.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Td.a,{handler:Pd=>{this.wf.Hjk(Pd)}}));this.LEj&&this.MVa.Eeo();this.vfo()}).catch(()=>{})}KJn(){const ma=this.wf.roc.entries();for(let cb=0;cb<this.wf.roc.size;cb++){const zb=
ma.next();2E3<=Date.now()-zb.value[1].time&&this.wf.P8h(zb.value[1].annotation,!0,Ta.a.getTypeName(),!1)}}I6n(ma){return 3===ma.OVc||Eb.a.qaj(ma.graphNode)}vfo(){!this.ded&&this.MVa.y7&&(this.ded=new za.a(4,2,this.Ma.pc("NodeEventsFiringInterval",500),this.fkl,131),this.Gb.Xb(this.ded))}f3i(ma,cb){var zb,Wb=[];const nc=Wc.GraphIterator.$a(ma),Uc=nc.Sp();for(var Md=0;Md<Uc;Md++){let ge=nc.YF(Md);ge.type===rf.a.outlineElement&&(ge=hf.OutlineElementNavigator.Ee(nc));const Pd=ge.id.toString(),te=null===
(zb=this.bub.QCb(ge))||void 0===zb?void 0:zb.szb(ge);Wb.push(Object.assign(new Kc.a,{body:te,id:Pd,revId:Eb.a.Bnf(ge)}));nc.kd(ma.type)}cb.push(ma.id.toString());zb=[];zb.push(Object.assign(new Ta.a,{parentPath:cb.slice(),items:Wb,prevId:null}));for(Wb=0;Wb<Uc;Wb++)Md=nc.YF(Wb),Md.type===rf.a.outlineElement&&(Md=hf.OutlineElementNavigator.Ee(nc)),0<nc.Sp()&&(zb=zb.concat(this.f3i(Md,cb))),nc.kd(ma.type);cb.pop();return zb}YNa(ma){return ma.split("\\").slice(0,-1)}L0h(ma,cb,zb,Wb=-1,nc=!0){var Uc;
let Md=null,ge=null;const Pd=ma.id.toString();var te=null;3!==zb&&(te=Eb.a.Iwk(ma));if(te)for(let Xe=0;Xe<te.length;Xe++)if(te[Xe]===Pd){ge=Xe+1<te.length?te[Xe+1]:null;Md=Xe?te[Xe-1]:null;break}Pd!==Md&&Pd!==ge||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",zb,Pd,Md,ge,ma.type);te=null===(Uc=this.bub.QCb(ma))||void 0===Uc?void 0:Uc.szb(ma,Wb,nc);Wb=[Object.assign(new Kc.a,{body:te,
id:Pd,revId:Eb.a.Bnf(ma)})];switch(zb){case 0:case 1:return Object.assign(new Ta.a,{parentPath:this.YNa(cb),items:Wb,prevId:Md,nextId:ge});case 4:return Object.assign(new Re,{parentPath:this.YNa(Eb.a.UL(ma)),prevParentPath:this.YNa(cb),items:Wb,prevId:Md,nextId:ge});case 5:return zb=this.MVa.Ksl(Pd),Object.assign(new Re,{parentPath:this.YNa(null!==zb&&void 0!==zb?zb:Eb.a.UL(ma)),prevParentPath:this.YNa(cb),items:Wb,prevId:Md,nextId:ge});case 2:return Object.assign(new qa.a,{parentPath:this.YNa(cb),
items:Wb});case 3:return Object.assign(new Fa.a,{parentPath:this.YNa(cb),items:Wb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",zb,Pd),Object.assign(new Ke.a,{parentPath:this.YNa(cb),items:Wb,prevId:Md,nextId:ge})}}UXl(ma){return this.gka&&this.gka[0]===ma?this.gka[1]:null}UTn(ma){var cb;if(!this.R$c)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Eb.a.qaj(ma))return!1;const zb=ma.id.toString();
var Wb=this.Lvb.contains(zb)?2:0;Wb=this.L0h(ma,Eb.a.UL(ma),Wb);this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,{operation:Wb}));this.Lvb.add(zb);this.gka=[zb,null===(cb=this.bub.QCb(ma))||void 0===cb?void 0:cb.rKc(ma)];return!0}QSn(ma,cb){var zb;if(this.R$c){var Wb=ma.id.toString(),nc=this.YNa(Eb.a.UL(ma));cb=[Object.assign(new Oc,{id:Wb,revId:Eb.a.Bnf(ma),parentPath:nc,delta:cb})];nc=Object.assign(new Fb,{parentPath:nc,items:cb});this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,
{$Ro:nc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Wb);this.gka=[Wb,null===(zb=this.bub.QCb(ma))||void 0===zb?void 0:zb.rKc(ma)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}cok(ma,cb){if(ma.tileReference.referencedPath.length!==cb.tileReference.referencedPath.length||ma.range.start!==cb.range.start||ma.range.length!==cb.range.length)return!1;for(let zb=0;zb<ma.tileReference.referencedPath.length;zb++)if(ma.tileReference.referencedPath[zb]!==
cb.tileReference.referencedPath[zb])return!1;return!0}$nk(ma,cb){if(ma.selectedRanges.length!==cb.selectedRanges.length||ma.content!==cb.content)return!1;for(let zb=0;zb<ma.selectedRanges.length;zb++)if(!this.cok(ma.selectedRanges[zb],cb.selectedRanges[zb]))return!1;return!0}fYi(ma){var cb;if(ma){var zb=new Qa.a,Wb="";for(let Md=0;Md<ma.length;Md++){var nc=ma.J(Md),Uc=(null===(cb=this.bub.QCb(nc.node))||void 0===cb?void 0:cb.szb(nc.node)).content;Wb+=Uc;Uc=nc.cpBegin<Uc.length?nc.cpBegin:-1;Uc=Object.assign(new ua.a,
{start:Uc,length:nc.cpEnd-nc.cpBegin});const ge=nc.node.id.toString();nc=this.YNa(Eb.a.UL(nc.node));nc.push(ge);zb.add(Object.assign(new Kd,{range:Uc,tileReference:Object.assign(new sc,{referencedPath:nc})}))}ma=Object.assign(new zg,{selectedRanges:zb.toArray(),content:Wb});this.JBe&&this.$nk(ma,this.JBe)||(cb=this.Apd?this.Apd:la.a.create().toString(),zb=[Object.assign(new Kc.a,{body:ma,id:cb})],this.Apd?cb=Object.assign(new qa.a,{parentPath:["session","doc"],items:zb}):(this.Apd=cb,cb=Object.assign(new Ta.a,
{parentPath:["session","doc"],items:zb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Gd.a,{operation:cb})),this.JBe=ma)}}A1n(ma){(this.DLe=ma)?this.fYi(this.ib.hb.kb):this.MVa.oGk()}XA(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(e.a)(Ik,"TileView",null,[308]);var th=c(45),Mi=c(100);class of{constructor(ma){Mi.a.assign(of,this,ma)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ma){return Mi.a.matchesTypesFor(ma,
[of.getTypeName()])}}of.H_={T_:of.getTypeName(),B_:of.getBaseTypes()};class ci{constructor(ma){Mi.a.assign(ci,this,ma)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ma){return Mi.a.matchesTypesFor(ma,[ci.getTypeName()])}}ci.H_={T_:ci.getTypeName(),B_:ci.getBaseTypes()};class Fl{constructor(ma){Mi.a.assign(Fl,this,ma)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ma){return Mi.a.matchesTypesFor(ma,
[Fl.getTypeName()])}}Fl.H_={T_:Fl.getTypeName(),B_:Fl.getBaseTypes()};class xg{constructor(ma){Mi.a.assign(xg,this,ma)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ma){return Mi.a.matchesTypesFor(ma,[xg.getTypeName()])}}xg.H_={T_:xg.getTypeName(),B_:xg.getBaseTypes()};class Uf{constructor(ma){Mi.a.assign(Uf,this,ma)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable",
"AugLoop_Table_Table"]}static typeGuard(ma){return Mi.a.matchesTypesFor(ma,[Uf.getTypeName()])}}Uf.H_={T_:Uf.getTypeName(),B_:Uf.getBaseTypes()};var tg;(function(ma){ma[ma.Top=0]="Top";ma[ma.Center=1]="Center";ma[ma.Bottom=2]="Bottom"})(tg||(tg={}));var sg;(function(ma){ma[ma.none=0]="none";ma[ma.firstRow=32]="firstRow";ma[ma.lastRow=64]="lastRow";ma[ma.firstCol=128]="firstCol";ma[ma.lastCol=256]="lastCol";ma[ma.noHBand=512]="noHBand";ma[ma.noVBand=1024]="noVBand";ma[ma.nwCell=160]="nwCell";ma[ma.neCell=
288]="neCell";ma[ma.swCell=192]="swCell";ma[ma.seCell=320]="seCell";ma[ma.defaultLook=1184]="defaultLook"})(sg||(sg={}));Object(e.b)("TableLookFlags",sg);class jh{szb(ma){if(ma)switch(ma.type){case 14:return this.BXk(ma);case 15:return new of;case 16:return this.AXk(ma)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}BXk(ma){var cb=ma.zF||[];let zb=0;for(let Wb=0;Wb<cb.length;Wb++)zb+=cb[Wb];cb=cb.map((Wb,nc)=>({columnId:nc.toString(),widthPercent:0!=zb?100*Wb/zb:
0}));return new xg({columnDefs:cb,tableLook:ma.properties.ia(na.a.tableLook,sg.defaultLook),complexTable:ma.properties.ia(na.a.complexTable,!1),floatingTable:ma.properties.ia(na.a.oji,!1)})}AXk(ma){return new ci({rowspan:ma.properties.ia(na.a.rowSpan,1),colspan:ma.properties.ia(na.a.colSpan,1),borderInfo:{topBorder:{color:ma.properties.ia(na.a.Snb,0),size:ma.properties.ia(na.a.ENb,4),style:ma.properties.ia(na.a.a6a,"single")},leftBorder:{color:ma.properties.ia(na.a.Qnb,0),size:ma.properties.ia(na.a.CNb,
4),style:ma.properties.ia(na.a.Z5a,"single")},rightBorder:{color:ma.properties.ia(na.a.Rnb,0),size:ma.properties.ia(na.a.DNb,4),style:ma.properties.ia(na.a.$5a,"single")},bottomBorder:{color:ma.properties.ia(na.a.Pnb,0),size:ma.properties.ia(na.a.BNb,4),style:ma.properties.ia(na.a.Y5a,"single")}},verticalAlignment:ma.properties.ia(na.a.Bpa,tg.Top),ghostCell:ma.properties.ia(na.a.ghostCell,!1),renderCell:ma.properties.ia(na.a.renderCell,!1),skippedCell:ma.properties.ia(na.a.skippedCell,!1),fillColor:ma.properties.ia(ud.a.wF,
0),verticalMerge:ma.properties.ia(th.a.vMerge,null)})}rKc(ma){return null===ma||void 0===ma?void 0:ma.properties}}Object(e.a)(jh,"TableElementNodeToTileConverter",null,[306]);class eh{constructor(ma,cb,zb){this.jp=cb;this.Nxa=zb;this.EFd=!1;this.gpc=null;this.BHi=(Wb,nc)=>{this.Swa(nc.node,0)};this.xHi=(Wb,nc)=>{Wb=nc.node;this.Nxa.CLb(Wb.id.toString(),Eb.a.UL(Wb))};this.CHi=(Wb,nc)=>{this.Swa(nc.node,3)};this.j2d=(Wb,nc)=>{this.Swa(nc.node,2)};this.EHi=(Wb,nc)=>{this.Swa(nc.node,0)};this.FHi=(Wb,
nc)=>{this.Swa(nc.node,3)};this.DHi=(Wb,nc)=>{Wb=nc.node;this.Nxa.CLb(Wb.id.toString(),Eb.a.UL(Wb))};this.k2d=(Wb,nc)=>{this.Swa(nc.node,2)};this.zHi=(Wb,nc)=>{this.Swa(nc.node,0)};this.yHi=(Wb,nc)=>{Wb=nc.node;this.Nxa.CLb(Wb.id.toString(),Eb.a.UL(Wb))};this.AHi=(Wb,nc)=>{this.Swa(nc.node,3)};this.h2d=(Wb,nc)=>{var Uc;Wb=nc.node;if(nc.property===na.a.ghostCell){if(nc=Wb.pg?Wb:null===(Uc=Wb.awa)||void 0===Uc?void 0:Uc.controlCell){Uc=Wc.GraphIterator.$a(nc);var Md=Uc.Sp();for(var ge=0;ge<Md;ge++){Uc.YF(ge);
var Pd=hf.OutlineElementNavigator.Ee(Uc);this.Nxa.CLb(Pd.id.toString(),String.format("{0}\\{1}",Eb.a.UL(nc),Pd.id));this.Swa(Pd,4);Uc.kd(16)}}}else if(nc.property===ud.a.gf){nc=Wc.GraphIterator.$a(Wb);Uc=nc.Sp();let te=null;Md=[];for(ge=0;ge<Uc;ge++){nc.YF(ge);Pd=hf.OutlineElementNavigator.Ee(nc);this.Nxa.FPn(Pd.id.toString(),String.format("{0}\\{1}",Eb.a.UL(Wb),Pd.id));if(14!==Pd.type){if(te=Eb.a.UL(Pd))this.Nxa.CLb(Pd.id.toString(),te),this.Swa(Pd,5)}else Md.push(Pd);nc.kd(16)}te&&Md.forEach(Xe=>
{this.Nxa.CLb(Xe.id.toString(),String.format("{0}\\{1}",te.split("\\").slice(0,-1).join("\\"),Xe.id));this.Swa(Xe,5)})}this.Swa(Wb,2)};this.OIf=()=>{this.E3c()?this.qU():this.EFd&&!this.Nxa.y7&&this.WSa()};this.xQb=ma.$("AugLoopOperationsAreEnabled")}get bXc(){return this.gpc}init(){this.E3c()&&this.qU();this.Nxa.Ceh(this.OIf)}qU(){const {Mgj:ma,Pee:cb,Agj:zb}=this.AWh();if(ma&&cb&&zb){this.EFd=!0;var Wb=this.xHi,nc=this.CHi,Uc=this.j2d;ma.mu(this.BHi);ma.mW(Wb);ma.Mv(nc);ma.Ap(Uc);Wb=this.DHi;nc=
this.FHi;Uc=this.k2d;cb.mu(this.EHi);cb.mW(Wb);cb.Mv(nc);cb.Ap(Uc);Wb=this.yHi;nc=this.AHi;Uc=this.h2d;zb.mu(this.zHi);zb.mW(Wb);zb.Mv(nc);zb.Ap(Uc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}WSa(){const {Mgj:ma,Pee:cb,Agj:zb}=this.AWh();if(ma&&cb&&zb){this.EFd=!1;var Wb=this.xHi,nc=this.CHi,Uc=this.j2d;ma.vU(this.BHi);ma.Yba(Wb);ma.yha(nc);ma.YX(Uc);Wb=this.DHi;nc=this.FHi;Uc=this.k2d;cb.vU(this.EHi);cb.Yba(Wb);cb.yha(nc);cb.YX(Uc);
Wb=this.yHi;nc=this.AHi;Uc=this.h2d;zb.vU(this.zHi);zb.Yba(Wb);zb.yha(nc);zb.YX(Uc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}Swa(ma,cb){ma&&this.x5a(ma)&&this.Nxa.y7&&this.xQb&&this.Nxa.u7d(ma,cb)}AWh(){return{Mgj:this.jp.Xe(14),Pee:this.jp.Xe(15),Agj:this.jp.Xe(16)}}x5a(ma){const cb=V.App.xa.jb.wc;return!!cb&&cb.$r&&!!cb.jd&&!!cb.jd.Jc&&!!ma&&!!ma.Jc&&ma.Jc.id===cb.jd.Jc.id}E3c(){return!this.EFd&&!!this.Nxa.y7}}Object(e.a)(eh,"TableNodeEventHandler",
null,[305]);class li{constructor(ma,cb){this.sKi=ma;this.mjo=cb}QCb(ma){return ma?14===ma.type||15===ma.type||16===ma.type?this.mjo:12===ma.type?this.sKi:null:null}}Object(e.a)(li,"NodeToTileConverterHolder",null,[304]);var Oj=c(395);class yk{get name(){return"Box4.AugmentationLoop"}xc(ma){this.W=ma;const cb=this.W.resolve("Common.IAppSettingsManager"),zb=cb.$("AugLoopTaskUseTimeBasedYieldStrategy"),Wb=new lj,nc=zb?new ha.a(cb.pc("AugLoopTaskAllowedRunTimeBeforeYielding",10),G.a.Ye):new ba(cb.pc("AugLoopTaskNodesToRunBeforeYielding",
10));this.W.ha("Common.ICpuMeter",()=>N.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new Oa).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new tc(cb,V.App.kk.sl.Xe(12),Wb,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),w.AFrameworkApplication.uc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();Eb.a.Ibe()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",()=>new eh(cb,V.App.kk.sl,Wb)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",
()=>new T).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new De(this.W.resolve("Common.IAppSettingsManager"),this.W.Pa("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>new ia.a(new R.a(()=>V.App.xa.jb.Yc.Bd),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",
()=>new Xb(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new R.a(()=>V.App.xa.jb.Yc.Bd),ma.resolve("Box4.IFeatureHelper"))).singleInstance();const Uc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",()=>new Ub(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),
new R.a(()=>V.App.xa.jb.Yc.Bd),w.AFrameworkApplication.uc,this.W.Pa("Box4.IIntelligenceReader"),this.W.Pa("Box4.IIntelligenceEditor"),this.W.Pa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Pa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ma.resolve("Box4.IFeatureHelper"),Oj.a.instance,()=>{try{return ac.a.getAugLoopRuntimeManager()}catch(Md){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Md),null}},Uc)).singleInstance();
this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new li(new bd.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new jh)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new Ik(cb,Wb,w.AFrameworkApplication.uc,nc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();
a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new yc).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new zc).singleInstance()}init(){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&w.AFrameworkApplication.nZ.BootFailed)a.ULS.sendTraceTag(512624089,389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");
else if(w.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ma=new jb(this.W.resolve("Common.IAppSettingsManager"),w.AFrameworkApplication.Ve,V.App.qia,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),W.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),cb=new ca;this.W.register(291,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().vDo(()=>cb);
w.AFrameworkApplication.Ce("b8afb343;bjdjj400");w.AFrameworkApplication.Ce("72af9564;82jf1647");const zb=Eb.a.qEm(this.W.resolve("Common.IDynamicScriptLoaderProvider").pA,this.W.resolve("Common.App.OAuth.IOAuthManager"),ma,this.W.resolve("Common.ISharedDependencyLoader"),cb);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new tb(zb)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Eb.a.Ibe()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();
this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ma){z.a.instance.Kc(new yk,0,ma);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(yk,"Box4AugmentationLoopPackage",null,[1,2]);var dj=c(621),bl=c(48),mh=c(14),Qk=c(449),Zf=c(1119);class Pl{constructor(ma,cb,zb,Wb=null,nc=null,Uc=null){this.KS=new Zf.a(cb,Wb,nc,Uc);this.Nb=
ma;this.Oc=zb}get type(){return this.KS.type}get id(){return this.KS.id}get intent(){return this.KS.intent}Xf(ma){return new Pl(ma,this.type,this.Oc,this.id,this.intent,this.KS.pwa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.KS,this.Oc)}}Object(e.a)(Pl,"IntentObject",null,[137]);var rh=c(502),tf=c(153),Ql=c(234);class ji{constructor(){this.Xpc=new tf.a}Cud(ma,cb,zb,Wb,nc=null,Uc=null,Md=null){ma=ma.kaa(cb,ma.qa.gqo(cb));ma.Sj||(ma.Sj=new rh.a(ma));ma.Sj.add(new Pl(ma,zb,Wb,
nc,Uc,Md));ma.isFromErrorRangeSplit=!0}cVi(ma){return ma.Nb&&ma.Nb.Sj&&ma.Nb.Sj.l0c(cb=>cb===ma,[ma.type])?!0:!1}dVi(ma,cb){if(ma.type===cb.type&&ma.Oc&&!cb.Oc&&ma.Nb&&ma.Nb.Sj&&ma.Nb.Sj.contains(ma)&&cb.Nb&&cb.Nb.Sj&&cb.Nb.Sj.contains(cb)){var zb=[ma.type];ma.Nb.Sj.l0c(Wb=>Wb===ma,zb);cb.Nb.Sj.l0c(Wb=>Wb===cb,zb)}}nEo(ma,cb,zb){if(!cb)return!1;zb=new sb.a([zb]);for(let Wb=0;Wb<ma.length;Wb++){const nc=ma.J(Wb);if(!nc.Sj)continue;let Uc=!0;zb.cTa(nc.Sj,void 0,Md=>{Md.id&&cb.equals(Md.id)&&(Uc=!1)});
if(!Uc)return!1}return!0}Pjn(ma,cb,zb,Wb){let nc=null,Uc=null;cb=new sb.a([cb]);const Md=ma.qa;for(let ge=0;ge<Md.length;ge++){const Pd=Md.J(ge);if(!Pd.Sj)continue;let te=!0;cb.cTa(Pd.Sj,void 0,(Xe,Yf)=>{if(Yf){var Jg=Yf.Nb.cp<zb,$h=Xe.Nb.cp>Wb;Jg&&Xe.Nb.cp<=zb||Yf.Nb.cp>=Wb&&$h||(Jg&&$h?te=!1:Jg?nc=Xe:$h?Uc=Yf:this.dVi(Yf,Xe))}});if(!te)return!1}if(nc){if(!this.cVi(nc))return!1;this.Cud(ma,zb,nc.type,nc.Oc,nc.id,nc.intent,nc.KS.pwa)}if(Uc){if(!this.cVi(Uc))return!1;this.Cud(ma,Wb,Uc.type,Uc.Oc,Uc.id,
Uc.intent,Uc.KS.pwa)}return!0}K4f(ma){let cb;return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:cb}=this.Xpc.Gc(ma.type,cb)).returnValue?cb.K4f(ma):!0}eRm(ma,cb){if(this.K4f(cb)){var zb=cb.id,Wb=cb.type,nc=cb.begin,Uc=cb.end;if(({cpEnd:Uc}=ji.gsj(ma,nc,Uc)).returnValue){if(Qk.a(Wb)){if(!this.nEo(ma.qa,zb,Wb))return}else if(!this.Pjn(ma,Wb,nc,Uc))return;this.Cud(ma,nc,Wb,!0,zb,cb.intent,cb.KS.pwa);this.Cud(ma,Uc,Wb,!1,zb,cb.intent,cb.KS.pwa)}}}lYc(ma,
cb){V.App.xa.xaf(ma,()=>{const zb=new bl.GraphTransaction(2);try{zb.Eb(ma);const Wb=ma.hY();try{const nc=ma.CZ();try{cb()}finally{nc&&nc.dispose()}}finally{Wb&&Wb.dispose()}}finally{zb&&zb.dispose()}})}W2a(ma,cb){this.lYc(ma,()=>{this.eRm(ma,cb)})}gRm(ma,cb){if(cb.count){var zb=new Xa.a,Wb=new Ql.a;for(var nc of cb){var Uc=nc.value;Qk.a(nc.key)||Uc.Sc((ge,Pd)=>ge.begin!==Pd.begin?ge.begin-Pd.begin:ge.end-Pd.end);if(ji.rEo(Uc))for(var Md of Uc)Uc=Md.end,({cpEnd:Uc}=ji.gsj(ma,Md.begin,Uc)).returnValue&&
(Uc=Uc!==Md.end?new Ya.a(Md.type,Md.begin,Uc,Md.id,Md.intent,Md.KS.pwa):Md,zb.add(Uc.begin),zb.add(Uc.end),ji.Fak(Wb,Uc))}ma.cFd(zb);ma=ma.qa;for(zb=0;zb<ma.length;zb++){nc=ma.J(zb);if(Md=nc.Sj)for(const Pd of cb.keys)Md.YVi(Pd);let ge;({value:ge}=Wb.Gc(nc.cp,ge)).returnValue||(ge=null);if(ge){Md||(Md=nc.Sj=new rh.a(nc));for(const Pd of ge)Md.add(Pd.Xf(nc))}nc.isFromErrorRangeSplit=!0}}}$Df(ma,cb){const zb=new tf.a;for(const Wb of cb){let nc;({value:nc}=zb.Gc(Wb.type,nc)).returnValue||(nc=new Qa.a,
zb.Z(Wb.type,nc));nc.add(Wb)}this.lYc(ma,()=>{this.gRm(ma,zb)})}wto(ma,cb,zb){ma=ma.qa;const Wb=new sb.a([8]);cb===zb&&(zb+=1);for(let nc=0;nc<ma.length;nc++){const Uc=ma.J(nc);Uc.Sj&&Wb.cTa(Uc.Sj,void 0,(Md,ge)=>{ge&&Math.max(ge.Nb.cp,cb)<Math.min(Md.Nb.cp,zb)&&this.dVi(ge,Md)})}}Fbg(ma,cb,zb){this.lYc(ma,()=>{this.wto(ma,cb,zb)})}yto(ma,cb){ma=ma.qa;for(let zb=0;zb<ma.length;zb++){const Wb=ma.J(zb);Wb.Sj&&Wb.Sj.YVi(cb)}}wOb(ma,cb){this.lYc(ma,()=>{this.yto(ma,cb)})}xto(ma,cb,zb){let Wb=!1;cb=cb.qa;
zb=[zb];for(let nc=0;nc<cb.length;nc++){const Uc=cb.J(nc);Uc.Sj&&(Wb=Uc.Sj.l0c(ma,zb)||Wb)}return Wb}Gbg(ma,cb,zb){let Wb=!1;this.lYc(cb,()=>{Wb=this.xto(ma,cb,zb)});return Wb}EKd(ma,cb,zb,Wb){return!ma||0>zb||Wb>ma.characterData.length||zb>Wb?new Qa.a:this.X_a(ma,cb,nc=>Math.max(nc.begin,zb)<=Math.min(nc.end,Wb))}X_a(ma,cb,zb){return ji.VGl(ma,cb,zb)}static VGl(ma,cb,zb){const Wb=new Qa.a;ma=ma.qa;cb=new sb.a([cb]);if(!ma)return Wb;for(let nc=0;nc<ma.length;nc++){const Uc=ma.J(nc);Uc.Sj&&cb.cTa(Uc.Sj,
void 0,(Md,ge)=>{ge&&(Md=new Ya.a(ge.type,ge.Nb.cp,Md.Nb.cp,ge.id,ge.intent,ge.KS.pwa),zb(Md)&&Wb.add(Md))})}return Wb}nLc(ma,cb){const zb=new Qa.a;if(!ji.xym(ma.contextId))return zb;let Wb;const nc=ma.node;ma.contextId!==mh.a.paragraph?(Wb=ma.cpBegin,ma=ma.cpEnd):(Wb=0,ma=nc.characterData.length);zb.addRange(this.EKd(nc,cb,Wb,ma));return zb}Qzn(ma){this.Xpc.ub(0)||this.Xpc.Z(0,ma)}static gsj(ma,cb,zb){ma=fc.ParagraphReader.textLength(ma);if(cb>=ma)return{returnValue:!1,cpEnd:zb};zb>ma&&(zb=ma);return{returnValue:!0,
cpEnd:zb}}static rEo(ma){if(!ma.count)return!0;const cb=new dj.a,zb=ma.J(0).type,Wb=Qk.a(zb);let nc=-1;for(const Uc of ma){if(Uc.type!==zb||(Qk.c(Uc.type)?Uc.begin>Uc.end:Uc.begin>=Uc.end))return!1;if(Wb){ma=Uc.id;if(!ma||ma.equals(la.a.nil)||cb.contains(ma))return!1;cb.add(ma)}else if(-1===nc)nc=Uc.end;else if(nc>Uc.begin)return!1}return!0}static Fak(ma,cb){let zb;({value:zb}=ma.Gc(cb.begin,zb)).returnValue||(zb=new Qa.a,ma.Z(cb.begin,zb));zb.add(new Pl(null,cb.type,!0,cb.id,cb.intent,cb.KS.pwa));
({value:zb}=ma.Gc(cb.end,zb)).returnValue||(zb=new Qa.a,ma.Z(cb.end,zb));zb.add(new Pl(null,cb.type,!1,cb.id,cb.intent,cb.KS.pwa))}static xym(ma){return ma===mh.a.Fd||ma===mh.a.Vc||ma===mh.a.paragraph}}Object(e.a)(ji,"IntentRangeEditor",null,[307]);class fi{constructor(){this.W=null}get name(){return"Box4.Intent"}xc(ma){this.W=ma;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new ji).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ma){z.a.instance.Kc(new fi,
0,ma);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(e.a)(fi,"PackageManager",null,[1,2]);var Yh=c(999),Yj=c(123),ef=c(1378);class Zj{constructor(ma){this.wPm=ma;this.sPm=[]}get handler(){return this.wPm}get Yla(){return this.sPm}}Object(e.a)(Zj,"RegisteredListener",null,[]);class Od{constructor(ma,cb){this.type=0;this.payload=null;this.type=ma;this.payload=cb}}Object(e.a)(Od,"OfficeSharedCommentsEvent",null,[846]);class Sh{constructor(){this.eventType=0;this.newViewContainer=
null;this.viewContainerVisibilityState=1}}Object(e.a)(Sh,"ViewContainerEvent",null,[846]);var qf=c(581);class Ld{constructor(ma){this.vDf=!1;this.Una=new Qa.a;this.FYd=ma}pzn(ma){ma=new Zj(ma);this.Una.add(ma)}Kmj(ma){for(let cb=0;cb<this.Una.count;++cb)if(this.Una.J(cb).handler===ma){this.Una.removeAt(cb);break}}LRa(ma=!1){const cb=()=>{if(w.AFrameworkApplication.Rk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let nc=0;nc<this.Una.count;++nc){const Uc=
this.Una.J(nc);for(;0<Uc.Yla.length;){var zb=Array.dequeue(Uc.Yla);if(Object(Yj.a)(Sh,zb)){var Wb=Uc.handler;Wb(zb)}else Object(Yj.a)(Od,zb)&&(Wb=Uc.handler,Wb(zb.type,zb.payload))}}};ma?cb():this.vDf||(this.vDf=!0,qf.a.g2(this.FYd,()=>{cb();this.vDf=!1},ef.a.lml))}}Object(e.a)(Ld,"GenericEventHost",null,[]);class fh{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=
this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(e.a)(fh,"BasicEventPayload",null,[881]);class Vm{constructor(ma){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ma}}Object(e.a)(Vm,"CommentContextDetails",null,[]);class zl{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=
0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(e.a)(zl,"ContextChangeWithSelectedThreadIndex",null,[881]);class Pm{constructor(){this.tasks=this.comments=null}}Object(e.a)(Pm,"LoadCommentsNoVirtualization",null,[881]);class xo extends Ld{constructor(ma){super(ma);this.r3g=0}O0n(){this.r3g=1656}Yzn(ma,cb,zb,Wb,nc,Uc){ma=new Zj(ma);Uc&&Array.enqueue(ma.Yla,this.ERk(Uc,this.r3g));Uc=cb?cb.length:0;Array.enqueue(ma.Yla,this.czh(Uc,zb,Wb,0));Uc&&Array.enqueue(ma.Yla,this.aAh(cb,
nc));this.Una.add(ma);this.LRa()}Djc(ma){this.Kmj(ma)}MSn(ma,cb,zb,Wb=0){this.FEb(this.czh(ma,cb,zb,Wb));this.LRa()}NSn(ma,cb,zb){this.FEb(this.dSk(ma,cb,zb));this.LRa()}iTn(ma,cb){this.FEb(this.aAh(ma,cb));this.LRa()}selectComment(ma){this.FEb(this.WAh(ma,6));this.LRa()}highlightComment(ma){this.FEb(this.WAh(ma,7));this.LRa()}Scg(ma,cb){this.FEb(this.kVk(ma,cb));this.LRa()}eRf(ma,cb){this.FEb(this.gXk(ma,cb));this.LRa()}ERk(ma,cb=0){const zb=new fh;zb.modelCapabilityFlags=ma;zb.richTextCapabilityFlags=
cb;return new Od(12,zb)}czh(ma,cb,zb,Wb){const nc=new fh;nc.numberOfComments=ma;nc.numberOfThreads=cb;nc.contextDetails=Object.assign(new Vm(zb),{nextPopulatedContextDetails:Wb});nc.contextDrafts=null;nc.rehydrationDrafts=null;return new Od(0,nc)}dSk(ma,cb,zb){const Wb=new fh;Wb.comments=ma;Wb.numberOfThreads=cb;Wb.tasks=zb;return new Od(2,Wb)}aAh(ma,cb){const zb=new Pm;zb.comments=ma;zb.tasks=cb;return new Od(1,zb)}WAh(ma,cb){const zb=new fh;zb.commentId="";ma&&(zb.commentId=ma);return new Od(cb,
zb)}kVk(ma,cb){const zb=new fh;zb.changes=[];zb.contextDetails=Object.assign(new Vm(cb),{nextPopulatedContextDetails:ma});return new Od(10,zb)}gXk(ma,cb){const zb=new fh;zb.commentId=ma;zb.smartReplies=cb;return new Od(15,zb)}FEb(ma){for(let cb=0;cb<this.Una.count;++cb)Array.enqueue(this.Una.J(cb).Yla,ma)}}Object(e.a)(xo,"OfficeSharedCommentsEventHost",Ld,[870]);var Vn=c(208),zk=c(150),Lh=c(236);class rk{constructor(){this.mLe=this.Xzg=!1;this.mS=this.jn=this.NOg=this.UUg=this.jtd=this.KVb=this.Z7g=
this.CEg=this.pA=this.Pxc=null}initialize(ma,cb,zb,Wb=null,nc=null,Uc=null,Md=null,ge=null,Pd=null,te=null){this.pA=ma;this.CEg=cb;this.Z7g=zb;this.KVb=Wb;this.jtd=nc;this.UUg=Uc;this.NOg=Md;this.jn=ge;this.Xzg=!0;this.mS=Pd;this.Pxc=te}cRd(ma=null,cb=null){if(!this.Xzg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((zb,Wb)=>{Wb(qf.a.$C(-2130915313))});if(this.mLe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.Pxc||(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.Pxc=appResourceLoader.loadChunk("sharedComments"):this.Pxc=this.pA.loadScript("sharedComments"));return this.Pxc.then(()=>{ma&&ma();this.mLe||(this.mS&&this.mS.execute(zb=>{zb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),cb&&cb(),sharedComments.instantiate(this.CEg,this.Z7g,this.KVb,this.jtd,this.UUg,this.NOg,this.jn));this.mLe=!0})}}Object(e.a)(rk,
"CommentActivationManager",null,[913]);class Jj extends Ld{constructor(ma){super(ma)}JBn(ma){this.pzn(ma)}ruo(ma){this.Kmj(ma)}r8i(ma){ma=this.$Rk(ma);for(let cb=0;cb<this.Una.count;++cb)Array.enqueue(this.Una.J(cb).Yla,ma);this.LRa(!0)}$Rk(ma){const cb=new Sh;cb.eventType=3;cb.viewContainerVisibilityState=ma;return cb}Kml(){const ma=this.hYk();for(let cb=0;cb<this.Una.count;++cb)Array.enqueue(this.Una.J(cb).Yla,ma);this.LRa(!0)}hYk(){const ma=new Sh;ma.eventType=2;return ma}}Object(e.a)(Jj,"ViewContainerEventHost",
Ld,[838]);var Rl=c(52);class cl{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(cl,"CommentUIActionPayload",null,[]);var Am=c(318);class fk{constructor(ma,cb){this.ga=ma;this.ypb=cb;this.vlc=new Am.a;for(let zb of this.ypb)this.vlc.Z(zb.value.canvasActionId,zb.key),ma=zb.value,ma.delayActionsUntilRegistration||this.pa(ma)}pa(ma){ma.withFlags?this.ga.gb(ma.canvasActionId,ma.canvasContextId,Object(Rl.a)(this,this.sbh,"actionHandler"),97):this.ga.pa(ma.canvasActionId,ma.canvasContextId,
Object(Rl.a)(this,this.sbh,"actionHandler"))}gRa(ma,cb){this.ypb.ub(ma)&&(this.ypb.J(ma).delayActionsUntilRegistration&&this.pa(this.ypb.J(ma)),this.ypb.J(ma).registeredCallback=cb)}sbh(ma,cb,zb,Wb,nc){if(this.vlc.ub(ma)){var Uc=this.vlc.J(ma);if(!this.ypb.ub(Uc))return 8;const Md=this.ypb.J(Uc);if(Md.preCallback){const ge=Md.preCallback(ma,cb,zb,Wb,nc);if(2!==ge)return ge}if(!Md.registeredCallback)return 1===zb?8:2;Uc=Object.assign(new cl,{actionType:Uc});1===zb&&(Uc.actionBehavior=1);Uc=Md.registeredCallback(Uc);
return Md.postCallback?Md.postCallback(Uc,ma,cb,zb,Wb,nc):Uc?32:8}return 2}}Object(e.a)(fk,"OfficeSharedCommentsActionHost",null,[872]);var cf=c(1758),ig=c(57),gk=c(112),wi=c(1427),pf=c(13),wn=c(32),Gh=c(658),Gl=c(1124),Jk=c(131),Ei=c(307),bc=c(54),oe=c(21),Me=c(1017),Ri=c(1010),Rk=c(1528),cg=c(157),af=c(6),Zi=c(42),si=c(705),eo=c(498),lk=c(18),cn=c(1949);class Al{constructor(ma){this.vV=ma;this.cdc=new O.a;this.N0a=new O.a;this.Mdm();this.F8l=[new cn.a(Zi.a.Guh,Zi.a.TJk),new cn.a(Zi.a.Szd,Zi.a.SJk),
new cn.a(Zi.a.xuh,Zi.a.IJk),new cn.a(Zi.a.Kzd,Zi.a.HJk),new cn.a(Zi.a.Huh,Zi.a.VJk),new cn.a(Zi.a.Tzd,Zi.a.UJk)]}kRa(ma){this.vV.kRa(ma);this.RCn(ma)}exf(ma,cb){return!!ma&&!!ma.objectId&&cb.contains(la.a.Gf(ma.objectId))}sPa(ma){ma=Object(pd.a)(240,ma);return!!ma&&!!ma.objectId}RCn(ma){for(const cb of this.F8l)ma.classList.remove(cb.className,cb.bNc);ma.classList.remove(Zi.a.FQf,Zi.a.Vzd,Zi.a.yuh,Zi.a.Uzd,Al.Ahg)}Mdm(){const ma=new O.a,cb=new O.a;ma.add(0,null);ma.add(1,Zi.a.Szd);ma.add(2,Zi.a.Guh);
ma.add(3,Zi.a.Vzd);cb.add(0,null);cb.add(1,Zi.a.Kzd);cb.add(2,Zi.a.xuh);cb.add(3,Zi.a.yuh);this.N0a.Z(1,ma);this.N0a.Z(2,cb);this.N0a.Z(3,cb);this.cdc.add(0,null);this.cdc.add(1,Zi.a.Tzd);this.cdc.add(2,Zi.a.Huh);this.cdc.add(3,Zi.a.Uzd)}}Al.Ahg="CommentImportant";Object(e.a)(Al,"CommentHighlightUtils",null,[]);class Vc{constructor(){this.GEd=0;this.bzb=null}}Object(e.a)(Vc,"CommentGuidsInElementInfo",null,[]);class Sk{constructor(){this.m$h=!1;this.kla=this.UIb=null;this.NQa=this.dEb=0}}Object(e.a)(Sk,
"HighlightInfoForElement",null,[]);class ne{constructor(){this.Aci=this.Cci=this.Bci=-1;this.Jai=[];this.F0b=[];this.POc=this.QOc=-1;this.ohi=!1}}Object(e.a)(ne,"HighlightInfoForElementsInPara",null,[]);class qi{constructor(){this.Cbg=this.pMf=null}}Object(e.a)(qi,"OnAnchorMouseOutData",null,[]);var Wf=c(1462);class Ak{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge){this.zpe=ma;this.p9=cb;this.Qj=zb;this.g1=Wb;this.ga=nc;this.Gb=Uc;this.Fj=Md;this.RVa=this.fj=null;this.a2m=Pd=>{if(!this.fj||this.g1.tTd)return!0;
if(Pd=Pd.Lo){if(this.fj.iA&&Pd[0].toString()===this.fj.iA.objectId)return!0;this.RVa&&Pd[0].equals(this.RVa.Cbg[0])?this.Gb.Se(this.RVa.pMf):(this.RVa&&(this.Gb.Se(this.RVa.pMf),this.ga.Ub(pf.a.Wzd,2,this.RVa.Cbg)),this.fj.gp.phi(Pd[0])&&!this.Fj.vn||this.ga.Ub(pf.a.v1e,2,Pd));this.RVa=null}return!0};this.$1m=Pd=>{if(this.g1.tTd)return!0;const te=Pd.Lo;te&&(Pd=new za.a(2,1,0,()=>{this.ga.Ub(pf.a.Wzd,2,te);this.RVa=null}),this.Gb.Xb(Pd),this.RVa=Object.assign(new qi,{pMf:Pd,Cbg:te}));return!0};this.iDi=
Pd=>{const te=new za.a(2,1,0,()=>{if(this.fj&&!this.fj.gp.Wy){var Xe=Pd.Lo;if(!Xe)Xe=V.App.xa.qp.currentScope,this.fj.iA&&(!Xe||Xe.name!==cg.AFrame.QL&&Xe.name!==cg.AFrame.sr)&&this.fj.clearSelection();else if(!this.fj.iA||Xe.toString()!==this.fj.iA.objectId)if(Xe=this.fj.gp.KZ(Xe.toString()))Xe=Object.assign(new wi.a,{commentId:Xe.id,ZQ:!1,B8:1}),this.ga.Ub(lk.a.selectComment,2,Xe)}});this.Gb.Xb(te);return!1};ge.execute(Pd=>{this.fj=Pd})}$mh(ma,cb,zb,Wb){const nc=new ne,Uc=[],Md=this.p9.sPa(cb)?
cb.objectId:null;for(let te=0,Xe=ma.length;te<Xe;te++){var ge=ma[te],Pd=Wf.g(ge);const Yf=Wf.d(ge);ge=new dj.a;const Jg=new Sk;if(Pd){const $h=new eo.a(Wf.c);Pd=this.hNh(Pd,Md,$h);0<Pd.length&&(this.Rxo(Pd,zb,ge,Jg,Md,Wb),Uc.push(Object.assign(new Vc,{GEd:te,bzb:$h})))}Yf&&(Pd=this.hNh(Yf,Md),0<Pd.length&&(this.Txo(Pd,zb,ge,Jg,nc,Md,Wb,te),this.lwo(Uc,Pd,te,Jg)));0<zb.count&&this.Uxo(cb,zb,Jg,Wb);this.jwo(Uc,Jg);nc.Jai.push(Jg)}return nc}yih(ma,cb,zb){let Wb=!1;for(let nc=0,Uc=ma.length;nc<Uc;nc++){const Md=
ma[nc],ge=cb.Jai[nc],Pd=si.a(Md);if(1!==Pd&&2!==Pd&&3!==Pd)continue;const te=3===Pd||2===Pd&&-1!==Md.className.indexOf(Zi.a.wOa);this.p9.kRa(Md);this.Ebk(Md,ge,te,Wb);this.tak(Md,nc,Pd,ge,cb,zb);this.uak(Md,nc,cb,ge);Wb=te}}hNh(ma,cb,zb=null){const Wb=[];for(let nc=0;nc<ma.length;nc++)this.zpe.N9i(ma[nc],ma[nc].toString()===cb)&&(Wb.push(ma[nc]),zb&&zb.add(ma[nc]));return Wb}Rxo(ma,cb,zb,Wb,nc,Uc){var Md;let ge=!1,Pd=!1;for(const Xe of ma){cb.add(Xe);zb.add(Xe);var te=Xe.toString();te===nc?(te=Uc?
1:2,Wb.NQa=te,Wb.dEb=te):this.exf(this.fj.iA,cb)&&(te===(null===(Md=this.fj.iA)||void 0===Md?void 0:Md.objectId)&&(Pd=!0),ge=!0)}0<ma.length&&!Wb.NQa&&(Wb.NQa=Pd?1:3,Wb.dEb=ge?1:3)}Txo(ma,cb,zb,Wb,nc,Uc,Md,ge){var Pd,te;const Xe=new eo.a(Wf.c);Md=Md?1:2;let Yf=!1;for(const Jg of ma){const $h=Jg.toString();cb.contains(Jg)||($h===Uc?nc.Aci=ge:(nc.Bci=ge,Wb.NQa=3,(null===(Pd=this.fj.iA)||void 0===Pd?void 0:Pd.objectId)===$h&&(nc.Cci=ge,Wb.NQa=1)),Xe.add(Jg));$h===(null===(te=this.fj.iA)||void 0===te?
void 0:te.objectId)&&(Yf=!0);cb.remove(Jg);zb.contains(Jg)&&this.Sxo(Wb,Jg,$h,Uc,Md);$h===Uc&&(Wb.NQa=Md)}0<ma.length&&!Wb.NQa&&(Wb.NQa=Yf?1:3);0<Xe.count&&nc.F0b.push(Object.assign(new Vc,{GEd:ge,bzb:Xe}))}lwo(ma,cb,zb,Wb){0!==ma.length&&(cb.forEach(nc=>{for(let Uc=ma.length-1;0<=Uc;Uc--){const Md=ma[Uc];if(Md.bzb.contains(nc)){Md.GEd===zb&&(Wb.kla?Wb.kla.push(nc):Wb.kla=[nc]);Md.bzb.remove(nc);break}}}),ma=ma.filter(nc=>0<nc.bzb.count))}Uxo(ma,cb,zb,Wb){var nc,Uc;this.exf(ma,cb)?zb.dEb=Wb?1:2:zb.dEb||
(zb.dEb=null!=(null===(nc=this.fj.iA)||void 0===nc?void 0:nc.objectId)&&cb.contains(la.a.Gf(null===(Uc=this.fj.iA)||void 0===Uc?void 0:Uc.objectId))?1:3);zb.UIb||(zb.UIb=[]);for(const Md of cb)zb.UIb.push(Md)}jwo(ma,cb){if(0<ma.length){cb.kla||(cb.kla=[]);for(const zb of ma[ma.length-1].bzb)cb.kla.push(zb)}}Sxo(ma,cb,zb,Wb,nc){ma.m$h=!0;ma.UIb||(ma.UIb=[]);ma.UIb.push(cb);zb===Wb&&(ma.dEb=nc)}exf(ma,cb){return!!ma&&!!ma.objectId&&cb.contains(la.a.Gf(ma.objectId))}Ebk(ma,cb,zb,Wb){!cb.NQa||zb||Wb||
((zb=this.p9.cdc.J(cb.NQa))&&ma.classList.add(zb),cb.m$h&&ma.classList.add(Zi.a.FQf))}tak(ma,cb,zb,Wb,nc,Uc){Wb=this.p9.N0a.J(zb).J(Wb.dEb);cb<nc.Aci?Wb=Uc?this.p9.N0a.J(zb).J(1):this.p9.N0a.J(zb).J(2):cb<nc.Bci&&!Wb&&(Wb=cb<nc.Cci?this.p9.N0a.J(zb).J(1):this.p9.N0a.J(zb).J(3));Wb&&(cb=nc.ohi,ma.classList.add(Wb),cb&&ma.classList.add(Al.Ahg))}uak(ma,cb,zb,Wb){Wb.kla||(Wb.kla=this.$wl(cb,zb)||Wb.UIb);cb=null;Wb.kla&&0<Wb.kla.length&&(this.Qj.mb(af.a.MX,ma,this.a2m,Wb.kla),this.Qj.mb(af.a.Mga,ma,this.$1m,
Wb.kla),cb=Wb.kla[0]);this.Qj.mb(af.a.click,ma,this.iDi,cb);this.Qj.mb(af.a.vJ,ma,this.iDi,cb)}$wl(ma,cb){for(;0<cb.F0b.length&&cb.F0b[0].GEd===ma;)cb.F0b.splice(0,1);if(0<cb.F0b.length){ma=[];for(const zb of cb.F0b[0].bzb)ma.push(zb);return ma}return null}}Object(e.a)(Ak,"AllMarkupModeHighlightChangeHandler",null,[214]);var Qf=c(1438);class Tk extends Qf.a{constructor(ma){super(100,25);this.tlc=new O.a(0);this.zDj=6E4;this.hml=()=>{const cb=this.tlc.keys;if(cb.length){var zb="";for(let Wb=0;Wb<cb.length;Wb++)zb+=
cb.J(Wb)+":"+this.tlc.J(cb.J(Wb))+";";this.Poa(zb);this.tlc=new O.a(0)}};this.Jpb=new Qa.a;this.Jpb.add(1);this.Jpb.add(6);this.Jpb.add(2);this.Jpb.add(4);this.Jpb.add(10);this.Jpb.add(11);this.lg=ma;ma.qVf&&window.setInterval(this.hml,this.zDj)}SFa(ma){this.lg.kso&&this.lg.qVf&&(this.Jpb.contains(ma)?this.cun(ma):this.Poa(ma+""))}cun(ma){this.tlc.Z(ma,this.tlc.Ty(ma,0)+1)}}Object(e.a)(Tk,"CommentActionInTypingRecorder",Qf.a,[248]);var ff=c(1562),vj=c(201);class jd{static cEn(ma){ma&&ma.atmention&&
delete ma.atmention.isCurrentUser;return ma}}Object(e.a)(jd,"DeltaFormatHelpers",null,[]);class Uk{constructor(){this.optional=this.attributes=null}}Object(e.a)(Uk,"Operation",null,[]);class If extends Uk{constructor(){super();this.insert=null}}Object(e.a)(If,"DeltaOperation",Uk,[]);class zf{constructor(){this.ops=null}}Object(e.a)(zf,"Delta",null,[]);var Wn=c(119),Kh=c(193),ti=c(170),jg=c(37),ej=c(47),dl=c(78),ui=c(135),hb=c(518),Ab=c(1168),Qb=c(1712);class uc extends Qb.ACommentFormatTranslator{constructor(ma,
cb){super(ma);this.me=cb}J$f(ma){const cb=new ff.a;for(let zb=0;zb<ma.length;zb++){const Wb=ma[zb];Wb.bFb=!0;this.Mkk(cb,Wb);cb.Sfa("\n")}return[cb.CKc()]}Tmo(ma,cb){ma=ff.a.lCb(ma[0]);ma=this.mkn(ma);const zb=new Qa.a;let Wb=0,nc=null,Uc=null;for(;Wb<ma.ops.length;){const Md=ma.ops[Wb];nc||(nc=Ab.a.instance.createInstance(393230),nc.bFb=!0,nc.Zg(na.a.Pc,vj.a.lG()),cb(nc),nc.qa.clear(),nc.vxa(""));"\n"===Md.insert?(Uc=this.PBf(nc,Uc),this.g3n(nc),zb.add(nc),nc=null):Uc=this.sFm(nc,Md,Uc);Wb++}return zb.toArray()}g3n(ma){const cb=
ma.Joh();for(let zb=0;zb<cb;zb++)ma.wordRunProperties.Sq.Z(zb,uc.IXm),ma.wordRunProperties.rt.Z(zb,uc.vIf)}PBf(ma,cb){var zb=ma.bFd();zb.cp===ma.characterData.length?zb.Uh=!0:(zb=Object.assign(new Kh.a(ma,ma.characterData.length),{Uh:!0}),ma.qa.add(zb));zb=ma.qa.last;if(cb){cb=!!cb.Zw;const Wb=this.Yvh(ma,zb,!cb,cb,null);zb.formatting=Wb;cb&&(ma=this.Wvh(ma,zb),zb.DT=ma.Hj);zb.ql=!0;cb=null}zb.cp||zb.formatting||(zb.formatting=new ti.a(zb,la.a.nil));return cb}sFm(ma,cb,zb){const Wb=ma.bFd(),nc=!!cb.attributes&&
!!cb.attributes.link,Uc=!!cb.attributes&&!!cb.attributes.atmention,Md=this.Yvh(ma,Wb,nc,Uc,cb);Wb.formatting=Md;zb&&(zb.Zw&&(zb=this.Wvh(ma,Wb),Wb.DT=zb.Hj),Wb.ql=!0,zb=null);if(nc||Uc)this.TEm(Wb,ma,cb),zb=Wb.hyperlink;ma.vxa(ma.characterData+cb.insert);return zb}Wvh(ma,cb){cb=new ti.a(cb,la.a.create());let zb=this.TBd();zb.setValue(na.a.cGb,!0);zb=ma.Jc.UQ(zb);cb.Hj=zb.id;return cb}Yvh(ma,cb,zb,Wb,nc){cb=new ti.a(cb,la.a.create());let Uc=Ab.a.instance.createInstance(1179649);if(zb||Wb)Uc.setValue(ud.a.$y,
!0),Uc.setValue(ud.a.s3,!0),zb&&this.RVn(ma,Uc);this.lg.hyb&&nc&&nc.attributes&&this.P0n(nc.attributes,Uc);Uc=ma.Jc.UQ(Uc);cb.Hj=Uc.id;return cb}RVn(ma,cb){jg.a.instance.J(6)&&(ma=this.me.jx(ma))&&(ma=ma.fh(ej.StyleReader.qPb))&&cb.setValue($d.a.Rv,ma.id)}P0n(ma,cb){this.eMb(ma.weight>=ff.a.ZEf,cb,ud.a.bold,!0);this.eMb(ma.italic,cb,ud.a.italic,!0);this.eMb(ma.underline,cb,ud.a.underline,!0);this.eMb(ma.underline,cb,ud.a.underlineType,xe.a.uOb);this.eMb(ma.strikethrough,cb,ud.a.strikethrough,!0);
if(dl.a.LSc(ma.highlight)){var zb=dl.a.K0a(ma.highlight);this.eMb(!!ma.highlight,cb,ud.a.highlight,dl.a.bca(zb))}dl.a.LSc(ma.color)&&(zb=dl.a.K0a(ma.color),this.eMb(!!ma.color,cb,ud.a.fontColor,dl.a.bca(zb)))}eMb(ma,cb,zb,Wb){ma&&cb.setValue(zb,Wb)}TEm(ma,cb,zb){if(zb.attributes&&zb.attributes.atmention){var Wb=ui.HyperlinkReader.ZNa(zb.attributes.atmention.email);zb=zb.optional&&zb.optional.atmention&&zb.optional.atmention.contentId?zb.optional.atmention.contentId:uc.aql(1===zb.attributes.atmention.resolveState);
Wb=new hb.a(ma,Wb,!0,void 0,void 0,void 0,zb);this.WQk(Wb,cb.Jc);ma.hyperlink=Wb}else cb=ui.HyperlinkReader.ZNa(zb.attributes.link),Wb=this.ETk(ma.paragraph.qa.first),ma.hyperlink=new hb.a(ma,cb,!1,Wb.Hj)}ETk(ma){let cb=this.PAh();cb=ma.paragraph.Jc.UQ(cb);ma=new ti.a(ma,la.a.nil);ma.Hj=cb.id;return ma}WQk(ma,cb){var zb=String.format(' HYPERLINK "{0}"',ma.url),Wb=ma.Zw;const nc=this.TBd();nc.setValue(na.a.Qq,15);nc.setValue(na.a.Zw,Wb);nc.setValue(na.a.pPa,!0);nc.setValue(na.a.fieldInstruction,zb);
ma.Dsa(cb.UQ(nc).id);Wb=this.TBd();Wb.setValue(na.a.Qq,47);Wb.setValue(na.a.fieldInstruction,zb);ma.Dsa(cb.UQ(Wb).id);zb=this.TBd();zb.setValue(na.a.Qq,16);ma.Dsa(cb.UQ(zb).id)}PAh(){const ma=Ab.a.instance.createInstance(1179649);ma.setValue(ud.a.$y,!0);ma.setValue(ud.a.s3,!0);ma.setValue(ud.a.isHidden,!0);return ma}TBd(){const ma=this.PAh();ma.setValue(ud.a.Y8,!0);return ma}mkn(ma){const cb=new Qa.a;for(let zb=0;zb<ma.ops.length;zb++){const Wb=ma.ops[zb];Wb.optional=jd.cEn(Wb.optional);if(-1!==Wb.insert.indexOf("\n")&&
"\n"!==Wb.insert){const nc=Wb.insert.split("\n");for(let Uc=0;Uc<nc.length;Uc++)if(zb!==ma.ops.length-1||Uc!==nc.length-1||nc[Uc])cb.add(Object.assign(new If,{insert:nc[Uc],attributes:Wb.attributes,optional:Wb.optional})),Uc!==nc.length-1&&cb.add(Object.assign(new If,{insert:"\n"}))}else cb.add(Wb)}return Object.assign(new zf,{ops:cb.toArray()})}static aql(ma){return Qb.ACommentFormatTranslator.Ook+Wn.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ma?"Z":"")}}uc.IXm=0;uc.vIf=0;Object(e.a)(uc,
"CommentDeltaFormatTranslator",Qb.ACommentFormatTranslator,[]);var Xc=c(1620),xd=c(1512);class de{get userPrincipalName(){return this.K.lb("UserPrincipalName")}constructor(ma,cb,zb){this.fk=ma;this.K=cb;this.BS=zb}gD(ma){return this.fk.gD(ma)}Flm(ma){ma=this.fk.gD(ma);return ma?!ma.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}tQc(ma){return this.fk.tQc(ma)}isCurrentUserMentioned(ma){var cb,zb;ma=this.fk.Pwl(ma);for(const Wb of ma){if(!Wb.text||0===Wb.text.length)continue;
ma=ff.a.lCb(Wb.text[0]);let nc=0;for(;ma.ops&&nc<ma.ops.length;){const Uc=null===(zb=null===(cb=ma.ops[nc])||void 0===cb?void 0:cb.attributes)||void 0===zb?void 0:zb.atmention;if(Uc&&Uc.email===this.userPrincipalName)return!0;nc++}}return!1}IWc(){this.BS.Moa("OnContentFilterUpdate")}}Object(e.a)(de,"CommentFilterActor",null,[244]);var Dd=c(86),ee=c(1945),vf=c(882),eg=c(603);class $b{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te){this.ii=ma;this.Gb=cb;this.Lh=zb;this.zTa=Wb;this.lg=nc;this.Fj=Uc;this.b5=
Md;this.Jh=ge;this.CS=Pd;this.yO=te;this.Mrb=null;this.xOe=0;this.hid=!1;this.Xmd=0;this.HOb=this.i4c=this.HDg=this.Esc=this.axb=!1;this.updateViewportInfo=()=>{this.CS.h5f()&&this.Jh.updateViewportInfo(this.hid,this.VNf)};this.qkb=()=>{this.Jh.Bka.Dva()&&(this.I_c(this.Jh.Bka.wc),this.Jh.Bka.uec(this.qkb))};this.VNf=()=>{this.H6a();this.CS.UNf()};this.T7f=()=>{!this.axb&&this.CS.B4f()&&(this.Xmd=this.AQe.scrollTop,this.axb=!0,this.zTa.SFa(2))};this.PVf=(Xe,Yf)=>{this.axb&&(Xe=this.AQe.scrollTop,
Xe-this.Xmd?(this.Esc||Yf.Gie||this.updatePosition(),this.Esc||1!==Yf.Gie||this.H6a(),this.qUe(Xe),this.CS.RMf()):this.Esc=this.axb=!1)};this.AQe=this.Jh.Nca;this.kha=eg.a.X2d;this.Vs=this.Jh.Vs;this.Jh.Mvh()}get YSd(){return this.CS.nyf()}get kha(){return this.Jh.kha}set kha(ma){this.Jh.kha=ma}get qjh(){return"1"===this.Vs.DE.style.opacity}b9i(ma){this.i4c||(this.i4c=!0,this.Jh.GMi(),this.Mrb=ma(this.Vs.NDa,this.Jh.OVi,()=>{this.updatePosition()}),this.Jh.Gti(this.Mrb),this.CS.initialize(this.Mrb,
this),this.Jh.initialize(this.Mrb,this.CS.skb),this.Jh.kTi(),this.Jh.W8i(),this.Jh.X8i(),this.Jh.a9i(this.CS.sXe,this.CS.V1d,this.CS.U1d),this.xWf())}k3c(){}Dbe(){return this.Jh.T9i()}setInitialActiveContainerId(ma,cb,zb=null){this.Jh.setInitialActiveContainerId(ma,0,zb)}updatePosition(){if(!this.HOb&&this.YSd&&this.ii.t6b()){var ma=G.a.Ye()-this.xOe<eg.a.Rpj;ma||this.hid||this.H6a(ma)}}xWe(){this.H6a()}MRa(ma,cb,zb){this.Jh.MRa(ma,cb,zb)}deleteContainer(ma,cb,zb=!1){this.Jh.deleteContainer(ma,cb,
()=>{this.ii.Gpf()||this.Jh.nqf();this.CS.cLf()},zb)}addContainer(ma,cb,zb){this.Jh.addContainer(ma,cb,zb,this.Jh.$e,this.CS.BLc,this.CS.OJf)}lLi(ma){this.HOb=!0;ma();this.HOb=!1}z0c(ma,cb,zb){this.Jh.z0c(ma,cb,zb)}q0b(){this.Jh.q0b()}mqj(){const ma="1"===this.Vs.DE.style.opacity;switch(!0){case ma&&!this.ii.Gpf():this.Jh.nqf();break;case !ma&&this.ii.Gpf():this.Jh.ohc()}}V$f(ma=!0){this.CS.d5f&&this.Jh.Qij(ma)}static WVh(ma,cb=null){const zb=new Ja.a;for(const Wb of ma)Wb.Hf||Wb.dr!==ee.a.beingCreated&&
(!cb||cb(Wb))&&$b.k$j(zb,Wb.objectId,Wb);return zb}static k$j(ma,cb,zb){let Wb;({value:Wb}=ma.Gc(cb,Wb)).returnValue||(Wb=[],ma.Z(cb,Wb));Wb.push(zb)}I_c(ma){ma&&(ma.Gka(()=>{this.updateViewportInfo()}),this.Xmd=this.AQe.scrollTop,ma.Afh(this.T7f),ma.Bfh(this.PVf))}xWf(){this.Jh.$e?this.I_c(this.Jh.$e):this.Jh.Bka?this.Jh.Bka.kZb(this.qkb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}qUe(ma){this.Vs.DE.style.top=ma-this.Xmd+"px";this.Esc=!1}H6a(ma=
!1){ma=new za.a(0,1,0,()=>{this.A9e()},129,void 0,!ma);this.Gb.Xb(ma);this.hid=!0;this.Esc=this.axb;this.zTa.SFa(10)}ylf(ma){return this.Jh.kZa({contentAnchorPositions:ma.contentAnchorPositions})}A9e(){this.hid=!1;if(this.Vs.NDa&&this.Mrb&&this.ii.t6b()){this.Jh.rFd();var ma=0;this.Lh.Sd(()=>{ma=this.Jh.CJd()},"FCM:UP:GET");var cb=null,zb=null;this.Lh.Sd(()=>{const Wb=this.CS.CUh(ma,this.Jh.$e);cb=Wb.GKk;zb=this.ylf(Wb)},"FCM:UP:GP");this.Lh.Sd(()=>{this.axb?(this.Jh.OIh(zb),this.axb=!1):this.Mrb.emitEvent(3,
zb);this.b5.$6d()},"FCM:UP:RC");this.Mrb.setFirstCommentRenderDone();"0"===this.Vs.DE.style.opacity&&0<cb.count&&!this.Fj.vn&&this.Lh.Sd(()=>{this.Jh.ohc()},"FCM:UP:SFC");this.lg.alb&&!this.HDg&&0<cb.count&&(qf.a.g2(this.Gb,this.Jh.eui,ef.a.dui),this.HDg=!0);this.xOe=G.a.Ye();this.zTa.SFa(6)}else this.xOe=G.a.Ye()}}Object(e.a)($b,"FloatingCommentManager",null,[26,205]);var Hd=c(107),$f=c(95),xi=c(1439),Qe;(function(ma){ma[ma.q_o=0]="singleHint";ma[ma.PWo=1]="multiHint";ma[ma.eZo=2]="resolvedHint";
ma[ma.QWo=3]="multiResolvedHint";ma[ma.entryPoint=4]="entryPoint";ma[ma.unknown=void 0]="unknown"})(Qe||(Qe={}));Object(e.b)("CommentIconType",Qe);var Wm=c(141),ph=c(1087);const mj={[1]:"ShowAllCommentsSelected_16x16x32",[0]:"SharedCommentBubbleSelected_16x16x32",[2]:"MarkCommentDone1Selected_16x16x32",[3]:"ShowAllCommentsResolvedSelected_16x16x32",[4]:"NewComment_16x16x32",[Qe.unknown]:""},Xn={[1]:"ShowAllCommentsHover_16x16x32",[0]:"SharedCommentBubbleHover_16x16x32",[2]:"MarkCommentDone1Hover_16x16x32",
[3]:"ShowAllCommentsResolvedHover_16x16x32",[4]:"NewComment_16x16x32",[Qe.unknown]:""},mf={[1]:"ShowAllComments_16x16x32",[0]:"SharedCommentBubble_16x16x32",[2]:"MarkCommentDone1_16x16x32",[3]:"ShowAllCommentsResolved_16x16x32",[4]:"NewComment_16x16x32",[Qe.unknown]:""},Ba=(ma,cb)=>{cb===Qe.unknown&&a.ULS.sendTraceTag(545056465,327,15,`Unknown hint IconType with state : ${ma}`);switch(ma){case 1:return mj[cb];case 2:return Xn[cb];case 3:return mf[cb];default:return""}},ub={[1]:"CommentMultiHintIcon_16",
[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Qe.unknown]:""},ic={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter",
"OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Qe.unknown]:[]},Hc=(ma,cb)=>{switch(ma){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(cb){case 3:return ph.a.Nuh;case 2:return ph.a.Ouh;case 1:return ph.a.Puh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(cb){case 3:return ph.a.Kuh;
case 2:return ph.a.Luh;case 1:return ph.a.Muh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(cb){case 3:return ph.a.Quh;case 2:return ph.a.Ruh;case 1:return ph.a.Suh}}},Vb=(ma,cb)=>{Wm.a("renderIcon")&&appChrome.api.renderIcon(ma,cb)};class Ud{}Ud.Kai=16;Ud.Q8l=1;Ud.Rrf=20;Ud.zuj=2;Object(e.a)(Ud,"CommentIconConstants",null,[]);class Cc{constructor(){this.Lzd=0;this.xBc=!1}}Object(e.a)(Cc,"CommentHintCensus",null,[]);class Te{constructor(ma,
cb,zb,Wb,nc){this.FEg=ma;this.GYb=zb;this.NJj=Wb;this.Fdb=nc;this.wLa=-1;this.ype=new Set(cb)}get y(){if(-1!==this.wLa)return this.wLa;const ma=Sys.UI.DomElement.getBounds(this.FEg),cb=this.FEg.getClientRects();return this.wLa=0<cb.length&&cb[0]?this.NJj?ma.y/this.GYb+Ud.zuj:Math.floor(cb[0].height)/(2*this.GYb)+ma.y/this.GYb-Ud.Kai/2:0}get Rzd(){return Array.from(this.ype)}jdk(ma){this.ype=new Set([...this.ype,...ma])}}Object(e.a)(Te,"HintInfo",null,[259]);class Ne extends xi.a{constructor(ma,cb,
zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg,$h){super();this.lg=ma;this.qg=cb;this.Qj=zb;this.ND=Wb;this.ga=nc;this.ii=te;this.uqa=Xe;this.zTa=Yf;this.Fj=Jg;this.sHj=$h;this.Tad=new Map;this.rsb=this.Nvb=null;this.Xic={bOb:-1,JIf:-1}}fnb(ma){let cb=!1;V.App.Ttj&&ma.Yb.mi?N.a.instance.Sd(()=>{cb=Wf.m(ma,!0)},"CHA:SCIVE"):N.a.instance.Sd(()=>{cb=Wf.l(ma.htmlElement,!0)},"CHA:SCI");return cb}jZa(ma){const cb=this.zoom,zb=ma.U3,Wb=ma.$ma;let nc=0;for(let ge=0;ge<ma.jX.length;ge++)if(0<ma.jX[ge].width){nc=ge;break}const Uc=
ma.Xcb(1,Ud.Rrf,cb,nc);this.zTa.SFa(1);let Md=[];Wb.forEach((ge,Pd)=>{const te=ma.jX[Pd].y/cb;ge=this.TTk(this.mFl(ge,Pd),Xe=>this.GTk(zb,Xe,Xe.y-te,Uc),()=>Ne.EVk(zb));Md=Md.concat(ge)});return Md}TTk(ma,cb,zb){zb=zb();const Wb=[];for(const nc of ma){ma=cb(nc);for(const Md of nc.Rzd)this.Tad.set(Md.toString(),ma);const Uc=this.u0h(nc.Rzd);this.Ioj(Uc,ma);null==zb.Fdb&&(zb.Fdb=nc.Fdb);zb.appendChild(ma);Wb.push(ma)}this.P6b(this.rsb);this.rhb(this.Nvb);return[zb]}D8k(ma,cb){ma=null===ma||void 0===
ma?void 0:ma.querySelectorAll("."+Ne.ZIi);return 0<(null===ma||void 0===ma?void 0:ma.length)&&ma[0]&&(ma=Array.from(ma[0].querySelectorAll(Ne.WJk)))?this.aRn(ma,cb):!1}aRn(ma,cb){let zb=0,Wb=ma.length-1,nc;for(;Wb>=zb;){nc=Math.floor((Wb-zb)/2+zb);const Uc=ma[nc];if(Uc.offsetTop>=cb-2&&Uc.offsetTop<=cb+2)return!0;Uc.offsetTop>cb+2?Wb=nc-1:zb=nc+1}return!1}u0h(ma){var cb,zb;let Wb=0,nc=0;for(const Uc of ma)if(this.ii.qxf(Uc)){if(this.lg.contentFilterApiEnabled&&this.Fj.vn&&(ma=this.ii.KZ(Uc.toString()),
null===(zb=(cb=this.sHj).isContentInFilteredContent)||void 0===zb||!zb.call(cb,ma.id)))continue;this.ii.phi(Uc)?nc+=1:Wb+=1}cb=new Cc;cb.Lzd=Wb+nc;cb.xBc=0===Wb;return cb}Kjc(ma){if(ma=this.Tad.get(ma.objectId)){var cb=Wf.g(ma);cb=this.u0h(cb);this.Ioj(cb,ma)}}Ioj(ma,cb){let zb,Wb;if(this.lg.contentFilterApiEnabled&&0===ma.Lzd)cb.style.display="none";else if(1===ma.Lzd?(zb=ma.xBc?2:0,Wb=ma.xBc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):
1<=ma.Lzd&&(zb=ma.xBc?3:1,Wb=ma.xBc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),cb.style.display="block",this.lg.mMa){if(ma=cb.firstElementChild)this.V5i(ma,zb),ma.title=Wb+". "+ma.title,Vb(ub[zb],ma)}else if(ma=cb.firstElementChild)this.V5i(ma,zb),ma.alt=Wb,ma.className=$f.getImageClassWithCluster(w.AFrameworkApplication.mQ,Ba(3,zb))}V5i(ma,cb){ma.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;
Hd.a.rl(ma,Ne.Tuh,cb)}mFl(ma,cb){ma=this.HTk(ma,cb);ma.sort((zb,Wb)=>zb.y-Wb.y);return this.LTm(ma)}HTk(ma,cb){const zb=[],Wb=this.lg.Hq,nc=this.zoom;ma=Wf.f(ma,!0);for(let Uc=0,Md=ma.length;Uc<Md;Uc++){const ge=ma[Uc],Pd=Wf.g(ge);Pd&&zb.push(new Te(ge,Pd,nc,Wb,cb))}return zb}LTm(ma){let cb=null;const zb=[];for(let Wb=0;Wb<ma.length;Wb++)cb&&Math.abs(ma[Wb].y-cb.y)<Ud.Kai+Ud.Q8l?cb.jdk(ma[Wb].Rzd):(cb=ma[Wb],zb.push(cb));return zb}GTk(ma,cb,zb,Wb){const nc=ma.Ug.ownerDocument,Uc=nc.createElement("div");
Uc.className=Ne.Iuh;Uc.style.top=zb+"px";Uc.style.left=Wb+"px";Uc.style.right="auto";Uc.style.zIndex="40";Hd.a.rl(Uc,Zi.a.WDc,cb.Rzd);this.lg.mMa?(cb=nc.createElement("span"),this.h7c(cb,Uc),Vb(ub[0],cb),this.fB(cb,ma)):(cb=nc.createElement("img"),this.h7c(cb,Uc),cb.src=w.AFrameworkApplication.Cr,cb.className=$f.getImageClassWithCluster(w.AFrameworkApplication.mQ,Ba(3,0)),cb.alt=CommonUIStrings.l_CommentHintTooltip+WordEditorIntl.WordEditorStrings.L_AccHelpShortcutMsgToMoveFocusCommentToDocument,
this.fB(cb,ma));return Uc}h7c(ma,cb){ma.title=CommonUIStrings.l_CommentHintTooltip;ma.setAttribute("role","button");cb.appendChild(ma)}fB(ma,cb){this.qg.xD(af.a.click,ma,this.C4m.bind(this),cb);this.qg.mb(af.a.IA,ma,this.F4m.bind(this));this.Qj.mb(af.a.MX,ma,this.H4m.bind(this));this.Qj.mb(this.lg.mMa?af.a.GK:af.a.Mga,ma,this.G4m.bind(this));this.ND.mb(ma,this.E4m.bind(this))}static EVk(ma){ma=ma.Ug.ownerDocument.createElement("div");ma.className=Ne.ZIi;return ma}E4m(){return!0}F4m(){return!0}C4m(ma){const cb=
Wf.g(ma.Pv.parentNode);ma.eventName===af.a.vJ&&(this.uqa.m0e(),this.Esh());this.ga.Ub(pf.a.Juh,2,cb);return!0}H4m(ma){this.bDa(this.rsb)!==ma.Pv&&(ma=Wf.g(ma.Pv.parentNode),this.ga.Ub(pf.a.v1e,2,ma));return!0}G4m(){this.ga.processAction(pf.a.Wzd,2);return!0}P6b(ma){this.Esh();this.rsb=ma;this.Hlk()}Hlk(){this.Ilk(this.bDa(this.rsb),this.bDa(this.Nvb))}rhb(ma){this.LFk();this.Nvb=ma;if(ma=this.bDa(this.Nvb)){const cb=this.pKd(ma);this.lg.mMa?this.nae(ma,cb,1):ma.className=$f.getImageClass(Ba(1,cb))}}bDa(ma){if(!ma)return null;
let cb=null;if(ma=this.ii.KZ(ma))if(ma=ma.Hf?this.ii.gD(ma.Hf):ma)cb=ma.objectId;return cb&&this.Tad.has(cb)?this.Tad.get(cb).firstChild:null}Esh(){this.NFk(this.bDa(this.rsb),this.bDa(this.Nvb))}NFk(ma,cb){if(ma){const zb=this.pKd(ma);cb=ma===cb?1:3;this.lg.mMa?this.nae(ma,zb,cb):ma.className=$f.getImageClass(Ba(cb,zb));this.rsb=null}}Ilk(ma,cb){ma&&(ma.title=0<this.Xic.JIf&&1<this.Xic.bOb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Xic.JIf,this.Xic.bOb):
CommonUIStrings.l_CommentHintTooltip,cb!==ma&&(cb=this.pKd(ma),this.lg.mMa?this.nae(ma,cb,2):ma.className=$f.getImageClass(Ba(2,cb))))}LFk(){var ma=this.bDa(this.rsb);const cb=this.bDa(this.Nvb);if(cb){const zb=this.pKd(cb);ma=ma===cb?2:3;this.lg.mMa?this.nae(cb,zb,ma):cb.className=$f.getImageClass(Ba(ma,zb));this.Nvb=null}}nae(ma,cb,zb){this.Ppm()?this.oYn(ma,zb):this.j_n(ma,cb,zb)}oYn(ma,cb){ma=null===ma||void 0===ma?void 0:ma.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ma||void 0===
ma?void 0:ma.length)&&(ma[0].style.fill=2===cb||1===cb?"Highlight":"ButtonText")}j_n(ma,cb,zb){cb=ic[cb];for(let nc=0;nc<cb.length;nc++){var Wb=cb[nc];const Uc=Hc(Wb,zb);if(!this.zmm(Uc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Uc}.`);break}Wb=null===ma||void 0===ma?void 0:ma.querySelectorAll("."+Wb);0<(null===Wb||void 0===Wb?void 0:Wb.length)&&(Wb[0].style.fill=`var(${Uc})`)}}Ppm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(ma){return!1}}pKd(ma){return Hd.a.Db(ma,
Ne.Tuh)}zmm(ma){var cb;const zb=document.getElementById(Jk.AppFrame.ZGc);return!(null===(cb=null===zb||void 0===zb?void 0:zb.style)||void 0===cb||!cb.getPropertyValue(ma))}}Ne.Iuh="clip16x16 HintContainer";Ne.WJk=".clip16x16.HintContainer";Ne.ZIi="OutlineElementHintMargin";Ne.Tuh="CommentIconType";Object(e.a)(Ne,"CommentHintActor",xi.a,[239]);var Sf=c(983);class Ie extends Sf.a{get d5f(){return this.SZ()}get D9e(){return this.QJo.r4h()}constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te){super();this.xi=ma;
this.Nt=cb;this.fk=zb;this.taskManager=Wb;this.Ztd=nc;this.BS=Uc;this.Jh=Md;this.getSelectedText=ge;this.QJo=Pd;this.Hh=te;this.uWc=()=>{};this.O0d=()=>{};this.aBg=!1;this.$Bk={[0]:()=>this.aEh(),[1]:()=>this.shc.xWe(),[2]:()=>this.aEh()};this.UNf=()=>{this.Ztd.SFa(11)};this.sXe=Xe=>{if(this.Nt.hyb)for(const Yf of Wf.t)Xe.bindAction(Dd.KeyInputManager.$F(Yf),lk.a.aZe)};this.V1d=()=>{this.O0d()};this.U1d=(Xe,Yf)=>{if(Xe.name!==cg.AFrame.sr&&Yf){var Jg=this.fk.Ss?this.fk.Ss.id:"";this.xi.uIb||(this.xi.uIb=
qf.a.g2(this.taskManager,()=>{this.uWc(Jg)}))}};this.iHi=()=>{};this.skb=()=>{this.Kaj()};this.OJf=(Xe,Yf)=>{0===Yf&&(this.BS.$6d(),this.Ztd.SFa(0))};this.cLf=()=>{this.Ztd.SFa(5)};this.BLc=Xe=>{let Yf=0;const Jg=this.fk.YP();for(let $h=0;$h<Jg.length;$h++){if(Jg[$h].Hf||Jg[$h].done)continue;if((Jg[$h].dr===ee.a.beingCreated?Jg[$h].Py.draftId:Jg[$h].id)===Xe.contentId)break;const ei=this.gx.getContentAnchorPosition(Jg[$h].id);!ei||4<Math.abs(Xe.anchorTop-ei.anchorTop)||Yf++}return Yf};this.vCi=()=>
{this.BS.$6d()};this.RMf=()=>{this.Ztd.SFa(2)};this.Kaj=()=>{if(!this.aBg&&this.Jh.Nca){const Xe=this.Jh.Nca.getElementsByClassName(Ne.Iuh);for(let Yf=0;Yf<Xe.length;Yf++)Xe[Yf].style.opacity="1";this.aBg=!0}}}initialize(ma,cb){this.gx=ma;this.shc=cb;this.H_c()}LXn(ma,cb){this.O0d=ma;this.uWc=cb}MUh(ma,cb){return{XXa:this.Bxl(ma,cb),containerContentByType:{}}}CUh(ma,cb){const zb=$b.WVh(this.fk.YP(),this.fk.kna),Wb=[],nc=Wf.e(!0);var Uc=this.fk.YP();cb=this.nmn(cb,Uc,zb);!cb.NRf&&cb.contentAnchorPosition&&
(Wb.push(cb.contentAnchorPosition),cb.contentAnchorPosition=null);for(Uc=0;Uc<nc.length;Uc++){const Md=nc[Uc],ge=Wf.g(Md);if(ge)for(let Pd=0;Pd<ge.length;Pd++){const te=this.getContentAnchorPosition(ma,zb,Md,ge[Pd]);te&&(Wb.push(te),cb.NRf&&cb.contentAnchorPosition&&te.contentId===cb.NRf.id&&(Wb.push(cb.contentAnchorPosition),cb.contentAnchorPosition=null))}}cb.contentAnchorPosition&&Wb.splice(0,0,cb.contentAnchorPosition);return{GKk:zb,contentAnchorPositions:Wb}}nyf(){var ma;return!(null===(ma=this.gx)||
void 0===ma||!ma.getAreContainersEnabled())}SZ(){return this.fk.t6b()}B4f(){return this.SZ()}I3c(){return this.SZ()}h5f(){return this.gx&&this.Jh.Nca&&this.SZ()}YGi(ma){0!==ma&&this.uWc(this.fk.Ss?this.fk.Ss.id:"")}getContentAnchorPosition(ma,cb,zb,Wb){let nc=null;return({value:nc}=cb.Gc(Wb.toString(),nc)).returnValue?(cb=nc[0])&&!cb.Hf?Object.assign(Object.assign({},new vf.a),{anchorTop:(eg.a.IKc(zb)-ma)/this.Jh.aaa,anchorLeft:0,containerContentType:0,contentId:cb.id}):null:null}nmn(ma,cb,zb){var Wb,
nc;const Uc={};"CREATE"===(null===(nc=null===(Wb=this.fk.Wy)||void 0===Wb?void 0:Wb.Py)||void 0===nc?void 0:nc.sessionType)&&(Wb=this.Jh.Nca.querySelectorAll(Wf.b),ma=this.Jh.lSh((0<Wb.length?Wb[0]:null)||this.getSelectedText(),this.fk.Wy.Py.draftId,0,ma),Uc.NRf=this.qOl(cb,zb),Uc.contentAnchorPosition=ma);return Uc}qOl(ma,cb){var zb=Array.indexOf(ma,this.fk.Wy);for(--zb;-1<zb;zb--)if(cb.ub(ma[zb].objectId))return ma[zb]}Bxl(ma,cb){return this.CUh(ma,cb).contentAnchorPositions}H_c(){this.BS.tha("OnAfterTrackChangeMarkupViewChange",
(ma,cb)=>{if(cb)this.$Bk[cb.rj]()})}aEh(){const ma=Wf.i();if(0!==ma.length){var cb=$b.WVh(this.fk.YP()),zb=this.fk.lK;for(let Wb=0;Wb<ma.length;Wb++){const nc=Wf.g(ma[Wb]);for(let Uc=0;Uc<nc.length;Uc++){let Md;({value:Md}=cb.Gc(nc[Uc].toString(),Md)).returnValue&&(Md.forEach(ge=>{var Pd;ge&&!ge.Hf&&(this.shc.deleteContainer(ge.id,0,!1),(null===(Pd=zb.iA)||void 0===Pd?void 0:Pd.id)===ge.id&&zb.clearSelection())}),this.Hh.Dg(cg.AFrame.So))}}}}}Object(e.a)(Ie,"CommentFloatingContainerActor",Sf.a,[247]);
var pg=c(1441),ak=c(1950),nn=c(189);class Sl extends pg.a{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd){super();this.ETj=ma;this.q8a=cb;this.zpe=zb;this.Lh=nc;this.p9=ge;this.b5=Pd;this.fj=null;this.rj=1;Wb.execute(te=>{this.fj=te});this.v1=[];this.onc=new nn.ScriptSharpLegacyMap;this.fyn(Uc,Md);this.H_c()}get Ji(){return this.ETj.value}get commentEditor(){return this.q8a}get Kaa(){return!!this.fj}get shb(){return 0}get O0a(){return this.v1}get wNg(){return this.onc.ub(this.rj)?this.onc.J(this.rj):this.onc.J(0)}sPa(ma){return this.p9.sPa(ma)}g0a(ma,
cb){if(ma=Object(pd.a)(240,ma))for(const zb of this.Dmn(ma))cb.add(zb)}nFa(ma,cb){this.Kaa&&this.Lh.Sd(()=>{this.W6m(ma,cb)},"CHA:OPHC")}W6m(ma,cb){if(this.fj.gp.t6b()){var zb=this.Uu.cCa,Wb=new Ma.a(new Ae.a),nc=cb.LFa("*"),Uc=this.dxl(zb),Md=!!zb&&!zb.action||!!Uc&&Uc===this.fj.iA,ge;this.Lh.Sd(()=>{this.zpe.rMl(ma.id,Wb,null===Uc||void 0===Uc?void 0:Uc.objectId)},"OPHC:GOI");this.Lh.Sd(()=>{ge=this.wNg.$mh(nc,Uc,Wb,Md);ge.ohi=this.mhi(zb)&&0===zb.action},"OPHC:BHI");this.Lh.Sd(()=>{this.wNg.yih(nc,
ge,Md)},"OPHC:AH")}}dxl(ma){let cb=null;!this.mhi(ma)||0!==ma.action&&2!==ma.action||(cb=this.Uu.cCa.aA);return cb||this.fj.iA}Dmn(ma){if(!ma)return[];ma=this.Ji.Db(la.a.Gf(ma.objectId));return this.commentEditor.CLd(ma,null)}lUi(){return!1}QE(ma,cb,zb){this.Kaa&&(ma=Object.assign(new ak.a,{action:ma,type:0,aA:cb,jJ:zb}),this.Uu.QE(ma))}m0e(){this.Kaa&&(this.QE(3,this.fj.V6b,this.fj.V6b),this.fj.V6b=null)}fyn(ma,cb){this.onc.add(1,ma);this.onc.add(0,cb)}H_c(){this.b5.tha("OnBeforeTrackChangeMarkupViewChange",
(ma,cb)=>{cb&&cb.tIf!==this.rj&&(this.rj=cb.tIf)})}mhi(ma){return ma&&0===ma.type}}Object(e.a)(Sl,"CommentHighlightActor",pg.a,[242,243]);var ql=c(1004),Pj=c(386),tm=c(546),mi=c(1471);class Wl{constructor(ma,cb){this.sKk=ma;this.JJf=cb}}Object(e.a)(Wl,"CommentEndParaIdBeforeChangeInfo",null,[]);var Ah=c(1563);class yd{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge){this.bBf=ma;this.xi=cb;this.fk=zb;this.BS=Wb;this.jp=nc;this.ij=Uc;this.PJk=Md;this.Nt=ge;this.oqb=null;this.omn=(Pd,te)=>{(Pd=te.commentNode)&&
!Wf.s(Pd)&&(te=this.fk.Zgf(Pd),la.a.Qp(te.H4c,te.FHc)||this.ioj(te,Pd)||this.vrh(te.HBa,te.kMa,Pd)||this.Tcg(Pd))};this.U0m=(Pd,te)=>{te.property===na.a.gua&&(Pd=Wf.h(te.node,la.a.nil),this.oqb=new Wl(te.node.id,Pd))};this.c2m=(Pd,te)=>{Pd=te.node;if(te.property===na.a.gua&&Pd){var Xe=Wf.k(Pd,la.a.nil);te=Wf.h(Pd,la.a.nil);var Yf=this.oqb?this.Bd.Db(this.oqb.JJf):null;!Wf.s(Pd)&&Xe&&!Xe.equals(te)&&this.oqb&&Pd.id.equals(this.oqb.sKk)&&!Xe.equals(this.oqb.JJf)&&Yf&&Yf.isConnected&&this.LSe(this.oqb.JJf,
Pd.id);te&&this.xi.ux.ub(te)&&(Xe=this.xi.ux.J(te),Xe.H0a&&(a.ULS.shipAssertTag(572835481,327,!!Xe.iM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),Xe.iM&&Xe.iM.contains(Pd.id)&&(Xe.iM.remove(Pd.id),Xe.iM.count||(Xe.H0a=!1),this.xi.jU.ub(Pd.id)?this.xi.jU.J(Pd.id).remove(te):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.TWc=(Pd,te)=>{Pd=te.node.id;this.xi.ux.ub(Pd)&&this.hEn(Pd)};this.E0m=(Pd,te)=>{te&&
te.node&&this.QTa.ub(te.node)&&(Pd=this.QTa.J(te.node).W2d,this.QTa.ub(Pd)||(Pd=this.QTa.J(te.node),this.vrh(Pd.d6e?Pd.currentNode:Pd.W2d,Pd.d6e?Pd.W2d:Pd.currentNode,Pd.commentNode)||this.Tcg(Pd.commentNode)),this.QTa.remove(te.node))};this.f2m=(Pd,te)=>{const Xe=Pd.Wj;if(!te&&this.Hab.ub(Xe)){var Yf;(Yf=this.Hab).Z(Xe,Yf.J(Xe)&(Pd.Oc?-2:-3));this.Hab.J(Xe)||(this.Tcg(this.Bd.Db(Xe)),this.Hab.remove(Xe))}};this.QTa=new tm.a(new ql.a);this.Hab=new Rf.a(Wf.c);this.BS.tha("OnCommentNodeAdded",this.omn);
this.Nt.contentFilterApiEnabled?(this.BS.tha("OnCommentPaneOpen",this.rim.bind(this)),this.BS.tha("OnCommentPaneClose",this.qim.bind(this)),this.BS.tha("OnContentFilterUpdate",this.IWc.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Pd=>{this.BS.tha(Pd,this.pim.bind(this))});ma=this.jp.Xe(12);ma.Mv(this.TWc);ma.mu(this.E0m);this.jp.Xe(40).Ixb(this.U0m);this.jp.Xe(40).Ap(this.c2m);Pj.a.hRa(this.f2m)}get fy(){return this.bBf.value}get Bd(){return this.fy.Bd}rMl(ma,cb,zb){if(this.Tdn(ma))for(const Wb of this.xi.ux.J(ma).iM)!this.N9i(Wb,
zb===Wb.toString())||cb.add(Wb)}N9i(ma,cb){const zb=this.Bd.Db(ma),Wb=Wf.s(zb);if(!zb||Wb)return!1;ma=this.fk.KZ(ma.toString());return!ma||this.Nt.contentFilterApiEnabled&&this.xi.vn&&!this.PJk.isContentInFilteredContent(ma.id)||!this.xi.vn&&!this.fk.kna(ma)&&!cb?!1:!0}Tdn(ma){return this.Adn(ma)}Tcg(ma){if(ma){var cb=mi.a.CLd(ma,null),zb=new Xa.a;for(let Wb=1;Wb<cb.length-1;Wb++)this.LSe(cb[Wb].id,ma.id),zb.add(cb[Wb]);si.b(zb)}}Adn(ma){if(!this.xi.xX)return!1;let cb=null;if(({value:cb}=this.xi.ux.Gc(ma,
cb)).returnValue)return cb.H0a;let zb=!1;this.ij.Sd(()=>{const Wb=Wf.e();for(let nc=0;nc<Wb.length;nc++)zb=this.tzo(Wb[nc],ma,zb);zb||(this.xi.ux.add(ma,new Ah.a),this.xi.ux.J(ma).H0a=!1)},"CHORA:PHOC");return zb}tzo(ma,cb,zb){ma=Wf.g(ma);if(!ma)return zb;for(let Wb=0;Wb<ma.length;Wb++){const nc=this.Bd.Db(ma[Wb]);nc&&!Wf.s(nc)&&(zb=zb||this.yCk(nc,cb))}return zb}yCk(ma,cb){var zb=this.fk.Zgf(ma);if(this.ioj(zb,ma))return!1;var Wb=zb.H4c;const nc=zb.FHc;zb=zb.HBa;if(Wb!==la.a.nil&&(Wb.equals(nc)||
Wb.equals(cb)))return!1;for(Wb=fc.ParagraphReader.Tg(zb,!1);Wb&&!Wb.id.equals(nc);){if(Wb.id.equals(cb))return this.LSe(cb,ma.id),!0;Wb=fc.ParagraphReader.Tg(Wb,!1)}return!1}LSe(ma,cb){this.xi.jU.ub(cb)||this.xi.jU.add(cb,new Ma.a(new Ae.a));this.xi.jU.J(cb).add(ma);this.xi.ux.ub(ma)?this.xi.ux.J(ma).iM||(this.xi.ux.J(ma).iM=new Ma.a(new Ae.a)):this.xi.ux.add(ma,new Ah.a(!0));this.xi.ux.J(ma).H0a=!0;this.xi.ux.J(ma).iM.add(cb)}hEn(ma){if(this.xi.ux.J(ma).iM)for(const cb of this.xi.ux.J(ma).iM)this.xi.jU.ub(cb)?
this.xi.jU.J(cb).remove(ma):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.xi.ux.remove(ma)}pim(){const ma=new Xa.a;for(const cb of this.fk.YP())cb.Hf||cb.dr===ee.a.beingCreated||this.fk.kna(cb)||this.fk.Vcg(cb,ma);si.b(ma)}rim(){this.ytf("OnCommentPaneOpen")}IWc(){this.ytf("OnContentFilterUpdate")}qim(){this.ytf("OnCommentPaneClose")}ytf(ma){const cb=new Xa.a;for(const zb of this.fk.YP())zb.Hf||zb.dr===ee.a.beingCreated||this.fk.lK.qph(ma,zb)||
this.fk.Vcg(zb,cb);si.b(cb)}ioj(ma,cb){let zb=!1;if(!ma.Ade||!ma.TEd){zb=!0;if(!ma.HBa||!ma.kMa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ma.HBa,!ma.kMa),!0;ma.Ade||this.QTa.ub(ma.HBa)||this.QTa.add(ma.HBa,{commentNode:cb,currentNode:ma.HBa,W2d:ma.kMa,d6e:!0});ma.TEd||this.QTa.ub(ma.kMa)||this.QTa.add(ma.kMa,{commentNode:cb,currentNode:ma.kMa,W2d:ma.HBa,d6e:!1})}return zb}vrh(ma,cb,zb){ma=mi.a.Bua(ma,zb.id,!0);cb=mi.a.Bua(cb,zb.id,!1);let Wb;ma||({value:Wb}=
this.Hab.Gc(zb.id,Wb),this.Hab.Z(zb.id,Wb&1));cb||({value:Wb}=this.Hab.Gc(zb.id,Wb),this.Hab.Z(zb.id,Wb&2));return!ma||!cb}}Object(e.a)(yd,"CommentHighlightOnRestActor",null,[241]);var Jd=c(344),Se=c(345),be=c(642);class el{constructor(ma,cb){this.$wb=ma;this.qja=cb}getViewContainer(){return this.$wb}registerForViewContainerEvents(ma){this.qja.JBn(ma)}unregisterForViewContainerEvents(ma){this.qja.ruo(ma)}}Object(e.a)(el,"ViewContainerProvider",null,[837]);class fj{constructor(ma,cb,zb,Wb){this.isRightToLeft=
!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ma;this.appLocale=cb;this.uiCulture=zb;this.dataCulture=Wb}}Object(e.a)(fj,"LocalizationDetails",null,[]);var Hh=c(1121),Fm=c(1483);class ri{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg,$h,ei,rl,Bi,en,Jm,fn,Rm,Km,Bm,sk,Jn,yg,Cm,Ni,Ci,gg,oo){this.Fq=ma;this.fk=cb;this.I0b=zb;this.wZ=Wb;this.Nt=nc;this.xi=Uc;this.uHd=Md;this.Q6b=ge;this.rq=Pd;this.Bc=te;this.dynamicScriptLoader=Xe;this.nNn=Yf;this.Hh=Jg;this.D1e=$h;this.z1e=
ei;this.zbh=rl;this.iFo=Bi;this.X_=en;this.BS=Jm;this.TOn=fn;this.ffl=Rm;this.VBi=Km;this.jFo=Bm;this.czb=sk;this.CS=Jn;this.Jh=yg;this.yO=Cm;this.P2e=Ni;this.J3a=Ci;this.Xzd=gg;this.SNk=oo;this.Egd=this.bWa=null;this.IOg=!1;this.qFe=[];this.q3g=this.JOg=!1;this.initialize=(Df,$l)=>{this.Ncm($l)};this.b_k=Df=>dl.a.o3e(Df);this.g2m=()=>{this.udi()};this.mDl=(Df,$l,sl)=>{Df=Object.assign(Object.assign({},new Hh.a),{containerPanel:Df,paneOpenedCallback:$l,paneClosedCallback:sl,ulsLogger:new Jd.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,
isRtl:w.AFrameworkApplication.isRtl&&this.Nt.alb,viewportInfo:this.Jh.Rhf(),destroyAllContainersCallback:()=>{this.xi.vn||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Nt.vHd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.Nt.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Nt.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,
contentNavigationApiEnabled:this.Nt.contentNavigationApiEnabled,contentFilterApiEnabled:this.Nt.contentFilterApiEnabled,returnToDraftFixEnabled:this.Nt.returnToDraftFixEnabled,duplicateUndoResolvedCommentsFixEnabled:this.Nt.duplicateUndoResolvedCommentsFixEnabled}});this.Nt.contentNavigationApiEnabled&&(Df.sidetrackContentNavigationApi=this.P2e,Df.featureGateApiSettings=this.CS.D9e,Df.telemetryDetails=this.VBi,this.Nt.contentFilterApiEnabled&&(Df.contentFilterAPI=this.SNk));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Df)};
this.W3m=Df=>{2!==this.Fq.mode&&3!==this.Fq.mode&&this.fk.Ss&&Df===this.fk.Ss.id&&this.Fq.clearSelection();V.App.xa.updateCommandUI(!0)};this.kDi=(Df,$l)=>{this.Kv("onCSCStart",window.performance.now());this.Zbb&&!Df&&(this.Ban(),this.Kv("openInFishbowl",!0));this.I0b.ccb&&this.Nt.oAb&&this.Bc.processAction(pf.a.newComment,2);$l&&$l();this.Kv("onCSCEnd",window.performance.now())};this.BS.tha("OnCommentInit",this.initialize);this.BS.tha("OnCommentRenderedOnce",this.g2m);this.CS.LXn(()=>{},this.W3m)}get PIa(){return this.Fq}get Zbb(){return this.xi.Zbb}Kv(ma,
cb){this.J3a.Kv(Yh.a.comments,ma,cb,!0)}Ncm(ma){if(this.xi.xX)ma&&ma.YEa&&ma.YEa();else if(this.IOg)(null===ma||void 0===ma?0:ma.YEa)&&this.qFe.push(ma.YEa);else{var cb=this.Nt.uNc;this.Kv("hasCommentOnBoot",cb);cb?this.czb.logKpiUsage(Fm.a.H0b,0):Se.a.obc("canvas","floatingComments");this.IOg=!0;this.Kv("initInProgress",!0);this.fk.initialize(this.Fq);this.I0b.initialize(this.Fq,null);this.I0b.Y8i(this.Fq);this.Q6b.Fdm(this.wZ.u1n);this.Kv("InitAMSetup",window.performance.now());be.a.sq(this.ffl).continueWith(zb=>
{(this.bWa=zb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.D1e.initialize(this.bWa);this.PIa.r1e.initialize(this.PIa,this.fk,this.bWa,this.D1e);this.zbh.initialize(this.dynamicScriptLoader,this.PIa.r1e,this.VBi,this.bWa,new el(this.iFo,this.jFo),this.k_h(),"",this.D1e.r4h(),this.X_,V.App.tbe);this.Kv("AMInitialized",window.performance.now());this.Nt.contentNavigationApiEnabled?(V.App.BBb?V.App.BBb:this.Jh.usi()).then(()=>{this.Kv("FCMLoaded",
window.performance.now());this.k3c();this.cRd(ma)}):this.cRd(ma)})}}ojn(){var ma;null===(ma=sharedComments.setDarkModeColorHandler)||void 0===ma?void 0:ma.call(sharedComments,this.b_k)}cRd(ma){this.Egd=this.zbh.cRd(void 0,this.ojn.bind(this));this.bPc(ma);this.xi.xX=!0;this.Nt.C6f&&this.z1e.initialize()}bPc(ma){if(!this.xi.sEb){this.Kv("InitCSStart",window.performance.now());var cb=this.rq.jg("Task","InitiateCommentingSession");this.czb.logKpiUsage(Fm.a.Uuh,0);try{const zb=this.rq.jg("Task","InitiateCommentingSession-UpdateModel");
this.Xzd.ddm();zb.stop();this.Kv("initAtBoot",window.performance.now());this.Nt.Hq&&this.fk.t6b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",G.a.Ye()));gk.a.get_instance().PK(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.xi.sEb=!0;this.Egd.then(()=>{this.Kv("SCLoaded",window.performance.now());this.Jh.wdm();this.Kv("FCMInitiated",window.performance.now());if(this.Nt.Hq){let nc=!1;if(this.Zbb){var Wb=
this.wZ.eJd(this.Zbb);Wb?(w.AFrameworkApplication.Ce("3ge3g205;cha3g788"),Wb=this.wZ.fJd(Wb,0),Wb)?this.fk.kna(Wb)||(nc=!0,this.Can(Wb)):(nc=!0,this.m3a()):nc=!0}Wb=ma?ma.bEi:null;this.Nt.contentNavigationApiEnabled?this.kDi(nc,Wb):this.OEm(nc,Wb)}ma&&ma.YEa&&ma.YEa();for(const nc of this.qFe)nc();this.JOg&&this.udi();this.qFe=[]})}catch(zb){a.ULS.oJ(539567713,327,10,zb,`Comments Initialization Failed: ${zb}`),this.czb.logKpiFailure(Fm.a.Uuh,"CommentsInitializationFailed",{isInternal:!0},{name:Fm.a.G0b,
isInternal:!0})}finally{cb.stop(),this.Kv("InitCSEnd",window.performance.now())}this.Bc.processAction(pf.a.wuh,2)}}Can(ma){this.Bc.processAction(pf.a.iY,2);this.CS.Kaj();qf.a.g2(w.AFrameworkApplication.uc,()=>{this.wZ.selectComment(ma,Object.assign(Object.assign({},new wi.a),{ZQ:!0,B8:1}));this.Hh.Dg(cg.AFrame.sr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-w.AFrameworkApplication.tW)},ef.a.HRn);this.czb.logUserAction(pf.a.u1e);
w.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}m3a(){this.Bc.processAction(pf.a.m3a,2)}OEm(ma,cb){(V.App.BBb?V.App.BBb:this.Jh.usi()).then(()=>{this.Kv("FCMLoaded",window.performance.now());this.k3c();this.kDi(ma,cb)}).catch(zb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+zb.toString())})}k3c(){this.yO.trackChangeInSidetrackEnabled?(this.uHd.k3c(),this.Kv("STSet",window.performance.now())):this.uHd.b9i(this.mDl)}udi(){this.q3g||
(this.xi.xX&&this.Egd?(this.Egd.then(()=>{const ma=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.TOn.execute(cb=>{ma.registerSafelinksNavigator(cb.vjc.bind(cb))});this.nNn.execute(cb=>{cb.iyn(ma)})}),this.q3g=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.JOg=!0))}k_h(){return new fj(w.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,w.AFrameworkApplication.uiCulture,w.AFrameworkApplication.dataCulture)}Ban(){this.wZ.m2i(this.Zbb,
Object.assign(Object.assign({},new wi.a),{Z4f:!1,oQc:!0}));this.czb.logUserAction(pf.a.u1e)}}Object(e.a)(ri,"CommentInitActor",null,[]);class Mh{constructor(ma,cb,zb,Wb,nc,Uc,Md){this.qg=ma;this.Qj=cb;this.ND=zb;this.ga=Wb;this.tHj=nc;this.Oi=Uc;this.lg=Md;this.bkc=this.HUa=null}get zoom(){let ma=1;this.Oi&&this.Oi.instance&&(ma=this.Oi.instance.jj);return 0<ma?ma:1}DMh(ma,cb){if(!this.bkc||!ma.$ma||cb>=ma.$ma.length)return null;const zb=this.zoom,Wb=ma.U3,nc=ma.Xcb(1,Ud.Rrf,zb,cb);return this.OSk(ma.$ma[cb],
Wb,(this.bkc.y-ma.jX[cb].y)/zb+Ud.zuj,nc)}OSk(ma,cb,zb,Wb){if(this.HUa)return(cb=this.HUa.parentElement)&&cb.removeChild(this.HUa),this.P4i(ma,this.HUa,zb,Wb),this.HUa;const nc=cb.Ug.ownerDocument,Uc=nc.createElement("div");Uc.className=Mh.NJk;this.P4i(ma,Uc,zb,Wb);this.lg.mMa?(ma=nc.createElement("span"),this.h7c(ma,Uc),Vb(ub[4],ma),this.tTi(ma,cb)):(ma=nc.createElement("img"),this.h7c(ma,Uc),ma.className=$f.getImageClassWithCluster(w.AFrameworkApplication.mQ,Ba(3,4)),ma.src=w.AFrameworkApplication.Cr,
ma.alt=CommonUIStrings.l_CommentNewCommentButton,this.tTi(ma,cb));return this.HUa=Uc}h7c(ma,cb){ma.title=CommonUIStrings.l_CommentNewCommentButton;ma.setAttribute("role","button");cb.appendChild(ma)}tTi(ma,cb){this.qg.xD(af.a.click,ma,this.A3m.bind(this),cb);this.qg.mb(af.a.IA,ma,this.C3m.bind(this));this.lg.mMa||(this.Qj.mb(af.a.MX,ma,this.E3m.bind(this)),this.Qj.mb(af.a.Mga,ma,this.D3m.bind(this)));this.ND.mb(ma,this.B3m.bind(this))}uPd(){if(this.HUa){const ma=this.HUa.parentElement;ma&&ma.removeChild(this.HUa)}}P4i(ma,
cb,zb,Wb){this.tHj.D8k(ma,zb)?cb.style.left=Wb+Ud.Rrf+"px":cb.style.left=Wb+"px";cb.style.top=zb+"px";cb.style.right="auto";cb.style.display="block";cb.style.position="absolute";cb.style.overflow="hidden";cb.style.cursor="default";cb.style.zIndex="40"}C3m(){return!0}A3m(ma){this.ga.bH=30;this.ga.processAction(pf.a.newComment,2);ma=ma.Pv;this.lg.mMa?Vb(ub[4],ma):ma.className=$f.getImageClassWithCluster(w.AFrameworkApplication.mQ,Ba(3,4));ma=ma.parentElement;(null===ma||void 0===ma?0:ma.parentElement)&&
ma.parentElement.removeChild(ma);return!0}E3m(ma){ma.Pv.className=$f.getImageClassWithCluster(w.AFrameworkApplication.mQ,Ba(2,4));return!0}D3m(ma){ma.Pv.className=$f.getImageClassWithCluster(w.AFrameworkApplication.mQ,Ba(3,4));return!0}B3m(){return!0}}Mh.NJk="clip16x16 EntryPointContainer";Object(e.a)(Mh,"CommentMarginEntryPointActor",null,[]);var Fi=c(455),rp=c(92),kh=c(228),cr=c(26),dg=c(124);class Kf{constructor(ma,cb,zb,Wb,nc,Uc,Md){this.bBf=ma;this.BCm=cb;this.gp=zb;this.xi=Wb;this.Nt=nc;this.x1e=
Uc;this.czb=Md;this.SOi=new Set;this.dHb=new Set;this.wXc=new kh.a;this.J0b=new Map;this.Zuh=K.a.instance.af("Box4.CommentParagraphMapping");this.dzb=new Set;this.Dea=this.dJd()}get fy(){return this.bBf.value}get Bd(){return this.fy.Bd}get KBa(){return this.BCm.value}dJd(){const ma=new Wc.GraphIterator;ma.set(this.fy);this.KBa.h3a(ma);return ma}ddm(){this.xi.sEb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
cr.Debug.x_a());this.Nt.contentNavigationApiEnabled||(this.Nt.uNc&&this.bdm(),this.gp.iFi())}j1m(){this.dzb.forEach(ma=>{this.Xkg(ma)});this.dzb.clear();this.gp.iFi()}Xkg(ma){if(Fi.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ma}`);var cb=this.J0b.get(ma).Lhc,zb=this.J0b.get(ma).b3b;cb===la.a.nil||zb===la.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${cb} or end ${zb} has invalid value`):(this.Zuh.value.PYa.set(ma,cb),this.Zuh.value.OYa.set(ma,
zb),a.ULS.sendTraceTag(512235651,327,50,`Start ${cb} and End ${zb} mapping info for Comment ${ma} added on Comment Model load`))}}Cfm(ma){const cb=[];for(const zb of ma)ma=zb.Wj.toString(),this.Onj(ma,zb.paragraph.id,zb.Oc),zb.Oc&&(this.SOi.has(ma)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",zb.Wj):(this.SOi.add(ma),(ma=this.m$j(zb))&&cb.push(ma)));this.XZi();return cb}Onj(ma,cb,zb){Fi.a.isEnabled&&(this.J0b.has(ma)||this.J0b.set(ma,{Lhc:la.a.nil,
b3b:la.a.nil}),zb?this.J0b.get(ma).Lhc=cb:this.J0b.get(ma).b3b=cb)}m$j(ma){var cb=this.Bd.Db(ma.Wj);this.Dea.Ii(cb);if(40!==this.Dea.ef||!cb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!cb,!ma.Wj),this.Dea=39===this.Dea.ef?this.Dea:this.dJd(),null;cb=this.gp.zBd(this.Dea);let zb;if(({index:zb}=this.gp.zge(cb)).returnValue)if(this.gp.gSe(cb,zb),this.dHb.add(cb.objectId),Wf.p(cb)||this.dzb.add(cb.objectId),
cb.Hf)this.vdf(cb);else return{contentId:cb.id,containerContentType:0,p8:{xd:ma.Nb.cp,hM:ma.paragraph.Bn}};else this.wXc.add(cb);return null}vdf(ma){if(ma.Hf){var cb=this.gp.gD(ma.Hf);if(cb&&cb.Hf){const zb=this.gp.gD(cb.Hf);zb&&(zb.Hf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ma.Hf=cb.Hf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ma.objectId} parentObjectId: ${cb.objectId}`)))}}}bdm(){const ma=new O.a(0),
cb=rp.a.Dp(this.gp.KHa),zb=new Set;this.Nt.Tbn&&!Fi.a.isEnabled&&this.qbk(cb,ma);const Wb=this.dJd(),nc=new Set,Uc=new Set,Md=new bl.GraphTransaction(2);try{if(Md.ev(Wb),Wb.Lq(1)){for(;cb.moveNext();){if(!fc.ParagraphReader.rh(cb.iterator))continue;const Pd=cb.iterator.currentNode,te=fc.ParagraphReader.bCb(Pd);Fi.a.isEnabled&&this.jRm(Pd,te,ma);zb.add(Pd.id.toString());this.jOi(te,Uc,Wb,nc)}this.XZi();const ge=this.exl(zb);0<ge.length&&this.FMn(ge,zb,Wb,Uc);this.dzb.forEach(Pd=>{this.Xkg(Pd)});this.dzb.clear()}}finally{Md&&
Md.dispose()}0==this.dHb.size&&this.Nt.uNc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");xd.a.gLm(nc,Uc,this.Bd)}jOi(ma,cb,zb,Wb){for(const nc of ma){ma=this.Nt.Hq?!nc.Oc:nc.Oc;const Uc=nc.Wj.toString();this.Onj(Uc,nc.paragraph.id,nc.Oc);ma?cb.has(Uc)||Wb.add(Uc):cb.has(Uc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",nc.Wj):(cb.add(Uc),this.n$j(nc,zb))}}FMn(ma,cb,zb,Wb){const nc=this.BNl(ma);xd.a.yDk(nc);
const Uc=new Set,Md=new Set;nc.forEach(Pd=>{cb.has(Pd.id.toString())||Md.has(Pd.id.toString())||(Md.add(Pd.id.toString()),Pd=fc.ParagraphReader.bCb(Pd),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Pd.length} CommentRangeObjects`),this.jOi(Pd,Wb,zb,Uc))});const ge=[];ma.forEach(Pd=>{this.dHb.has(Pd)||ge.push(Pd)});0<ge.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${ge.length} Failed To Load on Retry: ${ge.join(",")}`),this.czb.logKpiFailure(Fm.a.H0b,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:Fm.a.G0b,isInternal:!0}))}BNl(ma){const cb=[];ma.forEach(zb=>{if(zb=this.x1e.AUh(zb))zb=Wf.k(zb),(zb=this.Bd.Db(zb))&&zb.Wi&&cb.push(zb)});return cb}n$j(ma,cb){const zb=this.Bd.Db(ma.Wj);cb.Ii(zb);40===cb.ef&&zb?(ma=this.gp.zBd(cb),({index:cb}=this.gp.zge(ma)).returnValue?(this.gp.gSe(ma,cb),this.dHb.add(ma.objectId),Wf.p(ma)||this.dzb.add(ma.objectId),ma.Hf&&this.vdf(ma)):this.wXc.add(ma)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!zb,!ma.Wj),39===cb.ef||this.dJd())}exl(ma){const cb=[],zb=this.x1e.Zwl();if(this.dHb.size===zb.length)return cb;zb.forEach(Wb=>{!this.dHb.has(Wb)&&xd.a.Kym(Wb,ma,this.x1e,this.Bd)&&cb.push(Wb)});return cb}XZi(){for(let ma=0;ma<this.wXc.length;ma++){const cb=this.wXc.J(ma);let zb;({index:zb}=this.gp.zge(cb)).returnValue?(this.gp.gSe(cb,zb),Wf.p(cb)||this.dzb.add(cb.objectId),this.dHb.add(cb.objectId),cb.Hf&&this.vdf(cb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
cb.hOa,cb.RZa,cb.objectId,cb.Hf))}this.wXc.clear()}qbk(ma,cb){ma.ho(zb=>{if(11===zb.ef){var Wb=zb.currentNode;const nc=Wb.ia(dg.a.G1e,null),Uc=Wb.ia(dg.a.E1e,null);zb=!!nc&&0<nc.length;const Md=!!Uc&&0<Uc.length;zb&&nc.forEach(Pd=>{const te=this.Bd.Db(Pd);te&&!Wf.s(te)&&cb.add(Pd,0)});Md&&Uc.forEach(Pd=>{cb.ub(Pd)&&cb.remove(Pd)});(Wb=Wb.ia(ud.a.FL,null))&&Wb.forEach(Pd=>{const te=this.Bd.Db(Pd);fc.ParagraphReader.ic(te)&&!this.xi.ux.ub(Pd)&&this.xi.ux.add(Pd,new Ah.a)});const ge=cb.keys;for(let Pd=
0;Pd<ge.length;Pd++){Wb&&0<cb.J(ge.J(Pd))&&(this.xi.jU.ub(ge.J(Pd))||this.xi.jU.add(ge.J(Pd),new Ma.a(new Ae.a)),Wb.forEach(Xe=>{const Yf=this.Bd.Db(Xe);fc.ParagraphReader.ic(Yf)&&(this.xi.ux.J(Xe).iM||(this.xi.ux.J(Xe).iM=new Ma.a(new Ae.a)),this.xi.jU.J(ge.J(Pd)).add(Xe),this.xi.ux.J(Xe).H0a=!0,this.xi.ux.J(Xe).iM.add(ge.J(Pd)))}));let te;cb.Z(te=cb.keys.J(Pd),cb.J(te)+1)}return zb||Md}return!0},null)}jRm(ma,cb,zb){ma&&(this.aBj(cb,zb),this.xi.ux.ub(ma.id)||this.xi.ux.add(ma.id,new Ah.a),zb.forEach((Wb,
nc)=>{0<nc&&(this.xi.jU.ub(Wb)||this.xi.jU.add(Wb,new Ma.a(new Ae.a)),this.xi.ux.J(ma.id).iM||(this.xi.ux.J(ma.id).iM=new Ma.a(new Ae.a)),this.xi.jU.J(Wb).add(ma.id),this.xi.ux.J(ma.id).H0a=!0,this.xi.ux.J(ma.id).iM.add(Wb));zb.Z(Wb,nc+1);return!0}))}aBj(ma,cb){ma.forEach(zb=>{if(zb.Oc){const Wb=this.Bd.Db(zb.Wj);Wb&&!Wf.s(Wb)&&cb.Z(zb.Wj,0)}else cb.ub(zb.Wj)&&cb.remove(zb.Wj)})}}Object(e.a)(Kf,"CommentModelBootLoader",null,[238]);var yi=c(1013);class nf{constructor(ma){this.Wuh=ma;this.aqc=null;
this.FWg=void 0;this.GWg=null;this.Ouc=new Map;this.Kse=new Map}ABn(){yi.a.hRa(this.iwo.bind(this))}iwo(ma,cb){const zb=ma.id.toString();var Wb=ma.getValue(na.a.nE).toString();cb?(this.Ouc.delete(zb),this.Kse.delete(Wb)):(this.Ouc.set(zb,ma),this.Kse.set(Wb,ma));0===this.Ouc.size&&this.aqc&&(ma=+new Date-+this.aqc,this.aqc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ma}`));cb||this.FWg!==Wb||(cb=+new Date-
+this.GWg,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${cb}`),Wb=new F.a,Wb.durationMs=cb,this.Wuh.logKpiFailure(Fm.a.Nzd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:Wb},{name:Fm.a.Cuh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Wb}));this.aqc||(this.aqc=new Date)}set dVm(ma){this.FWg=ma;this.GWg=new Date;if(ma=this.Xwl(ma))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ma.id} present but failed to load`),
ma=new F.a,this.Wuh.logKpiFailure(Fm.a.Nzd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Fm.a.Cuh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ma})}Zwl(){return[...this.Ouc.keys()]}Xwl(ma){return this.Kse.get(ma)}AUh(ma){return this.Ouc.get(ma)}}Object(e.a)(nf,"CommentNodeTracker",null,[]);class Bb{get contentType(){return 0}constructor(ma,cb,zb,Wb,nc){this.b_f=ma;this.gp=cb;this.wZ=zb;this.lK=Wb;this.xi=nc;this.b_f.LTi(this)}q2i(ma,cb,zb){0===cb?(cb=this.gp.tQc(ma),
this.wZ.selectComment(cb?this.gp.Wy:this.gp.gD(ma),Object.assign(new wi.a,{ZQ:zb||cb,B8:1}))):this.lK.clearSelection()}s$i(ma){return this.xi.vn||this.gp.tQc(ma.contentId)?!0:this.gp.kna(this.gp.gD(ma.contentId))}}Object(e.a)(Bb,"CommentReviewSuggestionContentActor",null,[223]);class Ec{get Qfj(){return this.w8f}constructor(ma){this.Xzd=ma;this.w8f=new Set([12])}initialize(){}Asi(ma){if(!fc.ParagraphReader.ic(ma.node))return[];ma=fc.ParagraphReader.bCb(ma.node);return this.Xzd.Cfm(ma)}SCi(){this.Xzd.j1m()}}
Object(e.a)(Ec,"CommentReviewSuggestionContentProvider",null,[221]);var sd=c(63),Ce=c(106),Ue=c(261),Mf=c(1530);class Tg{constructor(){this.commentId=null;this.ZRc=!1}}Object(e.a)(Tg,"CommentToSelectOnPaneLoadData",null,[]);class Nh{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg,$h,ei){this.Fq=ma;this.gp=cb;this.JBa=zb;this.wZ=Wb;this.BS=nc;this.xi=Uc;this.uHd=Md;this.Nt=ge;this.I0b=Pd;this.y2a=te;this.Bc=Xe;this.cBf=Yf;this.Hh=Jg;this.ij=$h;this.pKk=ei;this.Bc.pa(pf.a.SMb,sd.a.frame,this.Fq.SMb.bind(this.Fq));
this.Bc.pa(pf.a.lEd,sd.a.frame,this.lEd.bind(this));this.Bc.pa(pf.a.s1e,sd.a.frame,this.Z1m.bind(this));this.Bc.pa(pf.a.BJk,sd.a.frame,this.Y1m.bind(this));this.Bc.pa(pf.a.$zi,sd.a.frame,this.q6m.bind(this));this.Bc.pa(pf.a.dGh,sd.a.frame,this.i3m.bind(this));this.Bc.pa(pf.a.Juh,sd.a.frame,this.D4m.bind(this));this.Bc.gb(pf.a.v1e,sd.a.frame,this.tlk.bind(this),64);this.Bc.gb(pf.a.Wzd,sd.a.frame,this.SCn.bind(this),64);this.Bc.pa(lk.a.selectComment,sd.a.frame,this.wZ.ERn.bind(this.wZ));this.Nt.gDm&&
this.Bc.pa(lk.a.pWd,sd.a.frame,this.pWd.bind(this));this.wch(lk.a.dGc,!1);this.wch(lk.a.s7e,!0);this.Bc.gb(lk.a.Yzd,sd.a.frame,this.Yzd.bind(this),64);this.Bc.pa(lk.a.qti,sd.a.frame,Ce.ActionManager.Mf);this.Nt.hyb&&this.Bc.pa(lk.a.aZe,sd.a.frame,this.oxk.bind(this));this.Bc.pa(lk.a.$Dh,sd.a.frame,(rl,Bi)=>Ue.a.dga(Bi.Yj)&&Ue.a.B8b()?8:32)}get fk(){return this.gp}get mode(){return this.Fq.mode}get iA(){return this.Fq.iA}get Tz(){return this.Nt.Hq}get Ji(){return this.y2a.value}get Bb(){return this.cBf.value}get lK(){return this.Fq}lEd(ma,
cb,zb,Wb,nc){return nc?nc?(ma=this.wZ.eJd(nc.NavigationId))&&this.wZ.fJd(ma,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}Z1m(ma,cb,zb,Wb,nc){nc&&this.BS.Moa("OnCommentInit",Object.assign(Object.assign({},new Mf.a),{YEa:()=>{var Uc=this.wZ.eJd(nc.NavigationId);if(Uc){var Md=this.wZ.fJd(Uc,1);Md?this.I0b.isVisible?(this.P1c(Md,1),this.Hh.qC(cg.AFrame.sr)):this.fk.kna(Md)?
(Uc=Wf.r(Md),this.wZ.selectComment(Md,Object.assign(Object.assign({},new wi.a),{ZQ:!Uc,B8:1})),this.Hh.qC(cg.AFrame.QL)):(this.xi.vn||this.Bc.processAction(pf.a.iY,2),qf.a.g2(w.AFrameworkApplication.uc,()=>{this.P1c(Md,1)},ef.a.P1c)):this.Bc.processAction(pf.a.m3a,2)}}}));return 32}Y1m(ma,cb,zb,Wb,nc){nc?(ma=this.fk.oKc(nc))?this.lK.Ebc(ma.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.lK.Ebc(null);return 32}q6m(ma,cb,zb,Wb,nc){if(nc){if(this.xi.sEb){for(ma=
0;ma<nc.length;ma++)this.fk.J4i(nc[ma]);this.Fq.IKb()}else this.fk.odk(nc);this.tLm(nc)}return 32}i3m(ma,cb,zb,Wb,nc){if(nc)if(this.xi.sEb){for(ma=0;ma<nc.length;ma++)this.fk.J4i(nc[ma],!0);this.Fq.IKb()}else this.fk.XFk();return 32}D4m(ma,cb,zb,Wb,nc){this.Tz||this.xi.vn||this.Bc.processAction(pf.a.iY,2);if(nc){ma=null;if(!this.iA||2!==this.mode&&3!==this.mode){if(!nc)return 8;if(this.Tz)ma=this.dil(nc);else for(cb=0;cb<nc.length&&(ma=this.fk.KZ(nc[cb].toString()),this.uHd.YSd&&(!ma||ma.done));cb++);
}else ma=this.iA;this.P1c(ma,1);ma&&this.xi.xX&&this.Hh.Dg(this.Tz&&!this.xi.vn?cg.AFrame.QL:cg.AFrame.sr)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}tlk(ma,cb,zb,Wb,nc){var Uc;if(!nc)return 32;if(nc&&0<nc.length){cb=ma=zb=0;Wb=!1;for(let Md=0;Md<nc.length;Md++)nc[Md].toString()===(null===(Uc=this.iA)||void 0===Uc?void 0:Uc.objectId)?(Wb=!0,ma++):this.gp.qxf(nc[Md])&&(Wb&&0===zb&&(zb=Md,cb=ma),ma++);(Uc=this.gp.KZ(nc[zb].toString()))?
(this.JBa.Xic.JIf=cb+1,this.JBa.Xic.bOb=ma,this.lK.Ebc(Uc.id)):(nc=nc[zb],this.Ji.Db(nc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${nc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",nc.toString()))}return 32}SCn(){this.lK.Ebc(null);return 32}wch(ma,cb){this.Bc.pa(ma,sd.a.frame,(zb,Wb,nc)=>this.O2m(nc,cb))}pWd(ma,cb,zb){2===zb&&(ma=this.fk.tv.Qc(7),ma.Eb(this.fk.KHa),cb=
new ff.a,cb.Sfa(`${String.fromCodePoint(128077)} \n`),this.gp.Gzb(bc.a.instance.hb.kb,void 0,cb),this.pKk.uPd(),ma.dispose());return 32}O2m(ma,cb=!1){if(2===ma)ma=this.fk.tv.Qc(15),ma.Eb(this.fk.KHa),this.ij.Sd(()=>{this.dGc(cb)},"ECM:DAC"),ma.dispose();else if(1===ma&&!this.fk.t6b())return 2;return 32}dGc(ma=!1){this.Fq.mode=1;const cb=this.fk.YP();for(const zb of cb)zb.dr===ee.a.beingCreated||ma&&!zb.done||zb.Hf||this.Fq.deleteComment(zb);this.Hh.Dg(cg.AFrame.So);0<(ma?this.fk.YP().filter(zb=>zb.done):
this.fk.YP()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ma):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ma)}Yzd(ma,cb,zb){if(2===zb)if(ma=this.Hh.currentScope.name,ma!==cg.AFrame.sr&&ma!==cg.AFrame.QL){!this.Tz||this.xi.vn?(this.xi.vn||this.Bc.processAction(pf.a.iY,2),this.Hh.Dg(cg.AFrame.sr)):this.Hh.Dg(cg.AFrame.QL);var Wb=this.Bb.hb.kb;if(!Wb||!Wb.Qa)return 2;ma=Wb.Qa.cpBegin;cb=
Wb.Qa.node;Wb=!!this.iA&&(Ui.SelectionEditor.om(Wb)||Wb.yK)&&Wf.q(this.iA,cb,this.Ji,ma);ma=!!this.iA&&(2===this.mode||3===this.mode);if(Wb||ma)return this.lK.s2i(this.iA.id,!0),32;Wb=this.Tz&&!this.xi.vn?this.fk.BUh(!0,!0):null;this.lK.NRn(Wb)}else this.fk.Ss&&(this.Fq.Q6b.l2i(this.fk.Ss,!0),this.Fq.Q6b.rhb(null===(Wb=this.fk.Ss)||void 0===Wb?void 0:Wb.objectId)),this.Hh.Dg(cg.AFrame.So);return 32}oxk(){return 4}tLm(ma){const cb=new Set;for(let zb=0;zb<ma.length;zb++){const Wb=this.fk.oKc(ma[zb]);
Wb&&cb.add(Wb.Hf?Wb.Hf:Wb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",cb.size.toString())}P1c(ma,cb){ma?this.I0b&&!this.xi.xX?this.xi.xdb=Object.assign(new Tg,{commentId:ma.id,ZRc:!1}):this.wZ.selectComment(ma,Object.assign(new wi.a,{ZQ:!!cb,B8:cb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}dil(ma){let cb=null,zb=!1;for(let Wb=0;Wb<ma.length;Wb++){const nc=ma[Wb].toString();if(this.fk.qxf(ma[Wb])){cb||(cb=nc);if(zb&&this.fk.Ss.objectId!==
nc)return this.fk.KZ(nc);zb=zb||!!this.fk.Ss&&this.fk.Ss.objectId===nc}}return cb?this.fk.KZ(cb):null}}Object(e.a)(Nh,"CommentsActionManager",null,[]);var Vk=c(204),qd=c(39),Wg=c(160),$g=c(1760),Hg=c(538),oc=c(28),Tl;(function(ma){ma[ma.sRo=0]="commentDeeplink";ma[ma.catchUpActivity=1]="catchUpActivity"})(Tl||(Tl={}));Object(e.b)("DeeplinkSource",Tl);class ni{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg){this.ga=ma;this.ii=cb;this.hu=zb;this.Ape=Wb;this.aP=nc;this.s5g=Uc;this.Vb=Md;this.Fj=
ge;this.lg=Pd;this.stb=te;this.Cpe=Xe;this.FJ=Yf;this.bMe=!1;this.u1n=$h=>{if(this.lg.Hq&&!this.Fj.vn){const ei=new za.a(0,1,0,()=>{this.u4i($h)},136,void 0,!0);w.AFrameworkApplication.uc.Xb(ei)}else this.u4i($h)};Jg.execute($h=>{this.cI=$h})}get gp(){return this.ii}get Bb(){return this.stb.value}PIh(ma){let cb=ma.dr===ee.a.beingCreated?ma.Py.draftId:ma.id,zb=null;ma.Hf&&(cb=ma.Hf,zb=()=>{this.s5g.selectComment(ma.id)});this.aP.setInitialActiveContainerId(cb,0,zb)}ERn(ma,cb,zb,Wb,nc){if(!nc.commentId)return 2;
ma=this.ii.gD(nc.commentId);if(!ma)return 2;this.xmb(ma,nc);return 32}p2i(ma,cb){var zb,Wb;if(ma){var nc=(null===(Wb=null===(zb=this.ii.Wy)||void 0===zb?void 0:zb.Py)||void 0===Wb?void 0:Wb.draftId)===ma?this.ii.Wy:this.ii.gD(ma);this.selectComment(nc,cb)}}selectComment(ma,cb){ma&&this.xmb(ma,cb)}m2i(ma,cb){var zb=this.eJd(ma);zb&&((zb=this.fJd(zb,0))?cb.Z4f?(this.Fj.xdb=Object.assign(new Tg,{commentId:zb.id,ZRc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):
(this.xmb(zb,Object.assign(new wi.a,{commentId:zb.id,B8:1,ZQ:!0,oQc:!0})),this.lg.Hq&&void 0!==ma&&null!==ma&&this.PIh(zb),qf.a.g2(w.AFrameworkApplication.uc,()=>{this.Vb.Dg(this.lg.Hq&&!this.Fj.vn?cg.AFrame.QL:cg.AFrame.sr)},ef.a.NXn),Vk.a.instance.Wf(qd.a.XCh,(new Date).getTime()),ma=this.lg.Hq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ma+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ma,(new Date).getTime()-w.AFrameworkApplication.tW)):
this.ga.processAction(pf.a.m3a,2))}eJd(ma){let cb=null;var zb=null;if(M.a.f9b(ma))cb=ma;else if(({Uv:zb}=A.d(ma)).returnValue&&(ma=zb))return Hg.a.comment in ma&&(cb=ma[Hg.a.comment]),cb;cb||(zb=zb?Object.keys(zb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",zb?zb.join(","):"Not Json."));return cb?cb.toString():null}fJd(ma,cb){const zb=this.ii.oKc(ma),Wb=0===cb;Wb&&this.FJ.logKpiUsage(Fm.a.Nzd,0);if(!zb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",
ma,cb);const nc=new oc.a;nc.name="DeepLinkSource";nc.string=Tl[cb];this.FJ.logActivity("CommentDeeplinkNotFound",{dataFields:[nc]});Wb&&(cb=new F.a,cb.extendedProperties=new Map([["ErrorLevel","warning"]]),this.FJ.logKpiFailure(Fm.a.Nzd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:cb}),this.Cpe.dVm=ma)}return zb}u4i(ma){this.bMe=!0;this.Bb.setSelection(ma);this.bMe=!1}xmb(ma,cb){if(ma){this.Fj.uIb&&(w.AFrameworkApplication.uc.Se(this.Fj.uIb),this.Fj.uIb=null);var zb=this.ii.Ss,
Wb=this.gp.vlf(ma),nc=2===cb.B8,Uc={};nc&&(Uc.TriggeredByFindReplace=!0);if(this.Fj.vn)nc&&(Uc.PaneAlreadyOpen=!0),Wg.UISurfaces.wu().then(Md=>{Md.setSelectedTaskPane($g.a.Zzd);return null});else if(ma.dr!==ee.a.beingCreated&&!this.gp.kna(ma))this.Fj.xX?this.ga.processAction(lk.a.iY,2):this.Fj.xdb=Object.assign(new Tg,{commentId:ma.id,ZRc:cb.oQc}),nc&&(Uc.OpeningPaneToSelect=!0);else if(this.lg.Hq){const Md=Wb.dr===ee.a.beingCreated;Md?this.aP.MRa(Wb.Py.draftId,0,cb.ZQ):this.aP.MRa(Wb.id,0,cb.ZQ);
!Md&&nc&&(Uc.SelectingDHC=!0)}qf.a.g2(w.AFrameworkApplication.uc,()=>{this.Fj.xX&&(cb.ZQ&&this.Vb.Dg(this.lg.Hq&&!this.Fj.vn?cg.AFrame.QL:cg.AFrame.sr),cb.oQc&&this.gp.kna(ma)||!cb.ZQ&&!cb.B8||this.s5g.selectComment(ma.id))},ef.a.g2f);nc=this.gp.vlf(zb);this.lg.ota&&this.cI&&nc&&nc.id!==Wb.id&&this.cI.fireEvent(9,{comment:nc});this.ii.selectComment(ma);this.lg.ota&&this.cI&&ma.dr===ee.a.normal&&!ma.Hf&&this.cI.fireEvent(8,{comment:ma});this.Ape.highlightComment(ma,!0);this.hu.QE(0,Wb,zb);V.App.xa.updateCommandUI(!0);
0<Object.keys(Uc).length&&this.FJ.logUserAction(lk.a.selectComment,{customData:Uc})}}}Object(e.a)(ni,"CommentSelectionActor",null,[222]);class di extends lf.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new nb.a,{T_:di.getTypeName(),B_:di.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(di,"CommentSmartReplySignal",lf.a,[]);class Yg extends Na.a{constructor(){super();
this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new nb.a,{T_:Yg.getTypeName(),B_:Yg.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(e.a)(Yg,"SmartReply",Na.a,[]);var Bh=c(851);class uh{constructor(ma){this.tqa=ma}u1b(ma,cb){return Object.assign(new Bh.a,{parentPath:["Signal",di.getTypeName()],items:[Object.assign(new Kc.a,{body:Object.assign(new di,
{commentId:ma,comment:cb})})]})}eRf(ma){const cb=new Qa.a;if(ma&&ma.CommentId&&ma.ResultSets&&0<ma.ResultSets.length&&ma.ResultSets[0].Documents&&0<ma.ResultSets[0].Documents.length){for(const zb of ma.ResultSets[0].Documents)cb.add(zb.Caption);0<cb.count&&this.tqa.eRf(ma.CommentId,cb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Yg.getTypeName()}}Object(e.a)(uh,"BaseCommentSmartReplyProvider",null,[945]);class ld extends uh{constructor(ma,
cb,zb,Wb){super(ma);this.wf=cb;this.TG=zb;this.PEj=Wb}initialize(){this.TG.nm().then(()=>{this.wf.mb(this,uh.prototype.getTypeName.call(this))})}invoke(ma,cb){this.TG.nm().then(()=>{this.PEj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Gd.a,{operation:this.u1b(ma,cb)}))})}mD(ma,cb){ma&&ja.a.getTypeNameFor(ma.content)===this.getTypeName()&&cb===Ta.a.getTypeName()?this.eRf(ma.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(ld,"CommentSmartReplyProvider",
uh,[220]);var fl=c(30),fg=c(139),Xg=c(159),Xf=c(689);class Hp{constructor(ma,cb,zb,Wb,nc,Uc){this.Ma=ma;this.Wc=cb;this.Ex=zb;this.$Be=Wb;this.Cpe=nc;this.yO=Uc;this.Asb=!1;this.Cpe.ABn();this.qHj=this.WLl();this.qVf&&(fl.a.addHandler(window.self,af.a.tgh,()=>{this.Asb=!0}),fl.a.addHandler(window.self,af.a.ugh,()=>{this.Asb=!1}))}get fy(){return this.Ex?this.Ex.value:null}get KBa(){return this.$Be.value}get kso(){return this.Asb}get uNc(){return 0<this.qHj}get Hq(){return this.yO.Hq}get K5k(){return!0}get Spk(){return Object(Xf.a)()?
!1:this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get alb(){return this.Ma.$("OutlineViewElementDisplayWrapperForDhcsIsEnabled")}get NNb(){return this.Wc.isFeatureEnabled(116)&&!Xg.App.sRc}get SSn(){return this.Wc.isFeatureEnabled(35)&&this.Ma.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get mMa(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentSVGIconsEnabled",!1)&&this.Wc.isFeatureEnabled(87)}get CJk(){return this.Ma.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get qVf(){return this.Ma.$("RecordCommentActionsInTypingIsEnabled")}get FAi(){return this.Ma.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get oAb(){return this.Hq&&
!this.uNc&&!this.Ma.lb("BootActivityNavigationId")&&H.a.jt}get hyb(){return this.Wc.isFeatureEnabled(6)}get Qok(){return this.Ma.$("AtMentionUserFloodGateCampaignIsEnabled")}get RJk(){return this.Ma.$("CommentFriendlyTimestampsIsEnabled")}get E5k(){return this.Ma.lb("DisabledChangeGatesInSharedComments")}get vHd(){return this.yO.vHd}get dNb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get C6f(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get XX(){return this.Ma.lb("PresenceUserId")}get removePersonalInformation(){return Xg.App.fje&&!!fg.PageReader.instance&&fg.PageReader.instance.Cfa(V.App.xa.jb.Yc).removePersonalInformation}get Reb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get oEm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get hko(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get IKk(){return this.Ma.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get wKk(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get gDm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.yO.contentNavigationApiEnabled}get Tbn(){return this.Wc.isFeatureEnabled(86)}get ota(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.yO.contentFilterApiEnabled}get returnToDraftFixEnabled(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReturnToDraftFixEnabled",!1)}get QJk(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get t$d(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectorFixForMissingCommentNotification",!1)}get duplicateUndoResolvedCommentsFixEnabled(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DuplicateUndoResolvedCommentsFixEnabled",
!1)}WLl(){if(this.fy&&this.KBa){const ma=new Wc.GraphIterator;ma.set(this.fy);this.KBa.h3a(ma);let cb=0;39===ma.ef&&(cb=ma.Sp());return cb}return-1}}Object(e.a)(Hp,"CommentsSettings",null,[]);var gm=c(1560),Ig=c(1342);class Bk{constructor(ma){this.p9=ma}$mh(ma,cb,zb){const Wb=new ne;cb=this.p9.sPa(cb)?cb.objectId:null;if(!cb)return Wb;cb=la.a.Gf(cb);if(zb.contains(cb))return Wb.QOc=0,Wb.POc=ma.length,Wb;for(let Uc=0,Md=ma.length;Uc<Md;Uc++){var nc=ma[Uc];zb=Wf.g(nc);nc=Wf.d(nc);zb&&Ig.a.vwh(zb,cb)&&
(Wb.QOc=Uc);if(nc&&Ig.a.vwh(nc,cb)){Wb.POc=Uc;break}}return Wb}yih(ma,cb,zb){const Wb=-1===cb.QOc&&-1===cb.POc,nc=-1<cb.QOc?cb.QOc:-1;cb=-1<cb.POc?cb.POc:ma.length;const Uc=!Wb&&nc===cb;var Md=!1;for(let ge=0;ge<ma.length;ge++){const Pd=ma[ge],te=si.a(Pd);if(1!==te&&2!==te&&3!==te)continue;this.p9.kRa(Pd);if(Wb||ge<nc||ge>cb)continue;const Xe=3===te||2===te&&-1!==Pd.className.indexOf(Zi.a.wOa),Yf=zb?1:2;this.smk(ge,nc,cb,Yf,Xe,Md,Pd,Uc);if(ge!==cb||Uc)(Md=this.p9.N0a.J(te).J(Yf))&&Pd.classList.add(Md),
Md=Xe}}smk(ma,cb,zb,Wb,nc,Uc,Md,ge){ma!==cb&&ma!==zb||nc||Uc||((ma=this.p9.cdc.J(Wb))&&Md.classList.add(ma),ge&&Md.classList.add(Zi.a.FQf))}}Object(e.a)(Bk,"DefaultHighlightChangeHandler",null,[214]);var zi;(function(ma){ma[ma.success=0]="success";ma[ma.noSelection=1]="noSelection";ma[ma.invalidContent=2]="invalidContent"})(zi||(zi={}));Object(e.b)("AnchorCreationResult",zi);var Lc=c(74),nh=c(24),Sd=c(290),je=c(248),Bl=c(1182);class Pg{}Object(e.a)(Pg,"EditorAnchorInfo",null,[230]);class gl{constructor(ma,
cb,zb,Wb,nc,Uc,Md,ge){this.GCm=ma;this.cBf=cb;this.fk=zb;this.$0a=Wb;this.JBa=nc;this.Nq=Uc;this.BS=Md;this.Nt=ge;this.j5g=null;this.$0a.t4a(this.JBa);this.Nt.contentFilterApiEnabled&&(this.BS.tha("OnCommentPaneOpen",this.cyo.bind(this)),this.BS.tha("OnCommentPaneClose",this.byo.bind(this)),this.BS.tha("OnContentFilterUpdate",this.IWc.bind(this)))}get Bb(){return this.cBf.value}get Ji(){return this.GCm.value}initialize(){}Fdm(ma){this.j5g=ma}dispose(){}rhb(ma){this.JBa.rhb(ma)}P6b(ma){this.JBa.P6b(ma)}highlightComment(ma){this.l2i(ma,
!1);this.JBa.rhb(ma.objectId)}Kjc(ma){this.JBa.Kjc(ma)}bDa(ma){return this.JBa.bDa(ma)}IWc(){this.Nke("OnContentFilterUpdate")}cyo(){this.Nke("OnCommentPaneOpen")}byo(){this.Nke("OnCommentPaneClose")}Nke(ma){const cb=[],zb=new Set;for(const nc of this.fk.YP())if(!nc.Hf&&nc.dr!==ee.a.beingCreated&&!this.fk.lK.qph(ma,nc)){var Wb=this.PMl(nc);zb.has(Wb.id.toString())||(zb.add(Wb.id.toString()),(Wb=Wb.xe(Lc.InteractiveViewManager.instance.od.Sb))&&cb.push(Wb))}cb.forEach(nc=>{this.$0a.Ljc(nc)})}PMl(ma){var cb,
zb;const Wb=null===(cb=this.Ji)||void 0===cb?void 0:cb.Db(ma.objectId);if(!Wb)return null;ma=Wf.k(Wb);cb=null===(zb=this.Ji)||void 0===zb?void 0:zb.Db(ma);return xd.a.V0h(cb)}l2i(ma,cb){if(!ma.dr){var zb=this.Ji.Db(la.a.Gf(ma.objectId)),Wb=mi.a.taa(zb,this.Ji,!0);zb=mi.a.taa(zb,this.Ji,!1);if(Wb&&zb){const nc=Wb.Nb.paragraph;Wb=Wb.Nb.cp;if(this.Tvm(nc,Wb))V.App.xa.updateCommandUI(!0);else{Wb=nh.SelectionFactory.we(nc,Wb);zb=Cf.a.Uc(zb.Nb.paragraph,zb.Nb.cp);if(gl.ag.C7(Wb.Qa)||gl.ag.C7(zb))ma.Y8b=
!0,ma.e3a();ma=cb?nh.SelectionFactory.Vz(Wb,zb):Wb;this.j5g(ma)}}}}KFk(){this.JBa.P6b(null);this.JBa.rhb(null)}UQk(){const ma=new Pg;return{returnValue:zi.success,anchor:ma}}Tvm(ma,cb){if(ma&&Object(Yj.a)(Bl.PageView,this.Nq.od)){var zb=ma.xe(this.Nq.od.Sb);ma=document.getElementById(Jk.AppFrame.jTa);if(zb&&ma){cb=Sd.a.Cq(zb,cb);if(!cb)return!1;cb=cb.y;zb=Sys.UI.DomElement.getBounds(ma).y;ma=ma.offsetHeight;if(cb>=zb&&cb<=zb+ma)return!0}}return!1}static get ag(){return je.a.instance}static getInstance(){return gl.Jl()}static Jl(){return gl._instance||
(gl._instance=new gl(new R.a(()=>V.App.xa.jb.Yc.Bd),new R.a(()=>bc.a.instance),K.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),K.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,K.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Lc.InteractiveViewManager.instance,K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}gl._instance=null;Object(e.a)(gl,"EditorCommentHintManager",
null,[218,219,9]);var yo=c(1947),Xl=c(372),Gm=c(1131);class Hm extends cf.a{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg,$h,ei,rl,Bi,en,Jm,fn,Rm,Km,Bm,sk,Jn,yg,Cm){super(Md);this.Ci=cb;this.stb=ge;this.r1e=te;this.uqa=Xe;this.r8a=Yf;this.aP=Jg;this.lg=$h;this.Lp=ei;this.iRb=rl;this.Fj=Bi;this.b5=en;this.je=fn;this.FJ=Rm;this.Lh=Km;this.CS=sk;this.Pzd=Jn;this.Mno=Cm;this.dai=this.f7g=this.aVa=null;this.qkb=()=>{this.bqa.Dva()&&(this.DTi(this.bqa.wc),this.bqa.uec(this.qkb))};this.kVc=Ni=>{2===
Ni.mode?this.xC=1:1===Ni.mode&&(this.xC=0);this.ii.Wy&&0===this.xC?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.ii.Wy.Py.sessionType):this.Fj.xX&&(this.Tz||this.T0.isVisible)&&this.IKb()};this.o0m=()=>{this.Fj.sEb?this.mode=0:this.xC=0};this.qFa=(Ni,Ci)=>{var gg;Ni=Ci.Ll.kb;if((this.Tz||this.Iba&&this.Iba.isVisible)&&!this.iRb.bMe&&Ni){Ci=Ui.SelectionEditor.om(Ni);var oo=Ni.yK;null!==(gg=this.dai)&&void 0!==gg&&gg.gaa||
(this.gp||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),gg=this.gp&&this.gp.hib(this.ga,!1),1!==this.mode||Ci&&!oo||!gg?this.r8a.uPd():this.HUk(Ni));2!==this.mode&&3!==this.mode&&this.lg.CJk&&this.Bqo(Ni,Ci,oo)}};this.uDk=()=>{if(this.fk&&this.fk.Wy&&!V.App.Ptf){var Ni=this.fk.Wy;Ni.Py.sessionType!==yo.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Ni.dr} present on app shutdown`),(Ni=xd.a.bBl(Ni))&&this.FJ.logKpiFailure(Ni,"CommentDraftLostOnAppShutdown",
{isInternal:!0},{name:Fm.a.G0b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.x0m=()=>{if(this.Fj.xX){var Ni=()=>!0;this.Tz&&!this.Fj.vn&&(Ni=Ci=>this.gp.kna(Ci));Ni=this.gp.Fgf(Ni);this.IKb(Ni)}};this.ga=Md;this.xC=1===this.ga.mode?0:1;this.T0=nc;this.ii=Wb;this.E9=Uc;this.Vb=Pd;this.BAn();zb.s4a(this.uqa);this.Bb.DA(this.qFa);ma.CWR(()=>ma.result.pB.OXa(this.o0m));w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.LXa(this.kVc);this.b5.tha("OnAfterTrackChangeMarkupViewChange",
this.x0m);w.AFrameworkApplication.rJ&&w.AFrameworkApplication.rJ(this.uDk);yg.execute(Ni=>{this.cI=Ni});Bm.execute(Ni=>{Ni.zOk.execute(Ci=>{this.dai=Ci})})}BAn(){this.bqa&&(this.bqa.Dva()?this.DTi(this.bqa.wc):this.bqa.kZb(this.qkb))}DTi(ma){ma.Gka(()=>{this.ofo()})}get bqa(){var ma;return null===(ma=Xg.App.Fn)||void 0===ma?void 0:ma.jb}get Bb(){return this.stb.value}get fk(){return this.ii}get gp(){return this.ii}get Tz(){return this.lg.Hq}get oAi(){return!0}get t$d(){return this.lg.t$d}get V6b(){return this.aVa}set V6b(ma){this.aVa=
ma}get mode(){return super.mode}set mode(ma){ma!==this.xC&&(super.mode=ma,this.e3a())}get iA(){return this.model&&this.model.Ss?this.model.Ss.Hf?this.model.gD(this.model.Ss.Hf):this.model.Ss:null}get Ji(){return this.Ci.value}get Laj(){return!1}get removePersonalInformation(){return this.lg.removePersonalInformation}IKb(ma=null,cb=null){const zb=this.gp,Wb=!this.xC,nc=this.Iba.OJk,Uc=zb.oLd();nc.Scg(Uc?5:1,Wb);ma=this.lg.dNb&&ma?ma:zb.ahf(this.lg.dNb&&this.Tz&&!this.Fj.vn);nc.NSn(ma,Uc,zb.TTa);this.ucg();
cb&&a.ULS.sendTraceTag(572281362,327,50,cb)}JWc(ma,cb,zb=!1){this.Fj.vn?this.aP.mqj():cb?this.aP.deleteContainer(ma.dr===ee.a.beingCreated?ma.Py.draftId:ma.id,0,zb):this.Msn(ma)}Msn(ma){const {Wlo:cb}=this.ii.oGl(ma),zb=this.E9.bDa(ma.objectId);zb&&this.aP.addContainer(ma.id,zb.parentElement,0,cb)}w2i(ma){const cb=this.iA;this.R1c();this.uqa.QE(0,this.ii.Ss,cb);this.Tz&&this.ii.Ss&&!this.Fj.vn&&this.aP.MRa(this.ii.Ss.id,0,1===ma)}ORn(){const ma=this.iA;this.S1c();this.uqa.QE(0,this.ii.Ss,ma);this.Tz&&
this.ii.Ss&&!this.Fj.vn&&this.aP.MRa(this.ii.Ss.id,0,!1)}Kjc(ma){this.E9.Kjc(ma)}T$k(ma,cb){this.aP.addContainer(ma,null,0,cb)}Lfn(ma){this.aP.lLi(ma)}V$k(ma,cb){this.aP.z0c(ma,cb,0)}nxo(){this.aP.xWe()}o2i(ma){if(ma&&(2!==this.mode||ma.dr===ee.a.beingCreated)){var cb=this.ii.Ss;cb!==ma&&(this.ii.selectComment(ma),this.T0.isVisible?this.Fj.xX?(this.T0.selectComment(ma,1),this.qja.selectComment(ma.id)):this.Fj.xdb=Object.assign(new Tg,{commentId:ma.id,ZRc:!1}):this.Tz&&!ma.done&&(this.s2i(ma.id,!1),
this.qja.selectComment(ma.id)),!this.T0.isVisible&&this.Tz&&ma.done||(this.Q6b.rhb(ma.objectId),this.uqa.QE(0,this.iA,cb)))}}bPc(){}jaf(){this.Fj.sEb=!1}xxb(ma){this.lg.FAi&&this.ii.Ss&&this.clearSelection();super.xxb(ma);this.FJ.logKpiUsage(Fm.a.C1e,0);this.ucg();if(this.Tz){const cb=this.ii.dXl(ma.draftId);this.T$k(ma.draftId,cb)}}addReply(ma,cb){this.FJ.logKpiUsage(Fm.a.aAd,0);super.addReply(ma,cb)}pta(ma){this.Tz&&null!=ma.Py&&this.ii.HUi(ma.Py.draftId);super.pta(ma);this.E9.rhb(ma.objectId);
a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Wf.a(ma));this.FJ.logKpiUsage(Fm.a.Auh,0);this.zDk(ma);xd.a.TEo(ma,this.Ji,this.FJ);this.FJ.logUserAction(lk.a.zuh,{succeeded:!0,customData:{actionType:ma.Hf?yo.a.reply:yo.a.create}})}zdb(ma){super.zdb(ma);this.FJ.logUserAction(lk.a.zuh,{succeeded:!0,customData:{actionType:yo.a.edit}})}zDk(ma){if(ma.Hf){var cb=this.ii.vlf(ma);if(cb.ZAc&&cb.$Ac){var zb=this.Ji.Db(la.a.Gf(cb.$Ac));cb=cb.$Ac===cb.ZAc?null:this.Ji.Db(la.a.Gf(cb.ZAc));xd.a.Rhg(zb,
ma,!0);xd.a.Rhg(cb,ma,!1)}}}eGc(ma){super.eGc(ma);this.iA&&this.iA.id===ma.id&&(super.clearSelection(),this.Tz&&this.aP.q0b());if(this.Tz)if(Wf.r(ma)){var cb=[];let zb=null;for(const Wb of this.model.YP())Wb!==ma&&(Wb.Hf===ma.Hf&&cb.push(Wb),Wb.id===ma.Hf&&(zb=Wb));zb&&zb.id&&zb.objectId&&!zb.done&&this.gp.dG(zb.objectId)&&!this.gp.$Li(zb.objectId)&&!cb.length&&this.JWc(zb,!0)}else cb=ma.dr===ee.a.beingCreated,ma.done||this.JWc(ma,!0),cb&&this.ii.HUi(ma.Py.draftId)}editComment(ma,cb){1===this.mode&&
ma&&(this.ii.nHc(ma,cb),yo.a.edit===cb.sessionType&&this.FJ.logKpiUsage(Fm.a.Fuh,0),this.lg.NNb&&3!==yo.a.Gjf(cb.sessionType)&&this.iRb.selectComment(ma,Object.assign(new wi.a,{ZQ:!1,B8:0})))}h$d(ma){this.Tz&&!this.Fj.vn||super.h$d(ma)}deleteComment(ma){ma.dr!==ee.a.beingCreated&&this.gp.lEh(la.a.Gf(ma.objectId));this.aVa&&this.aVa.id===ma.id&&(this.ii.Ss&&this.aVa.id===this.ii.Ss.id?this.aVa=null:this.uqa.m0e());!this.ii.Ss||this.ii.Ss.id!==ma.id&&this.ii.Ss.Hf!==ma.id?this.ii.Ss&&this.uqa.QE(0,
this.ii.Ss,null):void 0===ma.Hf||null===ma.Hf?this.clearSelection():this.ii.selectComment(this.ii.gD(ma.Hf));ma.Y8b&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",Wf.a(ma));super.deleteComment(ma);a.ULS.sendTraceTag(50426377,327,50,`${Wf.a(ma)} deleted by user action. DurableId: ${ma.RZa}`)}Myb(ma,cb){super.Myb(ma,cb);this.Tz&&!this.Fj.vn&&cb&&(this.ii.Ss&&this.ii.Ss.id===ma.id&&this.clearSelection(),this.V6b&&this.V6b.id===ma.id&&this.uqa.m0e())}NRn(ma=
null){(ma=this.gp.Vwl(ma))?this.iRb.selectComment(ma,Object.assign(new wi.a,{ZQ:!0,B8:1})):this.w2i(1)}HUk(ma){var cb,zb;if(null!==(cb=w.AFrameworkApplication.K)&&void 0!==cb&&cb.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleViewElementCommentEntryPoint",!1)){var Wb=this.bqa.wc;if(Wb){cb=ma.Qa.node;var nc=null===(zb=this.Mno.instance)||void 0===zb?void 0:zb.CMc(cb);if(nc)for(const Uc of Wb.wNa(nc))if(Uc&&Uc instanceof Xl.a&&(zb=Uc,Wb=Gm.a.QBd(zb),this.r8a.bkc=this.JMh(cb,ma),nc=this.Ayk(Wb),
null!==nc)){if(ma=this.r8a.DMh(Wb,nc))Wb.$ma[nc].appendChild(ma),zb.Pw(ma);break}}}else this.IUk(ma)}IUk(ma){var cb=ma.Qa.node;let zb=hf.OutlineElementNavigator.fl(cb);this.Lh.Sd(()=>{const nc=Wc.GraphIterator.$a(zb);let Uc=null;do nc.jo()&&(Uc=nc.parentNode?hf.OutlineElementNavigator.fl(nc.parentNode):null)&&(zb=Uc,nc.set(zb));while(Uc)},"ECM:FOOE");if(null===zb||void 0===zb?0:zb.FD)for(var Wb of zb.FD)if(Wb&&Wb instanceof Xl.a){const nc=Gm.a.QBd(Wb);this.r8a.bkc=this.JMh(cb,ma);ma=this.Byk(nc);
if(cb=this.r8a.DMh(nc,ma))nc.$ma[ma].appendChild(cb),Wb.Pw(cb);break}}JMh(ma,cb){let zb;for(const Wb of ma.FD)if(Wb&&Wb){zb=Wb;break}ma=cb.Qa.xk;cb=!(null===zb||void 0===zb||!zb.Mn)&&0<zb.Mn.length;return 0>ma||!cb||null===zb||void 0===zb||!zb.eop?null:Sd.a.pZ(ma,zb,!1,!1)}Ayk(ma){var cb;const zb=null===(cb=this.r8a.bkc)||void 0===cb?void 0:cb.y;for(const [Wb,nc]of ma.jX.entries())if(ma=zb-nc.y,-2<=ma&&ma<nc.height+2)return Wb;return null}Byk(ma){var cb;if(!ma.jX||2>ma.jX.length)return 0;let zb=0;
const Wb=null===(cb=this.r8a.bkc)||void 0===cb?void 0:cb.y;for(cb=1;cb<ma.jX.length;cb++)if(Wb>=ma.jX[cb].y-2)zb=cb;else break;return zb}e3a(){V.App.$gb=2===this.mode||3===this.mode;1!==this.mode&&this.r8a.uPd()}Bqo(ma,cb,zb){const Wb=this.Vb.currentScope;let nc=null;if(cb||zb){cb=ma.Qa.cpBegin;ma=ma.Qa.node;if(this.iA&&Wf.q(this.iA,ma,this.Ji,cb))return;nc=this.KKl(ma,cb)}nc?!this.Tz||this.Fj.vn?qf.a.g2(w.AFrameworkApplication.uc,()=>{this.o2i(nc)},ef.a.GRn):this.o2i(nc):!this.ii.Ss||Wb&&Wb.name===
cg.AFrame.QL||this.clearSelection()}KKl(ma,cb){let zb=null;const Wb=this.model.YP();for(let nc=Wb.length-1;0<=nc;nc--){const Uc=Wb[nc];if(Uc.objectId&&!(Uc.Hf||this.Tz&&!this.Iba.isVisible&&Uc.done)&&Wf.q(Uc,ma,this.Ji,cb)){zb=Uc;break}}return zb}selectComment(ma,cb=1){this.iRb.p2i(ma,Object.assign(new wi.a,{ZQ:1===cb,B8:cb}))}s2i(ma,cb){const zb=this.ii.gD(ma);zb?this.Tz&&!Wf.r(zb)&&zb.dr!==ee.a.beingCreated&&this.aP.MRa(ma,0,cb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ma=
this.model.Ss;this.lg.ota&&this.cI&&ma&&this.cI.fireEvent(9,{comment:ma});super.clearSelection();this.uqa.QE(1,ma,ma);this.Tz&&ma&&this.aP.q0b()}uvm(){var ma;return 500>(null===(ma=this.f7g)||void 0===ma?void 0:ma.vi)}Ebc(ma,cb=1){if(!this.lg.FAi||!this.ii.Wy){var zb=this.ii.gD(ma),Wb=null;zb||(Wb=this.aVa);var nc=this.uvm(),Uc=!1;1===cb&&this.qja&&(nc?Uc=!0:this.qja.highlightComment(ma));ma?zb?nc?Uc=!0:this.E9.P6b(zb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):
this.E9.P6b(null);zb?nc?Uc=!0:(this.aVa=zb,this.uqa.QE(2,zb,Wb)):(this.aVa=null,this.uqa.QE(3,null,Wb));Uc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}ofo(){this.je&&(this.f7g=this.je.jg("UserAction","StartScrollDetectionStopwatch"))}notify(ma,cb){this.Lp.sendNotification(ma,cb)}ucg(){this.Pzd.onContentChanged()}qph(ma,cb){var zb,Wb;switch(ma){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Obo(cb);case "OnContentFilterUpdate":return!(null===
(Wb=(zb=this.Pzd).isContentInFilterUpdateDiff)||void 0===Wb?0:Wb.call(zb,cb.id));default:return!0}}Obo(ma){return this.lg.QJk?!ma.done&&this.gp.kna(ma)===this.Pzd.isContentInFilteredContent(ma.id):this.gp.kna(ma)===this.Pzd.isContentInFilteredContent(ma.id)}static getInstance(){return Hm.Jl()}static Jl(){Hm.Pg||(Hm.Pg=new Hm(V.App.Lma(),new R.a(()=>V.App.xa.jb.Yc.Bd),K.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,K.a.instance.resolve("Common.Comments.ICommentModel"),K.a.instance.resolve("Common.Comments.ICommentPane"),
gl.getInstance(),w.AFrameworkApplication.ya,new R.a(()=>bc.a.instance),ig.FocusManager.instance(),K.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),K.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),K.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),K.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings"),K.a.instance.resolve("Common.Utils.IAriaNotifier"),K.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),
K.a.instance.resolve("WordEditor.Comments.CommentsState"),K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Xg.App.Fn.jb.wc,V.App.xa.tq,K.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),N.a.instance,K.a.instance.Za("WordEditor.HeaderFooter.HeaderFooterControlOwner"),K.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),K.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),K.a.instance.Za("WordEditor.Extension.RichApiEventManager"),
K.a.instance.Za("WordEditor.Indicator.TopLevelOutlineElementCache")),Hm.Pg.wMb=!0);return Hm.Pg}}Hm.Pg=null;Object(e.a)(Hm,"EditorCommentManager",cf.a,[215,216,217,9]);var Kj=c(1699);class Bf{constructor(ma,cb,zb,Wb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ma;this.body=cb;this.confirmButton=zb;this.cancelButton=Wb}}Object(e.a)(Bf,"ViewContainerModalDialogStrings",null,[]);var Ge=c(330);c(1446);class vi{constructor(ma,cb){this.canvasContextId=this.canvasActionId=0;
this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ma;this.canvasContextId=cb}}Object(e.a)(vi,"CommentUIAction",null,[]);var Mc=c(1025);class Xm{constructor(ma,cb,zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg,$h,ei,rl,Bi){this.ga=ma;this.qg=cb;this.ie=zb;this.Vb=Wb;this.Zo=nc;this.Eh=Uc;this.Y1=Md;this.tqa=ge;this.jtd=Pd;this.yQe=te;this.Gb=Xe;this.aP=Yf;this.lg=Jg;this.Fj=$h;this.iRb=ei;this.b5=rl;this.nja=Bi;this.Ape=this.fj=
null;this.n5g=this.fAg=!1;this.qwc=null;this.t$n=(en,Jm,fn)=>2!==fn||this.Fj.xX?1===fn?32:2:(this.b5.Moa("OnCommentInit",Object.assign(new Mf.a,{YEa:()=>{this.ga.processAction(pf.a.iY,2)}})),32);this.Pci=(en,Jm,fn)=>1!==fn||this.Fj.xX?2:8;this.g9j=(en,Jm,fn)=>{if(1===fn)return!this.hib()||this.ccb?8:this.Fj.xX?2:32;if(!this.Fj.xX)return this.ccb=!0,this.b5.Moa("OnCommentInit",Object.assign(new Mf.a,{YEa:()=>{this.Hq||this.Fj.vn||this.ga.processAction(pf.a.iY,2)}})),32;this.Hq||this.Fj.vn||this.ga.processAction(pf.a.iY,
2);(this.Hq||this.Fj.vn)&&this.Vb.Dg(this.Fj.vn?cg.AFrame.sr:cg.AFrame.QL);return 2};this.U0k=(en,Jm,fn)=>1===fn&&vd.SessionStatusManager.instance.zj?8:2;this.m5k=(en,Jm,fn,Rm)=>1!==Rm||(this.Hq||this.isVisible)&&this.fj.model.Ss?en||this.fj.model.Ss?32:8:8;this.nhb=(en,Jm,fn,Rm,Km)=>{if(1===fn||!this.Fj.vn)return 32;if(!this.Hq&&2===fn&&(2===this.fj.mode||3===this.fj.mode))return Km=new Bf(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,
CommentPaneStrings.DiscardDialogResume),this.jtd.invokeModalConfirmationDialog(()=>{this.o2m(en,Jm,fn,Rm)},()=>{this.s1m()},Km),32;this.wPd();if(this.Hq)return 32;Km&&this.NIh();return 32};this.rKb=(en,Jm,fn,Rm,Km)=>{if(1===fn)return 32;Km[Ge.a.On]=this.isVisible;return 32};this.vlc=this.QQk()}get isVisible(){return this.Fj.vn}get ccb(){return this.fAg}set ccb(ma){this.fAg=ma}get E4n(){return"SharedCommentsTaskPaneProps"}get RXc(){return null}get aAi(){return null}get mK(){return this.Zo}get Iba(){return null}get OJk(){return this.tqa}get Hq(){try{return this.lg.Hq}catch(ma){return!1}}k_h(){return new fj(w.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,w.AFrameworkApplication.uiCulture,w.AFrameworkApplication.dataCulture)}QQk(){const ma=new tf.a,cb=new vi(pf.a.newComment,sd.a.frame);cb.preCallback=this.g9j;const zb=new vi(lk.a.EIf,sd.a.frame),Wb=new vi(lk.a.QRf,sd.a.frame),nc=new vi(lk.a.deleteComment,sd.a.frame);nc.preCallback=this.U0k;nc.postCallback=this.m5k;this.Hq&&(zb.preCallback=this.Pci,Wb.preCallback=this.Pci);const Uc=new vi(pf.a.iY,sd.a.frame);Uc.preCallback=this.t$n;ma.Z(6,Uc);ma.Z(0,cb);ma.Z(1,zb);
ma.Z(2,Wb);ma.Z(3,nc);return ma}Y8i(ma){this.n5g||(this.C4j=this.dMd(),this.Y1.yMa(),this.S3n(),this.O3n(ma),this.n5g=!0)}O3n(ma){this.fj=ma;this.Ape=ma.Q6b;this.fj.WKh=this.tqa}initialize(ma){this.Y8i(ma);this.Wb()}rsf(){this.qwc&&this.Vb.Dg(cg.AFrame.sr);this.ccb&&!this.Hq?(this.ga.processAction(pf.a.newComment,2),this.ccb=!1):this.Fj.xdb&&qf.a.g2(w.AFrameworkApplication.uc,()=>{const ma=this.Fj.xdb.commentId,cb=this.Fj.xdb.ZRc;this.ga.Ub(lk.a.selectComment,2,Object.assign(new wi.a,{commentId:ma,
B8:1,ZQ:!0,oQc:cb}));cb&&(qf.a.g2(w.AFrameworkApplication.uc,()=>{this.Vb.Dg(cg.AFrame.sr)},ef.a.g2f),Vk.a.instance.Wf(qd.a.XCh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-w.AFrameworkApplication.tW);this.Fj.xdb=null},ef.a.FRn)}dispose(){}q4(){}selectComment(){this.isVisible||this.Hq||this.rbj();this.Eh.updateCommandUI(!0)}Wb(){this.ga.pa(pf.a.nhb,sd.a.frame,this.nhb);this.ga.gb(pf.a.rKb,sd.a.frame,this.rKb,
96)}e3a(){-1!==this.fj.mode&&(this.fj.mode||this.NIh())}NIh(){const ma=this.fj,cb=ma.gp,zb=cb.oLd(),Wb=cb.ahf(this.lg.dNb&&this.lg.Hq&&!this.Fj.vn);this.tqa.MSn(Wb.length,zb,!ma.mode,zb?5:1);this.tqa.iTn(Wb,cb.TTa)}S3n(){const ma=this.Vb.le(cg.AFrame.sr);ma.parent=cg.AFrame.Hp;ma.BK=!0;ma.c9d=!0;ma.Pob=!0;ma.ecb((cb,zb)=>{eg.a.pph(zb.name)&&(this.Fj.uIb=qf.a.g2(this.Gb,()=>{zb.name!==cg.AFrame.QL&&2!==this.fj.mode&&3!==this.fj.mode&&(this.fj.clearSelection(),this.Eh.updateCommandUI(!0));this.Fj.uIb=
null},ef.a.d2m))});this.Zo.uS(cg.AFrame.sr);if(this.lg.hyb)for(const cb of Wf.t)ma.bindAction(Dd.KeyInputManager.$F(cb),lk.a.aZe)}AXn(){this.qwc&&this.yQe.Kml()}irh(){this.nMj&&this.AXn()}o2m(ma,cb,zb,Wb){const nc=this.fj,Uc=nc.gp.Wy;Uc&&Uc.Py?nc.r1e.endCommentSession(Uc.Py.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.nhb(ma,cb,zb,Wb,!0);qf.a.g2(this.Gb,()=>{this.Eh.updateCommandUI(!0)},ef.a.yNn)}s1m(){this.qwc&&this.Vb.Dg(cg.AFrame.sr);
this.Eh.updateCommandUI(!0)}RFa(ma){ma.Mr(this.Vb.XV);ma.Mr(this.Vb.YV)}SMb(ma,cb,zb){if(1===zb)return 32;this.rbj();return 32}rbj(){this.isVisible||(this.Fj.xX?(this.i6k(),this.Fj.vn=!0,this.b5.$6d(),this.Vb.fAc(cg.AFrame.sr),this.Hq&&this.lg.dNb&&this.fj.IKb(this.fj.model.Fgf(()=>!0)),this.nMj=!0,Wg.UISurfaces.wu().then(ma=>{ma.showTaskPane($g.a.Zzd,this.C4j);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.fj.Ebc(null),this.Eh.updateCommandUI(!0),
this.RFa(this.Vb.le(cg.AFrame.sr)),this.b5.Moa("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.b5.Moa("OnCommentInit",Object.assign(new Mf.a,{YEa:()=>{this.Fj.vn||this.ga.processAction(pf.a.iY,2)}})))}i6k(){this.ga.Ub(lk.a.eaa,2,null);this.ga.Ub(lk.a.ZS,2,null)}hib(){return this.nja.hib(this.ga,!1)}xxb(){}show(){this.isVisible||this.ga.processAction(pf.a.iY,2)}editComment(){return 2}wPd(){this.fj.paneClosing();this.Fj.vn=!1;if(this.Hq&&this.lg.dNb){const cb=
this.fj.model;this.fj.IKb(cb.Fgf(zb=>cb.kna(zb)))}var ma=ig.FocusManager.instance();ma.currentScope&&ma.currentScope.name===cg.AFrame.sr&&ma.Dg(this.Hq&&(2===this.fj.mode||3===this.fj.mode||this.fj.fk.Ss)?cg.AFrame.QL:ma.QS);this.Zo.ex(cg.AFrame.sr);this.Vb.TFc(cg.AFrame.sr);Wg.UISurfaces.wu().then(cb=>{cb.hideTaskPane($g.a.Zzd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Hq&&(ma=this.fj.model.Ss)&&this.qwo(ma);this.b5.Moa("OnCommentPaneClose");
a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}qwo(ma){ma.done?this.fj.clearSelection():this.iRb.PIh(ma)}S9m(ma=null){this.yQe.r8i(3);this.rsf();if(ma){this.irh();fl.a.lWf(ma,[af.a.contextMenu]);const cb=this.Vb.le(cg.AFrame.sr);this.qg.tAc(cg.AFrame.sr,ma,cb.Pob)}}I7m(ma){this.Zo.XG(cg.AFrame.sr);1!==ma&&qf.a.g2(w.AFrameworkApplication.uc,()=>{this.Vb.qC(cg.AFrame.sr)},ef.a.g2f)}onTaskPaneClose(){this.Fj.xX&&this.yQe.r8i(1)}dMd(){const ma={type:this.E4n,KTo:this.irh};return Object.assign(new Mc.a,
{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ma,hideHeader:!1,width:300,location:2,onOpen:cb=>{this.qwc=cb;this.S9m(cb);this.aP.V$f(!0)},onClose:()=>{this.qwc=null;this.ga.Ub(pf.a.nhb,2,!0);this.Eh.updateCommandUI(!0);this.onTaskPaneClose();this.aP.V$f(!1)},onShow:cb=>{this.I7m(cb)}})}iY(){return 32}}Object(e.a)(Xm,"OfficeSharedCommentPane",null,[9,206,207]);var um=c(1618),On=c(144);class Uj{constructor(ma,cb){this.containerType="full-pane";this.identifier=null;this.ga=ma;this.identifier=
cb}openView(){this.ga.processAction(pf.a.SMb,2)}closeView(){this.ga.Ub(pf.a.nhb,2,!0)}invokeModalConfirmationDialog(ma,cb,zb){const Wb=new On.StandardDialog;zb&&zb.title&&zb.body&&zb.confirmButton&&zb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),zb=new Bf("","","",""));Wb.Ed=1;Wb.Ue(1,zb.confirmButton);Wb.Ue(0,zb.cancelButton);Wb.xv(zb.title,zb.body,1,nc=>{1===nc?ma():cb()})}}Object(e.a)(Uj,"ViewContainerAPI",null,[201,202]);class hm{constructor(ma,
cb,zb){this.ooo=ma;this.xi=cb;this.cHa=zb;this.Ld=new da.a;this.ooo.execute(Wb=>{this.cHa.I7d("OnBeforeTrackChangeMarkupViewChange",(nc,Uc)=>{Uc&&Uc.tIf!==Wb.rj&&this.Ld.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Uc)});this.cHa.I7d("OnAfterTrackChangeMarkupViewChangeEventKey",(nc,Uc)=>{Uc&&Uc.rj===Wb.rj&&(gm.a.rj=Wb.rj,this.Ld.raiseEvent("OnAfterTrackChangeMarkupViewChange",Uc))})})}tha(ma,cb){this.Ld.addHandler(ma,cb)}Moa(ma,cb){this.Ld.raiseEvent(ma,cb)}$6d(){this.xi.RUf||(this.xi.RUf=!0,
this.Ld.raiseEvent("OnCommentRenderedOnce"))}}Object(e.a)(hm,"WordCommentEventsActor",null,[]);var Ag=c(1757);class bk{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(bk,"InitCommentSessionResult",null,[]);class kf extends bk{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(kf,"BeginDraftingHostResult",bk,[]);var rr=c(1983),Dj=c(1948),Io=c(1011);class lm{constructor(ma,cb,
zb,Wb,nc,Uc,Md,ge,Pd,te,Xe,Yf,Jg,$h,ei){this.taskManager=ma;this.tqa=cb;this.TCj=zb;this.lpo=Wb;this.z1e=nc;this.Nt=Uc;this.$s=Md;this.Hh=ge;this.X_=Pd;this.Bc=te;this.ij=Xe;this.wZ=Yf;this.xi=Jg;this.qKk=$h;this.oKk=ei;this.KVb=this.K5=this.Cm=null;this.AHj="WordWebCommitNewCommentActivity";this.BHj="WordWebCommitTaskActivity";this.xHj="WordWebCommentReactionActivity";this.HEg=null}get nja(){return this.K5}Xjn(ma){var cb;const zb=this.nja.Wy,Wb=this.K5.YP();if(Wb&&zb){const nc=Io.a.hfb(null!==(cb=
zb.authorId)&&void 0!==cb?cb:"");cb=new Ag.a(zb.authorId,zb.d_b,zb.author,null!==nc&&void 0!==nc?nc:"",!0);ma.author=cb;ma.insertIndex=Array.indexOf(Wb,zb);ma.authorName=zb.author;ma.authorIdentity="";return null}return qf.a.$C(-2130915320)}initialize(ma,cb,zb,Wb){this.Cm=ma;this.K5=cb;this.KVb=zb;this.HEg=Wb}beginDraftingAsync(ma){if(!ma)return new Promise((Wb,nc)=>{nc(qf.a.$C(-2130915327))});const cb=new kf,zb=yo.a.Gjf(ma.sessionType);return void 0===zb||null===zb?new Promise((Wb,nc)=>{nc(qf.a.$C(-2130915317))}):
new Promise((Wb,nc)=>{qf.a.g2(this.taskManager,()=>{if(1!==this.Cm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.Cm.mode),nc(qf.a.$C(-2130915325));else{this.Jqh();try{switch(zb){case 0:if(!this.Cm.Iba.hib()){nc(qf.a.$C(-2130915326));return}this.qKk.uPd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ma.draftId}`);this.Cm.xxb(ma);break;case 1:if(!ma.threadId||""===ma.threadId){nc(qf.a.$C(-2130915324));return}if(this.Nt.C6f){const ge=
this.K5.gD(ma.threadId);if(ge){const Pd=this.K5.wUh(ge,!1),te=rr.a.cCb(ge,Pd,ge.authorId===this.Nt.XX);te&&this.z1e.invoke(ma.threadId,te)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.Cm.mode)}this.Cm.addReply(ma.threadId,ma);break;case 3:if(!ma.threadId||""===ma.threadId){nc(qf.a.$C(-2130915324));return}var Uc=this.K5.gD(ma.threadId);if(!Uc){nc(qf.a.$C(-2130915323));return}this.Cm.editComment(Uc,ma);break;case 2:if(!ma.commentId||""===ma.commentId){nc(qf.a.$C(-2130915324));
return}const Md=this.K5.gD(ma.commentId);if(!Md){nc(qf.a.$C(-2130915323));return}this.Cm.editComment(Md,ma)}}catch(Md){nc(Md);this.SYi();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Md} on Session ${zb}`);return}(Uc=this.Xjn(cb))?nc(Uc):Wb(cb);this.SYi()}},ef.a.beginDraftingAsync)})}commit(ma,cb,zb){const Wb=this.nja.Wy;if(!Wb)throw qf.a.$C(-2130915320);var nc=Wb.Py;if(!nc)throw qf.a.$C(-2130915320);const Uc=yo.a.Gjf(nc.sessionType);if(void 0===Uc||null===Uc)throw qf.a.$C(-2130915317);
if(ma!==nc.draftId)throw qf.a.$C(-2130915327);let Md=!1,ge=!1;nc=!1;switch(Uc){case 3:if(!zb)throw qf.a.$C(-2130915327);break;case 0:this.ij.Sd(()=>{if(!this.Cm.Iba.hib())throw qf.a.$C(-2130915326);Wb.text=[cb];this.Cm.Tz&&!this.xi.vn?this.Cm.Lfn(()=>{this.Cm.pta(Wb);this.Cm.V$k(ma,Wb.id)}):this.Cm.pta(Wb);ge=zb&&null!=zb.Task;Md=this.Cm.Tz;qf.a.g2(this.taskManager,()=>{this.xmb(Wb.id)},ef.a.xmb)},"WESCA:C:C");break;case 1:this.ij.Sd(()=>{Wb.text=[cb];this.Cm.pta(Wb);ge=zb&&null!=zb.Task;Md=this.Cm.Tz},
"WESCA:C:R");break;case 2:this.ij.Sd(()=>{Wb.text=[cb];this.Cm.zdb(Wb);this.oOi(lk.a.wIm)},"WESCA:C:E");break;default:throw qf.a.$C(-2130915322);}zb&&(zb.Resolve&&(this.L4i(Wb,zb.Resolve.isResolved),zb.Resolve.isResolved&&!this.xi.vn&&this.Cm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),zb.Task&&this.Cm.QKk(Wb,zb.Task),zb.Reaction&&(nc=this.Nt.wKk,zb.Reaction.isActive?this.Cm.pud(Wb,zb.Reaction.reactionType):this.Cm.Z7d(Wb,zb.Reaction.reactionType)));this.Nt.IKk&&ge&&this.X_.execute(Pd=>Pd.logActivity(this.BHj,
"CommentsTasksFpsIsEnabled"));Md&&this.X_.execute(Pd=>{Pd.logActivity(this.AHj,"CommentsFpsIsEnabled")});nc&&this.X_.execute(Pd=>{Pd.logActivity(this.xHj,"CommentReactionsFpsIsEnabled")});return Wb.id}endCommentSession(ma){const cb=this.nja.Wy;if(cb){if(cb.Py&&cb.Py.draftId!==ma)throw qf.a.$C(-2130915327);if(cb.dr===ee.a.beingCreated)this.Cm.deleteComment(cb),!this.Cm.Tz||cb.Hf||this.xi.vn||this.Hh.Dg(cg.AFrame.So);else{if(3!==this.Cm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");
return}cb.dr=ee.a.normal;cb.KRa=Dj.a.succeeded;cb.Py=null;this.Cm.UZe()}}this.$s&&this.$s.updateCommandUI(!0);this.nja.oLd()||this.tqa.Scg(1,!this.Cm.mode)}deleteComment(ma){(ma=this.K5.gD(ma))?(this.Cm.deleteComment(ma),this.Cm.Tz&&!this.xi.vn?ma.Hf||this.Hh.Dg(cg.AFrame.So):this.Hh.qC(cg.AFrame.sr),this.lpo.V4f(ma)&&this.oOi(lk.a.qti)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ma){this.xmb(ma,0)}highlightComment(ma){this.Cm.Ebc(ma,0)}setThreadResolvedState(ma,
cb){(ma=this.K5.gD(ma))&&this.L4i(ma,cb)}L4i(ma,cb){if(ma.Hf&&""!==ma.Hf)throw qf.a.$C(-2130915321);this.Cm.Myb(ma,cb);cb&&!this.xi.vn&&this.Hh.Dg(cg.AFrame.So)}presentLinkToComment(ma){var cb=this.K5.gD(ma);cb?(cb=this.nja.EJd(cb))?(ma={["nav"]:btoa(`{"${Hg.a.comment}":${cb}}`),["mode"]:"copy"},this.oKk.logUserAction(lk.a.presentLinkToComment),this.Bc.Ub(pf.a.qua,2,ma)):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ma):a.ULS.sendTraceTag(578401558,
327,10,"[LinkToComment] Comment not found for Id {0}",ma)}selectFirstThreadInNextCommentContext(){this.Cm.w2i(0)}selectLastThreadInPreviousCommentContext(){this.Cm.ORn()}registerForCommentEvents(ma){const cb=this.nja.ahf(this.Nt.dNb&&this.Nt.Hq&&!this.xi.vn),zb=this.nja.TTa,Wb=this.nja.oLd(),nc=!this.Cm.mode;this.tqa.O0n();this.HEg.eKl().then(Uc=>{this.tqa.Yzn(ma,cb,Wb,nc,zb,Uc);this.tqa.Scg(Wb?5:1,nc);this.$s&&this.$s.updateCommandUI(!0)})}unregisterForCommentEvents(ma){this.tqa.Djc(ma)}registerForAction(ma,
cb){this.TCj.gRa(ma,cb)}unregisterForAction(){}checkAtMentionCapability(){return this.KVb?this.KVb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ma=>{ma(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}Jqh(){const ma=this.Cm.Tz&&!this.xi.vn?cg.AFrame.QL:cg.AFrame.sr;if(ma===cg.AFrame.sr){if(!this.xi.vn)return;Wg.UISurfaces.wu().then(cb=>
{cb.setSelectedTaskPane($g.a.Zzd);return null})}this.Hh.qC(ma)}xmb(ma,cb=1){this.Jqh();this.wZ.p2i(ma,Object.assign(new wi.a,{B8:cb,ZQ:1===cb}))}SYi(){this.Cm.Iba.ccb&&(this.Cm.Iba.ccb=!1)}oOi(ma){this.Bc.processAction(ma,2)}}Object(e.a)(lm,"WordEditorSharedCommentAPI",null,[193,194]);class hp{constructor(ma,cb,zb,Wb,nc,Uc,Md=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ma;this.parentId=cb;this.commentBody=
zb;this.author=Wb;this.date=nc;this.commentFlags=Uc;this.usersByReactionType=Md}}Object(e.a)(hp,"OfficeSharedCommentModel",null,[]);c(1602);class Yl{constructor(ma,cb){this.Ma=ma;this.y2a=cb;this.Rbh="AD";this.pnc=new O.a;this.kQe=new O.a;this.spk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.EEg=new dj.a}get userPrincipalName(){return this.Ma.lb("UserPrincipalName")}get Y3a(){return this.Ma.lb("PresenceProvider")}get XX(){return this.Ma.lb("PresenceUserId")}get Ji(){return this.y2a.value}SAi(ma){const cb=
this.spk.exec(ma);return cb?cb[1]:ma}q4h(ma,cb=!1){let zb=0;ma.done&&(zb=ma.Hf&&""!==ma.Hf?zb|4:zb|8);ma.Lwh&&(zb|=2);cb&&(zb|=1);this.V4f(ma)&&(zb|=16);ma.Swf&&(zb|=32);this.P6l(ma)||(zb|=128);return zb}P6l(ma){return ma?(ma=this.Ji.Db(ma.objectId))?ma.hasProperty(na.a.v6):!1:!1}V4f(ma){if(!ma)return!1;if(void 0===ma.authorId||null===ma.authorId||""===ma.authorId)return this.NCf(ma.id,ma.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.XX||null===this.XX||""===this.XX)return this.NCf(ma.id,
ma.objectId,"PresenceUserId null or empty"),!1;if(this.XX==ma.authorId&&ma.d_b==this.Y3a)return!1;const cb=this.dGd(ma.authorId),zb=this.dGd(this.XX);if(this.Y3a===this.Rbh&&cb&&zb&&cb[0]!=this.userPrincipalName&&cb[1]!=zb[1])return!0;this.NCf(ma.id,ma.objectId,"Unknown");return!1}isCurrentUser(ma){if(!ma||void 0===ma.authorId||null===ma.authorId||""===ma.authorId||void 0===this.XX||null===this.XX||""===this.XX)return!1;if(this.XX==ma.authorId&&ma.d_b==this.Y3a)return!0;ma=this.dGd(ma.authorId);const cb=
this.dGd(this.XX);return this.Y3a===this.Rbh&&ma&&cb?ma[0]==this.userPrincipalName||ma[1]==cb[1]:!1}dGd(ma){if(void 0===ma||null===ma)return null;ma=ma.split("::");return 3===ma.length?ma.slice(1,3):null}NCf(ma,cb,zb){ma&&!this.EEg.contains(ma)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${cb}; reason: ${zb}`),this.EEg.add(ma))}FQh(ma,cb){var zb;if(!ma)return null;const Wb=ma.FUd;let nc=!1;1===cb&&(nc=!0);cb=ma.author?this.SAi(ma.author):"";const Uc=Io.a.hfb(null!==
(zb=ma.authorId)&&void 0!==zb?zb:"");zb=new Ag.a(ma.authorId?ma.authorId:"",ma.d_b,cb,null!==Uc&&void 0!==Uc?Uc:"",this.isCurrentUser(ma));return new hp(ma.id?ma.id:"",ma.Hf?ma.Hf:"",ma.text&&ma.text.length?ma.text[0]:null,zb,ma.date||Wb?ma.date:new Date,this.q4h(ma,nc),this.s4h(ma.usersByReactionType))}apl(ma,cb,zb){const Wb=[],nc=new O.a;if(!ma)return Wb;for(const Uc of ma)Uc.dr!==ee.a.beingCreated&&zb(Uc)&&(Uc.id&&this.pnc.ub(Uc.id)?(ma=this.pnc.J(Uc.id),ma=this.ZUk(Uc,ma,cb),Wb.push(ma),nc.Z(Uc.id,
ma)):Uc.id?(ma=this.FQh(Uc,cb),Wb.push(ma),nc.Z(Uc.id,ma)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.pnc=nc;return Wb}Xul(ma,cb,zb){const Wb=[];for(const nc of ma)nc.dr!==ee.a.beingCreated&&zb(nc)&&(nc.id&&this.pnc.ub(nc.id)?Wb.push(this.pnc.J(nc.id)):nc.id&&Wb.push(this.FQh(nc,cb)));return Wb}ZUk(ma,cb,zb){var Wb=ma.FUd,nc=1===zb;zb=ma.Hf?ma.Hf:"";const Uc=ma.text&&ma.text.length?ma.text[0]:null,Md=ma.author?this.SAi(ma.author):"",ge=ma.authorId?ma.authorId:"",Pd=ma.d_b?
ma.d_b:"",te=Io.a.hfb(ge);Wb=ma.date||Wb?ma.date:new Date;nc=this.q4h(ma,nc);const Xe=this.isCurrentUser(ma),Yf=this.s4h(ma.usersByReactionType);return cb.parentId===zb&&cb.commentBody===Uc&&cb.author.DisplayName===Md&&cb.author.UserId===ge&&cb.author.Provider===Pd&&cb.author.IsCurrentUser===Xe&&cb.date===Wb&&cb.commentFlags===nc&&this.Wnk(cb.usersByReactionType,Yf)?cb:(cb=new Ag.a(ge,Pd,Md,null!==te&&void 0!==te?te:"",Xe),new hp(ma.id,zb,Uc,cb,Wb,nc,Yf))}Wnk(ma,cb){if(!ma&&!cb)return!0;if(!cb||!ma)return!1;
var zb=Object.keys(ma);if(zb.length!==Object.keys(cb).length)return!1;for(const Wb of zb){if(!(Wb in cb))return!1;zb=ma[Wb];const nc=cb[Wb];if(zb.length!==nc.length)return!1;for(let Uc=0;Uc<zb.length;Uc++)if(!this.Knk(zb[Uc],nc[Uc]))return!1}return!0}Knk(ma,cb){return ma||cb?ma&&cb&&ma.UserId===cb.UserId&&ma.Provider===cb.Provider&&ma.Email===cb.Email&&ma.DisplayName===cb.DisplayName&&ma.IsCurrentUser===cb.IsCurrentUser?!0:!1:!0}s4h(ma){if(!ma)return null;const cb={},zb=this.Ma.lb("PresenceUserId");
for(const nc of Object.keys(ma)){const Uc=[];var Wb=ma[nc];for(const Md of Wb){Wb=Md.UserId===zb;let ge;this.kQe.ub(Md.UserId)?(ge=this.kQe.J(Md.UserId),ge.IsCurrentUser=Wb):(ge=new Ag.a(Md.UserId,Md.Provider,Md.DisplayName,Md.Email,Wb),this.kQe.add(Md.UserId,ge));Uc.push(ge)}cb[nc]=Uc}return cb}}Object(e.a)(Yl,"WordEditorSharedCommentModelTranslator",null,[192]);class wq{constructor(){this.jn=null;this.L$c=this.P0g=this.jBg=this.Y7g=this.O$g=this.uXg=this.P2g=!1}r4h(){this.jn||(a.ULS.sendTraceTag(588292828,
327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.A7i());return this.jn}eKl(){return new Promise((ma,cb)=>{this.L$c?ma(this.I_h()):this.i4i().then(()=>{ma(this.I_h())}).catch(zb=>{cb(zb)})})}I_h(){this.L$c||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ma;ma=33;this.jBg&&(ma|=2);this.P2g&&(ma|=8);this.O$g&&(ma|=16);this.uXg&&(ma|=4);this.Y7g&&
(ma|=64);this.P0g&&(ma|=128);return ma}}Object(e.a)(wq,"OfficeSharedCommentsAppCapabilities",null,[871]);class sr extends wq{constructor(ma){super();this.bWa=null;this.lg=ma;this.X1n();this.A7i()}X1n(){this.Y7g=this.lg.NNb;this.O$g=!1;this.P0g=this.uXg=this.P2g=!0}initialize(ma){this.bWa=ma;this.i4i()}A7i(){this.jn={};this.jn.LivePersonaPicker="true";this.jn.PersonaColor="true";this.jn.DiscreteHostedComments=this.lg.K5k.toString();this.jn.NewCommentButton="true";this.jn.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+
this.lg.E5k;this.jn.CommentsFluentUI="true";this.jn.CommentTasks=this.lg.NNb.toString();this.jn.CommentTasksFromReply=this.jn.CommentTasks;this.jn.CommentsFluentUIV2="true";this.jn.CommentFriendlyTimestamps=this.lg.RJk.toString();this.jn.AtMentionFloodgateSurvey=this.lg.Qok.toString();this.jn.HyperlinksInComments="true";this.jn.NewModelState="true";this.jn.LogDraftCommentIdPair="true";this.jn.RichTextFormattingInWeb=this.lg.hyb.toString();this.jn.NoDiscardOnFocusLoss="true";this.jn.NewResolvedCardDesignInWeb=
"true";this.jn.RichContentEditIntegration="true";this.jn.HyperlinksWithDisplayText="true";this.jn.SmartReplies=this.lg.C6f.toString();this.jn.NewBorderAndFocusLookInWeb="true";this.jn.LinkToComment="true";this.jn.TaskPaneWithNewInfrastructure="true";this.jn.CommentReactions="true";this.jn.WebThemeIntegration="true";this.jn.NewSelectionInteractions="true";this.jn.QuillInitializationTelemetry="true";this.jn.PersonaIconImageForWeb="true";this.jn.HighlightsAndFontColorInWebComments="true";this.jn.TruncationUIWithReadMoreText=
"true";this.jn.CtrlEnterTip="true";this.jn.AtMentionHintMessage="true";this.jn.LivePersonaCardForWeb=this.lg.oEm.toString();this.jn.TaskHistoryRecordIDs=this.lg.hko.toString();this.jn.ContentNavigation=this.lg.contentNavigationApiEnabled.toString()}i4i(){return new Promise((ma,cb)=>{this.bWa?this.bWa.atMentionsEnabledAsync().then(zb=>{this.jBg=zb;this.L$c=!0;ma(this.L$c)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),
cb(qf.a.$C(-2130915320)))})}}Object(e.a)(sr,"WordSharedCommentsAppCapabilities",wq,[186]);class sp{constructor(){this._initialized=!1;this.HKk={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Fm.a.lcf,vetoPillar:7};this.oko={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:um.a.lcf,vetoPillar:7}}get J3a(){return null!=this.uug?this.uug:this.uug=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}kW(ma){this.J3a.kW(Yh.a.comments,ma,!0)}get name(){return"WordEditor.Comments"}xc(ma){this.W=
ma;this.kW("CPConfigStart");ma.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Me.a(v.Health.instance,new Ri.a,this.HKk)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();ma.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new Me.a(v.Health.instance,new Ri.a,this.oko)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();ma.ha("WordEditor.Comments.CommentNodeTracker",()=>new nf(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();
ma.ha("WordEditor.Comments.CommentsSettings",()=>new Hp(w.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new R.a(()=>V.App.xa.jb.Yc),new R.a(()=>Rk.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();ma.ha("WordEditor.Comments.CommentsState",()=>new gm.a).singleInstance();ma.ha("WordEditor.Comments.WordCommentEventsActor",()=>new hm(ma.Za("Box4.TrackChange.ITrackChangeManager"),
ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();ma.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Yl(w.AFrameworkApplication.K,new R.a(()=>V.App.xa.jb.Yc.Bd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();ma.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new uc(ma.resolve("WordEditor.Comments.CommentsSettings"),ma.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();
ma.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new xo(w.AFrameworkApplication.uc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();ma.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Tk(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();ma.ha("WordEditor.Comments.EditorCommentModel",Kj.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();
ma.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new Kf(new R.a(()=>V.App.xa.jb.Yc),new R.a(()=>Rk.a.instance),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.Comments.CommentsSettings"),ma.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ma.ha("WordEditor.Comments.ICommentFilterActor",()=>new de(ma.resolve("WordEditor.Comments.IEditorCommentModel"),
w.AFrameworkApplication.K,ma.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();ma.resolve("WordEditor.Comments.ICommentFilterActor");ma.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new yd(new R.a(()=>V.App.xa.jb.Yc),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.WordCommentEventsActor"),ma.resolve("Box4.INotebookManager").sl,N.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),
ma.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();ma.ha("WordEditor.Comments.CommentHighlightUtils",()=>new Al(ma.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();ma.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Bk(ma.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();ma.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new Ak(ma.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ma.resolve("WordEditor.Comments.CommentHighlightUtils"),w.AFrameworkApplication.ta.k0,w.AFrameworkApplication.ta.YGa,w.AFrameworkApplication.ya,w.AFrameworkApplication.uc,ma.resolve("WordEditor.Comments.CommentsState"),ma.Za("WordEditor.Comments.IEditorCommentManager"))).singleInstance();ma.ha("WordEditor.Comments.CommentHighlightActor",()=>new Sl(new R.a(()=>V.App.xa.jb.Yc.Bd),ma.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ma.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ma.Za("WordEditor.Comments.IEditorCommentManager"),N.a.instance,ma.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ma.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ma.resolve("WordEditor.Comments.CommentHighlightUtils"),ma.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();ma.ha("WordEditor.Comments.CommentHintActor",()=>new Ne(ma.resolve("WordEditor.Comments.CommentsSettings"),Vn.a.instance,zk.a.instance,
Lh.a.instance,w.AFrameworkApplication.ya,wn.TableCellReader.mrm,oe.moveToLastRenderedCellOfTheRow,new Gh.a,ma.Za("Box4.ContentControlConfigSettings"),ma.resolve("WordEditor.Comments.IEditorCommentModel"),ma.resolve("WordEditor.Comments.ICommentHighlightActor"),ma.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ma.resolve("WordEditor.Comments.CommentsState"),ma.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();
ma.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Mh(Vn.a.instance,zk.a.instance,Lh.a.instance,w.AFrameworkApplication.ya,ma.resolve("WordEditor.Comments.ICommentHintActor"),ma.Za("Common.IZoomManager"),ma.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance();ma.ha("WordEditor.Comments.ViewContainerAPI",()=>new Uj(w.AFrameworkApplication.ya,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();ma.ha("Common.Comments.CommentActivationManager",
()=>new rk).as("Common.Comments.ICommentActivationManager").singleInstance();ma.ha("Common.Comments.ViewContainerEventHost",()=>new Jj(w.AFrameworkApplication.uc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();ma.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new ld(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();ma.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new sr(ma.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.kW("CPConfigEnd")}init(){this.kW("CPInitStart");this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{try{this.$m(),this.kW("CPInitEnd")}catch(ma){throw a.ULS.oJ(524300632,
327,10,ma,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ma),this.J3a.Kv(Yh.a.comments,"CPInitException",ma,!0),ma;}})}$m(){const ma=this.W.resolve("WordEditor.Comments.CommentsSettings");this.kW("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new Xm(w.AFrameworkApplication.ya,w.AFrameworkApplication.ta.kA,w.AFrameworkApplication.ta.uy,w.AFrameworkApplication.ta.qp,w.AFrameworkApplication.ta.Bv,V.App.xa,Gl.a.instance,
this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),w.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ma,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();
this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new fk(w.AFrameworkApplication.ya,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").vlc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new lm(w.AFrameworkApplication.uc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),ma,V.App.xa,w.AFrameworkApplication.ta.qp,this.W.Za("Common.ISystemInitiatedFeedback"),w.AFrameworkApplication.ya,N.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();
cf.a.factory=Hm.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",Hm.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new Ie(this.W.resolve("WordEditor.Comments.CommentsState"),ma,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),w.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${Jk.AppFrame.jTa} .${Ei.a.a2b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),w.AFrameworkApplication.ta.qp)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const cb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),zb=cb.trackChangeInSidetrackEnabled;zb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").oTi(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));
this.W.ha("WordEditor.Comments.FloatingCommentManager",()=>new $b(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),w.AFrameworkApplication.uc,N.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ma,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),cb)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",
()=>zb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new ni(w.AFrameworkApplication.ya,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),gl.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
w.AFrameworkApplication.ta.qp,this.W.resolve("WordEditor.Comments.CommentsState"),ma,new R.a(()=>bc.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Za("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new ri(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ma,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),gl.getInstance(),V.App.xa.tq,w.AFrameworkApplication.ya,this.W.resolve("Common.IDynamicScriptLoaderProvider").pA,this.W.Za("WordEditor.Comments.ICommentRibbonCommandHandler"),w.AFrameworkApplication.ta.qp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Za("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Za("Common.App.SafeLinks.ISafeLinksManager"),this.W.Za("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),cb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new Nh(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ma,this.W.resolve("Common.Comments.ICommentPane"),new R.a(()=>V.App.xa.jb.Yc.Bd),w.AFrameworkApplication.ya,
new R.a(()=>bc.a.instance),ig.FocusManager.instance(),N.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");ma.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new Ec(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",()=>new Bb(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const Wb=ma.Hq,nc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");
nc&&Wb&&(this.W.resolve("WordEditor.Comments.CommentsState").Zbb=sp.aTh(),ma.oAb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Moa("OnCommentInit"));xd.a.ZLm();ma.uNc&&V.App.xa.jb.IJh();cf.a.instance&&(ma.oAb||gk.a.get_instance().al(4,()=>{this.e2m(Wb)},11).continueWith(()=>{this.adm()}),this._initialized=!0);this.eyn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}adm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Moa("OnCommentInit")}e2m(ma){ma||
this.u0l()}u0l(){const ma=sp.aTh();ma&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-w.AFrameworkApplication.tW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Moa("OnCommentInit",Object.assign(new Mf.a,{YEa:()=>{cf.a.instance.Iba.isVisible||w.AFrameworkApplication.ya.processAction(pf.a.iY,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").m2i(ma,Object.assign(new wi.a,{Z4f:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").logUserAction(pf.a.u1e))}eyn(ma,
cb,zb){ma&&ma.execute(Wb=>{Wb.a4(new Xc.a(cb,zb))})}dispose(){this._initialized&&(cf.a.instance&&cf.a.instance.dispose(),this._initialized=!1)}static aTh(){return w.AFrameworkApplication.K.lb("BootActivityNavigationId")}}Object(e.a)(sp,"PackageManager",null,[1,2]);const Lj=ma=>{const cb=K.a.instance.Za("Box4.IPackageBootPerfLogger"),zb=window.performance.now();cb.execute(Wb=>{Wb.Kv(Yh.a.comments,"CPMain",zb,!0)});z.a.instance.Kc(new sp,0,ma)};var Jo=c(1879);class Hn{isComment(ma){return mi.a.isComment(ma)}pSd(ma){return mi.a.pSd(ma)}nuf(ma){return mi.a.nuf(ma)}SKf(ma,
cb){mi.a.SKf(ma,cb)}WKf(ma,cb){mi.a.WKf(ma,cb)}H4e(ma){return mi.a.H4e(ma)}h3a(ma){return Rk.a.instance.h3a(ma)}deleteComment(ma,cb){mi.a.deleteComment(ma,cb)}fDd(ma,cb){mi.a.fDd(ma,cb)}Vlb(ma){mi.a.Vlb(ma)}taa(ma,cb,zb){return mi.a.taa(ma,cb,zb)}Bua(ma,cb,zb){return mi.a.Bua(ma,cb,zb)}Q5b(ma,cb){return mi.a.Q5b(ma,cb)}nKc(ma,cb,zb,Wb=null){return mi.a.nKc(ma,cb,zb,Wb)}SYb(ma,cb,zb,Wb){mi.a.SYb(ma,cb,zb,Wb)}oud(ma,cb,zb,Wb){return mi.a.oud(ma,cb,zb,Wb)}get aFb(){return mi.a.aFb}set aFb(ma){mi.a.aFb=
ma}y3a(ma,cb){mi.a.y3a(ma,cb)}U_c(ma){mi.a.U_c(ma)}XWf(ma){mi.a.XWf(ma)}CLd(ma,cb){return mi.a.CLd(ma,cb)}TKf(ma,cb){mi.a.TKf(ma,cb)}VKf(ma,cb){mi.a.VKf(ma,cb)}r0d(ma,cb,zb,Wb,nc,Uc){mi.a.r0d(ma,cb,zb,Wb,nc,Uc)}Caf(ma,cb){mi.a.Caf(ma,cb)}QYc(ma,cb,zb,Wb){return mi.a.QYc(ma,cb,zb,Wb)}UYc(ma,cb,zb,Wb){return mi.a.UYc(ma,cb,zb,Wb)}}Object(e.a)(Hn,"CommentEditorProxy",null,[184]);class mk{constructor(){this.W=null}get FNb(){return null!=this.Wwg?this.Wwg:this.Wwg=(()=>this.W.Za("WordEditor.ITableEditor"))()}get J3a(){return null!=
this.vug?this.vug:this.vug=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}kW(ma){this.J3a.kW(Yh.a.comments,ma,!0)}get name(){return"WordEditor.CommentsInteractive"}xc(ma){this.W=ma;this.kW("CIPConfigStart");ma.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new Hn).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.kW("CIPConfigEnd")}init(){this.kW("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m();this.kW("CIPInitEnd")})}$m(){this.W8l()}dispose(){}W8l(){Pj.a.hRa(mi.a.WKf);
Jo.a.evd(mi.a.TKf);Jo.a.FAc(mi.a.VKf);Jo.a.afk(mi.a.b2m);this.FNb.execute(cb=>{cb.MTe(mi.a.y3a)});const ma=V.App.kk.sl;ma.Xe(39).Ap(mi.a.SKf);Jo.a.jek(mi.a.g1m);Jo.a.aek(mi.a.y0m);Fi.a.isEnabled&&ma.Xe(12).Mv(mi.a.Zyj)}}Object(e.a)(mk,"PackageManager",null,[1,2]);const mo=ma=>{const cb=K.a.instance.Za("Box4.IPackageBootPerfLogger"),zb=window.performance.now();cb.execute(Wb=>{Wb.Kv(Yh.a.comments,"CIPMain",zb,!0)});z.a.instance.Kc(new mk,0,ma)};var Ro=c(1982),Kk=c(184),on=c(1617);class iq{constructor(ma,
cb,zb,Wb,nc,Uc,Md){this.jLa=ma;this.r$=cb;this.W5=zb;this.Zc=Wb;this.zNj=nc;this.BEe=Uc;this.Etb=Md;on.a.$ek((ge,Pd)=>{this.bdk(Pd.graphNode,Pd.DJk)});on.a.Bfk((ge,Pd)=>{this.hQk(Pd.graphNode,Pd.zHk)})}IKd(){var ma=this.zNj();const cb=this.Zc.Bk();cb.set(ma);if(this.r$.Xro(cb))return cb;cb.set(ma);Kk.PageNavigator.instance.EQ(cb);ma=this.W5.DXk(cb.currentNode);cb.Ii(ma);return cb}RMd(ma){const cb=this.IKd();let zb=null;this.r$.SHd(cb,Wb=>{this.W5.Q5h(Wb)===ma&&(zb=Wb);return!zb});return zb}M5h(ma){const cb=
this.IKd();let zb=null;this.r$.SHd(cb,Wb=>{this.W5.Y5b(Wb)===ma&&(zb=Wb);return!zb});return zb}Wti(ma,cb,zb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ma,cb,zb)}R5h(){const ma=this.IKd(),cb=[];this.r$.SHd(ma,zb=>{cb.push(this.W5.Q5h(zb));return!0});return cb}Xdb(ma,cb){if(!cb.length)return this.Etb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const zb=this.IKd(),Wb=Wn.a.create().toString(),
nc=new kh.a;for(let Uc of cb)nc.add(Uc),this.Wti(Uc.type,Wb,Uc.completion);cb=this.jLa.i1f(nc);this.W5.Xdb(zb.currentNode,Wb,ma,cb);this.BEe();return Wb}Se(ma){(ma=this.RMd(ma))?(this.W5.Se(ma),this.BEe()):this.Etb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}Y5b(ma){ma=this.RMd(ma);return ma?this.W5.Y5b(ma):(this.Etb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}N5h(ma){return this.W5.Y5b(ma)}P5h(ma){ma=
this.RMd(ma);if(!ma)return this.Etb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ma=this.W5.vmf(ma);return this.jLa.i2b(ma).toArray()}Vkk(ma,cb){if(!cb.length)return this.Etb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const zb=this.RMd(ma);if(!zb)return this.Etb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Wb=this.W5.vmf(zb),nc=this.jLa.i2b(Wb);
for(let Uc of cb)nc.add(Uc),this.Wti(Uc.type,ma,Uc.completion);ma=this.jLa.i1f(nc);ma!==Wb&&(this.W5.y1n(zb,ma),this.BEe());return!0}bdk(ma,cb){if(cb=this.M5h(cb)){const zb=this.Zc.Bk();zb.set(ma);this.W5.Xb(cb.clone(),this.W5.zcl(cb,zb))}}eSi(ma,cb,zb){if(cb.ub(ma))return cb.J(ma);const Wb=Wn.a.create().toString();cb.add(ma,Wb);zb&&this.Etb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Wb}hQk(ma,cb){const zb=new Ql.a;var Wb=
this.Zc.Bk();Wb.set(ma);Wb.Rb(38)&&this.r$.SHd(Wb,nc=>{const Uc=this.W5.Y5b(nc);void 0!==Uc&&null!==Uc&&zb.add(Uc,nc);return!0});for(let nc of cb)if(ma=null,({value:ma}=zb.Gc(nc.key,ma)).returnValue)if(nc.value===nc.key)ma=this.M5h(nc.key),this.W5.k2n(ma,parseInt(nc.key));else{ma=this.W5.vmf(ma);if(!ma||""===ma){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ma=this.jLa.i2b(ma);Wb=new Ja.a;for(let Uc=0;Uc<ma.length;Uc++){if(ma.J(Uc).commentId){const Md=
Number.parseInvariant(ma.J(Uc).commentId);cb.ub(Md)?ma.J(Uc).commentId=cb.J(Md).toString():ma.J(Uc).commentId=null}ma.J(Uc).recordId=this.eSi(ma.J(Uc).recordId,Wb,!1);-1===ma.J(Uc).type&&(ma.J(Uc).undoId=this.eSi(ma.J(Uc).undoId,Wb,!0))}this.Xdb(nc.value,ma.toArray())}}static yr(){return new iq(K.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),K.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new Gh.a,()=>V.App.xa.jb.Yc,()=>
{K.a.instance.Za("Common.Interface.IEditNotificationManager").execute(ma=>{ma.yEd()})},!0)}}Object(e.a)(iq,"TaskActor",null,[251]);var Ko=c(1097);class no{create(){return new Ko.a}}Object(e.a)(no,"TaskContentNodeFactory",null,[204]);var Wk=c(1031);class Zh{create(){return new Wk.a}}Object(e.a)(Zh,"TaskNodeFactory",null,[204]);class Ai{constructor(ma,cb,zb,Wb,nc,Uc){this.r$=ma;this.Ic=cb;this.Zc=zb;this.x4j=Wb;this.A4j=nc;this.zQb=Uc}nWk(ma,cb,zb){const Wb=this.A4j.create(1074135162);Wb.setValue(na.a.taskId,
ma);Wb.setValue(na.a.JNb,cb);Wb.setValue(na.a.Rxa,zb);return Wb}$5b(ma){const cb=this.Ic.Qc(4);cb.Eb(ma);this.zQb();return cb}Q5h(ma){return this.r$.iGb(ma)?ma.getValue(na.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}Y5b(ma){return this.r$.iGb(ma)?ma.hasProperty(na.a.JNb)?ma.getValue(na.a.JNb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}vmf(ma){return this.r$.iGb(ma)?ma.getValue(na.a.Rxa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}DXk(ma){if(7!==ma.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const cb=this.$5b(ma);try{const zb=this.x4j.create(1074135161),Wb=this.Zc.Bk();Wb.set(ma);Wb.d2(zb,38,Ai.dko);return zb}finally{cb&&cb.dispose()}}Xdb(ma,cb,zb,Wb){if(!this.r$.Nyf(ma))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const nc=this.$5b(ma);try{const Uc=this.nWk(cb,zb,Wb),Md=this.Zc.Bk();Md.set(ma);Md.d2(Uc,1,new la.a(Wn.a.vla(zb.toString()),1));return Uc}finally{nc&&
nc.dispose()}}Se(ma){if(this.r$.iGb(ma))if(ma.anchor&&ma.anchor.gr){var cb=ma.anchor.gr.Kr.node;if(this.r$.Nyf(cb)){var zb=this.$5b(cb);try{const Wb=this.Zc.Bk();Wb.set(cb);Wb.Ii(ma.anchor.node);Wb.Jg()}finally{zb&&zb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}y1n(ma,cb){if(this.r$.iGb(ma)){var zb=
this.$5b(ma);try{ma.setValue(na.a.Rxa,cb)}finally{zb&&zb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}k2n(ma,cb){if(this.r$.iGb(ma)){var zb=this.$5b(ma);try{const Wb=ma.hasProperty(na.a.JNb)?ma.getValue(na.a.JNb):null;void 0===Wb||null===Wb||Wb===cb?ma.Zg(na.a.JNb,cb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{zb&&zb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}zcl(ma,cb){if(!cb.Lq(38)){const zb=this.Zc.Bk();
zb.set(ma);zb.Ab(71);zb.kd(71);ma=Wa.a(zb.currentNode,ma.Hi().Jc,!0);cb.Qf(ma,38)}return cb.Rb(38)}Xb(ma,cb){if(this.r$.Nyf(cb)){var zb=this.$5b(cb);try{const Wb=this.Zc.Bk();Wb.set(cb);Wb.Qf(ma,1)}finally{zb&&zb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static yr(){return new Ai(K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new Oj.a,new Gh.a,new no,new Zh,()=>{Xg.App.Fn.jb.Yc.ZF.H$(10)})}}Ai.dko=new la.a(Wn.a.Gf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(Ai,"TaskEditor",null,[185]);class vm{constructor(ma,cb){this.Ex=ma;this.yVb=cb}iGb(ma){return!!ma&&72===ma.type}vxm(ma){return!!ma&&71===ma.ef}Nyf(ma){return!!ma&&71===ma.type}Xro(ma){ma.set(this.Ex.value);this.yVb.EQ(ma);return!!ma.Rb(38)}SHd(ma,cb){if(ma&&cb)if(this.vxm(ma))for(var zb=!0,Wb=ma.Rb(1);zb&&Wb;)this.iGb(Wb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Wb.type),zb=cb(Wb),Wb=ma.yf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ma.ef);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static yr(){return new vm(new R.a(()=>V.App.xa.jb.Yc),Kk.PageNavigator.instance)}}Object(e.a)(vm,"TaskNavigator",null,[183]);class Qm{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()})}dispose(){}xc(ma){this.W=ma;ma.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new Ro.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();
ma.ha("WordEditor.Tasks.TaskNavigator",()=>vm.yr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();ma.ha("WordEditor.Tasks.TaskEditor",()=>Ai.yr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();ma.ha("WordEditor.Tasks.TaskActor",()=>iq.yr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}$m(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(116)}}Object(e.a)(Qm,"TasksPackage",null,[1,2]);var ag=c(65),Yn=c(1614),Im=c(444),Oe=c(75);class pj{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)(pj,"TaskPaneGroupAppProps",null,[]);var kg=c(143);class Mj{static VKk(ma,cb){ig.FocusManager.zJ()&&(zk.a.instance.UAa(ma,cb,!1),kg.a.instance.UAa(ma,cb,!1),w.AFrameworkApplication.ta.Bv.uS(ma))}}Object(e.a)(Mj,"ReactTaskPaneManagerUtils",null,[]);var pn=c(117),dn=c(293);class Pn{constructor(){this.type=
null}}Object(e.a)(Pn,"SampleTaskPaneProps",null,[]);var Up=c(1615);class Xk{constructor(){this.entry=null;this.show=!1}}Object(e.a)(Xk,"AnimationBatchEntry",null,[]);var Zn=c(281),Bg=c(1113),Vp=c(103);class Ck{constructor(){this.C_g=[];this.D_g=[];this.ska={};this.uIa=this.tIa=null;this.Brd=!1;this.RY=null;this.Hod=this.kjd=0;this.Nlc=[];this.Jze=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Pb.Kib;this.ww=!1}initialize(){this.Brd=!1;(this.ww=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Pb.vX)&&
this.u5e()}w5e(ma,cb,zb,Wb){cb=this.TMd(cb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.u5e();const nc=document.createElement("div");nc.id=cb;nc.className=Ck.PFo;nc.style.width="0";this.Jze||(this.V$j(zb,cb,nc),this.ska[cb]=ma.w5e(cb,zb,Wb,nc));return nc}u5e(){this.Brd||this.g4n()}V$j(ma,cb,zb){let Wb=null,nc=null;0===ma?(Wb=this.tIa,nc=this.C_g):1===ma&&(Wb=this.uIa,nc=this.D_g);if(Wb){ma=!1;for(let Uc=0;Uc<nc.length;Uc++)if(!ma)nc[Uc]===cb&&(ma=!0);else if(nc[Uc]in this.ska){this.hhm(Wb,
zb,this.ska[nc[Uc]]);return}Wb.appendChild(zb)}}hhm(ma,cb,zb){ma.insertBefore(cb,zb.element)}U6k(ma){ma=this.TMd(ma);if(ma in this.ska){const cb=this.ska[ma];cb.element.parentNode.removeChild(cb.element);delete this.ska[ma]}}Wbj(ma){ma=this.TMd(ma);ma in this.ska&&(ma=this.ska[ma])&&!ma.isVisible&&(this.hbj(ma,!0),this.Zfh(ma.position,!0,this.Hoh(ma,!0)),1===ma.position&&1<I.a.count(this.ska)&&this.BOm())}t8l(ma){ma=this.TMd(ma);ma in this.ska&&(ma=this.ska[ma])&&ma.isVisible&&(this.hbj(ma,!1),this.Zfh(ma.position,
!1,this.Hoh(ma,!1)))}D1b(ma){if(this.RY)return this.RY;const cb=document.createElement("div");document.body.appendChild(cb);cb&&(this.RY=new Yn.a(cb,ma));return this.RY}hbj(ma,cb){ma.element&&(ma.isVisible=cb,this.Nlc.push(Object.assign(new Xk,{entry:ma,show:cb})));0===ma.position?this.kjd+=cb?1:-1:this.Hod+=cb?1:-1;1===this.Nlc.length&&window.setTimeout(Object(Rl.a)(this,this.hfo,"startPaneAnimation"),0);this.ww&&ma.element&&ma.element.parentNode&&(0===ma.position&&!this.kjd||1===ma.position&&!this.Hod?
(ma.element.parentNode.style.minHeight="0px",ma.element.parentNode.style.height="0px",ma.element.parentNode.style.overflow="hidden"):(ma.element.parentNode.style.minHeight="",ma.element.parentNode.style.height="",ma.element.parentNode.style.overflow=""))}hfo(){this.FFi();var ma=lb.where(lb.asEnumerable(this.Nlc),nc=>0===nc.entry.position),cb=lb.where(ma,nc=>!nc.show);if(lb.any(cb)&&lb.Ct(cb)!==lb.Ct(ma)){for(var zb of cb)zb.entry.element.style.width="0";ma=lb.where(ma,nc=>nc.show)}cb=lb.where(lb.asEnumerable(this.Nlc),
nc=>1===nc.entry.position);zb=lb.where(cb,nc=>!nc.show);if(lb.any(zb)&&lb.Ct(zb)!==lb.Ct(cb)){for(var Wb of zb)Wb.entry.element.style.width="0";cb=lb.where(cb,nc=>nc.show)}for(let nc of lb.concat(ma,cb))ma=nc.entry,Vp.WacAirSpace.BU(ma.element,Zn.a.K5f),Wb=new Bg.a(ma.element),nc.show?Wb.TUe(0,ma.width):Wb.TUe(ma.width,0),Vp.WacAirSpace.animate(Wb,null,null);this.Nlc.length=0}FFi(){}Hoh(ma,cb){let zb=ma.width;ma=0===ma.position?this.kjd:this.Hod;if(cb&&1===ma||!cb&&!ma)zb+=1;return zb}g4n(){this.Brd||
(this.tIa||(this.tIa=document.createElement("div"),this.tIa.id=Ck.NFo,this.tIa.className=Ck.Ssj,Sys.UI.DomElement.addCssClass(this.tIa,"alignLeft"),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Pb.H7&&Sys.UI.DomElement.addCssClass(this.tIa,"FlexBoxLayout"),this.Jze&&Sys.UI.DomElement.addCssClass(this.tIa,Ck.Qsj),this.Wdh(0,this.tIa)),this.uIa||(this.uIa=document.createElement("div"),this.uIa.id=Ck.OFo,this.uIa.className=Ck.Ssj,Sys.UI.DomElement.addCssClass(this.uIa,"alignRight"),w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Pb.H7&&Sys.UI.DomElement.addCssClass(this.uIa,"FlexBoxLayout"),this.Jze&&Sys.UI.DomElement.addCssClass(this.uIa,Ck.Qsj),this.Wdh(1,this.uIa)),this.IHi(this.tIa,this.uIa),this.Brd=!0)}IHi(){}XAa(ma,cb){Array.add(1===ma?this.D_g:this.C_g,cb)}TMd(ma){return ma+"-Entry"}BOm(){let ma=0;for(const cb of I.a.bO(this.ska)){const zb=Object(pd.a)(931,this.ska[cb]);zb&&zb.isVisible&&1===zb.position&&ma++}2===ma?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ma&&
a.ULS.sendTraceTag(595179605,320,50,ma+" simultaneous panes open")}}Ck.NFo="WACTaskPaneContainerLeft";Ck.OFo="WACTaskPaneContainerRight";Ck.Ssj="WACTaskPaneContainer";Ck.PFo="WACTaskPaneEntry";Ck.Qsj="WACReactTaskPaneContainer";Object(e.a)(Ck,"BaseTaskPaneManager",null,[932]);var So=c(404),In=c(312);class ip extends Ck{constructor(ma,cb){super();this.Buc=this.Auc=this.CQe=this.BQe=0;this.$Ph=()=>{Lc.InteractiveViewManager.instance.forEach(zb=>{zb.WHd()})};this.ga=ma;this.wPg=cb}Wdh(ma,cb){const zb=
V.App.xa.vC;zb.parentNode&&(ma?1===ma&&(this.ww?((ma=Object(In.a)("FarPane"))&&ma.appendChild(cb),cb.classList.add("regionComposer"),V.App.xa.eI.registerBoundingWindowRectsChanged("farPane",(Wb,nc)=>{"DP"===nc||3===nc?cb.classList.add("DL"):cb.classList.remove("DL")})):zb.parentNode.insertBefore(cb,zb.nextSibling)):this.ww?((ma=Object(In.a)("NearPane"))&&ma.appendChild(cb),cb.classList.add("regionComposer")):zb.parentNode.insertBefore(cb,zb))}Zfh(ma,cb,zb){this.ww||(cb=cb?zb:-zb,ma?this.Buc+=cb:this.Auc+=
cb)}FFi(){if(!this.ww){var ma=V.App.xa.vC;Vp.WacAirSpace.BU(ma,Zn.a.K5f);if(this.BQe!==this.Auc){const cb=new So.a(ma);cb.ujk(this.BQe,this.Auc,this.wPg);Vp.WacAirSpace.animate(cb,null,this.$Ph);this.BQe=this.Auc}this.CQe!==this.Buc&&(ma=new So.a(ma),ma.vjk(this.CQe,this.Buc,this.wPg),Vp.WacAirSpace.animate(ma,null,this.$Ph),this.CQe=this.Buc)}}}Object(e.a)(ip,"TaskPaneManager",Ck,[]);var Zl=c(333);class xn extends ip{get Zii(){null==this.dle&&(this.dle=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.dle}constructor(ma,cb){super(ma,cb);this.XV=Dd.KeyInputManager.lc(ag.a.xx,0);this.YV=Dd.KeyInputManager.lc(ag.a.xx,4);this.sJe=this.muc=null;this.CUg="AccCheckerTaskPane";this.sa=new da.a;this.isPaneOpen=!1;this.dle=this.Lte=null;this.XAa(0,"SampleTaskPane");this.XAa(0,Zl.a.ofb);this.XAa(1,Zl.a.Lok);this.XAa(1,"CustomTaskPane");this.XAa(1,Zl.a.ktf);this.XAa(1,cg.AFrame.sr);this.XAa(1,cg.AFrame.Obh);this.XAa(1,cg.AFrame.Jbh);this.XAa(1,Zl.a.cId);this.XAa(1,Zl.a.oGc);this.XAa(1,
Zl.a.YHc);this.TRj=(this.QAg=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Pb)&&w.AFrameworkApplication.ta.Pb.Nxf;this.YQj=Xg.App.rGb;this.eRj=this.QAg&&w.AFrameworkApplication.ta.Pb.PRc;this.initialize();ma.gb(lk.a.a6f,mh.a.application,xn.a6f,96)}get Z8d(){if(!V.App.xa||!V.App.xa.vC)return null;this.sJe||(this.sJe=new Yn.a(V.App.xa.vC,ig.FocusManager.instance()));return this.sJe}Wb(){}IHi(ma,cb){const zb=Im.a.instance,Wb=ig.FocusManager.instance(),nc=Oe.EventHandlerManager.instance,
Uc=this;Wg.UISurfaces.wu().then(Md=>{Uc.muc=Uc.D1b(Wb);let ge;Md.renderTaskPaneGroups(ma,cb,(ge=new pj,ge.middleContainer=V.App.xa.vC,ge.onTabStripFocus=()=>{Wb.qC(Zl.a.fic)},ge.onOpen=(Pd,te)=>{Uc.Oxf(Pd)&&Mj.VKk(Pd,te);nc.rSe(te,"focus",Uc.L3h(Pd,Wb),!0);var Xe=Uc.Gki(Pd),Yf=Md.selectors.getTabbedTaskPaneCount(Xe?1:2);Xe=Xe?Zl.a.zee:Zl.a.fic;1===Yf&&(zb.Csa(Xe),this.isPaneOpen=!0,this.JQi({isPaneOpen:this.isPaneOpen,MNb:te}));te=Uc.Sif(Pd);if(Yf=Wb.le(te))Yf.nEc=Xe,Uc.A8n(Pd)&&(Yf.Mr(Uc.XV),Yf.Mr(Uc.YV)),
zb.sji(te)&&zb.ex(te);this.Zii&&this.$Fd&&this.$Fd.Ew(!0)},ge.onClose=(Pd,te)=>{Uc.Oxf(Pd);const Xe=Uc.Gki(Pd),Yf=Xe?Zl.a.zee:Zl.a.fic;Md.selectors.getTabbedTaskPaneCount(Xe?1:2)||(zb.ex(Yf),this.isPaneOpen=!1,this.JQi({isPaneOpen:this.isPaneOpen,MNb:te}));nc.$Wf(te,"focus",Uc.L3h(Pd,Wb),!0);this.Zii&&this.$Fd&&this.$Fd.Ew(!0)},ge.setFocusCallback=(Pd,te)=>{Uc.Oxf(Pd)&&te&&(Pd=Wb.le(Uc.Sif(Pd)),Pd.pGk(),Pd.hea(te))},ge.onOverflowMenuOpen=()=>{if(Uc.muc)Uc.muc.onMenuOpen()},ge.onOverflowMenuClose=
()=>{if(Uc.muc)Uc.muc.onMenuClose()},ge.onShow=(Pd,te)=>{2===te&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Wb.Dg(Pd)},0)})},ge.onHide=(Pd,te,Xe)=>{Xe&&1!==te&&Wb.Dg(Wb.QS)},ge.onResizeStart=()=>{if(V.App.xa&&(V.App.xa.vC.className=Jk.AppFrame.Ceg,Uc.Z8d))Uc.Z8d.onMenuOpen()},ge.onResizeEnd=()=>{if(V.App.xa&&(pn.a.Tmi()||(V.App.xa.vC.className+=" "+V.App.xa.Zph),Uc.Z8d))Uc.Z8d.onMenuClose()},ge));this.Wha(Zl.a.fic,Wb,cb,Uc);this.Wha(Zl.a.zee,Wb,ma,Uc);return null})}Wha(ma,cb,zb,Wb){const nc=
cb.le(ma);nc.parent=cg.AFrame.Hp;nc.BK=!0;zk.a.instance.UAa(ma,zb,!1);kg.a.instance.UAa(ma,zb,!1);ma=new dn.DOMFocusListing(()=>zb);ma.Go(3);ma.Go(2);ma.Go(4);ma.Go(1);cb.Wka(()=>zb,nc,ma).HX=!0;nc.Mr(Wb.XV);nc.Mr(Wb.YV)}Sif(ma){return ma===this.CUg?Zl.a.Uah:ma}L3h(ma,cb){return()=>{cb.qC(this.Sif(ma))}}A8n(ma){return ma===this.CUg?!1:!0}Aom(ma){return ma===Zl.a.ofb}Oxf(ma){return this.Aom(ma)||ma===Zl.a.Uah||0<=ma.indexOf("AppForOfficePanel")||ma===Zl.a.cId||ma===Zl.a.ktf&&this.TRj||ma===Zl.a.oGc&&
this.YQj||ma===Zl.a.YHc&&this.eRj||ma===Up.a.JBb?!0:!1}Gki(ma){return ma===Zl.a.ofb||"SampleTaskPane"===ma}static BWl(){return new xn(w.AFrameworkApplication.ya,w.AFrameworkApplication.isRtl)}static a6f(ma,cb,zb,Wb,nc){if(1===zb)return 32;Wg.UISurfaces.wu().then(Uc=>{Uc.showTaskPane(nc,Object.assign(new Mc.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Pn,{type:"SampleTaskPaneProps"})}));return null});return 32}ILa(ma){this.sa.addHandler("onPaneToggle",ma)}r0c(ma){this.sa.removeHandler("onPaneToggle",
ma)}JQi(ma){this.sa.raiseEvent("onPaneToggle",ma)}get $Fd(){this.Lte||(this.Lte=K.a.instance.Pa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.Lte}}Object(e.a)(xn,"TaskPaneManager",ip,[187]);class Ip{constructor(){this.pS=null}get name(){return"WordEditor.TaskPaneManager"}xc(){}init(){this.pS=xn.BWl();this.pS.Wb();V.App.xa.LNb=this.pS}dispose(){}}Object(e.a)(Ip,"PackageManager",null,[1,2]);c.d(L,"a",function(){return l})},1879:function(D,L,c){D=c(0);var l=c(1127),e=c(22),a=c(2),
k=c(729),m=c(171),w=c(69),v=c(55),r=c(7),z=c(45),A=c(17),G=c(8),H=c(52),I=c(82),K=c(441),F=c(37),J=c(445),N=c(5),O=c(596),M=c(203),T=c(99),R=c(230),W=c(20),V=c(1081),ba=c(40),ha=c(94),ca=c(43),ia=c(772),ra=c(32),da=c(89),za=c(21),la=c(58);class na{constructor(Xa,Va,Gb,Xb){this.qDd=this.oDd=null;this.t4c=Xa;this.Lee=Va;this.fdj=Gb;this.gdj=Xb}}Object(D.a)(na,"TableSimplificationInformation",null,[]);var Ca=c(91),Na=c(36),Ta=c(476),Fa=c(256),qa=c(914),ja=c(1529),X=c(299),ua=c(3),Ha=c(11),Ea=c(139),
wa=c(19),sa=c(270),fa=c(38),Ma=c(288),Ua=c(10),Qa=c(645),Ja=c(570),Wa=c(359);class Ya extends Sys.EventArgs{constructor(Xa){super();this.Ko=Xa}}Object(D.a)(Ya,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var sb=c(1713);class ob extends sb.a{constructor(Xa,Va,Gb,Xb){super(Xa,Va,{});this.ORa=[];for(Xa=0;Xa<Gb.length;Xa++)this.ORa.push(...Gb.J(Xa).toArray());this.SBa=0;this.mx=Xb;this.Ko={}}}Object(D.a)(ob,"BasicInternalCopyArguments",sb.a,[]);class fc extends Sys.EventArgs{constructor(Xa,Va){super();
this.Ko=Va;this.ORa=[];for(Va=0;Va<Xa.length;Va++)this.ORa.push(...Xa.J(Va).toArray())}}Object(D.a)(fc,"BeforeCopyArguments",Sys.EventArgs,[]);class Eb extends Sys.EventArgs{constructor(Xa){super();this.Ko=Xa}}Object(D.a)(Eb,"BeforePasteArguments",Sys.EventArgs,[]);class Ib extends Sys.EventArgs{constructor(Xa,Va,Gb,Xb){super();this.paragraph=Xa;this.cpBegin=Va;this.cpEnd=Gb;this.Ko=Xb}}Object(D.a)(Ib,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var Nb=c(1755),pb=c(1756);class Aa{constructor(Xa,
Va,Gb,Xb,rc,qb,Zb,Rb,Ra){this.iic=Xa;this.source=Va;this.target=Gb;this.wOf=Xb;this.rowIndex=rc;this.xo=qb;this.CYa=Zb;this.XKi=Rb;this.ye=Ra}}Object(D.a)(Aa,"CoreInternalTablePasteArguments",null,[]);class xb extends Sys.EventArgs{constructor(Xa,Va,Gb,Xb,rc){super();this.operation=Xa;this.FIi=Va;this.original=Gb;this.clone=Xb;this.Ko=rc}}Object(D.a)(xb,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);c.d(L,"a",function(){return gb});class gb{constructor(Xa,Va,Gb,Xb,rc,qb,Zb,Rb,Ra,ab,fb,bb,Ub,Oa,Fc){this.fW=
this.Ys=null;this.vEe=!1;this.kL=this.qza=null;this.cVb=qb;this.so=Zb;this.Gj=Xa;this.KNe=Va;this.TJ=Gb;this.Bh=Xb;this.ZH=rc;this.Ma=Rb;this.Ic=ab;this.dtd=Ra.create(2097162);this.fWf(this.dtd);this.Hse=Ra.create(2097162);this.fWf(this.Hse);this.EQe=Ra.create(2097162);this.fWf(this.EQe);this.Nrd=this.dtd;this.AY=fb;this.V1=bb;this.Ud=Ub;this.Fl=l.a.getInstance(Wa.a.xYa);this.Nxc=Oa;this.j1j=Oa.substr(0,3);this.v5=Fc}get paragraphEditor(){return null!=this.Uug?this.Uug:this.Uug=e.a.instance.resolve("Box4.IParagraphEditor")}get $b(){return null!=
this.Pog?this.Pog:this.Pog=e.a.instance.Pa("Box4.IFeatureHelper")}get dv(){return this.Ys?this.Ys.dv:0}get jzb(){return this.Ys.kb.jzb}get hua(){return this.Ys.kb.hua}get pia(){return this.Nrd}get Lhj(){return this.EQe}get E2e(){return this.Ys.YI&&!this.vEe}z8i(){this.vEe=!0}get iIi(){return!this.Ys.YI}get Upa(){return Qa.a.instance}get ztm(){return this.Ma.$("InternalPasteTableWithReplacingCellIsEnabled")}fWf(Xa){var Va=new qa.a(-1);this.cVb.sl.FLa(Va);const Gb=new N.GraphIterator;Gb.set(Va);a.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");
Va=3;this.Ma&&this.Ma.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(Va=0);Va=this.Ic.Qc(Va);Va.ev(Gb);Gb.Qf(Xa,80);Va.dispose()}gBd(Xa,Va=null){Xa=Xa.Bb;this.Ys=Xa.hb.clone();this.vEe=!1;Xa=N.GraphIterator.$a(Xa.m0);const Gb=N.GraphIterator.$a(this.pia),Xb=this.Ic.Qc(3,ua.a.internalCopy);Xb.ev(Gb);Xa.Rb(82);do Xa.currentNode.aPb(null);while(Xa.yi(82));Xa=new k.a(Va,Object(H.a)(this,this.OFk,"clearInternalClipboard"),new ob(Xa,Gb,this.Ys,Xb));Xa.il("InternalCopy");Xa.wg=!Va||Va.wg;Xa.run()}OFk(Xa,
Va){m.a.mark(5566);Va=Va.target;if(Va.Vd())return Va.Jg(),!0;Xa.Qh(Object(H.a)(this,this.fIc,"executeCopy"));return!0}fIc(Xa,Va){Va=new Nb.a(Va,null);const Gb=new k.a(Xa,Object(H.a)(this,this.NEc,"coreCopySetup"),Va);Gb.il("ExecuteCoreCopyToInternalClipboard");this.Lln(Va);Gb.run();Xa.Qh(Object(H.a)(this,this.Rpo,"trimNewText"));return!0}NEc(Xa,Va){if(!Va.source.Vd())return Va.Ki&&(Va.Ki.Lyd=null),G.ULS.shipAssertTag(6305560,307,!1),this.Fl.logKpiFailure({kpiName:Wa.a.gyd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Xa.Qh(Object(H.a)(this,this.cyh,"coreCopyIteration"));return!0}cyh(Xa,Va){const Gb=Va.insertAfter,Xb=Va.source,rc=Va.target,qb=Xb.currentNode;var Zb=this.iIi;if(!qb.jga)return Xa.Qh(Object(H.a)(this,this.MEc,"coreCopyIncrement")),!0;Va.Ki.BMb&&(Va.BMb=!0);if(!this.xDk(Va))return Va.Eia.XDa.c++,Xa.Qh(Object(H.a)(this,this.MEc,"coreCopyIncrement")),!0;if(!Va.BMb&&(qb.q3b()&&Va.Eia.XDa.c++,qb.q3b()||Zb&&!qb.Hib(this.dv)))return Xa.Qh(Object(H.a)(this,this.MEc,"coreCopyIncrement")),!0;if(!Va.BMb&&
Zb&&!qb.lz)return Xb.$z()&&(Va.$he=!0,Va=new k.a(Xa,Object(H.a)(this,this.NEc,"coreCopySetup"),new Nb.a(Va,Gb)),Va.il("RecursiveCoreCopyToInternalClipboard"),Va.run()),Xa.Qh(Object(H.a)(this,this.MEc,"coreCopyIncrement")),!0;Zb=rc.currentNode.Hi().Bd;Zb=O.a(qb,Zb,!0);Zb.kib=!0;this.Upa.v7d(Va.Eia.DDb,Zb);rc.nH(Zb,Gb,18===Xb.parentNode.type?1:Xb.role);rc.Ii(Zb);Va.insertAfter=Zb;Ua.ParagraphReader.ic(Zb)&&(this.Yln(Xa,Object(H.a)(this,this.NEc,"coreCopySetup"),qb,Zb,Va),this.Xln(Xa,qb,Zb));this.wKh(qb,
Zb);Xb.$z()&&(G.ULS.shipAssertTag(6305562,307,!Va.$he),Va=new k.a(Xa,Object(H.a)(this,this.NEc,"coreCopySetup"),new Nb.a(Va,null)),Va.il("RecursiveCoreCopyToInternalClipboard"),Va.run());Xa.Qh(Object(H.a)(this,this.jQk,"coreCopyIterationPostProcessing"));return!0}jQk(Xa,Va){var Gb=Va.source;const Xb=Va.target;var rc=Xb.currentNode,qb=Gb.currentNode;Ua.ParagraphReader.rh(Xb)&&(Va.mPf[qb.id.toString()]=rc);if(Ua.ParagraphReader.ic(rc)){if(0<Ua.ParagraphReader.l5h(qb))if(0<this.so.QF(qb).yt)qb.setValue(r.a.GQa,
0);else{const Zb=this.so.Z2(qb).yt;this.paragraphEditor.Vp.jca(rc,Zb)}if(!this.hQc&&this.v5.YKi){Gb.qc();if(!fa.TableReader.Jw(Xb)&&Gb.rEa&&!this.hua)for(const Zb of this.v5.oPf)rc.removeProperty(Zb);Gb.Ii(qb)}}if(Ua.ParagraphReader.ic(rc)){for(qb=0;qb<rc.wordRunProperties.length;qb++)rc.wordRunProperties.Sq.Z(qb,Ma.CharacterPropertiesEditor.IQ),rc.wordRunProperties.rt.Z(qb,Ma.CharacterPropertiesEditor.hU);G.ULS.shipAssertTag(6305565,307,!!Ha.App.yd);(this.Ud.zg||F.a.instance.J(3)&&Ha.App.Bw.ejc)&&
rc.setValue(r.a.BFb,!0);rc.Ng(r.a.rBb,r.a.eKi,r.a.gPf);F.a.instance.J(3)&&Ua.ParagraphReader.ic(rc)&&rc.Ng(r.a.lPa)}this.iIi&&(this.vKh(Xb),fa.TableReader.isTable(Xb)&&(rc=this.Ys.HN(),rc.moveNext(),(rc=ra.TableCellReader.TCa(Gb,rc.current.node))||(rc=new ia.a(0,0)),Gb=new na(rc,Xb,fa.TableReader.tfa(Gb),fa.TableReader.emf(Gb)),this.KNe.value.IKn(Gb)));ca.OutlineElementReader.Oh(Xb)&&!Xb.Lq(2)&&(this.Bh.GN(Xb),Xb.qc());Xb.qc();Va.Ki&&(Va.Ki.Lyd=Va.insertAfter);Xa.Qh(Object(H.a)(this,this.MEc,"coreCopyIncrement"));
return!0}MEc(Xa,Va){Va.$he&&(Va.insertAfter=Va.Lyd,Va.$he=!1);if(!Va.source.ht()){Va.Ki&&(Va.Ki.Lyd=Va.insertAfter);const Gb=Va.source;11!==Gb.ef||Gb.ALc(-1)||this.zmn(Xa,Gb.currentNode,Va.target.currentNode,Va);return!1}Xa.Qh(Object(H.a)(this,this.cyh,"coreCopyIteration"));return!0}xDk(Xa){const Va=Xa.source;if(ca.OutlineElementReader.Oh(Va)&&Va.bhb(12)){const Gb=Va.Vd();if(Ua.ParagraphReader.ic(Gb)&&Gb.ia(r.a.EM,null))return Va.qc(),Xa.BMb=!1;Va.qc()}else if(Ua.ParagraphReader.ic(Va.Hn)&&Va.Hn.ia(r.a.EM,
null))return!1;return!0}Xln(Xa,Va,Gb){Va=Ca.e(Va);Gb=Ca.e(Gb);for(let Xb=0;Xb<Va.length;Xb++)Va[Xb].xKf(Gb[Xb],Xa,Object(H.a)(this,this.NEc,"coreCopySetup"))}Rpo(Xa,Va){if(Va.SBa>=Va.ORa.length)return gb.sa.raiseEvent("AfterTrimCompleteOnCopy",new Ya(Va.Ko)),Xa.Qh(Object(H.a)(this,this.iQk,"copyTeardown")),!0;Xa=Va.ORa[Va.SBa];var Gb=Xa.node,Xb=Xa.cpBegin;let rc=Xa.cpEnd;if(!wa.SelectionEditor.Xu(Xa))if(!Va.SBa&&wa.SelectionEditor.Dk(Xa))rc=Xb=Ua.ParagraphReader.textLength(Gb);else if(Ua.ParagraphReader.em(Xa))Xb=
0,rc=Ua.ParagraphReader.textLength(Gb);else if(wa.SelectionEditor.Paa(Xa)){G.ULS.shipAssertTag(6305568,307,!Va.SBa);var qb=N.GraphIterator.$a(Gb);Xb=qb.Ab(12);G.ULS.shipAssertTag(6305569,307,Xb);Gb=qb.origin;rc=Xb=Ua.ParagraphReader.textLength(Gb)}else{if(ha.OutlineReader.cUd(Xa))for(Xa=M.a.Dp(Xa.node);Xa.moveNext();)qb=Xa.currentNode,Ua.ParagraphReader.ic(qb)&&Va.ORa.push(Na.a.createTextRange(qb,0,Ua.ParagraphReader.textLength(qb)));Va.SBa++;return!0}qb=Va.mPf[Gb.id.toString()];G.ULS.shipAssertTag(6305570,
307,!!qb);if(!qb)return G.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Va.SBa,["SelectedContextsLength"]:Va.ORa.length,["SelectedNodeType"]:Gb.type,["ContextId"]:Xa.contextId}),Va.SBa++,!0;Gb=Ca.e(qb);let Zb,Rb=!1;for(Zb=Gb.length-1;0<=Zb;Zb--)if(!Gb[Zb].tBa)if(4===Gb[Zb].li)Gb[Zb].Nb.blob=null,Gb[Zb].Nb.blob=new Ta.a(Gb[Zb].Nb),Va.Eia.XDa.e++;else{Gb[Zb].Nb.blob=null;if(-1!==Gb[Zb].Je){var Ra=Gb[Zb].Nb.formatting,ab=void 0,fb=void 0;Ra&&-1===Ra.Je?(fb=Gb[Zb].Je+
1,ab=Gb[Zb].K3-1,Ra.Je=Gb[Zb].Je):(ab=Gb[Zb].K3,fb=Gb[Zb].Je);for(Ra=0;Ra<ab;Ra++)qb.wordRunProperties.removeAt(fb,16);0<ab&&(Rb=!0)}ab="";X.f(Gb[Zb])?(ab=" ",Va.Eia.XDa.f++):X.g(Gb[Zb])&&(fb=X.b(Gb[Zb]))&&(ab=X.a(fb),Va.Eia.XDa.g++);fb=Gb[Zb].Nb.cp;fb>=Xb&&fb<rc&&(gb.characterPropertiesEditor.replaceTextRange(Na.a.createTextRange(qb,fb,fb+1),ab,void 0,void 0,void 0,void 0,!0),rc=rc-1+ab.length,Va.Eia.XDa.i++)}Rb&&qb.Cn();this.rEn(qb);gb.sa.raiseEvent("BeforeTrimOnCopy",new Ib(qb,Xb,rc,Va.Ko));Gb=
Ua.ParagraphReader.textLength(qb);rc<Gb&&gb.characterPropertiesEditor.replaceTextRange(Na.a.createTextRange(qb,rc,Gb),"",void 0,void 0,void 0,void 0,!0);0<Xb&&gb.characterPropertiesEditor.replaceTextRange(Na.a.createTextRange(qb,0,Xb),"",void 0,void 0,void 0,void 0,!0);this.J1l(qb,Va.Eia.XDa);Ua.ParagraphReader.textLength(qb)||Va.SBa!==Va.ORa.length-1||!wa.SelectionEditor.Xu(Xa)||qb.Ms||(Xa=N.GraphIterator.$a(qb),Xa.Ab(25)&&(ba.OutlineElementNavigator.$d(Xa),this.Bh.KZa(Xa),Va.SBa&&(this.Ys.kb.hua=
!0)));this.$b.isFeatureEnabled(88)&&Va.SBa==Va.ORa.length-1&&!this.hua&&qb.Ng(z.a.Y3,z.a.Lba,z.a.toa,z.a.Ewa,z.a.h8);this.Upa.w_c(Va.Eia.J3d,Va.Eia.Syb,Va.Eia.Jcb,qb);Va.SBa++;return!0}rEn(Xa){if(Xa=Xa.qa){var Va=new I.a;for(let Gb=0;Gb<Xa.length;Gb++){const Xb=Xa.J(Gb);Xb.xj&&Va.add(Xb)}for(const Gb of Va)Gb.xj=null}}iQk(Xa,Va){this.pia.aPb(null);Va.mx.dispose();m.a.mark(5567);this.zYm();this.fW=Va.Eia;this.hti("Copy");this.tlm&&G.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get tlm(){return!N.GraphIterator.$a(this.pia).Vd()}srj(){this.Nrd=
this.EQe}rrj(){this.Nrd=this.dtd}KCo(){this.Nrd=this.Hse}get mym(){return this.pia===this.dtd}get Bnm(){return this.pia===this.Hse}Fsh(){const Xa=N.GraphIterator.$a(this.pia);for(;Xa.Vd();)Xa.Jg()}hti(Xa){const Va=this.fW.XDa.b;Xa+="-"+Va;this.fW.XDa.b=Xa;this.fW.DDb.b=Xa;this.fW.J3d.b=Xa;this.fW.Syb.b=Xa;this.fW.Jcb.b=Xa;this.Upa.uKm(this.fW.XDa);this.Upa.xCf(this.fW.DDb);this.Upa.gui(this.fW.J3d);this.Upa.lCf(this.fW.Syb);this.Upa.jCf(this.fW.Jcb);this.fW.XDa.b=Va;this.fW.DDb.b=Va;this.fW.J3d.b=
Va;this.fW.Syb.b=Va;this.fW.Jcb.b=Va}UKi(Xa,Va,Gb,Xb,rc=null,qb=null){this.hti("Paste");Va=N.GraphIterator.$a(Va);const Zb=N.GraphIterator.$a(this.pia);var Rb=null;rc&&(Rb=new J.a(ha.OutlineReader.mDh,ha.OutlineReader.s0k),Rb=rc.equals(new J.a(-1,-1))?new J.a(0,0):rc.Zde(Rb));if(this.gfi())if(Zb.Vd(),W.ImageReader.Wu(Zb.currentNode))rc=Zb.currentNode,Zb.qc(),Zb.nH(this.Bh.Izb(),null,1),Zb.Vd(),Zb.nH(rc,null,2),Zb.qc(),Zb.Ii(rc),Zb.Jg(),this.z8i();else if(R.isFloatingEmbeddedFileNode(Zb.currentNode)){rc=
Zb.currentNode;Zb.qc();Zb.nH(this.Bh.Izb(),null,1);Zb.Vd();var Ra=this.Bh.GN(Zb);Ra=Na.a.Uc(Ra,0);gb.characterPropertiesEditor.replaceTextRange(Ra,"<<"+R.getEmbeddedFileName(rc)+">>",void 0,void 0,void 0,void 0,!0);Zb.qc();Zb.qc();Zb.Ii(rc);Zb.Jg();this.z8i()}this.AY&&this.AY.rxf(Gb)||!this.ztm||!this.Qoi(Zb,Va)?(m.a.mark(5564),Zb.currentNode.aPb(null),Xa={},Xa[gb.rrf]=Xb,T.ListReader.E7(Gb)&&(Xa[V.a.mfi]=!0),Gb=new pb.a(Zb,Va,Gb,Rb,Xa),Xb=new k.a(qb,Object(H.a)(this,this.PEc,"corePasteSetup"),Gb),
Xb.il("ExecuteCorePasteFromInternalClipboard"),Xb.wg=!qb||qb.wg,this.Mln(Gb),Xb.run()):(Zb.currentNode.aPb(null),G.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.pIn(qb,Zb,Va,Rb,Xa),G.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}ooi(Xa){if(Xa&&Xa.isValid){const Va=N.GraphIterator.$a(this.pia);return this.Qoi(Va,Xa)}return!1}Qoi(Xa,Va){if(ra.TableCellReader.Gna(Va)&&1===Xa.Sp()){Xa.Rb(1);if(ca.OutlineElementReader.Oh(Xa)){ba.OutlineElementNavigator.Ee(Xa);
if(fa.TableReader.isTable(Xa)){fa.TableReader.YA(Xa.currentNode)&&G.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(Va.Ab(14)&&!fa.TableReader.YA(za.getContainingTable(Va))){if(G.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.$T)return!0}else if(G.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.hQc&&!this.$T)return!0;if(this.$T)return!0}ba.OutlineElementNavigator.$d(Xa)}Xa.qc()}return!1}pIn(Xa,Va,Gb,Xb,rc){let qb,Zb;
let Rb;Object(v.a)("ReplaceTableCellsFromClipboardTable",!0);Gb.Ab(14);qb=la.a.Ar(Gb);Zb=da.a(Gb);Gb.kd(14);var Ra=fa.TableReader.$f(Gb.currentNode);Rb=fa.TableReader.Wg(Gb.currentNode);const ab=fa.TableReader.$f(Va.currentNode),fb=fa.TableReader.Wg(Va.currentNode);G.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",Ra,Rb,ab,fb,qb,Zb);if(this.$T&&sa.TableBorderSelectionCache.PMc())this.j2n(),Ra=Math.min(this.Zee+
1,Ra),Rb=Math.min(this.y9f+1,Rb),this.y9f-this.bko==Rb-1&&(this.Wgj==this.Zee?Zb=0:this.Zee-this.Wgj==Ra-1&&(Gb.Vd(),qb=la.a.Ar(Gb),Zb=da.a(Gb)));else{this.qza=Ja.a.m5b;const bb=qb+ab-Ra;0<bb&&(za.moveToLastRow(Gb),G.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+bb),this.KNe.value.insertRows(Gb,!1,bb,this.qza),G.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Gb.kd(14));const Ub=Zb+fb-Rb;if(0<Ub){G.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Ub);try{this.KNe.value.insertColumns(Gb,
Rb,!1,Ub,this.qza)}catch(Oa){throw G.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Oa.toString()),Oa;}G.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<bb||0<Ub)&&Object(v.a)("InsertRowsAndColumnsForInternalCCP",!0)}Ra=this.Ivl(Ra,Rb,ab,fb,qb,Zb);G.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Xa=new k.a(Xa,Object(H.a)(this,this.zfn,"pasteTableOperationRun"),new Aa(null,Va,Gb,Xb,qb,Zb,Ra,null,rc));Xa.il("ExecuteCorePasteTableInTable");Xa.wg=!1;Xa.run()}zfn(Xa,
Va){if(Va.iic){if(Va.iic.inProgress)return!0;ra.TableCellReader.isTableCell(Va.source)||Va.source.kd(16);if(this.eWm(Va))return!1}else fa.TableReader.isTable(Va.target)||Va.target.kd(14),fa.TableReader.isTable(Va.source)||Va.source.kd(14),za.moveToCell(Va.target,Va.rowIndex,Va.xo),za.moveToCell(Va.source,0,0);if(ra.TableCellReader.pg(Va.source)||ra.TableCellReader.pg(Va.target))return!0;this.mfn(Va,Xa);return!0}zYm(){if(this.hQc){for(var Xa=N.GraphIterator.$a(this.pia),Va=Xa.currentNode;14!==Xa.ef;)if(Va=
Xa.Vd(),!Va){G.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.XAi(Va)}}DYm(Xa){this.hQc&&this.XAi(Xa)}Nmo(Xa){const Va=N.GraphIterator.$a(Xa);this.TJ.Qhb(Va,null,!0);Xa.pg=!1;Xa.rowSpan=1;Xa.colSpan=1}XAi(Xa){if(Xa&&14===Xa.type){G.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Va={},Gb=fa.TableReader.$f(Xa),Xb=fa.TableReader.Wg(Xa),rc=N.GraphIterator.$a(Xa);za.forEachCellInTable(rc,
(qb,Zb,Rb)=>{const Ra={};qb=qb.currentNode;if(16===qb.type)if(qb.pg)gb.zvh(Zb,Rb)in Va||(this.Nmo(qb),Ra.IsGhostCell="->false");else{gb.rxn(Xa,qb,Zb,Rb,Gb,(fb,bb,Ub)=>{Ra.rowSpan=String.format("{0}:{1}->{2}",fb,bb,Ub)});gb.qxn(Xa,qb,Rb,Zb,Xb,(fb,bb,Ub)=>{Ra.colSpan=String.format("{0}:{1}->{2}",fb,bb,Ub)});const ab=String.format("{0},{1}-{2},{3}",Zb,Rb,Zb+qb.rowSpan,Rb+qb.colSpan);for(let fb=0;fb<qb.rowSpan;fb++)for(let bb=0;bb<qb.colSpan;bb++)if(fb||bb)Va[gb.zvh(Zb+fb,Rb+bb)]=ab}if(0<K.a(Ra).length){if(void 0===
Ra.IsGhostCell||null===Ra.IsGhostCell){if(void 0===Ra.rowSpan||null===Ra.rowSpan)Ra.rowSpan=qb.rowSpan;if(void 0===Ra.colSpan||null===Ra.colSpan)Ra.colSpan=qb.colSpan}G.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",Zb,Rb,Ra)}return!0});gb.p9k(Va)}}J1l(Xa,Va){if(Xa&&Ua.ParagraphReader.ic(Xa)){var Gb=0,Xb=N.GraphIterator.$a(Xa);for(Xb.Rb(6);!Xb.Dr;){var rc=Xb.currentNode;Xb.yi(6);W.ImageReader.Wu(rc)?W.ImageReader.Txf(rc)?N.GraphIterator.$a(rc).bhb(59)?G.ULS.sendTraceTag(590455048,
307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.f3e(rc,Na.a.Uc(Xa,Gb),!0),Va.d++,Gb++):(rc=N.GraphIterator.$a(rc),rc.Ab(12),rc.Jg(),Va.h++):G.ULS.shipAssertTag(6305571,307,!1)}}}get hQc(){return!!this.Ma&&this.Ma.$("ComplexTableCellPasteWithFormattingIsEnabled")}Ivl(Xa,Va,Gb,Xb,rc,qb){const Zb=[];let Rb,Ra,ab,fb;this.$T&&sa.TableBorderSelectionCache.PMc()?(Rb=Math.min(Xa,rc+Gb),Ra=Math.min(Va,qb+Xb),fb=rc):(fb=0,Rb=Math.max(rc+Gb,Xa));
for(;fb<Rb;fb++)for(this.$T&&sa.TableBorderSelectionCache.PMc()?ab=qb:(ab=0,Ra=qb+Xb,fb<rc?ab=Va:fb>=rc&&fb<Math.min(rc+Gb,Xa)?ab=qb:fb>=rc+Gb&&fb<Xa?ab=Va:Ra=Math.max(qb+Xb,Va));ab<Ra;ab++)Zb.push(Array(2)),Zb[Zb.length-1][0]=fb,Zb[Zb.length-1][1]=ab;return Zb}PEc(Xa,Va){if(!Va.source.Vd())return Xa.Qh(Object(H.a)(this,this.tlb,"pasteTeardown")),!0;Xa.Qh(Object(H.a)(this,this.eyh,"corePasteIteration"));return!0}AIn(Xa,Va){if(this.hQc)if(!Va||!Xa)G.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",
{["source"]:Xa,["table"]:Va});else if(16===Va.currentNode.type&&16===Xa.parentNode.type){Va=Va.currentNode;Xa=Xa.parentNode;var Gb={};Va.pg!==Xa.pg&&(Va.pg=Xa.pg,Gb.IsGhostCell=Va.pg);Va.z3!==Xa.z3&&(Va.z3=Xa.z3,Gb.IsSkippedCell=Va.z3);Va.knb!==Xa.knb&&(Va.knb=Xa.knb,Gb.ShouldRenderCell=Va.knb);Va.colSpan!==Xa.colSpan&&(Gb.ColSpan=String.format("{0}<={1}.",Va.colSpan,Xa.colSpan),Va.colSpan=Xa.colSpan);Va.rowSpan!==Xa.rowSpan&&(Gb.RowSpan=String.format("{0}<={1}.",Va.rowSpan,Xa.rowSpan),Va.rowSpan=
Xa.rowSpan);K.a(Gb)}}eyh(Xa,Va){const Gb=Va.source,Xb=Va.target,rc=Gb.currentNode;if(!rc.jga||!rc.TLa||this.h8n(Gb,Xb))return Xa.Qh(Object(H.a)(this,this.OEc,"corePasteIncrement")),!0;if(F.a.instance.J(3)&&ca.OutlineElementReader.Oh(Gb)){if(!ba.OutlineElementNavigator.Ee(Gb).TLa)return ba.OutlineElementNavigator.$d(Gb),Xa.Qh(Object(H.a)(this,this.OEc,"corePasteIncrement")),!0;ba.OutlineElementNavigator.$d(Gb)}G.ULS.shipAssertTag(6305608,307,!rc.q3b());var qb=Xb.currentNode.Hi().Bd;qb=O.a(rc,qb,!0);
qb.pQa();qb.CRc=!0;this.AIn(Gb,Xb);Xb.nH(qb,Va.insertAfter,Gb.role);Xb.Ii(qb);Va.insertAfter=qb;Ha.App.yd.Xp&&Ha.App.yd.Vq.WG(qb);this.wKh(rc,qb);Va=new k.a(Xa,Object(H.a)(this,this.PEc,"corePasteSetup"),new pb.a(Gb,Xb,null,Va.wOf,Va.Ko));Va.il("RecursiveCorePasteOperation");Va.run();Xa.Qh(Object(H.a)(this,this.mQk,"corePasteIterationPostProcessing"));return!0}h8n(Xa,Va){let Gb=!1;ca.OutlineElementReader.Oh(Xa)&&(Gb=ca.OutlineElementReader.GP(Xa)&&this.uxm(Va));return Gb}uxm(Xa){if(Xa)return Xa=Xa.ef,
36===Xa||38===Xa||16===Xa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}Hmn(Xa,Va,Gb){Va=Ca.e(Va);const Xb=Ca.e(Gb);for(let rc=Va.length-1;0<=rc;rc--){if(!Va[rc].Sgc(Gb)){const qb=Na.a.createTextRange(Gb,Va[rc].Nb.cp,Va[rc].Nb.cp+1);gb.characterPropertiesEditor.replaceTextRange(qb,"",void 0,void 0,void 0,void 0,!0)}Va[rc].tWc(Xb[rc],Xa,Object(H.a)(this,this.PEc,"corePasteSetup"),this.Bnm)}}mQk(Xa,Va){const Gb=Va.target,Xb=Gb.currentNode,rc=Va.source,
qb=rc.currentNode;let Zb=-1;Va.Ko[gb.rrf]&&(Zb=Va.Ko[gb.rrf]);Ua.ParagraphReader.ic(Xb)&&(this.Mmn(Xa,Object(H.a)(this,this.PEc,"corePasteSetup"),qb,Xb,Va),this.Hmn(Xa,qb,Xb));Xb.v_();Va.Ko[V.a.mfi]?22===Xb.type&&(ra.TableCellReader.e_(rc)||Xb.setValue(r.a.listID,Number.MAX_VALUE)):this.ZH.IHn(Xb);if(Ua.ParagraphReader.ic(Xb)&&(Va=Ca.i(Xb,5),0<Va.length)){for(const Rb of Va)!Rb.properties.hasProperty(r.a.nJb)&&Rb.properties.hasProperty(r.a.h4d)&&(Va=Rb.properties.getValue(r.a.h4d),Rb.properties.setValue(r.a.nJb,
Va)),W.ImageReader.c8b()?W.ImageReader.lGb(Rb.properties)&&this.Gj.a0f(Rb.properties,Zb):W.ImageReader.Yx(Rb.properties)||this.Gj.a0f(Rb.properties,Zb);Xb.Hi().contentReplicator.forceOutbound(null,null,null)}this.vKh(Gb);this.mBo(qb,Xb);fa.TableReader.yX(Xb)&&G.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.$T&&ra.TableCellReader.Gna(Gb)&&ja.a.j1i(Xb);Gb.qc();Xa.Qh(Object(H.a)(this,this.OEc,"corePasteIncrement"));return!0}mBo(Xa,Va){if(F.a.instance.J(3)&&fa.TableReader.yX(Xa)){let Gb=0;const Xb=
fa.TableReader.$f(Xa);for(const rc of fa.TableReader.ix(Xa,0,Xb-1))rc.fv&&Gb++;Xa=this.Ic.Qc(4);Xa.Eb(Va);Va.properties.setValue(A.a.Oxa,Xb-Gb);Xa.dispose()}}OEc(Xa,Va){if(!Va.source.ht())return Xa.Qh(Object(H.a)(this,this.tlb,"pasteTeardown")),!0;Xa.Qh(Object(H.a)(this,this.eyh,"corePasteIteration"));return!0}tlb(){m.a.mark(5565);return!1}get $T(){null==this.kL&&(a.AFrameworkApplication.Ce("he991617;3eed2178"),this.kL=a.AFrameworkApplication.K?a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.kL}A_d(){return!N.GraphIterator.$a(this.pia).Vd()}gfi(){return this.E2e?1===N.GraphIterator.$a(this.pia).Sp():!1}fVh(Xa){try{return this.uyl(Xa)}catch(Va){return G.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Va.message),0}}uyl(Xa){let Va=0;if(Xa&&(Va=this.tyl(Xa),!Va&&Xa.childNodes))for(let Gb=0;Gb<Xa.childNodes.length&&!(Va=this.fVh(Xa.childNodes[Gb]));Gb++);return Va}tyl(Xa){if(1===Xa.nodeType&&Xa.getAttribute){Xa=(Xa.getAttribute("class")||
"").split(" ");for(const Va of Xa)if(Va.startsWith(this.j1j))return Va.startsWith(this.Nxc)?this.dv&&Va===this.Nxc+this.dv?3:2:1}return 0}Yln(Xa,Va,Gb,Xb,rc){rc.Ko||(rc.Ko={});gb.sa.raiseEvent("OnParagraphCopy",new xb(Xa,Va,Gb,Xb,rc.Ko))}zmn(Xa,Va,Gb,Xb){Xb.Ko||(Xb.Ko={});gb.sa.raiseEvent("OnCopyComplete",new xb(Xa,null,Va,Gb,Xb.Ko))}Mln(Xa){Xa.Ko||(Xa.Ko={});gb.sa.raiseEvent("BeforePaste",new Eb(Xa.Ko))}Lln(Xa){Xa.Ko||(Xa.Ko={});gb.sa.raiseEvent("BeforeCopy",new fc(this.Ys,Xa.Ko))}Mmn(Xa,Va,Gb,Xb,
rc){gb.sa.raiseEvent("OnParagraphPaste",new xb(Xa,Va,Gb,Xb,rc.Ko))}vKh(Xa){ra.TableCellReader.isTableCell(Xa)&&(Xa.Rb(1)||this.TJ.i6(Xa,!0),Xa.qc())}wKh(Xa,Va){this.V1.Lva(Va)&&(Va.width=Xa.width)}static evd(Xa){gb.sa.addHandler("OnParagraphCopy",Xa)}static FAc(Xa){gb.sa.addHandler("OnParagraphPaste",Xa)}static MFn(Xa){gb.sa.removeHandler("OnParagraphPaste",Xa)}static afk(Xa){gb.sa.addHandler("OnCopyComplete",Xa)}static iek(Xa){gb.sa.addHandler("BeforePaste",Xa)}static iFn(Xa){gb.sa.removeHandler("BeforePaste",
Xa)}static gek(Xa){gb.sa.addHandler("BeforeCopy",Xa)}static jek(Xa){gb.sa.addHandler("BeforeTrimOnCopy",Xa)}static aek(Xa){gb.sa.addHandler("AfterTrimCompleteOnCopy",Xa)}static get characterPropertiesEditor(){return null!=gb.wmg?gb.wmg:gb.wmg=e.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get vG(){return Fa.a.instance}static get Te(){return Ea.PageReader.instance}static p9k(Xa){const Va={};for(const Gb of K.a(Xa)){const Xb=Xa[Gb];Va[Xb]=Xb in Va?String.format("{0}|{1}",Va[Xb],Gb):
Gb}1<=K.a(Va).length&&G.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Va)}static qxn(Xa,Va,Gb,Xb,rc,qb){Va.colSpan>rc-Gb&&(qb&&qb("A",Va.colSpan,rc-Gb),Va.colSpan=rc-Gb);Xa=gb.lbo(Xa,Va,Xb,Gb);Va.colSpan!==Xa&&(qb&&qb("B",Va.colSpan,Xa),Va.colSpan=Xa)}static rxn(Xa,Va,Gb,Xb,rc,qb){Va.rowSpan>rc-Gb&&(qb&&qb("A",Va.rowSpan,rc-Gb),Va.rowSpan=rc-Gb);Xa=gb.mbo(Xa,Va,Gb,Xb);Va.rowSpan!==Xa&&(qb&&qb("B",Va.rowSpan,Xa),Va.rowSpan=Xa)}static lbo(Xa,Va,Gb,Xb){return gb.hcj(Xa,Va.colSpan,
(rc,qb)=>{za.moveToCell(rc,Gb,Xb+qb)})}static mbo(Xa,Va,Gb,Xb){return gb.hcj(Xa,Va.rowSpan,(rc,qb)=>{za.moveToCell(rc,Gb+qb,Xb)})}static hcj(Xa,Va,Gb){if(14!==Xa.type)throw Error.argument("tableNode is not a Table.");if(!Gb)throw Error.argumentNull("MoveToCellAction");for(let rc=1;rc<Va;rc++){var Xb=N.GraphIterator.$a(Xa);Gb(Xb,rc);Xb=Xb.currentNode;if(!Xb||16!==Xb.type||!Xb.pg)return rc}return Va}static zvh(Xa,Va){return Xa+","+Va}mfn(Xa,Va){for(;Xa.target.Vd();)Xa.target.Jg();Xa.iic=new k.a(Va,
Xa.XKi?Xa.XKi:Object(H.a)(this,this.PEc,"corePasteSetup"),new pb.a(Xa.source,Xa.target,null,Xa.wOf));Xa.iic.il("ExecuteCorePasteCellContentInCell");Xa.iic.wg=!1;Xa.iic.run()}eWm(Xa){let Va=!1;if(this.$T&&sa.TableBorderSelectionCache.PMc()){const Gb=da.a(Xa.target),Xb=la.a.Ar(Xa.target);let rc=this.Zee;isNullOrUndefined(Xa.CYa[Xa.CYa.length-1])||(rc=Math.min(rc,Xa.CYa[Xa.CYa.length-1][0]));let qb=this.y9f;isNullOrUndefined(Xa.CYa[Xa.CYa.length-1])||(qb=Math.min(qb,Xa.CYa[Xa.CYa.length-1][1]));ra.TableCellReader.dPa(Xa.target)||
ra.TableCellReader.dPa(Xa.source)||Xb==rc&&Gb==qb?Va=!0:(ra.TableCellReader.isTableCell(Xa.target)||Xa.target.kd(16),ra.TableCellReader.Waa(Xa.source)?(ra.TableCellReader.dPa(Xa.target)||(za.moveToNextRow(Xa.target),za.moveToColumnByIndex(Xa.target,Xa.xo),G.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),za.moveToNextOrPreviousCell(Xa.source,!1,!1)):ra.TableCellReader.Waa(Xa.target)||Gb==qb?(za.moveToNextRow(Xa.source),za.moveToColumnByIndex(Xa.source,0),G.ULS.sendTraceTag(537519906,
307,50,"Move to next row to replace cell contents"),za.moveToNextRow(Xa.target),za.moveToColumnByIndex(Xa.target,Xa.xo),G.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(za.moveToNextOrPreviousCell(Xa.target,!1,!1),za.moveToNextOrPreviousCell(Xa.source,!1,!1)))}else ra.TableCellReader.dPa(Xa.source)?Va=!0:(ra.TableCellReader.isTableCell(Xa.target)||Xa.target.kd(16),ra.TableCellReader.Waa(Xa.source)?(za.moveToNextRow(Xa.target),za.moveToColumnByIndex(Xa.target,Xa.xo),
G.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):za.moveToNextOrPreviousCell(Xa.target,!1,!1),za.moveToNextOrPreviousCell(Xa.source,!1,!1));Va&&(this.AY&&this.AY.Jmn(Xa.target,Xa.CYa),fa.TableReader.isTable(Xa.target)||Xa.target.kd(14),this.DYm(Xa.target.currentNode),G.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return Va}j2n(){this.Zee=sa.TableBorderSelectionCache.z8.bottomMostRowSelected;this.y9f=sa.TableBorderSelectionCache.z8.rightMostColumnSelected;
this.bko=sa.TableBorderSelectionCache.z8.leftMostColumnSelected;this.Wgj=sa.TableBorderSelectionCache.z8.topMostRowSelected}}gb.sa=new w.a;gb.rrf="PasteConstrainingWidth";Object(D.a)(gb,"InternalClipboard",null,[])},1889:function(D,L,c){D=c(0);var l=c(2),e=c(106),a=c(61),k=c(201),m=c(22),w=c(16),v=c(80),r=c(133),z=c(17),A=c(44),G=c(7),H=c(8),I=c(68),K=c(55),F=c(28),J=c(318),N=c(37),O=c(14),M=c(5),T=c(109),R=c(20),W=c(40),V=c(260),ba=c(43),ha=c(262),ca=c(21),ia=c(91),ra=c(170),da=c(872),za=c(495),
la=c(3),na=c(97),Ca=c(67),Na=c(11),Ta=c(110),Fa=c(48),qa=c(504),ja=c(598),X=c(233),ua=c(19),Ha=c(24),Ea=c(54),wa=c(38),sa=c(248),fa=c(10),Ma=c(1517),Ua=c(1533),Qa=c(241),Ja=c(171),Wa=c(57),Ya=c(531);class sb extends Qa.a{constructor(Aa,xb,gb,Xa,Va,Gb,Xb,rc){super();this.B4g=this.JB=null;this.init(Aa);this.il("FormattingViewOperation");this.Lhb(l.AFrameworkApplication.ya,xb,Xa,Va,Gb);this._context=gb;this.z7a=0;this.Yq=!0;this.WLj=Xb;this.Om=rc}get laa(){return this.Om.instance}run(){const Aa=this._context.view;
var xb=null;Aa.ue&&(xb=Aa.Bb);if(xb){var gb=xb.hb.kb,Xa=!Ua.a.g8b(this.actionId);!gb||sb.ag.hyf(gb,Xa)?(sb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.hE}),this.Yq=!1):this.laa&&this.laa.z8b(gb)?(sb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.externalSelection}),this.Yq=!1):sb.Yg.lya(fa.ParagraphReader.MT,xb.Lg)&&(sb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.BN}),this.Yq=!1)}else sb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.Nga}),this.Yq=!1;1!==this.behavior&&this.Yq||(this.Yq&&(gb=xb.hb.kb,1===xb.hb.length&&1===gb.length&&ua.SelectionEditor.Ek(gb.Qa)&&
ia.b(gb.Qa)&&(sb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.qEc}),this.Yq=!1)),(gb=this.Yq)&&this.actionId===la.a.l4&&((gb=Array.from(xb.hb.kb).some(T.FormattingReader.x2e))||sb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.P9e})),this.nr=gb?32:8,this.z7a=3);this.z7a||(Ja.a.mark(5730),this.B4g=Ya.SelectionReferenceFactory.instance.Kzb(),gb=xb.hb.kb.Qa,this.JB=new Fa.GraphTransaction(15),this.JB.Eb(gb.node),this.JB.Kk=this.actionId,this.z7a=1);if(1===this.z7a){this.xF||this.s2c(this._context.Yj);if(1===this.c4a())return;this.z7a=
2}if(2===this.z7a){if(this.actionId===la.a.l4)if(xb=xb.Lg,xb.Hw)for(gb=0;gb<xb.length;gb++)Xa=xb.getContext(gb),this.Slj(Xa);else this.Slj(xb);this.B4g.Uoa(this.actionId===la.a.bY||this.actionId===la.a.dta);(xb=Object(I.a)(18,this.vd))&&!xb.u5a||Wa.FocusManager.instance().Dg(Aa.vI);this.JB.dispose();this.JB=null;Na.App.xa.updateCommandUI();Ja.a.mark(5731);this.z7a=3;this.nr=32}3===this.z7a&&(this.WLj.process(this.actionId,this._context,this.behavior,this.response),this.hpa())}Slj(Aa){(ua.SelectionEditor.Xu(Aa)||
ua.SelectionEditor.Dk(Aa))&&Na.App.BM.xca(Aa.node)}static get ag(){return sa.a.instance}static get Yg(){return X.ContextSetEditor.instance}static get Mc(){return r.a.instance}}Object(D.a)(sb,"FormattingViewOperation",Qa.a,[]);var ob=c(1008),fc=c(768),Eb=c(78),Ib=c(64);c.d(L,"a",function(){return pb});const Nb=new Set([la.a.gO,la.a.xO,la.a.clearFormatting,la.a.xBa,la.a.yBa,la.a.zYa,la.a.ata,la.a.AYa]);class pb{constructor(Aa,xb,gb=null,Xa,Va,Gb,Xb,rc,qb,Zb,Rb,Ra,ab){this.kpiName="ChangeCaseCommandUsage";
this.S6="wwaengidc";this.gjb=new Map;this.vVg=new Set;this.OBb=()=>new da.a(2);this.yPi=(fb,bb,Ub,Oa,Fc)=>{Oa=!0;bb.contextId!==O.a.view&&(Oa=!1);if(1===Ub&&!Oa)return 8;if(fb===la.a.tZc)fb=Fc.formatting,Fc=Fc.G6f;else{if(!bb.view||!bb.view.ue)return 2;bb=bb.view;if(!bb.Bb||!bb.Bb.hb.kb)return 8;fb=Fc;Fc=bb.Bb.hb}this.GLk(Fc,fb);return 32};this.sVe=(fb,bb,Ub,Oa,Fc,xc)=>new sb(fb,bb,Ub,Oa,Fc,xc,this.FMj,pb.Gw());this.Uvd=(fb,bb,Ub,Oa,Fc)=>{var xc,pd,lb;let Tb=!0,pc=bb;const Db=!Ua.a.g8b(fb);bb.contextId!==
O.a.Fd&&bb.contextId!==O.a.Vc?Tb=!1:(pb.ag.C7(pc,!1,Db)&&(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.hE}),Tb=!1),pb.Gw()&&pb.Gw().instance&&pb.Gw().instance.PT(pc)&&(Tb=!1),Tb&&ua.SelectionEditor.Ek(bb)&&ia.b(pc)&&(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.qEc}),Tb=!1),fa.ParagraphReader.MT(bb)&&(pb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.BN}),Tb=!1));if(1===Ub||!Tb)return Tb?32:8;if(bb.contextId===O.a.Vc)return 2;Ib.a.L2e&&(bb=null===(xc=this.Np)||void 0===xc?void 0:xc.U1h(pc))&&(pc=bb);this.y8n(fb)&&(xc=ua.SelectionEditor.kOb(pc),
ua.SelectionEditor.pf(xc)||(pc=xc));xc="boolean"===typeof Fc&&Fc;bb=!1;(null===(pd=this.cra)||void 0===pd?0:pd.annotateRange)&&(null===(lb=this.cra)||void 0===lb?0:lb.NFb(pc.node))&&(bb=this.k2(pc,fb,Fc,xc));bb&&fb!==la.a.l4||pb.VGa.k2(pc,Ob=>{this.cgc(Ob,fb,Fc,pc.cpEnd)},xc);pc.node.es&&(pd=[Object.assign(new F.a,{name:"Source",string:"CharacterFormatting"})],K.a("TOCFormatting",!0,void 0,pd));this.flm(fb)&&this.oyd(pc,fb);Oa&&Ma.a.$nb&&(Oa.Xr|=Ma.a.agb(pc.node));return 32};this.T5c=(fb,bb,Ub)=>
1!==Ub&&2===Ub?(this.gjb.set("Source","Shortcut"),fb=bb.node.characterData.substr(bb.cpBegin,bb.cpEnd-bb.cpBegin),pb.Ayf(fb,0,fb.length)?this.oyd(bb,la.a.xBa):pb.Hwm(fb,fb.length)?this.oyd(bb,la.a.ata):this.oyd(bb,la.a.yBa)):32;this.mdb=(fb,bb,Ub)=>{let Oa=!0;fb=!Ua.a.g8b(fb);bb.contextId!==O.a.Fd&&bb.contextId!==O.a.Vc?Oa=!1:(pb.ag.C7(bb,!1,fb)&&(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.hE}),Oa=!1),Oa&&ua.SelectionEditor.Ek(bb)&&ia.b(bb)&&(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.qEc}),Oa=!1),Oa&&fa.ParagraphReader.MT(bb)&&
(pb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.BN}),Oa=!1));if(1===Ub||!Oa)return Oa?32:8;bb=bb.node;this.Cs.s0b(bb,!1);bb.es&&(bb=[Object.assign(new F.a,{name:"Source",string:"ClearFormatting"})],K.a("TOCFormatting",!0,void 0,bb));return 32};this.sDc=(fb,bb,Ub,Oa,Fc)=>{fb={};fb[ob.a.JHa]=6168;fb[ob.a.IHa]=6169;const xc=bb.view;var pd=null;xc.mi&&(pd=xc);var lb=!0;let Tb=32;pd&&(pd=pd.Bb.hb.kb)&&(pb.ag.hyf(pd)?(pb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.hE}),Tb=8,lb=!1):1===Ub&&(Tb=32,lb=!1));lb&&(lb=new Fa.GraphTransaction(1===
Ub?3:15),lb.Eb(xc.root),Tb=ob.a.yoa(la.a.mdb,bb,Ub,Oa,Fc,fb,12),lb.dispose());return Tb};this.BVe=(fb,bb,Ub,Oa,Fc)=>{var xc,pd=!0,lb=32;const Tb=!Ua.a.g8b(fb);bb.contextId!==O.a.Vc?pd=!1:pb.ag.C7(bb,!1,Tb)&&(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.hE}),pd=!1);if(1===Ub||!pd)return pd?32:8;Ub=bb.node;N.a.instance.J(6)&&fb===la.a.clearFormatting&&(pb.xn.tDc(Ub),this.Cs.Zsh(Ub),pd=this.Kz.jx(Ub).fh(this.Kz.wordStyleIdNormal),this.sL.QK(pd,Ub,!0));Ub=pb.uj.tmf(bb);Ib.a.L2e&&!Ub&&(pd=null===(xc=this.Np)||void 0===
xc?void 0:xc.U1h(bb))&&(bb=pd,Ub=Ha.SelectionFactory.Vn(bb));if(Ub)lb=Ea.a.Fzb(Ub),lb=l.AFrameworkApplication.ya.Tf(lb,fb,2,!1,Oa,Fc);else{Oa=Object(I.a)(18,Fc);xc=T.FormattingReader.zr(bb);if(!xc)return 16;xc=xc.cache;switch(fb){case la.a.font:pb.aPh();if(Oa&&Oa.vd){const {fontName:pc,a9:Db,bold:Ob,italic:jb}=pb.Uif(Oa.vd);pb.uj.iae(pc);pb.uj.Bgc(Db);Object(qa.a)()&&(fb=1==Ob,Fc=1==jb,fb||Fc)&&(pb.uj.mG(fb),pb.uj.setItalic(Fc))}break;case la.a.Us:H.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");
pb.uj.Us(Fc);break;case la.a.Nha:pb.uj.Us(Fc);this.recentColors.fcb(Fc)||H.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.u2:pb.uj.u2();break;case la.a.bY:H.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");pb.uj.xxa(Fc);break;case la.a.E8:pb.uj.xxa(Fc);this.recentColors.fcb(Fc)||H.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.dta:pb.uj.Xyd();
break;case la.a.Av:pb.aPh();pb.uj.Av(Oa.vd);break;case la.a.gO:fb=pb.uj.VF(z.a.fontSize,xc.fontSize);pb.uj.Av(this.ze.gO(fb));break;case la.a.xO:fb=pb.uj.VF(z.a.fontSize,xc.fontSize);pb.uj.Av(this.ze.xO(fb));break;case la.a.bold:fb=pb.uj.VF(z.a.bold,xc.isBold);pb.uj.mG(!fb);break;case la.a.setItalic:fb=pb.uj.VF(z.a.italic,xc.isItalic);pb.uj.setItalic(!fb);break;case la.a.underline:fb=pb.uj.VF(z.a.underline,xc.isUnderline);pb.uj.o4(!fb);break;case la.a.Uha:pb.uj.Uha(Fc);break;case la.a.superscript:fb=
pb.uj.VF(z.a.superscript,xc.isSuperscript);pb.uj.mca(!fb);break;case la.a.subscript:fb=pb.uj.VF(z.a.subscript,xc.isSubscript);pb.uj.kpa(!fb);break;case la.a.strikethrough:fb=pb.uj.VF(z.a.strikethrough,xc.isStrikethrough);pb.uj.K8(!fb);break;case la.a.ur:fb=pb.uj.VF(A.a.ur,xc.isDoubleStrikethrough);pb.uj.ggc(!fb);break;case la.a.clearFormatting:pb.uj.E4a();break;case la.a.l4:Fc.hasProperty(z.a.cC)&&pb.uj.l4(Fc.getValue(z.a.cC));Fc.hasProperty(G.a.noProof)&&(fb=Fc.getValue(G.a.noProof),pb.uj.i_n(fb));
break;default:this.vVg.has(fb)||(this.vVg.add(fb),(Fc=e.ActionManager.dea(fb))&&Fc.length||(Fc="UnknownAction"),H.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${Fc} (${fb})`))}}Na.App.xa.updateCommandUI();return lb};this.xS=(fb,bb,Ub,Oa,Fc)=>{Oa=pb.Mc.Xo(la.a.eXn);var xc=!0;bb.contextId!==O.a.endOfParagraph&&(xc=!1);if(1===Ub||!xc)return xc?32:8;Ub=bb.node;xc=M.GraphIterator.$a(bb.node);xc.zd();var pd=xc.j7(4);if((xc=!!pd&&pb.hd.Xaa(pd))&&!Na.App.Bjb)return 8;
var lb=!fa.ParagraphReader.textLength(Ub);Oa.properties.Z("Action",fb.toString());Oa.properties.Z("ListContext",xc.toString());Oa.properties.Z("IsEmptyParagraph",lb.toString());H.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",fb,xc,lb);xc&&!za.a.hh.jO&&this.epj(fb,Fc,pd);xc=Ub.qa.last;this.zEn(Ub,fb);lb=!!xc.formatting;const Tb=Ub.getValue(G.a.endOfParagraphFormatting);pd=this.Rd.VMa(Ub);lb=!lb&&Tb&&Tb.equals(a.a.nil)?new ra.a(xc,a.a.nil):pd.Xf(pd.Nb);
this.cgc(pd,fb,Fc,xc.cp);N.a.instance.J(3)&&pb.Dj.YLb(Ub,xc,bb.cpBegin,bb.cpEnd,lb,pd,pb.Kd.zg);Oa.end();return 32};this.Mka=(fb,bb,Ub,Oa,Fc)=>{Oa=!0;const xc=M.GraphIterator.$a(bb.node);xc.zd();bb.contextId===O.a.endOfParagraph&&xc.j7(4)||(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.HBf}),Oa=!1);bb=xc.currentNode;if(!pb.hd.Xaa(bb))return 8;if(1===Ub||!Oa)return Oa?32:8;za.a.hh.jO||this.epj(fb,Fc,bb);return 32};this.Loa=(fb,bb,Ub,Oa,Fc)=>{fb=!0;bb.contextId!==O.a.paragraph&&(fb=!1);if(1===Ub&&!fb)return 8;
Ub=bb.node;-1!==Fc.Vh?Fc.Vh!==fa.ParagraphReader.Vv(Ub)&&(Fc.Vh=0):Fc.Vh=fa.ParagraphReader.Vv(Ub);fb=this.so.sgb(Ub);Fc.it?(!Fc.u6l&&this.x6l(Fc.it,fb)&&2===Fc.it.specialIndentType&&(Fc.it.specialIndentType=0),Fc.it.uEb===fb.uEb&&k.a.b_(Fc.it.UA,fb.UA)||(Fc.it.UA=Number.MAX_VALUE),Fc.it.vEb===fb.vEb&&k.a.b_(Fc.it.Zma,fb.Zma)||(Fc.it.Zma=Number.MAX_VALUE)):Fc.it=fb;bb=pb.Yg.nkh(bb.Yj);void 0!==bb&&null!==bb&&(bb=bb.node,void 0!==bb&&null!==bb&&(bb=V.WordSectionNavigator.instance.fJ(bb),void 0!==bb&&
null!==bb&&(bb=pb.Uf.Pt(bb)-(pb.Uf.JI(bb)+pb.Uf.sK(bb)+Na.App.oya),fb.OOc=bb-fb.UA,fb.NOc=bb-fb.Zma,Fc.it.NOc=Math.min(Fc.it.NOc,fb.NOc),Fc.it.OOc=Math.min(Fc.it.OOc,fb.OOc))));bb=this.DV.jDa(Ub);Fc.spacing?(Fc.spacing.beforeSpacing=pb.ggh(bb.beforeSpacing,Fc.spacing.beforeSpacing),Fc.spacing.afterSpacing=pb.ggh(bb.afterSpacing,Fc.spacing.afterSpacing),Fc.spacing.lineSpacing.unit===bb.lineSpacing.unit&&k.a.b_(Fc.spacing.lineSpacing.value,bb.lineSpacing.value)||(Fc.spacing.lineSpacing.unit=0,Fc.spacing.lineSpacing.value=
0)):Fc.spacing=bb;bb=new M.GraphIterator;bb.set(Ub);bb.Ab(11);if(Ub=bb.kd(11))Fc.isRtl=ba.OutlineElementReader.qm(Ub);Ub=pb.hd.Qu(bb);bb=16;void 0!==Ub&&null!==Ub&&(bb=Ub.listType);Fc.listType=pb.bzl(Fc.listType,bb);Fc.px=16===Fc.listType?null:Ub;return 32};this.zpn=(fb,bb,Ub,Oa,Fc)=>{Fc.isRtl=ba.OutlineElementReader.qm(W.OutlineElementNavigator.fl(bb.node));return 32};this.ajh=(fb,bb,Ub)=>{if(fb===la.a.rMb)fb=!0;else if(fb===la.a.qMb)fb=!1;else return 2;fb&&this.tui(bb);if(1===Ub)return 32;this.Bh.jMb(W.OutlineElementNavigator.fl(bb.node),
fb);return 32};this.qpn=(fb,bb,Ub,Oa,Fc)=>{fb=bb.node;Fc.isRtl=ba.OutlineElementReader.isRtl(W.OutlineElementNavigator.fl(fb));Fc.Vh=R.ImageReader.Vv(fb);return 32};this.vqn=(fb,bb,Ub,Oa,Fc)=>{fb=bb.node;Fc.isRtl=ba.OutlineElementReader.isRtl(W.OutlineElementNavigator.fl(fb));Fc.Vh=wa.TableReader.Vv(fb);-1!==Fc.Vh&&Fc.Vh||(Fc.Vh=Fc.isRtl?3:1);return 32};this.KVe=(fb,bb,Ub,Oa,Fc)=>{let xc;if(!({Lx:xc}=Ua.a.A4f(Ub,bb)).returnValue)return xc;const pd=bb.node;switch(fb){case la.a.qMb:this.Bh.Agc(pd,!1);
break;case la.a.rMb:this.tui(bb);this.Bh.Agc(pd,!0);break;case la.a.l4:xc=l.AFrameworkApplication.ya.Tf(bb.Yj,fb,Ub,!0,Oa,Fc),32===xc&&fa.ParagraphReader.em(bb)&&pb.bZc&&pb.bZc.xca(pd)}return 32};this.HFk=(fb,bb,Ub,Oa,Fc)=>{const xc={};xc[ob.a.JHa]=6168;xc[ob.a.IHa]=6169;var pd=bb.view;const lb=new Fa.GraphTransaction(1===Ub?3:15);lb.Eb(pd.root);let Tb=ob.a.yoa(fb,bb,Ub,Oa,Fc,xc,0),pc=null;pd.mi&&(pc=pd);pd=!0;let Db=null;pc&&(Db=pc.Bb.hb.kb)&&(fb=!Ua.a.g8b(fb),pb.ag.hyf(Db,fb)?(pb.Mc.fc(na.a.vf,
{["Reason"]:Ca.a.hE}),Tb=8,pd=!1):1===Ub&&(Tb=32,pd=!1),pb.Yg.lya(fa.ParagraphReader.MT,pc.Bb.Lg)&&(pb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.BN}),Tb=8,pd=!1));pd&&this.Mwm(Db)&&(Tb=ob.a.yoa(la.a.mdb,bb,Ub,Oa,Fc,xc,12));lb.dispose();return Tb};this.GFk=(fb,bb,Ub)=>{fb=!0;bb.contextId!==O.a.paragraph&&bb.contextId!==O.a.Vc?fb=!1:pb.ag.$1a(bb)&&(pb.Mc.fc(na.a.Zm,{["Reason"]:Ca.a.hE}),fb=!1);if(1===Ub||!fb)return fb?32:8;bb=bb.node;Ub=new Fa.GraphTransaction(15);Ub.Eb(bb);pb.xn.tDc(bb);this.Cs.s0b(bb,!0);this.sL.t0e(bb);
Ub.dispose();return 2};this.Z1l=(fb,bb,Ub)=>{fb=!0;bb.contextId!==O.a.view&&(fb=!1);if(1===Ub&&!fb)return 8;if(!bb.view||!bb.view.ue)return 2;bb=bb.view;if(!bb.Bb||!bb.Bb.hb.kb)return 8;if(pb.Yg.lya(fa.ParagraphReader.MT,bb.Bb.Lg))return pb.Mc.fc(na.a.vf,{["Reason"]:Ca.a.BN}),8;bb=bb.Bb.hb;for(const Oa of bb)for(const Fc of Oa)if(Fc&&Fc.contextId!==O.a.Fd&&Fc.contextId!==O.a.Vc&&Fc.contextId!==O.a.paragraph&&Fc.contextId!==O.a.endOfParagraph)return 2;return 32};this.j4a=(fb,bb,Ub,Oa,Fc)=>{fb=!0;bb.contextId!==
O.a.paragraph&&(fb=!1);if(1===Ub&&!fb)return 8;Fc.it||(bb=bb.node,Ub=this.so.sgb(bb),Fc.it=Ub,bb=W.OutlineElementNavigator.fl(bb),Fc.isRtl=bb?ba.OutlineElementReader.qm(bb):!1);return 32};this.wqn=(fb,bb,Ub,Oa,Fc)=>{bb=bb.node;fb=W.OutlineElementNavigator.fl(bb);Fc.it||(bb=this.WNl(bb),bb=this.so.sgb(bb),Fc.it=bb,Fc.isRtl=ba.OutlineElementReader.isRtl(fb));return 32};this.FMj=Aa;this.cra=xb;this.t5=gb;this.Np=Xa;this.ze=Va;this.Rd=Gb;this.Cs=Xb;this.DV=rc;this.sL=Zb;this.Kz=qb;this.Bh=Rb;this.QJ=
Ra;this.so=ab}get recentColors(){return null!=this.xvg?this.xvg:this.xvg=m.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get IHd(){return!!this.t5&&this.t5.enabled}Wb(){const Aa=l.AFrameworkApplication.ya,xb=this.zpn;(pb.$b?pb.$b.Xx(41):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Aa.pa(la.a.font,O.a.endOfParagraph,this.xS),Aa.pa(la.a.Av,O.a.endOfParagraph,this.xS),Aa.pa(la.a.gO,O.a.endOfParagraph,this.xS),Aa.pa(la.a.xO,O.a.endOfParagraph,
this.xS),Aa.pa(la.a.Us,O.a.endOfParagraph,this.xS),Aa.pa(la.a.Nha,O.a.endOfParagraph,this.xS),Aa.pa(la.a.u2,O.a.endOfParagraph,this.xS),Aa.pa(la.a.bY,O.a.endOfParagraph,this.xS),Aa.pa(la.a.E8,O.a.endOfParagraph,this.xS),Aa.pa(la.a.dta,O.a.endOfParagraph,this.xS),Aa.pa(la.a.bold,O.a.endOfParagraph,this.xS),Aa.pa(la.a.setItalic,O.a.endOfParagraph,this.xS),Aa.pa(la.a.underline,O.a.endOfParagraph,this.xS),Aa.pa(la.a.Uha,O.a.endOfParagraph,this.xS),Aa.pa(la.a.superscript,O.a.endOfParagraph,this.xS),Aa.pa(la.a.subscript,
O.a.endOfParagraph,this.xS),Aa.pa(la.a.strikethrough,O.a.endOfParagraph,this.xS),Aa.pa(la.a.ur,O.a.endOfParagraph,this.xS),Aa.pa(la.a.l4,O.a.endOfParagraph,this.xS),Aa.pa(la.a.clearFormatting,O.a.endOfParagraph,this.xS)):Na.App.Bjb&&(Aa.pa(la.a.font,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.Av,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.Us,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.Nha,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.u2,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.bold,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.setItalic,
O.a.endOfParagraph,this.Mka),Aa.pa(la.a.superscript,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.subscript,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.strikethrough,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.ur,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.gO,O.a.endOfParagraph,this.Mka),Aa.pa(la.a.xO,O.a.endOfParagraph,this.Mka));const gb=Na.App.GSa.aFc(Xa=>ja.OutlineElementGeneralizer.ima(Xa.hb,!0));Aa.gb(la.a.s_e,O.a.view,this.Z1l,100);Aa.gb(la.a.T5c,O.a.Fd,this.T5c,1028);Aa.pa(la.a.g4a,O.a.view,this.yPi);Aa.pa(la.a.tZc,
O.a.view,this.yPi);Aa.pa(la.a.Loa,O.a.view,gb);Aa.pa(la.a.Loa,O.a.paragraph,this.Loa);Aa.pa(la.a.Loa,O.a.image,this.qpn);Aa.pa(la.a.Loa,O.a.unsupportedObject,xb);Aa.pa(la.a.Loa,O.a.table,this.vqn);Aa.pa(la.a.j4a,O.a.view,gb);Aa.pa(la.a.j4a,O.a.paragraph,this.j4a);Aa.pa(la.a.j4a,O.a.table,this.wqn);Aa.Xc(la.a.g4a,99);Aa.Xc(la.a.tZc,1127);Aa.Xc(la.a.Loa,97);Aa.Xc(la.a.j4a,97);this.xL(Aa,la.a.font);this.xL(Aa,la.a.Av);this.xL(Aa,la.a.gO);this.xL(Aa,la.a.xO);Aa.acb(la.a.APh,O.a.view,this.sVe);Aa.Xc(la.a.APh,
1092);this.xL(Aa,la.a.Us);this.xL(Aa,la.a.Nha);this.xL(Aa,la.a.u2);this.xL(Aa,la.a.bY);this.xL(Aa,la.a.E8);this.xL(Aa,la.a.zYa);this.xL(Aa,la.a.xBa);this.xL(Aa,la.a.yBa);this.xL(Aa,la.a.ata);this.xL(Aa,la.a.AYa);this.xL(Aa,la.a.dta);this.xL(Aa,la.a.bold);Aa.PLb(la.a.bold,this.OBb);this.xL(Aa,la.a.setItalic);Aa.PLb(la.a.setItalic,this.OBb);this.xL(Aa,la.a.underline);Aa.PLb(la.a.underline,this.OBb);this.xL(Aa,la.a.Uha);this.xL(Aa,la.a.superscript);Aa.PLb(la.a.superscript,this.OBb);this.xL(Aa,la.a.subscript);
Aa.PLb(la.a.subscript,this.OBb);this.xL(Aa,la.a.strikethrough);Aa.PLb(la.a.strikethrough,this.OBb);this.xL(Aa,la.a.ur);Aa.PLb(la.a.ur,this.OBb);Aa.gb(la.a.p1a,O.a.Fd,this.Uvd,96);Aa.acb(la.a.l4,O.a.view,this.sVe);Aa.pa(la.a.l4,O.a.paragraph,this.KVe);Aa.pa(la.a.l4,O.a.Fd,this.Uvd);Aa.pa(la.a.l4,O.a.Vc,this.BVe);Aa.pa(la.a.clearFormatting,O.a.view,this.HFk);Aa.pa(la.a.clearFormatting,O.a.paragraph,this.GFk);Aa.pa(la.a.clearFormatting,O.a.Fd,this.Uvd);Aa.pa(la.a.clearFormatting,O.a.Vc,this.BVe);Aa.Xc(la.a.clearFormatting,
1036);Aa.pa(la.a.mdb,O.a.Fd,this.mdb);Aa.pa(la.a.mdb,O.a.Vc,this.mdb);Aa.pa(la.a.sDc,O.a.view,this.sDc);Aa.pa(la.a.qMb,O.a.view,Ua.a.Nv);Aa.pa(la.a.qMb,O.a.paragraph,this.KVe);Aa.pa(la.a.qMb,O.a.unsupportedObject,this.ajh);Aa.Xc(la.a.qMb,1028);Aa.pa(la.a.rMb,O.a.view,Ua.a.Nv);Aa.pa(la.a.rMb,O.a.paragraph,this.KVe);Aa.pa(la.a.rMb,O.a.unsupportedObject,this.ajh);Aa.Xc(la.a.rMb,1028)}xL(Aa,xb){Aa.acb(xb,O.a.view,this.sVe);Aa.pa(xb,O.a.Fd,this.Uvd);Aa.pa(xb,O.a.Vc,this.BVe);Aa.Xc(xb,1036)}GLk(Aa,xb){for(const rc of Aa)for(const qb of rc){Aa=
null;if(qb.contextId===O.a.Fd){if(ia.b(qb))continue;Aa=[];var gb=qb.node.qa;if(gb){var Xa=gb.length-1;const Zb=qb.cpBegin,Rb=qb.cpEnd;let Ra=!1;const ab=qb.node.characterData;if(ab&&""!==ab){var Va=ab.substr(Zb,Rb-Zb);Va&&""!==Va&&w.a.G2e(Va,0,Va.length)&&(Ra=!0)}Va=!1;for(let fb=0;fb<Xa;fb++){var Gb=gb.J(fb).cp,Xb=gb.J(fb+1).cp;if(gb.J(fb).formatting&&Math.max(Gb,Zb)<Math.min(Xb,Rb)){if(ab&&""!==ab&&(Gb=Gb<Zb?Zb:Gb,Xb=ab.substr(Gb,(Xb<Rb?Xb:Rb)-Gb),!Ra&&w.a.G2e(Xb,0,Xb.length)))continue;Va=!0;Aa.push(gb.J(fb).formatting)}else if(Va)break}gb.J(Xa).formatting&&
qb.cpEnd>gb.J(Xa).cp&&Aa.push(gb.J(Xa).formatting)}}else if(qb.contextId===O.a.paragraph&&!fa.ParagraphReader.MT(qb)){if(Aa=[],gb=qb.node.qa)for(Xa=0;Xa<gb.length;Xa++)gb.J(Xa).formatting&&Aa.push(gb.J(Xa).formatting)}else if(qb.contextId===O.a.endOfParagraph)Aa=[T.FormattingReader.zr(qb)];else if(qb.contextId===O.a.Vc){this.$on(qb,xb);return}if(Aa&&0<Aa.length)for(const Zb of Aa)if(T.FormattingReader.fcg(xb,Zb.cache,qb))return}}$on(Aa,xb){if(Aa=T.FormattingReader.zr(Aa)){Aa=Aa.cache;var gb=pb.uj.VF(z.a.bold,
Aa.isBold);xb.bold=gb?1:0;gb=pb.uj.VF(z.a.italic,Aa.isItalic);xb.italic=gb?1:0;gb=pb.uj.VF(z.a.underline,Aa.isUnderline);xb.underline=gb?1:0;xb.underlineType=pb.uj.VF(z.a.underlineType,Aa.underlineType);gb=pb.uj.VF(z.a.superscript,Aa.isSuperscript);xb.superscript=gb?1:0;gb=pb.uj.VF(z.a.subscript,Aa.isSubscript);xb.subscript=gb?1:0;gb=pb.uj.VF(z.a.strikethrough,Aa.isStrikethrough);xb.strikethrough=gb?1:0;gb=pb.uj.VF(A.a.ur,Aa.isDoubleStrikethrough);xb.ur=gb?1:0;gb=pb.uj.VF(z.a.font,Aa.lH);xb.fontName=
Ta.a.P_a(gb);xb.a9=Aa.ve;xb.fontSize=pb.uj.VF(z.a.fontSize,Aa.fontSize);xb.fontColor=pb.uj.VF(z.a.fontColor,Aa.fontColor);xb.highlight=pb.uj.VF(z.a.highlight,Aa.highlight)}}y8n(Aa){return Aa===la.a.underline||Aa===la.a.Uha||Aa===la.a.strikethrough||Aa===la.a.ur||Aa===la.a.bY}static Uif(Aa){return"string"===typeof Aa?{fontName:Aa,a9:-1,bold:2,italic:2}:Aa}k2(Aa,xb,gb,Xa){var Va;const Gb=Aa.cpBegin,Xb=Aa.cpEnd,rc=Aa.node;var qb=T.FormattingReader.zr(Aa);let Zb=Gb;const Rb=null===(Va=l.AFrameworkApplication.K)||
void 0===Va?void 0:Va.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);Va=pb.Kd.zg;if(Rb&&(Va||rc.Ms))return!1;if(Nb.has(xb))for(const Ra of rc.qa)if(!(Ra.cp<=Gb)){if(Ra.cp>=Xb)break;Ra.formatting&&Ra.formatting.cache.fontSize!=qb.cache.fontSize&&(qb=this.BXh(Aa.node,qb,xb,gb,Rb?null:Xa),this.cra.annotateRange(Aa.node,Rb?rc.qa.OZa(Zb):Zb,Rb?rc.qa.OZa(Ra.cp):Ra.cp,qb),Zb=Ra.cp,qb=Ra.formatting)}xb=this.BXh(Aa.node,qb,xb,gb,Rb?null:Xa);this.cra.annotateRange(Aa.node,Rb?
rc.qa.OZa(Zb):Zb,Rb?rc.qa.OZa(Xb):Xb,xb);return!0}BXh(Aa,xb,gb,Xa,Va){const Gb={},Xb=Object(I.a)(18,Xa),rc=xb.cache;switch(gb){case la.a.bold:2===Xa.value&&(Xa.value=rc.isBold?0:1);Gb[z.a.bold.id]=1===Xa.value;break;case la.a.setItalic:2===Xa.value&&(Xa.value=rc.isItalic?0:1);Gb[z.a.italic.id]=1===Xa.value;break;case la.a.underline:2===Xa.value&&(Xa.value=rc.isUnderline?0:1);Gb[z.a.underline.id]=1===Xa.value;break;case la.a.Uha:Gb[z.a.underlineType.id]=Xa.number;break;case la.a.superscript:2===Xa.value&&
(Xa.value=rc.isSuperscript?0:1);Gb[z.a.superscript.id]=1===Xa.value;1===Xa.value&&(Gb[z.a.subscript.id]=!1);break;case la.a.subscript:2===Xa.value&&(Xa.value=rc.isSubscript?0:1);Gb[z.a.subscript.id]=1===Xa.value;1===Xa.value&&(Gb[z.a.superscript.id]=!1);break;case la.a.strikethrough:6!==l.AFrameworkApplication.ya.bH?H.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):H.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Xa.value&&(Xa.value=
rc.isStrikethrough?0:1);Gb[z.a.strikethrough.id]=1===Xa.value;break;case la.a.ur:2===Xa.value&&(Xa.value=rc.isDoubleStrikethrough?0:1);Gb[A.a.ur.id]=1===Xa.value;break;case la.a.font:if(Xb&&Xb.vd){const {fontName:Zb,a9:Rb,bold:Ra,italic:ab}=pb.Uif(Xb.vd);Xa=Zb.substr(0,pb.Uwi);this.IHd&&(Gb[G.a.BL.id]=Xa,Gb[G.a.Ry.id]=Xa,Gb[G.a.BP.id]=Xa,Gb[G.a.jQ.id]=Xa,Gb[G.a.Fe.id]=Rb,Gb[G.a.We.id]=Rb,Gb[G.a.De.id]=Rb,Gb[G.a.Ge.id]=Rb);Gb[z.a.font.id]=Xa;Gb[G.a.ve.id]=Rb;if(Object(qa.a)()){Xa=1==Ra;var qb=1==ab;
if(Xa||qb)Gb[z.a.bold.id]=Xa,Gb[z.a.italic.id]=qb}}break;case la.a.Us:Xa=fc.a.instance.GBa(Aa,Xa);Gb[z.a.fontColor.id]=Xa;break;case la.a.Nha:qb=fc.a.instance.GBa(Aa,Xa);Gb[z.a.fontColor.id]=qb;this.recentColors.fcb(Xa)||H.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.u2:Gb[z.a.fontColor.id]=Eb.a.auto;break;case la.a.bY:Gb[z.a.highlight.id]=parseInt(Xa,16);break;case la.a.E8:Gb[z.a.highlight.id]=parseInt(Xa,16);this.recentColors.fcb(Xa)||
H.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.dta:Gb[z.a.highlight.id]=Eb.a.auto;break;case la.a.Av:Gb[z.a.fontSize.id]=this.ze.Q0b(Xb.vd);break;case la.a.gO:Gb[z.a.fontSize.id]=this.iGl(rc.fontSize);break;case la.a.xO:Gb[z.a.fontSize.id]=this.Ozl(rc.fontSize);break;case la.a.p1a:if(Xa=null===(qb=pb.zz)||void 0===qb?void 0:qb.p1a)for(const Zb of Xa.Aj())Gb[Zb.id]=Xa.Nf(Zb);break;case la.a.clearFormatting:if(Xa=xb.Vm)for(const Zb of Xa.Aj())Gb[Zb.id]=
null;Gb[G.a.Vyb.id]=!0;break;case la.a.xBa:case la.a.yBa:case la.a.zYa:case la.a.ata:case la.a.AYa:rc.jOa&&2===rc.capitalization&&(Gb[A.a.capitalization.id]=0)}null!=Va&&(Gb[l.AFrameworkApplication.Tef]=Va);return Gb}iGl(Aa){Aa=this.ze.gO(Aa);return this.ze.Q0b(Aa)}Ozl(Aa){Aa=this.ze.xO(Aa);return this.ze.Q0b(Aa)}cgc(Aa,xb,gb,Xa){var Va=Aa.cache;const Gb=Object(I.a)(18,gb);switch(xb){case la.a.bold:2===gb.value&&(gb.value=Va.isBold?0:1);this.ze.mG(Aa,1===gb.value);break;case la.a.setItalic:2===gb.value&&
(gb.value=Va.isItalic?0:1);this.ze.setItalic(Aa,1===gb.value);break;case la.a.underline:2===gb.value&&(gb.value=Va.isUnderline?0:1);this.ze.o4(Aa,1===gb.value);break;case la.a.Uha:this.ze.Uha(Aa,gb);break;case la.a.superscript:2===gb.value&&(gb.value=Va.isSuperscript?0:1);this.ze.mca(Aa,1===gb.value);break;case la.a.subscript:2===gb.value&&(gb.value=Va.isSubscript?0:1);this.ze.kpa(Aa,1===gb.value);break;case la.a.strikethrough:6!==l.AFrameworkApplication.ya.bH?H.ULS.sendTraceTag(539305613,340,50,
"User used strikethrough from ribbon"):H.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===gb.value&&(gb.value=Va.isStrikethrough?0:1);this.ze.K8(Aa,1===gb.value);break;case la.a.ur:2===gb.value&&(gb.value=Va.isDoubleStrikethrough?0:1);this.ze.ggc(Aa,1===gb.value);break;case la.a.font:if(Gb&&Gb.vd){const {fontName:Xb,a9:rc,bold:qb,italic:Zb}=pb.Uif(Gb.vd);this.ze.S_(Aa,Xb.substr(0,pb.Uwi));this.ze.Bgc(Aa,rc);Object(qa.a)()&&(gb=1==qb,Xa=1==Zb,gb||Xa)&&(this.ze.mG(Aa,
gb),this.ze.setItalic(Aa,Xa))}break;case la.a.Us:H.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.ze.Us(Aa,gb,null);break;case la.a.Nha:this.ze.Us(Aa,gb,null);this.recentColors.fcb(gb)||H.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.u2:this.ze.u2(Aa);break;case la.a.bY:H.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.ze.xxa(Aa,gb);break;case la.a.E8:this.ze.xxa(Aa,
gb);this.recentColors.fcb(gb)||H.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.dta:this.ze.Xyd(Aa);break;case la.a.Av:this.ze.Av(Aa,Gb.vd);break;case la.a.gO:this.ze.N8h(Aa);break;case la.a.xO:this.ze.fcj(Aa);break;case la.a.l4:Va=gb.ia(G.a.noProof,!1);this.ze.A2f(Aa,gb.getValue(z.a.cC),Xa,Va);break;case la.a.p1a:this.ze.kae(Aa);break;case la.a.clearFormatting:this.ze.dla(Aa);break;case la.a.xBa:case la.a.yBa:case la.a.zYa:case la.a.ata:case la.a.AYa:Va.jOa&&
2===Va.capitalization&&this.ze.uFk(Aa)}}zEn(Aa,xb){la.a.clearFormatting===xb&&W.OutlineElementNavigator.fl(Aa).properties.removeProperty(z.a.UX)}epj(Aa,xb,gb){const Xa=Object(I.a)(18,xb);switch(Aa){case la.a.Us:this.QJ.Us(gb,xb);break;case la.a.Nha:this.QJ.Us(gb,xb);break;case la.a.Av:this.QJ.Av(gb,Xa.vd);break;case la.a.u2:this.QJ.u2(gb);break;case la.a.gO:this.QJ.gO(gb);break;case la.a.xO:this.QJ.xO(gb);break;case la.a.font:this.QJ.SXn(gb,Xa.vd);break;case la.a.bold:Aa=this.Qec(xb,z.a.bold,gb);
this.QJ.mG(gb,Aa);break;case la.a.setItalic:Aa=this.Qec(xb,z.a.italic,gb);this.QJ.setItalic(gb,Aa);break;case la.a.subscript:Aa=this.Qec(xb,z.a.subscript,gb);this.QJ.kpa(gb,Aa);break;case la.a.superscript:Aa=this.Qec(xb,z.a.superscript,gb);this.QJ.mca(gb,Aa);break;case la.a.strikethrough:Aa=this.Qec(xb,z.a.strikethrough,gb);this.QJ.K8(gb,Aa);break;case la.a.ur:Aa=this.Qec(xb,A.a.ur,gb),this.QJ.ggc(gb,Aa)}}Qec(Aa,xb,gb){2===Aa.value&&(Aa.value=gb?gb.ia(xb,!1)?0:1:0);return 1===Aa.value}x6l(Aa,xb){return this.ujh(Aa,
xb)||this.ujh(xb,Aa)}ujh(Aa,xb){return(1===Aa.specialIndentType||!Aa.specialIndentType)&&2===xb.specialIndentType}WNl(Aa){Aa=M.GraphIterator.$a(Aa);Aa.Ab(11);ca.moveToCell(Aa,0,0);Aa.Vd();Aa.Haa();return Aa.currentNode}Mwm(Aa){return!Aa||ua.SelectionEditor.om(Aa)||1===Aa.length&&ua.SelectionEditor.Ek(Aa.Qa)&&!ua.SelectionEditor.nib(Aa.Qa)?!1:!0}tui(Aa){pb.M3g.ub(Aa.contextId)||(H.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Aa.contextId),pb.M3g.Z(Aa.contextId,!0))}flm(Aa){return Aa===la.a.zYa||
Aa===la.a.xBa||Aa===la.a.yBa||Aa===la.a.ata||Aa===la.a.AYa}oyd(Aa,xb){const gb=Aa.node,Xa=gb.characterData.substr(Aa.cpBegin,Aa.cpEnd-Aa.cpBegin);this.gjb.set("Command",xb.toString());v.Health.instance.recordKpiUsage(this.kpiName,1,this.S6,this.gjb);xb=pb.glo(Xa,xb);gb.vxa(gb.characterData.substr(0,Aa.cpBegin)+xb+gb.characterData.substr(Aa.cpEnd));return 32}static get uj(){return pb.zz||(pb.zz=m.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Gw(){return pb.Om||(pb.Om=m.a.instance.Za("Box4.IExternalSelectionManager"))}static get Yg(){return X.ContextSetEditor.instance}static get ag(){return sa.a.instance}static get Mc(){return r.a.instance}static get $b(){return null!=
pb.Mog?pb.Mog:pb.Mog=m.a.instance.Pa("Box4.IFeatureHelper")}static get bZc(){return Na.App.BM}static get Kd(){return null!=pb.iyg?pb.iyg:pb.iyg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Dj(){return null!=pb.Kxg?pb.Kxg:pb.Kxg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get VGa(){return null!=pb.nxg?pb.nxg:pb.nxg=m.a.instance.resolve("Box4.TextFormattingHelper")}static get hd(){return null!=pb.Ftg?pb.Ftg:pb.Ftg=m.a.instance.resolve("Box4.List.IListReader")}static get xn(){return null!=
pb.qtg?pb.qtg:pb.qtg=m.a.instance.resolve("Box4.List.IListEditor")}static get Uf(){return ha.a.instance}static bzl(Aa,xb){return 42===Aa?xb:Aa!==xb||16===Aa?16:Aa}static ggh(Aa,xb){Aa.Khi||(xb.Khi?xb=Aa:xb.unit===Aa.unit&&k.a.b_(xb.value,Aa.value)||(xb.value=-1));return xb}static glo(Aa,xb){switch(xb){case la.a.xBa:return Aa.toLowerCase();case la.a.yBa:return 6!==l.AFrameworkApplication.ya.bH?H.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):H.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),Aa.toUpperCase();case la.a.zYa:case la.a.ata:return pb.mCk(Aa,xb===la.a.ata);case la.a.AYa:return pb.rno(Aa);default:return Aa}}static rno(Aa){let xb="";for(let gb=0;gb<Aa.length;gb++)xb=Aa.charAt(gb)===Aa.charAt(gb).toUpperCase()?xb+Aa.charAt(gb).toLowerCase():xb+Aa.charAt(gb).toUpperCase();return xb}static mCk(Aa,xb){let gb,Xa,Va=!0,Gb=Aa.length,Xb=0,rc=pb.Ayf(Aa,Xb,Gb);for(;0<Gb;){Xa=gb=!1;var qb=Gb;let Rb;var Zb=void 0;for(Zb=0;0<qb&&pb.HEk(Aa.charAt(Xb+
Zb));Zb++,qb--)Xa=pb.MUd(Aa.charAt(Xb+Zb));for(Rb=Zb;0<qb&&!(gb=pb.MUd(Aa.charAt(Xb+Zb)))&&" "!==Aa.charAt(Xb+Zb)&&"/"!==Aa.charAt(Xb+Zb);Zb++,qb--);qb=Zb-Rb;if(0>=qb)break;Xb+=Rb;Zb=Aa.substr(Xb,qb);Zb=Zb===Zb.toUpperCase();if(rc||!Zb)Aa=Va||Xa||xb?Aa.substr(0,Xb)+Aa.charAt(Xb).toUpperCase()+Aa.substr(Xb+1,qb-1).toLowerCase()+Aa.substr(Xb+qb):Aa.substr(0,Xb)+Aa.substr(Xb,qb).toLowerCase()+Aa.substr(Xb+qb);Gb-=qb+Rb;Xb+=qb;if(Va=gb)Xb++,Gb--,rc=pb.Ayf(Aa,Xb,Gb)}return Aa}static Ayf(Aa,xb,gb){for(;0<
gb&&!pb.MUd(Aa.charAt(xb));){if(Aa.charAt(xb)!==Aa.charAt(xb).toUpperCase())return!1;xb++;gb--}return!0}static Hwm(Aa,xb){for(var gb=0;0<xb&&!pb.MUd(Aa.charAt(gb));){if(Aa.charAt(gb)!==Aa.charAt(gb).toLowerCase())return!1;gb++;xb--}return!0}static MUd(Aa){return"."===Aa||"!"===Aa||"?"===Aa?!0:!1}static HEk(Aa){return-1==="0123456789".indexOf(Aa)&&Aa.toUpperCase()===Aa.toLowerCase()}static aPh(){const Aa=m.a.instance.Za("Common.ISystemInitiatedFeedback");Aa&&Aa.execute(xb=>{xb.logActivity("FontsSurveyActivity",
"FontsFloodgateSurvey")})}}pb.M3g=new J.a;pb.zz=null;pb.Om=null;pb.Uwi=31;Object(D.a)(pb,"TextFormattingActor",null,[])},1944:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(D.b)("BrowserCode",l)},1946:function(D,
L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(D.a)(l,"AtMentionAttributes",null,[])},1952:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";
e[e.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(D.b)("FindReplaceViewType",l)},1954:function(D,L,c){c.d(L,"a",function(){return l});var l;(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||(l={}))},1968:function(D,L,c){function l(b,h){h=Object.assign(new ca.a,{name:"LinkType",string:h});e(Oa.a.Yfm,b,[h])}function e(b,h,u,y=!0){h&&h.UILocation&&
Object(Ub.d)(b,y,Ub.e,0,h.UILocation,0,u)}function a(b,h){var u;return b===Yr.none?"none":null===(u=tu[b])||void 0===u?void 0:u[h]}function k(){const b=Ja.a.instance.Pa("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&w.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}c.r(L);var m=c(0),w=c(8),v=c(52),r=c(2),z=c(33),A=c(16),G=c(161),H=c(88);class I{constructor(b){this.E$f=0;this.eEb=this.ydc=this.O5a=null;this.$Q=r.AFrameworkApplication.ta.tq;
this.eX=b;this.eX.Jv(H.a.b5i);this.eX.oC(H.a.b5i,Object(v.a)(this,this.N7m,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.eEb)return w.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.eEb;this.O5a=this.$Q.jg("ComponentAttach","getCustomAuthConfig");return this.eEb=new Promise((b,h)=>{const u={};let y=!1,P=!1,aa=0;this.E$f=window.setInterval(()=>{4>aa?(aa++,this.eX.sendMessage(H.a.getCustomAuthConfig,u)):(window.clearInterval(this.E$f),y=!0,w.ULS.sendTraceTag(588087303,
344,10,z.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.ydc=(ta,Pa)=>{window.clearInterval(this.E$f);y||P||(P=!0,ta?(w.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ta)):(w.ULS.sendTraceTag(589050654,369,10,z.c({["error"]:Pa.toString()})),h(Pa)))};this.eX.sendMessage(H.a.getCustomAuthConfig,u)})}N7m(b){try{const h=z.a(b.Values[G.a.Cxk]);let u=r.AFrameworkApplication.K.lb("Application")||"";u=A.a.jh(u);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
u+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+u+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+u+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+u+"%3Facctsw%3D1";this.O5a&&(this.O5a.stop(),this.O5a=null);this.ydc(h,"")}catch(h){w.ULS.sendTraceTag(589050655,344,10,z.c({["error"]:h.message,["stack"]:h.stack})),this.ydc(null,h.message)}}}Object(m.a)(I,"AccountSwitchingManager",
null,[151]);var K=c(177);class F{get name(){return"Common.App.AccountSwitching"}xc(b){b.register(I,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Xd(()=>new I(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){K.a.instance.Kc(new F)}}Object(m.a)(F,"AccountSwitchingPackage",null,[1,2]);var J;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=
2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(J||(J={}));Object(m.b)("ErrorCodes",
J);c(1749);class N{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(m.a)(N,"OutstandingRequest",null,[]);class O{}O.iYm="AADSTS50058";O.invalidResourceUrl="AADSTS50001";O.bYm="AADSTS65001";O.MYm="AADSTS70011";O.userAborted="13002";O.Bin="Popup Window is null";O.Ain="Popup Window closed";O.adalTimeout="Token renewal operation failed due to timeout";O.zno="tokenRevoked";Object(m.a)(O,"WopiHostErrorType",null,[]);var M=c(595),T=
c(61),R=c(1748);class W{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(m.a)(W,"WopiIdentityInfo",null,[778]);class V{constructor(b,h,u){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=u}}Object(m.a)(V,"WopiIdentityToken",null,[777]);var ba=c(15),ha=c(142),ca=c(28),ia=c(181);class ra{constructor(b){this._initialized=!1;this.Dcc={};this.Pde={};this.$Q=r.AFrameworkApplication.ta.tq;
this.Kqf=b}Oaf(b){this._initialized||(b.Jv(H.a.mdc),b.oC(H.a.mdc,Object(v.a)(this,this.M7m,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,u=null){this.Dga(b,h);return new Promise((y,P)=>{if(this.Ttf(h))if(h in this.Dcc)P("unresolvedPendingRequest");else{var aa=window.setTimeout(()=>{w.ULS.sendTraceTag(37856032,344,10,z.c({["error"]:"Request timeout.",["callerId"]:h}));P("timeout")},12E4);this.Dff(b,h,u,(ta,Pa)=>{window.clearTimeout(aa);ta?y(ta):(w.ULS.sendTraceTag(37856033,369,
15,z.c({["error"]:J[Pa]})),P(Pa))})}else w.ULS.sendTraceTag(37856034,344,10,z.c({["error"]:"Caller is not allowed."})),P("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,u)=>{this.Ttf(b)?this.XPl((y,P)=>{y?h(y):(w.ULS.sendTraceTag(37856064,369,10,z.c({["error"]:P.toString()})),u(P))}):(w.ULS.sendTraceTag(37856065,344,10,z.c({["error"]:"Caller is not allowed."})),u("notAllowed"))})}getAuthContext(b){return new Promise((h,u)=>{const y=this.getAuthContextSync(b);y?h(y):u("notAllowed")})}getAuthContextSync(b){if(this.Ttf(b)){const h=
new R.a;h.upn=r.AFrameworkApplication.K.lb("UserPrincipalName");h.userId=r.AFrameworkApplication.K.lb("LoggableUserId");h.authority=r.AFrameworkApplication.K.lb("HostAuthAuthority");h.tenantId=r.AFrameworkApplication.K.lb("TenantId");h.isAnonymous=r.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.p9l(b);b=r.AFrameworkApplication.K.lb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}w.ULS.sendTraceTag(40751647,344,10,z.c({["error"]:"Caller is not allowed."}));
return null}p9l(b){const h=M.OAuthManagerSettings.aOc;return ba.a.qPa?h&&M.OAuthManagerSettings.fhj?Array.contains(M.OAuthManagerSettings.fhj,b.toLowerCase()):!1:h}Dff(b,h,u,y){var P=[];Array.add(P,Object.assign(new ca.a,{name:"CallerId",string:h}));Array.add(P,Object.assign(new ca.a,{name:G.a.m7f,string:b.correlationId}));ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:P}));P=T.a.create().toString();const aa="getAccessToken_"+
P,ta=this.$Q.jg("ComponentAttach",aa);this.Pde[aa]=ta;const Pa={};Pa[G.a.n7f]=P;Pa[G.a.peo]=b.resource;Pa[G.a.qeo]=b.scope;Pa[G.a.Qdj]=r.AFrameworkApplication.K.lb("HostAuthType");Pa[G.a.teo]=r.AFrameworkApplication.K.lb("UserPrincipalName");Pa[G.a.reo]=b.silentLogin;Pa[G.a.meo]=b.options;Pa[G.a.m7f]=b.correlationId;Pa[G.a.neo]=h;u&&(Pa[G.a.addinName]=u.AddinName,Pa[G.a.leo]=u.AddinTrustId);this.Kqf.execute(vb=>{this.Oaf(vb);vb.sendMessage(H.a.getAuthToken,Pa)});this.Dcc[P]=new N(b,y)}XPl(b){const h=
r.AFrameworkApplication.K.lb("UserName"),u=r.AFrameworkApplication.K.lb("UserPrincipalName"),y=r.AFrameworkApplication.K.lb("LoggableUserIdSpace"),P=new W;P.email=u;P.displayName=h;switch(y){case "OrgIdPuid":P.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":P.authority="MicrosoftAccount";break;default:P.authority=y}b(P,null)}M7m(b){let h=null;try{let y=b.Values[G.a.n7f];const P=b.Values[G.a.keo],aa=b.Values[G.a.Qdj],ta=b.Values[G.a.seo];let Pa=null,vb=null;const Kb=this.Dcc[y];
if("undefined"!==typeof Kb&&Kb){var u=[];Array.add(u,Object.assign(new ca.a,{name:G.a.m7f,string:Kb.requestParameters.correlationId}));ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:u}));h=Kb.requestCallback;delete this.Dcc[y];"undefined"!==typeof P&&P&&P.length?vb=new V(P,aa,ta):Pa=J[this.BQm(b)];u="getAccessToken_"+y;u in this.Pde&&(this.Pde[u].stop(),delete this.Pde[u]);h(vb,Pa)}else w.ULS.sendTraceTag(37856066,
344,10,z.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:y}))}catch(y){b=b.Values[G.a.n7f],b in this.Dcc&&delete this.Dcc[b],this.GXd(),w.ULS.sendTraceTag(37856067,344,10,z.c({["error"]:y.message,["stack"]:y.stack})),h&&h(null,"generalException")}}Ttf(b){var h=r.AFrameworkApplication.k0l();b=b.toLowerCase();for(const u of h)if(b===u.toLowerCase())return!0;h=M.OAuthManagerSettings.bVe;for(let u in h)if(b===h[u].toLowerCase())return!0;return!1}BQm(b){b=b.Values[G.a.oeo];
this.GXd();w.ULS.sendTraceTag(39068821,344,15,z.c({["error"]:b}));return b?-1<b.indexOf(O.iYm)?9:-1<b.indexOf(O.Bin)||-1<b.indexOf(O.Ain)?12:-1<b.indexOf(O.invalidResourceUrl)?10:-1<b.indexOf(O.userAborted)?8:-1<b.indexOf(O.MYm)||-1<b.indexOf(O.bYm)||b===O.zno?11:-1<b.indexOf(O.adalTimeout)?6:0:13}Dga(b,h){b=this.nxn(b.resource);w.ULS.sendTraceTag(39921882,344,50,z.c({["callerId"]:h,["resource"]:b}))}GXd(){w.ULS.sendTraceTag(39068822,344,50,z.c({["userAgent"]:window.navigator.userAgent}))}nxn(b){return(b?
b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(m.a)(ra,"WopiIdentityManager",null,[752]);class da{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}xc(b){this.W=b;b.register(ra,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Xd(()=>new ra(b.Za("Postmessage.IHostPostmessenger")))}init(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.lp(Object(v.a)(this,this.rx,"onFullAppSettingsReady"))}rx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){w.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){K.a.instance.Kc(new da)}}Object(m.a)(da,"WopiIdentityPackage",null,[1,2]);var za=c(546),la=c(376),na=c(68),Ca;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ca||(Ca={}));Object(m.b)("ApplicationFeatureHelperRequestType",Ca);class Na{constructor(){this.message=null;this.httpStatusCode=
0}}Object(m.a)(Na,"HttpRequstToPromiseRejectData",null,[]);var Ta=c(80),Fa=c(46),qa=c(185);class ja{constructor(b,h){this.Ma=b;this.rg=h}A4e(b,h,u,y=null,P=null,aa=null,ta=null,Pa=null){const vb=Ca[u],Kb=vb+"RequestFailure";Ta.Health.instance.recordKpiUsage(Kb,0,"jpittsdirects",null);return new Promise((Sb,Yb)=>{w.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",vb);const Ac=null!=ta?ta:this.Ma.pc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),Sc=null!=Pa?Pa:this.Ma.pc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.rg.dZb(b,1,null,this.NEl(u,y),aa,1,nd=>{w.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",vb);try{if(void 0===nd||null===nd||void 0===nd.data||null===nd.data||void 0===nd.data.Ae||null===nd.data.Ae){Ta.Health.instance.recordKpiFailure(Kb,"Invalid RequestSucceededEventArgs",!1,!0,null);let he=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
vb);Yb(this.eMc(he,nd))}else if(nd.data.jf!==qa.a.tB){Ta.Health.instance.recordKpiFailure(Kb,"HttpStatusCode_"+nd.data.jf.toString(),!1,!0,null);let he=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",nd.data.jf,vb);Yb(this.eMc(he,nd))}else{void 0!==P&&null!==P&&void 0!==nd.data.Bj&&null!==nd.data.Bj&&P(nd.data.Bj);var Ad=h(nd.data.Ae);if(Ad)w.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",vb),Sb(Ad);else{Ta.Health.instance.recordKpiFailure(Kb,"Parse Failure",!1,!0,null);let he=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",vb);Yb(this.eMc(he,nd))}}}catch(he){Ta.Health.instance.recordKpiFailure(Kb,"Unexpected Failure",!1,!0,null),Ad=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
he,vb),Yb(this.eMc(Ad,nd))}},nd=>{if(nd.data){Ta.Health.instance.recordKpiFailure(Kb,"HttpStatusCode_"+nd.data.jf.toString(),!1,!0,null);var Ad=A.a.mmf(nd.data.Ae||"No Data");Ad=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",nd.data.jf,Ad,vb)}else Ta.Health.instance.recordKpiFailure(Kb,"Invalid RequestFailedEventArgs",!1,!0,null),Ad=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
vb);Yb(this.eMc(Ad,nd))},void 0,void 0,Ac,Sc)})}eMc(b,h){const u=new Na;u.message=b;u.httpStatusCode=h&&h.data?h.data.jf:-1;return u}NEl(b,h){const u={};u["x-UserDataSignature"]=this.Ma.lb("UserDataSignature");u["x-LicensingIsEnabled"]=this.Ma.$("LicensingIsEnabled").toString();u["x-CacheIsEnabled"]=this.Ma.$("LicensingRedisIsEnabled").toString();u["x-OcpsIsEnabled"]=this.Ma.$("OcpsIsEnabled").toString();u["x-LicensingAADIdIsEnabled"]=this.Ma.$("LicensingAadIdIsEnabled").toString();0===b&&(u["x-LicenseCheckOnTenantEnabled"]=
"true",u["x-SupportUserConsentDependentFeatures"]="true",u["x-AFHUserConsentGroupValue"]="0",u["x-UseShellServiceForUserConsentGroup"]="true",u["x-SMBUserLicensingEnabled"]="true",u["x-AFHPIPLComplianceEnabled"]=Fa.a.rT(window.location.href,"wd_afhpipl")||"false");if(h)for(let y of h.keys)u[y]=h.J(y);return u}}Object(m.a)(ja,"HttpRequestToPromiseUtility",null,[]);var X;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(X||(X={}));Object(m.b)("AlternateAuthSupportApp",X);class ua{constructor(){this.Token=
null;this.ExpirationTime=0}}Object(m.a)(ua,"WacAlternateAuthToken",null,[]);class Ha{constructor(b,h){this.xno=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=b;this.o$c=new za.a(la.a.Ri());this.hrc=new ja(b,h);void 0!==M.OAuthManagerSettings.bDf&&null!==M.OAuthManagerSettings.bDf&&void 0!==M.OAuthManagerSettings.mYd&&null!==M.OAuthManagerSettings.mYd&&0<M.OAuthManagerSettings.mYd&&(b=new ua,b.Token=M.OAuthManagerSettings.bDf,
b.ExpirationTime=M.OAuthManagerSettings.mYd,this.o$c.Z("loki",b))}Csl(){let b=null;this.o$c.ub(X[0])&&(b=this.o$c.J(X[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.Fgl():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-Date.now()<this.xno}Fgl(){const b=new za.a(la.a.Ri());b.Z("X-AlternateAuthApp",X[0]);return this.hrc.A4e(this.igb("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.men,"parseAlternateAuthTokenResponse"),2,b).then(h=>{w.ULS.sendTraceTag(545821456,
3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",X[0]);this.o$c.Z(X[0],h);return h.Token},h=>{h=Object(na.a)(Na,h);w.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}men(b){let h=null;({Uv:h}=z.d(b));w.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}igb(b){return String.format("{0}{1}?{2}",
this.Ma.lb("WebServiceBase"),b,r.AFrameworkApplication.Gm)}}Object(m.a)(Ha,"AlternateAuthHelper",null,[716]);var Ea=c(482);class wa{constructor(b,h,u){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=u}}Object(m.a)(wa,"FeatureStateChangeArgs",null,[]);var sa=c(114),fa=c(198),Ma=c(77),Ua=c(119),Qa;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Qa||(Qa={}));Object(m.b)("FeatureState",Qa);var Ja=c(22),Wa=c(13),Ya=c(134);class sb{constructor(b,
h,u=null,y=null,P=null){this.mfb=this.iAa=this.I2g=this.E$a=this.Mqd=null;this.hrc=new ja(b,h);this.Ma=b;this.ITj=b.pc("LicensingMaxRetryAttempts",0);this.Fhd=b.$("IsO365ConsumerHost");this.tze=b.$("IsO365CommercialHost");this.uhd=b.$("PremiumUpsellIsEnabled");this.TBe=0;this.jEg=u;this.z$g=y;this.ga=P;this.D$a=b.$("LicensingIsEnabled");this.fub=b.$("OcpsIsEnabled")&&this.tze;this.lQe=b.$("ShowPrivacyDialog")&&!!y;this.JTb=b.$("IsAnonymousUser");this.hcf=new Promise(aa=>{aa(!1)});this.uob=new Promise(aa=>
{aa(!0)});this.lfb=new za.a(la.a.Ri());this.etd=!0;this.FUg=this.gIl();this.Z1a()&&!this.JTb?(void 0!==r.AFrameworkApplication.ta&&null!==r.AFrameworkApplication.ta&&(this.Mqd=r.AFrameworkApplication.ta.tq,void 0!==this.Mqd&&null!==this.Mqd&&(this.E$a=this.Mqd.XPa("WebServiceCall","ApplicationFeatureHelperService"))),this.mfb=this.$ag()):this.mfb=new Promise(aa=>{aa({})});this.mfb.catch(aa=>{aa=Object(na.a)(Na,aa);w.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",
aa?aa.httpStatusCode.toString():"Unknown")});this.etd&&(this.uhd=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(aa=>{this.uhd=this.Ma.$("PremiumUpsellIsEnabled")&&aa;return null}))}gIl(){const b=this.Ma.Sv("AllLicensedFeatures")?this.Ma.XB("AllLicensedFeatures"):[],h=new Ea.a;for(let u=0;u<b.length;u++)h.add(b[u]);return h}Z1a(){return this.tze||this.Fhd}$ag(b=0,h=!1){w.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const u=sa.a.AF();
u&&(u.set("retryAttempt",b.toString()),u.set("forceRefresh",h.toString()),u.set("isO365ConsumerHost",this.Fhd.toString()),u.set("isO365CommercialHost",this.tze.toString()),u.set("isFreemiumUpsellSettingEnabled",this.uhd.toString()));Ta.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",u);Ta.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",u);void 0!==this.E$a&&null!==this.E$a&&this.E$a.start();let y=null;h&&(y=new za.a(la.a.Ri()),
y.Z("x-LicensingForceRefresh","true"));this.I2g=new Date;return(this.D$a?this.hrc.A4e(this.igb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.ren,"parseApplicationFeatureHelperResponse"),0,y,Object(v.a)(this,this.Jln,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(P=>{const aa=Object.assign(new Ya.a,{durationMs:this.Kej()});aa.extendedProperties=u;aa.extendedProperties&&P&&(aa.extendedProperties.set("featureCount",Ma.a.count(P).toString()),
aa.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in P).toString()),aa.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in P).toString()),"FreemiumUpsell"in P&&aa.extendedProperties.set("isFreemiumUpsellEnabled",P.FreemiumUpsell.toString()),this.iAa&&aa.extendedProperties.set("fromCache",(this.iAa<this.I2g).toString()));Ta.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",aa);return P},P=>{const aa=Object.assign(new Ya.a,{durationMs:this.Kej()}),
ta=Object(na.a)(Na,P);if(!ta)return w.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Ta.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,aa),new Promise((Pa,vb)=>{vb(P)});aa.extendedProperties=u;aa.extendedProperties&&aa.extendedProperties.set("status",ta.httpStatusCode.toString());Ta.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",
!1,!0,aa);return 408===ta.httpStatusCode&&++b<=this.ITj?this.$ag(b):new Promise((Pa,vb)=>{vb(ta)})})}ren(b){(b=z.b(b))?(w.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),w.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):w.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}igb(b){var h=String.format("{0}{1}",this.Ma.lb("WebServiceBase"),b);this.Ma.Sv("ApplicationFeatureHelperHttpCachingEnabled")&&
this.Ma.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=sb.bLd(this.Ma))&&0<b.length&&(this.etd&&(b+="ucbf"),h=new fa.QueryStringBuilder(h),h.Pe("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.fub&&!this.lQe&&!this.D$a)return this.uob;w.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var u=this.fub?this.jEg.raa("ControllerConnectedServicesEnabled"):this.uob;const aa=
this.lQe?this.z$g.getSettings().then(ta=>2!==ta.mI,()=>h):this.uob;return u.then(ta=>ta?aa:this.hcf)}u=null;u=this.fub?this.jEg.isFeatureEnabled(b):this.uob;let y=null;y=this.D$a?this.rom(b,h):this.uob;let P=null;P=this.lQe?this.z$g.isFeatureEnabled(b):this.uob;return u.then(aa=>aa?P.then(ta=>ta?y:this.hcf):this.hcf).then(aa=>{this.zti(b,aa,!0);return aa},()=>{this.zti(b,h,!1);return h})}zti(b,h,u){w.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,u)}getFeatureTier(b,
h){if(!this.D$a)return new Promise(u=>{u(2)});w.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.mfb.then(u=>this.YMd(b,u,h),()=>h)}isFreemiumUpsellEnabled(){const b=this.uhd&&this.Fhd&&!this.JTb;if(b&&2!==this.TBe||!b&&1!==this.TBe)w.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isO365ConsumerHost={0}, isAnonymousUser={1}, isFreemiumUpsellEnabled={2}",this.Fhd.toString(),this.JTb.toString(),
b.toString()),this.TBe=b?2:1;return b}launchUpsellExperience(b,h=null){w.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var u=sa.a.AF();u&&(u.set("experienceId",b),h&&u.set("campaignId",h));Ta.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",u);if(u=Ja.a.instance.Pa("Common.IInProductMessagingUIManager")){const y=Object(v.a)(this,this.A2l,"handleDimeTaskComplete");u.ari(b,
y,h)}else w.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Ta.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Ub(Wa.a.hId,2,{["experience"]:b})}Wwa(b,h){if(!this.D$a)return null;if(!b||!h)return w.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const u=Ua.a.create().toString();this.lfb.ub(b)||this.lfb.Z(b,new za.a(la.a.Ri()));this.lfb.J(b).add(u,
h);w.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",u,b));return u}oec(b,h){this.D$a&&(b&&this.lfb.ub(b)?h&&Ua.a.isValid(h)?this.lfb.J(b).ub(h)?(w.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.lfb.J(b).remove(h)):w.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",
h,b)):w.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):w.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}YMd(b,h,u){return this.etd?b in h?h[b].LicenseTier:u:b in h?this.bfn(h[b],u):u}bfn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;
default:return h}}A2l(){w.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.mfb.then(b=>{this.NSi(b)}).catch(()=>{this.NSi({})})}NSi(b){w.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.$ag(0,!0);h.then(u=>{this.mfb=h;Ma.a.count(u)>Ma.a.count(b)?Ta.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Ta.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",
!1,!0,null);for(let y of this.lfb.keys)if(y in u){const P=this.YMd(y,u,0);y in b?this.YMd(y,b,0)!==P&&this.dJf(y,!0,P):this.dJf(y,!0,P)}else y in b&&this.dJf(y,!1,this.YMd(y,b,0))}).catch(u=>{Ta.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);w.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(u))})}dJf(b,h,u){w.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
b,h,u);h=new wa(b,h,u);u=this.lfb.J(b);for(let y of u)try{y.value(h)}catch(P){w.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,y.key,P.message))}}qom(b,h){if(this.D$a){const u=this.FUg.contains(b);let y=!0,P="",aa=!1;return this.mfb.then(ta=>{b in ta?(ta=ta[b],P=Qa[ta.FeatureState],y=1!==ta.FeatureState):y=!u;this.Nti(b,u,P,aa,h,y);return y},()=>{aa=!0;
u&&(y=h);this.Nti(b,u,P,aa,h,y);return y})}return this.uob}Nti(b,h,u,y,P,aa){w.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,y,u,P,aa)}rom(b,h){if(this.etd)return this.qom(b,h);if(this.D$a){if(this.FUg.contains(b))return this.mfb.then(u=>b in u,()=>h);w.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
b)}return this.uob}Jln(b){try{b&&"Date"in b&&(this.iAa=new Date(b.Date),w.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.iAa.toString()))}catch(h){w.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",h)}}Kej(){if(void 0!==this.E$a&&null!==this.E$a){const b=this.E$a.vi;this.E$a.stop();return b}return null}static bLd(b){try{if(ba.a.oee){const h=b.lb("UserDataSignature").split(".");if(1<h.length){const u=
window.self.atob(h[1]),y=JSON.parse(u).LocalStorageKey;if(void 0!==y&&null!==y&&0<y.length)return y}}}catch(h){w.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(m.a)(sb,"ApplicationFeatureHelper",null,[717]);var ob=c(82);class fc{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(m.a)(fc,"CloudPolicySettingsCacheData",
null,[]);var Eb=c(1347),Ib=c(379),Nb=c(240);class pb{static lcj(){return r.AFrameworkApplication.K.$("SideCarIsEnabled")?pb.c$d&&pb.sQc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{pb.c$d=Nb.a.create(r.AFrameworkApplication.K.lb("SideCarUrl"));Ib.a.eT(pb.c$d);pb.c$d.lW((u,y)=>{(pb.sQc=y.succeeded)?b(y.succeeded):h(y.succeeded)})}):new Promise(b=>{b(!1)})}}pb.sQc=!1;pb.c$d=null;Object(m.a)(pb,"SideCarLoader",null,[]);class Aa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(m.a)(Aa,"CloudPolicySettingsData",null,[]);class xb{constructor(b,h){this.Doe=0;this.szd=null;this.hrc=new ja(b,h);this.Ma=b;h=b.lb("HostAuthType");this.fub=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.kYg=z.b(b.lb("OcpsDefaultSettings")||"{}");this.Dtc=this.bLd();h=this.Ma.Sv("ServicesControlsMicrosoftControllerServicesList")?this.Ma.XB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.zbd=new Ea.a;for(let u=0;u<
h.length;u++)this.zbd.add(h[u]);this.fub&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.szd=this.cro():this.szd=this.Zag(this.fub,this.igb("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.ven,"parseCloudPolicySettingsResponse"));this.szd.then(()=>null).catch(u=>{u=Object(na.a)(Na,u);w.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",u?u.httpStatusCode.toString():"Unknown")})}raa(b,h=!0){if(!this.fub){const aa=this;return new Promise(ta=>
{ta(aa.GLc(b))})}let u=this,y=this;const P=this.szd.then(aa=>{try{let ta=null;aa.PolicySettings&&"unknown"in aa.PolicySettings&&(ta=aa.PolicySettings.unknown);if(ta){if(b in ta&&void 0!==ta[b]&&null!==ta[b])return new Promise(vb=>{vb("0"!==ta[b])});const Pa=b.toLowerCase();if(Pa in ta&&void 0!==ta[Pa]&&null!==ta[Pa])return new Promise(vb=>{vb("0"!==ta[Pa])});w.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(vb=>{vb(u.GLc(b))})}return new Promise(Pa=>{Pa(u.GLc(b))})}catch(ta){return w.ULS.sendTraceTag(50622686,
3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ta.message),u.handleError(ta.toString(),h,u.GLc(b))}},aa=>y.handleError(aa,h,y.GLc(b)));P.then(aa=>{w.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,aa);return null});return P}isFeatureEnabled(b,h=!0){if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.tom(b,h);let u=new Promise(P=>{P(!0)}),
y="";this.zbd.contains(b)&&(y="ControllerConnectedServicesEnabled",u=this.raa(y,h));u.then(P=>{w.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,y);return null});return u}tom(b,h=!0){let u=new Promise(P=>{P(!0)}),y="";"mso_sendASmile"===b?y="Enabled":"Survey"===b||"FloodgateSurvey"===b?y="SurveyEnabled":this.zbd.contains(b)&&(y="ControllerConnectedServicesEnabled");""!==y&&(u=this.raa(y,h));u.then(P=>{w.ULS.sendTraceTag(558187080,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,y);return null});return u}handleError(b,h,u){return h?new Promise(y=>{y(u)}):new Promise((y,P)=>{P(b)})}Zag(b,h,u){if(!b)return Promise.resolve(new Aa);let y=!1,P=null;Ta.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let aa=this.O3e("GetCloudPolicySettings");return(new Promise((ta,Pa)=>{if(void 0!==this.Dtc&&null!==this.Dtc&&0<this.Dtc.length){const vb=this.Gqo();
if(void 0!==vb&&null!==vb){y=!0;ta(vb);return}}this.hrc.A4e(h,u,1,null,Object(v.a)(this,this.Vln,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ma.pc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ma.pc("CloudPolicySettingsRequestSentTimeout",3E4)).then(vb=>{w.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Mro(vb);ta(vb);return vb},vb=>{Pa(vb);return null})})).then(ta=>{({ry:aa,returnValue:P}=this.Lde(aa));var Pa=sa.a.AF();Pa&&Pa.set("FromCache",
y.toString());Pa=Object.assign(new Ya.a,{durationMs:P,extendedProperties:Pa});Ta.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Pa);return ta})}cro(){return pb.lcj().then(()=>{w.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}igb(b){return String.format("{0}{1}",this.Ma.lb("WebServiceBase"),b)}ven(b){let h=null;({Uv:h}=z.d(b));b=!!h;w.ULS.sendTraceTag(50622687,
3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}Vln(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.Doe=h)}}catch(h){w.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}GLc(b){return b in this.kYg?"0"!==this.kYg[b]:!0}Gqo(){try{const b=Eb.a.instance.getItem(this.Dtc);if(void 0===b||null===b)return w.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;w.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return w.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return w.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return w.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const u=new Aa;u.PolicySettings=h.PolicySettings;u.ControllerConnectedServicesFeatureNames=new ob.a;this.Ma.Sv("ServicesControlsMicrosoftControllerServicesList")&&this.Ma.XB("ServicesControlsMicrosoftControllerServicesList");for(let y of this.zbd)u.ControllerConnectedServicesFeatureNames.add(y);w.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return u}catch(b){return w.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}Mro(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)w.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Doe)w.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new fc(b,this.Doe),u=JSON.stringify(h);
w.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",u);Eb.a.instance.setItem(this.Dtc,u);w.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){w.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}bLd(){const b=sb.bLd(this.Ma);return b&&0<b.length?"OCPS"+b:null}O3e(b){const h=Ja.a.instance.Pa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
h&&null!==h?h.jg("WebServiceCall",b):null}Lde(b){if(void 0!==b&&null!==b){const h=b.vi;b.stop();return{returnValue:h,ry:null}}return{returnValue:null,ry:b}}}Object(m.a)(xb,"CloudPolicySettingsHelper",null,[714]);class gb{constructor(){this.IHh=this.yrj=this.mI=0;this.JHh=this.zrj=this.qzb="";this.wMe=this.gTa=2}clone(){const b=new gb;b.mI=this.mI;b.yrj=this.yrj;b.IHh=this.IHh;b.qzb=this.qzb;b.zrj=this.zrj;b.JHh=this.JHh;b.gTa=this.gTa;b.wMe=this.src;return b}get src(){return this.wMe}serialize(b=
null){const h={};if(!b||b.contains(gb.jIb))h[gb.jIb]=this.mI;if(!b||b.contains(gb.hWc))h[gb.hWc]=this.qzb;if(!b||b.contains(gb.iWc))h[gb.iWc]=this.gTa;return JSON.stringify(h)}static create(b,h=null){const u=new gb;u.wMe=b;void 0!==h&&null!==h&&(gb.jIb in h&&(u.mI=h[gb.jIb]),gb.hWc in h&&(u.qzb=h[gb.hWc]),gb.iWc in h&&(u.gTa=h[gb.iWc]));return u}static deserialize(b,h){try{const u=JSON.parse(b);if(void 0!==u&&null!==u)return gb.create(h,u);w.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(u){throw w.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",u.toString()),u;}}}gb.jIb="CCS";gb.hWc="CCSTime";gb.iWc="OfficePrivacyRoamedNoticeShown";Object(m.a)(gb,"UserPrivacySettings",null,[]);var Xa=c(128);class Va{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=b;this.rg=h;this.kLe=this.Pd=null}igb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ma.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(r.AFrameworkApplication.Gm);return h.toString()}executeRequest(b,h,u,y=null){return this.rg.eZb(b,h,y,null,u,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,u)=>{try{if(void 0===this.Pd||null===this.Pd||void 0===b||null===b)w.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),u("Can't determine setting changes to save");
else{var y=this.Pd.mI!==b.mI;if(2===this.Pd.src&&y)this.QPn(b),h(!0);else{var P=this.uUn(b);if(void 0===P||null===P||!P.length)w.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),u("No changes to save");else if(1===this.Pd.src)h(this.Nlj(P));else if(0===this.Pd.src){w.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",P);const aa=this.executeRequest(this.igb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
P);aa.continueWith(()=>{if(aa.yo||aa.Di)w.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ta=aa.result;void 0!==ta.args&&null!==ta.args&&void 0!==ta.args.data&&null!==ta.args.data&&ta.args.data.jf===qa.a.tB?(w.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(w.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(aa){w.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",aa.toString()),h(!1)}})}uUn(b){if(void 0===this.Pd||null===this.Pd||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new ob.a;0===b.src?(this.Pd.mI!==b.mI&&(h.add(gb.jIb),h.add(gb.hWc)),this.Pd.gTa!==b.gTa&&h.add(gb.iWc)):1===b.src&&this.Pd.mI!==b.mI&&h.add(gb.jIb);return h.count?b.serialize(h):(w.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.kLe){const b=this;this.kLe=new Promise(h=>{try{b.Pd?h(b.Pd.clone()):b.Xqo().then(u=>{b.Pd=u;h(b.Pd.clone());return null},()=>{b.Vqo().then(u=>{b.Pd=u;h(b.Pd.clone());return null},()=>{b.Wqo().then(u=>{b.Pd=u;h(b.Pd.clone());return null},()=>{w.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Pd=new gb;h(b.Pd.clone());return null});return null});return null})}catch(u){w.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
u.toString()),b.Pd=new gb,h(b.Pd.clone())}})}return this.kLe}Xqo(){return new Promise((b,h)=>{try{const y=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ma.$("PrivacyDialogShouldCheckRoaming")||y){var u=this.executeRequest(this.igb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");u.continueWith(()=>{try{if(u.yo||u.Di)w.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const P=u.result;if(P&&P.args&&P.args.data)if(P.args.data.jf!==
qa.a.tB)w.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",P.args.data.jf);else{if(P.args.data.Ae){b(Va.parse(P.args.data.Ae,0));w.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",P.args.data.Ae);return}w.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else w.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(P){w.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",P.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else w.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(y){w.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
y.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Vqo(){return new Promise((b,h)=>{try{const u=Xa.a.get("WacUPToggleState");let y=null;void 0!==u&&null!==u&&0<u.length&&(y=decodeURIComponent(u));if(void 0!==y&&null!==y&&0<y.length){const P=Va.parse(y,1);w.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",P.toString());b(P)}else{const P=gb.create(1),aa=new ob.a;aa.add(gb.jIb);const ta=P.serialize(aa);this.Nlj(ta)?
(w.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ta),b(P)):(w.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ta),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(u){w.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",u.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Wqo(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let u=gb.create(2);h?(u.mI=2,r.AFrameworkApplication.MFh(),w.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",u.toString())):(u.mI=1,w.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",u.toString()));b(u)}catch(u){w.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",u.toString()),
h=gb.create(2),h.mI=1,b(h)}})}QPn(b){w.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.mI?r.AFrameworkApplication.MFh():r.AFrameworkApplication.mal();w.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}Nlj(b){try{w.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ma.lb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
w.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Xa.a.w8i("WacUPToggleState",b,Xa.a.aQa,h)}catch(h){return w.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const u=this.Ma.Sv("ServicesControlsMicrosoftControllerServicesList")?this.Ma.XB("ServicesControlsMicrosoftControllerServicesList"):[],y=new Ea.a;for(let P=0;P<u.length;P++)y.add(u[P]);return y.contains(b)?
2!==h.mI:!0},()=>{w.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return w.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),gb.deserialize(b,h)}catch(u){throw w.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",u.toString()),u;}}}Object(m.a)(Va,"UserPrivacySettingsHelper",null,[715]);class Gb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}xc(b){this.W=
b;this.W.register(714,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Xd(()=>new xb(r.AFrameworkApplication.K,r.AFrameworkApplication.Ve));this.W.register(715,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Xd(()=>new Va(r.AFrameworkApplication.K,r.AFrameworkApplication.Ve));this.W.register(716,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Xd(()=>new Ha(r.AFrameworkApplication.K,r.AFrameworkApplication.Ve));
this.W.register(717,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Xd(()=>new sb(r.AFrameworkApplication.K,r.AFrameworkApplication.Ve,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),r.AFrameworkApplication.ya))}init(){r.AFrameworkApplication.K.lp(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");r.AFrameworkApplication.K.$("LicensingIsEnabled")&&
(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{w.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,r.AFrameworkApplication.K.lb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{w.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,r.AFrameworkApplication.K.lb("IsAnonymousUser"));
return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.Sko()})}dispose(){}Sko(){try{r.AFrameworkApplication.K.$("SideCarIsEnabled")&&pb.lcj().then(b=>{w.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){K.a.instance.Kc(new Gb)}}Object(m.a)(Gb,"ApplicationFeatureHelperPackage",null,[1,2]);var Xb=c(187);class rc{gLd(b,h){let u;const y=[];for(;u=h.exec(b);){const P=u.index;
y.push(new Xb.a(P,P+u[0].length))}return y}isEndPuncSpecialCase(b){const h=this.gLd(b,rc.fdo);for(const u of h)if(u.end===b.length)return!0;return!1}kIc(b){for(const h of rc.Ael){const u=this.gLd(b,h);if(0<u.length&&!u[0].begin)return u[0].end-1}return 0}findBeginBoundary(b,h,u){var y=b.substring(u,h);b=this.gLd(y,rc.zJh);for(h=b.length-1;0<=h;h--){const P=y.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return y=y.substring(b[h].begin,y.length),u+b[h].end+this.kIc(y)}return u}findEndBoundary(b,
h,u){var y=b.substring(h,u);b=this.gLd(y,rc.zJh);for(u=0;u<b.length;u++){const P=y.substring(0,b[u].end);if(!this.isEndPuncSpecialCase(P))return y=y.substring(b[u].begin,y.length),h+b[u].end+this.kIc(y)}return-1}}rc.Kbf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
rc.Lbf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";rc.Mbf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";rc.Ael=
[new RegExp(rc.Kbf,"ig"),new RegExp(rc.Lbf,"ig"),new RegExp(rc.Mbf,"ig")];rc.O6f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";rc.R6f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";rc.Q6f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
rc.P6f=rc.R6f+"|"+rc.Q6f;rc.S6f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";rc.T6f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";rc.U6f="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
rc.V6f="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";rc.g1f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
rc.P6f+"|"+rc.S6f+"|"+rc.T6f+")";rc.f1f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
rc.U6f+")";rc.MIf=rc.O6f+"|"+rc.V6f;rc.N6f=rc.MIf+"|"+rc.g1f+"|"+rc.f1f;rc.zJh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");rc.fdo=new RegExp(rc.N6f,"g");Object(m.a)(rc,"ProofingSentenceSeparatorScriptSharp",null,[713]);class qb{g9c(b,h){const u=[];let y;for(;null!=(y=h.exec(b));){const P=y.index;u.push({begin:P,end:P+y[0].length})}return u}isEndPuncSpecialCase(b){return this.g9c(b,qb.mAj).some(h=>
h.end==b.length)}kIc(b){for(const h of qb.Vwj){const u=this.g9c(b,h);if(0<u.length&&0==u[0].begin)return u[0].end-1}return 0}findBeginBoundary(b,h,u){var y=b.substring(u,h);b=this.g9c(y,qb.Ugg);for(h=b.length-1;0<=h;h--){const P=y.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return y=y.substring(b[h].begin,y.length),u+b[h].end+this.kIc(y)}return u}findEndBoundary(b,h,u){var y=b.substring(h,u);b=this.g9c(y,qb.Ugg);for(u=0;u<b.length;u++){const P=y.substring(0,b[u].end);if(!this.isEndPuncSpecialCase(P))return y=
y.substring(b[u].begin,y.length),h+b[u].end+this.kIc(y)}return-1}}qb.Nvj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";qb.hAj="[\u2639\u263a\u263b]";qb.ejg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";qb.Iwj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
qb.bzj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";qb.Ejg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
qb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
qb.djg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";qb.dyj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";qb.cyj="[\uff21-\uff3a\uff41-\uff5a]";qb.ayj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
qb.$xj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";qb.byj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";qb.Pje="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";qb.Tgg="[\u3002\uff61]";qb.A9c="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";qb.axj="[\u00bb\u2019\u201d\u203a\"']";qb.ike=qb.Nvj+"|"+qb.hAj;qb.eyj="[\u2028\u2029\n\r]";qb.Zxj="("+qb.A9c+"|"+qb.ejg+"|"+qb.Ejg+"|"+qb.djg+
")";qb.Yxj="("+qb.A9c+"|"+qb.ejg+"|"+qb.Ejg+"|"+qb.Symbol+"|"+qb.djg+"|"+qb.Iwj+"|"+qb.bzj+")";qb.Kbf="("+qb.Pje+"("+qb.ike+"|"+qb.axj+"|"+qb.A9c+")*"+qb.eyj+")";qb.Lbf="("+qb.Pje+"("+qb.ike+")*("+qb.A9c+")+)";qb.Mbf="("+qb.Tgg+"("+qb.ike+")*)";qb.Vwj=[new RegExp(qb.Kbf,"ig"),new RegExp(qb.Lbf,"ig"),new RegExp(qb.Mbf,"ig")];qb.O6f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";qb.R6f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
qb.Q6f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";qb.P6f=qb.R6f+"|"+qb.Q6f;qb.S6f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";qb.T6f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
qb.U6f="(("+qb.dyj+"|"+qb.ayj+"|"+qb.byj+")[.])+|(("+qb.$xj+")[.\ufe52\uff0e])+";qb.V6f="("+qb.cyj+")[.\ufe52\uff0e]";qb.g1f=qb.Zxj+"("+qb.P6f+"|"+qb.S6f+"|"+qb.T6f+")";qb.f1f=qb.Yxj+"("+qb.U6f+")";qb.MIf=qb.O6f+"|"+qb.V6f;qb.N6f=qb.MIf+"|"+qb.g1f+"|"+qb.f1f;qb.Ugg=new RegExp(qb.Pje+"|"+qb.Tgg,"ig");qb.mAj=new RegExp(qb.N6f,"g");Object(m.a)(qb,"ProofingSentenceSeparator",null,[713]);class Zb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}xc(b){this.W=b;r.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new qb).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new rc).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){K.a.instance.Kc(new Zb)}}Object(m.a)(Zb,"Box4GrammarCheckPackage",null,[1,2]);var Rb=c(86),Ra=c(11),ab=c(74),fb=c(65),bb=c(6),Ub=c(55),Oa=c(3);class Fc{constructor(b,h,u,y){this.pJe=this.pid=this.Nxe=this.ie=null;this.WSg=this.Lsb=this.Bja=this.sra=this.MBg=
!1;this.zda=0;this.f5f=!1;this.SIb=()=>{this.reset()};this.Fcb=P=>{this.zda=P.Ib.keyCode;var aa=P.Ib.rawEvent.key;aa&&aa!==Fc.fK||(this.f5f=!0);return this.Bja&&this.pid?P.Ib.keyCode===fb.a.A0||P.Ib.keyCode===fb.a.us||P.Ib.keyCode===fb.a.xx?(aa=!1,P.Ib.keyCode===fb.a.A0?(w.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),aa=!0):P.Ib.keyCode===fb.a.us?w.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):P.Ib.keyCode===fb.a.xx&&
w.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.pid(P),aa&&this.reset(),!0):P.Ib.keyCode===fb.a.Fia||P.Ib.keyCode===fb.a.f9||P.Ib.keyCode===fb.a.B0||P.Ib.keyCode===fb.a.C0||P.Ib.keyCode===fb.a.K4||P.Ib.keyCode===fb.a.XK?(this.pid(P),!0):!1:!1};this.Fpa=P=>{if(this.f5f||this.Bja){this.f5f=!1;var aa=this.RLc(),ta=this.BKc(P.Ib.target),Pa=P.Ib.rawEvent.inputType;return(void 0!==Pa&&null!==Pa||this.zda!==fb.a.sB&&this.zda!==fb.a.z0)&&"deleteContentBackward"!==
Pa&&"deleteContentForward"!==Pa?this.H9h(aa,ta,P.Ib.target):!1}};this.Nqk=P=>{if(1!==P.Ib.rawEvent.key.length)return!1;const aa=this.RLc(),ta=this.BKc(P.Ib.target);return this.H9h(aa,ta,P.Ib.target)};this.zPa=P=>{if(!this.Bja)return!1;const aa=this.RLc(),ta=this.BKc(P.Ib.target);(P.Ib.keyCode===fb.a.sB||P.Ib.keyCode===fb.a.z0||(P.Ib.keyCode===fb.a.yTa||P.Ib.keyCode===fb.a.jlc)&&P.Ib.ctrlKey)&&this.cpf(aa,ta,P.Ib.target);return!1};this.ZWe=(P,aa)=>{this.zda=aa.Ztf?fb.a.sB:aa.isDelete?fb.a.z0:this.zda;
this.Bja&&(aa.Ztf?this.Q1l(aa.eqi):aa.isDelete&&this.s2l(aa.eqi))};this.ke=b;this.Ej=h;this.dmc=u;this.fd=y;this.reset()}SBc(b,h){this.sra||(this.sra=!0,b.pva?this.Gcb(h):b.kea(()=>{this.sra||this.Gcb(h)}))}dispose(){this.Lsb&&(Ra.App.xa.Jic.sc(bb.a.input,this.fd.editingView.editingElement,this.Fpa),this.Lsb=!1);this.MBg&&(this.ie.sc(bb.a.Hwd,this.fd.editingView.editingElement,this.Nqk),this.MBg=!1);this.WSg&&(this.ie.sc(bb.a.hI,this.fd.editingView.editingElement,this.Fcb),this.ie.sc(bb.a.sh,this.fd.editingView.editingElement,
this.zPa));Ra.App.xa.Zba(this.SIb);this.Lej()}xTi(b){this.Nxe=b}KTi(b){this.pJe=b}yTi(b){this.pid=b}Tqk(){this.Bja=!0;r.AFrameworkApplication.Ce("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}Lej(){this.Bja=!1}zK(){return this.Bja}Gcb(b){this.ie=b;if(!this.fd.od)w.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.fd.od.mi){if(Ra.App.hCc&&ba.a.kee||ba.a.jt)Ra.App.xa.Jic.mb(bb.a.input,this.fd.editingView.editingElement,
this.Fpa,null),this.Lsb=!0;this.ie&&(this.ie.mb(bb.a.hI,this.fd.editingView.editingElement,this.Fcb),this.ie.mb(bb.a.sh,this.fd.editingView.editingElement,this.zPa),this.WSg=!0);this.dmc.Peh(this.ZWe);Ra.App.xa.jZ(this.SIb)}}H9h(b,h,u){if(1>h)return!1;b=b.replace(new RegExp(Fc.newLine,"g"),"");const y=b.charAt(h-1);this.Bja&&y!==Fc.fK?this.cpf(b,h,u):this.Bja||y!==Fc.fK?this.Bja&&y===Fc.fK&&w.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.Nxe&&(this.reset(),
this.Zkn(h,b)&&(this.Tqk(),this.cpf(b,h,u),w.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===h?"true":"false")));return this.Bja}reset(){this.sra=!1;this.Lej();this.pJe&&this.pJe()}BKc(b){return this.Ej.u4b(2,b)}RLc(){return this.ke.Zr().innerText}Zkn(b,h){return 0>b-2||this.rCk(h.charAt(b-2))?!0:!1}rCk(b){return A.a.eba(b)||"("===b}cpf(b,h,u){if(!b||""===b||0>h)this.reset();else{const {a2i:y,rwd:P}=this.NAm(b,h);this.Nxe(y,u,P)}}NAm(b,h){const u=this.mtl(b,h);if(0<=
u&&h<=b.length)return{a2i:b.substring(u,h),rwd:u};this.reset();return{a2i:"",rwd:u}}mtl(b,h){let u=-1,y=h;for(y;0<=y&&63>=h-y;y--)if(b.charAt(y)===Fc.fK){u=y;break}63<h-y&&-1==u&&Ub.c(Oa.a.hso,!0,void 0,void 0,void 0,void 0);return u}Q1l(b){b=this.BKc(b.Ib.target);b=this.RLc().charAt(b-1);this.Bja&&b===Fc.fK&&this.reset()}s2l(b){b=this.BKc(b.Ib.target);b=this.RLc().charAt(b);this.Bja&&b===Fc.fK&&this.reset()}}Fc.fK="@";Fc.newLine="\n";Object(m.a)(Fc,"AtMentionsListener",null,[711]);class xc{constructor(){this.W=
null}get name(){return"Box4.AtMentions"}xc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>new Fc(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),ab.InteractiveViewManager.instance)).singleInstance()}init(){r.AFrameworkApplication.K.lp(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").SBc(Ra.App.xa.jb,Rb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){K.a.instance.Kc(new xc)}}
Object(m.a)(xc,"Box4AtMentionsPackage",null,[1,2]);class pd{get name(){return"Box4.Workers"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new pd)}}Object(m.a)(pd,"Box4WorkersPackage",null,[1,2]);var lb=c(318),Tb=c(85);class pc{constructor(){this.VHa=new Tb.a}j4(b,h){this.VHa.Z(b,h)}Iff(b){({value:b}=this.VHa.Gc(b));return b}}Object(m.a)(pc,"AggregationMethodsForActivityName",null,[]);var Db=c(250);class Ob{constructor(){this.hnd=new lb.a;this.VHa=new lb.a}j4(b,h,u){this.VHa.ub(b)&&this.VHa.J(b)||
this.VHa.Z(b,new pc);this.VHa.J(b).j4(h,u)}Iff(b,h){return this.VHa.ub(b)&&this.VHa.J(b)?this.VHa.J(b).Iff(h):null}ZLc(b){this.hnd.ub(b)&&this.hnd.J(b)||this.hnd.Z(b,new Db.a);return this.hnd.J(b)}OCh(b,h){this.ZLc(b).add(h)}}Object(m.a)(Ob,"ActivityAggregationInfo",null,[750]);var jb=c(123),tb=c(971),ac=c(989);class zc extends tb.a{constructor(b,h){super(b);this.IPe=(this.bDj=h)?h.iDl():ac.a.vff()}get SAa(){return this.bDj}get activityName(){return this.SAa.name}get startTime(){return this.SAa.startTime}get endTime(){return this.SAa.endTime}end(){}cancel(){}mef(){}Bxo(){this.d4b.Z("AM",
this.SAa.mode.toString());this.d4b.Z("C",this.SAa.count.toString());this.d4b.Z("DA",this.SAa.VHh.toFixed(2));this.d4b.Z("DV",this.SAa.t9k.toFixed(2))}Klf(b){return this.SAa.Klf(b)}nmf(){return this.SAa.nmf()}hZb(){for(let b of this.SAa.TAa)b.hZb()}}Object(m.a)(zc,"AggregatedActivity",tb.a,[]);class yc{constructor(b,h){this.hme=0;this.sya=b;this.ATa=h}sik(b,h){this.hme=h;for(h=0;h<b.count;h++){const u=b.J(h);this.tik(u)}}tik(b){const h=Object(na.a)(zc,b);if(h)if(1===this.hme)this.rik(h);else if(2===
this.hme){this.uik(h);for(let u of this.ATa.ZLc(this.sya)){const y=h.SAa.TAa.J(0);y.properties.ub(u)&&b.properties.Z(u,y.properties.J(u))}}}rik(b){for(let h of this.ATa.ZLc(this.sya))this.n0i(b,h)}uik(b){for(let h of b.nmf())this.n0i(b,h)}n0i(b,h){const u=this.ATa.Iff(this.sya,h);if(u){const y=b.Klf(h);b.properties.Z(h,u(y))}}}Object(m.a)(yc,"PropertyAggregationHelper",null,[]);var cd=c(1060);class Cd{constructor(b,h,u,y,P){this.iQb=b;this.ATa=h;this.NEg=P;this.Qle=y;this.dTj=u}get Hbh(){return this.dTj.value}ZDc(b){if(Object(jb.a)(cd.a,
b))b.ZDc();else if(Object(jb.a)(zc,b)&&this.Qle.yph(b.activityName.toString())){b=Object(na.a)(zc,b);b.Bxo();b=b.owi();var h=[];Array.add(h,b);b=z.c(h);w.ULS.sendTraceTag(6907266,213,50,b)}}YAa(b,h){const u=(new Date).getTime();var y=this.NEg.list.J(b);const P=({wik:y}=this.Krl(y)).returnValue;this.NEg.list.Z(b,new ob.a);h&&(y=this.rQk(y,u,this.iQb.r8h));0<y.count&&(new yc(b,this.ATa)).sik(y,P)}rQk(b,h,u){const y=new ob.a;for(let P=0;P<b.count;P++){const aa=b.J(P);aa.startTime>h-u?aa.hZb():y.add(aa)}return y}Krl(b){const h=
this.Hbh.iij(b);b=this.Hbh.lmo(b);const u=this.xik(h,b);return{returnValue:u,wik:1===u?h:b}}xik(b,h){return b.count*this.iQb.Cyi<h.count?1:2}get enabled(){return this.iQb.enabled}hZb(){}}Object(m.a)(Cd,"ActivityAggregationManager",null,[745]);class ud{constructor(b){this.enabled=!1;this.Ywi=500;this.iyi=2;this.Cyi=5;this.r8h=3E4;this.sIc(b.appSettings)}sIc(b){this.enabled=Boolean.parse(b[ud.faf]||"false");this.Ywi=parseInt(b[ud.fSm]||"500");this.iyi=parseInt(b[ud.LUm]||"2");this.Cyi=parseInt(b[ud.iVm]||
"5");this.r8h=parseInt(b[ud.F0l]||"30000")}}ud.faf="ActivityAggregationEnabled";ud.fSm="ActivityAggregationMaxInterval";ud.LUm="ActivityAggregationMinChain";ud.iVm="ActivityAggregationModeFactor";ud.F0l="ActivityAggregationGraceWindow";Object(m.a)(ud,"ActivityAggregationParams",null,[]);class $d{constructor(b,h){this.ATa=b;this.cAg=h}iij(b,h=1){if(!b||!b.count)return b;const u=new ob.a;var y=null;for(let P=0;P<b.count;P++){const aa=b.J(P);if(!aa)continue;const ta=aa.activityName;y?y.mzm(aa)?y.add(aa):
(y=y.process(),u.addRange(y),y=this.cAg(ta,h),y.add(aa)):(y=this.cAg(ta,h),y.add(aa))}y&&(b=y.process(),u.addRange(b));return u}lmo(b){if(!b||!b.count)return b;const h={};var u=null;for(let P=0;P<b.count;P++){const aa=b.J(P);if(aa){if(!u){u=new ob.a;var y=this.ATa.ZLc(aa.activityName);for(let ta of y)u.add(ta)}y=this.tQl(aa,u);null!==y&&(y in h&&h[y]||(h[y]=new ob.a),h[y].add(aa))}}b=new ob.a;for(const P of Ma.a.bO(h))u=this.iij(h[P],2),b.addRange(u);return b}tQl(b,h){let u="";for(let y of h)u+=y,
u=b.properties.ub(y)&&void 0!==b.properties.J(y)&&null!==b.properties.J(y)?u+b.properties.J(y):u+"null";return u}}Object(m.a)($d,"ActivityAggregationSchemes",null,[744]);class gc{constructor(b,h,u,y,P){this.Qr=this.Fi=0;this.iQb=u;this.Clc=y;this.ATa=P;this.name=b;this.Dy=h;this.TAa=new ob.a}get mode(){return this.Dy}get count(){return this.TAa.count}get startTime(){return this.Fi}get endTime(){return this.Qr}get VHh(){if(!this.count)return 0;let b=0;for(let h of this.TAa)b+=h.endTime-h.startTime;
return b/this.count}get t9k(){if(!this.count)return 0;let b=0;const h=this.VHh;for(let u of this.TAa){const y=u.endTime-u.startTime;b+=(y-h)*(y-h)}return b/this.count}add(b){this.count?this.Qr=b.endTime>this.endTime?b.endTime:this.endTime:(this.Fi=b.startTime,this.Qr=b.endTime);this.TAa.add(b)}mzm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.iQb.Ywi}process(){if(this.count>=this.iQb.iyi){const b=new ob.a,h=this.Clc(this);b.add(h);return b}return this.TAa}Klf(b){const h=new ob.a;for(let u of this.TAa)if(u.properties.ub(b)){const y=
u.properties.J(b);h.add(y)}else h.add(null);return h}nmf(){const b=this.ATa.ZLc(this.name),h=new Db.a;for(let u of this.nsl())b.contains(u)||h.add(u);return h}nsl(){const b=new Db.a;if(!this.TAa)return b;for(let h of this.TAa)for(let u of h.properties.keys)b.add(u);return b}iDl(){return this.TAa.J(0).uniqueID}}Object(m.a)(gc,"ActivityCollection",null,[742]);class kc{constructor(){this.qqb=new lb.a}get list(){return this.qqb}add(b){const h=b.activityName;if(this.qqb.ub(h)&&this.qqb.J(h)){const u=this.lGl(this.qqb.J(h),
b);this.qqb.J(h).insert(u,b)}else this.qqb.Z(h,new ob.a),this.qqb.J(h).add(b)}lGl(b,h){for(let u=b.count-1;0<=u;u--)if(h.startTime>b.J(u).startTime)return u+1;return 0}}Object(m.a)(kc,"CompletedActivitiesHelper",null,[743]);class Wc{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){r.AFrameworkApplication.rJ(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}xc(b){this.W=b;const h=y=>new zc(()=>b.Pa("Common.App.Activities.IActivityAggregationManager"),
y),u=(y,P)=>new gc(y,P,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Cd,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Xd(()=>new Cd(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.af("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(ud,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Xd(()=>new ud(r.AFrameworkApplication.K));b.register(Ob,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Xd(()=>new Ob);b.register($d,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Xd(()=>
new $d(b.resolve("Common.IActivityAggregationInfo"),u));b.register(kc,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Xd(()=>new kc)}static main(){K.a.instance.Kc(new Wc)}}Object(m.a)(Wc,"ActivityAggregatorPackage",null,[1,2]);var td=c(470),Fe=c(1357);class Cf{constructor(b){this.c1g=0;this.Aoe=null;this.c_j=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get f4f(){return this.c_j.value}Wb(){this.isInitialized?this.fec():this.jAn(Object(v.a)(this,this.fec,
"registerActionsInternal"))}fec(){w.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(v.a)(this,this.E1m,"onChatContainerReady"))}).catch(b=>{w.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(v.a)(this,this.wCk,"chatCountChanged"))}).catch(b=>{w.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",
b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(v.a)(this,this.H1m,"onChatKeyPress"))}).catch(b=>{w.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){w.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}wCk(b){w.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.f4f.D1m();else if(1===b&&!this.c1g){const h=document.getElementById(this.Aoe?this.Aoe:Fe.a.Qyb);h?this.f4f.I1m(h,Object(v.a)(this,this.Too,"transferFocusToChat")):
w.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.c1g=b}E1m(b){this.Aoe=b}H1m(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.Soo(b.shiftKey)}jAn(b){td.a.instance.mb(bb.a.mio,window.self,()=>{b();return!0})}Too(){w.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{w.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){w.ULS.sendTraceTag(50595974,
333,10,"Failed to transfer focus to chat: {0}",b)}}Soo(b){w.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.f4f.F1m(b)}}Object(m.a)(Cf,"ChatManager",null,[738]);var ie=c(69);class Ae{constructor(){this.sa=new ie.a;this.z5j=!1}Wfk(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}Ifk(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get Qno(){return this.z5j}OQi(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(m.a)(Ae,
"HeaderEventSource",null,[]);var xe=c(157),ng=c(293);class Af{constructor(b,h,u,y,P){this.ssd=null;this.Vb=b;this.Zo=h;this.Qj=u;this.C5j=y;this.ga=P}mTi(b,h,u,y=null){const P=this.Vb.le(h);P.parent=u;P.BK=!0;y&&P.z$(y);this.Qj.UAa(h,b,!1);this.C5j.UAa(h,b,!1);h=new ng.DOMFocusListing(()=>b);h.Go(2);h.Go(1);h.Go(8);h.Go(5);h.Go(3);h.Go(6);this.Vb.Wka(()=>b,P,h).HX=!0;h=Rb.KeyInputManager.lc(fb.a.xx,0);u=Rb.KeyInputManager.lc(fb.a.xx,4);P.Mr(h);P.Mr(u)}onFlexPaneOpen(b){this.mTi(b,Fe.a.Cac,Fe.a.qOa);
this.Vb.Dg(Fe.a.Cac);this.Zo.Csa(Fe.a.Cac)}onFlexPaneClose(){this.Zo.ex(Fe.a.Cac);this.Vb.Dg(Fe.a.qOa)}I1m(b,h){this.ssd||(this.ssd=h,this.mTi(b,Fe.a.Qyb,xe.AFrame.zL,Object(v.a)(this,this.G1m,"onChatFocus")));this.Vb.Dg(Fe.a.Qyb);this.Zo.Csa(Fe.a.Qyb)}G1m(){this.ssd&&this.ssd()}D1m(){this.Zo.ex(Fe.a.Qyb);this.Vb.XHd(xe.AFrame.So)}F1m(b){this.ga.processAction(b?Wa.a.bcf:Wa.a.Rje,2)}}Object(m.a)(Af,"ReactSharedHeaderFocusManager",null,[737]);var De=c(106),Rf=c(1022),Je=c(35),le=c(63);class dh{constructor(b){this.ga=
b}Wb(){this.ga.pa(Wa.a.hId,le.a.frame,Object(v.a)(this,this.Nzi,"navigateToUpsellPage"));this.ga.pa(Wa.a.Vol,le.a.frame,Object(v.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.pa(Wa.a.TIn,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.XXi,le.a.frame,De.ActionManager.Mf)}Nzi(b,h,u,y,P){if(1===u)return 32;b=8;2===u&&(u=this.Wgf(P,"experience","gopremiumribbon"),P=Fa.a.g7("2116536"),P=Fa.a.Tn(P,"ocid",Rf.b(r.AFrameworkApplication.ta.Pb.$n,r.AFrameworkApplication.ta.Pb.Qga,u)),
Je.a.en(P,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(Wa.a.XXi,2),w.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,u,y,P){if(1===u)return 32;var aa=8;2===u&&(w.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(aa=Ja.a.instance.Pa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.Wgf(P,"experience","gopremium"),P=this.Wgf(P,"dimeCampaignId",null),aa.launchUpsellExperience(b,P),aa=32):
(w.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),aa=this.Nzi(b,h,u,y,P)));return aa}Wgf(b,h,u){b&&b[h]&&(u=Object(na.a)(String,b[h]));return u}}Object(m.a)(dh,"UpsellActor",null,[736]);class lj{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ja.a.instance.resolve("Common.App.Header.IUpsellActor").Wb();Ja.a.instance.resolve("Common.App.Header.IChatManager").Wb()}dispose(){}xc(b){this.W=b;this.W.register(Ae,"Common.App.Header.HeaderEventSource").singleInstance();
this.W.register(dh,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Xd(()=>new dh(r.AFrameworkApplication.ya));this.W.register(Af,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Xd(()=>new Af(r.AFrameworkApplication.ta.qp,r.AFrameworkApplication.ta.Bv,r.AFrameworkApplication.ta.k0,r.AFrameworkApplication.ta.rfe,r.AFrameworkApplication.ya));this.W.register(Cf,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Xd(()=>
new Cf(this.W.af("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){K.a.instance.Kc(new lj)}}Object(m.a)(lj,"CommonAppHeaderPackage",null,[1,2]);var sh=c(752);class We{static ASh(b,h){switch(b){case 3:return We.z_l(h);case 2:return We.cNl(h);case 1:return We.VBl(h)}return""}static z_l(b){switch(b){case 1:return r.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return r.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static cNl(b){switch(b){case 1:return r.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return r.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static VBl(b){switch(b){case 1:return r.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return r.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,u){if(ba.a.zi||ba.a.ZL)window.setTimeout(()=>{We.DSi(u,We.kNd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(We.yhh(u),b,0,!1)}static VGk(b,h,u,y){h&&
y&&y();We.openInClient(b,h,u)}static kNd(){return ba.a.zi?1:ba.a.ZL?2:ba.a.n2a?3:ba.a.Kl?4:0}static k_l(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static l_l(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get Dwf(){return"zh-CN"===window.navigator.language}static DSi(b,h){1===h?(w.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=We.ASh(b,h),8<ba.a.Q0a?Je.a.en(b,void 0,void 0,"RedirectToAppStore"):Je.a.HBb(b)):document.hidden||(We.Dwf?(b=r.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(w.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Je.a.HBb(b)):w.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(w.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(We.ASh(b,
h),null,null)))}static yhh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Ybe(){return(ba.a.n2a||ba.a.Kl)&&ba.a.Wp}static get Y7n(){return ba.a.zi||ba.a.ZL}static TSh(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Rki(b){return(b=We.eHl(b))&&""!==b?Boolean.parse(b):!1}static A3f(b){We.XYn(b)}static eHl(b){try{return localStorage.getItem(b)}catch(h){return w.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static XYn(b){try{localStorage.setItem(b,"true")}catch(h){w.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}We.Vrh="ChromeExtensionBarDismiss";Object(m.a)(We,"WildFireUtilities",null,[]);var Fh=c(412);class cc{constructor(){this.xme=new Fh.a;this.vme=new Fh.a;this.ume=new Fh.a;this.Ttk(this.xme);this.Stk(this.vme);this.Rtk(this.ume);this.Rwe=new Fh.a;
this.Qwe=new Fh.a;this.Pwe=new Fh.a;this.Rwk(this.Rwe);this.Qwk(this.Qwe);this.Pwk(this.Pwe);this.Toe=new Fh.a;this.euk(this.Toe);this.txb(this.Toe);this.txb(this.ume);this.txb(this.vme);this.txb(this.xme);this.txb(this.Qwe);this.txb(this.Rwe);this.txb(this.Pwe)}EMd(b,h){switch(b){case 1:return this.p0l(h);case 2:return this.Lsl(h)}return We.Ybe?this.Toe:null}Ttk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}Stk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}Rtk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Rwk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}euk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Qwk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Pwk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}txb(b){b.add("Corporation","Microsoft Corporation")}p0l(b){switch(b){case 3:return this.Rwe;case 2:return this.Qwe;case 1:return this.Pwe}return null}Lsl(b){switch(b){case 3:return this.xme;case 2:return this.vme;case 1:return this.ume}return null}static get instance(){cc._instance||
(cc._instance=new cc);return cc._instance}}cc._instance=null;Object(m.a)(cc,"WildFireStringFactory",null,[]);class tc{constructor(b,h,u,y,P=null,aa=null){this.IFe=null;this._id=b;this.nHe=h;this.ONj=P;this.gsc=y;this.nxc=aa;this.P7a=null;this.Bzc=u;this.uyc=cc.instance.EMd(h,b)}BRk(){this.P7a=new sh.a(this.title,this.message,null);this.P7a.addButton(this.hxk,Object(v.a)(this,this.m1m,"onButtonOneClick"),"");this.Bzc&&this.P7a.Odh(this.nxk,Object(v.a)(this,this.r1m,"onButtonTwoClick"));this.P7a.fla=
Object(v.a)(this,this.N5k,"dismissBar");this.P7a.image=3;this.P7a.id=16;this.P7a.closeable=!0}get title(){return this.uyc.J("Headline")}get message(){return this.uyc.J("CallToAction")}get hxk(){return this.Bzc?this.uyc.J("InstallButton"):this.uyc.J("UseAppButton")}get nxk(){return this.Bzc?this.uyc.J("OpenAppButton"):""}m1m(){this.Bzc?this.vhm():this.ICo()}r1m(){this.Bzc&&this.van()}get Jnh(){return this.P7a}get F3a(){this.IFe||(this.IFe=this.ONj());return this.IFe}vhm(){w.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.gsc&&this.nxc&&this.nxc();We.DSi(this._id,this.nHe)}van(){this.F3a&&(w.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.gsc&&this.nxc&&this.nxc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(We.yhh(this._id),this.F3a,0,!1))}ICo(){We.Ybe?this.dxk():(w.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),We.A3f("BizBarClicked"),1!==this.nHe&&2!==this.nHe||We.VGk(this.F3a,this.gsc,this._id,this.nxc))}dxk(){this.gsc?
w.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):w.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Je.a.HBb(r.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}O5k(){this.gsc?w.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):w.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");We.A3f(We.Vrh)}N5k(){We.Ybe?this.O5k():(We.A3f(We.TSh(this._id)),w.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static A5e(){const b=r.AFrameworkApplication.ta.Pb;
new tc(b.$n,We.kNd(),8<ba.a.Q0a,1===b.Qga,()=>b.Cea,b.N_f());w.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(m.a)(tc,"WildFireBusinessBar",null,[]);class bd{get name(){return"Common.App.WildFire"}dSe(b){const h=r.AFrameworkApplication.ta.Pb;let u=!1;b&&(b.BRk(),b.Jnh&&(u=h.Bsa(b.Jnh,!0)));return u}HRk(){var b=r.AFrameworkApplication.ta.Pb;b=new tc(b.$n,We.kNd(),!1,1===b.Qga);this.dSe(b)&&w.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}A5e(b,h,u,y,P,aa){b=new tc(b,
u,y,h,P,aa);this.dSe(b)&&w.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}rYk(){const b=r.AFrameworkApplication.ta.Pb;var h=r.AFrameworkApplication.K;const u=b.$n,y=1===b.Qga;if(h.$(We.k_l(u))){var P=We.kNd(),aa=8<ba.a.Q0a;if(2!==u||2!==P||!y){h=h.$(We.l_l(u));var ta=b.N_f(),Pa=()=>b.Cea;h&&!We.Rki(We.TSh(u))&&this.A5e(u,y,P,aa,Pa,ta)}}}init(){var b=r.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;We.Ybe&&b&&!We.Rki(We.Vrh)?
this.HRk():(document.body&&We.Y7n&&this.rYk(),r.AFrameworkApplication.ya.pa(Wa.a.RAf,le.a.frame,Object(v.a)(this,this.RAf,"launchWildFireBusinessBar")))}RAf(b,h,u,y,P){if(1===u)return 32;if(!P)return 8;this.A5e(P.app,P.mode,P.platform,P.useTwoButton,null,null);return 32}dispose(){}xc(){}static main(){K.a.instance.Kc(new bd)}}Object(m.a)(bd,"PackageManager",null,[1,2]);class vd{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(vd,"BrowserInfo",null,[]);class Tc{constructor(){this.Version=
this.Name=null}}Object(m.a)(Tc,"PluginInfo",null,[]);class nb{static nba(){if(r.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=nb.rpl();try{const h=JSON.stringify(b);w.ULS.sendTraceTag(6903563,102,50,h)}catch(h){w.ULS.sendTraceTag(6903564,102,15,h.message)}}else w.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static ePl(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let u=0;u<b.length;u++){const y=b[u].name,P=b[u].version;
Array.add(h,Object.assign(new Tc,{Name:y,Version:P}))}return h}static rpl(){const b=new vd,h=new Sys.StringBuilder;nb.mH(u=>{b.DocElemClientHeight=u},()=>document.documentElement.clientHeight,h);nb.mH(u=>{b.DocElemClientWidth=u},()=>document.documentElement.clientWidth,h);nb.mH(u=>{b.DocElemOffsetHeight=u},()=>document.documentElement.offsetHeight,h);nb.mH(u=>{b.DocElemOffsetWidth=u},()=>document.documentElement.offsetWidth,h);nb.mH(u=>{b.ScreenAvailHeight=u},()=>window.screen.availHeight,h);nb.mH(u=>
{b.ScreenAvailWidth=u},()=>window.screen.availWidth,h);nb.mH(u=>{b.ScreenWidth=u},()=>window.screen.width,h);nb.mH(u=>{b.ScreenHeight=u},()=>window.screen.height,h);nb.mH(u=>{b.ScreenLogicalXdpi=u},()=>window.screen.logicalXDPI,h);nb.mH(u=>{b.ScreenLogicalYdpi=u},()=>window.screen.logicalYDPI,h);nb.mH(u=>{b.ScreenDeviceXdpi=u},()=>window.screen.deviceXDPI,h);nb.mH(u=>{b.ScreenDeviceYdpi=u},()=>window.screen.deviceYDPI,h);nb.mH(u=>{b.WinInnerHeight=u},()=>window.self.innerHeight,h);nb.mH(u=>{b.WinInnerWidth=
u},()=>window.self.innerWidth,h);nb.mH(u=>{b.WinOuterHeight=u},()=>window.self.outerHeight,h);nb.mH(u=>{b.WinOuterWidth=u},()=>window.self.outerWidth,h);nb.mH(u=>{b.WinOrientation=u},()=>window.self.orientation,h);nb.mH(u=>{b.WinDevicePixelRatio=u},()=>window.self.devicePixelRatio,h);nb.mH(u=>{b.SupportsTouch=u},()=>ba.a.b5c,h);nb.mH(u=>{b.NavAppName=u},()=>window.navigator.appName,h);nb.mH(u=>{b.NavAppVersion=u},()=>window.navigator.appVersion,h);nb.mH(u=>{b.NavLanguage=u},()=>window.navigator.browserLanguage||
window.navigator.language,h);nb.mH(u=>{b.NavUserAgent=u},()=>window.navigator.userAgent,h);nb.mH(u=>{b.NavPlatform=u},()=>window.navigator.platform,h);nb.mH(u=>{b.NavPlugins=u},nb.ePl,h);nb.mH(u=>{b.CalculatedDevicePixelRatio=u},()=>nb.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static mH(b,h,u){try{const y=h();b(y)}catch(y){u.isEmpty()||u.append(" | "),u.append(y.message||
"null")}}}Object(m.a)(nb,"BrowserInfoLogger",null,[]);class Fb{get name(){return"Common.App.BrowserInfoLogger"}xc(){}init(){nb.nba()}dispose(){}static main(){K.a.instance.Kc(new Fb)}}Object(m.a)(Fb,"BrowserInfoLoggerPackage",null,[1,2]);class Kc{constructor(){this.sa=new ie.a}NXa(b){this.sa.addHandler("OnEditHappenedEvent",b)}xec(b){this.sa.removeHandler("OnEditHappenedEvent",b)}rrn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Kc,"EditNotificationEventSource",null,[]);var sc=c(83);class Oc{constructor(b,
h,u,y,P,aa,ta=0){this.Pse=!1;this.Ose=this.dub=null;this.v$g=!1;this.Gb=h;this.Lkd=b;this.W9a=u;this.k5=y;this.t$g=P;this.tKj=aa;this.Ycd=0;this.gfd=!1;try{0<ta&&(this.Ycd=ta,3E5>this.Ycd&&(this.Ycd=3E5),this.Gb&&!this.Ose&&(this.Ose=new sc.a(3,2,this.Ycd,Object(v.a)(this,this.NIn,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Gb.Xb(this.Ose)))}catch(Pa){w.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Pa)}}get Wdg(){return this.v$g}yEd(){this.Wdg?
this.gfd=!0:(this.v$g=!0,Ta.Health.instance.addQosPillar("Save"),Ta.Health.instance.addQosPillar("ContentCreation"),Ub.c(Wa.a.editDocument));this.Pse=!0;this.t$g&&this.t$g.Kbh();this.k5&&this.k5.rrn();r.AFrameworkApplication.Gg&&r.AFrameworkApplication.Gg.RQm();this.tKj&&!this.dub&&(this.d2c(null),this.dub=new sc.a(3,2,this.Lkd,Object(v.a)(this,this.d2c,"sendPostMessageIfNecessary"),113),this.Gb.Xb(this.dub))}d2c(){this.Pse&&(this.W9a.CWR(()=>this.W9a.result.sendMessage(H.a.editNotification,null)),
w.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Pse=!1)}NIn(){try{this.gfd&&(Ub.c(Wa.a.editDocument),this.gfd=!1)}catch(b){this.gfd=!1,w.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(m.a)(Oc,"EditNotificationManager",null,[734]);class Ke{constructor(b,h,u,y,P){this.Uve=this.dub=null;this.XUa=this.Mle=!1;this.Gb=h;this.Lkd=b;this.W9a=u;this.Qj=y;this.cFe=P;this.sTi(null)}sTi(){const b=
document.getElementById(r.AFrameworkApplication.OZb);!this.XUa&&this.Qj&&b&&(this.Qj.mb(bb.a.MX,b,Object(v.a)(this,this.qFf,"mouseActivityHandler"),null),this.XUa=!0);this.cFe(()=>{this.dispose()})}qFf(){this.XUa&&(this.Qj.sc(bb.a.MX,document.getElementById(r.AFrameworkApplication.OZb),Object(v.a)(this,this.qFf,"mouseActivityHandler")),this.XUa=!1);this.Kbh();return!1}Kbh(){this.Mle=!0;this.Uve||(this.Uve=new sc.a(3,2,this.Lkd,Object(v.a)(this,this.sTi,"registerHandlerTask"),112),this.Gb.Xb(this.Uve));
this.dub||(this.d2c(null),this.dub=new sc.a(3,2,this.Lkd,Object(v.a)(this,this.d2c,"sendPostMessageIfNecessary"),111),this.Gb.Xb(this.dub))}d2c(){this.Mle&&(this.W9a.CWR(()=>this.W9a.result.sendMessage(H.a.iDo,null)),w.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Mle=!1)}dispose(){this.XUa&&(this.Qj.sc(bb.a.MX,document.getElementById(r.AFrameworkApplication.OZb),Object(v.a)(this,this.qFf,"mouseActivityHandler")),this.XUa=!1)}}Object(m.a)(Ke,
"UserActivityHostNotificationManager",null,[735,9]);var Re=c(150),lf=c(84),Jh=c(642);class zg{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.lp(Object(v.a)(this,this.rx,"onFullAppSettingsReady"))}rx(){zg.N9k&&0<zg.t$e&&(this.W.register(Kc,"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(Ke,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Xd(()=>
new Ke(6E4,lf.a.instance,Jh.a.sq(this.W.Za("Postmessage.IHostPostmessenger")),Re.a.instance,r.AFrameworkApplication.rJ)),this.W.register(Oc,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Xd(()=>new Oc(zg.t$e,lf.a.instance,Jh.a.sq(this.W.Za("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Pa("Common.Interface.IUserActivityHostNotificationManager"),zg.O9k,zg.I9k)),
this.W.resolve("Common.Interface.IEditNotificationManager"),w.ULS.shipAssertTag(38086291,209,0<zg.t$e,"EditNotification Interval is less than or equal to 0."))}xc(b){this.W=b}dispose(){}static get t$e(){return r.AFrameworkApplication.K?parseInt(r.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get I9k(){return r.AFrameworkApplication.K?parseInt(r.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get N9k(){return!!r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get O9k(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){K.a.instance.Kc(new zg)}}Object(m.a)(zg,"CommonHostNotificationPackage",null,[1,2]);class Kd{constructor(b,h,u){this.awb=null;this.Gb=b;this.ga=h;this.NKg=u.create()}Slb(){this.awb?w.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(w.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.awb=new sc.a(2,1,3E4,Object(v.a)(this,this.jce,"showFloatPane"),67),this.Gb.Xb(this.awb))}jce(){this.awb=null;w.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.NKg.display()}gRa(){this.ga.pa(Wa.a.jce,le.a.frame,Object(v.a)(this,this.g$n,"showFloatPaneHandler"))}g$n(b,h,u,y,P){return b!==Wa.a.jce?2:1===u?32:2===u&&P?(w.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.Slb():(this.awb?(w.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Gb.Se(this.awb)):(w.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.NKg.remove(null)),this.awb=null),32):8}}Object(m.a)(Kd,"FloatPaneActor",null,[733]);var Td=c(90),Gd=c(95),rf=c(30),hf=c(23);class Ui{constructor(b,h,u,y,P){this.qCe=this.Vqc=this.Wnd=this.tWa=this.Gda=this.PTa=this.Mne=this.V9=this.Bvc=this.ytc=this.ztc=this.Bue=null;this.Gb=h;this.Ma=b;this.qg=u;this.W=P;this.yya=y}ezh(){this.V9=document.createElement("div");
this.V9.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.V9.style.width=this.Gda.width+"px";(this.qCe=this.YLl(this.yya))?(this.tWa=document.createElement("a"),this.tWa.setAttribute(hf.a.wh,hf.a.My),this.qg.mb(bb.a.click,this.tWa,Object(v.a)(this,this.oGi,"onRedirectClick")),this.tWa.href=this.qCe,this.tWa.target="_blank",this.tWa.appendChild(this.Gda),this.V9.appendChild(this.tWa)):this.V9.appendChild(this.Gda);this.PTa=document.createElement("a");this.PTa.setAttribute(hf.a.wh,
hf.a.l2);this.PTa.className="StandardButton WACFloatPaneCloseButton";this.PTa.title=CommonUIStrings.l_Close;this.PTa.tabIndex=-1;this.Mne=Gd.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Mne.setAttribute(hf.a.wh,hf.a.My);this.PTa.appendChild(this.Mne);this.qg.mb(bb.a.click,this.PTa,Object(v.a)(this,this.onClose,"onClose"));this.V9.appendChild(this.PTa);this.Bvc.appendChild(this.V9)}WFl(b){const h=this.Ma.$("O365PromotionHasStarted");
switch(b){case 2:return Td.a.T$(String.format("adppt{0}.png",h?"sale":""));case 1:return Td.a.T$(String.format("adxls{0}.png",h?"sale":""));case 3:return Td.a.T$(String.format("addoc{0}.png",h?"sale":""))}return null}YLl(b){const h=this.Ma.lb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.Vqc=null;this.V9&&!this.Wnd&&(b?w.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):
w.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.V9.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.V9.style.height="0px",this.Wnd=new sc.a(2,1,1E3,Object(v.a)(this,this.remove,"remove"),67),this.Gb.Xb(this.Wnd))}remove(){this.V9&&this.Bvc&&(this.tWa&&this.qg.sc(bb.a.click,this.tWa,Object(v.a)(this,this.oGi,"onRedirectClick")),this.qg.sc(bb.a.click,this.PTa,Object(v.a)(this,this.onClose,"onClose")),this.Bvc.removeChild(this.V9),this.V9=
null);this.Wnd=null}display(){if(this.Bue=this.W.Pa("Common.IFloatPaneContainer"))if(this.Bvc=this.Bue.container){var b=this.WFl(this.yya);b?(w.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Gda=document.createElement("img"),this.Gda.className="WACFloatPaneImage",this.ztc=Object(v.a)(this,this.O5m,"onLoadImageFinish"),rf.a.addHandler(this.Gda,bb.a.load,this.ztc),this.ytc=Object(v.a)(this,this.N5m,"onLoadImageError"),rf.a.addHandler(this.Gda,bb.a.error,this.ytc),
this.Gda.src=b):w.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else w.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else w.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}O5m(){const b=this.Ma.pc("O365AdPaneShowingDuration",60);this.ezh();this.V9.style.display="block";this.V9.style.height=this.Gda.height+"px";this.Vqc=new sc.a(2,1,1E3*b,Object(v.a)(this,
this.hide,"hide"),67);this.Gb.Xb(this.Vqc);this.$Ui()}N5m(){w.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.$Ui();this.Gda=null}$Ui(){this.ztc&&this.Gda&&rf.a.removeHandler(this.Gda,bb.a.load,this.ztc);this.ztc=null;this.ytc&&this.Gda&&rf.a.removeHandler(this.Gda,bb.a.error,this.ytc);this.ytc=null}oGi(){w.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Vqc&&this.Gb.Se(this.Vqc);
this.hide();return!0}dispose(){this.hide()}}Object(m.a)(Ui,"FloatPane",null,[765]);class Ik{constructor(b,h,u,y,P){this.Gb=h;this.Ma=b;this.qg=u;this.W=P;this.yya=y}create(){return new Ui(this.Ma,this.Gb,this.qg,this.yya,this.W)}}Object(m.a)(Ik,"FloatPaneFactory",null,[732]);var th=c(208);class Mi{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get mji(){return r.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&r.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.mji&&
(w.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").Slb(),w.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").gRa())}xc(b){this.W=b;this.mji&&(this.W.register(Ik,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Xd(()=>new Ik(r.AFrameworkApplication.K,r.AFrameworkApplication.uc,th.a.instance,r.AFrameworkApplication.ta.Pb.$n,
this.W)).singleInstance(),this.W.register(Kd,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Xd(()=>new Kd(r.AFrameworkApplication.uc,r.AFrameworkApplication.ya,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){K.a.instance.Kc(new Mi)}}Object(m.a)(Mi,"FloatPanePackage",null,[1,2]);var of=c(1601);class ci{}Object(m.a)(ci,"LokiTokenResult",null,[]);class Fl{constructor(b){this.Vkd=b}lkf(){const b=this.gJl();return b?
Fl.Z1a?new Promise((h,u)=>{this.Vkd.continueWith(()=>{this.Vkd.yo||this.Vkd.Di?u(Error.create("Error downloading auth library")):this.Vkd.result.uia("Loki",b).then(y=>{y=r.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.jJl():y.IsSuccess&&y.Token?Object.assign(new ci,{isSuccess:!0,token:y.Token,errorMessage:null}):Object.assign(new ci,{isSuccess:!1,token:null,errorMessage:JSON.stringify(y)});h(y);return y})})}):Promise.resolve(Object.assign(new ci,{isSuccess:!1,token:null,
errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new ci,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",of.a.HSh())}))}jJl(){const b=r.AFrameworkApplication.K.lb("LokiUserDataSignature")||"";return Object.assign(new ci,{isSuccess:!0,token:b,errorMessage:null})}gJl(){let b=null;const h=of.a.EId();2===h?b=r.AFrameworkApplication.K.lb("LokiAADAppId"):1===h&&(b=r.AFrameworkApplication.K.lb("LokiMSAAppId"));
return b}static get Z1a(){return r.AFrameworkApplication.K.$("IsO365CommercialHost")||r.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(m.a)(Fl,"LokiTokenManager",null,[731]);class xg{get name(){return"Common.App.LivePersonaUtils"}init(){Ja.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}xc(b){b.register(Fl,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Xd(()=>new Fl(Jh.a.sq(b.Za("Common.App.OAuth.IOAuthManager"))))}static main(){K.a.instance.Kc(new xg)}}
Object(m.a)(xg,"LivePersonaUtilsPackage",null,[1,2]);class Uf{constructor(b){this.qme=b}wii(b){if(!this.qme)return!0;b=Fa.a.qjf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.qme.length;h++)if(b.endsWith(this.qme[h]))return!0;return!1}}Object(m.a)(Uf,"DomainAllowListManager",null,[]);class tg{constructor(b,h){this.v6e=null;this.GOe=b;this.url=h}get Cdg(){return Fa.a.Zwa(this.url)}get Lr(){return this.GOe}N$f(){const b={},h=this.Lr;b.a=this.Cdg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);
b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);
b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.v6e;return b}round(b){return Math.round(1E3*b)/1E3}}Object(m.a)(tg,"PerformanceTimingEntry",null,[]);const sg=(b,h)=>{const u={};let y=null;switch(b){case 0:y="ResourceTiming";b=h.a;null!=b&&(u.Url=b);b=h.b;null!=b&&(u.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(u.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(u.RedirectEnd=b);
b=null==h.e?null:h.e.toString();null!=b&&(u.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(u.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(u.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(u.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(u.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(u.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(u.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(u.ResponseStart=b);b=null==
h.m?null:h.m.toString();null!=b&&(u.ResponseEnd=b);b=h.n;null!=b&&(u.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(u.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(u.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(u.TransferSize=h);break;case 1:y="PerformanceTiming",b=h.a,null!=b&&(u.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(u.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(u.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(u.UnloadEventEnd=
b),b=null==h.e?null:h.e.toString(),null!=b&&(u.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(u.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(u.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(u.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(u.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(u.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(u.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(u.SecureConnectionStart=b),b=null==
h.m?null:h.m.toString(),null!=b&&(u.RequestStart=b),b=null==h.n?null:h.n.toString(),null!=b&&(u.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(u.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(u.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(u.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(u.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(u.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(u.DomComplete=b),b=null==
h.u?null:h.u.toString(),null!=b&&(u.LoadEventStart=b),b=null==h.v?null:h.v.toString(),null!=b&&(u.LoadEventEnd=b),h=h.w,null!=h&&(u.CustomText=h)}u.Table=y;return Sys.Serialization.JavaScriptSerializer.serialize(u)};var jh=c(39),eh=c(204),li=c(164);class Oj{constructor(b,h=null,u=null){this.Rg=b;this.Bdg=this;this.VMj=h||(()=>window.location.href);this.xse=new Uf(u)}run(){if(Oj.Rcb(window.performance))try{const P=this.VMj();if(Oj.K5j.exec(P)&&this.xse.wii(P)){var b=new tg(window.performance.timing,
P);li.a.instance.oun(b.Lr.fetchStart);li.a.instance.pun(b.Lr.navigationStart);li.a.instance.KX(jh.a.Eol,"connectStart","requestStart");li.a.instance.KX(jh.a.Mol,"requestStart","responseStart");li.a.instance.KX(jh.a.Pol,"responseStart","responseEnd");this.Bdg.kHb(1,b.N$f());this.Rg.Wf(jh.a.Dfb,b.Lr.fetchStart);this.Rg.Wf(jh.a.Jol,b.Lr.domainLookupStart);this.Rg.Wf(jh.a.Iol,b.Lr.domainLookupEnd);this.Rg.Wf(jh.a.Gol,b.Lr.connectStart);this.Rg.Wf(jh.a.Rol,b.Lr.secureConnectionStart);this.Rg.Wf(jh.a.Fol,
b.Lr.connectEnd);this.Rg.Wf(jh.a.Nol,b.Lr.requestStart);this.Rg.Wf(jh.a.Mef,b.Lr.responseStart);this.Rg.Wf(jh.a.Kol,b.Lr.responseEnd-b.Lr.responseStart);this.Rg.Wf(jh.a.Ool,b.Lr.responseStart-b.Lr.requestStart);var h=0,u=0,y=0;({transferSize:h,gaf:u,S6e:y}=this.sro(P)).returnValue&&(this.Rg.Wf(jh.a.Tol,h),this.Rg.Wf(jh.a.Hol,y),this.Rg.Wf(jh.a.Lol,u));this.Rg.Wf(jh.a.tJc,b.Lr.navigationStart)}}catch(P){w.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",P)}}sro(b){let h,
u,y;y=u=h=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,gaf:u,S6e:y};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,gaf:u,S6e:y};b=b[0];var P=b.transferSize;void 0!==h&&null!==h&&(h=P);P=b.decodedBodySize;void 0!==P&&null!==P&&(y=P);b=b.encodedBodySize;void 0!==b&&null!==b&&(u=b);return{returnValue:!0,transferSize:h,gaf:u,S6e:y}}kHb(b,
h){w.ULS.sendTraceTag(4551815,306,50,sg(b,h))}static get instance(){return Oj._instance||(Oj._instance=new Oj(eh.a.instance,null,r.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?r.AFrameworkApplication.K.XB("ResourceLoggerDomainAllowList"):null))}static Rcb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}Oj._instance=null;Oj.K5j=RegExp("^https?://.*","i");Object(m.a)(Oj,"PerformanceTimingLogger",null,[730]);class yk{constructor(b,h){this.v6e=null;this.GOe=
b;this.behavior=h;this.url=this.Lr.name}get Cdg(){return 2===this.behavior?this.url:Fa.a.Zwa(this.url)}get Lr(){return this.GOe}N$f(){const b={},h=this.Lr;b.a=this.Cdg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):
0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);b.o=this.round(yk.E5b(h,"decodedBodySize"));b.p=this.round(yk.E5b(h,"encodedBodySize"));b.q=this.round(yk.E5b(h,"transferSize"));b.n=this.v6e;return b}round(b){return Math.round(1E3*b)/1E3}static E5b(b,h){return b[h]}}Object(m.a)(yk,"ResourceTimingEntry",null,[764]);class dj{constructor(b,h=null,u=100){this.TAg=b;this.Jqd=h;this.hQb={};this.lGj=u}bqo(b){var h=b.name.toLowerCase();const u=Fa.a.ilf(h);this.ALn(u,
h)&&(u in this.hQb?w.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",u):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.Oxm(b),h.encodedsize=yk.E5b(b,"encodedBodySize"),h.decodedsize=yk.E5b(b,"decodedBodySize"),this.hQb[u]=h))}ALn(b,h){if(this.TAg)return Array.contains(this.TAg,b);if(this.Jqd)for(b=Fa.a.LZ(h),h=0;h<this.Jqd.length;h++)if(this.Jqd[h]&&b.endsWith(this.Jqd[h]))return!0;return!1}Oxm(b){try{const h=yk.E5b(b,"transferSize");
if(void 0!==h&&null!==h)return!h;w.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.lGj}catch(h){w.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}Pwn(){if(Ma.a.kf(this.hQb))w.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=r.AFrameworkApplication.S2?
r.AFrameworkApplication.S2.split(";"):[],h=Object.assign(new Ya.a,{extendedProperties:sa.a.AF()});h.extendedProperties.set("Flights",z.c(b));this.Pti(h,this.hQb,Ta.Health.instance)}}Hff(b){let h=0,u=0,y=0,P=0;const aa=this.hQb;for(let Pa in aa){var ta=aa[Pa];Pa.endsWith(".js")&&(ta=Object(na.a)(Object,ta),ta.responseend<b&&(h+=1,u+=ta.decodedsize,P+=ta.encodedsize,y+=ta.iscached?0:ta.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=u;b.transferredBytes=y;b.encodedBytes=P;return b}Pti(b,h,u){if(h){var y=
0,P=0,aa=0,ta=0,Pa=0,vb=0,Kb=0,Sb=0,Yb=0,Ac=0,Sc=0;for(let Ad in h){var nd=h[Ad];try{const he=Object(na.a)(Object,nd);if(!he)continue;const ce=he.iscached?Boolean.parse(he.iscached.toString()):!1,Nd=he.fetchstart?this.parseFloat(he.fetchstart.toString()):0,re=(he.responseend?this.parseFloat(he.responseend.toString()):0)-Nd,Xd=he.encodedsize?this.parseFloat(he.encodedsize.toString()):0,vg=he.decodedsize?this.parseFloat(he.decodedsize.toString()):0;y+=re;ta+=Xd;Kb+=vg;Ac++;ce?(aa+=re,vb+=Xd,Yb+=vg,
Sc++):(P+=re,Pa+=Xd,Sb+=vg)}catch(he){w.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",he.message)}}b.extendedProperties.set("StaticResources",z.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",y.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",P.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",aa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Pa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",vb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Kb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Sb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Yb.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Ac.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Sc.toString());u.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);u.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(m.a)(dj,"AppStaticResourceManager",null,[]);class bl extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(m.a)(bl,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class mh{constructor(b,
h,u=null,y=null,P=100){this.xAe=!1;this.vo=null;this.Onc=0;this.sa=new ie.a;this.pQb=null;this.OY=!1;this.K8g=0;this.Gb=b;this.CGg=0;this.Bdg=this;this.xse=new Uf(u);this.WJ=h;y&&(this.pQb=new dj(null,y,P))}get Nmh(){try{return!(void 0===this.WJ||null===this.WJ)&&!(void 0===this.WJ.getEntriesByType||null===this.WJ.getEntriesByType)}catch(b){return w.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get F_k(){return this.CGg}get isActive(){return this.OY}get F$f(){return this.K8g}yeh(b){this.sa.addHandler(mh.bbf,
b)}hWi(b){this.sa.removeHandler(mh.bbf,b)}xc(b,h){const u=this.F$f!==b;this.K8g=b;this.isActive&&this.Gb&&u&&(this.Se(),this.Xb());this.CGg=h}activate(){!this.isActive&&this.Nmh&&(this.Xb(),this.OY=!0)}deactivate(b){this.isActive&&(this.Se(),b&&this.flush(),this.OY=!1)}flush(){if(this.isActive&&this.Nmh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.Onc&&w.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.Onc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.Onc=0);const u=[];for(let y=this.Onc;y<b.length;y++)this.xse.wii(b[y].name)&&(this.pQb&&this.pQb.bqo(b[y]),u.push(new yk(b[y],this.F_k)));h||(this.Onc=b.length);this.sa.raiseEvent(mh.bbf,new bl(u));for(b=0;b<u.length;b++)0!==u[b].behavior&&2!==u[b].behavior||this.Bdg.kHb(0,u[b].N$f());0<u.length&&w.ULS.sendTraceTag(19506834,
306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",u.length)}catch(h){w.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}kHb(b,h){w.ULS.sendTraceTag(4310804,306,50,sg(b,h))}iun(){this.pQb.Pwn()}Hff(b){return this.pQb.Hff(b)}Xb(){this.Gb&&0<this.F$f&&(this.vo=new sc.a(3,2,1E3*this.F$f,()=>{this.flush()},5),this.Gb.Xb(this.vo),this.xAe=!0)}Se(){this.xAe&&(this.Gb.Se(this.vo),this.vo=null,this.xAe=!1)}}mh.bbf="EntriesAvailable";
Object(m.a)(mh,"ResourceTimingLogger",null,[708,730]);class Qk{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");Oj.instance.run()}dispose(){}xc(b){this.W=b;let h=null;if(r.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=r.AFrameworkApplication.K.XB("ResourceLoggerDomainAllowList")}catch(P){w.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const u=
[];u.push(Fa.a.LZ(Td.a.t4).toLowerCase());u.push(Fa.a.LZ(Td.a.o3c).toLowerCase());const y=r.AFrameworkApplication.K.pc("AppStaticResourceMonitorCacheThresholdInMs",100);b.register(708,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Xd(()=>new mh(r.AFrameworkApplication.uc,window.performance,h,u,y))}static main(){K.a.instance.Kc(new Qk)}}Object(m.a)(Qk,"ResourceTimingPackage",null,[1,2]);var Zf=c(231);class Pl{constructor(){this.Jle={}}U8j(b){this.Jle[b.id.toString()]=b}eZm(b){const h=
this.Jle;for(let u in h)h[u].notify(b,!1);this.Jle={}}jpn(b,h){h&&this.U8j(h);return this.BGi(b,h)}T$e(b){this.eZm(b)}MIh(b,h){b.notify(h,!0)}}Object(m.a)(Pl,"AEventEmitter",null,[668]);var rh;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(rh||(rh={}));Object(m.b)("EventResultState",rh);class tf{constructor(){this._state=0}get state(){return this._state}set state(b){w.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",
{["OldState"]:rh[this._state],["NewState"]:rh[b]},"ResultType",this.p3h());this._state=b}}Object(m.a)(tf,"AEventResult",null,[667]);class Ql extends tf{constructor(){super();this.$Me=this.Vvc=null;this.state=0;this.bye=this.aPg=!1}get Oba(){return this.Vvc}get P5a(){return this.$Me}get Bhm(){return this.aPg}p3h(){return"GetMoreInfo Result"}}Object(m.a)(Ql,"GetMoreInfoResult",tf,[787,667]);var ji=c(1349),fi=c(1513),Yh=c(1023);class Yj{constructor(b,h,u,y,P,aa,ta,Pa){this.ga=b;this.rg=h;this.Eh=u;this.yya=
y;this.Gb=P;this.sA=aa;this.lOj=ta;this.drd=Pa}gyn(){this.dbc.pa(Wa.a.vcc,le.a.frame,Object(v.a)(this,this.vcc,"openUrlInNewTab"));this.dbc.pa(Wa.a.eOf,le.a.frame,Object(v.a)(this,this.eOf,"openDocumentUrl"));r.AFrameworkApplication.Yea?this.Vti():this.dbc.gb(Wa.a.dEd,le.a.frame,Object(v.a)(this,this.dEd,"documentLoaded"),96)}vcc(b,h,u,y,P){P&&P.MenuItemId&&(w.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:Yh.a[this.VEa]}),Je.a.en(P.MenuItemId.toString(),
"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}eOf(b,h,u,y,P){if(P&&P.MenuItemId){const aa=r.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ta=r.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");w.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",aa,ta);if(aa&&ta){w.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:Yh.a[this.VEa]});b=P.MenuItemId.toString();
const Pa={};Pa[G.a.dec]="1";Pa[G.a.documentUrl]=b;Pa[G.a.reason]=fi.a.open;w.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");r.AFrameworkApplication.fO().execute(vb=>{vb.sendMessage(H.a.CAb,Pa)})}else this.vcc(b,h,u,y,P)}return 32}dEd(){this.Vti();return 32}NPa(b,h,u=""){if(h&&h.oH){const y=ji.a[h.status];h=h.oH.getTime();const P=this.hr()-h;w.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:y,["ElapsedMs"]:P,
["StartTime"]:h,["Notes"]:u})}else w.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}Vti(){var b=r.AFrameworkApplication.K.$("QPGVCI"),h=Fa.a.rT(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var u=Fa.a.rT(document.URL,"wdPreviousSession",b);b=Fa.a.rT(document.URL,"wdPreviousCorrelation",b);var y=r.AFrameworkApplication.K.$("NAOPLP");if(r.AFrameworkApplication.Yea){var P=r.AFrameworkApplication.Yea.getTime();!h||h>P?
w.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:P,["SessionId"]:u,["Correlation"]:b}):w.ULS.sendTraceTag(5849683,202,y?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:P-h,["ClickTimestamp"]:h,["SessionId"]:u,["Correlation"]:b})}else w.ULS.sendTraceTag(5849681,202,y?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:u,["Correlation"]:b})}}get dbc(){return this.ga.value}get DVc(){return this.rg.value}get Zzi(){return this.Eh.value}get VEa(){return this.yya.value}get j_d(){return this.Gb.value}get hr(){return this.sA}get iQa(){return this.lOj.value}get T5a(){return this.drd.value}static get instance(){return Yj._instance||(Yj._instance=Yj.yr())}static yr(){return new Yj(new Zf.a(()=>r.AFrameworkApplication.ya),new Zf.a(()=>r.AFrameworkApplication.Ve),new Zf.a(()=>r.AFrameworkApplication.ta),
new Zf.a(()=>r.AFrameworkApplication.ta.Pb.$n),new Zf.a(()=>r.AFrameworkApplication.uc),()=>(new Date).getTime(),new Zf.a(()=>r.AFrameworkApplication.ta.Pb.iQa),new Zf.a(()=>r.AFrameworkApplication.T5a))}}Yj._instance=null;Object(m.a)(Yj,"NewAndOpenCommonHelpers",null,[665]);class ef{constructor(b,h,u){this.Fpd=this.vo=null;this.CJe=0;this.l1j=b;this.Gb=h;this.cHg=u}bik(){this.CJe=this.Yec+1}qZf(b){this.vo&&(this.Gb.Se(this.vo),this.vo=null);b&&(this.CJe=0)}efo(b){const h=this.wmo;0<=h?(this.bik(),
this.qZf(!1),this.vo=new sc.a(4,1,h,b,107),this.Gb.Xb(this.vo)):(this.qZf(!0),w.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.cHg}))}get Yec(){return this.CJe}get wmo(){return this.Yec>=this.M3i.length?-1:this.M3i[this.Yec]}get M3i(){if(!this.Fpd){const b=(this.l1j.value||"0").split(",");this.Fpd=[];for(let h=0;h<b.length;h++){const u=parseInt(b[h]);isNaN(u)?w.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.cHg,["Entry"]:b[h]}):
Array.add(this.Fpd,u)}}return this.Fpd}}Object(m.a)(ef,"RetryHelper",null,[]);class Zj extends Pl{constructor(b,h){super();this.Pza=b;this.Wwc=new ef(h,this.nVc.j_d,"GetMoreInfo");this.hq=new Ql}ZPm(){this.PDf("Document opened")}FUk(b){return()=>{this.PDf(b,!0)}}BGi(b,h=null){w.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.hq.state?(h&&this.MIh(h,this.hq),w.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.PDf(b);return this.hq}PDf(b,h=!1){this.Wwc.qZf(!h);1===this.hq.state?w.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Wwc.Yec}):(w.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Wwc.Yec}),this.hq.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.nVc.iQa,r.AFrameworkApplication.Gm),this.nVc.DVc.dZb(h,1,null,null,[Zj.p0g,Zj.g7g],5,this.xTk(),this.wTk(b)))}xTk(){return b=>
{var h=!1;let u=!1;var y=!1,P;r.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.Ae?({Uv:P}=z.d(b.data.Ae)).returnValue?P?(y=!0,this.hq.$Me=P.StorageServiceDisplayName,this.hq.Vvc=Zj.Cpi(P.PersonalFileStorageUrl)?P.PersonalFileStorageUrl:"",""===this.hq.Oba&&"SharePointOnlineConsumer"===r.AFrameworkApplication.K.lb("FileSource")&&(this.hq.Vvc=Fa.a.Zwa(r.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.hq.Oba&&""!==this.hq.P5a):w.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
w.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):w.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));y||((P=b.data.Bj)?(this.hq.$Me=(P[Zj.g7g]||"").toString(),h=(P[Zj.p0g]||"").toString(),this.hq.Vvc=Zj.Cpi(h)?h:"",""===this.hq.Oba&&"SharePointOnlineConsumer"===r.AFrameworkApplication.K.lb("FileSource")?(this.hq.Vvc=Fa.a.Zwa(r.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.hq.Oba&&""!==this.hq.P5a):h=""===h&&""!==this.hq.P5a):(w.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),u=!0));y=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.Wwc.Yec,u,h,y);this.nVc.NPa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,y);this.c4i(3,h,u)}}wTk(b){return h=>{this.nVc.NPa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.c4i(2);this.Wwc.efo(this.FUk(b))}}c4i(b,h=!1,u=!1){this.hq.state=b;this.hq.aPg=h;this.hq.bye=u;this.T$e(this.hq)}get nVc(){return this.Pza.value}static get instance(){return Zj._instance||(Zj._instance=Zj.yr())}static yr(){return new Zj(new Zf.a(()=>Yj.instance),new Zf.a(()=>r.AFrameworkApplication.sKl))}static Cpi(b){if(!b)return w.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(A.a.jh(b).startsWith("https://"))return!0;w.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}Zj.p0g="PersonalFileStorageUrl";Zj.g7g="StorageServiceDisplayName";Zj._instance=null;Object(m.a)(Zj,"GetMoreInfoActor",Pl,[]);class Od{constructor(b,h,u,y,P){this.xPj=6E4;this.kci="inactive";this.Abh="active";this.OY=!0;this.Gb=b;this.tNj=h;this.sA=u;this.$rd=y;this.sa=new ie.a;P&&this.Veo();this.gTg=this.LZh()}bch(b){this.sa.addHandler(this.Abh,b)}ibk(b){this.sa.addHandler(this.kci,b)}Veo(){const b=new sc.a(5,2,this.xPj,Object(v.a)(this,this.Eam,
"inactiveLoop"),108);this.Fam.Xb(b)}Eam(){const b=this.LZh(),h=this.hr()-b;h>this.Cfe&&this.OY&&(w.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.OY=!1,this.sa.raiseEvent(this.kci));b-this.gTg>this.Cfe&&(this.OY=!0,this.sa.raiseEvent(this.Abh));this.gTg=b}get Fam(){return this.Gb.value}get LZh(){return this.tNj}get hr(){return this.sA}get Cfe(){return this.$rd.value}static get instance(){return Od._instance||(Od._instance=Od.yr())}static yr(){return new Od(new Zf.a(()=>
lf.a.instance),()=>r.AFrameworkApplication.BAf.getTime(),()=>(new Date).getTime(),new Zf.a(()=>r.AFrameworkApplication.Cfe),!0)}}Od._instance=null;Object(m.a)(Od,"InactivityManager",null,[]);var Sh=c(1621);class qf extends tf{constructor(){super();this.dVj=this.bXg=this.aXg=null;this.state=this.L8g=0;this.bye=!1}get MFf(){return this.aXg}get ozi(){return this.bXg}get Cmo(){return this.L8g}p3h(){return"MruActor Result"}}Object(m.a)(qf,"MruResult",tf,[666,667]);class Ld{constructor(b,h,u){this.task=
null;this.xEb=b;this.maxRetries=h;this.taskManager=u;this.retryCount=this.GPc=0;this.QHe=this.dTc=null}Htm(b,h){return b===qa.a.Y3b||20===h||18===h||3===h}avm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get b5d(){return this.QHe}reset(){this.GPc=this.retryCount=0;this.QHe=this.dTc=null;this.task&&(this.taskManager.Se(this.task),this.task=null)}Wem(b,h,u,y){this.QHe=String.format("{0}_{1}",u,y);if(this.retryCount>=
this.maxRetries)return w.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Htm(u,y))return w.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.avm(y)&&1<=this.GPc)return this.dTc=u,!1;h=Math.max(h,this.xEb*Math.pow(2,this.GPc));if(26===y)h=Math.max(h,3E4);else if(27===y||28===y)h=Math.max(h,6E4);9===y||412===u&&(null==this.dTc||412!==this.dTc)?h=500:this.GPc+=1;this.dTc=u;this.retryCount+=1;this.task&&this.taskManager.Se(this.task);w.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new sc.a(2,1,h,b,107);this.taskManager.Xb(this.task);return!0}}Object(m.a)(Ld,"RetryManager",null,[]);var fh=c(141);class Vm{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(Vm,"WriteOptions",null,[]);var zl=c(594);class Pm extends Pl{constructor(b,h,u,y,P,aa,ta){super();this.Pza=b;this.WTj=h;this.Nab=new Ld(r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.jM.j_d);this.Vbb=new Ld(r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.jM.j_d);this.f_j=u;this.Fah=y;this.O7j={};this.Jja=new qf;this.RMj=P;this.pkd="";this.fL=aa;this.WIg=ta;this.Mnd="";this.j_j=r.AFrameworkApplication.K.pc("WordRecentLinksCount",
25)}get sje(){return this.O7j}MBn(){this.jM.dbc.pa(Wa.a.UWi,le.a.frame,Object(v.a)(this,this.tGn,"renameMruEntry"))}tGn(){return this.Qfg("Rename")}mQm(){this.rwi("File Opened")}nQm(){this.rwi("IntervalUpdate")}rwi(b){w.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.Qfg(b)}NNa(b){(b=A.a.NNa(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}wSh(){switch(this.jM.VEa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}qZl(b){var h=this.RMj();if(!h)return null;const u=new Vm;u.documentUrl=this.WIg.value?encodeURI(h):h;u.mruItemId=this.pkd;u.app=this.wSh();if(h=this.fL())u.folderName=h.breadcrumbFolderName,h=h.Nz,u.documentName=A.a.zI(h),u.documentExt=this.NNa(h);b&&(u.documentName?u.documentName.length?255<=u.documentName.length?b.set("DocumentNameLength","Long"):2084<=u.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(u)}Qfg(b,h=!1){if(4===this.jM.VEa&&!r.AFrameworkApplication.YGc)return 2;var u=sa.a.AF();u&&(u.set("Trigger",b),u.set("IsRetry",h?"true":"false"),u.set("MruIdSent",this.pkd?"true":"false"),u.set("URLEncoded",this.WIg.value?"true":"false"));Ta.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",u);b=this.qZl(u);if(!b)return h=!r.AFrameworkApplication.mPb,u&&(u.set("WebEditingIsEnabled",r.AFrameworkApplication.mPb?"true":"false"),u.set("ProtectedFile",r.AFrameworkApplication.protectFile?
"true":"false")),Ta.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new Ya.a,{extendedProperties:u})),2;this.Vbb&&!h&&this.Vbb.reset();u=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.jM.iQa,this.cCf);this.Fah?this.sje["X-FileId"]=r.AFrameworkApplication.Gm:u+=String.format("&{0}",r.AFrameworkApplication.Gm);r.AFrameworkApplication.sessionStartInfoSettings&&(this.sje["X-Office-AudienceGroup"]=Object(na.a)(String,r.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.sje["X-Timeout"]=15E3;return this.jM.DVc.qj(u,2,b,this.sje,!0,5,Object(v.a)(this,this.mKo,"writeMruV2EntryOnServerSuccessCallback"),Object(v.a)(this,this.wYk,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}mKo(b){this.l9h(b.data)}l9h(b){const h=sa.a.AF();this.Vbb&&(h&&this.Vbb.b5d&&(h.set("LastError",this.Vbb.b5d),h.set("NumRetries",this.Vbb.retryCount.toString())),this.Vbb.reset());const u=Sh.c(b.Ae);u&&u.diagnostics_data&&(this.pkd=u.diagnostics_data.mru_id);
b=+b.FS-+b.oH;h&&h.set("RequestDuration",b.toString());Ta.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Ya.a,{extendedProperties:h}))}wYk(b){if(b.data.jf===qa.a.DFc)this.l9h(b.data);else{var h=b.data.jf===qa.a.Eoa,u=sa.a.AF();this.u9h(this.Vbb,b,this.cYk(),u);u&&(u.set("StatusCode",b.data.jf.toString()),h||this.pSe(b.data,u));Ta.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.jf),h,!1,Object.assign(new Ya.a,{extendedProperties:u}))}}cYk(){return()=>
{this.Qfg("Retry",!0)}}AKl(){this.CUc("Polling")}zKl(){this.CUc("Retry",!0)}bQm(){this.CUc("Open")}aQm(){this.CUc("Activity")}$Pm(){this.CUc("ActivityRecentLinks",!1,!0)}CUc(b,h=!1,u=!1){w.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const y=sa.a.AF();y&&(y.set("Trigger",b),y.set("IsRetry",h?"true":"false"),u&&y.set("RecentLinks","true"));Ta.Health.instance.recordKpiUsage("GetMru",0,"smartfio",y);this.Nab&&!h&&this.Nab.reset();u?this.Gzh(Object(v.a)(this,this.BKl,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(v.a)(this,this.wKl,"getMruForRecentLinksFromServerFailureCallback"),!0):this.Gzh(Object(v.a)(this,this.CKl,"getMruV2FromServerSuccessCallback"),Object(v.a)(this,this.yKl,"getMruFromServerFailureCallback"))}pSe(b,h){b&&b.Bj&&(b=b.Bj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}OJm(b,h){b&&(h&&h.set("RequestDuration",(+b.FS-+b.oH).toString()),Ta.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Ya.a,{extendedProperties:h})))}CKl(b){this.M_h(b)}M_h(b,h=!1){var u="";let y=null,
P=null,aa=null;const ta=Sh.c(b.data.Ae);ta&&(y=ta.places?ta.places.items:[],P=ta.documents?ta.documents.items:[],(aa=Sh.a(ta,h))&&(u=z.c(aa)));r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa&&fh.c()&&(h?this.Mnd=u:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(u,!0)));u=sa.a.AF();this.Nab&&(u&&this.Nab.b5d&&(u.set("LastError",this.Nab.b5d),u.set("NumRetries",this.Nab.retryCount.toString())),this.Nab.reset());h&&u&&u.set("RecentLinks","true");aa||y||P?(h?this.jM.NPa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.jM.NPa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.Ghe(3,aa,y,P),this.OJm(b.data,u)):(h?this.jM.NPa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.jM.NPa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),u&&this.pSe(b.data,u),Ta.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Ya.a,{extendedProperties:u})),this.Ghe(3,null,null,null,!0));this.T$e(this.Jja)}BKl(b){this.M_h(b,
!0)}u9h(b,h,u,y){let P=0,aa=0;const ta=Sh.c(h.data.Ae);ta&&(null!=ta.response_code&&(P=ta.response_code,y&&y.set("MruResponseCode",P.toString()),9===P&&(this.pkd="")),ta.error_data&&null!=ta.error_data.retry_after_ms&&(aa=ta.error_data.retry_after_ms,y&&y.set("ExpectedRetryAfter",aa.toString())));b&&(h=b.Wem(u,aa,h.data.jf,P),y&&(y.set("CurrentRetryCount",b.retryCount.toString()),y.set("RetryScheduled",h?"true":"false")))}yKl(b){this.L_h(b)}L_h(b,h=!1){const u=b.data.jf===qa.a.Eoa,y=sa.a.AF();y&&
(y.set("StatusCode",b.data.jf.toString()),h&&y.set("RecentLinks","true"),u||this.pSe(b.data,y));h?this.jM.NPa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.jM.NPa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.Ghe(2);this.u9h(this.Nab,b,Object(v.a)(this,this.zKl,"getMruFromServerRetryTask"),y);Ta.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.jf),u,!1,Object.assign(new Ya.a,{extendedProperties:y}));this.T$e(this.Jja);
r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa&&fh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.Mnd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}wKl(b){this.L_h(b,!0)}Ghe(b,h=null,u=null,y=null,P=!1){if(3!==this.Jja.state||3===b)this.Jja.aXg=h,this.Jja.bXg=u,this.Jja.dVj=y,this.Jja.state=b,this.Jja.bye=P,this.Jja.L8g=this.jM.hr()}BGi(b,h){w.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Jja.state});
h&&3===this.Jja.state&&this.MIh(h,this.Jja);return this.Jja}Gzh(b,h,u=!1){this.Ghe(1);let y;const P={};y=u?String.format(this.jM.iQa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.j_j,"OfficeSuite",this.cCf,"ClassicMru"):String.format(this.jM.iQa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.wSh(),this.cCf);this.f_j.value||(y+="&entity=docs");r.AFrameworkApplication.sessionStartInfoSettings&&(P["X-Office-AudienceGroup"]=Object(na.a)(String,r.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");u&&(P["X-Office-Application"]="147");this.Fah?P["X-FileId"]=r.AFrameworkApplication.Gm:y+=String.format("&{0}",r.AFrameworkApplication.Gm);this.jM.DVc.qj(y,1,null,P,!0,5,b,h,null)}get jM(){return this.Pza.value}get cCf(){return this.WTj.value}static get instance(){return Pm._instance||(Pm._instance=Pm.yr())}static yr(){return new Pm(new Zf.a(()=>Yj.instance),new Zf.a(()=>zl.a.sg(r.AFrameworkApplication.lcid).name),new Zf.a(()=>r.AFrameworkApplication.ta.Pb.ZA),r.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>r.AFrameworkApplication.ta.Pb.Cea,()=>r.AFrameworkApplication.su,new Zf.a(()=>r.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}Pm._instance=null;Object(m.a)(Pm,"MruActor",Pl,[]);class xo{constructor(){this.tzc=this.M1g=this.W=null;this.Mh=!1}get name(){return"Common.App.NewAndOpen.Core"}xc(b){this.W=b;b.register(665,"Common.INewAndOpenCommonHelpers").singleInstance().Xd(()=>Yj.instance);b.register(668,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Xd(()=>Zj.instance);
b.register(668,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Xd(()=>Pm.instance)}init(){r.AFrameworkApplication.K.lp(()=>{this.a1a()})}a1a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Yj.instance.gyn();r.AFrameworkApplication.WEa&&(b=!0);r.AFrameworkApplication.bVf&&(Pm.instance.bQm(),0<r.AFrameworkApplication.pzi&&this.Rch(),this.b4n(),b=!0);r.AFrameworkApplication.T5a&&
b&&Zj.instance.ZPm();r.AFrameworkApplication.kzo&&(b=Pm.instance,b.MBn(),b.mQm(),lf.a.instance.Xb(this.lzo))}b4n(){Od.instance.bch(Object(v.a)(Pm.instance,Pm.instance.aQm,"makeGetMruRequestActivityTrigger"));Od.instance.bch(Object(v.a)(this,this.Rch,"addGetMruFromServerTask"));Od.instance.ibk(Object(v.a)(this,this.E1k,"deleteGetMruFromServerTask"))}E1k(){lf.a.instance.Se(this.qzi)}Rch(){lf.a.instance.Xb(this.qzi)}get qzi(){return this.M1g||(this.M1g=new sc.a(5,2,r.AFrameworkApplication.pzi,Object(v.a)(Pm.instance,
Pm.instance.AKl,"getMruFromServerTask"),109))}get lzo(){return this.tzc||(this.tzc=new sc.a(2,2,6E4*r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(v.a)(Pm.instance,Pm.instance.nQm,"makeUpdateMruTask"),197))}dispose(){this.Mh||(this.Mh=!0,this.tzc&&(lf.a.instance.Se(this.tzc),this.tzc=null))}}Object(m.a)(xo,"CorePackageManager",null,[1,2,9]);var Vn=c(1510),zk=c(111);class Lh{static zal(b){return Lh.znh("New",b)}static Aal(b){return Lh.znh("Open",
b)}static dnh(b,h){return Lh.qYa("LoadingMenuSection",Lh.tHm,b,Lh.qCc("lblLoading",h))}static rCc(b,h,u=null,y=null){return Lh.qYa("MessageMenuSection",Lh.nzi,h,Lh.qCc("lblMessage",b,u,y))}static uvk(b){return Lh.dnh(b,CommonUIStrings.l_VoicedLoadingText)}static vvk(b,h){return Lh.rCc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Oba,h.P5a)}static tvk(b,h){return Lh.rCc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.P5a,"\n\n"),b.labelText)}static hnh(b){return Lh.rCc(CommonUIStrings.l_NewGenericErrorMessage,
b.labelText)}static rvk(b,h,u){return Lh.qYa("menuNewBlank",Lh.v7l,u?b.labelText:null,Lh.lCc(b.Z$h,b.$$h,b.aai,null,b.R0a,b.rOc,h,"blank"))}static ywk(){return Lh.qCc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static xnh(){return Lh.qCc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static zwk(b,h){return Lh.qYa("menuNewTemplates",b,null,h)}static pvk(b,h){return Lh.qYa("menuNewMoreTemplates",Lh.KPh,null,Lh.lCc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,
CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static Xtk(b,h,u){let y="";u&&h&&(y=Lh.qYa("BrowseMoreMenuSection",Lh.KPh,null,Lh.lCc("btnBrowseMore",h,h,null,null,null,b||"1959943459",u)));return y}static qCc(b,h,u=null,y=null){let P=y;h&&0<h.length&&(P=Lh.iAi.vlb(h).trimEnd(),P=0<=P.indexOf("{0}")?String.format(P,y):String.format("{0} {1}",P,y));u=u&&y?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',A.a.Cf(u),A.a.Cf(y),A.a.Cf(P)):
"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',A.a.Cf(b||""),Lh.iAi.vlb(A.a.Cf(h||"")),u)}static lCc(b,h,u,y,P,aa,ta,Pa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',A.a.Cf(b||""),A.a.Cf(h||""),A.a.Cf(u||""),y||"32by32",A.a.Cf(P||""),
A.a.Cf(aa||""),ta,A.a.Cf(Pa||""))}static znh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static qYa(b,h,u,y){u=u?String.format('Title="{0}"',A.a.Cf(u)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',A.a.Cf(b||""),A.a.Cf(h||""),u,y)}}Lh.nzi="MenuMru";Lh.tHm=
"MenuLoading";Lh.v7l="MenuHeader";Lh.KPh="MenuFooter";Lh.iAi=zk.a.QB("\n","&#10;");Object(m.a)(Lh,"NewAndOpenXmlUtilities",null,[]);class rk{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(m.a)(rk,"HostInformation",null,[]);var Jj=c(200);class Rl{constructor(b,h,u,y,P,aa){this.Hrd=this.ow=this.had=null;this.lqd=this.TLe=!1;this.oWg=0;this.xLe=this.Nze=!1;this.Pza=b;this.Tpc=h;this.UUa=new Zf.a(()=>new Vn.a(u.value,Object(v.a)(this,this.NCb,"getMoreInfoEventReceived")));
this.bVj=y;this.Z$a=P;this.s2j=aa;this.Vxc=this.Ube;2===this.J3.VEa&&(this.xLe=!0);r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.Pgl()}get h6(){switch(this.J3.VEa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Pgl(){lf.a.instance.Xb(new sc.a(5,1,0,()=>{this.getTemplateListJson()}))}Wb(){const b=this.J3.dbc;b.pa(Wa.a.newDocument,le.a.frame,
Object(v.a)(this,this.newDocument,"newDocument"));b.pa(Wa.a.D4d,le.a.frame,Object(v.a)(this,this.D4d,"populateNewMenu"))}newDocument(b,h,u,y,P){if(1===u)return 32;if(2===u&&P){if(r.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&P.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),r.AFrameworkApplication.ya.processAction(Wa.a.Djn,2);if(P.MenuItemId&&P.SourceControlId)return"NewDocumentHome"===P.SourceControlId&&Ub.a("NewDocumentFromHomeTab"),
this.pFc(P.MenuItemId,P.SourceControlId)}return 8}pFc(b,h){var u=this.n_d.mAh;if(null===u)return 8;var y=r.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(r.AFrameworkApplication.kGb&&y){w.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const P={};P[G.a.template]=b;P[G.a.h6]=this.h6;P[G.a.lcid]=r.AFrameworkApplication.lcid.toString();P[G.a.reason]=fi.a.R4e;r.AFrameworkApplication.fO().execute(aa=>{aa.sendMessage(H.a.pFc,
P)})}else y=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",u,A.a.Pj(this.WEa),A.a.Pj(b),A.a.Pj(this.h6),A.a.Pj(r.AFrameworkApplication.lcid.toString()),A.a.Pj(y.toString()),A.a.Pj(h),A.a.Pj(r.AFrameworkApplication.canary),r.AFrameworkApplication.Gm),(u=r.AFrameworkApplication.K.lb("ScenarioId"))&&""!==u&&(h+="&wdscenarioid="+A.a.Pj(u)),h+="&"+r.AFrameworkApplication.wMd(),r.AFrameworkApplication.W1a&&
(h+="&"+r.AFrameworkApplication.dLd()),(u=this.ow?this.ow.Oba:null)&&(h+="&DestinationUrl="+A.a.Pj(u)),Je.a.en(h,"_blank",void 0,"CreateNewDocument");2===this.J3.VEa&&w.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Yh.a[this.J3.VEa],["Template"]:b});return 32}NNm(b){let h=Number.MAX_VALUE,u=Number.MIN_VALUE;const y=window.performance;if(y&&"undefined"!==typeof y.getEntriesByName){for(let aa=0;aa<b.length;aa++){var P=y.getEntriesByName(b[aa]);P&&0<P.length&&(P=
P[0],h=Math.min(parseInt(String(P.fetchStart)),h),u=Math.max(parseInt(String(P.responseEnd)),u))}u>h&&w.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:u-h,["MinFetchStart"]:h,["MaxResponseEnd"]:u})}}D4d(b,h,u,y,P){if(1===u)return this.xLe&&(r.AFrameworkApplication.Bga("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.xLe=!1),32;2!==u||this.Nze||(this.oWg=(new Date).getTime(),w.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",
{["ShouldShowTemplates"]:this.Ube,["CachedNewMenuXmlExists"]:!!this.had,["ShouldCallGetMoreInfo"]:this.J3.T5a}));r.AFrameworkApplication.Ce("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");r.AFrameworkApplication.Ce("templatesCreateNewcf;templatesCreateNewtf");return this.nin(P)}nin(b){b&&(this.had?b.PopulationXML=this.had:(this.J3.T5a&&!this.ow&&this.EXm.gk("Opened New menu",!0),b.PopulationXML=this.Kql(this.getTemplateListJson())));return 32}Qmi(){return!this.J3.T5a||!!this.ow&&
3===this.ow.state&&!!this.ow.P5a&&!!this.ow.Oba}Bum(){return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa?!0:this.Qmi()}getTemplateListJson(){if(!this.Ube||!this.Bum())return null;if(this.Vxc&&!this.lqd){var b="9";r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=r.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in h&&(b=h.NumberOfTemplatesInBackstage);let u=
this.h6;const y=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.CreateNewTemplates","");""===y?"TemplateCollectionId"in h&&(u=h.TemplateCollectionId):3===this.J3.VEa&&(u=y);b=String.format(this.J3.iQa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",A.a.Pj(r.AFrameworkApplication.lcid.toString()),A.a.Pj(u),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in
h&&(b+="&templateTier="+h.TemplateTier);b+="&"+r.AFrameworkApplication.wMd();r.AFrameworkApplication.W1a&&(b+="&"+r.AFrameworkApplication.dLd());this.J3.DVc.qj(b,1,null,null,!1,2,P=>{this.J3.NPa("CreateNewActor.GetTemplateListJson",P.data);this.Rko(P.data.Ae)},P=>{this.J3.NPa("CreateNewActor.GetTemplateListJson",P.data);this.Qko()},null,void 0,void 0,void 0,void 0,"5");this.Vxc=!1}return this.Hrd}Rko(b){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.Hrd=this.Lhl(b):this.Hrd=b;this.Vxc=!1;this.B_c();if(r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa&&fh.c()){b=r.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const h=r.AFrameworkApplication.kGb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Hrd,!0,b&&h))}}Qko(){this.lqd=this.Vxc=!0;this.B_c();r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa&&fh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));Ta.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Lhl(b){b=JSON.parse(b);const h=new ob.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const u=Jj.a.cfg(b,y=>h.contains(y.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(u));return JSON.stringify(b)}znf(b){var h=0;for(var u=0;u<b.length;u++)if("ST"===b[u].ImageType){h=u;break}const y=b.length?b[h]:null;b=y?y.Url||"":"";var P;let aa=u=h=!1;if(y&&(P=y.AspectRatio))P=
parseFloat(P),1>P?h=!0:1.5<P?u=!0:1===P&&(aa=!0);else switch(w.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.J3.VEa){case 3:h=!0;break;case 2:u=!0;break;case 5:aa=!0}return{returnValue:b,kam:h?"95by123":u?"123by69":aa?"100by100":"123by95"}}Kql(b){b=({Cbe:h}=this.svk(b,this.n_d,this.n_d.uCc||"1056925771")).returnValue;if(h){this.had=b;var h=(new Date).getTime()-this.oWg;w.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:h})}return b}NCb(b,h){w.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.ow||3!==b.state?2===b.state&&(w.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.TLe=!0,this.B_c()):(this.ow=b,h||this.B_c(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa&&fh.c()&&fh.d("setFileMenuHostInformation")&&(b=Object.assign(new rk,{hostUrl:this.ow.Oba,hostName:this.ow.P5a,folderUrl:r.AFrameworkApplication.breadcrumbFolderUrl,
folderName:r.AFrameworkApplication.breadcrumbFolderName}),w.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}svk(b,h,u){let y;y=!1;const P=this.Qmi();let aa="";this.J3.T5a&&(this.TLe?(aa=Lh.hnh(h),this.TLe=!1,w.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.ow?P?aa=Lh.vvk(h,this.ow):this.ow.Bhm?(y=!0,this.Vxc=!1,aa=Lh.tvk(h,this.ow),w.ULS.sendTraceTag(5849607,
202,50,"Rendering File>New with personal storage instantiation message")):(y=!0,aa=Lh.hnh(h),w.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.ow.Oba,["StorageServiceDisplayNameIsSet"]:!!this.ow.P5a})):(aa=Lh.uvk(h.labelText),w.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));P&&(aa+=Lh.rvk(h,u,!aa)+({Cbe:y}=this.xwk(b,u)).returnValue);return{returnValue:Lh.zal(aa),
Cbe:y}}xwk(b,h){let u;u=!1;if(!this.Ube)return u=!0,w.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Cbe:u};let y="",P="",aa="MenuTemplate";if(this.lqd)y=Lh.xnh(),this.lqd=!1,w.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ta=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);y=this.wwk(ta,h);w.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");r.AFrameworkApplication.jAi&&
"OneDrive"===this.WEa&&(P=Lh.pvk(this.FXm,r.AFrameworkApplication.jAi))}catch(ta){w.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),y=Lh.xnh()}u=!0}else aa="MenuLoading",y=Lh.ywk(),w.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Lh.zwk(aa,y)+P,Cbe:u}}wwk(b,h){let u="";const y=[];for(let aa=0;aa<b.length;aa++){var P=b[aa];let ta="";if(P){const Pa=P.Title,vb=P.AssetId;P=P.Thumbnails;
vb&&Pa&&P&&({kam:P,returnValue:ta}=this.znf(P),u+=Lh.lCc("jbtnNewTemplate"+aa,Pa,null,P,null,ta,h,vb))}y[aa]=ta}b=new sc.a(4,1,5E3,()=>{this.NNm(y)},106);this.J3.j_d.Xb(b);return u}B_c(){this.Nze=!0;this.J3.Zzi.xHa(this.n_d.iJc);this.Nze=!1}get J3(){return this.Pza.value}get n_d(){return this.Tpc.value}get EXm(){return this.UUa.value}get FXm(){return this.bVj.value}get WEa(){return this.Z$a.value}get Ube(){return this.s2j.value}}Object(m.a)(Rl,"CreateNewActor",null,[]);class cl{constructor(){this._initialized=
!1;this.dNe={}}vE(b){this.tKh();return this.get(b)}contains(b){this.tKh();return b.toString()in this.dNe}tKh(){this._initialized||(this.Rck(),this._initialized=!0)}gcb(b,h){this.dNe[b.toString()]=h}get(b){return this.dNe[b.toString()]}}Object(m.a)(cl,"AIntlHelper",null,[]);class Am extends cl{constructor(){super()}Rck(){this.gcb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.gcb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.gcb(2,CommonUIStrings.l_Open);this.gcb(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.gcb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.gcb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Am._instance||(Am._instance=new Am)}static Zan(b){return Am.instance.vE(b)}}Am._instance=null;Object(m.a)(Am,"MruActorIntlHelper",cl,[]);var fk;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(fk||(fk={}));Object(m.b)("DisplayState",fk);class cf{constructor(b,h,u,y,P,aa,ta,Pa){this.Yne=null;this.LQe=!0;this.gad="";
this.t5j=0;this.zUb=null;this.sBe=3;this.Ma=Pa;this.Pza=b;this.bsa=h;this.ELj=u;this.QFj=y;this.PFj=P;this.UUa=new Zf.a(()=>new Vn.a(aa.value,null));this.wNj=new Zf.a(()=>new Vn.a(ta.value,Object(v.a)(this,this.vWm,"mruEventResultReceived")));this.Ma.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ma.$("UiHostSupportsDocRebootFeatures")}vWm(b,h){this.zUb=b;h||this.RSi()}SAn(){this.jM.dbc.gb(Wa.a.cRf,le.a.frame,Object(v.a)(this,this.cRf,"populateMruMenu"),96)}cRf(b,h,u,y,P){return 1!==u&&P?this.kin(P):
32}kin(b){this.gbl();this.fbl();b.PopulationXML=Lh.Aal(this.gad+this.Yne);return 32}gbl(){var b=3;let h=!1;if(this.gad&&this.t5j===this.zUb.Cmo)w.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.sBe;else{w.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var u=this.jM.hr();this.zUb=this.uWm.gk("File Open opened",!0);this.gad&&2!==this.sBe&&3!==this.zUb.state?
h=!0:(b=this.ETl(this.zUb),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.jPa&&fh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.gad=({vXm:b}=this.Lql(this.zUb)).returnValue);u=this.jM.hr()-u;w.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:u})}2!==b&&(u={["DisplayState"]:fk[b]},1!==b&&(u.IsStale=h),w.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",u));this.sBe=
b}ETl(b){let h;try{h=z.c(b.MFf)}catch(u){h=null,w.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",u)}return h}fbl(){this.LQe?(w.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Yne=({$Fo:this.LQe}=this.WPm()).returnValue):w.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");w.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.LQe,
["NotDisplayingLink"]:!this.Yne})}Lql(b){let h;1===b.state||0===b.state?(w.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=Lh.dnh(this.q0a(2),this.q0a(5))):3===b.state&&b.MFf?(h=this.qvk(b.MFf),b=0):(w.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=Lh.rCc(this.q0a(1),this.q0a(2)),b=1);return{returnValue:h,vXm:b}}qvk(b){let h;const u=this.aVc.uCc||"2155708348";if(b.length){h=Lh.qCc("lblRecentDocuments",this.q0a(3));
let y=0;for(let P=0;P<b.length;P++){const aa=b[P];"FileName"in aa&&"DocumentUrl"in aa&&"Path"in aa&&(h+=Lh.lCc("MruButton"+P,aa.FileName.toString(),aa.Path.toString(),null,this.aVc.R0a,this.aVc.rOc,u,aa.DocumentUrl.toString()),aa.IsPinned&&y++)}h=Lh.qYa("RecentDocumentsMenuSection",Lh.nzi,this.q0a(2),h);w.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:y})}else h=Lh.rCc(this.q0a(0),this.q0a(2)),w.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}WPm(){let b;b=!0;let h=this.otk;var u=this.ntk;if(h&&u||!this.jM.T5a)b=!1;else{const y=this.iLd.gk("File Open",!1);3===y.state&&(h=y.Oba,u=y.P5a,b=!1)}u=u?String.format(this.q0a(4),u):null;return{returnValue:Lh.Xtk(this.aVc.uCc,u,h),$Fo:b}}RSi(){this.jM.Zzi.xHa(this.aVc.iJc)}get jM(){return this.Pza.value}get q0a(){return this.bsa.value}get aVc(){return this.ELj.value}get otk(){return this.QFj.value}get ntk(){return this.PFj.value}get iLd(){return this.UUa.value}get uWm(){return this.wNj.value}}
Object(m.a)(cf,"MruRenderer",null,[]);var ig=c(1514);class gk{constructor(b,h,u,y,P,aa,ta){this.ow=null;this.l4g=!1;this.Uqa=this.P0=0;this.qVj=b;this.$Ub=h;this.vkd=u;this.Tpc=y;this.Z$a=P;this.Pza=aa;this.UUa=new Zf.a(()=>new Vn.a(ta.value,Object(v.a)(this,this.NCb,"getMoreInfoEventReceived")))}pFc(){!this.ow&&this.mIf.T5a?this.iLd.gk("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}NCb(b){if(!this.ow&&3===b.state)this.ow=b;else if(2===b.state){this.l4g?w.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.iLd.gk("NewDocumentFromStream",!0),this.l4g=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.P0=(new Date).getTime();var b=this.ahl.mAh;if(null===b)this.$Ub(null);else{var h=this.vkd.menuItemId,u=this.vkd.EGa,y=this.vkd.Dgo,P=this.vkd.ihl;this.Uqa="streamBase64"===y?P.length/1024:0;w.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.h6,this.Uqa);var aa=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,A.a.Pj(this.WEa),A.a.Pj(h),A.a.Pj(this.h6),A.a.Pj(r.AFrameworkApplication.lcid.toString()),A.a.Pj(aa.toString()),A.a.Pj(u),A.a.Pj(r.AFrameworkApplication.canary),r.AFrameworkApplication.Gm,A.a.Pj(y));b+="&"+r.AFrameworkApplication.wMd();r.AFrameworkApplication.W1a&&(b+="&"+r.AFrameworkApplication.dLd());(h=this.ow?this.ow.Oba:null)&&(b+="&DestinationUrl="+A.a.Pj(h));this.mIf.DVc.qj(b,2,P,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(v.a)(this,this.yXm,"newDocumentFromStreamSuccessHandler"),
Object(v.a)(this,this.xXm,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}yXm(b){if(b&&b.data&&b.data.Ae)if(({Uv:h}=z.d(b.data.Ae)).returnValue)if(b=h,b.StatusCode!==qa.a.tB&&b.StatusCode!==qa.a.DFc)w.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.h6,this.Uqa,b.StatusCode),this.$Ub(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.P0;w.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.h6,this.Uqa,h);this.qVj(b.NewDocumentUrl)}else w.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.h6,this.Uqa),this.$Ub(null);else w.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.h6,this.Uqa,{["ResponseData"]:ig.a.x6c(b.data.Ae)}),this.$Ub(null);else w.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.h6,this.Uqa),this.$Ub(null)}xXm(b){b&&b.data&&w.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.h6,this.Uqa,b.data.status);this.$Ub(null)}get h6(){switch(this.mIf.VEa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get ahl(){return this.Tpc.value}get WEa(){return this.Z$a.value}get mIf(){return this.Pza.value}get iLd(){return this.UUa.value}}
Object(m.a)(gk,"NewDocumentFromStreamOperation",null,[]);class wi{constructor(b,h,u,y){this.Tpc=b;this.Z$a=h;this.Pza=u;this.vNj=y}create(b,h,u){return new gk(b,h,u,this.Tpc,this.Z$a,this.Pza,this.vNj)}}Object(m.a)(wi,"NewDocumentFromStreamOperationFactory",null,[762]);var pf=c(121);class wn{get name(){return"Common.App.NewAndOpen.UX"}xc(b){b.register(wi,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Xd(()=>
new wi(new Zf.a(()=>r.AFrameworkApplication.ta.Pb.Gif()),new Zf.a(()=>r.AFrameworkApplication.WEa),new Zf.a(()=>b.Pa("Common.INewAndOpenCommonHelpers")),new Zf.a(()=>b.Pa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){r.AFrameworkApplication.K.lp(()=>{this.a1a()})}a1a(){const b=Jh.a.sq(Ja.a.instance.Za("Common.INewAndOpenCommonHelpers")),h=Jh.a.sq(Ja.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));r.AFrameworkApplication.WEa&&pf.Task.WAA.call(null,b,h).continueWith(()=>
{const u=new Rl(new Zf.a(()=>b.result),new Zf.a(()=>r.AFrameworkApplication.ta.Pb.Gif()),new Zf.a(()=>h.result),new Zf.a(()=>r.AFrameworkApplication.ta.Pb.Hif().uCc||"1959943459"),new Zf.a(()=>r.AFrameworkApplication.WEa),new Zf.a(()=>r.AFrameworkApplication.jsm));u.Wb();u.B_c()});if(r.AFrameworkApplication.bVf){const u=Jh.a.sq(Ja.a.instance.Za("Common.IEventEmitter<Common.IMruResult>"));pf.Task.WAA.call(null,b,h,u).continueWith(()=>{const y=new cf(new Zf.a(()=>b.result),new Zf.a(()=>Am.Zan),new Zf.a(()=>
r.AFrameworkApplication.ta.Pb.Hif()),new Zf.a(()=>r.AFrameworkApplication.Yan),new Zf.a(()=>r.AFrameworkApplication.Xan),new Zf.a(()=>h.result),new Zf.a(()=>u.result),r.AFrameworkApplication.K);y.SAn();y.RSi()})}}dispose(){}}Object(m.a)(wn,"UXPackageManager",null,[1,2,9]);var Gh=c(144);class Gl extends Gh.StandardDialog{constructor(){super();this.Ed=0;this.Ue(1,CommonUIStrings.l_DialogClose)}$S(b){this.py(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}m9e(b){this.py(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(m.a)(Gl,"ErrorDialog",Gh.StandardDialog,[739]);var Jk=c(438);class Ei{rSh(){w.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Jk.a;b.Cg("api.onedrive.com");return b.task}}Object(m.a)(Ei,"OneDriveConsumerEndpointHelper",null,[707]);var bc=c(41);class oe{constructor(b,h,u,y){this.mub=this.cFa=null;this.jLe=this.lLe=!1;this.mVb=null;this.Ma=b;this.z$c=h;this.utb=u;this.FG=y}get ghh(){return this.z$c}get K(){return this.Ma}r5b(){this.mVb||
(this.mVb=this.tcc?Nb.a.create(this.tcc,null,null,null,!1):null);return this.mVb}setup(b){this.mub=b;this.lLe||this.jLe?this.lLe&&this.mub&&this.mub(!0):(b=this.r5b())?(this.jLe=!0,b.G2a.continueWith(h=>{this.A6m(h)}),Ib.a.eT(b)):(w.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.mub(!1))}$Lf(b){w.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}A6m(b){this.jLe=
!1;if(b.Di)this.$Lf(b),this.mub(!1);else try{this.lLe=!0,w.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.fsf(),w.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.mub(!0)}catch(h){w.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.mub(!1)}}I4c(b){this.cFa=b;this.utb?w.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(w.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(v.a)(this,this.fKf,"onApiReady")))}fKf(b){b?this.eWd():this.Kp()}Kp(){this.FG().$S(bc.a.jan)}onSuccess(b){w.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.cFa&&this.cFa(!0,b)}dispose(){this.mVb&&this.mVb.dispose()}}Object(m.a)(oe,"AOneDriveFilePickerApiManager",null,[768,9]);class Me extends oe{constructor(b,h,u,y,P,aa){super(h,u,y,aa);this.Pm=null;this.Xra=b;this.B2j=P}get tcc(){return this.K.lb("OneDriveApiUrl")}start(b,h){this.Pm=
b;this.I4c(h)}fsf(){WL.init(1===this.ghh||2===this.ghh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}I4c(b){this.cFa=b;!this.utb&&this.Xra.TPc?(w.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(v.a)(this,this.fKf,"onApiReady"))):(w.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.B2j())}eWd(){try{w.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Pm).then(Object(v.a)(this,this.onSuccess,"onSuccess"),Object(v.a)(this,this.onFailure,"onFailure"))}catch(b){w.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Kp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){w.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}w.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else w.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.cFa&&this.cFa(!1,b);this.Kp()}}Object(m.a)(Me,"OneDriveFilePickerApiManagerV5",oe,[]);class Ri extends oe{constructor(b,h,u,y,P){super(b,h,u,y);this.Cfd=this.zZg=null;this.OKj=P;this.options={};this.options.clientId=this.K.lb("OneDriveApiV7ClientId");this.options.cancel=Object(v.a)(this,this.Mfe,"toggleHostDivVisibility")}get tcc(){return this.K.lb("OneDriveApiV72Url")}start(b,h){this.Cfd=h;const u=
this.OKj.rSh();u.continueWith(()=>{w.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.zZg=u.result;this.I4c((y,P)=>{this.Mfe();b(y,P)})},3);u.continueWith(()=>{w.ULS.sendTraceTag(24134242,352,15,u.exception.message);this.Mfe()},5)}fsf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.zZg;this.options.advanced.iframeParentDiv=this.Cfd}eWd(){try{w.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Mfe(),OneDrive.open(this.options)}catch(b){w.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Kp()}}onFailure(b){this.cFa&&this.cFa(!1,b);this.Kp()}Mfe(){this.Cfd.style.visibility="hidden"===this.Cfd.style.visibility?"":"hidden"}}Object(m.a)(Ri,"OneDriveFilePickerApiManagerV7",oe,[]);class Rk extends oe{constructor(b,
h,u,y){super(b,h,u,y);this.hEj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.lb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get tcc(){return this.K.lb("OneDriveApiV72Url")}start(b,h,u,y){this.options.advanced.iframeParentDiv=u;this.options.advanced.endpointHint=y;this.options.cancel=h;this.hEj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.I4c(b)}I4c(b){this.cFa=b;this.utb?w.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(w.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(v.a)(this,this.fKf,"onApiReady")))}fsf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}eWd(){try{w.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){w.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Kp()}}$Lf(b){w.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Ib.a.AEn(this.tcc);this.mVb=null}Kp(){this.FG().m9e(bc.a.hPn)}onFailure(b){this.cFa&&this.cFa(!1,b)}}Object(m.a)(Rk,"OneDriveFilePickerApiManagerV72",
oe,[]);class cg{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(m.a)(cg,"IExtraData",null,[]);class af extends Rk{constructor(b,h,u,y){super(b,h,u,y);this.options.advanced.filter=b.lb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=r.AFrameworkApplication.shh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.lb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new cg(r.AFrameworkApplication.userSessionId))}get tcc(){return this.K.lb("OneDriveApiV72Url")}eWd(){try{w.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",r.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){w.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Kp()}}}Object(m.a)(af,"OneDriveFilePickerApiOpenManagerV72",Rk,[]);class Zi{constructor(b){this.Op=null;this.rg=b;this.AJe=3}rSh(){this.Op=new Jk.a;w.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.S0f();return this.Op.task}S0f(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",r.AFrameworkApplication.Uzb);this.rg.dZb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(v.a)(this,this.tKl,"getMoreInfoSucceeded"),Object(v.a)(this,this.rKl,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}rKl(b){if(b.data.jf===qa.a.Eoa&&"X-NewKey"in b.data.Bj){w.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.Bj["X-NewKey"];this.S0f(h)}else 0<this.AJe?(w.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.AJe),this.AJe--,this.S0f()):(w.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Op.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}tKl(b){"PersonalFileStorageUrl"in b.data.Bj&&""!==b.data.Bj.PersonalFileStorageUrl?(w.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Op.Cg(b.data.Bj.PersonalFileStorageUrl)):(w.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Op.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(m.a)(Zi,"OneDriveForBusinessEndpointHelper",null,[707]);var si=c(751);class eo{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}xc(b){this.W=b;this.W.register(Me,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Xd(()=>new Me(si.a.instance,r.AFrameworkApplication.K,
r.AFrameworkApplication.Vla,r.AFrameworkApplication.Qna,r.AFrameworkApplication.d6f,()=>new Gl));r.AFrameworkApplication.K9b?this.W.register(707,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Xd(()=>new Ei):this.W.register(707,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Xd(()=>new Zi(r.AFrameworkApplication.Ve));this.W.register(Ri,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Xd(()=>new Ri(r.AFrameworkApplication.K,
r.AFrameworkApplication.Vla,r.AFrameworkApplication.Qna,()=>new Gl,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Rk,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Xd(()=>new Rk(r.AFrameworkApplication.K,r.AFrameworkApplication.Vla,r.AFrameworkApplication.Qna,()=>new Gl));this.W.register(af,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Xd(()=>new af(r.AFrameworkApplication.K,
r.AFrameworkApplication.Vla,r.AFrameworkApplication.Qna,()=>new Gl))}static main(){K.a.instance.Kc(new eo)}}Object(m.a)(eo,"PackageManager",null,[1,2]);class lk{constructor(b,h,u,y,P,aa){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=u;this.PolicyCookieTTL=y;this.WasServiceDown=P;this.AffinitizedUrl=aa}}Object(m.a)(lk,"SafeLinksData",null,
[]);class cn{constructor(b,h){this.$ee=b;this.ry=h}}Object(m.a)(cn,"SafeLinksGetUrlReputationRequestData",null,[]);class Al{constructor(b,h,u,y){this.Ma=b;this.rg=h;this.PNj=u;Al.je=y}vjc(b,h,u){try{var y=null;Al.je&&(y=Al.je.jg("WebServiceCall","SafeLinksGetUrlReputation"));const P=new cn(h,y);y={};y.AffinitizedUrl=b;y.TargetUrl=h;y.PolicyCookie=u;const aa=z.c(y);this.rg.qj(this.PNj,2,aa,null,!1,2,Object(v.a)(this,this.u4m,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.t4m,"onGetUrlReputationFailureCallback"),
P,void 0,void 0,3E3,3E3,"36");return!0}catch(P){w.ULS.sendTraceTag(588788033,378,10,P.message)}return!1}u4m(b){let h="OnGetUrlReputationSuccessCallback: ",u=10;const y=b.data.state;try{const P=z.b(b.data.Ae).reputationResults[0],aa=P.navigateUrl.length,ta=y.$ee.length,Pa=P.navigateUrl===y.$ee;P.navigateUrl&&0<P.navigateUrl.length&&(y.$ee=P.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.jf,P.verdict,
ta.toString(),aa.toString(),Pa.toString());u=50}catch(P){h+=String.format("Exception {0}",P.message)}this.g9h(y,h,u)}t4m(b){let h="OnGetUrlReputationFailureCallback: ";const u=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.jf)}catch(y){h+=String.format("Exception {0}",y.message)}this.g9h(u,h,10)}g9h(b,h,u){b.ry&&(b.ry.stop(),b.ry=null);w.ULS.sendTraceTag(588788034,378,u,h);Je.a.en(b.$ee,void 0,"noopener,noreferrer","SafeLinksNav")}}Al.je=null;Object(m.a)(Al,"SafeLinksNavigationHelper",
null,[]);var Vc;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Vc||(Vc={}));Object(m.b)("SafeLinksNavigationState",Vc);class Sk{constructor(b,h,u,y=!1,P=null,aa=null){this.dsb=this.csb=0;this.JQc=this.Wed=!1;this.vab=null;this.iUb=!0;this.Gpd=null;w.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Ma=b;this.rg=h;this.xya=u;Sk.je=aa;this.v7j=y?this.Ma.lb("SafeLinksHandlerWebServiceBase"):this.Ma.lb("WebServiceBase");this.N6j=this.Ma.lb("SafeLinksHashedUserId");this.bKo=this.Ma.lb("SafeLinksWorkloadIdHeaderValue");this.Ijd=this.Ma.pc("SafeLinksMaxGetPolicyBootRetries",2);this.Jjd=this.Ma.pc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.lhd=this.pvm();this.khd=this.ovm();w.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.lhd,this.khd);
if(this.lhd&&this.khd){h=(b=this.t4b())?b.IsSafeLinksEnabled.toLowerCase():"";u=this.xxf();w.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,u);var ta=!b||"unknown"===h||b.WasServiceDown||u,Pa=sa.a.AF();Pa&&(Pa.set("shouldGetSafeLinksDataFromServer",ta.toString()),Pa.set("isSafeLinksEnabledCacheValue",h.toString()));P?(this.iUb=!1,P.execute(vb=>{vb.isFeatureEnabled("MsoUrlreputation",!0).then(Kb=>{this.iUb=Kb;Pa.set("isUserLicensedForSafeLinks",
this.iUb.toString());Ta.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Pa);this.iUb&&ta&&this.pMd(!0);return null})})):(Ta.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Pa),ta&&this.pMd(!0))}}get appName(){return this.xya}get Oie(){return this.v7j}get userId(){return this.N6j}get gPl(){const b=this.Oie?this.Oie+"/":"",h=new fa.QueryStringBuilder("SafeLinksHandler.ashx");h.Pe("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&h.Pe("action","debug");
this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Pe("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Pe("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),r.AFrameworkApplication.Gm)}get UYl(){const b=this.Oie?this.Oie+"/":"",h=new fa.QueryStringBuilder("SafeLinksHandler.ashx");h.Pe("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&h.Pe("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&h.Pe("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Pe("s2saat","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Pe("s2se03","1");h.Pe("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),r.AFrameworkApplication.Gm)}get aXm(){Sk.lKe||(Sk.lKe=new Al(this.Ma,this.rg,this.UYl,Sk.je));return Sk.lKe}vjc(b){if(!b)return w.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var h=this.Vpm(b);w.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.lhd,this.khd,this.iUb);if(!(h&&this.lhd&&this.khd&&this.iUb))return!1;h=0;const u=({state:h}=this.z8n()).returnValue;w.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Vc[h]);const y=sa.a.AF();y&&y.set("SafeLinksNavigationState",Vc[h]);Ta.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",y);if(!u)return 2!==h&&3!==h||Ta.Health.instance.recordKpiFailure("SafeLinksNavigations",Vc[h],!1,!0,null),!1;w.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.X8n())return this.xxf()?!1:this.aXm.vjc(this.Jrl(),b,this.W1h());if(!this.xxf())return this.Alj(b),!0;this.vab=b;w.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.JQc=!1;this.pMd();return!0}Vpm(b){b=b.toLowerCase();const h=this.Ma.XB("SafeLinksUnsupportedProtocols");
if(h)for(let u=0;u<h.length;u++)if(b.startsWith(h[u]))return!1;return!0}pMd(b=!1){var h=sa.a.AF();h&&h.set("isOnBootRequest",b.toString());Ta.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);Ta.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.O3e("SafeLinksGetPolicy");this.rg.qj(this.gPl,1,null,null,!0,2,Object(v.a)(this,this.zSl,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.ySl,"getSafeLinksDataFromServer_OnFailureCallback"),
h,void 0,void 0,void 0,void 0,"23");this.JQc=b;this.Wed=!0;b?this.csb++:this.dsb++}zSl(b){let h=qa.a.KYm,u="";try{this.Wed=this.JQc=!1;var y=b.data.state;const Ac=({ry:y}=this.Lde(y)).returnValue,Sc=Object.assign(new Ya.a,{durationMs:Ac});Ta.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Sc);w.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.jf,b.data.Ae.length,Ac);if(b.data.jf!==qa.a.tB)u=
"Unexpected httpStatus: "+b.data.jf.toString();else{y=null;try{y=z.b(b.data.Ae)}catch(nd){u="Exception:"+nd.toString()+" deserializing response";return}if(y){var P=y.IsSafeLinksEnabled;if(void 0===P||null===P||0>=P.length)u="Invalid isSafeLinksEnabledString";else{w.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",P);var aa=Sk.JPf(P);if(void 0===y.WebAffinitizedUrl||null===y.WebAffinitizedUrl||0>=y.WebAffinitizedUrl.length)u="Invalid WebAffinitizedUrl";else if(void 0===y.PolicyCookie||
null===y.PolicyCookie||0>=y.PolicyCookie.length)u="Invalid PolicyCookie";else if(void 0===y.PolicyCookieTTL||null===y.PolicyCookieTTL)u="Invalid PolicyCookieTTL";else{var ta=y.WebAffinitizedUrl,Pa=y.PolicyCookie,vb=y.AffinitizedUrl,Kb=new Date;Kb.setMinutes(Kb.getMinutes()+(5<y.PolicyCookieTTL?y.PolicyCookieTTL-5:0));var Sb=Kb.getTime(),Yb=new lk(P,ta,Pa,Sb,!1,vb);this.t4i(Yb);h=b.data.jf;this.vab&&(aa?(this.Alj(this.vab),this.dsb=this.csb=0):(w.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),
Ta.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Je.a.HBb(this.vab)),this.vab=null)}}}else u="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Ac){u="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Ac.toString()}finally{h!==qa.a.tB&&this.f9h(h,u)}}ySl(b){this.Wed=!1;let h=500,u="";try{let y=b.data.state;const P=({ry:y}=this.Lde(y)).returnValue,aa=Object.assign(new Ya.a,{durationMs:P});h=b.data.jf;Ta.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+h.toString(),!1,!0,aa);u="Request Failed, Status="+ji.a[b.data.status]+" Duration: "+P}catch(y){u="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+y.toString()}finally{this.f9h(h,u)}}f9h(b,h=""){try{if(w.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.csb<this.Ijd&&this.dsb<this.Jjd)this.pMd(this.JQc);else{this.JQc=!1;w.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.csb,this.dsb,b,h);h=null;const u=sa.a.AF();u&&(u.set("HttpStatus",b.toString()),h=Object.assign(new Ya.a,{extendedProperties:u}));Ta.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const y=new lk("false","","",0,!0,"");this.t4i(y);this.vab&&(w.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),Ta.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Je.a.HBb(this.vab),this.vab=null)}}catch(u){w.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",u.toString())}}Alj(b){const h=this.W1h(),u=this.c_l(),y={};y.Url=b;y.SafeLinksCookie=h;y.CorrelationId=Ua.a.create().toString();y.WorkloadId=this.bKo;y.UserAgentInfo=ba.a.tF+"|"+this.appName;w.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",y.CorrelationId);Je.a.nRf(Je.a.aqa(4),u,y)}pvm(){const b=this.Ma.lb("IsSafeLinksEnabledForUser");
return b?Sk.JPf(b):!1}ovm(){const b=this.Ma.XB("SafeLinksDisabledBrowsers");if(ba.a.n3){if(this.Ma.Sv("SafeLinksForTeamsIsEnabled")&&this.Ma.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,ba.a.tF))return!1;return"officecomhwa"===(this.Ma.lb(r.AFrameworkApplication.wia)||"").toLowerCase()?!1:!0}X8n(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&ba.a.Kwf?!0:ba.a.n3}z8n(){let b;b=0;const h=this.t4b(),u=h?h.IsSafeLinksEnabled:"";if(""!==u)return h.WasServiceDown?(w.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===u.toLowerCase()?(w.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:Sk.JPf(u),state:b};if(this.Wed)return b=3,w.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.csb>=
this.Ijd||this.dsb>=this.Jjd)return b=2,w.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.csb,this.Ijd,this.dsb,this.Jjd),{returnValue:!1,state:b};w.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.Ijd+this.Jjd-(this.csb+this.dsb));return{returnValue:!0,state:b}}W1h(){const b=
this.t4b();return b?b.PolicyCookie:""}c_l(){const b=this.t4b();return b?b.WebAffinitizedUrl:""}Jrl(){const b=this.t4b();return b?b.AffinitizedUrl:""}XBl(){const b=new Date;try{const h=this.t4b();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){w.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}xxf(){const b=this.XBl();return!!b&&b.getTime()<Date.now()}t4b(){if(!this.Gpd){const b=Eb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Gpd=
JSON.parse(b)}return this.Gpd}t4i(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Gpd=b;b.WasServiceDown||this.pKo(b)}pKo(b){b=JSON.stringify(b);Eb.a.instance.setItem(this.userId,b)}O3e(b){return void 0!==Sk.je&&null!==Sk.je?Sk.je.jg("WebServiceCall",b):null}Lde(b){if(void 0!==b&&null!==b){const h=b.vi;b.stop();return{returnValue:h,
ry:null}}return{returnValue:null,ry:b}}static JPf(b){return"false"!==b.toLowerCase()?!0:!1}}Sk.je=null;Sk.lKe=null;Object(m.a)(Sk,"SafeLinksManager",null,[740]);const ne=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},qi=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Wf{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}xc(b){this.W=
b}init(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.lp(Object(v.a)(this,this.rx,"onFullAppSettingsReady"))}dispose(){}rx(){r.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(Sk,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Xd(()=>new Sk(r.AFrameworkApplication.K,r.AFrameworkApplication.Ve,String.format("{0}-{1}",ne(r.AFrameworkApplication.ta.Pb.$n),qi(r.AFrameworkApplication.ta.Pb.Qga)),!1,this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
r.AFrameworkApplication.ta.tq)),this.W.Pa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){K.a.instance.Kc(new Wf)}}Object(m.a)(Wf,"SafeLinksPackage",null,[1,2]);var Ak=c(186);class Qf{constructor(b){this.sa=new ie.a;this.Eh=b}icb(b){this.sa.addHandler(Qf.txa,b)}p0c(b){this.sa.removeHandler(Qf.txa,b)}PXa(b){this.sa.addHandler(Qf.LSa,b)}SKb(b){this.sa.removeHandler(Qf.LSa,b)}QTe(b){this.sa.addHandler(Qf.Vic,b)}z5f(){this.sa.raiseEvent(Qf.txa)}Qpf(){return Ak.a.instance.mPa(r.AFrameworkApplication.Iy)}}
Qf.txa="SE";Qf.l2c="SEP";Qf.LSa="SER";Qf.Vic="TRP";Object(m.a)(Qf,"NullSessionExpirationManager",null,[703,704]);class Tk{constructor(){this.Oxc=this.ibb=!1;const b=r.AFrameworkApplication.Iy;0>=b||(this.Iy=b,w.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Iy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:r.AFrameworkApplication.tW}),Ak.a.instance.Hfh(Object(v.a)(this,this.icc,"onSessionExpiredDetected")),Ak.a.instance.Gfh(Object(v.a)(this,
this.fXc,"onSessionExpiringDetected")))}icc(){Ak.a.instance.PWi(Object(v.a)(this,this.icc,"onSessionExpiredDetected"));w.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.lpf()}fXc(){Ak.a.instance.hGn(Object(v.a)(this,this.fXc,"onSessionExpiringDetected"));this.Oxc||this.ibb||(w.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Oxc=!0,this.f6f())}lpf(){this.ibb||(r.AFrameworkApplication.WQ(bc.a.k2c),this.ibb=!0,this.Dce())}}Object(m.a)(Tk,"ASessionExpirationManager",
null,[]);var ff=c(156),vj=c(264);class jd{constructor(b,h,u,y){this.q$f="";this.R9c=b;this.Z4g=u;this.V4g=y;this.sQg=h;b=(new Date(this.R9c)).format(r.AFrameworkApplication.L9i);this.q$f=this.sQg?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Wfc(b){1===b?this.Z4g&&this.Z4g(this.sQg):0===b&&r.AFrameworkApplication.ya.Ub(Wa.a.close,2,vj.g)}dispose(){this.V4g&&this.V4g()}}jd.id="SessionExpirationDialog";Object(m.a)(jd,"SessionExpirationDialogSharedProperties",
null,[]);class Uk{}Uk.Hg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(m.a)(Uk,"SessionExpirationDialogHtml",null,[]);class If extends ff.a{constructor(b,h,u,y){super(h);const P={};this.QWa=new jd(b,h,u,y);this.mg=jd.id;r.AFrameworkApplication.uph?(this.Ed=1,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.Ed=0,this.Qt=!1);h||1===r.AFrameworkApplication.ta.mode?this.Ue(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Ue(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Hg=Uk.Hg;P.WACSessionExpirationText=this.QWa.q$f;this.Wh(CommonUIStrings.l_DefaultDialogTitle,Object(v.a)(this,this.Wfc,"sessionExpirationDialogHandler"),P);this.k4(this.mj("WACSessionExpirationText"))}Wfc(b){this.QWa.Wfc(b)}iqf(){this.hide()}dispose(){super.dispose();this.QWa&&this.QWa.dispose()}}Object(m.a)(If,"LegacySessionExpirationDialog",ff.a,[792]);class zf extends Gh.StandardDialog{constructor(b,h,u,y){super(h);this.QWa=
new jd(b,h,u,y);this.mg=jd.id;r.AFrameworkApplication.uph?(this.Ed=1,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.Ed=0,this.Qt=!1);h||1===r.AFrameworkApplication.ta.mode?this.Ue(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ue(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.xv(CommonUIStrings.l_DefaultDialogTitle,this.QWa.q$f,0,Object(v.a)(this,this.Wfc,"sessionExpirationDialogHandler"))}Wfc(b){this.QWa.Wfc(b)}iqf(){this.hide()}dispose(){super.dispose();this.QWa&&this.QWa.dispose()}}
Object(m.a)(zf,"SessionExpirationDialog",Gh.StandardDialog,[792]);const Wn=(b,h,u,y)=>r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA&&r.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new zf(b,h,u,y):new If(b,h,u,y);var Kh=c(158);class ti extends Tk{constructor(b){super();this.iqd=this.gXb=!0;this.ZY=null;this.sa=new ie.a;this.Eh=b}icb(b){this.sa.addHandler(ti.txa,b)}p0c(b){this.sa.removeHandler(ti.txa,b)}PXa(b){this.sa.addHandler(ti.LSa,b)}SKb(b){this.sa.removeHandler(ti.LSa,
b)}QTe(b){this.sa.addHandler(ti.Vic,b)}Qpf(){return Ak.a.instance.mPa(r.AFrameworkApplication.Iy)}z5f(b){this.gXb=b}f6f(){if(!this.ZY&&!Kh.a.KL){if(this.iqd){const b=Object(v.a)(this,this.t2b,"disposeCallback");this.ZY=Wn(this.Iy,!1,Object(v.a)(this,this.Xfc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(ti.l2c)}}Dce(){this.ZY&&(this.ZY.nga&&this.ZY.iqf(),this.ZY=null);if(this.gXb){const b=Object(v.a)(this,this.t2b,"disposeCallback");this.ZY=Wn(this.Iy,!0,Object(v.a)(this,this.Xfc,"sessionExpirationHandler"),
b)}this.sa.raiseEvent(ti.txa)}t2b(){this.ZY=null}Xfc(b){(b||this.Eh.Iwd())&&this.Eh.refreshDocument(null)}}ti.txa="SE";ti.l2c="SEP";ti.LSa="SER";ti.Vic="TRP";Object(m.a)(ti,"SessionExpirationManager",Tk,[703,704]);class jg{}jg.b8j="Aborting";jg.gud="ActivityDuration";jg.error="Error";jg.jbf="Errors";jg.failed="Failed";jg.yBb="FirstActivity";jg.initialized="Initialized";jg.kickedOut="KickedOut";jg.kBm="LastActivity";jg.YZi="RetryOverride";jg.P8d="RequestGroups";jg.dmb="Requests";jg.a9d="Responses";
jg.G$d="SessionDuration";jg.status="Status";jg.success="Success";jg.nho="Successful";jg.tokens="Tokens";jg.OQf="PollingDuration";Object(m.a)(jg,"SessionExpirationStrings",null,[]);class ej{constructor(b){this.vB={};this.Pia={};this.cWa={};this.Mti=15;this.kSg=!1;this.n1j=new Date;this.Eid=new Date;this.Gb=b;this.$D=new sc.a(2,2,6E4*this.Mti,Object(v.a)(this,this.vuj,"writeMeasures"),135,"SL",!1);this.Gb.Xb(this.$D);this.Vdm()}vuj(){w.ULS.sendTraceTag(41964821,217,50,w.ULS.VSc({["Aggregate"]:this.Pia,
["Current"]:this.vB}))}Vdm(){this.Pia[jg.P8d]=0;this.Pia[jg.dmb]=0;this.Pia[jg.a9d]=0;this.Pia[jg.status]=jg.initialized;this.Pia[jg.yBb]=new Date;this.Pia[jg.G$d]=0;this.Pia[jg.gud]=0;this.Pia[jg.G$d]=0;this.vB[jg.G$d]=0;this.Pia[jg.gud]=0;this.vB[jg.gud]=0}get Ehn(){this.cWa[jg.OQf]=+new Date-+this.cWa[jg.yBb];return this.cWa}Prf(b,h){var u=b[h];u=u?u:0;u++;b[h]=u;this.B2f(b)}B2f(b){const h=new Date;b[jg.gud]=+h-+this.Eid;this.Eid=h;b[jg.G$d]=+this.Eid-+this.n1j;b[jg.kBm]=this.Eid}G8(b,h){this.vB[b]=
h;this.B2f(this.vB)}R1f(b,h){this.vB[b]=h;this.B2f(this.vB)}n7b(b){this.Prf(this.vB,b);this.Prf(this.Pia,b);this.Prf(this.cWa,b)}flush(){this.kSg||(this.Pia[jg.status]=this.vB[jg.status],this.vuj(this.$D),this.Gb.e4(this.$D,6E4*this.Mti))}jKn(){const b=this.vB[jg.status];b&&(this.Pia[jg.status]=b);this.vB={}}AKn(){this.cWa={};this.cWa[jg.OQf]=0;this.cWa[jg.yBb]=new Date}stop(){w.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.kSg=!0;this.Gb.Se(this.$D)}}
Object(m.a)(ej,"SessionLogger",null,[699]);class dl{constructor(b,h){this.gsd=b;this.lza=h}get tokens(){return this.gsd}get errors(){return this.lza}}Object(m.a)(dl,"TokenRefreshArgs",null,[727]);var ui=c(393);class hb extends Sys.EventArgs{constructor(b,h,u,y,P,aa,ta){super();this.cWa=b;this.vhn=h;this.P8d=y;this.failed=P;this.dmb=aa;this.a9d=ta}}Object(m.a)(hb,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Ab=c(29);class Qb{constructor(b,h=null,u=null){this.Oxc=this.ibb=!1;this.iqd=this.gXb=
!0;this.sa=new ie.a;this.Qxc=this.Vsc=this.Ond=!1;this.Tub=null;this.y0g=10;this.Mhd=!1;this.OOe=b;this.yAe=r.AFrameworkApplication.ozm;this.Gb=lf.a.instance;w.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:r.AFrameworkApplication.Iy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:r.AFrameworkApplication.tW});this.re=h||new ej(lf.a.instance);this.lka=u;Ak.a.instance.Hfh(Object(v.a)(this,this.V7j,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));
Ak.a.instance.Gfh(Object(v.a)(this,this.uRe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ui.SessionStatusManager.instance.OTe(Object(v.a)(this,this.uRe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ui.SessionStatusManager.instance.lgk(Object(v.a)(this,this.rjn,"preemptiveTokenRefresh"));this.FTg=new Date;r.AFrameworkApplication.nzm&&(Ak.a.instance.$Ze=Object(v.a)(this,this.oxn,"refreshAccessTokenWhenSessionExpired"));b=!1;r.AFrameworkApplication.K&&(r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",
!1),this.y0g=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldResetLastAttemptWhenNetworkResumed",!1));b?ui.SessionStatusManager.instance.OTe(Object(v.a)(this,this.W7j,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):ui.SessionStatusManager.instance.OTe(Object(v.a)(this,
this.uRe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}icb(b){this.sa.addHandler(Qb.txa,b)}p0c(b){this.sa.removeHandler(Qb.txa,b)}PXa(b){this.sa.addHandler(Qb.LSa,b)}SKb(b){this.sa.removeHandler(Qb.LSa,b)}QTe(b){this.sa.addHandler(Qb.Vic,b)}Qpf(){return Ak.a.instance.mPa(r.AFrameworkApplication.Iy)}oxn(){this.pNc(!1);return!Ak.a.instance.mPa(r.AFrameworkApplication.Iy)}V7j(b,h){Ak.a.instance.RUd?this.icc(b,h):this.yAe?(this.Vsc=!1,this.pNc(!1)):(this.ibb||w.ULS.sendTraceTag(520954892,
217,15,"Detected session expiry before token refresh got blocked"),this.icc(b,h))}W7j(b,h){Ak.a.instance.QUd?this.fXc(b,h):(Ab.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.Vsc=!1,this.pNc(!0))}uRe(b,h){Ak.a.instance.QUd?this.fXc(b,h):this.pNc(!0)}pNc(b){if(!this.Ond&&!this.Vsc)if(this.lka&&this.lka.zo)this.Qxc=!0,this.re.G8(jg.status,jg.kickedOut),this.re.flush(),this.re.stop();else if(w.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",
b,this.Qxc),this.Qxc)this.Dce();else{this.re.flush();this.re.jKn();this.re.n7b(jg.P8d);this.Ond=!0;this.Mhd||(this.re.AKn(),this.Mhd=!0,this.dRk());const h=this.OOe.Fxn(b);h.continueWith(()=>{if(this.OOe.pnn(h))this.re.n7b(jg.nho),this.re.G8(jg.status,jg.success),this.iqd=!1,this.yAe&&(this.gXb=!1),this.Vsc=!1,this.FTg=new Date,this.jgo(),this.sa.raiseEvent(Qb.LSa,new dl(h.result.tokens,null));else{const u=h.result.errors;this.re.n7b(jg.failed);this.re.G8(jg.status,jg.failed);b||(this.Qxc=this.OOe.DRc(u));
this.Qxc&&(this.re.G8(jg.b8j,JSON.stringify(u)),w.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Vsc=!0;this.sa.raiseEvent(Qb.LSa,new dl(null,u))}this.re.flush();this.Ond=!1})}}icc(){this.yAe||Ak.a.instance.PWi(Object(v.a)(this,this.icc,"onSessionExpiredDetected"));w.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.lpf(Ak.a.instance.RUd)}fXc(){this.Oxc||this.ibb||(w.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Oxc=!0,
this.f6f(Ak.a.instance.QUd))}lpf(b){if(!this.ibb){var h=b?bc.a.CUn:bc.a.k2c;const u=Object.assign(new Ya.a,{extendedProperties:new Map});u.extendedProperties.set("ErrorCode",String.format("{0}",h));r.AFrameworkApplication.WQ(h,void 0,["SessionExpired"],u);b||(b=new Date,h=new Date(r.AFrameworkApplication.tW),w.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&Ta.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",
["SessionExpired"],!0,!0,!1,!0,u),2592E5>+b-+h&&Ta.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,u));this.ibb=!0;this.Dce()}}jgo(){this.Mhd&&(this.Gb.Se(this.Tub),this.Mhd=!1)}dRk(){this.Tub=new sc.a(2,2,1E3*this.y0g,Object(v.a)(this,this.wno,"tokenRefreshPolling"),135);this.Gb.Xb(this.Tub)}wno(){const b=this.re.Ehn;w.ULS.sendTraceTag(555255521,217,50,"{0}",z.c(b));this.sa.raiseEvent(Qb.Vic,new hb(b,b[jg.OQf],b[jg.yBb],b[jg.P8d],b[jg.failed],
b[jg.dmb],b[jg.a9d]))}rjn(){3E5<+new Date-+this.FTg?(w.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.pNc(!1)):w.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}Qb.txa="SE";Qb.l2c="SEP";Qb.LSa="SER";Qb.Vic="TRP";Object(m.a)(Qb,"ASessionExpirationManagerWithRefresh",null,[]);class uc extends Qb{constructor(b,h,u=null,y=null){super(h,u,y);this.ZY=null;this.Eh=b}z5f(b){this.gXb=b}f6f(b){if(!this.ZY&&!Kh.a.KL){if(b){var h=
Object(v.a)(this,this.t2b,"disposeCallback");this.ZY=Wn(r.AFrameworkApplication.smb,!1,Object(v.a)(this,this.Xfc,"sessionExpirationHandler"),h)}else if(this.iqd){if(this.Ond)return;h=Object(v.a)(this,this.t2b,"disposeCallback");this.ZY=Wn(r.AFrameworkApplication.Iy,!1,Object(v.a)(this,this.Xfc,"sessionExpirationHandler"),h)}w.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Qb.l2c,b);this.sa.raiseEvent(Qb.l2c)}}Dce(){this.ZY&&(this.ZY.nga&&this.ZY.iqf(),this.ZY=null);
if(this.gXb){this.re.stop();if(this.lka&&this.lka.zo)return;const b=Object(v.a)(this,this.t2b,"disposeCallback");this.ZY=Wn(r.AFrameworkApplication.Iy,!0,Object(v.a)(this,this.Xfc,"sessionExpirationHandler"),b)}w.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Qb.txa);this.sa.raiseEvent(Qb.txa)}t2b(){this.ZY=null}Xfc(b){(b||this.Eh.Iwd())&&this.Eh.refreshDocument(null)}}Object(m.a)(uc,"SessionExpirationManagerWithRefresh",Qb,[703,704]);class Xc{constructor(b,h,u=null,y=null){this.h$g=!1;this._instance=
null;this._frame=b;this.Cm=h;this.re=u||new ej(lf.a.instance);this.lka=y}create(){this.h$g=r.AFrameworkApplication.o2a;if(!this.h$g)return new ti(this._frame);r.AFrameworkApplication.Xm("WOPITokenRefreshIsEnabled");w.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(r.AFrameworkApplication.JGo){case 1:w.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new Qf(this._frame);break;case 2:w.ULS.sendTraceTag(39408091,
217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new uc(this._frame,this.Cm,this.re,this.lka);break;default:w.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new ti(this._frame)}w.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(m.a)(Xc,"SessionExpirationManagerFactory",null,[702]);class xd{}Object(m.a)(xd,"Error",
null,[]);class de{}Object(m.a)(de,"NamedResult",null,[]);class Dd extends de{}Object(m.a)(Dd,"ErrorInfo",de,[]);var ee=c(1047);class vf{constructor(b,h,u,y=null,P=!1,aa=null,ta=!1,Pa=!1){this.jAa=0;this.kLa=this.vo=null;this.gsd=new ob.a;this.lza=new ob.a;this.Op=null;this.Dsc=!1;this.Xyc=this.Yyc=null;this.Gb=b;this.D0g=h;this.D0g.execute(vb=>{vb.oC(H.a.Lqf,Object(v.a)(this,this.I4m,"onHostResponseReceived"))});this.L1=u;this.R8g=new ee.a("WebServiceCall","TokenRefresh");this.re=y||new ej(b);this.g1j=
P;this.nf=aa?aa:ui.SessionStatusManager.instance;this.TIg=ta;this.rdd=Pa}I4m(b){if(b.MessageId!==H.a.Lqf)Ab.b(39408099,306,15,"Unexpected message.");else{var h=new ob.a,u=new ob.a;this.re.n7b(jg.a9d);var y=b.Values[G.a.S3i];if(!y||0>=y.length)Ab.b(40122317,306,15,"Found no tokens in the dictionary"),y=b.Values;Ab.b(40122318,306,100,"The Tokens array contains {0} tokens",y.length);this.re.G8("Correlation",b.CorrelationId);var P="";for(let Pa=0;Pa<y.length;Pa++){this.re.R1f(jg.tokens,y.length);var aa=
y[Pa],ta=aa;if(!ta||!ta.Name)continue;this.re.n7b(ta.Name);const vb=aa;if(vb&&vb.Value)Ab.b(39408128,306,100,"Received token with name: {0}",vb.Name),h.add(vb),this.gsd.add(vb),this.rdd||this.re.G8(jg.status,jg.success),this.TIg&&this.nf&&this.nf.RKn();else if(aa=this.KSl(aa),Ab.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ta.Name,JSON.stringify(aa),this.kLa),u.add(aa),this.rdd||(this.lza.add(aa),P=JSON.stringify(aa),this.re.G8(jg.error,JSON.stringify(aa)),
this.re.G8(jg.status,jg.failed)),this.TIg)for(const Kb of aa.Errors)ta=this.OBl(Kb),this.nf&&this.nf.wdk(ta)}this.rdd?(0<u.count?this.Xyc?this.Xyc(new dl(h,u)):Ab.b(512267295,306,15,"Received errors but the promise has completed"):this.Yyc?this.Yyc(new dl(h,u)):Ab.b(512267294,306,15,"Received valid tokens but the promise has completed"),Ab.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,u.count,b.CorrelationId,this.kLa)):(0<u.count&&
""!==P?(y=Object.assign(new Ya.a,{extendedProperties:new Map}),y.extendedProperties.set("Errors",P),y.extendedProperties.set("RetryCount",this.jAa.toString()),y.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),y.extendedProperties.set("IsTokenExpiring",this.Dsc.toString()),Ta.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,y)):Ta.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Ab.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,u.count,b.CorrelationId,this.kLa),0<u.count&&!this.DRc(u)?(b=this.L1.q3h(u),b!==this.L1.Zec&&(this.re.R1f(jg.YZi,b),this.Gb.e4(this.vo,b))):(this.re.flush(),this.vo&&(Ab.b(39408131,306,100,"Deleting task {0} from task manager",this.vo.name),this.Gb.Se(this.vo)),this.Op&&!this.Op.task.isCompleted?this.Op.Cg(new dl(h,u)):Ab.b(512267293,306,15,"Received results but the task has completed")))}}KSl(b){if(!b)return null;const h=Object.assign(new Dd,{Name:b.Name,Errors:[]});for(const u of b.Errors)b=
new xd,b.Id=u.Id,b.Details=A.a.mmf(u.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.JYi()}JYi(){r.AFrameworkApplication.Ce("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.jAa>=this.L1.dZd?(Ab.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.kLa),this.QSk(this.Op)):(Ta.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.d3i())}d3i(){const b={};b[G.a.S3i]=this.L1.tokens;const h=Ua.a.create().toString();Ab.b(39408133,
306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.L1.tokens),this.jAa+1,h,this.kLa);this.D0g.execute(u=>{u.sendMessage(H.a.gVe,b,h)});this.jAa++;this.re.n7b(jg.dmb)}QSk(b){const h=new ob.a;for(let u=0;u<this.L1.tokens.length;u++){const y=Object.assign(new Dd,{Name:this.L1.tokens[u],Errors:[Object.assign(new xd,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(y);this.lza.add(y)}this.Gb.Se(this.vo);
this.re.G8(jg.jbf,JSON.stringify(this.lza));this.re.G8(jg.status,jg.failed);b&&!b.task.isCompleted&&b.Cg(new dl(new ob.a,this.lza))}Fxn(b){r.AFrameworkApplication.Ce("258ec738;j5j99381");r.AFrameworkApplication.Ce("85gid169;g470d326");this.R8g.start();this.Dsc=b;this.kLa=Ua.a.create().toString();Ab.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.kLa,this.Dsc);this.jAa=0;this.lza.clear();this.gsd.clear();this.Op=new Jk.a;this.rdd?this.KYi(this.L1.dZd).then(h=>{this.Op&&
!this.Op.task.isCompleted&&this.Op.Cg(h);this.Xyc=this.Yyc=null;this.re.G8(jg.jbf,JSON.stringify(this.lza));this.re.G8(jg.status,jg.success);this.re.flush()}).catch(h=>{this.Op&&!this.Op.task.isCompleted&&this.Op.Cg(Object(na.a)(727,h));this.Xyc=this.Yyc=null;this.re.G8(jg.jbf,JSON.stringify(this.lza));this.re.G8(jg.status,jg.failed);this.re.flush()}):(this.vo=new sc.a(this.L1.priority,2,this.L1.Zec,Object(v.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,H.a.gVe,!0),this.g1j&&this.JYi(),this.Gb.Xb(this.vo));
return this.Op.task}KYi(b){const h=this,u=new Promise((Pa,vb)=>{h.Yyc=Pa;h.Xyc=vb;Ta.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.d3i()}),y=this,P=new Promise((Pa,vb)=>{window.setTimeout(()=>{vb(y.wzh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},y.L1.Zec)});let aa=b;const ta=this;return new Promise((Pa,vb)=>{aa--;Promise.race([u,P]).then(Kb=>{Ta.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Pa(Kb)}).catch(Kb=>{var Sb=
ta.L1.Zec;if(Object(jb.a)(727,Kb)&&(Kb=Object(na.a)(727,Kb),0<Kb.errors.count)){ta.dJm(Kb.errors);ta.Cch(Kb.errors);if(ta.DRc(Kb.errors)){vb(Kb);return}const Yb=ta.L1.q3h(Kb.errors);Yb!==ta.L1.Zec?(ta.re.R1f(jg.YZi,Yb),Sb=Yb):ta.Mxm(Kb.errors)&&(Sb=0)}aa?window.setTimeout(()=>{ta.KYi(aa).then(Pa).catch(vb)},Sb):(Sb=ta.wzh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ta.Cch(Sb.errors),vb(Sb),Ab.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ta.kLa))})})}Cch(b){for(let h of b)this.lza.add(h)}Mxm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}wzh(b,h){const u=new ob.a;for(let y=0;y<this.L1.tokens.length;y++){const P=this.RSk(this.L1.tokens[y],b,h);u.add(P)}return new dl(new ob.a,u)}RSk(b,h,u){return Object.assign(new Dd,{Name:b,Errors:[Object.assign(new xd,{Id:h,Details:u})]})}dJm(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new Ya.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.jAa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.Dsc.toString());Ta.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.re.G8(jg.error,b);this.re.G8(jg.status,jg.failed)}}pnn(b){this.R8g.stop();const h=this.Y5l(b.result.errors);w.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.kLa,this.Dsc,this.jAa,this.lza.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.onn(b.result.tokens)}DRc(b){return this.L1.DRc(b)}onn(b){for(let h=0;h<b.count;h++){const u=b.J(h);if(u.Name===G.a.accessToken){const y=(new Date).getTime();u.Expiry>r.AFrameworkApplication.Iy?
(w.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:u.Expiry,["NowGetTime"]:y,["BootTime"]:r.AFrameworkApplication.tW},"PreviousAccessTokenTtl",r.AFrameworkApplication.Iy),r.AFrameworkApplication.accessToken=u.Value,r.AFrameworkApplication.Iy=Math.floor(u.Expiry),r.AFrameworkApplication.gfg=y,r.AFrameworkApplication.yLa=Math.floor(u.Expiry)):w.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:u.Expiry,
["NowGetTime"]:y,["BootTime"]:r.AFrameworkApplication.tW},"PreviousAccessTokenTtl",r.AFrameworkApplication.Iy)}}return!0}Y5l(b){let h=!1;for(let u=0;u<b.count;u++){h=!0;const y=b.J(u);w.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",y.Name,JSON.stringify(y.Errors),this.kLa)}return h}OBl(b){let h=bc.a.k2c;b=parseInt(b.Id);if(isNaN(b))h=bc.a.ztj;else{switch(b){case 401:h=bc.a.hfg;break;case 403:h=bc.a.xtj;break;case 500:h=bc.a.ytj;break;case 503:h=bc.a.Btj}h===
bc.a.k2c&&(h=500<b?bc.a.Atj:bc.a.wtj)}return h}}Object(m.a)(vf,"TokenRefreshManager",null,[701]);class eg{constructor(){this.Zec=r.AFrameworkApplication.MGo;this.dZd=r.AFrameworkApplication.KGo;this.tokens=r.AFrameworkApplication.m0l();this.priority=r.AFrameworkApplication.NGo;this.Z2g=this.K0n();this.ZQe=r.AFrameworkApplication.l0l()}DRc(b){b=JSON.stringify(b);if(this.ZQe&&0<this.ZQe.length)for(const h of this.ZQe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}q3h(b){try{if(b)for(let h of b)if(h.Errors)for(const u of h.Errors)if(u.Id in
this.Z2g)return Number.parseInvariant(this.Z2g[u.Id].toString())}catch(h){w.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Zec}K0n(){const b={};try{if(!r.AFrameworkApplication.rNd()||0>=r.AFrameworkApplication.rNd().length||""===r.AFrameworkApplication.rNd()[0])return b;for(const h of r.AFrameworkApplication.rNd())0<h.length&&(b[h]=r.AFrameworkApplication.LGo)}catch(h){w.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(m.a)(eg,"TokenRefreshPolicy",null,[700]);class $b{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){r.AFrameworkApplication.K.lp(()=>{this.a1a()})}a1a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}xc(b){this.W=b;b.register(699,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Xd(()=>new ej(lf.a.instance));
b.register(700,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Xd(()=>new eg);b.register(701,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Xd(()=>new vf(lf.a.instance,r.AFrameworkApplication.fO(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),r.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Pa("Common.ISessionStatus"),r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),r.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(702,"Common.ISessionExpirationManagerFactory").singleInstance().Xd(()=>new Xc(r.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Pa("Common.ISessionStatus")));b.register(703,"Common.ISessionExpirationManagerWithDialog").singleInstance().Xd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(704,
"Common.ISessionExpirationManager").singleInstance().Xd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){K.a.instance.Kc(new $b)}}Object(m.a)($b,"SessionExpirationPackage",null,[1,2]);var Hd=c(754),$f=c(443),xi=c(357),Qe=c(214);class Wm extends Qe.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(Wm,"PersonaButtonProps",Qe.a,[]);class ph{x1b(b,h){if(b&&!(1>b.length)&&h){var u=Object.assign(new xi.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.eTk(b,u.ControlList);h.push(u)}}eTk(b,h){const u=Object.assign(new Hd.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new $f.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,u);h=Object.assign(new xi.a,{Title:"",ControlList:[]});Array.add(u.Menu.MenuSectionList,h);this.YVk(b,h.ControlList)}YVk(b,h){for(let u=0;u<b.length;u++){const y=Object.assign(new Wm,{ExternalId:String.format("CoauthorPersona_{0}",
u),Command:"336231556",DisplayName:b[u].userName,LabelText:b[u].userName,ImageBackColor:b[u].color,PersonaId:b[u].email,IsAnonymous:b[u].isAnonymous});Array.add(h,y)}}}Object(m.a)(ph,"PresenceContextMenuSectionBuilder",null,[724]);var mj=c(81);class Xn{constructor(b,h,u,y){this.Gya=this.Xs=this.vo=this.eg=this.dIa=null;this.oqd=b;this.y2j=y;this.oqd.TPc&&(this.vo=new sc.a(3,2,5E3,Object(v.a)(this,this.qpk,"authenticationCheckTask"),2),r.AFrameworkApplication.uc.Xb(this.vo),this.Wb(h,u));this.oqd.dek(()=>
{this.rIb()});this.oqd.ueh(()=>{this.sIb()})}get vP(){return this.Xs||(this.Xs=Ja.a.instance.Pa("CommonUI.IBusinessBar"))}get Knh(){return this.Gya||(this.Gya=Ja.a.instance.Pa("CommonUI.IBusinessBarEntryFactory"))}Wb(b,h){const u=r.AFrameworkApplication.ya;u.gb(Wa.a.Dkh,le.a.frame,b,96);u.gb(Wa.a.Ekh,le.a.frame,h,96);u.pa(Wa.a.Sph,le.a.frame,De.ActionManager.FZ);u.pa(Wa.a.Tph,le.a.frame,De.ActionManager.FZ);u.pa(Wa.a.PAf,le.a.frame,De.ActionManager.FZ)}rIb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
r.AFrameworkApplication.ya.processAction(Wa.a.Dkh,2)}sIb(){this.Bko();r.AFrameworkApplication.ya.processAction(Wa.a.Ekh,2)}qpk(){this.oqd.authenticationCheck()}Bko(){this.eg&&(this.eg.hide(),this.eg.dispose(),this.eg=null);this.dIa&&this.vP&&(r.AFrameworkApplication.Rk||this.vP.removeEntry(this.dIa),this.dIa.dispose(),this.dIa=null)}showDialog(b){mj.a.kB(this.eg);this.eg=new Gh.StandardDialog;this.y2j||(this.eg.Qt=!1,this.eg.Ed=0);this.eg.Ue(1,CommonUIStrings.l_SignIn);this.eg.GU(CommonUIStrings.l_DefaultDialogTitle,
b,Object(v.a)(this,this.daa,"dialogHandler"))}daa(b){1===b?(si.a.f4d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),r.AFrameworkApplication.ya.processAction(Wa.a.PAf,2)):(this.l9n(),r.AFrameworkApplication.ya.processAction(Wa.a.Tph,2))}l9n(){this.vP&&this.Knh&&(this.dIa=this.Knh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.dIa.closeable=!0,this.dIa.addButton(CommonUIStrings.l_SignIn,Xn.vyb,""),this.dIa.fla=
Object(v.a)(this,this.Zwk,"businessBarEntryCloseHandler"),this.vP.BA(this.dIa,!1))}Zwk(){this.v5k();r.AFrameworkApplication.ya.processAction(Wa.a.Sph,2)}v5k(){this.vo&&(r.AFrameworkApplication.uc.Se(this.vo),this.vo=null)}dispose(){this.vo=this.eg=this.dIa=null}static vyb(){si.a.f4d();r.AFrameworkApplication.ya.processAction(Wa.a.PAf,2)}}Object(m.a)(Xn,"SignOutResponseUI",null,[9]);class mf{get name(){return"Common.App.UI"}xc(b){b.register(ph,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){mj.a.kB(mf.Xra);
mf.Xra=null}static main(){K.a.instance.Kc(new mf)}static ocm(b,h,u){mf.Y8n()&&(mf.Xra=new Xn(si.a.instance,b,h,u))}static Y8n(){return r.AFrameworkApplication.g_d&&!r.AFrameworkApplication.Zfa}}mf.Xra=null;Object(m.a)(mf,"CommonAppUIPackage",null,[1,2]);class Ba{get name(){return"Common.App.DialogWithLinkToResource"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new Ba)}}Object(m.a)(Ba,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var ub=c(57);class ic{constructor(b){this.Jx=b;this.Bx=
Array.indexOf(this.Jx,this.nfa)}dispose(){this.Jx=null}get G2(){return this.Jx[this.Bx]}vy(b){this.r2c(b,!1);return!0}$3b(b){this.r2c(b,!0)}r2c(b,h){b&&(this.G2!==b||h)&&(b.tabIndex=0,ub.FocusManager.wJ(b));Array.contains(this.Jx,b)&&(this.Bx=Array.indexOf(this.Jx,b))}get GNi(){let b=this.Bx;do if(b)if(0<b&&b<this.Jx.length)b--;else break;else b=this.Jx.length-1;while(!ng.DOMFocusListing.TZa(this.Jx[b])&&b!==this.Bx);return this.Jx[b]}get rAi(){let b=this.Bx;do if(b===this.Jx.length-1)b=0;else if(0<=
b&&b<this.Jx.length-1)b++;else break;while(!ng.DOMFocusListing.TZa(this.Jx[b])&&b!==this.Bx);return this.Jx[b]}get nfa(){let b=0;for(;!ng.DOMFocusListing.TZa(this.Jx[b])&&b<this.Jx.length;)b++;return ng.DOMFocusListing.TZa(this.Jx[b])?this.Jx[b]:null}get x$b(){let b=this.Jx.length-1;for(;!ng.DOMFocusListing.TZa(this.Jx[b])&&0<b;)b--;return ng.DOMFocusListing.TZa(this.Jx[b])?this.Jx[b]:null}}Object(m.a)(ic,"DialogFocusListing",null,[92]);var Hc=c(49);class Vb extends Gh.StandardDialog{constructor(b,
h,u,y=null){super();this.Hda=this.xw=this.u9a=null;this.Jx=[];this.rmd=h;this.Qj=b;this.EOj=u;this.Cpd=y;this.Wl=new ee.a("LoadResource","LoadPrintablePdf")}xCa(){this.Ed=5;this.width=40;const b=document.createElement("span");b.id=this.mj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Hda=document.createElement("iframe");this.Hda.name="pdfObjectFrame";this.Hda.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Hda.onload=Object(v.a)(this,this.hln,"printablePdfLoaded");if(this.Cpd&&0<this.Cpd.count){var u=Fa.a.rlf(this.rmd,this.Cpd);const y=Fa.a.qXf(this.rmd,this.Cpd);this.xw=document.createElement("form");this.xw.id="printPreviewPostForm";this.xw.method="POST";this.xw.target=this.Hda.name;this.xw.action=y;for(let P of u)u=document.createElement("input"),u.type="hidden",u.name=P.key,u.value=P.value,this.xw.appendChild(u)}else this.Hda.setAttribute("src",this.rmd);
Sys.UI.DomElement.addCssClass(this.Hda,Kh.a.hYg);this.EOj?(Sys.UI.DomElement.addCssClass(this.Hda,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,hf.a.Tq(this.Hda,hf.a.Mz,hf.a.ep)):(Sys.UI.DomElement.addCssClass(this.Hda,"DirectPrintPdfObject"),this.Jx.push(this.Hda));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Hda);this.xw&&b.appendChild(this.xw);b.appendChild(document.createElement("br"));b.appendChild(this.BMk(this.xw?
"#":this.rmd));this.Wl.start();this.Sjb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.k4(this.mj("DirectPrintHeaderContent"));this.xw&&this.xw.submit();this.gTk();w.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}BMk(b){const h=document.createElement("span");var u=document.createElement("span");u.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(u);r.AFrameworkApplication.K&&(2===r.AFrameworkApplication.ta.Pb.$n&&r.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===r.AFrameworkApplication.ta.Pb.$n&&r.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===r.AFrameworkApplication.ta.Pb.$n?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===r.AFrameworkApplication.ta.Pb.$n&&(b.innerText=CommonUIStrings.l_InternalError_Directive,w.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.u9a=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(u=
document.createElement("a"),u.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,u.href=b,u.target="_blank",u.id="PrintPDFLink",u.className="AllowBrowserClick",this.u9a=u,h.appendChild(document.createElement("br")),h.appendChild(u),this.xw&&rf.a.addHandler(u,"click",Object(v.a)(this,this.H9m,"onSubmit")),this.Qj.mb(bb.a.click,this.u9a,Object(v.a)(this,this.MHh,"downloadPDFLinkClicked"),null));this.Jx.push(this.u9a);return h}H9m(b){this.xw&&(this.xw.target="_blank",this.xw.submit());b.preventDefault()}gTk(){if(0<
this.Jx.length){const b=new ic(this.Jx),h=ub.FocusManager.instance().Ks();h&&(this.u9a.focus(),h.Xj=b,h.HX=!0)}}MHh(){w.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}iUc(){w.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}hln(){w.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Wl&&this.Wl.stop()}dispose(){this.u9a&&(this.Qj.sc(bb.a.click,this.u9a,Object(v.a)(this,this.MHh,"downloadPDFLinkClicked")),
this.u9a=null);Hc.a.hw(this.Hda);this.Hda=null;super.dispose()}}Object(m.a)(Vb,"DirectPrintDialog",Gh.StandardDialog,[786]);class Ud{constructor(b){this.Qj=b}CAl(b,h,u=null){return new Vb(this.Qj,b,h,u)}}Object(m.a)(Ud,"DirectPrintDialogFactory",null,[773]);class Cc{constructor(b,h){this._url=b;this.wXj=h}AGh(){this.wXj?Je.a.downloadFile(this._url):Je.a.en(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(m.a)(Cc,"OpenUrlInTabDialogDownloadBehavior",null,
[791,9]);class Te extends Gh.StandardDialog{constructor(b,h=!0,u=!1,y=null,P=null,aa=!1){super();this.aTb=this.$Sb=this.xw=this.D1=null;var ta=this.I$f?this.I$f:CommonUIStrings.l_DefaultDialogTitle;Te.K6b=aa;this.Cse=y||new Cc(b,!0);const Pa=[],vb=[];Te.WK&&(this.ovd&&this.ovd.forEach(Yb=>{Array.add(Pa,Yb)}),this.Xfh&&this.Xfh.forEach(Yb=>{Array.add(vb,Yb)}));h?u?(this.Ed=4,this.Ue(1,this.buttonText),this.Ue(2,CommonUIStrings.l_DialogClose)):(this.Ed=6,this.Ue(0,CommonUIStrings.l_DialogClose)):this.Ed=
5;aa=document.createElement("span");this.EFc&&(aa.className=this.EFc);y=document.createElement("a");y.innerText=this.P$b;y.href=b;y.target="_blank";y.id=this.STc;y.className=xe.AFrame.IUe;var Kb=!ba.a.n3&&!!P&&0<P.count;if(Kb){const Yb=Fa.a.rlf(b,P);P=Fa.a.qXf(b,P);y.href="#";y.target="_self";this.xw=document.createElement("form");this.xw.id="printPreviewPostForm1";this.xw.method="post";this.xw.target="_blank";this.xw.action=P;for(var Sb of Yb)P=document.createElement("input"),P.type="hidden",P.name=
Sb.key,P.value=Sb.value,this.xw.appendChild(P)}else this.xw=null;this.xw||Te.K6b?Te.K6b||Array.add(vb,{["type"]:"AppLinkProps",["id"]:this.STc,["text"]:this.P$b,["onExecute"]:()=>{this.oRi()}}):Array.add(vb,{["type"]:"AppLinkProps",["id"]:this.STc,["text"]:this.P$b,["handler"]:{["href"]:Kb?"#":b,["target"]:Kb?"_self":"_blank"}});this.d3a&&Array.add(Pa,this.d3a);u?(b=document.createElement("span"),b.innerText=this.d3a.replace("{0}",""),aa.appendChild(b)):this.Yxi?(b=document.createElement("span"),
b.id=this.mj("message"),Sb=document.createElement("span"),P=document.createElement("span"),Kb=this.d3a.split("{0}"),Sb.innerText=Kb[0],P.innerText=Kb[1],b.appendChild(Sb),b.appendChild(y),b.appendChild(P),aa.appendChild(b)):(b=document.createElement("span"),b.innerText=this.d3a,aa.appendChild(b),aa.appendChild(document.createElement("br")),aa.appendChild(document.createElement("br")),aa.appendChild(y),Te.K6b||Array.add(Pa,"{0}"));this.xw&&aa.appendChild(this.xw);Te.WK&&(this.sjb&&(this.zTc?this.Fch(this.sjb,
this.zTc):(Array.add(Pa,"{0}"),Array.add(vb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.sjb,["onExecute"]:()=>{}}))),this.mAc(Pa,vb));this.Sjb(ta,null,this.Wqf,null,Object(v.a)(this,this.daa,"dialogHandler"),Te.WK?null:aa);this.k4(this.mj("message"));!Te.WK&&this.zTc&&this.sjb&&(ta=document.createElement("div"),ta.className="WACDialogLearnMoreLinkContainer",this.D1=document.createElement("a"),this.D1.innerText=this.sjb,this.D1.href=this.zTc,this.D1.target="_blank",this.D1.id=this.mj("LearnMoreLinkId"),
this.D1.className=xe.AFrame.IUe,ta.appendChild(this.D1),h?this.Lc.insertBefore(ta,this.Lc.lastChild):this.Lc.appendChild(ta),this.k4(String.format("{0} {1}",this.mj("message"),this.mj("LearnMoreLinkId"))));this.apc=y;u?this.EU(this.AG):this.EU(this.apc);this.nCf();r.AFrameworkApplication.ta.k0.mb(bb.a.click,this.apc,Object(v.a)(this,this.LHh,"downloadLinkClicked"),null);this.D1&&r.AFrameworkApplication.ta.k0.mb(bb.a.click,this.D1,Object(v.a)(this,this.Ari,"learnMoreLinkClicked"),null);this.pV=!1}get Wqf(){return null}get I$f(){return null}get d3a(){return null}get zTc(){return null}get sjb(){return null}get Yxi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get EFc(){return null}get ovd(){return null}get Xfh(){return null}Qka(){this.xw&&
(this.$Sb||(this.$Sb=Object(v.a)(this,this.W_m,"onActionButtonClicked"),this.xq.mb(bb.a.click,this.AG,this.$Sb)),this.aTb||(this.aTb=Object(v.a)(this,this.X_m,"onActionButtonKeyUp"),this.ie.mb(bb.a.sh,this.AG,this.aTb)));super.Qka()}W_m(b){this.lLh(b);return!0}X_m(b){return this.XSc(b,Object(v.a)(this,this.lLh,"executeDismissActionButtonFromArgs"))}lLh(b){this.xw&&this.xw.submit();this.cBb(b.Bf)}iUc(){}LHh(){this.oCf();this.xw?this.xw.submit():this.Cse.AGh();return!0}Ari(){return!1}dispose(){this.Cse.dispose();
this.apc&&(r.AFrameworkApplication.ta.k0.sc(bb.a.click,this.apc,Object(v.a)(this,this.LHh,"downloadLinkClicked")),this.apc=null);this.D1&&(r.AFrameworkApplication.ta.k0.sc(bb.a.click,this.D1,Object(v.a)(this,this.Ari,"learnMoreLinkClicked")),this.D1=null);this.xq&&this.$Sb&&(this.xq.sc(bb.a.click,this.AG,this.$Sb),this.$Sb=null);this.ie&&this.aTb&&(this.ie.sc(bb.a.sh,this.AG,this.aTb),this.aTb=null);super.dispose()}oRi(){this.xw&&(document.body.appendChild(this.xw),this.xw.submit(),document.body.removeChild(this.xw))}daa(b){1===
b&&(this.iUc(),this.xw?Te.WK&&this.oRi():this.Cse.AGh());this.dispose()}static get WK(){return r.AFrameworkApplication.ta.Pb.ZA&&r.AFrameworkApplication.ta.Pb.Mmi}static get K6b(){return Te.oNg}static set K6b(b){Te.oNg=b}}Te.oNg=!1;Object(m.a)(Te,"ADialogWithLinkToResource",Gh.StandardDialog,[]);class Ne extends Te{constructor(b,h,u=null,y=!0,P=!1){super(b,!0,!(Ne.Qob&&y),new Cc(b,h),u,P);Ne.Qob=Ne.Qob&&y;if(Ne.Qob){h=document.createElement("iframe");y=null;P=this.jFh;h.name="pdfObjectFrame";h.id=
"pdfObjectIFrame";if(u&&0<u.count){const aa=Fa.a.rlf(b,u);b=Fa.a.qXf(b,u);y=document.createElement("form");y.id="printPreviewPostForm";y.method="POST";y.target=h.name;y.action=b;for(let ta of aa)b=document.createElement("input"),b.type="hidden",b.name=ta.key,b.value=ta.value,y.appendChild(b)}else h.src=b;P.appendChild(h);y&&(P.appendChild(y),y.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");hf.a.Tq(h,hf.a.Mz,hf.a.ep)}}get Wqf(){return"Print_32x32x32"}get I$f(){return Ne.Qob?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get d3a(){return Ne.Qob?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get ovd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Te.K6b){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==r.AFrameworkApplication.ta.Pb.vCh&&(h=r.AFrameworkApplication.ta.Pb.vCh);Array.add(b,h)}return Ne.Qob?b:null}get P$b(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get STc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get EFc(){return r.AFrameworkApplication.DZa?
"UIFontDialogTextLarge":null}nCf(){w.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}oCf(){r.AFrameworkApplication.Mm.X0a(9540);w.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}iUc(){w.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get Qob(){return!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA&&r.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(ba.a.n3||ba.a.kt||ba.a.kj||ba.a.aba)&&!r.AFrameworkApplication.DSc&&
r.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set Qob(b){}}Object(m.a)(Ne,"PrintDialogWithLinkToPdf",Te,[]);class Sf{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.bum=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.Qqm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.pNb=(b.DirectPrintSupportedMimeTypes||"").split(Sf.G8e);this.Hnb=(b.DirectPrintSupportedPlugins||"").split(Sf.G8e);this.uam=(b.DirectPrintImmersivePreviewPlugins||
"").split(Sf.G8e);this.Eii=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.mlm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.LEk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.cFf=14;this.lyi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.cFf=parseInt(h[0]),this.lyi=parseInt(h[1])):w.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else w.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Sf.G8e=",";Object(m.a)(Sf,"DirectPrintBrsSettings",null,[]);class Ie{constructor(b,h){this.x8f=b;this.Hnb=h}}Object(m.a)(Ie,"DirectPrintProbeResults",null,[]);class pg{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.ctd=null;this.IJj=b;this.wuc=h;this.hEe=u;this.dRj=y;this.jSj=P;this.kwc=new Zf.a(Object(v.a)(this,this.aQl,"getProbeResults"));this.Coc=aa;this.DUg=vb;this.VV=ta;this.Bsc=Pa;this.DSj=Kb}get OP(){return this.IJj}start(){}Dln(){this.OP.bum&&
this.uMm()}rqn(){const b=Array(this.OP.pNb.length);if(void 0!==this.wuc&&null!==this.wuc)for(let h=0;h<this.OP.pNb.length;h++)b[h]=this.OP.pNb[h]in this.wuc&&this.dRj(this.wuc[this.OP.pNb[h]]);return b}sqn(){const b=Array(this.OP.Hnb.length),h=!(void 0===this.hEe||null===this.hEe);for(let u=0;u<this.OP.Hnb.length;u++){const y=this.OP.Hnb[u];b[u]=h&&y in this.hEe?!0:this.jSj(y)}return b}xVl(){const b=this.rqn(),h=Array(b.length);for(let u=0;u<b.length;u++)h[u]=b[u]?this.zfl(this.wuc[this.OP.pNb[u]]):
null;return h}zfl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}uMm(){w.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.kwc.value.x8f,this.kwc.value.Hnb)}aQl(){var b=this.xVl();const h=this.sqn(),u={},y={};for(let P=0;P<this.OP.pNb.length;P++)u[this.OP.pNb[P]]=b[P];for(b=0;b<this.OP.Hnb.length;b++)y[this.OP.Hnb[b]]=h[b];return new Ie(u,y)}Q8n(){return this.DSj||!this.OP.isEnabled||r.AFrameworkApplication.DSc?!1:this.Bho()}W8n(){if(null!=
this.ctd)return this.ctd;const b=pg.Dii(this.OP);return this.ctd=this.OP.Eii&&b||this.llm()}llm(){return ba.a.Wp&&this.OP.mlm&&ba.a.KEk>=this.OP.LEk?!0:!1}Bho(){if(!this.Bsc(this.OP))return!1;var b=Ma.a.jNd(this.kwc.value.x8f);for(const h of b)if(void 0!==h&&null!==h)return!0;b=Ma.a.jNd(this.kwc.value.Hnb);for(const h of b)if(h)return!0;return!1}i6l(){const b=Ma.a.jNd(this.kwc.value.x8f);for(const h of b)if(Jj.a.contains(this.OP.uam,h))return!0;return!1}iao(b,h=null){r.AFrameworkApplication.ta&&r.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.DUg(b,h):this.Q8n()?this.y6k(b,this.i6l()&&!0,h):this.DUg(b,h)}y6k(b,h,u=null){const y=this.VV.jg("UserAction","OpenDirectPrintDialog");this.Coc.CAl(b,h,u).xCa();y.stop()}static Nwm(b){try{return new ActiveXObject(b),!0}catch(h){w.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static Znm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new Sf(r.AFrameworkApplication.K.appSettings);let u=
null;try{u=window.navigator.mimeTypes}catch(Kb){w.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let y=null;try{y=window.navigator.plugins}catch(Kb){w.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const P=pg.Znm,aa=pg.Nwm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ta=r.AFrameworkApplication.ta.tq,Pa=pg.Pwm,vb=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA&&!r.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");
return new pg(h,u,y,P,aa,b,ta,Pa,(Kb,Sb)=>new Ne(Kb,!1,Sb,!0,vb),r.AFrameworkApplication.Zfa)}static Pwm(b){return ba.a.Wp||ba.a.kt&&b.Qqm||b.Eii&&pg.Dii(b)?!0:!1}static Dii(b){var h=ba.a.K2b;if(h){var u=h.split(".");if(2===u.length)return h=parseInt(u[0]),u=parseInt(u[1]),h>b.cFf||h===b.cFf&&u>=b.lyi}return!1}}Object(m.a)(pg,"DirectPrintManager",null,[723]);class ak{constructor(){this.drb=this.W=null}get name(){return"Common.App.DirectPrint"}xc(b){this.W=b;b.register(Ud,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Xd(()=>
new Ud(r.AFrameworkApplication.ta.k0));b.register(723,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Xd(()=>pg.create(this.W))}init(){this.drb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.drb.start()}dispose(){}}Object(m.a)(ak,"PackageManager",null,[1,2]);class nn{constructor(b,h=3E4){this.X$f=9E5;this.Z$f=1E4;this.uvi=this.pac=null;this.qDf=0;this.ieb=Date.now;this.$Md=b;this.MSa=h;this.zId()}w6h(b=!0){const h=this.ieb();if(h<this.qDf+this.X$f)return h>this.qDf+
this.Z$f&&this.zId(),this.uvi;b&&this.zId();return null}getToken(b=!0){return(b=this.w6h(b))?Promise.resolve(b):this.zId()}zId(){return this.pac=this.pac||new Promise(b=>{this.$Md().then(h=>{this.pac=null;""!==h&&h&&(this.uvi=h,this.qDf=this.ieb(),b(h));b(null)}).catch(()=>{this.pac=null;b(null)});window.setTimeout(()=>{this.pac=null;b(null)},this.MSa)})}}Object(m.a)(nn,"OAuthCacheManager",null,[]);class Sl{static wua(b){return""!==b&&b?Sl.kkk[b.toLowerCase()]:""}static vXl(b,h){const u=Date.now();
var y=Sl.QMk();const P=r.AFrameworkApplication.K.lb("UserPrincipalName"),aa=Sl.wua(b);w.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+b);if(""===P||!P)return w.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===aa||!aa)return w.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+b),Promise.resolve("");const ta=Ua.a.create().toString();y=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",aa,encodeURIComponent(h),encodeURIComponent(P),encodeURIComponent(y),ta);const Pa=document.createElement("iframe");Pa.style.display="none";Pa.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Pa.src=y;document.body.appendChild(Pa);return new Promise(vb=>{Sl.BVm(Pa.contentWindow).then(Kb=>{document.body.removeChild(Pa);const Sb=new Tb.a,Yb=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ac;for(;Ac=Yb.exec(Kb);)3!==Ac.length&&(w.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Ac.length),vb("")),Sb.Z(Ac[1],Ac[2]);Sb.ub("access_token")?(w.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",h,b,Date.now()-u),vb(Sb.J("access_token"))):(w.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",h,b,(Date.now()-u).toString()),vb(""))}).catch(Kb=>{try{document.body.removeChild(Pa)}catch(Sb){}w.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",h,b,JSON.stringify(Kb),(Date.now()-u).toString());vb("")})})}static QMk(){const b=window.location.protocol,h=window.location.host;var u=r.AFrameworkApplication.K.lb("OAuthManagerHostPathOverride");if(void 0===u||null===u){u=window.location.pathname;const y=u.lastIndexOf("/");u=0<=y?u.substring(0,y+1):""}return b+"//"+h+u+"WacOAuth.html"}static BVm(b){return new Promise((h,u)=>{let y=0,P=0;P=window.setInterval(()=>
{if(200<y++)window.clearInterval(P),u("Exceeded 10000ms timeout after 200 polls");else{var aa=null,ta=null;try{if(!b||b.closed){window.clearInterval(P);u("Window or Frame is closed before completion");return}aa=b.location.href;ta=b.location.hash}catch(Pa){}aa&&"about:blank"!==aa&&ta&&""!==ta&&(window.clearInterval(P),h(ta))}},50)})}}Sl.kkk={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(m.a)(Sl,"OAuthHelper",null,[]);class ql{constructor(b,
h){this.token=b;this.source=h}}Object(m.a)(ql,"TokenResult",null,[]);var Pj=c(101),tm=c(249);class mi{constructor(){this.W7=null;this.aJg={};this.tokenCache=new za.a(la.a.Ri())}getToken(b,h,u=!1){if(this.tokenCache.ub(h))return this.tokenCache.J(h).getToken();const y=new nn(()=>u?this.x6h(b,h):this.$Md(b,h));this.tokenCache.Z(h,y);return y.getToken()}sXl(b,h,u=!1){if(this.tokenCache.ub(h))return this.tokenCache.J(h).w6h();const y=new nn(()=>u?this.x6h(b,h):this.$Md(b,h));this.tokenCache.Z(h,y);return null}$Md(b,
h){const u=Date.now();return Sl.vXl(b,h).then(y=>new ql(y,"SSOStack")).then(y=>new Promise(P=>{y.token&&""!==y.token?(w.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",b,y.source,Date.now()-u),this.Bmb("GetTokenInternal",!0,Date.now()-u,b,"","",h),P(y.token)):(w.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",b,Date.now()-u),this.Bmb("GetTokenInternal",!1,Date.now()-u,b,"GetTokenSilent Failed","SSO Token provider failed!",h),P(""))}))}x6h(b,
h){if(!this.W7)try{this.W7=Ja.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(u){w.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+u)}return this.W7?new Promise(u=>{const y=Date.now();this.W7.uia(b,h).then(P=>{const aa=P.Token;!P.IsSuccess||this.Qxm(aa)?(this.Bmb("GetTokenInternalImplicitJS",!1,Date.now()-y,b,P.ErrorCode,P.ErrorMessage,h),u(null)):(this.Bmb("GetTokenInternalImplicitJS",!0,Date.now()-y,b,P.ErrorCode,P.ErrorMessage,h),u(aa))}).catch(P=>{P=P?z.c(P):"";
this.Bmb("GetTokenInternalImplicitJS",!1,Date.now()-y,b,"Caught Exception",P,h);u(null)})}):new Promise(u=>{this.Bmb("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");u(null)})}Bmb(b,h,u,y,P="",aa="",ta=""){var Pa="Search"===y;const vb=[];b=Pj.a.vfa(Pa?"Event":"EventName",b,2);y=Pj.a.vfa("AppName",y,2);Array.add(vb,b);Array.add(vb,y);Pa&&(y=Pj.a.vfa("LatencyType","FetchToken",2),Array.add(vb,y));P&&""!==P&&(P=Pj.a.vfa("ErrorCode",P,2),Array.add(vb,P));aa&&""!==aa&&(aa=
Pj.a.vfa("ErrorMessage",aa,2),Array.add(vb,aa));ta&&""!==ta&&(aa=!(ta in this.aJg),this.aJg[ta]=aa,aa=Pj.a.vfa("WarmUpCall",aa.toString(),1),Array.add(vb,aa),ta=Pj.a.vfa("Service",this.ITl(ta),2),Array.add(vb,ta));Pa=Pa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new tm.a,{name:Pa,samplingPolicy:2,dataFields:vb,succeeded:h,durationMs:u});ha.a.sendActivityEvent(h)}ITl(b){return b===r.AFrameworkApplication.cDf?"Loki":b===r.AFrameworkApplication.q8f?
"Substrate":r.AFrameworkApplication.K&&b===r.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}Qxm(b){return!b||!b.length}}Object(m.a)(mi,"SearchOAuthManager",null,[697]);class Wl{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}xc(b){this.W=b;this.W.register(697,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Xd(()=>new mi)}init(){}dispose(){}static main(){K.a.instance.Kc(new Wl)}}Object(m.a)(Wl,"SearchOAuthPackage",null,
[1,2]);var Ah=c(228),yd=c(5),Jd=c(20),Se=c(19),be=c(10);class el{constructor(b,h,u){this.ZEe=this.svb=this.WEe=this.rvb=this.IBe=null;this.F2l=y=>{try{this.E2l(y)}catch(P){y=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",P.message,P.stack),w.ULS.sendTraceTag(5285580,334,10,y)}};this.Lp=b;this.xKj=h;this.ib=u;this.init()}init(){this.xKj.mb(this.F2l);this.rvb=new Fh.a;this.WEe=new Fh.a;this.svb=new Fh.a;this.ZEe=new Ah.a}a4(b){this.rvb.add(b.key,
b)}jec(b){this.svb.add(b.key,b)}E2l(b){let h;({h6e:h}=el.Zqo(this.ib.hb.kb)).returnValue&&(b=el.fyl(b,this.IBe,h),this.Wln(b,h),this.IBe=h)}Wln(b,h){b=this.Nrl(b,h);let u;({notification:u}=el.Qqo(b)).returnValue&&this.Lp.sendNotification(u,!1)}Nrl(b,h){const u=new Fh.a;u.Z(1,new Ah.a);u.Z(0,new Ah.a);b.forEach(y=>{3===y?(el.Q4f(h.node)||this.RJn(h),this.TNl(u,h)):y||this.Eyl(u,h);return!0});return u}RJn(b){this.rvb.forEach((h,u)=>{u.reset(b);return!0})}Eyl(b,h){let u=new Fh.a;el.Q4f(h.node)||(u=this.Cyl(h.cpBegin));
this.Dyl(b,this.WEe,u,el.P2i(this.IBe,h));this.WEe=u}Cyl(b){const h=new Fh.a;this.rvb.forEach((u,y)=>{u=null;({jF:u}=y.jHa(b)).returnValue&&h.Z(y.key,u);return!0});return h}Dyl(b,h,u,y){const P=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((aa,ta)=>{const Pa=this.rvb.J(aa).Cw||ta.title;let vb;({value:vb}=u.Gc(aa)).returnValue?y&&vb.contentObject!==ta.contentObject&&(Pa&&b.J(1).add(Pa),aa=this.rvb.J(aa).Cw,aa=String.format(P,vb.title,aa),vb.description&&(aa+=", "+vb.description),
b.J(0).add(aa)):Pa&&b.J(1).add(Pa);return!0});u.forEach((aa,ta)=>{h.ub(aa)||(aa=this.rvb.J(aa).Cw,aa=String.format(P,ta.title,aa),ta.description&&(aa+=", "+ta.description),b.J(0).add(aa));return!0})}TNl(b,h){h=this.RUl(h.node);h=this.oIk(h);this.SUl(b,this.ZEe,h);this.ZEe=h}RUl(b){const h=new yd.GraphIterator;h.set(b);if(!h.Ab(1))return null;const u=new Ah.a;for(;1!==h.ef;)this.svb.forEach((y,P)=>{let aa;({ola:aa}=P.sjc(h)).returnValue&&u.add(aa);return!0}),h.qc();u.reverse();return u}oIk(b){b=b.toArray();
let h=0;for(;h<b.length-1;){var u=b[h];if(u.kG===b[h+1].kG&&(this.svb.J(u.kG),({rIk:u}={returnValue:!1,rIk:null}).returnValue)){b.splice(h,2,u);continue}h++}return new Ah.a(b)}SUl(b,h,u){var y;for(y=0;y<Math.min(u.length,h.length)&&u.J(y).contentId.equals(h.J(y).contentId);y++){var P=this.svb.J(u.J(y).kG).hCb(u.J(y),h.J(y));P&&(u.J(y).description&&(P+=", "+u.J(y).description),b.J(0).add(P))}for(P=y;P<u.length;P++){let aa=this.svb.J(u.J(P).kG).hCb(u.J(P),null);aa&&(u.J(P).description&&(aa+=", "+u.J(P).description),
b.J(0).add(aa))}for(u=y;u<h.length;u++)(y=this.svb.J(h.J(u).kG).Cw)&&b.J(1).add(y)}static fyl(b,h,u){const y=new Ah.a;(b=b||el.qSn(h,u))?(y.add(3),y.add(0)):el.P2i(h,u)&&y.add(0);return y}static qSn(b,h){return!b||!b.node.id.equals(h.node.id)}static P2i(b,h){return!b||!b.equals(h)}static Zqo(b){let h=null;if(!b||!(Se.SelectionEditor.om(b)||(b=Se.SelectionEditor.Vj(b,!0,!1),Se.SelectionEditor.om(b)||b.Qa&&el.Q4f(b.Qa.node))))return{returnValue:!1,h6e:h};h=b.Qa;return{returnValue:!!h,h6e:h}}static Qqo(b){const h=
new Ah.a;b.J(1).forEach(u=>{u=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,u);h.add(u);return!0});b.J(0).forEach(u=>{u=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,u);h.add(u);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static Q4f(b){return Jd.ImageReader.Wu(b)||be.ParagraphReader.rta(b)}}Object(m.a)(el,"AccessibilityContextManager",null,[696]);class fj{constructor(b,h){this.RRg=!1;this.txc=null;this.zpd=
this.Vsd=!1;this.xIg=null;this.tvd=(u,y)=>{(y.iR||y.dpa)&&this.nZm(y.iR,y.dpa)};this.Gb=b;this.RM=h}get V6l(){return!!this.txc}mb(b){this.RRg||(this.RM.Meh(this.tvd),this.RRg=!0);this.xIg=b}nZm(b,h){this.V6l&&this.Gb.Se(this.txc);this.Vsd=this.Vsd||b;this.zpd=this.zpd||h;this.txc=new sc.a(5,1,fj.zdl,()=>{this.xIg(this.Vsd,this.zpd);this.reset()},126);this.Gb.Xb(this.txc)}reset(){this.txc=null;this.zpd=this.Vsd=!1}}fj.zdl=100;Object(m.a)(fj,"EditingViewOnAfterValidateEventsConsolidator",null,[695]);
var Hh=c(54);class Fm{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Ra.App.Ljh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}xc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new fj(r.AFrameworkApplication.uc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",()=>
new el(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Hh.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){K.a.instance.Kc(new Fm)}}Object(m.a)(Fm,"Box4AccessibilityPackage",null,[1,2]);var ri=c(133),Mh=c(1027),Fi=c(1591),rp=c(885),kh=c(171),cr=c(1489),dg=c(48),Kf=c(24),yi=c(135),nf=c(36);class Bb extends cr.a{get nva(){return null!=this.qsg?this.qsg:this.qsg=Ja.a.instance.Pa("Box4.IInternalLinkManager")}get JMi(){return null!=
this.qvg?this.qvg:this.qvg=Ja.a.instance.Pa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get aC(){return!0}get commandId(){return Oa.a.Apk}Jla(b){kh.a.mark(7012);const h=new dg.GraphTransaction(15);h.Eb(b);var u=this.eG,y=this.r_,P=be.ParagraphReader.text(b),aa=P.substring(u,y);const ta=({GVc:Pa}=A.a.$7f(aa)).returnValue;aa!==ta&&(u+=Pa,y=u+ta.length);aa=nf.a.createTextRange(b,u,y);var Pa=P.substring(u,y);Bb.Kqm(P,u,y)&&(this.Rd.replaceTextRange(nf.a.createTextRange(b,u-1,y+1),Pa,!0,!1),
--u,--y,aa=nf.a.createTextRange(b,u,y),u=Kf.SelectionFactory.we(b,y),Hh.a.instance.setSelection(u));u=yi.HyperlinkReader.ZNa(Pa);Bb.hyperlinkEditor.eH(aa,u,!1);P=Pa="";y=!1;this.nva&&({HWf:Pa,DQh:P}=this.nva.Qag(u)).returnValue&&(u=Pa,y=!0,Pa=yi.HyperlinkReader.iD(aa,!1),Bb.hyperlinkEditor.VQ(Pa[0].paragraph,Pa[0].hyperlink),""!==P&&(this.Rd.replaceTextRange(aa,P,!0,!1),aa=nf.a.createTextRange(b,this.eG,this.eG+P.length),b=Kf.SelectionFactory.we(b,this.eG+this.eG+P.length),Hh.a.instance.setSelection(b)),
Bb.hyperlinkEditor.eH(aa,u,!1));h.dispose();!y&&this.JMi&&this.JMi.Sin(aa,u);kh.a.mark(7013)}set aC(b){super.aC=b}static get hyperlinkEditor(){return null!=Bb.pqg?Bb.pqg:Bb.pqg=Ja.a.instance.resolve("Box4.IHyperlinkEditor")}static Kqm(b,h,u){u=u!==b.length&&('"'===b.charAt(u)||"\u201d"===b.charAt(u));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&u}}Object(m.a)(Bb,"HyperlinkAction",cr.a,[]);class Ec{constructor(b){this.Rd=b}KTk(b,h,u){return new Bb(null,b,h,u,this.Rd)}}Object(m.a)(Ec,
"HyperlinkActionFactory",null,[692]);var sd=c(248);class Ce{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}xc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new Fi.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),sd.a.instance,r.AFrameworkApplication.ya,r.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",
()=>new Mh.a(b.resolve("Box4.IRoamingServiceRequestManager"),r.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new rp.a(b.resolve("Box4.IAutoCorrectRules"),Hh.a.instance,ri.a.instance,r.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();
b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Ec(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").BEm();const b=r.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").ttl()}dispose(){}static main(){K.a.instance.Kc(new Ce)}}Object(m.a)(Ce,"Box4AutoCorrectPackage",null,[1,2]);class Ue{get name(){return"Box4.Clipboard"}init(){}dispose(){}xc(){}static main(){K.a.instance.Kc(new Ue)}}
Object(m.a)(Ue,"Box4ClipboardPackage",null,[1,2]);class Mf{get name(){return"Box4.ImageEditors"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new Mf)}}Object(m.a)(Mf,"Box4ImageEditorsPackage",null,[1,2]);class Tg{C$i(){return{B$i:!0,rtj:!1}}}Object(m.a)(Tg,"CursorMovementValidator",null,[570]);class Nh{kOi(b,h,u,y,P,aa){return b?r.AFrameworkApplication.ya.Tf(b,h,u,!0,P,aa):8}}Object(m.a)(Nh,"ListContextManager",null,[569]);class Vk{get name(){return"Box4.ListEditors"}xc(b){b.ha("Box4.ListEditors.CursorMovementValidator",
()=>new Tg).as("Box4.List.ICursorMovementValidator").singleInstance();b.ha("Box4.ListEditors.ListContextManager",()=>new Nh).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){K.a.instance.Kc(new Vk)}}Object(m.a)(Vk,"Box4ListEditorsPackage",null,[1,2]);class qd{get name(){return"Box4.NotebookLevelEditors"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new qd)}}Object(m.a)(qd,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Wg=c(1501),$g=c(131),Hg=c(775),oc=c(14);
const Tl=(b,h,u,y,P)=>{if(h.contextId===oc.a.view)switch(b){case Oa.a.search:return Ra.App.xa.jb.bwa.qqo(),Ra.App.CM.D6i(),32;case Oa.a.findOnPage:return 1!==u&&(Ra.App.xa.jb.bwa.qqo(),Ra.App.CM.N2f()),32;case Oa.a.dZi:return Ra.App.xa.jb.wc&&Ra.App.xa.jb.wc.mi?(1!==u&&(Hg.a.GLb?Ra.App.CM.uKn():Ra.App.CM.N2f()),b=32):b=8,b;case Oa.a.Iyb:case Oa.a.Lph:return 1===u?b=Hg.a.GLb?32:8:(Ra.App.CM.uKn(),b=32),b;case Oa.a.c5d:return 1!==u&&Ra.App.CM.wNd(),32;case Oa.a.INi:return(b=Je.a.tNa(document.body.ownerDocument))&&
b.id===$g.AppFrame.W1i&&Ra.App.CM.wNd(),32;case Oa.a.s_d:return 1!==u&&Ra.App.CM.vNd(),32;case Oa.a.tAi:return(b=Je.a.tNa(document.body.ownerDocument))&&b.id===$g.AppFrame.W1i&&Ra.App.CM.vNd(),32;case Oa.a.B5i:return Ra.App.CM.$Zo(),32;case Oa.a.c1c:return Ra.App.CM.c1c(),32;case Oa.a.Mqf:return 1!==u&&"string"===typeof P&&Ra.App.CM.Mqf(P),32;case Oa.a.F1i:return 1!==u&&Ra.App.CM.N2f(),32;case Oa.a.G1i:return 1!==u&&Ra.App.CM.D6i(),32;case Oa.a.Fbh:return Ra.App.CM.FUo(),32;case Oa.a.Y1i:return Ra.App.CM.D6i(),
"string"===typeof P&&(Ra.App.CM.Zon(P),Hg.a.GLb=!0),32;case Oa.a.VGd:return Ra.App.CM.N2f(),"string"===typeof P&&(Ra.App.CM.Zon(P),Hg.a.GLb=!0),32}return 2};class ni{get name(){return"Box4.Search"}xc(b){b.ha("Box4.Search.FindManagerHelper",()=>Wg.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){Ib.a.D_c(Tl)}dispose(){}}Object(m.a)(ni,"PackageManager",null,[1,2]);class di{get name(){return"Box4.TableEditors"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new di)}}
Object(m.a)(di,"Box4TableEditorsPackage",null,[1,2]);class Yg{get name(){return"Box4.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new Yg)}}Object(m.a)(Yg,"Box4TextLevelEditorsPackage",null,[1,2]);var Bh=c(107),uh=c(375),ld=c(108),fl=c(626),fg=c(1515);class Xg{constructor(b,h,u){this.Fv=this.UIa=this.bLa=null;this.HD=this.Wqe=this.kIa=0;this.Eja=this.whd=this.PUa=this.OUa=!1;this.igd=this.oOg=this.rOg=0;this.zza=b;this.ga=h;this.Sm=u}iO(b){return!Ra.App.xa.jb.isEditingAllowed||
ui.SessionStatusManager.instance.zj?!1:""!==this.bLc(b.Bf)}IK(b){if(!this.iO(b))return!1;this.KYn(b);this.HD=this.zza.J4b();this.D0n(b);this.E0n();({K8b:this.whd,c$b:this.Eja}=this.f7i(this.Wqe));this.F0n();this.bLa=b.yH;this.Fv=new Sys.UI.Point(0,0);[this.rOg,this.oOg]=this.zza.getDimensions();w.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}iU(b){this.UIa=b.yH;this.Txk();this.igd=fg.b(this.Fv.x,this.Fv.y,this.rOg,this.oOg,this.whd,this.Eja,this.igd,r.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));
this.zza.Zcg(this.igd,this.whd,this.Eja);return!0}tD(){this.setSize();w.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}PX(){this.zza.pZf();w.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}KYn(b){this.zza=Bh.a.Db(b.Bf,fl.a)}E0n(){this.Wqe=(Math.floor((this.HD+22)/45)%8+this.kIa)%8}f7i(b){let h,u;if(this.HD&&90!==this.HD&&180!==this.HD&&270!==this.HD&&360!==this.HD||this.Nqm(b))return{K8b:!0,c$b:!0};h=u=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:u=!0}return{K8b:u,
c$b:h}}F0n(){this.PUa=this.OUa=!1;switch(this.Wqe){case 0:this.PUa=this.OUa=!0;break;case 1:case 2:this.PUa=!0;break;case 7:case 6:this.OUa=!0}}Nqm(b){return!(b%2)}bLc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const u=b[h].toString();if(u.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==u)return u}return""}D0n(b){switch(this.bLc(b.Bf)){case "WACImageResizeHandleNW":this.kIa=
0;break;case "WACImageResizeHandleN":this.kIa=1;break;case "WACImageResizeHandleNE":this.kIa=2;break;case "WACImageResizeHandleE":this.kIa=3;break;case "WACImageResizeHandleSE":this.kIa=4;break;case "WACImageResizeHandleS":this.kIa=5;break;case "WACImageResizeHandleSW":this.kIa=6;break;case "WACImageResizeHandleW":this.kIa=7}}Txk(){var b=1;this.Sm.instance&&(b=this.Sm.instance.jj);const h=(this.UIa.x-this.bLa.x)/b;b=(this.UIa.y-this.bLa.y)/b;this.Fv.x=this.OUa?-h:h;this.Fv.y=this.PUa?-b:b}setSize(){const b=
new uh.DictionaryPropertySet;b.setValue(ld.a.GOc,100*this.igd);b.setValue(ld.a.Wbi,!0);if(90===this.HD||270===this.HD){let h,u;({K8b:h,c$b:u}=this.f7i(this.kIa));b.setValue(ld.a.srf,h);b.setValue(ld.a.trf,u)}else b.setValue(ld.a.srf,this.whd),b.setValue(ld.a.trf,this.Eja);this.ga.Ub(Oa.a.h7b,2,b)}}Object(m.a)(Xg,"ImageResizeDragAdapter",null,[150]);var Xf=c(138),Hp=c(873);class gm{constructor(b,h,u,y){this.uxe=this.UIa=this.bLa=this.Qod=null;this.Fld=this.ztd=0;this.Hb=null;this.ga=b;this.ib=h;this.Sm=
u;this.QUg=this.mAa=0;this.fd=y}iO(b){return Ra.App.xa.jb.isEditingAllowed&&!ui.SessionStatusManager.instance.zj&&b&&this.ivm(b.Bf)?(this.Qod=this.ib.Lg)?!0:!1:!1}sHd(){}cmf(){return null}IK(b){if(!this.iO(b))return!1;this.zza=Bh.a.Db(b.Bf,fl.a);if(!this.zza)return!1;this.qpd=this.zza.A8;if(!this.qpd)return!1;this.Qod=this.ib.Lg;this.Hb=Jd.ImageReader.Wm(this.Qod);if(!this.Hb)return!1;this.bLa=this.DNa(b);this.uxe=Sys.UI.DomElement.getBounds(this.qpd);this.ztd=0<Jd.ImageReader.vKd(this.Hb)?Jd.ImageReader.vKd(this.Hb):
0;this.Fld=Jd.ImageReader.Ajf(this.Hb);return!0}iU(b){this.UIa=this.DNa(b);this.ayk();if(this.zza)return this.zza.Phe(this.mAa,this.QUg),!0;w.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}tD(){this.ztd=this.mAa=fg.c(this.mAa);this.n4()}PX(){this.zza.Phe(this.Fld,0)}ivm(b){return b.classList.contains(Hp.c)||b.classList.contains(Hp.b)||b.classList.contains(Hp.a)||!!b.parentElement&&b.parentElement.classList.contains(Hp.a)}DNa(b){return this.fd.od.D_a(b)}ayk(){var b=
1;this.Sm&&this.Sm.instance&&(b=this.Sm.instance.jj);var h=new Sys.UI.Point(this.uxe.x+this.qpd.clientWidth/2*b,this.uxe.y+this.qpd.clientHeight/2*b);b=fg.a(this.bLa,h);h=fg.a(this.UIa,h);this.mAa=Math.round(Xf.a.Xqn(h-b));0<this.ztd&&(this.mAa+=this.ztd-this.Fld);this.QUg=this.mAa;this.mAa+=this.Fld}n4(){const b=new uh.DictionaryPropertySet;b.setValue(ld.a.DOc,0);b.setValue(ld.a.QI,this.mAa);this.ga.Ub(Oa.a.imageRotate,2,b)}}Object(m.a)(gm,"ImageRotateDragAdapterSimplified",null,[536,150]);class Ig{constructor(){this.W=
null}get name(){return"Box4.Images"}xc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new Xg(null,r.AFrameworkApplication.ya,Ja.a.instance.Za("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new gm(r.AFrameworkApplication.ya,Hh.a.instance,Ja.a.instance.Za("Common.IZoomManager"),ab.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");
this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){K.a.instance.Kc(new Ig)}}Object(m.a)(Ig,"Box4ImagesPackage",null,[1,2]);var Bk=c(286),zi=c(124),Lc=c(7),nh=c(687),Sd=c(489),je=c(577),Bl=c(269),Pg=c(271),gl=c(1714),yo=c(1765),Xl=c(1181);class Gm extends yo.a{constructor(b,h,u){super(b,h,u);this.Imd=this.Lbb=null}get $Q(){return r.AFrameworkApplication.ta.tq}OJd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}tie(b){return Gm.kya(b,this.$6h())}$6h(){return Gm.oQe}kya(b,h=null){b=this.tie(b);return 0!==b?(h&&h.xud(),2===b&&(h=this.OJd(b),this.Kp(this.xWh(b),h)),!1):!0}kNa(b,h){w.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.QNf=h;kh.a.mark(5576);this.Imd=this.$Q.jg("LoadResource","PictureUploadTime");this.ZQd()?this.I8d(b):this.kXc()}Kp(b,h){const u=new Gh.StandardDialog;u.Ed=0;u.py(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}kXc(){w.ULS.sendTraceTag(36783361,
322,50,"PictureUploader.OnUploadComplete");super.kXc();this.Imd&&(this.Imd.stop(),this.Imd=null)}YMb(){this.Lbb=(new Xl.a).create();this.Lbb.message=CommonUIStrings.l_ImageUploadWait;this.Lbb.Ed=5;this.Lbb.Qt=!1;this.Lbb.wM(null,null,null)}qzd(){this.Lbb&&(this.Lbb.close(),this.Lbb=null)}static j7l(b,h){b=A.a.jh(b);for(let u=0;u<h.length;++u)if(b.endsWith(h[u]))return!0;return!1}static kya(b,h=null){h||(h=Gm.oQe);return b?Gm.j7l(b,h)?0:2:1}}Gm.oQe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(m.a)(Gm,"PictureUploader",yo.a,[]);var Hm=c(1127),Kj;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";b[b.pictureTooLarge=3]="pictureTooLarge"})(Kj||(Kj={}));Object(m.b)("PictureValidationResult",Kj);var Bf=c(62),Ge=c(17),vi=c(44);class Mc{constructor(){this.hT=null}}Object(m.a)(Mc,"ImageData",null,[]);var Xm=c(51),um=c(1715),On=c(1564),Uj=c(1596);class hm extends ff.a{constructor(b,h=!0){super(!1,!1,hm.WK);
this.fWb=null;this.iKg=!1;this.Jx=[];this.rs=null;this.Nbb=b;this.u1j=h;this.D9=this.K7g=!1;this.sXa=null;this.aue=!1;this.Hg=this.n4k;this.mg="InsertFileDialog";this.Ue(1,this.Ptd);hm.WK?(this.fWb={["id"]:this.mg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(v.a)(this,this.I$m,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(v.a)(this,this.g4m,"onFrameReady")},this.Wh(this.titleText,
Object(v.a)(this,this.OQd,"insertDialogHandler"),this.fWb),this.pV=!0):(this.showDialog(this.titleText,Object(v.a)(this,this.OQd,"insertDialogHandler")),h&&this.O2n(),(b=this.HId(1))&&this.Jx.push(b),(b=this.HId(0))&&this.Jx.push(b),this.lpj(),this.pV=!1)}get brj(){return this.Nbb}validate(){this.rs.hT||w.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.rs.hT.value?!0:(hm.py(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}g4m(b){this.u1j&&(this.rs=this.i8i(b,this.Nbb))}I$m(){this.rs&&
this.rs.hT&&(this.iKg||(this.rs.lAn(Object(v.a)(this,this.nLf,"onFileChosen")),this.iKg=!0),this.rs.VMh())}nLf(b){this.fWb.uploadStatusLabel=b;this.t0(this.titleText,Object(v.a)(this,this.OQd,"insertDialogHandler"),this.fWb)}OQd(b){1===b&&this.isEnabled()?hm.WK&&this.rs.hT&&!this.rs.hT.value?(this.fWb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.t0(this.titleText,Object(v.a)(this,this.OQd,"insertDialogHandler"),this.fWb)):(this.yPd(),this.Nbb.kNa(this.rs,Object(v.a)(this,this.dispose,
"dispose"))):0===b&&this.hide()}O2n(){this.aue=!1;this.rs=this.i8i(document.getElementById("uploadFrameContainer"),this.Nbb);r.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.sXa=Object(v.a)(this,this.RNf,"onUploadFrameLoad"),rf.a.addHandler(this.rs.iFrame,"load",this.sXa));this.rs.hT||w.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.sOi()}RNf(){this.sOi()}sOi(){if(this.rs&&!this.aue){var b=this.rs.hT;b&&(rf.a.addHandler(b,bb.a.hi,Object(v.a)(this,
this.onKeyDown,"onKeyDown")),b=[b],this.Jx=b.concat.apply(b,this.Jx),this.lpj(),this.aue=!0)}}dispose(){if(this.rs&&!hm.WK){const b=this.rs.hT;b&&rf.a.removeHandler(b,bb.a.hi,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.sXa&&rf.a.removeHandler(this.rs.iFrame,"load",this.sXa)}this.rs=null;super.dispose()}lpj(){if(0<this.Jx.length){const b=new ic(this.Jx),h=ub.FocusManager.instance().Ks();h&&(this.Jx[0].focus(),h.Xj=b,h.HX=!0)}}onKeyDown(b){4!==ub.FocusManager.instance().wOi(b)&&b.preventDefault()}static get WK(){return r.AFrameworkApplication.ta.Pb.ZA&&
r.AFrameworkApplication.ta.Pb.Omi}static py(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(m.a)(hm,"InsertFileDialog",ff.a,[]);class Ag{static get Hg(){return ff.a.Sy(Ag.am,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Ag.am="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(Ag,"InsertImageDialogHtml",null,[]);class bk extends hm{constructor(b,h=!0){super(b,h)}get Ptd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get n4k(){return Ag.Hg}validate(){this.rs.hT||w.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(na.a)(Gm,this.brj);const h=b.tie(this.rs.hT.value);return 0!==h?(b=b.OJd(h),hm.py(b),!1):!0}}Object(m.a)(bk,"InsertImageDialog",hm,[]);class kf extends bk{constructor(b){super(b)}i8i(b,
h){const u=r.AFrameworkApplication.ta.Pb.ZA&&r.AFrameworkApplication.ta.Pb.Omi;return new Uj.a(b,Object(v.a)(h,h.pcc,"onUploadFrameInitialized"),Object(v.a)(h,h.eya,"uploadResponseReceived"),r.AFrameworkApplication.K,!u)}isEnabled(){return kf.HT.zea(this.brj.context)}static get HT(){return null!=kf.Bqg?kf.Bqg:kf.Bqg=Ja.a.instance.resolve("Box4.Images.IImageEditor")}}Object(m.a)(kf,"Box4InsertImageDialog",bk,[]);class rr{LOk(b){return new Promise((h,u)=>{this.MOk(b).then(y=>{h(y)},y=>{u(y)})})}mxh(b){return new Promise((h,
u)=>{const y=new FileReader;y.addEventListener("load",()=>{h(y.result)},!1);y.addEventListener("error",()=>{u("FileReader exception ("+y.error.name+")")});y.readAsDataURL(b)})}MOk(b){return new Promise((h,u)=>{this.mxh(b).then(y=>{this.h3e(y,"image/jpeg").then(P=>{h(P)},P=>{u(P)})},y=>{u(y)})})}h3e(b,h){return new Promise((u,y)=>{const P=new Image;P.addEventListener("load",()=>{const aa=document.createElement("canvas"),ta=aa.getContext("2d");aa.width=P.width;aa.height=P.height;ta.drawImage(P,0,0);
u(aa.toDataURL(h))});P.addEventListener("error",()=>{y("Image failed to load")});P.src=b})}}Object(m.a)(rr,"ImageFormatConverter",null,[]);var Dj=c(436);const Io=["ImageInsertFailed"];class lm extends Gm{constructor(b,h,u,y,P,aa,ta=!0){super(b,h,u);this.wza=this.jm=this.zG=this.Re=null;this.tGd="wwpicturesfc";this.kpiName="ImageFileExtension";this.Rsc="LocalDeviceUpload";this.sga=new Map;this.aNh=0;this.Mbb=null;this.Zte="";this.Uqa=0;this.Lp=null;this.Crc="";this.RVg=50;this.GLg=this.Ipc=this.eyc=
this.Kuc=!1;this.sUj=19922944;this.cYg=0;this.due=[];this.hKg=[];this.dYg=0;this.mf=y;this.Yl=P;this.ga=aa;this.Fl=Hm.a.getInstance(Dj.a);this.RUg=u.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.gWg=u.pc("ImageUploadMaxByteSize",Number.MAX_VALUE);ta&&this.showDialog();Ra.App.Hic.addHandler(this)}get wki(){return this.K.$("JfifImageInsertIsEnabled")}get lO(){return this.Rsc}get fileExtension(){return this.Zte}get fileSize(){return this.Uqa}get arj(){return this.Mbb}get nu(){return this.Lp||
(this.Lp=Ja.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Qsf(){return this.lO===this.Rsc}showDialog(){On.a(this.K)?(this.m2b=!1,this.rs=new Uj.a(document.body,Object(v.a)(this,this.pcc,"onUploadFrameInitialized"),Object(v.a)(this,this.eya,"uploadResponseReceived"),this.K,!1,void 0,!0)):On.b()||this.ZHb&&ba.a.pH?(this.m2b=!1,this.rs=new Uj.a(document.body,Object(v.a)(this,this.pcc,"onUploadFrameInitialized"),Object(v.a)(this,this.eya,"uploadResponseReceived"),this.K,!1)):(this.m2b=!0,this.rs=
(new kf(this)).rs)}xWh(b){switch(b){case Kj.noPictureSpecified:return Xm.a.noPictureSpecified;case Kj.invalidExtension:return Xm.a.Ogm;case Kj.pictureTooLarge:return Xm.a.Msi}return bc.a.unknown}I8d(b){this.Qsf||(this.Re.Hi()?(w.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),um.a.instance.zdg(this.Re.Hi()),this.Re.Hi().contentReplicator.forceOutbound(Object(v.a)(this,this.MMf,"onPlaceholderNodeSaved"),Object(v.a)(this,this.OJb,"processFailure"),b)):this.OJb(b,157))}Qtm(){return On.c(this.Re)}MMf(b){w.ULS.sendTraceTag(36783363,
322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(b){var h={},u=this.zG?this.zG.properties.Rc.toString():this.Re.Rc.toString();h[Sd.a.nodeId]=this.zG?this.zG.id.toString():this.Re.id.toString();h[Sd.a.classId]=u;this.mf.hasProperty(Lc.a.imageType)&&(h[nh.a.imageType]=this.mf.getValue(Lc.a.imageType));this.mf.hasProperty(Lc.a.GT)&&(h[nh.a.GT]=this.mf.getValue(Lc.a.GT));this.mf.hasProperty(zi.a.$ea)&&(h[nh.a.$ea]=this.mf.getValue(zi.a.$ea));this.mf.hasProperty(Lc.a.Gjb)&&(h[nh.a.Gjb]=this.mf.getValue(Lc.a.Gjb));
On.d(b,this.Re,this.jm,h)&&(this.U4c(b),lm.ubc++)}else w.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")}U4c(b){b.U4c();this.Mbb=b.Mbb}eya(b){this.aNh=+new Date-+this.arj;this.RXd();w.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");On.e(this,b,this.Re)}eCo(){w.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.kXc();lm.ubc--;this.ga.processAction(Wa.a.J6a,2);this.Re?um.a.instance.Tjc(this.Re.Hi(),0):w.ULS.sendTraceTag(42468439,
339,50,"Not able to notify upload notifier for completion");this.nu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}OJb(b,h){var u;if(this.IMn(b))w.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new Ya.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(u=r.AFrameworkApplication.K)||void 0===u?0:u.$("ShouldLogPicturesExtendedHealthKpis"))?this.Fl.logKpiFailure({kpiName:Dj.c.HDa,
errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Dj.c.f7b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):Ta.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Io,!1,!0,!1,!1,b);u=this.ibf(h);w.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Re.BI();var y=
new dg.GraphTransaction(15,Oa.a.pQ);y.Eb(this.Re);lm.HT.VRa(this.mf,u);lm.HT.xVi(this.Re,this.zG);Jd.ImageReader.Y5i(this.mf);y.dispose();this.sbj(u);this.Yl.u0b(b,!1);this.kXc();lm.ubc--;um.a.instance.Tjc(this.Re.Hi(),h)}}sbj(b){const h=new Gh.StandardDialog;h.Ed=0;h.py(Xm.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}ibf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}Bxj(){if(this.Crc&&
0<this.Crc.length){const b=new uh.DictionaryPropertySet;b.setValue(ld.a.PQ,this.Crc);b.setValue(ld.a.B7,!0);this.ga.Ub(Oa.a.r2,2,b)}this.Y9n()}Y9n(){let b="";this.GLg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Kuc&&this.Ipc&&this.eyc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Kuc&&this.Ipc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Kuc&&this.eyc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:
this.eyc&&this.Ipc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.eyc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.Ipc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Kuc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.sbj(b),this.kyj())}mdk(b){this.Crc+=String.format('<img src="{0}"></img>',b);this.dYg++}oKm(){this.eyc=!0;w.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Ya.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Image too large");this.TXd(b)}nKm(){this.Ipc=!0;w.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Ya.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.TXd(b)}Dti(b){this.GLg=!0;w.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}Feo(b){const h=new rr;if(this.tie(b.name)===Kj.validPicture)return h.mxh(b);if(Gm.kya(b.name,Uj.a.pQe)===
Kj.validPicture)return h.LOk(b)}UOk(b){return new Promise(h=>{const u=this.Feo(b);void 0===u&&(this.Dti("Failed starting conversion work"),h());u.then(y=>{y.length>this.sUj?this.oKm():this.mdk(y);h()},y=>{this.Dti(y);h()})})}Aym(b){return this.tie(b.name)===Kj.validPicture||Gm.kya(b.name,Uj.a.pQe)===Kj.validPicture}bgm(){const b=[];if(this.rs.hT.files){this.cYg=this.rs.hT.files.length;this.rs.hT.files.length>this.RVg&&(this.Kuc=!0);this.YMb();for(let h=0;h<this.rs.hT.files.length&&this.RVg;h++){const u=
this.rs.hT.files[h];this.due.push(u.name);this.hKg.push(u.size);u&&(this.Aym(u)?b.push(this.UOk(u)):this.nKm())}}Promise.all(b).then(()=>{this.qzd();this.Bxj()});return!0}Qgm(){this.jm=Ua.a.create();this.mf||(this.mf=new uh.DictionaryPropertySet);this.RUg&&this.wza&&this.mf.setValue(zi.a.Tsi,this.wza);var b=480;let h=320;var u=this.context.view;this.K.$("WordEditorAutoResizeImageIsEnabled")&&(u=u.oh.editingElement.clientWidth,0<u&&u<b&&(h=Math.floor(1*u/b*h),b=u,this.mf.setValue(zi.a.$ea,u)));this.mf.setValue(Ge.a.jba,
Bf.a.Ml(b,0));this.mf.setValue(Ge.a.tga,Bf.a.Ml(h,1));this.mf.setValue(vi.a.VZ,1);this.mf.setValue(ld.a.B7,!0);this.mf.setValue(Lc.a.Gjb,Box4Intl.Box4Strings.l_Picture);b=lm.HT.CGh(this.context,this.mf,this.jm);if(!b)return!1;this.Re=b.node;this.mf=(this.zG=b.blob)?this.zG.properties:this.Re.properties;Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(this.Re);return!0}ZQd(){return this.Qsf?this.bgm():this.Qgm()}kyj(){var b;this.sga.set("FileExtensions",this.nxl());this.sga.set("FileSizeInBytes",this.hKg.toString());
this.sga.set("Source",this.lO);this.sga.set("NumberOfImagesAttemptedToInsert",this.cYg.toString());this.sga.set("NumberOfImagesPasted",this.dYg.toString());(null===(b=r.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.sga.set("ErrorLevel","warning"),b=Object.assign(new Ya.a,{extendedProperties:this.sga}),this.Fl.logKpiFailure({kpiName:Dj.c.HDa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):Ta.Health.instance.recordKpiUsage("MultipleImageInsert",
0,this.tGd,this.sga)}nxl(){let b="";for(let h=0;h<this.due.length;++h)b=b+this.OWh(this.due[h])+",";return b}kNa(b,h){this.RUg&&(this.wza=new Mc,this.wza.hT=b.hT);super.kNa(b,h)}pcc(b){this.rs=b;if(!this.m2b){if(this.die){if(On.a(this.K)||this.ZHb&&ba.a.pH){b.VDd(Object(v.a)(this,this.P3m,"onFileChosen$2"));return}const h=b.VDd(null),u=this.PWh(b);u&&(this.Zte=u.name,this.Uqa=u.size);if(!this.kya(h,b)||!this.meg(u,b)){b=Object.assign(new Ya.a,{extendedProperties:new Map});b.extendedProperties.set("type",
this.kya(h,this.rs)?"Image too large":"FileType invalid");this.TXd(b);this.RXd();return}}this.kNa(b,null)}}P3m(b){if(!this.Qsf){var h=this.PWh(this.rs);h&&(this.Zte=h.name,this.Uqa=h.size);if(!this.kya(b,this.rs)||!this.meg(h,this.rs)){h=Object.assign(new Ya.a,{extendedProperties:new Map});h.extendedProperties.set("type",this.kya(b,this.rs)?"Image too large":"FileType invalid");this.TXd(h);this.RXd();return}}this.kNa(this.rs,null)}nPd(){return!!lm.ubc}RXd(){var b;this.sga.set("FileExtension",this.OWh(this.fileExtension));
this.sga.set("Source",this.lO);this.sga.set("FileSizeInBytes",this.fileSize.toString());this.sga.set("RequestTimeInMs",this.aNh.toString());(null===(b=r.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.Fl.logKpiUsage({kpiName:Dj.c.HDa,kpiType:0,optionalProperties:{extendedProperties:this.sga}}):Ta.Health.instance.recordKpiUsage(this.kpiName,0,this.tGd,this.sga)}OWh(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}$6h(){return this.wki?
Uj.a.D$g:Gm.oQe}PWh(b){return(b=b.hT)?b.files[0]:null}meg(b,h){return b&&b.size>this.gWg?(h&&h.xud(),b=this.OJd(Kj.pictureTooLarge),this.Kp(this.xWh(Kj.pictureTooLarge),b),!1):!0}OJd(b){switch(b){case Kj.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Kj.invalidExtension:return this.wki?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Kj.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,
Math.round(this.gWg/1E6));default:return""}}TXd(b){var h;(null===(h=r.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Dj.c.f7b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.Fl.logKpiFailure({kpiName:Dj.c.HDa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):Ta.Health.instance.recordQosError("PictureFromLocalInvalid",
Io,!0,!0,!1,!1,b)}static get HT(){return null!=lm.Aqg?lm.Aqg:lm.Aqg=Ja.a.instance.resolve("Box4.Images.IImageEditor")}}lm.ubc=0;Object(m.a)(lm,"Box4PictureUploader",Gm,[627,620]);var hp=c(694),Yl=c(162);class wq{constructor(){this.As=this.Bq=this.Xub=this.z8g=this.J$c=this.TGj=null;this.tJe=0;this.Jqa=this.IEe=this.lvb=null;this.dFg=0;this.Vme=this.Jda=this.bBe=null;this.CPg=!1;this.cme=this.Zle=this.dme=null}get assetId(){return this.J$c}get thumbnailUrl(){return this.z8g}get Ykn(){return this.Xub}get displayName(){return this.Jqa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Bq,this.As)}get qhk(){if(this.Zle&&this.cme&&this.dme){const b=document.createElement("a");b.setAttribute("href",this.dme);b.setAttribute("target","_blank");b.innerText=this.cme;return b}return null}get Wfh(){return this.Zle}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.dFg)}get Isn(){const b=document.createElement("span");var h=0;if(this.lvb&&0<this.lvb.length){var u=this.lvb.indexOf("."),y=0>u?this.lvb:this.lvb.substring(0,u);for(y=Number.parseInvariant(y);h<
y&&5>h;h++)b.appendChild(Gd.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Yl.a.Yh("box42.png"),"","",!0,""));0<u&&(u=Number.parseInvariant(this.lvb.substr(u+1)),3>u?b.appendChild(Gd.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Yl.a.Yh("box42.png"),"","",!0,"")):8>u?b.appendChild(Gd.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Yl.a.Yh("box42.png"),"","",!0,"")):b.appendChild(Gd.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Yl.a.Yh("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Gd.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Yl.a.Yh("box42.png"),"","",!0,""));this.IEe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.IEe),b.appendChild(h));return b}get dLn(){return 0<this.tJe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.tJe):""}get npk(){if(this.CPg){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.Vme&&this.Jda)return wq.pUk(this.Vme,this.Jda);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.bBe){const h=this.bBe.split(",");b=Array(h.length);for(let u=0;u<h.length;u++)b[u]=h[u].trim()}else b=[];return b}static dpl(b){const h=new wq;for(let u=0;u<b.childNodes.length;u++){const y=b.childNodes[u];if(1===y.nodeType)try{const P=y.firstChild.nodeValue;switch(y.nodeName){case "src":h.TGj=P;break;case "assetid":h.J$c=
P;break;case "thumb":"64x64"===y.attributes.getNamedItem("size").nodeValue?h.z8g=wq.zkj(P):"192x192"===y.attributes.getNamedItem("size").nodeValue&&(h.Xub=wq.zkj(P));break;case "imagedim":if(P){const ta=P.indexOf("x");0<ta&&ta<P.length&&(h.Bq=P.substr(0,ta),h.As=P.substr(ta+1))}break;case "resolution":h.tJe=Number.parseInvariant(P);break;case "rating":h.lvb=P;break;case "numofratings":h.IEe=P;break;case "displayname":h.Jqa=P;break;case "contentlength":h.dFg=Number.parseInvariant(P)/1024;break;case "subject":h.bBe=
P;break;case "provider":h.Jda=P;break;case "attributionlink":h.Vme=P;break;case "iscsc":h.CPg=1===Number.parseInvariant(P);break;case "additional":const aa=y.firstChild;if(y.hasChildNodes()&&aa&&"id"===aa.nodeName&&1===Number.parseInvariant(aa.text))for(let ta=0;ta<y.childNodes.length;ta++){const Pa=y.childNodes[ta];switch(Pa.nodeName){case "caption":h.Zle=Pa.text;break;case "value":h.dme=Pa.text;break;case "string":h.cme=Pa.text}}}}catch(P){}}return h}static pUk(b,h){const u=document.createElement("a");
u.setAttribute("href",b);u.setAttribute("target","_blank");u.innerText=h;return u}static zkj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(m.a)(wq,"ClipArtSearchResult",null,[]);class sr{static get Hg(){return ff.a.Sy(sr.am,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}sr.am="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(m.a)(sr,"InsertClipartDialogHtml",null,[]);class sp extends ff.a{constructor(b){super();this.uza=this.vsb=0;this.T0g=null;this.JHe=!1;this.TVb=this.jWa=this.cN=null;this.TGi=h=>{const u=this.ZV.value;u&&0<u.trim().length&&(this.search(this.ZV.value),this.Lha(1,!1));h.preventDefault();h.stopPropagation()};this.U8m=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.TGi(h),h.preventDefault(),h.stopPropagation())};this.UGi=h=>{100<=this.ZV.value.length&&(h.preventDefault(),h.stopPropagation())};
this.w7m=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.DNi(h);this.f2f(h)};this.onScroll=()=>{if(this.pr&&this.pr.children&&!(2>this.pr.children.length)){var h=this.pr.children[0].children[0],u=this.pr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.pr.scrollTop,y=h.clientHeight+2,P=parseInt(String(this.pr.scrollTop/y));h=parseInt(String(u/y));var aa=parseInt(String(this.pr.clientWidth/y));h<u/y&&h<parseInt(String(this.cN.length/aa))&&h++;for(u=P;u<h;u++)for(y=
0;y<aa;y++){var ta=u*aa+y;P=this.cN[ta];(ta=document.getElementById("clip"+ta))&&!ta.childNodes.length&&(P=this.ABh(P),ta.appendChild(P))}}};this.Z9m=h=>{h.target.setAttribute("src",Yl.a.Yh("phthumb.64x64x32.png"))};this.x7m=h=>{h.target.setAttribute("src",Yl.a.Yh("phpreview.96x96x32.png"))};this.wEi=h=>{Je.a.en(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.P4m=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.wEi(h)};this.OEi=h=>{const u=h.target.innerText;this.ZV&&(this.ZV.value=u);this.search(u);h.stopPropagation();h.preventDefault();this.Lha(1,!1)};this.y5m=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.OEi(h)};this.WGi=h=>{this.cN&&(this.jRn(this.cN[this.vsb]),h.stopPropagation(),h.preventDefault(),this.ZV.value="",this.Lha(1,!1))};this.V8m=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.WGi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let u=0;switch(h.keyCode){case Sys.UI.Key.up:u=-5;break;case Sys.UI.Key.down:u=5;break;case Sys.UI.Key.left:u=-1;break;case Sys.UI.Key.right:u=1}this.uza=this.uza+u<this.pr.children.length-1?0>this.uza+u?0:this.uza+u:this.pr.children.length-1;this.f2f(this.uza);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.pr.children.length&&this.z2i(h)):h.keyCode===Sys.UI.Key.tab&&
(this.uza=h.shiftKey?Math.max(0,this.uza-1):Math.min(this.uza+1,this.pr.children.length-1))};this.onError=()=>{this.pr&&(this.pr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.OOi=h=>{if(this.pr)if(h.data.Aha){var u=h.data.Aha.lastChild.childNodes;this.cN||(this.cN=[]);for(h=0;h<u.length&&100>this.cN.length;h++){var y=u[h];1===y.nodeType&&"image"===y.nodeName&&(y=wq.dpl(y),this.cN.push(y))}this.oGh();this.cN.length||(this.pr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.Ae){h=
A.a.mfj(h.data.Ae);try{u=parseInt(h)}catch(P){u=14}this.pr.innerText=26===u?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.oGh=()=>{if(this.cN){Hc.a.tZ(this.pr);this.jWa&&(this.jWa.dispose(),this.jWa=null);this.pr.focus();this.pr.classList.remove("ClipartSearchInProgress");for(let u=0;u<this.cN.length;u++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+u;const y=document.createElement("span");y.id="clip"+u;y.classList.add("ClipartImageContainer");
h.appendChild(y);this.pr.appendChild(h);u<parseInt(String(this.pr.clientHeight/y.clientHeight))*parseInt(String(this.pr.clientWidth/y.clientWidth))&&(h=this.ABh(this.cN[u]),y.appendChild(h))}this.JHe&&(this.z2i(this.vsb),this.f2f(this.vsb))}};this.xfm=h=>{1===h&&this.cN&&sp.HT.zea(this.bEg.context)&&(h=this.cN[this.vsb])&&this.bEg.IGa(h)};this.bEg=b;this.Hg=sr.Hg;this.mg="InsertClipartDialog";this.Ue(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.xfm);this.pr=document.getElementById("clipartsearchresults");this.lpd=this.onKeyDown;rf.a.addHandler(this.pr,"keydown",this.lpd);this.kpd=this.onScroll;rf.a.addHandler(this.pr,"scroll",this.kpd);this.ZV=document.getElementById("textInput");this.Jrd=this.U8m;rf.a.addHandler(this.ZV,"keydown",this.Jrd);this.Krd=this.UGi;rf.a.addHandler(this.ZV,"keypress",this.Krd);this.Lrd=this.UGi;rf.a.addHandler(this.ZV,"paste",this.Lrd);this.rmc=document.getElementById("btnSearch");this.rmc.setAttribute("src",
Yl.a.Yh("search.16x16x32.png"));this.jpd=this.TGi;rf.a.addHandler(this.rmc,"click",this.jpd);this.fSb=document.getElementById("clipartpreviewimage");this.hse=document.getElementById("clipartattributedisplayname");this.d9a=document.getElementById("clipartseesimilar");this.gse=document.getElementById("clipartdimensions");this.Poc=document.getElementById("clipartadditionalvalue");this.ise=document.getElementById("clipartratingvalue");this.sUa=document.getElementById("clipartattributionvalue");this.tUa=
document.getElementById("clipartkeywords");this.ese=document.getElementById("clipartadditionalname");this.jse=document.getElementById("clipartratingname");this.fse=document.getElementById("clipartattributionname");this.LHe=this.w7m;this.vOe=this.Z9m;this.Mfd=this.wEi;this.Nfd=this.P4m;this.$Ae=this.OEi;this.aBe=this.y5m;this.npd=this.WGi;this.opd=this.V8m;this.ZV.focus();this.Lha(1,!1)}dispose(){this.pr&&this.osh();this.pr&&this.lpd&&(rf.a.removeHandler(this.pr,"keydown",this.lpd),this.lpd=null);
this.pr&&this.kpd&&(rf.a.removeHandler(this.pr,"scroll",this.kpd),this.kpd=null);this.pr=null;this.ZV&&this.Jrd&&(rf.a.removeHandler(this.ZV,"keydown",this.Jrd),this.Jrd=null);this.ZV&&this.Krd&&(rf.a.removeHandler(this.ZV,"keypress",this.Krd),this.Krd=null);this.ZV&&this.Lrd&&(rf.a.removeHandler(this.ZV,"paste",this.Lrd),this.Lrd=null);this.ZV=null;this.rmc&&this.jpd&&(rf.a.removeHandler(this.rmc,"click",this.jpd),this.rmc=this.jpd=null);this.fse=this.jse=this.ese=this.tUa=this.sUa=this.ise=this.Poc=
this.gse=this.d9a=this.hse=this.fSb=this.opd=this.npd=this.aBe=this.$Ae=this.Nfd=this.Mfd=this.TVb=this.vOe=this.LHe=null;this.jWa&&(this.jWa.dispose(),this.jWa=null);super.dispose()}SK(){super.SK();document.getElementById(this.mj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.MLb(b,!1,this.OOi)}MLb(b,h,u){this.uza=this.vsb=0;this.osh();if(this.cN&&b===this.T0g&&this.JHe===h)window.setTimeout(this.oGh,500);else{this.cN&&(Array.clear(this.cN),this.cN=null);this.T0g=b;this.JHe=
h;var y=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');y.append("<query>");y.append(A.a.Cf(b));y.append("</query>");y.append("<mediatype>Illustration</mediatype>");y.append("<mediatype>Photo</mediatype>");y.append("<filetype>jpg</filetype>");y.append("<filetype>jpeg</filetype>");y.append("<filetype>gif</filetype>");y.append("<filetype>bmp</filetype>");y.append("<filetype>tif</filetype>");y.append("<filetype>tiff</filetype>");y.append("<filetype>png</filetype>");y.append("</search>");
b=r.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let P=b.length;4>P;P++)b="0"+b;r.AFrameworkApplication.Ve.qj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Ra.App.webServiceBase,b,nh.a.ubo,h.toString()),2,y.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,u,this.onError,null)}}jRn(b){this.MLb(b.assetId,!0,this.OOi);this.cN||(this.cN=[],this.cN.push(b))}ABh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);rf.a.addHandler(h,"click",this.LHe);rf.a.addHandler(h,"error",this.vOe);return h}j2k(b){1===b.childNodes.length&&(b=b.childNodes[0],rf.a.removeHandler(b,"click",this.LHe),rf.a.removeHandler(b,"error",this.vOe))}DNi(b){const h=this.cN[b];var u=h.Ykn;this.msh();this.TVb=this.x7m;var y=document.createElement("img");y.setAttribute("src",u);if(h.displayName)u=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{u=new Sys.StringBuilder;for(let P=0;P<h.keywords.length&&5>P;P++)P&&u.append(", "),u.append(h.keywords[P]);u=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,u.toString())}y.setAttribute("title",u);y.setAttribute("alt",u);rf.a.addHandler(y,"error",this.TVb);this.fSb.appendChild(y);y=document.getElementById("clip"+this.vsb);y.classList.remove("ClipartSelectedImage");y=document.getElementById("clip"+
b);y.classList.add("ClipartSelectedImage");this.vsb=b;h.displayName&&(this.hse.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');rf.a.addHandler(b,"click",this.npd);rf.a.addHandler(b,"keydown",this.opd);this.d9a.appendChild(b);this.gse.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.dLn,h.fileSize);(b=h.qhk)&&h.Wfh?(this.Poc.parentNode.style.display="block",this.ese.innerText=h.Wfh,this.Poc.appendChild(b)):
this.Poc.parentNode.style.display="none";this.ise.appendChild(h.Isn);Hc.a.tZ(this.sUa);if(b=h.npk)this.sUa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(rf.a.addHandler(b,"click",this.Mfd),rf.a.addHandler(b,"keydown",this.Nfd));this.tUa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)y=h.keywords[b],u=document.createElement("a"),u.innerText=y,u.setAttribute("href",'""'),rf.a.addHandler(u,"click",this.$Ae),rf.a.addHandler(u,"keydown",this.aBe),this.tUa.appendChild(u),
b<h.keywords.length-1&&(y=document.createElement("span"),y.innerText=", ",this.tUa.appendChild(y));this.jse.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.fse.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Lha(1,!0)}msh(){this.fSb&&1===this.fSb.childNodes.length&&(this.TVb&&(rf.a.removeHandler(this.fSb.childNodes[0],"error",this.TVb),this.TVb=null),Hc.a.tZ(this.fSb));this.sUa&&0<this.sUa.childNodes.length&&"a"===this.sUa.childNodes[0].nodeName.toLowerCase()&&(this.Mfd&&rf.a.removeHandler(this.sUa.childNodes[0],
"click",this.Mfd),this.Nfd&&rf.a.removeHandler(this.sUa.childNodes[0],"keydown",this.Nfd));this.d9a&&0<this.d9a.children.length&&"a"===this.d9a.children[0].nodeName.toLowerCase()&&(this.npd&&rf.a.removeHandler(this.d9a.children[0],"click",this.npd),this.opd&&rf.a.removeHandler(this.d9a.children[0],"keydown",this.opd),Hc.a.tZ(this.d9a));if(this.tUa){for(let b=0;b<this.tUa.childNodes.length;b++){const h=this.tUa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(rf.a.removeHandler(h,"click",this.$Ae),rf.a.removeHandler(h,
"keydown",this.aBe))}Hc.a.tZ(this.tUa)}this.hse.innerText="";this.gse.innerText="";Hc.a.tZ(this.Poc);Hc.a.tZ(this.ise);Hc.a.tZ(this.sUa);this.tUa.innerText="";this.ese.innerText="";this.jse.innerText="";this.fse.innerText=""}z2i(b){if(!(this.pr.children.length<=b||0>b)){var h=this.pr.children[b],u=this.pr.children[0];u=u.clientHeight-u.children[0].clientHeight+2;this.pr.scrollTop+this.pr.clientHeight<h.offsetTop+h.clientHeight?this.pr.scrollTop=h.offsetTop-3*h.clientHeight-u:this.pr.scrollTop>h.offsetTop&&
(this.pr.scrollTop=h.offsetTop-u/2);this.DNi(b)}}validate(){return!0}osh(){if(ub.FocusManager.zJ()){var b=ub.FocusManager.instance().getRegion(this.oK);b&&b.Xj.vy(this.ZV)}else this.ZV.focus();for(b=0;b<this.pr.childNodes.length;b++){const h=this.pr.childNodes[b];1===h.childNodes.length&&this.j2k(h.childNodes[0])}Hc.a.tZ(this.pr);this.msh();this.Lha(1,!1);this.jWa=new hp.a(Box4Intl.Box4Strings.l_ClipartSearching);this.jWa.Pni=!1;this.pr.appendChild(this.jWa.element);this.pr.classList.add("ClipartSearchInProgress")}f2f(b){this.uza=
b;b=this.pr.children[this.uza];ub.FocusManager.zJ()?ub.FocusManager.instance().getRegion(this.oK).Xj.vy(b):b.focus()}static get HT(){return sp.Gj=sp.Gj||Ja.a.instance.resolve("Box4.Images.IImageEditor")}}sp.Gj=null;Object(m.a)(sp,"InsertClipartDialog",ff.a,[]);class Lj extends lm{constructor(b,h,u,y,P,aa){super(b,h,u,y,P,aa,!1);this.i7m=ta=>{if(this.Qtm()){var Pa=this.Re.Hi(),vb=Pa.contentReplicator.zu.toString(),Kb=new Sys.Net.WebRequest;Kb.set_url("ClipArtUpload.ashx");Kb=new Sys.StringBuilder(Kb.getResolvedUrl());
this.jW(Kb,nh.a.assetId,ta.assetId,!0);this.jW(Kb,Sd.a.lcid,r.AFrameworkApplication.lcid.toString());this.jW(Kb,Sd.a.nodeId,this.zG?this.zG.id.toString():this.Re.id.toString());this.jW(Kb,Sd.a.cellId,Pa.gm.toString());this.jW(Kb,Sd.a.fileId,Pa.Js);this.jW(Kb,Sd.a.Wsa,vb);this.jW(Kb,Sd.a.WS,this.jm.toString());ta=this.Re.ia(zi.a.CK,Pg.a.ot);this.jW(Kb,Sd.a.CK,ta.toString());this.jW(Kb,Sd.a.cpb,"1");Pa.tI&&this.jW(Kb,Sd.a.tI,Pa.tI);this.jW(Kb,Sd.a.classId,this.zG?this.zG.properties.Rc.toString():this.Re.Rc.toString());
this.mf.hasProperty(Lc.a.imageType)&&this.jW(Kb,nh.a.imageType,this.mf.getValue(Lc.a.imageType).toString());Bl.a.instance.vdk(Kb);r.AFrameworkApplication.Ve.qj(Kb.toString(),2,"",{},!1,2,this.fCo,this.uploadFailed,null);lm.ubc++}};this.fCo=ta=>{if(({group:Pa}=je.a.q0(ta.data.Ae)).returnValue){var Pa=Pa.Responses[0];Pa.bmb=ta.data.oH;Pa.qu=ta.data.Bj?ta.data.Bj[Bk.a.C6]:"";this.eya(Pa)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ta=new gl.a;ta.StatusCode=14;this.eya(ta)};new sp(this)}IGa(b){this.ZQd()&&
this.Re.Hi().contentReplicator.forceOutbound(this.i7m,null,b)}jW(b,h,u,y){b.append(y?"?":"&");b.append(A.a.Pj(h));b.append("=");b.append(A.a.Pj(u))}ibf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.ibf(b)}}eya(b){super.eya(b);lm.ubc--}}Object(m.a)(Lj,"ClipartUploader",lm,[]);class Jo{constructor(b,h,u){this.yfm=(y,P,aa,ta,Pa)=>{if(!this.Gj||!this.Gj.value)return w.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;y=this.Gj.value.zea(P);return 2===aa&&y?(new Lj(P,lf.a.instance,r.AFrameworkApplication.K,Pa,this.Yl,this.ga),32):1===aa?y&&Ra.App.gth?32:8:2};this.Gj=b;this.Yl=h;this.ga=u}Wb(){this.ga.gb(Oa.a.Xdi,oc.a.view,this.yfm,260)}}Object(m.a)(Jo,"ClipArtActor",null,[]);class Hn{constructor(){this.W=null}get name(){return"Box4.ClipArt"}xc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new Jo(b.af("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),r.AFrameworkApplication.ya)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Wb();
const b=Ra.App.xa;b&&b.updateCommandUI()}dispose(){}}Object(m.a)(Hn,"ClipartPackage",null,[1,2]);class mk{constructor(b){this.FWa=this.qWa=this.LWa=this.KWa=null;this.SMg=this.yTg=this.Ah=this.M9=!1;this.iJe=this.eUg=null;this.PTg=0;this.Ma=this.$Tg=null;this.k5=b;this.qR=3;this.$rc=!0}initialize(b,h,u){this.KWa=this.kmf(b,h);this.LWa=CommonUIStrings.l_SavingStatus;this.qWa=CommonUIStrings.l_ReadOnlyStatus;this.FWa=CommonUIStrings.l_ReviewModeStatus;this.k5&&this.k5.execute(y=>{y.NXa(Object(v.a)(this,
this.y7c,"updateToSavingStatus"))});this.Ah=!0;this.Ma=u;return!0}Nob(b,h){this.M9=b;this.qR=h;this.aTa(this.$rc)}aTa(b){!this.$rc&&b&&(this.$Tg=new Date);this.$rc=b;b=null;3===this.qR&&(b=this.$rc?this.KWa:this.LWa);this.p6k(b)}kmf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}y7c(){this.aTa(!1)}dKl(){switch(this.qR){case 1:return this.qWa;case 2:return this.FWa;
default:return null}}tnm(b){return this.yTg===this.M9&&this.PTg===this.qR&&this.eUg===b}a9e(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.M9,b,this.dKl(),this.$Tg,this.$rc);this.SMg=!0;return null});this.iJe=null}p6k(b){this.Ah&&fh.c()&&!this.tnm(b)&&(!this.SMg&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.a9e(b):Je.a.Q8d()?(this.iJe&&w.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.iJe=window.requestIdleCallback(()=>{this.a9e(b)})):window.requestAnimationFrame(()=>{this.a9e(b)}),this.yTg=this.M9,this.eUg=b,this.PTg=this.qR)}}Object(m.a)(mk,"ReactSaveStatusUIHandler",null,[597]);class mo{constructor(b,h){this.eX=null;this.KWa=CommonUIStrings.l_SavedStatus;this.LWa=CommonUIStrings.l_SavingStatus;this.qWa=CommonUIStrings.l_ReadOnlyStatus;this.FWa=CommonUIStrings.l_ReviewModeStatus;this.V9a=h;this.k5=b;this.qR=3;this.$ab=!0}fB(){this.k5&&this.k5.execute(b=>{b.NXa(Object(v.a)(this,
this.y7c,"updateToSavingStatus"))});this.V9a.execute(b=>{this.eX=b})}Nob(b,h){this.qR=h;3===h?this.aTa(this.$ab):2===h?this.nbg(this.FWa):this.nbg(this.qWa)}y7c(){this.aTa(!1)}aTa(b){this.$ab=b;this.nbg(this.$ab?this.KWa:this.LWa)}nbg(b){this.eX&&this.eX.sendMessage(H.a.pso,this.NMk(b))}NMk(b){const h={};h.StatusText=b;return h}}Object(m.a)(mo,"SaveStatusPostMessageHandler",null,[597]);var Ro=c(223),Kk=c(117);class on{constructor(b,h,u,y){this.FWa=this.qWa=this.LWa=this.KWa=null;this.Mtb=0;this.YY=
this.qKe=this.Opb=this.Hme=this.HOe=null;this.tg=b;this.P9a=h;this.k5=u;this.Sl=y;this.BQg=!0;this.M9=!1;this.qR=3;this.$ab=!0}initialize(b,h){if(!this.tg)return!1;this.KWa=this.kmf(b,h);this.LWa=CommonUIStrings.l_SavingStatus;this.qWa=CommonUIStrings.l_ReadOnlyStatus;this.FWa=CommonUIStrings.l_ReviewModeStatus;this.fB();return!0}kmf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}fB(){this.P9a&&
this.P9a.execute(b=>{b.Wfk(Object(v.a)(this,this.hBh,"createStatusAndModeElements"));b.Ifk(Object(v.a)(this,this.w$n,"showHideSaveStatusElement"));b.Qno&&this.hBh(null,null)});this.k5&&this.k5.execute(b=>{b.NXa(Object(v.a)(this,this.y7c,"updateToSavingStatus"))})}yia(){this.YY&&this.tg&&this.tg.aya(this.YY)}w$n(b,h){this.Nob("true"===h,this.qR)}Nob(b,h){this.M9=b;this.qR=h;this.Hme&&(this.Hme.style.display=this.M9||3===this.qR||!this.HOe?"none":"");this.Opb&&(this.Opb.style.display=this.M9||3===this.qR?
"none":"",this.Opb.innerText=1===this.qR?this.qWa:this.FWa,this.Opb.title=1===this.qR?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.qKe&&(this.qKe.style.display=this.M9||1===this.qR||!this.HOe&&!this.Opb?"none":"");this.YY&&(this.YY.style.display=this.M9||1===this.qR?"none":"",this.aTa(this.$ab),this.YY.title=CommonUIStrings.l_SaveStatusTooltip)}hBh(b,h){b=document.getElementById(Ro.CuiHelper.w7l);h&&h.DGo||!b||""===this.KWa||""===this.LWa||""===this.qWa||
""===this.FWa||(this.HOe=document.getElementById(Ro.CuiHelper.yYe),this.Hme=Ro.CuiHelper.wBd(b,"BreadcrumbAppModeDash","-"),this.Opb=Ro.CuiHelper.wBd(b,"BreadcrumbAppModeStatus",1===this.qR?this.qWa:this.FWa),this.roj(this.Opb),this.qKe=Ro.CuiHelper.wBd(b,"BreadcrumbSaveStatusDash","-"),this.YY=Ro.CuiHelper.wBd(b,"BreadcrumbSaveStatus",this.KWa),this.roj(this.YY),this.Nob(this.M9,this.qR))}y7c(){this.aTa(!1)}aTa(b){this.$ab=b;this.vAo(this.$ab?this.KWa:this.LWa)}vAo(b){!this.YY||3!==this.qR&&2!==
this.qR||(this.BQg&&!this.$ab?(this.Mtb=this.YY.offsetWidth<this.Mtb?this.Mtb:this.YY.offsetWidth,this.gvo(this.LWa),this.BQg=!1):this.YY.innerText=b)}roj(b){b.style.direction=this.Sl?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Sl?"right":"left";b.style.display=this.M9?"none":"";b.setAttribute("Unselectable","on")}gvo(b){this.YY&&(this.YY.style.width="",this.YY.innerText=b,this.Mtb=this.YY.offsetWidth<this.Mtb?this.Mtb:this.YY.offsetWidth,b=Kk.a.WB(this.YY),this.YY.style.width=this.Mtb-
Hc.a.mM(b.paddingLeft)-Hc.a.mM(b.paddingRight)+1+"px")}}Object(m.a)(on,"SaveStatusUIHandler",null,[597]);var iq=c(75);class Ko{constructor(){this.rKe=this.xIe=this.TKa=this.W=null}get name(){return"Common.App.SaveStatus"}xc(b){this.W=b;r.AFrameworkApplication.K.$("PostMessageEmbedded")&&r.AFrameworkApplication.zT?this.W.register(mo,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Xd(()=>new mo(this.W.Za("Common.App.HostNotification.EditNotificationEventSource"),
this.W.Za("Postmessage.IHostPostmessenger"))):r.AFrameworkApplication.ta.Pb.Eyf||(r.AFrameworkApplication.ta.Pb.ZI?this.W.register(mk,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Xd(()=>new mk(this.W.Za("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(on,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Xd(()=>new on(iq.EventHandlerManager.instance,
this.W.Za("Common.App.Header.HeaderEventSource"),this.W.Za("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)))}init(){r.AFrameworkApplication.K.lp(Object(v.a)(this,this.rx,"onFullAppSettingsReady"))}rx(){const b=r.AFrameworkApplication.K,h=!!r.AFrameworkApplication.ta.Pb&&4===r.AFrameworkApplication.ta.Pb.$n;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||
b.$("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.K.$("PostMessageEmbedded")&&r.AFrameworkApplication.zT?(this.rKe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.rKe.fB():r.AFrameworkApplication.ta.Pb.Eyf||b.$("PreventSaveStatusInitializationWithHiddenHeader")&&r.AFrameworkApplication.hideHeader||(r.AFrameworkApplication.ta.Pb.ZI?(this.xIe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.xIe.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus"),
r.AFrameworkApplication.K):(this.TKa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.TKa.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus")))}dispose(){this.TKa&&this.TKa.yia()}}Object(m.a)(Ko,"PackageManager",null,[1,2]);var no=c(1599);class Wk{get name(){return"Common.App.EventsCachePackage"}xc(){}init(){no.a.instance.init()}dispose(){}static main(){K.a.instance.Kc(new Wk)}}Object(m.a)(Wk,"EventsCachePackage",null,[1,2]);var Zh=c(112),Ai=c(146),vm=c(98),Qm=c(634),
ag=c(330),Yn=c(477),Im=c(304),Oe=c(27),pj=c(258),kg=c(25);class Mj{constructor(b){this.IPg=!1;this.X9c=this.im=null;this.Ile=!1;this.OD=b}get control(){return this.OD}get Qd(){return this.control.Qd}get root(){return this.control.root}get uH(){return this.control.uH}get DXa(){return this.control.DXa}get pk(){return this.control.pk}get iE(){return this.control.iE}gI(){}initialize(){}Fw(b,h,u){this.control.e7k(b,h,u)}Nl(){Oe.c(this.control.Gh.Command)||this.Yt(this.control.Gh.Command,null,null)}Yt(b,
h,u){let y=0;this.root&&(y=this.root.Coa(b,h,u));this.control.enabled=0<(y&1);return y}M6a(){let b=this.control.visible;this.root.uSa&&(b=this.Qd[pj.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.bbc=!0));return b}Kcg(){const b=kg.a.Wpa(this.Qd[pj.a.labelText],this.control.Gh.LabelText);this.xae(b)}xae(b){this.control.labelText!==b&&(this.iE.forEach(h=>{h.xae(b)}),this.control.labelText=b,this.root.j3a=!0)}LOb(){const b=kg.a.Wpa(this.Qd[pj.a.alt],this.control.Gh.Alt);this.Cgc(b)}Cgc(b){this.control.tooltip!==
b&&(this.iE.forEach(h=>{h.Cgc(b)}),this.control.tooltip=b)}Cia(){const b=kg.a.Wpa(this.Qd[Qm.a.Image16by16Class],this.control.Gh.Image16by16Class),h=kg.a.Wpa(this.Qd[Qm.a.Image32by32Class],this.control.Gh.Image32by32Class);var u=kg.a.Wpa(this.Qd[Qm.a.Image48by48Class],this.control.Gh.Image48by48Class);u=Oe.b(u)?h:u;this.nBc(this.iE.small,b);this.nBc(this.iE.medium,b);this.nBc(this.iE.large,h);this.nBc(this.iE.pco,b);this.nBc(this.iE.v$b,u)}nBc(b,h){!b||Oe.c(b.PP)||Oe.c(h)||b.PP.className===h||(b.PP.className=
h)}Rwo(b){if(!Oe.b(b)&&this.root.B8f){for(const h of this.control.V1e){const u=h.aT===b;u&&(this.control.PRe=h);this.control.visible&&(h.mA=u)}this.control.visible&&(this.root.j3a=!0)}}Jhk(){if(this.iE.v$b&&this.iE.v$b.MN&&this.iE.v$b.Leb){const b=this.iE.v$b.MN,h=kg.a.Wpa(this.Qd[ag.a.Description],this.control.Gh.Description);Oe.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.pk;Object(jb.a)(Yn.a,b)?this.uH.Hob(b):
this.root.pzb=this.control;return!1}onBlur(){const b=this.pk;this.control.$Fb()&&kg.a.gw(b.Nc,"cui-ctl-menu-hovered-without-focus");this.root.pzb=null;return!1}RX(b){if(this.control.$Fb()){var h=this.uH.upa;const u=h===this.root.HHb-1;h=u?null:this.root.eC[h+1];this.Q0e(!1);u||this.control===h||kg.a.gw(h.NGb,Im.MenuLauncher.ZUc);this.control.enabled&&this.control.vu?u?this.control.aY():(kg.a.Zf(this.pk.Nc,"cui-ctl-menu-hovered-without-focus"),h.afa=this.control.vu):u?this.uH.setFocus(b.og):(h.afa=
this.uH.Nc,this.uH.Toa())}return!1}oO(){this.control.$Fb()&&kg.a.gw(this.pk.Nc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!Oe.c(b.Ib)&&!Oe.c(b.Ib.rawEvent)){const u=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;u===Sys.UI.Key.enter&&(h=!0);if(Object(jb.a)(Yn.a,this.pk)){const y=this.uH;if(!Oe.c(y)){const P=y.upa,aa=0===this.root.g0,ta=!Oe.c(this.control.gen);if(u!==Sys.UI.Key.tab&&u!==Sys.UI.Key.left&&u!==Sys.UI.Key.right&&u!==Sys.UI.Key.up&&u!==Sys.UI.Key.down&&u!==Sys.UI.Key.esc)return h;
Je.a.q0e();u!==Sys.UI.Key.tab||b?u===Sys.UI.Key.tab&&b?(y.nK(1),h=!0):u===Sys.UI.Key.left&&aa||u===Sys.UI.Key.right&&!aa?(ta?y.nK(2):0<P&&this.root.MYa(P,!0,!1),h=!0):u===Sys.UI.Key.right&&aa||u===Sys.UI.Key.left&&!aa?(ta&&y.nK(4),h=!0):u===Sys.UI.Key.up?(y.nK(5),h=!0):u===Sys.UI.Key.down?(y.nK(6),h=!0):u===Sys.UI.Key.esc&&(this.root.MYa(P,!0,!1),h=!0):(y.nK(0),h=!0)}}}return h}dw(b){let h=!1;if(!Oe.c(b.Ib)&&!Oe.c(b.Ib.rawEvent)){const u=b.Ib.keyCode;Rb.KeyInputManager.n$h(b)||u!==Sys.UI.Key.enter&&
u!==Sys.UI.Key.space||(h=this.Uof(b),h||(this.Fw(b.Bf,1,b.Ib),h=!0))}return h}fC(b){this.J1e();if(this.DXa){let h=!0;2===b.og&&(h=b.pba===Sys.UI.MouseButton.leftButton);h&&this.pk&&this.aud(this.pk.Nc)}(b.Ib.type.toLowerCase()!==bb.a.HO||this.DXa)&&b.Ib.preventDefault();return!1}get ouf(){return this.IPg}kal(){this.IPg=!0}J1e(){this.ouf&&this.control.root.ydb()}twa(b){Object(jb.a)(Yn.a,this.pk)&&!this.DXa&&2===b.og&&b.pba===Sys.UI.MouseButton.leftButton?(this.Fw(b.Bf,b.og,b.Ib),b=!0):b=this.control.Mta(b);
return b}onClick(b){let h=!1;Object(jb.a)(Yn.a,this.pk)&&!this.DXa&&3===b.og&&(this.Fw(b.Bf,b.og,b.Ib),h=!0);return ba.a.zi?!1:h}Vkb(b){return this.Y_d(b)}rFa(b){this.Mta(b);return!1}Y_d(b){return Oe.c(this.im)?!1:(this.r1f(Je.a.mUd(this.Dbh,b.clientPoint)),!0)}Pbc(b){let h=!1;this.Mta(b)&&(h=!0);3!==b.og&&(b=!0,!this.root&&Mj.kJf&&(w.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.P$(),h=!0);return h}Sbc(b){return this.Mta(b)}Qbc(b){return this.Y_d(b)}Rbc(b){return this.Mta(b)}Nbc(b){return 3===
b.og?(this.root.P$(),!0):!1}Obc(){return!1}get Dbh(){!Oe.c(this.im)&&Oe.c(this.X9c)&&(this.X9c=Je.a.getElementBounds(this.im));return this.X9c}r1f(b){this.Ile!==b&&(this.Ile=b,this.QRe(this.Ile))}QRe(b){Oe.c(this.im)||kg.a.D4(this.im,vm.Control.dud,b)}aud(b){this.control.enabled&&(this.im=b,this.root.jAc=this.control,this.r1f(!0),this.root.uea(this.control,!1))}Mta(b){if(!Oe.c(this.im)){this.r1f(!1);let h=!!this.root;if(Mj.kJf){const u=De.ActionManager.dea(parseInt(this.control.Gh.Command))||"";w.ULS.sendTraceTag(588084885,
207,50,"Root not null: {0}, Action: {1}",h,u)}h&&this.root.jaa(this.control,!1);Oe.c(b)||Je.a.mUd(this.Dbh,b.clientPoint)&&this.Fw(this.im,b.og,b.Ib);h=!!this.root;Mj.kJf&&w.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.jAc=null);this.X9c=this.im=null;return!0}return!1}nK(b){return Object(jb.a)(Yn.a,this.pk)&&2!==b&&4!==b&&!Je.a.P7b(this.control.vu)?this.aY():!1}aY(){try{if(this.control.visible){const b=this.control.vu;if(!Oe.c(b))return b.focus(),!0}}catch(b){}return!1}Q0e(b){const h=
this.uH;Oe.c(h)||this.root.MYa(h.upa+1,b)}hoa(){}Uof(){return!1}Ifa(b){let h=null;b&&b.rawEvent&&(h={},h[Mj.triggerTime]=b.rawEvent.timeStamp);return h}static get kJf(){null==Mj.DEe&&(Mj.DEe=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Mj.DEe}}Mj.triggerTime="TriggerTime";Mj.DEe=null;Object(m.a)(Mj,"ControlBehavior",null,[615]);var pn=c(143);class dn extends Mj{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Gh}gI(b){const h=
b.Km;b=b.aT;Oe.c(h)||(td.a.instance.mb(bb.a.focus,h,Object(v.a)(this,this.onFocus,"onFocus")),td.a.instance.mb(bb.a.blur,h,Object(v.a)(this,this.onBlur,"onBlur")),Ai.a.instance.mb(bb.a.pointerOver,h,Object(v.a)(this,this.RX,"onPointerOver")),Ai.a.instance.mb(bb.a.pointerOut,h,Object(v.a)(this,this.oO,"onPointerOut")),Rb.KeyInputManager.instance.xD(bb.a.hi,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"),b),Rb.KeyInputManager.instance.xD(bb.a.St,h,Object(v.a)(this,this.gG,"onKeyPress"),b),Rb.KeyInputManager.instance.xD(bb.a.sh,
h,Object(v.a)(this,this.dw,"onKeyUp"),b),Ai.a.instance.mb(bb.a.pointerDown,h,Object(v.a)(this,this.fC,"onPointerDown")),Ai.a.instance.mb(bb.a.nM,h,Object(v.a)(this,this.twa,"onPointerUp")),th.a.instance.mb(bb.a.click,h,Object(v.a)(this,this.onClick,"onClick")),pn.a.instance.mb(bb.a.GO,h,Object(v.a)(this,this.Vkb,"onTouchMove")),pn.a.instance.mb(bb.a.vJ,h,Object(v.a)(this,this.rFa,"onTouchEnd")))}Fw(b,h,u){this.control.enabled&&(b=null,this.pk&&this.pk.jRc()&&this.uH&&(b=this.root.eC[this.uH.upa])&&
!this.ouf&&(b.NRa(this.button),b=null),this.executeCommand(this.control.Gh.Command,h,!0,u),b&&b.NRa(this.button))}executeCommand(b,h,u,y){if(!Oe.c(b)){const P=this.Qd;P.CommandValueId=this.button.$Bb();P.MenuItemId=this.button.Gh.MenuItemId;P.SourceControlId=this.control.id;this.root.executeCommand(b,P,this.pk,h,u,null,this.Ifa(y))}}Nl(){Oe.c(this.control.Gh.Command)||0<(this.Yt(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)&&this.M6a()&&this.ZSa()}ZSa(){this.Kcg();this.LOb();this.Cia()}onFocus(b){super.onFocus(b);
this.x7f();return!1}onBlur(b){super.onBlur(b);this.maf();return!1}onKeyDown(b){let h=super.onKeyDown(b);Oe.c(b.Ib)||this.u4f(b.Lo,b.Ib.keyCode)&&(h=!1);return h}gG(b){let h=!1;Oe.c(b.Ib)||Oe.c(b.Ib.rawEvent)||(this.u4f(b.Lo,b.Ib.rawEvent.keyCode)?(this.Fw(b.Bf,b.og,b.Ib),h=!0):b.Ib.preventDefault());return h}u4f(b,h){if(ba.a.kt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}dw(b){let h=!1;Oe.c(b.Ib)||this.u4f(b.Lo,b.Ib.keyCode)||
(h=super.dw(b));return h}x7f(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}maf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(m.a)(dn,"ButtonBehavior",Mj,[]);var Pn=c(963);class Up{}Up.Color="Color";Up.IndexColorSelected="ColorSelected";Object(m.a)(Up,"ColorPickerCommandProperties",null,[]);class Xk extends Mj{constructor(b){super(b);this.Dxc=this.lv=-1}get colorPicker(){return this.control}get hMa(){return this.colorPicker.OIk.hMa}get properties(){return this.colorPicker.Gh}Fw(b,
h,u){if(this.control.enabled){const y=this.Qd;y.Color=Xk.kLd(b)[Pn.ColorPicker.Fzd];b=null;kg.a.Fr(this.properties.Stateful)&&this.pk&&this.pk.jRc()&&this.uH&&(b=this.root.eC[this.uH.upa]);this.root.executeCommand(this.properties.Command,y,this.pk,h,!0,null,this.Ifa(u));b&&b.NRa(this.colorPicker)}}Nl(){var b=this.Qd;b.SourceControlId=this.properties.Id;if(0<(this.Yt(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Up.IndexColorSelected in this.Qd&&(b=this.Qd[Up.IndexColorSelected]),
b!==this.Dxc)){const h=this.hMa;0<=b&&b<h.length&&this.Gnj(h[b],!0);0<=this.Dxc&&this.Dxc<h.length&&this.Gnj(h[this.Dxc],!1);this.Dxc=b}}Gnj(b,h){h?kg.a.Zf(b,"cui-colorpicker-selected"):kg.a.gw(b,"cui-colorpicker-selected")}gI(b){for(let h=0;h<b.vRe.length;++h){const u=b.vRe[h];td.a.instance.mb(bb.a.focus,u,Object(v.a)(this,this.DKf,"onCellFocus"));td.a.instance.mb(bb.a.blur,u,Object(v.a)(this,this.z1m,"onCellBlur"));Rb.KeyInputManager.instance.mb(bb.a.hi,u,Object(v.a)(this,this.onKeyDown,"onKeyDown"));
Rb.KeyInputManager.instance.mb(bb.a.sh,u,Object(v.a)(this,this.dw,"onKeyUp"));th.a.instance.mb(bb.a.click,u,Object(v.a)(this,this.A1m,"onCellClick"));Ai.a.instance.mb(bb.a.nM,u,Object(v.a)(this,this.FKf,"onCellPointerUp"));Ai.a.instance.mb(bb.a.pointerOver,u,Object(v.a)(this,this.EKf,"onCellPointerOver"));Ai.a.instance.mb(bb.a.pointerDown,u,Object(v.a)(this,this.B1m,"onCellPointerDown"))}}DKf(b){b=Xk.kLd(b.Bf);this.uH.Hob(this.pk);this.rhe(b,!0);return!0}z1m(b){this.rhe(Xk.kLd(b.Bf),!1);return!0}rhe(b,
h){h?(this.lv=parseInt(b.getAttribute("arrayPosition")),kg.a.Zf(b,"cui-colorpicker-hoveredOver"),this.x7f(b)):(this.lv=-1,this.maf(b),kg.a.gw(b,"cui-colorpicker-hoveredOver"))}A1m(b){3===b.og&&this.Fw(b.Bf,b.og,b.Ib);return!0}FKf(b){3!==b.og&&this.Fw(b.Bf,b.og,b.Ib);return!0}EKf(b){this.Q0e(!1);b=parseInt(Xk.kLd(b.Bf).getAttribute("arrayPosition"));this.x2c(b);return!0}B1m(){return!1}x7f(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!Oe.b(h)){const u=this.Qd;u.Color=b[Pn.ColorPicker.Fzd];
this.root.executeCommand(h,u,this.pk,0,!1)}}}maf(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!Oe.b(h)){const u=this.Qd;u.Color=b[Pn.ColorPicker.Fzd];this.root.executeCommand(h,u,this.pk,0,!1)}}}nK(b){b=vm.Control.Sdf(this.lv,this.colorPicker.width,this.hMa.length,b);if(b!==this.lv&&this.x2c(b))return!0;this.rhe(this.hMa[this.lv],!1);return!1}aY(){return this.x2c(0)}x2c(b){return this.hMa&&this.hMa.length>b&&(b=this.hMa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}hoa(){-1!==
this.lv&&this.rhe(this.hMa[this.lv],!1)}static kLd(b){return Xk.IKl(b)}static IKl(b){var h=["td"];const u=h.length;if(!b)return null;for(var y=0;y<u;y++)if(b.tagName.toLowerCase()===h[y].toLowerCase())return b;for(b=b.parentNode;b;){for(y=0;y<u;y++)if(b.tagName.toLowerCase()===h[y].toLowerCase())return b;b=b.parentNode}return null}}Object(m.a)(Xk,"ColorPickerBehavior",Mj,[]);var Zn=c(279),Bg=c(281),Vp=c(1622),Ck=c(693),So=c(397),In=c(1104);class ip{constructor(b,h){this.T4j=b;this.uPg=h}gae(b,h,u,
y){if(Oe.c(b)||Oe.c(h))return null;const P=new In.a;const aa=y.x;var ta=y.y;const Pa=y.width;var vb=y.height;let Kb;ip.n2b(h,"flyoutWidth");y=ip.n2b(h,"flyoutRealHeight");const Sb=ip.n2b(h,"viewportWidth");var Yb=ip.n2b(h,"viewportHeight"),Ac=ip.n2b(h,"viewableLeft");const Sc=ip.n2b(h,"viewableTop"),nd=this.T4j;let Ad=!1,he=!1;const ce=1===u,Nd=4===u,re=this.uPg;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Kb=this.vxi(b);P.Isj=Yb;P.Deg=Sb;if(ce)nd?h=
aa+Pa:(h=aa-Kb,P.qjb=!0),vb=ta;else{var Xd="";Pa>Kb&&(Kb=Pa,Xd=(Kb-2*So.Menu.iZd).toString());nd?h=aa:(h=aa+Pa-Kb,P.qjb=!0);vb=ta+vb;""!==Xd&&(b.style.minWidth=Xd+"px")}re&&(vb+=Sc,h+=Ac);b.style.top=vb+"px";b.style.left=h+"px";let vg=!1;Xd=!1;Kb<=Sb?h+Kb>Ac+Sb?(ce&&nd&&aa-Kb>Ac||Nd&&aa-Kb>Ac?(h=aa-Kb,re&&(h+=Ac),Xd=P.qjb=!0):(h=Ac+Sb-Kb,Ad=!0),vg=!0):h<Ac&&(ce&&!nd&&aa+Pa+Kb<Ac+Sb?(h=aa+Pa,re&&(h+=Ac),P.qjb=!1,Xd=!0):(h=Ac,he=!0,P.qjb=!0),vg=!0):nd?(h=Ac,vg=!0,P.qjb=!0):(h=Ac+Sb-Kb,vg=!0,P.qjb=!1);
vg&&(b.style.left=h+"px");P.R3b=vb;vb+y<=Sc+Yb&&3!==u||(P.TAf=!0,{AXm:u,tml:ta,Qom:Yb,xvm:Ac}=this.rdf(u,vb,y,ta,Sc,Yb),vb!==u&&(b.style.top=u+"px",P.R3b=u),-1<ta&&(b.style.maxHeight=ta+"px"),Yb&&(b.style.bottom="0px",b.style.height="auto"),Ac&&this.YPm(b,nd,ce,Xd,he,Ad,Sb,aa,Pa));P.jJc=h;P.Rdf=Kb;P.Ndf=y;return P}rdf(b,h,u,y,P,aa){let ta,Pa,vb;ta=-1;vb=Pa=!1;const Kb=h,Sb=P+aa-h;h=y-u;const Yb=this.uPg;let Ac=!1;0>h&&(h=P);Yb||(y-=P);u<=y&&1!==b||(4===b||1===b?u<aa?(h=aa-u,Pa=!0):(h=P,Ac=vb=Pa=!0):
(y<Sb&&3!==b?(h=Kb,Pa=!0):ta=y,vb=!0));Yb&&(Pa=!1,Ac?ta=aa:h+=P);return{AXm:h,tml:ta,Qom:Pa,xvm:vb}}YPm(b,h,u,y,P,aa,ta,Pa,vb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(aa||y)b.style.left="",b.style.right=(aa?0:ta-Pa)+"px"}else P||y||(b.style.left="",b.style.right=(u?ta-Pa:ta-Pa-vb)+"px")}BAl(b){const h={};if(Oe.c(b))return h;h.viewportWidth=Hc.a.wDb();h.viewportHeight=Hc.a.c3();Oe.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);
Oe.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;Oe.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);Oe.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*So.Menu.iZd:b.scrollHeight;const u=
b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.vxi(b);b.style.overflowY=u;return h}vxi(b){return b.offsetWidth}static n2b(b,h){return Oe.c(b)?0:b[h]}}Object(m.a)(ip,"MenuPositioner",null,[]);var Zl=c(533),xn=c(620),Ip=c(1106),ma=c(1105),cb=c(1102),zb=c(1103),Wb=c(1108),nc=c(417),Uc=c(961);class Md extends Mj{constructor(b){super(b);this.zDe=0;this.sTg=null;this.YGe=-1;this.bdd=null;this.NQf=this.CMg=!1;this.MUj=new ip(0===this.root.g0,kg.a.Fr(this.root.properties.DivSyndicated))}get Hxi(){return this.MUj}get Du(){return this.control}get properties(){return this.control.Gh}get menu(){return this.Du.menu}set menu(b){this.Du.menu=
b}get FK(){return this.Du.FK}set FK(b){this.Du.FK=b}get Skh(){Oe.c(this.bdd)&&(this.bdd=Md.FTk());return this.bdd}get U$i(){let b=!this.root.Erf;Object(jb.a)(396,this.root)&&1===this.root.HHb&&(b=!0);return b}Fw(b,h){Object(jb.a)(396,this.root)&&this.root.Daf();this.Du.h_(h)}h_(b){if(this.Du.enabled&&!this.FK){var h=ri.a.instance.Xo(Wa.a.h_);h.properties.add("Id",this.Du.Gh.Id);h.properties.add("InputMethod",Zn.a[b]);h.end();kh.a.mark(10326);Je.a.gZd(this.Du.Gh.Id,"MenuOpen");this.Du.vu&&(this.Du.afa=
Je.a.tNa(this.Du.vu.ownerDocument));this.zDe=b;this.qMi(b);this.y$d();this.Du.B6a(this.Du.vu,!0)}}y$d(){Oe.c(this.properties.PopulateAsyncTriggerCommand)||this.CMg||(this.fZm(),this.CMg=!0)}fZm(){const b={};b[Vp.a.Callback]=Object(v.a)(this,this.PSi,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.pk,0,!1)}PSi(){this.Du.fRa()}fRa(){this.FK&&this.qMi(this.zDe,!0)}qMi(b,h=!1){var u=!0;if(kg.a.Fr(this.properties.PopulateDynamically)){u=!1;const y=this.qYc(b);
y!==this.sTg&&(u=this.bRf(y,h));u=u||!this.FK}u&&(h=r.AFrameworkApplication.ta.tq,u=null,h&&(u=h.jg("LoadResource","Menu Initialization")),this.b1a(b),u&&u.stop(),this.m1d())}b1a(b){if(!Oe.c(this.menu)){if(this.Du.P3a){var h=this.Du.pk;if(h&&h.keytip){var u=h.keytip.key.toLocaleLowerCase();this.menu.Q_n(String.format("{0} {1}",this.Du.P3a,h.keytip.L$e),this.Du.JQa&&""!==this.Du.JQa?String.format("{0}-{1}",this.Du.JQa,u):u)}}this.menu.Ula();kg.a.Zf(this.menu.Nc,this.Du.lUe);kg.a.D4(this.menu.Nc,"cui-touch",
3===b||this.root.Zfe);if(this.menu.hasItems()){this.menu.gI();h=this.pk;h.SJh();h.pOc=!0;h.Qf(this.menu);h.pOc=!1;this.menu.nMi();u=Object(jb.a)(Uc.a,this.root);var y=null,P=!1;u&&(y=this.root,P=y.v5a,y.v5a=!1);var aa=this.menu.Nc;aa.style.visibility="hidden";aa.style.position="absolute";aa.style.top="0px";aa.style.left="0px";ba.a.kt&&!ba.a.yib&&(aa.style.maxHeight="100px",aa.style.overflowY="scroll");document.body.appendChild(aa);this.Mhk();this.Iin(aa);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.k9j();kg.a.Zf(this.Du.NGb,Im.MenuLauncher.ZUc);var ta=this.root.HHb;this.m6n&&this.root.uea(this.control,!0);aa.style.zIndex=String(r.AFrameworkApplication.ta.ysa);this.root.Pak(this.Du);this.menu.upa=ta;aa.style.visibility="visible";ta=this.TTh();if(Object(jb.a)(zb.a,this.menu)){aa.style.position="fixed";const Pa=this.root.eC[0];Pa&&Pa.menu&&Pa.menu.Nc?100!==Je.a.HLc(this.root.eC[0].menu.Nc)&&Bg.a.Q5f(aa,ta,Object(v.a)(this,this.wUe,"afterShowMenu")):Bg.a.Q5f(aa,ta,Object(v.a)(this,this.wUe,
"afterShowMenu"))}else Bg.a.Q5f(aa,ta,Object(v.a)(this,this.wUe,"afterShowMenu"));this.FK=!0;this.menu.SAf=!0;!ba.a.zi&&this.Du.XSn&&this.menu.setFocus(b);u&&(y.v5a=P);u=this.properties.CommandMenuOpen;Oe.b(u)||this.root.executeCommand(u,null,h,b,!1)}}kh.a.mark(10327)}m1d(){}k9j(){this.YGe=kg.a.Jyb(this.YGe);this.YGe=window.setTimeout(Object(v.a)(this,this.l9j,"addAndPositionBackFrameInternal"),50)}l9j(){this.menu&&this.menu.Nc&&(document.body.appendChild(this.Skh),this.Din())}Din(){const b=this.Skh;
var h=this.menu.Nc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let u=h.offsetWidth;h=h.offsetHeight;ba.a.yib&&(u-=4,h-=4);b.style.width=u.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get m6n(){return this.root.HHb?!1:!0}wUe(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Nc===b.element&&Object(jb.a)(cb.a,this.menu)&&
Bg.a.pjk(this.TTh()))}TTh(){const b=this.menu.children,h=[];if(Object(jb.a)(cb.a,this.menu))for(let u=0;u<b.count;u++){const y=b.J(u);Array.add(h,y.separator);for(let P=0;P<y.children.count;P++){const aa=y.children.J(P);Array.add(h,aa.Nc)}}return h}Mhk(){var b=this.menu.children;for(let u=0;u<b.count;u++){const y=b.J(u).children;for(let P=0;P<y.count;P++){var h=y.J(P);if(Object(jb.a)(Yn.a,h)){const aa=h;if("Menu32"===aa.aT||"Menu48"===aa.aT)h=h.control,h.behavior&&(Object(jb.a)(xn.a,h)||Object(jb.a)(ma.a,
h))&&h.behavior.Jhk()}}}0<b.count&&(b=b.J(0),Oe.c(b.separator)||(b.separator.style.display="none"),Oe.c(b.Ffe)||kg.a.Zf(b.Ffe,"cui-menusection-titleAtTop"))}Iin(b){if(!Oe.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=Ck.a.create();try{const u=this.Hxi.BAl(b),y=this.qLc();let P=this.root.gae(b,u,this.Du.jZd,y);P||(P=this.Hxi.gae(b,u,this.Du.jZd,y));this.root.Ixi=P}finally{h&&h.dispose()}}}qLc(){const b=Je.a.getElementBounds(this.Du.NGb);
var h=this.uH;Oe.c(h)||Oe.c(h.Nc)||(h=Je.a.getElementBounds(h.Nc),b.x=h.x+So.Menu.iZd,b.width=h.width-2*So.Menu.iZd);Object(jb.a)(nc.a,this.Du.iWd)&&(b.height=0);return b}kta(){if(this.Du.FK){w.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.Du.Gh.Id});this.menu.hoa();this.oVi();this.FK=!1;this.menu.SAf=!1;this.root.jaa(this.control,!0);this.U$i?r.AFrameworkApplication.ta.e1c(this.Du.afa,this.zDe):this.NLn();this.Du.afa=null;var b=this.Du.NGb;kg.a.gw(b,Im.MenuLauncher.ZUc);this.Du.B6a(this.Du.vu,
!1);kg.a.gw(b,"cui-ctl-menu-hovered-without-focus");this.menu.Toa();Oe.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.pk,0,!1);this.nVi()}}NLn(){const b=this.Du.afa;if(b)try{b.focus()}catch(h){}}nVi(){Hc.a.hw(this.menu.Nc);Hc.a.hw(this.bdd);kg.a.aya(this.menu.Nc)}qYc(b){if(this.NQf&&kg.a.Fr(this.properties.PopulateOnlyOnce)||Oe.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Du.Xgf();return 0<(this.root.Coa(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}bRf(b,h=!1){if(this.NQf&&kg.a.Fr(this.properties.PopulateOnlyOnce))return!0;let u=null;this.sTg=b;Oe.c(b)||(u=this.LUk(b));Oe.c(u)||(this.NQf=!0);if(h){this.root.VFk(this.Du);if(Oe.c(u)||!u.hasItems())return this.kta(),!1;this.oVi();this.nVi()}this.RZn(u);return!0}NDi(){}LUk(b){b=Zl.Builder.Lxh(b);if(!Oe.c(b)){const h=new Wb.a;h.mth=!0;h.parentId=this.control.id;let u;u=Object(jb.a)(Ip.a,this.control);return this.root.wN.pYa(b,h,u)}return null}RZn(b){Oe.c(b)||
(Oe.c(this.menu)||this.menu.dispose(),this.menu=b,this.NDi())}oVi(){const b=this.menu.parent;b?(b.pOc=!0,b.removeChild(this.menu.id),b.pOc=!1):w.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;Oe.c(b.Ib)||Oe.c(b.Ib.rawEvent)||Object(jb.a)(Yn.a,this.pk)||!b.Ib.rawEvent.altKey||b.Ib.keyCode!==Sys.UI.Key.down||(this.Fw(b.Bf,1,b.Ib),h=!0);h||(h=super.onKeyDown(b));return h}fC(b){this.J1e();2===b.og&&b.pba!==Sys.UI.MouseButton.leftButton||
this.Fw(b.Bf,b.og,b.Ib);b.Ib.preventDefault();return!1}Uof(b){if(!this.uH||!this.uH.inKeytipMode||!this.Du.ZEi)return!1;this.Du.ZEi(this.pk,b);return!0}static FTk(){const b=kg.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(m.a)(Md,"MenuLauncherBehavior",Mj,[633,615]);var ge=c(910);class Pd extends Md{constructor(b){super(b)}get Rs(){return this.jHc.properties}get jHc(){return this.control}get LMa(){return this.jHc.LMa}gI(){Ai.a.instance.mb(bb.a.pointerDown,
this.LMa.Km,Object(v.a)(this,this.fC,"onPointerDown"));Rb.KeyInputManager.instance.mb(bb.a.hi,this.LMa.Km,Object(v.a)(this,this.onKeyDown,"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.sh,this.LMa.Km,Object(v.a)(this,this.dw,"onKeyUp"))}Nl(){const b=this.Qd[ge.a.SelectedItemId];if(0<(this.Yt(this.Rs.Command,this.Rs.QueryCommand,this.Qd)&2)){const h=this.Qd[ge.a.SelectedItemId];Oe.c(h)||b===h||this.jHc.Q1c(h)||(this.Qd[ge.a.SelectedItemId]=null)}}}Object(m.a)(Pd,"DropDownBehavior",Md,[]);var te=
c(543),Xe=c(706);class Yf extends Pd{constructor(b){super(b);this.CUa=null;this.iEe=this.Ksb=this.Mza=!1;this.Nvc=null;this.Lvc=-1}get v2(){return this.control}get zP(){return this.v2.zP}get $G(){return this.v2.$G}get fTd(){return this.Qd[te.a.IsFreeForm]}set fTd(b){this.Qd[te.a.IsFreeForm]=b}gI(b){Ai.a.instance.mb(bb.a.pointerDown,b.Km,Object(v.a)(this,this.fC,"onPointerDown"));const h=b.fr;td.a.instance.mb(bb.a.focus,h,Object(v.a)(this,this.Ikb,"onInputFocus"));td.a.instance.mb(bb.a.blur,h,Object(v.a)(this,
this.swa,"onInputBlur"));Rb.KeyInputManager.instance.mb(bb.a.hi,h,Object(v.a)(this,this.d5m,"onInputKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.St,h,Object(v.a)(this,this.e5m,"onInputKeyPress"));Re.a.instance.mb(bb.a.rba,h,Object(v.a)(this,this.NLf,"onInputMouseUp"));Ai.a.instance.mb(bb.a.pointerDown,h,Object(v.a)(this,this.g5m,"onInputPointerDown"));Ai.a.instance.mb(bb.a.pointerDown,b.xIh,Object(v.a)(this,this.lMf,"onMenuButtonPointerDown"))}Nl(){0<(this.Yt(this.$G.Command,this.$G.QueryCommand,
this.Qd)&2)&&(this.Ksb||this.Pqj(),this.uxo())}NDi(){this.v2.menuItems=null;var b;var h=b=null;if(!Oe.c(this.menu)){this.M$d();for(let y of this.menu.children)for(let P of y.children)if(Object(jb.a)(Yn.a,P)){var u=P;u=u.control;Object(jb.a)(625,u)&&(b=u,b=b.Gh.MenuItemId);Object(jb.a)(604,u)&&(h=u,h=h.p0a());Oe.c(b)||Oe.c(h)||(this.v2.menuItems[h]=b,b=h=null)}}}g5m(b){Object(jb.a)(396,this.root)&&2===b.og&&(this.CUa=Je.a.tNa(this.control.vu.ownerDocument),this.control.vu.focus());return!1}fC(b){this.J1e();
let h=!1;3===b.og&&(h=super.fC(b),this.M$d());h&&b.Ib.preventDefault();return!1}lMf(b){let h=!1;if(2!==b.og||b.pba===Sys.UI.MouseButton.leftButton)this.Fw(b.Bf,b.og,b.Ib),this.M$d(),h=!0;h&&b.Ib.preventDefault();return!1}d5m(b){let h=!1;if(!Oe.c(b.Ib)&&!Oe.c(b.Ib.rawEvent)){const u=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;kg.a.Fr(this.$G.AutoComplete);if(u===Sys.UI.Key.enter)this.ES(),this.BZf(),Object(jb.a)(Xe.Ribbon,this.root)&&this.root.DZ(),h=!0;else if(u===Sys.UI.Key.tab){if(this.ES(),this.BZf(),
Object(jb.a)(Xe.Ribbon,this.root)&&(h=this.root.lje(this.pk.Nc,!b)),Object(jb.a)(396,this.root))return!0}else u===Sys.UI.Key.backspace||u===Sys.UI.Key.del?this.control.enabled?(this.XZe(),this.Nvc=null):h=!0:u===Sys.UI.Key.esc?(this.FZf(),this.BZf(),Object(jb.a)(Xe.Ribbon,this.root)&&this.root.DZ(),h=!0):u===Sys.UI.Key.down&&(this.h_(1),this.M$d(),h=!0)}return h}e5m(b){if(!this.control.enabled)return!0;!Oe.c(b.Ib)&&b.Ib.charCode&&this.C0k();return!1}NLf(){return this.Mza?!1:this.Mza=!0}Hdl(){this.Lvc=
-1;const b=this.zP.fr,h=b.value,u=this.UCl(h);if(u){b.value=u.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const y=b.createTextRange();y.moveStart("character",h.length);y.moveEnd("character",b.value.length);y.select()}this.Nvc=u.value}else this.Nvc=null}UCl(b){const h=this.v2.menuItems;for(let u in h){const y={key:u,value:h[u]};if(y.key.toLowerCase().startsWith(b.toLowerCase()))return y}return null}C0k(){kg.a.Fr(this.$G.AutoComplete)&&-1===this.Lvc&&
(this.iEe&&(this.qYc(0),this.iEe=!1),this.Lvc=window.setTimeout(Object(v.a)(this,this.Hdl,"executeAutoComplete"),this.v2.vpk))}XZe(){kg.a.Fr(this.$G.AutoComplete)&&(this.Lvc=kg.a.Jyb(this.Lvc))}Ikb(b){if(this.FK)return this.menu.setFocus(0),!0;Object(jb.a)(396,this.root)&&(ub.FocusManager.instance().qC("ribbon"),this.root.FNc=!1);this.onFocus(b);this.Ksb=!0;kg.a.Zf(this.zP.Km,"cui-cb-focus");kg.a.Fr(this.$G.PopulateDynamically)&&(this.iEe=!0);Je.a.M1c(this.zP.fr);Oe.c(this.menu)||this.menu.sm();return this.Mza=
!1}swa(){this.Ksb=!1;this.ES();kg.a.gw(this.zP.Km,"cui-cb-focus");return!1}BZf(){Object(jb.a)(396,this.root)&&(void 0!==this.CUa&&null!==this.CUa&&r.AFrameworkApplication.ta.e1c(this.CUa,2),this.CUa=null)}ES(){if(this.control.enabled){this.XZe();var b=this.zP.fr;if(void 0===this.Qd[te.a.Value]||null===this.Qd[te.a.Value]||b.value!==this.Qd[te.a.Value].toString())if(this.v2.Q1c(this.Nvc))this.fTd=!1,this.Qd[te.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.v2.V1c.$Bb(),["MenuItemId"]:this.v2.V1c.Gh.MenuItemId},
this.root.executeCommand(this.$G.Command,b,this.pk,0,!1);else{if(!kg.a.Fr(this.$G.AutoComplete)){var h=this.v2.menuItems[b.value];if(!Oe.b(h)&&this.v2.Q1c(h)){this.fTd=!1;this.Qd[te.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.v2.V1c.$Bb(),["MenuItemId"]:h};this.root.executeCommand(this.$G.Command,b,this.pk,0,!1);return}}h=!Oe.b(b.value)&&""!==A.a.$wa(b.value);this.v2.Hgh&&h?(this.fTd=!0,this.Qd[te.a.Value]=b.value,this.root.executeCommand(this.$G.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.pk,0,!1)):this.FZf()}}else this.FZf()}FZf(){this.XZe();this.Nvc=null;this.Pqj()}Pqj(){const b=this.Qd[te.a.Value]||"";b!==this.zP.fr.value&&(this.zP.fr.value=b);this.v2.Q1c(this.v2.menuItems[b])}uxo(){const b=this.Qd[te.a.FontStyle]||"normal";b!==this.zP.fr.style.fontStyle&&(this.zP.fr.style.fontStyle=b)}M$d(){this.control.vu&&this.menu&&this.control.vu.setAttribute(hf.a.Njh,this.menu.id)}}Object(m.a)(Yf,"ComboBoxBehavior",Pd,[]);class Jg extends Md{constructor(b){super(b)}get NAd(){return this.control}qLc(){let b=
0;this.menu&&this.menu.Nc&&2===this.menu.horizontalAlignment&&(b=this.menu.Nc.clientWidth);return new Sys.UI.Bounds(this.NAd.x-b,this.NAd.y,this.NAd.VAf,this.NAd.UAf)}}Object(m.a)(Jg,"ContextMenuLauncherBehavior",Md,[]);class $h extends Md{constructor(b){super(b)}get zDd(){return this.control}qLc(){return new Sys.UI.Bounds(this.zDd.x,this.zDd.y,this.zDd.VAf,this.zDd.UAf)}}Object(m.a)($h,"DialogMenuLauncherBehavior",Md,[]);var ei=c(619);class rl extends Md{constructor(b){super(b);this.lEe=!1;this.m2j=
!kg.a.aga(this.Rs.ShouldRefreshWhenDropped)}get PCa(){return this.control}get Rs(){return this.control.Gh}gI(b){b=b.Km;Oe.c(b)||(td.a.instance.mb(bb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus")),td.a.instance.mb(bb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur")),Ai.a.instance.mb(bb.a.pointerOver,b,Object(v.a)(this,this.RX,"onPointerOver")),Rb.KeyInputManager.instance.mb(bb.a.hi,b,Object(v.a)(this,this.onKeyDown,"onKeyDown")),Rb.KeyInputManager.instance.mb(bb.a.sh,b,Object(v.a)(this,this.dw,
"onKeyUp")),Ai.a.instance.mb(bb.a.pointerDown,b,Object(v.a)(this,this.fC,"onPointerDown")))}Nl(){Oe.c(this.control.Gh.Command)||(this.PCa.FK&&!this.m2j?this.lEe=!0:(0<(this.Yt(this.Rs.Command,this.Rs.QueryCommand,this.Qd)&2)&&this.M6a()&&this.ZSa(),kg.a.Fr(this.Rs.RefreshableMenu)&&this.FK&&this.menu.yhn()))}ZSa(){this.rxo();this.Cia();this.dyo();this.PCa.nrf=this.Qd[ei.a.ImageIsVisible]}rxo(){const b=kg.a.Wpa(this.Qd[ei.a.LabelText],this.Rs.LabelText),h=this.Qd[ei.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.Rs.LabelTextUserGeneratedPlaceholderReplacements!==h)this.iE.medium&&this.sxo(this.iE.medium.MN,b,h),this.root.j3a=!0,this.control.labelText=b,this.Rs.LabelTextUserGeneratedPlaceholderReplacements=h}sxo(b,h,u){const y=b.lastChild;kg.a.W4i(b,h+" ",u);h=Oe.c(y);w.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":y.nodeType.toString());h||b.appendChild(y)}dyo(){const b=this.Qd[ei.a.ImageBackColor];this.iE.forEach(h=>
{rl.rlk(h.PP,b)})}h_(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(r.AFrameworkApplication.Bga("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),r.AFrameworkApplication.ya.processAction(Wa.a.FDd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||r.AFrameworkApplication.ya.processAction(Wa.a.FDd,2);Object(jb.a)(Yn.a,this.pk)&&(this.FK||this.Q0e(!0),this.control.enabled&&
this.aY());super.h_(b)}kta(){super.kta();this.lEe&&(this.lEe=!1,this.Nl())}RX(b){return this.control.$Fb()?(this.PCa.FK?(this.root.Nph(),kg.a.Zf(this.PCa.NGb,Im.MenuLauncher.ZUc),this.PCa.afa=this.control.vu):(super.RX(b),this.Fw(b.Bf,b.og,b.Ib)),!1):super.RX(b)}onKeyDown(b){let h=!1;if(!Oe.c(b.Ib)&&!Oe.c(b.Ib.rawEvent)){if(Object(jb.a)(Yn.a,this.pk)){const u=b.Ib.rawEvent,y=b.Ib.keyCode,P=0===this.root.g0;u.shiftKey||u.ctrlKey||!(y===Sys.UI.Key.right&&P||y===Sys.UI.Key.left&&!P)||(h=this.Uof(b),
h||(this.Fw(b.Bf,1,b.Ib),h=!0))}h||(h=super.onKeyDown(b))}return h}static rlk(b,h){Oe.c(b)||Oe.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(m.a)(rl,"FlyoutAnchorBehavior",Md,[]);var Bi=c(938);class en extends Mj{constructor(b){super(b)}get i4b(){return this.control}get properties(){return this.i4b.properties}get Fea(){return this.i4b.Fea}gI(b){b=b.OAb;td.a.instance.mb(bb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));td.a.instance.mb(bb.a.blur,b,Object(v.a)(this,this.onBlur,
"onBlur"));Ai.a.instance.mb(bb.a.pointerOver,b,Object(v.a)(this,this.RX,"onPointerOver"));Ai.a.instance.mb(bb.a.pointerOut,b,Object(v.a)(this,this.oO,"onPointerOut"));Rb.KeyInputManager.instance.mb(bb.a.hi,b,Object(v.a)(this,this.onKeyDown,"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.sh,b,Object(v.a)(this,this.dw,"onKeyUp"));Ai.a.instance.mb(bb.a.pointerDown,b,Object(v.a)(this,this.fC,"onPointerDown"));Ai.a.instance.mb(bb.a.nM,b,Object(v.a)(this,this.twa,"onPointerUp"));pn.a.instance.mb(bb.a.GO,
b,Object(v.a)(this,this.Vkb,"onTouchMove"));pn.a.instance.mb(bb.a.vJ,b,Object(v.a)(this,this.rFa,"onTouchEnd"))}Nl(){const b=this.Qd[Bi.a.On],h=this.Qd[Bi.a.IsRtl];this.uqj();if(0<(this.Yt(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)){var u=!Oe.c(this.Qd[Bi.a.InnerHTML])||!Oe.c(this.properties.InnerHTML),y=!Oe.c(this.properties.Image);u||y||(this.control.enabled=!1);y=this.Fea.OAb;if(!Oe.c(y)){if(u){u=kg.a.Wpa(this.Qd[Bi.a.InnerHTML],this.properties.InnerHTML);if(null===y.innerHTML||
null===u||A.a.jh(y.innerHTML)!==A.a.jh(u))y.innerHTML=u;""===u&&(this.control.enabled=!1)}u=y.title;const P=kg.a.Wpa(this.Qd[Bi.a.Alt],this.properties.Alt);P===u||this.control.I4f||(y.title=P)}y=this.Qd[Bi.a.IsRtl];b===this.Qd[Bi.a.On]&&h===y||this.control.OIb()}}uqj(){const b=this.Qd;b[Bi.a.CommandValueId]=this.control.$Bb();b.MenuItemId=this.control.Gh.MenuItemId;b.SourceControlId=this.properties.Id}Fw(b,h,u){if((b=this.pk)&&this.control.enabled){const y=this.root;if(r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.jRc()&&this.uH){const P=y.eC[this.uH.upa];P?P.NRa(this.i4b):w.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.uqj();this.Qd[Bi.a.On]||(this.Qd[Bi.a.On]=!0,this.control.OIb());"Menu"===b.aT&&kg.a.gw(this.Fea.Km,"cui-gallerybutton-focused");y.executeCommand(this.properties.Command,this.Qd,b,h,!0,null,this.Ifa(u))}}onFocus(b){super.onFocus(b);kg.a.Zf(this.Fea.Km,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);kg.a.gw(this.Fea.Km,"cui-gallerybutton-focused");return!1}}Object(m.a)(en,"GalleryButtonBehavior",Mj,[]);var Jm=c(1109),fn=c(1360),Rm=c(649);class Km extends Mj{constructor(b){super(b);this.QVa=-1}get C7b(){return this.control}get properties(){return this.C7b.Gh}get QDc(){return this.C7b.QDc}get Iqf(){var b=null;if(this.pk&&(b=this.pk.parent,!Object(jb.a)(Rm.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get AEb(){return this.C7b.aRd.AEb}get yXc(){return this.C7b.aRd.yXc}Fw(b,
h,u){if(this.control.enabled){b=this.Ejf(this.v4b(b));const y=this.TId(b);this.QDc[fn.a.Rows]=this.mMd(b)+1;this.QDc[fn.a.Columns]=y+1;this.root.executeCommand(this.properties.Command,this.QDc,this.pk,h,!0,null,this.Ifa(u))}}gI(b){var h=b.Km;const u=b.Aqh;b=b.cells;Ai.a.instance.mb(bb.a.pointerOut,h,Object(v.a)(this,this.F2m,"onControlPointerOut"));pn.a.instance.mb(bb.a.GO,h,Object(v.a)(this,this.H2m,"onControlTouchMove"));pn.a.instance.mb(bb.a.vJ,h,Object(v.a)(this,this.G2m,"onControlTouchEnd"));
for(h=0;h<b.length;++h)this.Sok(u[h],b[h])}Sok(b,h){td.a.instance.mb(bb.a.focus,b,Object(v.a)(this,this.DKf,"onCellFocus"));Ai.a.instance.mb(bb.a.pointerOver,h,Object(v.a)(this,this.EKf,"onCellPointerOver"));Ai.a.instance.mb(bb.a.nM,h,Object(v.a)(this,this.FKf,"onCellPointerUp"));Rb.KeyInputManager.instance.mb(bb.a.hi,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.sh,h,Object(v.a)(this,this.dw,"onKeyUp"));pn.a.instance.mb(bb.a.HO,h,Object(v.a)(this,this.C1m,"onCellTouchStart"))}Ejf(b){return parseInt(b.id.substr(this.C7b.id.length+
1))}i9h(b){this.h9h(this.Ejf(b))}mMd(b){return Math.floor(b/Jm.a.WVc)}TId(b){return b%Jm.a.WVc}h9h(b){if(b!==this.QVa){var h=this.TId(b),u=this.mMd(b),y=-1;let P=-1;-1!==this.QVa&&(y=this.mMd(this.QVa),P=this.TId(this.QVa));for(;y!==u||P!==h;)y<u?this.l7i(++y,P,!0):y>u?(this.l7i(y,P,!1),y--):P<h?this.G4i(++P,y,!0):P>h&&(this.G4i(P,y,!1),P--);this.Iqf?this.Iqf.a8i(this.CTh(u+1,h+1)):(u=(h=this.control.V1e)&&0<h.length?h[0]:null,y=this.pk,w.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!u,["FirstCompPar"]:!!u&&!!u.parent,["DispComp"]:!!y,["DispCompPar"]:!!y&&!!y.parent}));this.QVa=b}}l7i(b,h,u){for(let y=0;y<=h;y++)this.x4i(b,y,u)}G4i(b,h,u){for(let y=0;y<=h;y++)this.x4i(y,b,u)}x4i(b,h,u){h=b*Jm.a.WVc+h;b=this.AEb[h];h=this.yXc[h];u?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}FKf(b){this.Fw(b.Bf,b.og,b.Ib);return!0}v4b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return Oe.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}b8i(b){const h=this.Ejf(b);b.childNodes[0].childNodes[0].title=this.CTh(this.mMd(h)+1,this.TId(h)+1)}CTh(b,h){let u=this.properties.Alt;Oe.c(u)&&(u=this.properties.MenuSectionTitle);return u=String.format(u,h.toString(),b.toString())}Jec(){if(this.pk){for(var b=0;b<Jm.a.pbc;b++)this.AEb[b].className="cui-it-inactiveCell",this.yXc[b].className="cui-it-inactiveCellOuter";this.QVa=-1;b=this.properties.MenuSectionInitialTitle;
Oe.c(b)&&(b="");this.Iqf.a8i(b)}}EKf(b){this.control.enabled&&(b=this.v4b(b.Bf),this.x2c(b),this.s9e(b));return!1}s9e(b){this.b8i(b);this.i9h(b)}DKf(b){if(!this.control.enabled)return!1;b=this.v4b(b.Bf);this.b8i(b);this.i9h(b);return!1}F2m(b){Je.a.wxf(this.C7b.aRd.Km,b.clientPoint)||this.Jec();return!1}C1m(b){if(!this.control.enabled)return!1;b=this.v4b(b.Bf);this.s9e(b);return!0}H2m(b){if(!this.control.enabled)return!1;b=Je.a.IJd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.v4b(b))?this.s9e(b):this.Jec();return!0}G2m(b){if(!this.control.enabled)return!1;var h=Je.a.IJd(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.Jec(),!0;(h=this.v4b(h))?this.Fw(h,3,b.Ib):this.Jec();return!0}nK(b){b=vm.Control.Sdf(this.QVa,Jm.a.WVc,Jm.a.pbc,b);if(b!==this.QVa)return this.AEb[b].firstChild.focus(),this.h9h(b),!0;this.Jec();this.QVa=-1;return!1}aY(){const b=this.AEb[0];if(Oe.c(b))return!1;b.firstChild.focus();return!0}x2c(b){if(Oe.c(b))return!1;b.firstChild.firstChild.focus();
return!0}hoa(){this.Jec()}}Object(m.a)(Km,"InsertTableBehavior",Mj,[]);class Bm extends Md{constructor(b){super(b)}Nl(){this.control.enabled=!!this.menu}Fw(b,h,u){r.AFrameworkApplication.ya.Ub(Wa.a.FPa,2,h,this.Ifa(u))}}Object(m.a)(Bm,"JewelMenuLauncherBehavior",Md,[]);var sk=c(1035);class Jn extends Mj{constructor(b){super(b)}get properties(){return this.control.Gh}Nl(){0<(this.Yt(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)&&this.M6a()&&this.ZSa()}ZSa(){this.sBo();this.Cia();
this.LOb()}sBo(){const b=this.control.labelText;let h=this.Qd[sk.a.Value];Oe.c(h)&&(h=this.properties.LabelText,Oe.c(h)&&(h=""));h!==b&&this.xae(h)}gI(b){b=b.Km;Oe.c(b)||(Ai.a.instance.mb(bb.a.pointerDown,b,Object(v.a)(this,this.fC,"onPointerDown")),Ai.a.instance.mb(bb.a.pointerOver,b,Object(v.a)(this,this.RX,"onPointerOver")),Ai.a.instance.mb(bb.a.pointerOut,b,Object(v.a)(this,this.oO,"onPointerOut")))}}Object(m.a)(Jn,"LabelBehavior",Mj,[]);var yg=c(867),Cm=c(217),Ni=c(316);class Ci extends Md{constructor(b){super(b);
this.vxe=this.kpe=!1;this.xTb=this.$Pb=null;if(this.WTb=r.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.$Pb=this.Zt.Eha.LightImage16by16Class,this.xTb=this.Zt.Eha.DarkImage16by16Class}get Zt(){return this.control}B_d(b,h,u,y){h&&(this.Zt.afa=u,r.AFrameworkApplication.ta.Jmb());if(Object(jb.a)(Cm.a,b)&&y){u=new yg.a;u.CommandLocation=this.root.y8;u.InvocationMethod=0;const P={};(b=b.control)&&b.Gh&&(P.CommandId=b.Gh.Command,P.ControlId=b.Gh.Id,P.CloseAllMenus=h,b.uH&&b.uH.parent&&b.uH.parent.id&&
(P.ParentControlId=b.uH.parent.id.split("-")[0]),this.root.ME&&this.root.ME.aNa(y,P,u))}}kta(){this.Zt.afa||(this.Zt.afa=this.Zt.Wx);!this.Zt.GVm&&this.WTb&&(kg.a.gw(this.Zt.Wx,"cui-sb-focus"),kg.a.gw(this.Zt.p0,"cui-sb-focus"),kg.a.gw(this.Zt.oxa,this.$Pb),kg.a.Zf(this.Zt.oxa,this.xTb));this.kpe=!0;super.kta();this.kpe=!1;this.KUf()}get U$i(){return!this.Zt.RQa}m1d(){this.Zt.m1d()}b7d(){this.vxe||this.kpe||(this.vxe=!0,this.Zt.raiseEvent(Ni.a.o1a,null))}KUf(){this.FK||this.Zt.Fsf||(this.vxe=!1,this.Zt.raiseEvent(Ni.a.REb,
null))}KLf(b){kg.a.gw(this.Zt.Wx,"cui-sb-focus");kg.a.gw(this.Zt.p0,"cui-sb-focus");this.WTb&&!this.Zt.FK&&(kg.a.gw(this.Zt.oxa,this.$Pb),kg.a.Zf(this.Zt.oxa,this.xTb));this.Zt.raiseEvent(Ni.a.blur,b);this.KUf();this.Zt.afa=this.Zt.Wx;return!1}LLf(b){kg.a.Zf(this.Zt.Wx,"cui-sb-focus");kg.a.Zf(this.Zt.p0,"cui-sb-focus");this.WTb&&(kg.a.gw(this.Zt.oxa,this.xTb),kg.a.Zf(this.Zt.oxa,this.$Pb));this.Zt.raiseEvent(Ni.a.focus,b);this.b7d();return!1}mNf(){this.WTb&&(kg.a.Zf(this.Zt.p0,"cui-sb-hover"),kg.a.Zf(this.Zt.Wx,
"cui-sb-hover"),kg.a.gw(this.Zt.oxa,this.xTb),kg.a.Zf(this.Zt.oxa,this.$Pb));return!1}lNf(){this.WTb&&(kg.a.gw(this.Zt.p0,"cui-sb-hover"),kg.a.gw(this.Zt.Wx,"cui-sb-hover"),this.Zt.FK||this.Zt.Fsf||(kg.a.gw(this.Zt.oxa,this.$Pb),kg.a.Zf(this.Zt.oxa,this.xTb)));return!1}}Object(m.a)(Ci,"SearchBoxBehavior",Md,[617,615]);class gg{}gg.Value="value";gg.MinValue="MinValue";gg.MaxValue="MaxValue";gg.Text="Text";Object(m.a)(gg,"SliderCommandProperties",null,[]);class oo extends Mj{constructor(b){super(b)}get B6f(){return this.control}get r4(){return this.B6f.r4}get properties(){return this.control.Gh}initialize(){}Fw(){}gI(b){b=
b.fr;td.a.instance.mb(bb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));td.a.instance.mb(bb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur"));td.a.instance.mb(bb.a.change,b,Object(v.a)(this,this.uba,"onChange"));td.a.instance.mb(bb.a.input,b,Object(v.a)(this,this.uba,"onChange"))}onFocus(b){this.r4.Km&&Sys.UI.DomElement.addCssClass(this.r4.Km,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.r4.Km&&Sys.UI.DomElement.removeCssClass(this.r4.Km,"cui-sldr-onfocus");return super.onBlur(b)}uba(){this.SKk(this.r4.fr.value);
return!0}SKk(b){this.Qd[gg.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Qd,this.pk,0,!1)}Nl(){const b=this.Qd[gg.Value],h=this.Qd[gg.MaxValue],u=this.Qd[gg.Text];var y=this.Yt(this.properties.Command,this.properties.QueryCommand,this.Qd);this.r4&&this.r4.fr&&(this.r4.fr.disabled=!this.control.enabled);if(0<(y&2)){y=this.Qd[gg.Value];const P=this.Qd[gg.MaxValue],aa=this.Qd[gg.Text];(P!==h||y!==b||u!==aa)&&this.r4&&this.r4.fr&&(this.r4.fr.setAttribute(hf.a.kwd,String.format("{0}",
P)),this.r4.fr.setAttribute("max",String.format("{0}",P)),this.r4.fr.value=y,this.r4.MN.innerText=this.Qd[gg.Text])}}}Object(m.a)(oo,"SliderBehavior",Mj,[]);var Df=c(1355);class $l extends Mj{constructor(b){super(b);this.Tkd=0;this.Jbb=null;this.$hd=!1;this.F$g=null;this.uMe=!1;this.god=this.tmd=-1;this.Mza=!1}get spinner(){return this.control}get oG(){return this.spinner.oG}get properties(){return this.control.Gh}initialize(){const b=this.spinner.geg;this.F$g=this.mto(b);this.Tkd=b[0].min;this.Jbb=
b[0];this.$hd=!1}Fw(){}gI(b){const h=b.fr,u=b.V2b;b=b.tHc;td.a.instance.mb(bb.a.focus,h,Object(v.a)(this,this.onFocus,"onFocus"));td.a.instance.mb(bb.a.blur,h,Object(v.a)(this,this.onBlur,"onBlur"));Rb.KeyInputManager.instance.mb(bb.a.hi,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.St,h,Object(v.a)(this,this.gG,"onKeyPress"));Rb.KeyInputManager.instance.mb(bb.a.sh,h,Object(v.a)(this,this.dw,"onKeyUp"));td.a.instance.mb(bb.a.change,h,Object(v.a)(this,this.uba,
"onChange"));Re.a.instance.mb(bb.a.rba,h,Object(v.a)(this,this.NLf,"onInputMouseUp"));Ai.a.instance.mb(bb.a.pointerDown,u,Object(v.a)(this,this.DCi,"onArrowPointerDown"));Ai.a.instance.mb(bb.a.pointerDown,b,Object(v.a)(this,this.DCi,"onArrowPointerDown"));Ai.a.instance.mb(bb.a.nM,u,Object(v.a)(this,this.ECi,"onArrowPointerUp"));Ai.a.instance.mb(bb.a.nM,b,Object(v.a)(this,this.ECi,"onArrowPointerUp"));pn.a.instance.mb(bb.a.GO,u,Object(v.a)(this,this.GCi,"onArrowTouchMove"));pn.a.instance.mb(bb.a.GO,
b,Object(v.a)(this,this.GCi,"onArrowTouchMove"));pn.a.instance.mb(bb.a.vJ,u,Object(v.a)(this,this.FCi,"onArrowTouchEnd"));pn.a.instance.mb(bb.a.vJ,b,Object(v.a)(this,this.FCi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);kg.a.Zf(this.oG.Km,"cui-spn-focus");this.control.enabled&&Je.a.M1c(this.oG.fr);return this.Mza=!1}onBlur(b){super.onBlur(b);kg.a.gw(this.oG.Km,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!Oe.c(b.Ib)&&!Oe.c(b.Ib.rawEvent)){const u=b.Ib.keyCode,y=b.Ib.rawEvent.shiftKey;if(u===
Sys.UI.Key.up||u===Sys.UI.Key.down)this.root.Guf(this.control)||this.tej(u===Sys.UI.Key.up,b.og),h=!0;else if(u===Sys.UI.Key.enter)this.ES(),Object(jb.a)(Xe.Ribbon,this.root)&&this.root.DZ(),h=!0;else if(u===Sys.UI.Key.tab)this.ES(),Object(jb.a)(Xe.Ribbon,this.root)&&(h=this.root.lje(this.pk.Nc,!y));else if(u===Sys.UI.Key.esc)this.Lec(),Object(jb.a)(Xe.Ribbon,this.root)&&this.root.DZ(),h=!0;else if(u===Sys.UI.Key.backspace||u===Sys.UI.Key.del)h=!this.control.enabled}return h}gG(){return!this.control.enabled}dw(){this.o_k();
return!1}uba(){this.ES();return!1}NLf(){return this.Mza?!1:this.Mza=!0}DCi(b){var h=!1;let u=!0;2===b.og&&(u=b.pba===Sys.UI.MouseButton.leftButton);u&&(h=b.Bf,this.tej(h===this.oG.V2b||h===this.oG.IIh||h===this.oG.HIh,b.og),h=!0);return h}ECi(b){return this.Mta(b)}GCi(b){return this.Y_d(b)}FCi(b){return this.Mta(b)}Jam(b){if(this.control.enabled){var h=!1;if(!this.$hd){var u=this.hGl(b);u=b?u+this.Jbb.step:u-this.Jbb.step;u=Math.min(u,this.Jbb.max);u=Math.max(u,this.Jbb.min);u!==this.Tkd&&(this.I1e(u,
this.Jbb),this.root.executeCommand(this.properties.Command,this.Qd,this.pk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,u=this.Qd,u.Increment=b,Oe.c(h)||this.root.executeCommand(h,u,this.pk,0,!1))}}hGl(b){const h=Math.pow(10,r.AFrameworkApplication.numberFormat.J_d),u=Math.round(this.Jbb.step*h);let y=Math.round(this.Tkd*h)/u;y=b?Math.floor(y):Math.ceil(y);return y*u/h}tej(b,h){if(this.control.enabled){this.ES();const u=b?this.oG.V2b:this.oG.tHc;switch(h){case 2:case 3:this.uMe=b;this.aud(u);break;
case 1:this.uMe=b,this.T8j(u)}}}Yej(){this.Oph();this.$Ak()}ODh(){-1===this.tmd&&(this.tmd=window.setTimeout(Object(v.a)(this,this.OHn,"repeatSpin"),500))}Oph(){this.tmd=kg.a.Jyb(this.tmd)}OHn(){this.Oph();-1===this.god&&(this.kde(),this.god=window.setInterval(Object(v.a)(this,this.kde,"spin"),50))}$Ak(){this.god=kg.a.WAk(this.god)}kde(){this.Jam(this.uMe)}T8j(b){this.root.uea(this.control,!1);kg.a.Zf(b,vm.Control.dud);this.kde();this.ODh()}o_k(){this.root.jaa(this.control,!1);this.Yej();kg.a.gw(this.oG.V2b,
vm.Control.dud);kg.a.gw(this.oG.tHc,vm.Control.dud)}jgc(b){this.oG.fr.value!==b&&(this.oG.fr.value=b)}Lec(){this.jgc(this.Qd[Df.a.Text])}Z4i(b){this.jgc(b);this.Qd[Df.a.Text]=b;this.$hd=!0}vWn(b,h,u){this.jgc(u);this.Qd[Df.a.Text]=u;this.Qd[Df.a.Number]=b;this.Qd[Df.a.UnitType]=h.type;this.Tkd=b;this.Jbb=h;this.oG.fr.setAttribute(hf.a.tWe,u);this.oG.fr.setAttribute(hf.a.Ujh,String.format("{0}",h.min));this.oG.fr.setAttribute(hf.a.kwd,String.format("{0}",h.max));this.$hd=!1}fvh(b){var h;if(({JYm:h}=
this.twm(b)).returnValue)this.Z4i(h);else{({number:b,x6a:h}=A.a.JKi(b,this.F$g,r.AFrameworkApplication.numberFormat));let u=this.che(h);0===h&&Oe.c(u)&&(u=this.che(this.Qd[Df.a.UnitType]));this.I1e(b,u)}}I1e(b,h){b=this.UIf(b,h);if(isNaN(b)||Oe.c(h))this.Lec();else{const u=r.AFrameworkApplication.numberFormat;let y;y=A.a.SCa(b,h.type,u);y=y.replace(6===h.type?u.K_d:u.hQf,"");this.vWn(b,h,y)}}twm(b){let h,u=!1;h="";b=b.trim();const y=this.spinner.Vrj;if(!Oe.c(y))for(let P=0;P<y.length;P++)if(y[P].toLowerCase()===
b.toLowerCase()){h=y[P];u=!0;break}return{returnValue:u,JYm:h}}UIf(b,h){return isNaN(b)||Oe.c(h)?Number.NaN:h.UIf(b)}che(b){let h=null;const u=this.spinner.geg;for(let y=0;y<u.length;y++)if(u[y].type===b){h=u[y];break}return h}mto(b){const h=b.length,u=Array(h);for(let y=0;y<h;y++)u[y]=b[y].type;return u}ES(){if(this.control.enabled){const b=this.Qd[Df.a.Text],h=this.oG.fr.value;h!==b&&(this.fvh(h),this.Qd[Df.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Qd,this.pk,0,!1))}else this.Lec()}Nl(){var b=
this.Qd[Df.a.Text],h=this.Qd[Df.a.Number];const u=this.Qd[Df.a.UnitType],y=this.Qd[Df.a.MaxValue];if(0<(this.Yt(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)){const P=this.Qd[Df.a.Text],aa=this.Qd[Df.a.Number],ta=this.Qd[Df.a.UnitType],Pa=this.Qd[Df.a.MaxValue];Pa!==y&&(this.che(ta).max=Pa,this.oG.fr.setAttribute(hf.a.kwd,String.format("{0}",Pa)));P!==b?""===P?this.Z4i(P):this.fvh(P):isNaN(aa)||aa===h&&ta===u||this.I1e(aa,this.che(ta));b=this.oG.Km.title;h=kg.a.Wpa(this.Qd[Df.a.Alt],
this.properties.Alt);h!==b&&(this.oG.fr.title=h,this.oG.V2b.title=h,this.oG.tHc.title=h)}}QRe(b){super.QRe(b);b?(this.kde(),this.ODh()):this.Yej()}}Object(m.a)($l,"SpinnerBehavior",Mj,[616,615]);var sl=c(321),Eg=c(879);class To extends Md{constructor(b){super(b);this.UUb=!0;this.dqb=!1}get s4(){return this.control}get Rs(){return this.s4.properties}gI(b){const h=b.Km,u=b.Keb;b=b.vHc;td.a.instance.mb(bb.a.focus,h,Object(v.a)(this,this.onFocus,"onFocus"));td.a.instance.mb(bb.a.blur,h,Object(v.a)(this,
this.onBlur,"onBlur"));Rb.KeyInputManager.instance.mb(bb.a.hi,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.sh,h,Object(v.a)(this,this.dw,"onKeyUp"));ba.a.jt&&16>this.iBl()&&(Ai.a.instance.mb(bb.a.pointerDown,h,Object(v.a)(this,this.qHi,"onSplitbuttonPointerDownPointerUp")),Ai.a.instance.mb(bb.a.nM,h,Object(v.a)(this,this.qHi,"onSplitbuttonPointerDownPointerUp")));Ai.a.instance.mb(bb.a.pointerOver,u,Object(v.a)(this,this.o1m,"onButtonPointerOver"));Ai.a.instance.mb(bb.a.pointerOut,
u,Object(v.a)(this,this.n1m,"onButtonPointerOut"));Ai.a.instance.mb(bb.a.pointerDown,u,Object(v.a)(this,this.UCi,"onButtonPointerDown"));Ai.a.instance.mb(bb.a.nM,u,Object(v.a)(this,this.VCi,"onButtonPointerUp"));pn.a.instance.mb(bb.a.GO,u,Object(v.a)(this,this.q1m,"onButtonTouchMove"));pn.a.instance.mb(bb.a.vJ,u,Object(v.a)(this,this.p1m,"onButtonTouchEnd"));Ai.a.instance.mb(bb.a.pointerDown,b,Object(v.a)(this,this.lMf,"onMenuButtonPointerDown"));Ai.a.instance.mb(bb.a.pointerOver,b,Object(v.a)(this,
this.Y5m,"onMenuButtonPointerOver"));Ai.a.instance.mb(bb.a.pointerOut,b,Object(v.a)(this,this.X5m,"onMenuButtonPointerOut"))}Fw(b,h,u){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.dqb&&(this.s4.on=!this.s4.on,b=this.Qd,b.CommandValueId=this.control.$Bb(),this.root.executeCommand(this.Rs.Command,b,this.pk,h,!0,null,this.Ifa(u))):this.UUb&&super.Fw(b,h,u)}dw(b){const h=b.Ib.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Qd,b.CommandValueId=this.control.$Bb(),this.root.executeCommand(this.Rs.Command,
b,this.pk,1,!0),!0):super.dw(b)}Nl(){const b=this.root.Coa(this.Rs.Command,this.Rs.QueryCommand,this.Qd),h=0<(b&1);let u=!0;u=Oe.c(this.Rs.CommandMenuOpen)?h:0<(this.root.Coa(this.Rs.CommandMenuOpen,null,null)&1);if(u!==this.UUb||h!==this.dqb||(u||h)!==this.control.enabled)this.control.enabled=u||h,h!==this.dqb&&this.w3m(h),u!==this.UUb&&this.x3m(u),this.UUb=u,this.dqb=h;if(0<(b&2)){this.Cia();const y=kg.a.Wpa(this.Qd[Eg.a.LabelText],this.Rs.LabelText);this.Qd[Eg.a.ApplyLabelTextToControlOnly]?this.s4.X3b(P=>
{P.Km.title=y;P.Keb.removeAttribute("title");P.vHc.removeAttribute("title")}):this.s4.X3b(P=>{P.Keb.title=y});this.Qd[Eg.a.EnsureControlRoleIsButton]&&this.s4.X3b(P=>{hf.a.Tq(P.Km,hf.a.wh,hf.a.l2)});Oe.c(this.Qd[Eg.a.Visible])||this.M6a()&&this.ZSa()}this.s4.setState(this.s4.on&&h)}ZSa(){this.Kcg();this.LOb();this.Cia()}x3m(b){this.s4.X3b(h=>{kg.a.Imb(h.vHc,b)});this.X_c();this.UUb=b}w3m(b){this.s4.X3b(h=>{kg.a.Imb(h.Keb,b)});this.X_c();this.dqb=b}X_c(){const b=this.s4.ggb();Oe.c(b)||(kg.a.gw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),kg.a.gw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),kg.a.gw(b.childNodes[1],"cui-ctl-split-hovered-primary"),kg.a.gw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}qHi(b){if(0!==sl.a(b.Ib))return!1;let h=!1;b.eventName===bb.a.pointerDown?h=this.UCi(b):b.eventName===bb.a.nM&&(h=this.VCi(b));return h}UCi(b){let h=!1;const u=b.og;switch(u){case 3:this.T8n()?this.Fw(this.pk.Nc,u,b.Ib):this.aud(this.s4.qGh);h=!0;break;case 2:b.pba===Sys.UI.MouseButton.leftButton&&
(this.aud(this.s4.qGh),h=!0)}h&&b.Ib.preventDefault();return!1}T8n(){const b=this.pk.aT;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}VCi(b){return this.Mta(b)}q1m(b){return this.Y_d(b)}p1m(b){return this.Mta(b)}onFocus(b){super.onFocus(b);this.vqf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.X_c();return!1}o1m(){this.control.enabled&&this.dqb&&this.vqf(!0,this.s4.on);return!1}n1m(){this.control.enabled&&this.dqb&&this.X_c();return!1}lMf(b){let h=!1;if(2!==b.og||b.pba===Sys.UI.MouseButton.leftButton)this.Fw(b.Bf,
b.og,b.Ib),h=!0;h&&b.Ib.preventDefault();return!1}Y5m(){this.control.enabled&&this.UUb&&this.vqf(this.s4.on,!0);return!1}X5m(){this.X_c();return!1}vqf(b,h){const u=this.control.ggb();Oe.c(u)||(kg.a.Zf(u.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),kg.a.Zf(u.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}iBl(){var b=ba.a.K2b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(m.a)(To,"SplitButtonBehavior",Md,[]);
var Yk=c(1359);class wm extends Mj{constructor(b){super(b);this.Ksb=this.Mza=!1;this.aLj=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Hca(){return this.textBox.Hca}get F9f(){return this.textBox.Gh}gI(b){b=b.fr;td.a.instance.mb(bb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));td.a.instance.mb(bb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur"));Rb.KeyInputManager.instance.mb(bb.a.hi,b,Object(v.a)(this,this.onKeyDown,
"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.St,b,Object(v.a)(this,this.gG,"onKeyPress"));Rb.KeyInputManager.instance.mb(bb.a.sh,b,Object(v.a)(this,this.dw,"onKeyUp"));td.a.instance.mb(bb.a.change,b,Object(v.a)(this,this.uba,"onChange"));Re.a.instance.mb(bb.a.rba,b,Object(v.a)(this,this.uQa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.Ksb=!0;kg.a.Zf(this.Hca.Km,"cui-tb-focus");this.control.enabled&&Je.a.M1c(this.Hca.fr);return this.Mza=!1}onBlur(b){this.Ksb=!1;super.onBlur(b);kg.a.gw(this.Hca.Km,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!Oe.c(b.Ib)&&!Oe.c(b.Ib.rawEvent)){const u=b.Ib.keyCode,y=b.Ib.rawEvent.shiftKey;u===Sys.UI.Key.tab?(this.ES(),Object(jb.a)(Xe.Ribbon,this.root)&&(h=this.root.lje(this.pk.Nc,!y))):u===Sys.UI.Key.enter?this.aLj&&(this.ES(),Object(jb.a)(Xe.Ribbon,this.root)&&this.root.DZ(),h=!0):u===Sys.UI.Key.esc?(this.Lec(),Object(jb.a)(Xe.Ribbon,this.root)&&this.root.DZ(),h=!0):u===Sys.UI.Key.backspace||u===Sys.UI.Key.del?h=!this.control.enabled:b.jla&&
(rf.a.Kph(b.Ib),h=!1)}return h}gG(){return!this.control.enabled}dw(){return!1}uba(){this.ES();return!1}uQa(){return this.Hca.isEditable?this.Mza?!1:this.Mza=!0:(Je.a.M1c(this.Hca.fr),!0)}jgc(b){this.Hca.fr.value!==b&&(this.Hca.fr.value=b)}Lec(){this.jgc(this.Qd[Yk.a.Text])}ES(){if(this.control.enabled&&this.Hca.isEditable){const b=this.Hca.fr.value;b!==this.Qd[Yk.a.Text]&&(this.Qd[Yk.a.Text]=b,this.root.executeCommand(this.F9f.Command,this.Qd,this.pk,0,!1))}else this.Lec()}Nl(){const b=this.Qd[Yk.a.Text];
if(0<(this.Yt(this.F9f.Command,this.F9f.QueryCommand,this.Qd)&2)&&!this.Ksb){const h=this.Qd[Yk.a.Text];h!==b&&this.jgc(h)}}}Object(m.a)(wm,"TextBoxBehavior",Mj,[614,615]);var tl=c(428);class Dh extends Mj{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Gh}Fw(b,h,u){this.control.enabled&&(kg.a.aga(this.properties.TogglesWhenExecuted)||this.toggle(),this.Qd.CommandValueId=this.toggleButton.$Bb(),this.Qd.MenuItemId=this.toggleButton.Gh.MenuItemId,
this.Qd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Qd,this.pk,h,!kg.a.aga(this.properties.CloseMenuWhenExecuted),y=>{kg.a.Fr(this.properties.UpdateHtmlPostToggle)&&(32===y?this.Tij():this.Rij())},this.Ifa(u)))}Rij(){this.Qd[ag.a.On]=!this.Qd[ag.a.On]}Tij(){this.toggleButton.setState(this.Qd[ag.a.On]);(this.toggleButton.gya&&this.toggleButton.hie||kg.a.Fr(this.properties.UpdateHtmlPostToggle))&&this.ZSa()}toggle(){this.Rij();kg.a.Fr(this.properties.UpdateHtmlPostToggle)||
this.Tij()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!Oe.c(b.Ib)&&this.uH){const u=b.Ib.keyCode;u!==Sys.UI.Key.enter&&u!==Sys.UI.Key.space||b.Ib.preventDefault()}return h}Nl(){Oe.c(this.properties.MenuItemId)||(this.Qd.MenuItemId=this.properties.MenuItemId);0<(this.Yt(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)&&this.M6a()&&this.ZSa()}ZSa(){this.toggleButton.setState(this.Qd[ag.a.On]);this.Rwo(kg.a.Wpa(this.Qd[ag.a.DisplayMode],""));this.Kcg();this.Cia();this.Ayo();ag.a.Alt in
this.Qd&&this.LOb()}Ayo(){const b=this.iE.v$b;if(b&&b.Leb){var h=kg.a.Wpa(this.Qd[ag.a.Description],this.properties.Description);h!==b.Leb.innerText&&(b.Leb.innerText=h,b.MN&&!Object(jb.a)(tl.Jewel,this.root)&&(h=!Oe.b(h),kg.a.D4(b.MN,"UIFontBold",h),kg.a.D4(b.MN,"cui-ctl-mediumlabel-nodescription",!h)))}}gI(b){b=b.Km;td.a.instance.mb(bb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));td.a.instance.mb(bb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur"));Ai.a.instance.mb(bb.a.pointerOver,b,Object(v.a)(this,
this.RX,"onPointerOver"));Ai.a.instance.mb(bb.a.pointerOut,b,Object(v.a)(this,this.oO,"onPointerOut"));Rb.KeyInputManager.instance.mb(bb.a.hi,b,Object(v.a)(this,this.onKeyDown,"onKeyDown"));Rb.KeyInputManager.instance.mb(bb.a.sh,b,Object(v.a)(this,this.dw,"onKeyUp"));Ai.a.instance.mb(bb.a.pointerDown,b,Object(v.a)(this,this.fC,"onPointerDown"));Ai.a.instance.mb(bb.a.nM,b,Object(v.a)(this,this.twa,"onPointerUp"));th.a.instance.mb(bb.a.click,b,Object(v.a)(this,this.onClick,"onClick"));pn.a.instance.mb(bb.a.GO,
b,Object(v.a)(this,this.Vkb,"onTouchMove"));pn.a.instance.mb(bb.a.vJ,b,Object(v.a)(this,this.rFa,"onTouchEnd"))}}Object(m.a)(Dh,"ToggleButtonBehavior",Mj,[]);class Lk{constructor(b){this.zHj=b;this.Ste={["Button"]:h=>new dn(h),["FileMenuButton"]:h=>new dn(h),["ColorPicker"]:h=>new Xk(h),["ComboBox"]:h=>new Yf(h),["ContextMenuControl"]:h=>new Jg(h),["ContextMenuLauncher"]:h=>new Jg(h),["DialogMenuLauncher"]:h=>new $h(h),["DropDown"]:h=>new Pd(h),["FlyoutAnchor"]:h=>new rl(h),["GalleryButton"]:h=>new en(h),
["StatefulColorFlyoutAnchor"]:h=>new rl(h),["JewelMenuLauncher"]:h=>new Bm(h),["Label"]:h=>new Jn(h),["Placeholder"]:h=>new Mj(h),["SearchBox"]:h=>new Ci(h),["Separator"]:h=>new Mj(h),["SplitButton"]:h=>new To(h),["StatefulColorSplitButton"]:h=>new To(h),["StatefulImageSplitButton"]:h=>new To(h),["TextBox"]:h=>new wm(h),["ToggleButton"]:h=>new Dh(h)}}eJh(){this.Ste[vm.Control.Bei]=b=>new Km(b)}daf(){this.Ste[vm.Control.qdj]=b=>new $l(b)}Htl(b){const h=this.Ste[b.controlType];(b=h?h(b):null)&&this.zHj&&
b.kal();return b}static get instance(){return Lk._instance||(Lk._instance=new Lk(!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Lk._instance=null;Object(m.a)(Lk,"ControlBehaviorFactory",null,[579]);var tk=c(962),tp=c(169);class Jp extends Im.MenuLauncher{constructor(b,h,u,y){super(b,h,u,y);this.tUg=null;this.wLa=this.Uzc=0;this.ME=null;this.ptc=this.otc=0;this.lh("Menu");this.enabled=!0}get x(){return this.Uzc}get y(){return this.wLa}get UAf(){return this.otc}get VAf(){return this.ptc}get controlType(){return"DialogMenuLauncher"}g5a(){}B6a(){}Xgf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Rs.DialogMoveCommand;b.DialogCloseCommand=this.Rs.DialogCloseCommand;return b}QBm(b,h){this.Uzc=b.x;this.wLa=b.y;this.otc=b.height;this.ptc=b.width;this.h_(h)}IP(b){this.tUg=kg.a.createElement("span");return new tp.a(b,this.tUg)}get Rs(){return this.Gh}qta(b,h,u){return new Jp(b,this.id,h,u)}}Object(m.a)(Jp,"DialogMenuLauncher",Im.MenuLauncher,[]);var zo=c(813);class Oq extends tk.a{constructor(b,h){super(b,h);this.I7a=null}get TRe(){return this.I7a}get iFh(){return this.properties}get y8(){return 20}sm(){super.sm();
Oe.c(this.Nc)&&this.VB();this.Nc=kg.a.oRa(this.Nc);this.pW(this.Nc);this.dirty=!1}ON(b){if(!Object(jb.a)(zo.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}i4e(b,h,u,y){u=new So.Menu(this,h,u,y,null);b||(b={});b.CommandMenuOpen=this.iFh.CommandMenuOpen;b.CommandMenuClose=this.iFh.CommandMenuClose;b=new Jp(this,h,b,u);this.Pzb[h]=b;h=new zo.a(this,"dock"+h);h.Qf(b.JP("Menu"));this.Qf(h);this.refresh()}y5f(b,h,u,y){const P=this.Pzb[b];if(Oe.c(P))throw Error.create('The dialog menu "'+
b+'" does not exist');P.QBm(new Sys.UI.Bounds(h,u,0,0),y);this.I7a=P.menu}R0e(b){b=this.Pzb[b];Oe.c(b)||(b.kta(),this.I7a=null)}n1d(){this.I7a=null}dispose(){const b=this.Pzb;for(let h in b)b[h].dispose();super.dispose()}}Object(m.a)(Oq,"DialogMenuRoot",tk.a,[]);class xq{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(m.a)(xq,"RootProperties",null,[]);class Hl extends xq{constructor(){super()}}Object(m.a)(Hl,"StandaloneRootProperties",xq,[]);class gj extends Hl{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(m.a)(gj,"DialogMenuRootProperties",Hl,[]);class Vd{constructor(){const b=new gj;b.ImageSideArrow=r.AFrameworkApplication.Cr;b.ImageSideArrowClass=Gd.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=r.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ad=new Oq("DialogMenuRootId",b);this.Ad.ME=this;this.Ad.refresh();r.AFrameworkApplication.ya.gb(Wa.a.UQf,le.a.frame,Object(v.a)(this,this.UQf,"populateDialogMenu"),96)}get l0(){return this.Ad}aNa(b,h,u,y,P=null){b=parseInt(b);y=r.AFrameworkApplication.ya;
u&&(y.bH=u.CommandLocation,y.t7=u.InvocationMethod);h=y.Ub(b,2,h,P);this.Ad.refresh();return 32===h}tEa(b){return b?32===r.AFrameworkApplication.ya.processAction(parseInt(b),1):!0}Yt(){this.l0.root.Nl()}i4e(b,h,u){const y={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};y.DialogMoveCommand=h;y.DialogCloseCommand=u;this.l0.i4e(y,b,"","")}y5f(b,h,u,y){this.l0.y5f(b,h,u,y)}R0e(b){this.l0.R0e(b)}UQf(b,h,u,y,P){if(1===u)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',P.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',P.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");P.PopulationXML=b.toString();return 32}dispose(){this.Ad&&
(this.Ad.dispose(),this.Ad=null)}}Object(m.a)(Vd,"DialogMenuRootUser",null,[355,9,542]);class Ao{constructor(b,h,u){this.Mqb=this.Fqd=this.ruc=this.Xl=null;this.zxe=this.Upd=!1;this.rqc=b;this.ie=h;this.Rr=u;this.VTb=r.AFrameworkApplication.isRtl}get Frf(){return this.zxe}Ncl(b){b?(this.Xl=b,this.zxe=!0,this.Upd=!1,this.ie.capture(Object(v.a)(this,this.AAm,"keyEventHandler"),null),this.Rr.mb(bb.a.pointerDown,this.rqc,Object(v.a)(this,this.edc,"pointerDownHandler")),this.ruc||this.VUk(),this.Xl.appendChild(this.ruc),
this.idm()):w.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}Jbf(){this.zxe=!1;this.Fqd=this.Mqb=null;this.bEn();this.JWf();this.Xl=null}JWf(){this.ie.releaseCapture();this.Rr.sc(bb.a.pointerDown,this.rqc,Object(v.a)(this,this.edc,"pointerDownHandler"))}idm(){if(this.Xl.style.left.endsWith("px")&&this.Xl.style.right.endsWith("px"))this.Mqb=new Sys.UI.Point(Kk.a.VX(this.VTb?this.Xl.style.right:this.Xl.style.left),Kk.a.VX(this.Xl.style.top));else{const b=this.VTb?this.rqc.offsetWidth-
(this.Xl.offsetLeft+this.Xl.offsetWidth+Kk.a.VX(this.Xl.style.marginRight)):this.Xl.offsetLeft-Kk.a.VX(this.Xl.style.marginLeft),h=this.Xl.offsetTop-Kk.a.VX(this.Xl.style.marginTop);this.H7i(b,h);this.Mqb=new Sys.UI.Point(b,h)}this.Fqd=this.Mqb}VUk(){this.ruc=Gd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}bEn(){this.ruc.parentNode===this.Xl&&this.Xl.removeChild(this.ruc)}AAm(b){if(!this.Frf)return!1;b.Ib.preventDefault();if(b.eventName===bb.a.hi){const h=b.Ib.ctrlKey?
1:10;let u;switch(b.Ib.keyCode){case fb.a.f9:this.Tac(0,-1*h);break;case fb.a.Fia:this.Tac(0,1*h);break;case fb.a.XOb:u=this.VTb?1:-1;this.Tac(u*h,0);break;case fb.a.YOb:u=this.VTb?-1:1;this.Tac(u*h,0);break;case fb.a.Q6a:this.Ryi(this.Fqd.x,this.Fqd.y);this.Upd=!0;break;case fb.a.us:this.Upd=!0}}b.eventName===bb.a.sh&&this.Upd&&this.Jbf();return!0}edc(b){if(!this.Frf)return!1;b.Ib.preventDefault();this.Jbf();return!0}Tac(b,h){this.Ryi(this.Mqb.x+b,this.Mqb.y+h)}Ryi(b,h){b=this.Nhk(b,h);this.H7i(b.x,
b.y);this.Mqb=b}H7i(b,h){this.VTb?this.Xl.style.right=b+"px":this.Xl.style.left=b+"px";this.Xl.style.top=h+"px"}Nhk(b,h){const u=this.VTb?Kk.a.VX(this.Xl.style.marginRight):Kk.a.VX(this.Xl.style.marginLeft),y=Kk.a.VX(this.Xl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-u,b),this.rqc.offsetWidth-this.Xl.offsetWidth-u),Math.min(Math.max(-y,h),this.rqc.offsetHeight-this.Xl.offsetHeight-y))}}Object(m.a)(Ao,"KeyMoveAdapter",null,[543]);var mb=c(1098),hc=c(569);class Nc{get name(){return"CUI.Behavior"}xc(b){r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(542,"Common.UI.IDialogMenuRootUser").singleInstance().Xd(()=>new Vd),b.register(543,"Common.IKeyMoveAdapter").singleInstance().Xd(()=>new Ao(r.AFrameworkApplication.ta.oma(),Rb.KeyInputManager.instance,Ai.a.instance)));b.register(hc.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Xd(()=>hc.a.instance)}init(){mb.a.c3e=Lk.instance;const b=hc.a.instance.S_i;for(let h=0;h<b.length;++h){const u=Object(na.a)(544,
b[h]);u&&u.UMa()}Zh.a.get_instance().PK(6)}dispose(){}static main(){K.a.instance.Kc(new Nc,5)}}Object(m.a)(Nc,"CuiBehaviorPackage",null,[1,2]);class ed{constructor(b){const h=new Hl;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Gd.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Gd.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Gd.getImageClass("RibbonUpArrow_8x8x32");
h.ImageDownArrow8by8Class=Gd.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Gd.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Gd.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=Gd.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=r.AFrameworkApplication.isRtl?"rtl":"ltr";this.zw=tk.a.lXk(h);this.zw.refresh()}get L8(){return this.zw}dispose(){this.zw.dispose()}}Object(m.a)(ed,"StandaloneRootController",null,[848,9]);var Ed=c(1124),ke=
c(239);class Lf{constructor(b){this.Lwc=b}create(b,h){const u=new Sys.StringBuilder;this.vFc(u,b,h);this.D4e(u,b);return u.toString()}Vdb(b,h){const u=[];this.o5e(u,b,h);this.E4e(u,b);return u}vFc(b,h,u){switch(h.errorType){case 0:b.append(this.Lwc.build());break;case 1:case 2:b.append(this.MYe(h,u))}}o5e(b,h,u){switch(h.errorType){case 0:b.push(this.Lwc.pnh());break;case 1:case 2:b.push(this.nuk(h,u))}}D4e(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(ke.a("btnIgrnoreSpellingError",
(2===h.errorType?Oa.a.rHa:Oa.a.cva).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}E4e(b,h){const u=Object.assign(new xi.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";u.ControlList.push(Object.assign(new Qe.a,{ExternalId:h}));b.push(u)}MYe(b,h){b=this.rql(b.suggestions,h);return 0<b.length?ke.h("msUnknownWord",ke.d(null,b),"Menu16"):ke.h("msUnknownWord",ke.d(null,[ke.a("btnNoSuggestions",Oa.a.rHa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,
null)]),"Menu16")}rql(b,h){const u=[];if(b){const y=Math.min(h.length,b.length);for(let P=0;P<y;++P)b[P]&&u.push(ke.a("btnCorrectWord"+P,h[P].toString(),b[P]))}return u}nuk(b,h){const u=Object.assign(new xi.a,{Id:"Suggestions",ControlList:[]});this.qql(b.suggestions,h,u.ControlList);0>=u.ControlList.length&&(b=Object.assign(new Qe.a,{ExternalId:"NoSuggestions"}),u.ControlList.push(b));return u}qql(b,h,u){if(b){const y=Math.min(h.length,b.length);for(let P=0;P<y;++P){if(!b[P])continue;const aa=Object.assign(new Qe.a,
{ExternalId:"btnCorrectWord"+P,Command:h[P].toString(),LabelText:b[P]});u.push(aa)}}}}Object(m.a)(Lf,"DefaultProofingContextMenuCreator",null,[]);var Gf=c(712);class Cg{constructor(b,h){this.DGg=b;this.AIg=h;this.oka=[Oa.a.Xnb,Oa.a.Ynb,Oa.a.Znb,Oa.a.HNb,Oa.a.INb]}create(b,h){return h?Object(jb.a)(Gf.a,h)?this.AIg.create(b,h,this.oka):this.DGg.create(h,this.oka):""}x1b(b,h){return h?Object(jb.a)(Gf.a,h)?this.AIg.Vdb(b,h,this.oka):this.DGg.Vdb(h,this.oka):null}}Object(m.a)(Cg,"ProofingContextMenuSectionFactory",
null,[680]);class Uh{build(){const b=[ke.a("btnDeleteRepeatedWord",Oa.a.pCa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return ke.h("msRepeatedWord",ke.d(null,b),"Menu16")}pnh(){const b=Object.assign(new xi.a,{ControlList:[]}),h=Object.assign(new Qe.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(m.a)(Uh,"ProofingRepeatedWordSectionBuilder",null,[679]);class nj{static get Hg(){return ff.a.Sy(nj.am,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,
Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}nj.am="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(m.a)(nj,"AutoCorrectOptionsDialogHTML",null,[]);class ah{static get Hg(){return ff.a.Sy(ah.am,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}ah.am="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(m.a)(ah,"AutoCorrectOptionsDialogHTML2",null,[]);class ul extends ff.a{constructor(b,h){super();this.mVn=(u,y)=>{1!==u?w.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):y.ReplaceTextAsYouType!==this.aV.tRa||y.CapitalizeFirstLetterOfSentences!==this.aV.Uxd||y.ReplaceOrdianalsWithSuperscript!==this.aV.D8d||y.ReplaceHyphensWithDash!==this.aV.A0c||y.ReplaceFractionsWithFractionCharacter!==this.aV.C8d||this.Mda&&y.ReplaceQuoteWithSmartQuote!==
this.aV.EYf?(u={},u.ReplaceTextAsYouType=y.ReplaceTextAsYouType,u.CapitalizeFirstLetterOfSentences=y.CapitalizeFirstLetterOfSentences,u.ReplaceOrdianalsWithSuperscript=y.ReplaceOrdianalsWithSuperscript,u.ReplaceHyphensWithDash=y.ReplaceHyphensWithDash,u.ReplaceFractionsWithFractionCharacter=y.ReplaceFractionsWithFractionCharacter,this.Mda&&(u.ReplaceQuoteWithSmartQuote=y.ReplaceQuoteWithSmartQuote),this.aV.mPn(u),w.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:y.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:y.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:y.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:y.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:y.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Mda,["ReplaceQuoteWithSmartQuote"]:this.Mda&&y.ReplaceQuoteWithSmartQuote}),Ra.App.xa.updateCommandUI(!0)):w.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.aV=b;this.Mda=h;this.mg="AutoCorrectOptionsDialog"}P5f(){w.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Hg=this.Mda?ah.Hg:nj.Hg;const b={};b.ReplaceTextAsYouType=this.aV.tRa;b.CapitalizeFirstLetterOfSentences=this.aV.Uxd;b.ReplaceOrdianalsWithSuperscript=this.aV.D8d;b.ReplaceHyphensWithDash=this.aV.A0c;b.ReplaceFractionsWithFractionCharacter=this.aV.C8d;this.Mda&&(b.ReplaceQuoteWithSmartQuote=
this.aV.EYf);this.Wh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.mVn,b)}}Object(m.a)(ul,"AutoCorrectOptionsDialog",ff.a,[678]);class jl{static get Hg(){return ff.a.Sy(jl.am,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}jl.am="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(jl,"AltTextDialogWithDescriptionHtml",null,[]);class Lm extends ff.a{constructor(b=!1){super(!1,!1,b);this.Hg=jl.Hg;this.mg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}N3e(b){this.Wh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(v.a)(this,this.ejk,"altTextDialogHandler"),this.bif(b));b=document.getElementById(Lm.NUe);b.focus();b.select()}bif(b){const h={};h[Lm.NUe]=this.Sff(b);h[Lm.MUe]=this.kAl(b)||"";return h}L2(b){return b.Bf.id===Lm.MUe?!1:super.L2(b)}}Lm.NUe="titleText";
Lm.MUe="descriptionText";Object(m.a)(Lm,"BaseAltTextDialogWithDescription",ff.a,[]);var xh=c(38);class Dm extends Lm{constructor(b,h,u,y,P){super();this.rk=h;this.wo=u;this.tv=y;this.Kd=P;this.Vnb=this.JS=null;this.N3e(b)}kAl(b){this.JS=b.node;this.Vnb=xh.TableReader.y5h(b);return xh.TableReader.anf(this.Vnb)}Sff(b){this.JS=b.node;this.Vnb=xh.TableReader.y5h(b);return xh.TableReader.bnf(this.Vnb)}ejk(b,h){if(1===b){b=xh.TableReader.bnf(this.Vnb);const u=xh.TableReader.anf(this.Vnb),y=h[Lm.NUe];h=
h[Lm.MUe];this.hide();const P=this.tv.Qc(15);try{P.Eb(this.JS),this.rk.q3f(this.Vnb,y),this.rk.M7i(this.Vnb,h)}finally{P&&P.dispose()}y===b&&h===u||this.Kd.Ds(16)}this.wo.Xp&&this.wo.Vq.WG(this.JS)}}Object(m.a)(Dm,"TableAltTextDialog",Lm,[]);class Bo{constructor(b,h,u){this.Lz=b;this.Ic=h;this.Ud=u}create(b){return new Dm(b,this.Lz,Ra.App.yd,this.Ic,this.Ud)}}Object(m.a)(Bo,"TableAltTextDialogFactory",null,[]);const gn=()=>{Ra.App.Jgh=!0;return 32},hn=(b,h,u,y,P)=>{if(1===u)return 32;if(!({point:b,
ox:h}=yq(P)).returnValue)return 16;Ra.App.xa.Ygc(b,h);return 32},tr=(b,h,u,y,P)=>{if(1===u)return 32;if(!({point:b,ox:h}=yq(P)).returnValue)return 16;Ra.App.xa.Xha(b,h);return 32},yq=b=>{let h=null,u=0;if(!b)return{returnValue:!1,point:h,ox:u};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,ox:u};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));u=parseInt(b[2]);return{returnValue:!0,point:h,ox:u}};var jp=c(1766);class Lp extends Sys.EventArgs{constructor(b,h,u,y,P,aa=0,ta=0,Pa=null){super();
this.controlId=b;this.commandId=y;this.time=P;this.commandSurface=aa;this.ox=ta;this.contentType=Pa}}Object(m.a)(Lp,"CommandClickEventArgs",Sys.EventArgs,[]);class Si{constructor(b,h){this.gra=b.Mhf();this.Knc=b;this.C7a=h}aNa(b,h,u,y=null,P=null){u&&(this.C7a.bH=u.CommandLocation,this.C7a.t7=u.InvocationMethod,this.C7a.udb=u.CommandTabName);b=parseInt(b);let aa=this.Knc.BWh(b,h,u);aa.SHf&&(aa=this.Knc.BWh(aa.vL,h,u));if(void 0!==aa.SZa&&null!==aa.SZa)return aa.SZa;if(aa.VDb)P=32;else{var ta=null;
this.gra&&this.gra.oRf&&(ta=this.gra.oRf(aa,P));aa.kga||aa.NRc?aa.KCa?P=16:(P=this.C7a.Ub(aa.vL,aa.r9b?2:1,aa.vd,P),2===P&&(P=32)):aa.KCa?P=this.C7a.Hoa(null,aa.vL,aa.vd,Pa=>{y&&y(Pa.response)},P):(P=this.C7a.Ub(aa.vL,2,aa.vd,P),y&&y(P));this.gra&&this.gra.jRf&&this.gra.jRf(aa,P,ta);if(h&&u&&-1!==u.InvocationMethod&&u.InvocationMethod){u=h.LegacyId;if(void 0===u||null===u)u="";ta=h.ParentMenuId;void 0!==ta&&null!==ta||!h.MenuId||(ta=h.MenuId);let Pa=h.SqmControlId;void 0!==Pa&&null!==Pa||!h.SourceControlId||
(Pa=h.SourceControlId);(void 0!==Pa&&null!==Pa||void 0!==ta&&null!==ta)&&jp.a.jrn(new Lp(Pa,u,ta,De.ActionManager.dea(b),Date.now()))}}aa.kga&&32===P&&this.gra&&this.gra.cBa&&this.gra.cBa(aa,h);aa.NRc&&32===P&&this.gra&&this.gra.$Xa&&this.gra.$Xa(aa,h);return 32===P||1===P}tEa(b,h=null){if(r.AFrameworkApplication.Rk||lf.a.instance.Zu)return!1;null!=h&&null!=h.UILocation&&(this.C7a.bH=h.UILocation);const u=parseInt(b);if(!b||u===De.ActionManager.V$e)return!0;b=this.Knc.sWh(u,h);b.SHf&&(b=this.Knc.sWh(b.vL,
h));if(void 0!==b.SZa&&null!==b.SZa)return b.SZa;u===Wa.a.YYb&&h&&(b.vd=h);return 32===this.C7a.Ub(b.vL,1,b.vd)}clearCache(){this.Knc.clearCache()}}Object(m.a)(Si,"GeneralCuiUser",null,[354,355]);var Oh=c(189),uk=c(59),hl=c(47),vl=c(1368);class Uo{get HM(){return null!=this.Hyg?this.Hyg:this.Hyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,h,u,y){this.THg="DocumentProofingFailed";this.lOe=b;this.g8g=h;this.P$c=u;this.XH=y}TSl(){const b=this.XH.gQl(this.lOe);return{returnValue:this.XH.UNa(this.lOe),
Pnn:b}}zyo(b,h){const u=uk.a.Xv();if(u){var y=new Oh.ScriptSharpLegacyMap;y.add(Ge.a.cC,b);y.add(Lc.a.noProof,h);b=new dg.GraphTransaction(15);b.Eb(u);this.HM.PHb(hl.StyleReader.wordStyleIdNormal,y,u)?vl.a.gkj():(w.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),vl.a.recordQosError(this.THg,[vl.a.nwc],"Style could not be modified"));b.dispose()}else w.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),vl.a.recordQosError(this.THg,[vl.a.nwc],"PageContentNode not found")}SWn(b,
h){this.zyo(b,h)}g1n(b,h){if(this.g8g){var u=new uh.DictionaryPropertySet;this.P$c.execute(y=>{y.OHc(b)});u.setValue(Ge.a.cC,b);u.setValue(Lc.a.noProof,h);h=new dg.GraphTransaction(15);h.set(Ra.App.kk.sl);this.g8g.l4(u);h.dispose()}}pf(){return Se.SelectionEditor.pf(this.lOe)}}Object(m.a)(Uo,"LanguageEditor",null,[540]);var lg=c(621),kl=c(234),Qj=c(93);class Lo{constructor(b=!1,h=0){this.languages=Lo.z4h(zl.a.azl());this.fjd=new kl.a;this.aRa=[];this.hWb=new lg.a;this.HRi=b;this.T1g=0>=h?7:h;this.S1g=
this.EIe=0;this.MMg=!1;b&&(this.qem(),r.AFrameworkApplication.rJ(()=>{this.NMm()}))}qem(){for(var b of this.languages)this.fjd.Z(b.LCID,b);b=[];try{const y=Xa.a.get("RecentlyUsedLcids");if(y&&""!==y){const P=decodeURIComponent(y).split(",").slice(0,this.T1g);for(const aa of P){let ta;({value:ta}=this.fjd.Gc(parseInt(aa),ta)).returnValue&&b.push(ta)}}}catch(y){w.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",y.message),Array.clear(b)}if(b.length)for(var h of b){var u=
h.LCID;this.hWb.contains(u)||(this.aRa.push(h),this.hWb.add(u))}else h=r.AFrameworkApplication.lcid,({value:u}=this.fjd.Gc(h,u)).returnValue&&(this.aRa.push(u),this.hWb.add(h));this.X0i()}X0i(){const b=Qj.toArray(Qj.select(Qj.asEnumerable(this.aRa),h=>h.LCID)).join(",");Xa.a.cSa("RecentlyUsedLcids",b,180)}zHl(b){let h,u=-1,y=null;var P=Lo.z4h(this.aRa);this.HRi&&0<P.length&&(y=Qj.toArray(Qj.Si(Qj.asEnumerable(P),(Pa,vb)=>{b===Pa.LCID&&-1===u&&(u=vb);return{["key"]:vb,["text"]:Pa.displayName,["value"]:Pa.LCID.toString()}})));
let aa=0;y&&(aa=y.length);P=aa;const ta=Qj.toArray(Qj.Si(Qj.asEnumerable(this.languages),(Pa,vb)=>{b===Pa.LCID&&-1===u&&(u=aa+vb);return{["key"]:aa+vb,["text"]:Pa.displayName,["value"]:Pa.LCID.toString()}}));h=u;return 0<aa?{returnValue:y.concat.apply(y,ta),selectedIndex:h,Idj:P}:{returnValue:ta,selectedIndex:h,Idj:P}}ZYn(b,h){if(this.HRi&&({value:u}=this.fjd.Gc(b,u)).returnValue){h=b!==h;if(this.hWb.contains(b))b=Array.indexOf(this.aRa,u),0<=b&&(Array.removeAt(this.aRa,b),this.aRa.push(u)),h&&this.EIe++;
else{this.hWb.add(b);this.aRa.push(u);if(this.aRa.length>this.T1g){var u=this.aRa.shift();this.hWb.remove(u.LCID)}h&&this.S1g++}this.X0i()}}NMm(){const b=this.EIe+this.S1g;!this.MMg&&0<b&&(w.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.EIe/b),this.MMg=!0)}static z4h(b){b=Array.clone(b);b.sort((h,u)=>h.displayName.localeCompare(u.displayName));return b}}Object(m.a)(Lo,"LanguageListHelper",null,[538]);var qn=c(199);class Pq extends qn.a{constructor(){super();this.Type=
this.Number=0}get ControlType(){return 10}}Object(m.a)(Pq,"NumberButtonProps",qn.a,[]);var im=c(233);class am{static get fY(){return null!=am.lwg?am.lwg:am.lwg=Ja.a.instance.Pa("Box4.ISpacingCommands")}static get Yg(){return im.ContextSetEditor.instance}static get i_(){return null!=am.ftg?am.ftg:am.ftg=Ja.a.instance.Pa("Box4.ILineSpacingHelper")}static get I$i(){return!!am.fY}static Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.kdc,oc.a.view,am.kdc);b.Xc(Oa.a.kdc,1124);b.pa(Oa.a.kdc,oc.a.paragraph,
am.Fyo)}static kdc(b,h,u,y,P){if(1===u||!am.I$i)return am.I$i?32:8;if(!am.eli){var aa=[];aa.push(Object.assign(new Pq,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));aa.push(Object.assign(new Pq,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));aa.push(Object.assign(new Pq,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));aa.push(Object.assign(new Pq,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));aa.push(Object.assign(new Pq,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));aa.push(Object.assign(new Pq,
{ExternalId:"LineSpacing3_00",Number:3,Type:0}));P.MenuItems=ke.f(aa);am.eli=!0}w.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.Bb;aa=null;h&&h.hb.kb&&(aa=h.hb.kb);h=am.Yg.XQh(aa.Qa);r.AFrameworkApplication.ya.Tf(h,b,u,!0,y,P);return 32}static Fyo(b,h){let u=b=!0;h=am.i_.jDa(h.node);var y=h.beforeSpacing;let P=!1;1===y.unit&&(P=!0);if(P||0<y.value)b=!1;h=h.afterSpacing;y=!1;1===h.unit&&(y=!0);if(y||0<h.value)u=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(am.Lck,
!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(am.NEn,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(am.Kck,!u));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(am.MEn,u));return 32}}am.Lck="AddSpaceBeforeParagraph";am.Kck="AddSpaceAfterParagraph";am.NEn="RemoveSpaceBeforeParagraph";am.MEn="RemoveSpaceAfterParagraph";am.eli=!1;Object(m.a)(am,"LineSpacingRibbonMenu",null,[]);var Vj=c(160),qj=c(1362),Vh=c(1350);const mm=(b,h,u)=>{if(1===
u)return 32;b=Ra.App.xa.notificationBar.sla("Automation test",!1);b.image=3;Ra.App.xa.notificationBar.BA(b);return 32},Mt=(b,h,u,y,P)=>{let aa;if(!({qrj:aa}=dr(P)).returnValue)return 16;Vj.UISurfaces.KI().then(ta=>{let Pa=null;var vb=Object.assign(new qj.a,{label:"OK",onExecute:()=>{Pa&&ta.removeNotification(Pa)}});vb=Object.assign(new Vh.a,{target:"#"+$g.AppFrame.l_f,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:vb,useTeachingStyles:aa});vb=ta.callout(vb);Pa=ta.addNotification(vb);
return null},ta=>{w.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ta);return null});return 32},dr=b=>{let h=!1;if(!b)return{returnValue:!1,qrj:h};h=Boolean.parse(b);return{returnValue:!0,qrj:h}};var ol=c(1429);let Co,Dk,fo,ur;class zn{constructor(){this.T5=new ob.a;this.QRg=!1}fcb(b){const h=this.T5.indexOf(b);let u=!0;if(-1!==h){u=!1;if(!h)return u;this.T5.removeAt(h)}this.T5.insert(0,b);w.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",
b);11===this.T5.count&&(w.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.T5.J(10)),this.T5.removeAt(10));this.cAo();return u}gdg(b){let h="#";for(let y=0;y<this.T5.count;y++){var u="#"+this.T5.J(y).substring(4,6)+this.T5.J(y).substring(2,4)+this.T5.J(y).substring(0,2);u=Object.assign(new ol.a,{Color:this.T5.J(y),Alt:u,DisplayColor:u});if(u.DisplayColor.toLowerCase()===b.toLowerCase()){h=u.Color;break}}for(const y of zn.P1g)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(y,
h))}cAo(){w.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let u=0;u<this.T5.count;u++){var h="#"+this.T5.J(u).substring(4,6)+this.T5.J(u).substring(2,4)+this.T5.J(u).substring(0,2);h=Object.assign(new ol.a,{Color:this.T5.J(u),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const u of zn.P1g)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(u,b));this.QRg||this.bzo();
this.QRg=!0}bzo(){for(const b of Object.keys(zn.pWg)){w.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=zn.pWg[b],u=[];for(const y of h)u.push(appChrome.api.menuSection([y],y in zn.BDe?zn.BDe[y].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,u,zn.BDe[b].toString()))}}}zn.pWg={["FontColor"]:(ur=new ob.a,ur.add("AutomaticFontColor"),ur.add("ThemeFontColorPickerMCU"),ur.add("ThemeFontColorPicker"),ur.add("StandardFontColorPicker"),
ur.add("RecentFontColorPicker"),ur.add("MoreFontColors"),ur),["CellShading"]:(fo=new ob.a,fo.add("ThemeShadingColorPickerMCU"),fo.add("ThemeShadingColorPicker"),fo.add("StandardShadingColorPicker"),fo.add("RecentCellShadingColorPicker"),fo.add("ClearShadingColor"),fo.add("MoreCellShadingColors"),fo),["PictureBorders"]:(Dk=new ob.a,Dk.add("ThemePictureBorderColorPickerMCU"),Dk.add("ThemePictureBorderColorPicker"),Dk.add("StandardPictureBorderColorPicker"),Dk.add("RecentPictureBorderColorPicker"),Dk.add("MorePictureBorderColors"),
Dk.add("NoPictureBorder"),Dk.add("PictureBorderWeightOptions"),Dk.add("PictureBorderStyleOptions"),Dk)};zn.BDe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};zn.P1g=(Co=new ob.a,Co.add("RecentFontColorPicker"),Co.add("RecentCellShadingColorPicker"),Co.add("RecentPictureBorderColorPicker"),Co);Object(m.a)(zn,"RecentColorsSectionHandler",null,[]);var po=c(1377),An=c(1025);class er{constructor(b){this.nYj=b}b8(){}a8(b){this.nYj.bZm(b)}}Object(m.a)(er,"DataBuddyActionListener",
null,[35]);class kp{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(m.a)(kp,"DataBuddyTaskPaneProps",null,[]);class Vo{constructor(b){this.isVisible=!1;this.nY=new ob.a;this.Cle=null;this.Y1=b;this.xA=new po.a;this.Vb=ub.FocusManager.instance()}initialize(){this.Cle=new er(this);this.Y1.yMa();this.xA.MK(this.Pbk());this.xA.MK(this.W9j())}toggle(){this.isVisible?this.hide():this.show()}bZm(b){if(2===b.behavior){const h=De.ActionManager.dea(b.actionId)||
b.actionId.toString();h.startsWith("Query")||(this.nY.add(h+": "+Vo.drl(b.response)),this.ym())}}hide(){Vj.UISurfaces.wu().then(b=>{b.hideTaskPane(Vo.nB,2);return null})}show(){Vj.UISurfaces.wu().then(b=>{b.showTaskPane(Vo.nB,this.Pz());return null});this.isVisible&&Vj.UISurfaces.wu().then(b=>{b.setSelectedTaskPane(Vo.nB);return null})}Pbk(){return b=>{b.actions=this.nY.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}W9j(){return b=>{b.onClearClick=()=>{this.nY.clear();
this.ym()}}}Wb(){r.AFrameworkApplication.ya.b4(this.Cle)}y6a(){r.AFrameworkApplication.ya.Djc(this.Cle)}Pz(){const b=new kp;this.xA.gMb(b);return Object.assign(new An.a,{title:"Data Buddy",hideHeader:!1,width:Vo.width,location:2,contentProps:b,onOpen:()=>{this.D8();this.Wb();this.isVisible=!0;r.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.kca();this.y6a();this.isVisible=!1;this.ym();r.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}ym(){Vj.UISurfaces.wu().then(b=>{b.updateTaskPane(Vo.nB,
this.Pz());return null})}D8(){this.Vb.Dg(Vo.nB)}kca(){this.i2a()&&this.Vb.Dg(this.Vb.QS)}i2a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Vo.nB}static drl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Vo.nB="DataBuddyTaskPane";Vo.width=300;Object(m.a)(Vo,"Box4DataBuddyTaskPane",null,
[537]);class ds{constructor(b){this.Eh=b}uHa(b){this.Eh&&this.Eh.xG(b)}a7c(){this.Eh&&this.Eh.s7c(void 0)}}Object(m.a)(ds,"RibbonButtonUpdater",null,[535]);var oi=c(395);class Kr{constructor(){this.zMe=this.W=null}get name(){return"Box4.UI"}xc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new Si(b.resolve("Box4.UI.CuiActionBridge"),r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new Bo(b.resolve("Box4.ITableEditor"),new oi.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
b.ha("Box4.UI.ILanguageEditor",()=>new Uo(Hh.a.instance.Lg,b.Pa("Box4.ITextFormattingCommands"),b.Za("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new ed(r.AFrameworkApplication.Cr)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new ul(b.resolve("Box4.IAutoCorrectOptionsInfo"),r.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>
new Lo(r.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(Uh,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Lf(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new Cg(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),
b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new ds(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new zn).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new Vo(Ed.a.instance)).singleInstance()}init(){var b=Ra.App.xa;const h=b.Pb;mf.ocm(Object(v.a)(h,h.rIb,"onAuthenticationLost"),Object(v.a)(h,
h.sIb,"onAuthenticationRestored"),b.NAk);b=r.AFrameworkApplication.ya;b.pa(Oa.a.Mkn,oc.a.application,gn);b.gb(Oa.a.B9n,oc.a.application,hn,96);b.gb(Oa.a.h$n,oc.a.application,tr,96);b=r.AFrameworkApplication.ya;b.gb(Oa.a.Pao,oc.a.application,mm,96);b.gb(Oa.a.s9n,oc.a.application,Mt,96);am.Wb();this.wem();this.zMe=this.W.resolve("Common.IStandaloneRootController")}wem(){this.W.Za("Box4.IGeneralCuiUser").execute(b=>{this.W.Za("Common.IStandaloneRootController").execute(h=>{h.L8.ME=b})})}dispose(){this.zMe.dispose();
this.zMe=null}static main(){K.a.instance.Kc(new Kr,6)}}Object(m.a)(Kr,"Box4UIPackage",null,[1,2]);var Qq=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},zq=c(1781);class ok{get name(){return"Box4.Insights"}init(){}dispose(){}xc(b){b.ha("Box4.Insights.Box4InsightsSelection",
()=>new zq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(m.a)(ok,"Box4InsightsPackage",null,[1,2]);const Cl=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var go=c(444),nm=c(344),Bn=c(1751);class Mk{bkb(){return!1}reset(){}update(){}}Object(m.a)(Mk,"NullTaskYieldStrategy",null,[334]);var Aq=c(1380);class up{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(up,"CatchUpConfiguration",null,[]);class vp{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(vp,"SharedControllerFactoryParameters",null,[]);var vk=c(159),Rc=c(18);class jn{constructor(b,h,u,y){this.h$m=(P,aa)=>{(this.Pgd=!this.Pgd)&&aa.Yj&&aa.Yj.contextId===oc.a.Vc&&this.yrh(aa.Yj.node,aa.Yj.xk);return 32};this.Ax=b;this.Lp=h;this.ga=u;this.Vb=y;this.Fid=this.Gid=null;this.Pgd=!1;this.ga.pa(Rc.a.Aij,oc.a.view,this.h$m);this.Vb.le(xe.AFrame.Hp).bindAction(Rb.KeyInputManager.lc(fb.a.jlc,
6),Rc.a.Aij)}R3(b,h){this.Pgd&&this.Lp&&h&&h.Ll&&h.Ll.kb&&h.Ll.kb.Qa&&h.Ll.kb.Qa.node&&h.Ll.kb.Qa.contextId===oc.a.Vc&&this.yrh(h.Ll.kb.Qa.node,h.Ll.kb.Qa.xk)}yrh(b,h){b&&(this.LAi(b)?(this.Gid&&this.Gid.id.equals(b.id)||(this.Lp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.Gid=b),this.VPm(b,h)):this.Fid=this.Gid=null)}LAi(b){return 0<this.Ax.OCb(b).count}VPm(b,h){if(b){var u=-1,y=null,P=null;for(let aa=0;aa<b.qa.length;aa++){const ta=b.qa.J(aa);
if(!(null==P||ta.changeStart&&ta.changeStart.equals(y))&&h>=u&&h<=ta.cp&&!y.equals(this.Fid))if(this.Ax.AFb(y)){(b=this.Ax.FJc(y,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Lp.sendNotification(b,!1),this.Fid=y);break}else this.Fid=null;ta.changeStart&&!ta.changeStart.equals(y)&&(u=ta.cp,y=ta.changeStart);P=ta.changeStart}}}}Object(m.a)(jn,
"ActivityAnnouncementManager",null,[]);var wp=c(1351),ho=c(473),ao=c(767),bm=c(524);class Do{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(Do,"Activity",null,[]);var Nk=c(433);class xp extends Do{constructor(){super();this.ov=this.objectId=null}static tG(b){const h=new bm.a(new Nk.a);if(b.ov)for(const u of b.ov)h.add(u);return h}}Object(m.a)(xp,"RevisionSetActivity",Do,[]);class lp{constructor(b,
h,u,y=!1){this.Tpe=null;this.dismiss=()=>{this.dBi.then(P=>{P.removeNotification(this.Tpe);return this.Tpe=null})};this.vW=b;this.Bc=h;this.dBi=u;this.c9b=y}tro(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.Bc.Ub(Wa.a.m3a,2,null);break;default:this.gZm()}else w.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}gZm(){this.dBi.then(b=>{var h=Object.assign(new Vh.a,{target:'[data-unique-id~="CatchUpWithChanges"]',
showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new wp.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const u=Object.assign(new ho.a,{expirationOptions:Object.assign(new ao.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.Tpe=b.addNotification(h,u)})}doesContentExist(b){if(!b)return w.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return w.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Bc.Ub(Wa.a.lEd,2,h))return!1;break;case 1:return this.F7k(b)}return!0}F7k(b){b=xp.tG(b);return b?0<this.vW.mKd(b).count:(w.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(m.a)(lp,"ActivityContentManager",null,[658]);var Qn=c(1441),io=c(1949),hk=c(995),Xp=c(705);class Kn{constructor(){this.ov=this.dX=null}compare(b){if(!b)return!1;
if(this.dX&&b.dX){if(this.dX.count!==b.dX.count)return!1;for(const h of this.dX)if(!b.dX.contains(h))return!1}else if(!b.dX&&this.dX||!this.dX&&b.dX)return!1;if(b.ov&&this.ov){if(b.ov.count!==this.ov.count)return!1;for(const h of this.ov)if(!b.ov.contains(h))return!1}else if(!this.ov&&b.ov||!b.ov&&this.ov)return!1;return!0}}Object(m.a)(Kn,"ActivityHighlightableObject",null,[]);class Ws extends Qn.a{constructor(b,h){super();this.OHe=this.WVb=null;this.a$c=b;this.Ax=h;this.v1=[new io.a(hk.a.nqh,hk.a.mqh),
new io.a(hk.a.kqh,hk.a.jqh),new io.a(hk.a.Zxd,hk.a.$xd),new io.a(hk.a.ayd,hk.a.e_e)]}get shb(){return 1}get O0a(){return this.v1}get Kaa(){return!0}g0a(b,h){if(b=Object(na.a)(Kn,b))if(b.dX)for(const u of b.dX)h.add(u);else w.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}nFa(b,h){if(this.Uu.cCa){var u=this.a$c.X4a,y=this.a$c.thb,P=!!u&&u.compare(y),aa=this.Uu.cCa,ta=aa.action,Pa=this.q6n(aa,b),vb=!1;2!==ta&&ta&&(vb=(vb=this.Uu.lTc)?1===vb.type:!!u||!!y);h=h.LFa("*");
for(let Kb=0,Sb=h.length;Kb<Sb;Kb++){const Yb=h[Kb],Ac=this.vBl(Yb,hk.a.RCc);if(Ac&&Ac.Mt)if(this.EDn(Yb),1===aa.type)switch(ta){case 0:Pa&&u.ov.contains(Ac.Mt)&&this.Xvd(Yb,2,Ac,!1);break;case 2:Pa&&y.ov.contains(Ac.Mt)&&this.Xvd(Yb,P?2:1,Ac,!1);break;default:this.O6b(b,Yb,Ac,!1)}else vb?this.O6b(b,Yb,Ac,!1):this.O6b(b,Yb,Ac,!0)}this.WVb&&(this.WVb.classList.add(hk.a.ayd),this.OHe=this.WVb=null)}}vBl(b,h){return Bh.a.Db(b,h)}q6n(b,h){if(b&&b.aA){const u=b.aA,y=b.action;if(1===b.type&&(2===y||!y)&&
u.dX)return u.dX.contains(h);if(u.ov)for(const P of u.ov){b=this.Ax.$Kc(P);for(const aa of b)if(aa===h)return!0}}return!1}O6b(b,h,u,y){const P=this.a$c.X4a,aa=this.a$c.thb;P&&P.ov.contains(u.Mt)&&(!P.dX||P.dX.contains(b))?this.Xvd(h,2,u,y):aa&&aa.ov.contains(u.Mt)&&(!aa.dX||aa.dX.contains(b))&&this.Xvd(h,1,u,y)}Xvd(b,h,u,y){b&&Xp.a(b)&&(b.classList.add(this.iFl(2===h,y)),this.pYn(b,u,y))}pYn(b,h,u){this.WVb?-1!==h.cpEnd&&this.OHe.cpEnd!==h.cpBegin&&(this.WVb.classList.add(u?hk.a.e_e:hk.a.ayd),b.classList.add(u?
hk.a.$xd:hk.a.Zxd)):b.classList.add(u?hk.a.$xd:hk.a.Zxd);b.classList.add(hk.a.lqh);this.WVb=b;this.OHe=h}EDn(b){this.Uu.kRa(b);this.yCn(b)}yCn(b){b.classList.remove(hk.a.Zxd,hk.a.$xd,hk.a.lqh,hk.a.ayd,hk.a.e_e)}iFl(b,h){return h?b?hk.a.jqh:hk.a.mqh:b?hk.a.kqh:hk.a.nqh}}Object(m.a)(Ws,"ActivityHighlightActor",Qn.a,[]);var jm=c(1950),Bq=c(180);class ss{constructor(b,h,u,y,P,aa,ta,Pa){this.vV=b;this.iN=h;this.Ax=u;this.hYj=P;this.ib=aa;this.Lp=Pa;this.Vb=ta;this.iN.rUd=!1}ZGi(b,h,u){b?this.D8l(b,h,u):
this.iN.X4a&&(b=Object.assign(new jm.a,{action:1,type:1,aA:null,jJ:this.iN.X4a}),this.iN.X4a=null,this.vV.QE(b))}D8l(b,h,u){if(h){b=new bm.a(new Nk.a);for(P of h){var y=this.Ax.gKc(P);for(let aa=0;aa<y.length;aa++){const ta=y[aa];this.Ax.AFb(ta)&&b.add(ta)}}var P=this.Ax.mKd(b);P=this.Ayh(P,b);y=this.iN.X4a;this.iN.X4a=P;P=Object.assign(new jm.a,{action:0,type:1,aA:this.iN.X4a,jJ:y});this.vV.QE(P);u&&!this.RQn(h.J(0),b)||this.CSn(h.J(0),b)}else w.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}RQn(b,h){if(!b)return w.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return w.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.Fyl(b,h);return this.hYj.FLb(b.id,h)?this.setSelection(b,h)?!0:!1:(w.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}CSn(b,h){b=this.jFl(b,h);h=new Sys.StringBuilder;for(let u=
0;u<b.count;u++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,u+1,b.count,b.J(u)));this.Lp.sendNotification(h.toString(),!0)}setSelection(b,h){if(!b||!be.ParagraphReader.ic(b))return w.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return w.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.iN.rUd=!0;b=nf.a.Uc(b,h);b=new Bq.Selection([b],!0);this.ib.setSelection(b);ub.FocusManager.zJ()&&
this.Vb.Dg(xe.AFrame.So);return!0}Fyl(b,h){if(h&&0<h.count)for(let u=0;u<b.qa.length;u++){const y=b.qa.J(u);if(y.changeStart&&h.contains(y.changeStart))return y.cp}w.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}jFl(b,h){const u=new ob.a;if(h&&0<h.count&&b){let y=-1;for(let P=0;P<b.qa.length;P++){const aa=b.qa.J(P);if(-1!==y&&aa.isChangeEnd)if(aa.changeStart&&h.contains(aa.changeStart))continue;else u.add(b.characterData.substring(y,
aa.cp)),y=-1;aa.changeStart&&h.contains(aa.changeStart)&&(y=aa.cp)}}return u}hGi(b,h){if(b)switch(b.type){case 1:if(h){b=new bm.a(new Nk.a);for(var u of h){h=this.Ax.gKc(u);for(let y=0;y<h.length;y++){const P=h[y];this.Ax.AFb(P)&&b.add(P)}}}else b=xp.tG(b);h=this.Ax.mKd(b);this.iN.thb=this.Ayh(h,b);u=Object.assign(new jm.a,{action:2,type:1,aA:this.iN.thb,jJ:null});this.vV.QE(u)}else this.iN.thb&&(u=Object.assign(new jm.a,{action:3,type:1,aA:null,jJ:this.iN.thb}),this.iN.thb=null,this.vV.QE(u))}Ayh(b,
h){var u=null;if(b){u=new Ea.a;for(const y of b)12===y.type&&u.add(y)}b=new Kn;b.dX=u;b.ov=h?h:this.OKl(u);return b}OKl(b){const h=new bm.a(new Nk.a);if(!b)return h;for(const u of b)for(const y of this.Ax.OCb(u))h.add(y);return h}}Object(m.a)(ss,"ActivityHighlightManager",null,[]);var Mp=c(526),cm=c(492),Eo=c(1439),$i=c(127),Wo=c(66);class Vi{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(m.a)(Vi,"CreateIndicatorTooltipParameters",null,[]);class yp{constructor(){this.clearSticky=
!1}}Object(m.a)(yp,"DismissIndicatorTooltipParameters",null,[]);class Yp{constructor(){this.target=null;this.isSticky=!1}}Object(m.a)(Yp,"UpdateIndicatorTooltipParameters",null,[]);class vr extends Sys.EventArgs{constructor(b,h,u){super();this.yBb=b;this.Gci=h;this.p7n=u}}Object(m.a)(vr,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class $m{constructor(){this.Hci=new Map;this.Ici=new Set}Hoo(b,h){this.Ici.add(b);this.Hci.set(b,h)}wqm(b){return Je.a.Lii(b.htmlElement)}UZl(){const b=new Set;for(const h of this.Ici){const u=
this.Hci.get(h);u&&this.vqm(u)&&b.add(h)}return b}vqm(b){return b.parentElement&&Je.a.Lii(b.parentElement)}}Object(m.a)($m,"IndicatorVisibilityTracker",null,[]);class Cq extends Eo.a{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){super();this.sa=new ie.a;this.Hsb=this.I9=null;this.C4l=(Yb,Ac,Sc,nd,Ad)=>{if(!Ad)return w.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Ac=xp.tG(Ad.Activity);Yb=null;if(Ad.NodeId&&(Ad=$i.b(Ad.NodeId),!T.a.Qp(Ad,T.a.nil)&&(Ad=this.Ax.QXh(Ad),
this.fbg(Ad,!1))))return 32;for(const he of Ac)if(this.Ax.AFb(he)){Ad=this.Ax.R4b(he);if(this.fbg(Ad,!0))return 32;Ad&&!Yb&&(Yb=Ad)}if(this.fbg(Yb,!1))return 32;w.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.A4l=(Yb,Ac,Sc,nd,Ad)=>{w.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Ad&&Ac&&Ac.gl&&(Yb=Ac.node)&&((Yb=this.Dlc.yKd(Yb))?this.$td(Yb,!1,!1):w.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.Rao=Yb=>{(Yb=this.Dlc.yKd(Yb.customData))&&this.$td(Yb,!1,!1)};this.onMouseEnter=Yb=>this.lFi(Yb.Pv,!0);this.ioa=Yb=>{Yb=Yb.Pv;if(Yb===this.I9)return!0;this.KUi(Yb);return!0};this.aFa=Yb=>{this.Hsb=null;return this.lFi(Yb.Pv,!1)};this.w_=()=>{this.q6f();this.Zyd(!0);return!1};this.Qs=()=>{this.WJi()};this.p3d=()=>{this.I9&&this.Toj(this.I9);this.Hsb&&this.KUi(this.Hsb);this.a5m()};this.WJi=()=>{this.I9?
this.Toj(this.I9):this.i0e()};this.Ax=b;this.Nle=h;this.COg=u;this.JPj=y;this.ml=P;this.s5=null;this.Gb=ta;this.Dlc=Pa;this.Dxe=new $m;this.Tw=vb;this.UJ=Kb;this.WH=Sb;this.$e&&(this.$e.Gka(this.p3d),this.$e.lfh(this.WJi));aa&&aa.execute(Yb=>{Yb.u8(this.Qs)})}get $e(){return this.ml&&this.ml.mi?this.ml:(w.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}ZBa(b,h,u){if(this.I9){var y=Wo.a(this.I9);if(b===y)return this.I9}const P=b.Ug.ownerDocument;y=Mp.a.createElement(P,cm.a.div);
y.className=hk.a.wBk;y.style.left=h+"px";y.style.top=u+"px";h=Mp.a.createElement(P,cm.a.div);h.className=this.Tw?hk.a.tqh:hk.a.oqh;y.style.cursor="pointer";h.style.cursor="pointer";this.WH&&(h.style.backgroundColor=this.UJ.kvl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.UJ.mvl());y.appendChild(h);Re.a.instance.mb(bb.a.DQ,y,this.onMouseEnter);Re.a.instance.mb(bb.a.GK,y,this.ioa);th.a.instance.mb(bb.a.click,y,this.aFa);Re.a.instance.mb(bb.a.contextMenu,y,this.w_);
w.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.rKm(b);h=this.GLl(b);this.Dxe.Hoo(h,y);this.Dxe.wqm(b)&&this.BEi(h);return y}fnb(b){return this.o5n(b)}jZa(b){const h=this.Cyk(b),u=[];u.push(this.ZBa(b.U3,h,b.pkc[0].y-b.jX[0].y));return u}Cyk(b){let h=hk.a.rbm+(0>b.ATc?-b.ATc:0);const u=Bf.a.Mi(b.leftMargin,0)/2;1>=u&&w.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>u?u:h;h=h<hk.a.pqh?hk.a.pqh:h;return r.AFrameworkApplication.isRtl?
b.jX[0].width/this.zoom+h:-h}W9i(b){if(b&&393230===b.Rc||393251===b.Rc){const h=this.Ax.OCb(b);if(h)for(const u of h)if(b===this.Ax.R4b(u))return!0}return!1}o5n(b){for(const h of be.ParagraphReader.Yv(b.yb,!0,!1))if(this.W9i(h))return!0;return!1}Wb(b){b.pa(Rc.a.Haj,oc.a.Vc,this.A4l);b.pa(Rc.a.L5f,oc.a.Vc,this.C4l)}fbg(b,h){if(!b)return!1;const u=this.Dlc.yKd(b);if(u)return this.$td(u,!1,!0),!0;if(!h){let y;this.c_c((y=new ob.a,y.add(b),y),!1,!0,!0);h=new sc.a(3,1,0,this.Rao,181);h.customData=b;this.Gb.Xb(h);
return!0}return!1}STk(b,h=!1){h&&this.Zyd(!0);if(b&&b.parentNode){var u=this.knf(b);u=this.nrl(u);this.s5||(this.s5=document.createElement("Div"),document.getElementById(r.AFrameworkApplication.OZb).appendChild(this.s5));this.Nle.createActivityIndicatorTooltip(Object.assign(new Vi,{target:b,container:this.s5,activityIds:u,isSticky:h,dirHint:9}));h&&(this.I9=b)}else w.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Val(b){b&&
b.classList.add(hk.a.byd)}lFi(b,h){return this.$td(b,h,!1)}$td(b,h,u){if(h&&b===this.I9)return!0;const y=this.knf(b);h||this.q6f();this.STk(b,!h);this.Val(b.getElementsByClassName(this.Tw?hk.a.tqh:hk.a.oqh)[0]);this.c_c(y,h,!0,u);this.Iti(y,h?1:2);this.JPj.hYd();h&&(this.Hsb=b);return!0}Zyd(b=!1){this.Nle.dismissActivityIndicatorTooltips(Object.assign(new yp,{clearSticky:b}));this.Hsb=null;b&&(this.I9=null)}gcj(b){b&&b.classList.remove(hk.a.byd)}q6f(){this.I9&&this.gcj(this.I9.getElementsByClassName(hk.a.byd)[0])}KUi(b){const h=
this.knf(b);this.c_c(h,!0,!1,!1);this.gcj(b.getElementsByClassName(hk.a.byd)[0]);this.Zyd(!1);this.Hsb=null}knf(b){let h=null;(b=(b=Wo.a(b))?b.yb:null)&&11===b.type&&(h=be.ParagraphReader.Yv(b,!0,!1));return h}i0e(){const b=!!this.Hsb;if(this.I9||b)this.q6f(),this.Zyd(!0),this.c_c(null,!1,!1,!1),this.c_c(null,!0,!1,!1)}Sdk(b){this.sa.addHandler(Cq.Mbh,b)}Tdk(b){this.sa.addHandler(Cq.Nbh,b)}c_c(b,h,u,y){let P=null;if(u&&b){for(const aa of b)if(u=this.Ax.gKc(aa))for(let ta=0;ta<u.length;ta++){const Pa=
u[ta];if(this.Ax.AFb(Pa)){P=this.Ax.FJc(Pa,aa.id);break}}if(!P){w.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(Cq.Mbh,new vr(P,b,!1)):this.sa.raiseEvent(Cq.Nbh,new vr(P,b,y))}nrl(b){const h=[];if(b)for(const y of b){var u=this.Ax.OCb(y);for(const P of u)(u=this.Ax.FJc(P,y.id))&&h.push(u.activityId)}!h.length&&b&&b.count&&w.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}Toj(b){b&&b.parentNode?(this.Nle.updateActivityIndicatorTooltip(Object.assign(new Yp,{target:b,isSticky:!0})),this.I9=b):w.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}a5m(){const b=this.Dxe.UZl();for(const h of b)this.BEi(h)}BEi(b){this.COg.Hti(b,3)}GLl(b){return(b=be.ParagraphReader.Yv(b.yb,!0,!1))&&b.count?b.J(0).id:null}rKm(b){b=be.ParagraphReader.Yv(b.yb,!0,!1);this.Iti(b,0)}Iti(b,
h){b&&b.count&&this.qKm(b.J(0).id,h)}qKm(b,h){this.COg.Hti(b,h)}}Cq.Mbh="ActivityIndicatorPreviewed";Cq.Nbh="ActivityIndicatorSelected";Object(m.a)(Cq,"ActivityIndicatorActor",Eo.a,[]);var og=c(40);class ts{constructor(b,h,u){this.Ax=b;this.csd=h;this.ml=u}get $e(){return this.ml&&this.ml.mi?this.ml:(w.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}yKd(b){w.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.QYh(b);if(!h){w.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Ax.OCb(b);for(const u of b)if(b=this.Ax.R4b(u),b=this.QYh(b))return b}return h}QYh(b){if(!b||12!==b.type)return w.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return w.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.csd.CMc(b);if(!h||11!==h.type)return w.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.xe(this.$e.Sb);if(!h||!h.htmlElement)return w.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var u=Hc.a.hKc(h.htmlElement,ts.Lbh);if(u)return u;h=h.Scf();if(!h)return w.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=Hc.a.awl(h,ts.Lbh);if(!h)return w.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(u=0;u<h.length;u++){const y=Wo.a(h[u]),P=og.OutlineElementNavigator.fl(b);if(y&&y.yb&&P&&y.yb.id.equals(P.id))return h[u]}w.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}uGl(b){b=this.Ax.QXh(b);if(!b||12!==b.type)return w.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
T.a.nil;b=this.yKd(b);if(!b)return w.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),T.a.nil;b=Wo.a(b);return b?b.yb.id:(w.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),T.a.nil)}}ts.Lbh="CatchUpActivityIndicatorContainer";Object(m.a)(ts,"ActivityIndicatorHelper",null,[]);var Ek=c(1627);class Hs{constructor(b,h,u,y,P,aa,ta){this.$0a=
b;this.pageContentNode=h;this.XRe=u;this.Bc=y;this.vW=P;this.Ne=aa;this.ZPc=ta;this.SQm=(Pa,vb,Kb)=>{if(1===Kb)return this.s$h?32:8;2===Kb&&(this.s$h&&(this.XRe.i0e(),this.lFk()),w.ULS.sendTraceTag(38138719,377,50,z.c({["MarkAsRead invoked"]:!0})));Ra.App.xa.updateCommandUI();return 8};this.$0a.t4a(this.XRe)}initialize(){this.Bc.pa(Rc.a.zwi,le.a.frame,this.SQm)}get s$h(){return!!this.vW.GQ&&0<this.vW.GQ.count||!!this.vW.ebc&&0<this.vW.ebc.count}YNf(b){const h=b&&b.wywaActivities?b.wywaActivities.length:
0;if(!this.ZPc||0<h||!b){const u=new Map;u.set("activityCount",h.toString());this.Ne.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:u})}b?this.ZPc&&0==b.wywaActivities.length||this.Z_m(b.wywaActivities):(w.ULS.shipAssertTag(36538305,377,!1),this.ZPc||Object(Ek.a)(),this.Ne.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}Z_m(b){b?(w.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.K3n(b),b=this.vW.ndk(b),this.L3n(b)):w.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}K3n(b){if(b){var h=new ob.a;for(const u of b)switch(u.type){case 2:case 3:case 4:case 10:b=4===u.type?u.zKi:u.contentId,h.add(b),this.vW.ebc.add(b)}0<h.count&&(w.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.Bc.Ub(Wa.a.$zi,2,h.toArray()))}}L3n(b){const h=new bm.a(new Nk.a),u=new dg.GraphTransaction(3);try{u.Eb(this.pageContentNode);for(const y of b){const P=this.vW.R4b(y);P&&this.XRe.W9i(P)&&
(h.add(P.id),this.$0a.J7b(P,!0))}}finally{u&&u.dispose()}0<b.count&&Ra.App.xa.updateCommandUI();b={};b.highlightedNodeCount=h.count;w.ULS.sendTraceTag(36509257,377,50,"{0}",z.c(b))}lFk(){w.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.vW.ebc.count&&(this.Bc.Ub(Wa.a.dGh,2,this.vW.ebc.toArray()),this.vW.ebc.clear());const b=this.iHk(this.vW.GQ);this.rCn(b)}rCn(b){w.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new dg.GraphTransaction(3);try{h.Eb(this.pageContentNode);for(const u of b){this.vW.GQ.remove(u);for(const y of this.vW.$Kc(u))this.$0a.J7b(y,!0)}this.vW.esh()}finally{h&&h.dispose()}}iHk(b){const h=new bm.a(new Nk.a);for(const u of b)h.add(u);return h}}Object(m.a)(Hs,"ActivityIndicatorManager",null,[]);class Cn{constructor(){this.thb=this.X4a=null;this.isFirstDocumentOpen=this.rUd=!1}}Object(m.a)(Cn,"ActivityStateManager",null,[657]);class fr{constructor(b,h){this.uad={};this.NQb=b;this.Fz=
h;this.ebc=new ob.a}get GQ(){return this.NQb.GQ}OCb(b){const h=new bm.a(new Nk.a);if(!b)return h;b=this.NQb.LId(b);for(let u=0;u<b.length;u++){const y=b[u];this.AFb(y)&&h.add(y)}return h}$Kc(b){return this.NQb.$Kc(b)}mKd(b){const h=new ob.a;if(b)for(const u of b)h.addRange(this.$Kc(u));return h}ndk(b){const h=new bm.a(new Nk.a);if(b)for(const u of b)if(1===u.type&&(b=u))for(const y of b.ov){h.add(y);this.GQ.add(y);const P=y.toString();this.uad[P]||(this.uad[P]=new ob.a);this.uad[P].add(b)}this.esh();
return h}AFb(b){return this.GQ&&b?this.GQ.contains(b):!1}FJc(b,h){if(b&&(b=this.uad[b.toString()])&&0<b.count){for(const u of b)if(u.objectId.equals(h))return u;return b.J(0)}return null}R4b(b){return this.NQb.R4b(b)}esh(){this.NQb.YEk()}gKc(b){return this.NQb.gKc(b)}QXh(b){if(!this.Fz)return null;const h=this.Fz.Jc;return h?h.Db(b):null}}Object(m.a)(fr,"ChangeIdCache",null,[]);var bo=c(174),ai=c(113);class qo extends bo.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new ai.a,{T_:qo.getTypeName(),B_:qo.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(m.a)(qo,"ChangeSummariesResponse",bo.a,[]);var jq=c(471);class zp extends jq.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new ai.a,{T_:zp.getTypeName(),B_:zp.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(zp,"ChangeSummariesRequest",jq.a,[]);var pk=c(392),us=c(394),Ap=c(254),Lr=c(415);class qt{constructor(){this.kec=this.X0c=null}}Object(m.a)(qt,"ActionPair",null,[]);class Dq{constructor(b,h,u,y){this.Oal=P=>{P=P.customData;const aa=this.jUi(P);aa&&(w.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.ykf(P)),aa.kec("Request timeout"))};this.TG=b;this.Q4=h;this.wf=u;this.Gb=y;this.Fxe=null;this.ZHe=
new Tb.a;this.J2g=new Tb.a}hho(b){const h=Object.assign(new pk.a,{parentPath:["Signal",zp.getTypeName()],items:[Object.assign(new us.a,{body:b})]});return this.initialize().then(()=>{const u=new Promise((y,P)=>{this.ZHe.Z(b.requestId,Object.assign(new qt,{X0c:y,kec:P}))});this.J2g.Z(b.requestId,new Date);w.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Dq.requestTimeoutMs);this.Q4.getAugLoopRuntimeManager().submitOperation(Object.assign(new Lr.a,
{operation:h}));this.B0n(b.requestId);return u})}initialize(){this.Fxe||(this.Fxe=this.TG.nm().then(()=>{this.wf.mb(this,qo.getTypeName())}));return this.Fxe}mD(b,h){if(b&&Ap.a.getTypeNameFor(b.content)===qo.getTypeName())if(b=b.content){var u=this.jUi(b.correspondingRequest);u?h!==pk.a.getTypeName()?u.kec("Invalid operation type"):(w.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.ykf(b.correspondingRequest)),
u.X0c(b)):w.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.ykf(b.correspondingRequest))}else w.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else w.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}B0n(b){const h=new sc.a(3,1,Dq.requestTimeoutMs,
this.Oal,176);h.Ntd=0;h.customData=b;this.Gb.Xb(h)}jUi(b){if(!b)return null;let h;if(!({value:h}=this.ZHe.Gc(b,h)).returnValue)return null;this.ZHe.remove(b);return h}ykf(b){if(!b)return-1;let h;return({value:h}=this.J2g.Gc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return r.AFrameworkApplication.K.pc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(m.a)(Dq,"ChangeSummariesAugloopProvider",null,[220]);class Np{constructor(){this.activityGroups=null}}Object(m.a)(Np,
"FeaturedActivityGroupPayload",null,[]);class Y{constructor(b,h,u,y,P){this.R_j=b;this.TEj=h;this.GGj=u;this.jKj=y;this.Dpb=P}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.jKj.dvb.then(()=>this.pCl(b)):Y.W$e}$1l(b,h,u){if(!h)return w.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Cl("TranslateFeaturedActivityGroups");u=this.GGj.jpo(b,h,u.wywaActivities);w.ULS.sendTraceTag(542942800,377,50,
"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<u.length);this.Dpb.set(h.correspondingRequest,u);return Object.assign(new Np,{activityGroups:u})}pCl(b){Cl("BuildFeaturedActivityGroupRequest");const h=this.R_j.duk();if(!h||!h.documentContent||!h.activityChanges)return w.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
Y.W$e;if(!h.documentContent.length||!h.activityChanges.length)return Y.W$e;w.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);Cl("SubmitFeaturedActivityGroupRequest");return this.TEj.hho(h).then(u=>this.$1l(h,u,b))}}Y.W$e=Promise.resolve(Object.assign(new Np,{activityGroups:[]}));Object(m.a)(Y,"ChangeSummariesDataProvider",null,[656]);class pa{constructor(b,h){this.Ax=b;this.F4j=h}duk(){const b=new ob.a,h=
new ob.a,u=new bm.a(new Nk.a);var y=this.Ax.GQ;if(!y||!y.count)return pa.Z$e;y=this.Ax.mKd(y);if(!y||!y.count)return w.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),pa.Z$e;for(const P of y)u.contains(P.id)||(u.add(P.id),this.Emn(P,b,h));return h.count&&b.count?Object.assign(new zp,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:$i.a(T.a.create())}):pa.Z$e}Emn(b,h,u){if(be.ParagraphReader.ic(b)){var y=
be.ParagraphReader.plainText(b);if(y&&y.length){h.add(y);y=this.Ax.OCb(b);y=this.l1l(y);for(const P of y){y=new ob.a;const aa=this.getTextRanges(b,P);for(const ta of aa)y.add({changeEnd:ta.endIndex,changeSpanId:ta.wUn,changeStart:ta.startIndex,contentIndex:h.count-1,locationId:$i.a(b.id)});(y=this.RQk(P,y.toArray()))&&u.add(y)}}else w.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else w.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}l1l(b){const h=
new Tb.a;for(const u of b)(b=this.K1h(u))?(h.ub(b)||h.Z(b,new bm.a(new Nk.a)),h.J(b).add(u)):w.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}RQk(b,h){const u=[];let y=null;for(const P of b)if(b=this.Ax.FJc(P,T.a.nil)){if(!y){const aa=this.K1h(P);if(!aa||!aa.length){w.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}y=
aa}u.push(b)}else w.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return u.length?y?h.length?{activityId:u[0].activityId,changes:h,personId:y,timestamp:u[0].displayTimestamp.toISOString()}:(w.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(w.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(w.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}K1h(b){b=this.Ax.FJc(b,T.a.nil);if(!b)return w.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return w.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const u=new ob.a;if(!h||!h.count||!b)return u;let y=-1,P=new bm.a(new Nk.a);for(let aa=0;aa<b.qa.length;aa++){const ta=b.qa.J(aa);if(-1!==y&&ta.isChangeEnd){if(ta.changeStart&&h.contains(ta.changeStart)){P.add(ta.changeStart);continue}u.add({startIndex:y,endIndex:ta.cp,wUn:this.F4j.E3i(P)});y=-1;P=new bm.a(new Nk.a)}ta.changeStart&&h.contains(ta.changeStart)&&(y=ta.cp,P.add(ta.changeStart))}return u}}pa.Z$e=Object.assign(new zp,
{activityChanges:[],documentContent:[],requestId:$i.a(T.a.nil)});Object(m.a)(pa,"ChangeSummariesRequestBuilder",null,[]);class rb{constructor(){this.changes=this.content=null}}Object(m.a)(rb,"ContentChange",null,[]);class ec{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(m.a)(ec,"FeaturedActivityGroup",null,[]);class wc{constructor(){this.end=this.start=0}}Object(m.a)(wc,"TextRange",null,[]);class gd{constructor(b){this.Dlc=b}jpo(b,h,u){if(!h)return w.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),gd.MEd;if(!h.inferences)return w.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),gd.MEd;if(!h.activityClassifications)return w.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),gd.MEd;if(!h.inferences.length||!h.activityClassifications.length)return w.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),gd.MEd;const y=[],P=new za.a(new Nk.a);for(const aa of h.inferences){const ta=this.ipo(aa,b,h,u);if(!ta)continue;const Pa=this.Dlc.uGl($i.b(ta.locationId));Pa.equals(T.a.nil)?y.push(ta):P.ub(Pa)?P.J(Pa).ranking>ta.ranking&&P.Z(Pa,ta):P.add(Pa,ta)}b=[...Array.from(P.values),...y];b.sort((aa,ta)=>aa.ranking-ta.ranking);return b.slice(0,gd.bSm)}ipo(b,h,u,y){if(!b||Jj.a.kf(b.activitiesInGroup))return w.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const P=new ob.a,aa=new Tb.a;let ta=null;for(const vb of b.activitiesInGroup){if(!vb){w.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>vb.activityIndex||vb.activityIndex>=u.activityClassifications.length){w.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Kb=u.activityClassifications[vb.activityIndex];if(!Kb||Jj.a.kf(Kb.contents))w.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Pa=this.Uhl(y,Kb.activityId);if(Pa){P.add(Pa);for(const Sb of vb.changes){if(!Sb){w.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Pa=Sb.value;if(0>Pa||Pa>=Kb.contents.length){w.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Pa=Kb.contents[Pa];if(!Pa){w.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const Yb=h.documentContent[Pa.contentIndex],Ac=Object.assign(new wc,{start:Pa.changeStart,end:Pa.changeEnd});if(aa.ub(Yb))aa.J(Yb).add(Ac);else{let Sc;aa.Z(Yb,(Sc=new ob.a,Sc.add(Ac),Sc))}ta||(ta=Pa.locationId)}}else w.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!P.count)return w.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.jYl(aa);return h.count?Object.assign(new ec,{ranking:b.ranking.value,reasons:[1],activities:P.toArray(),contentChanges:h.toArray(),locationId:ta}):(w.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}Uhl(b,h){for(const u of b)if(u&&u.activityId&&u.activityId===h)return u;return null}jYl(b){const h=new ob.a;for(const y of b){b=y.key;const P=y.value;P.Sc((aa,ta)=>aa.start-ta.start);var u=P.J(0).start;if(u>gd.Zwi){u-=gd.Zwi;b=b.substring(u,b.length);for(const aa of P)aa.start-=u,aa.end-=u}h.add(Object.assign(new rb,{content:b,changes:P.toArray()}))}return h}}gd.MEd=[];gd.Zwi=10;gd.bSm=4;Object(m.a)(gd,"ChangeSummariesResponseTranslator",null,[]);class Qd{constructor(){this.Dpb=new Tb.a;this.hJe=
new Tb.a}set(b,h){if(h.length&&b){this.Dpb.Z(b,h);for(const u of h)if(u.activities)for(const y of u.activities)y&&y.activityId?this.hJe.Z(y.activityId,b):w.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else w.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.Dpb.ub(b)?this.Dpb.J(b):null}$Om(b){return b&&this.hJe.ub(b)?this.hJe.J(b):null}}Object(m.a)(Qd,"FeaturedActivityGroupCache",null,
[]);class Yd{constructor(b){this.EXd=(h,u,y,P,aa)=>{if(!aa)return w.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=aa.Activity;if(!h)return w.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;u=this.Dpb.$Om(h.activityId);if(!u)return w.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;y=xp.tG(h);w.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",u,h.activityId,this.E3i(y));return 32};this.Dpb=b;this.tDg=new Map}Wb(b){b.pa(Rc.a.EXd,le.a.frame,this.EXd)}E3i(b){let h=0;const u=Array(b.count);for(const y of b)b=this.xMl(y),u[h]=$i.a(b),h++;return u.join(",")}xMl(b){let h=this.tDg.get(b);if(h&&h!=T.a.nil)return h;h=T.a.create();this.tDg.set(b,h);return h}}Object(m.a)(Yd,"FeaturedActivityGroupTelemetryActor",
null,[]);var Le=c(92);class Ef extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(m.a)(Ef,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Mg{constructor(b,h,u){this.fS=null;this.opo=y=>{this.zXa.reset();y=this.aYl(y.customData);let P=null;for(;y.moveNext();){const aa=y.currentNode;if(aa&&(be.ParagraphReader.ic(aa)&&this.sa.raiseEvent("OPV",new Ef(aa)),this.zXa.update(),this.zXa.bkb())){P=aa;break}}P?this.heh(P):this.fS(!0)};this.Gb=b;this.zXa=h;this.Fz=u;this.sa=new ie.a;this.dvb=new Promise(y=>
{this.fS=y})}Afk(b){this.sa.addHandler("OPV",b)}Xqk(){this.heh(null)}heh(b){const h=new sc.a(3,1,0,this.opo,182);h.customData=b;this.Gb.Xb(h)}aYl(b){if(!b)return Le.a.Dp(this.Fz);b=yd.GraphIterator.$a(b);b.Ab(7);return Le.a.Vr(b,this.Fz)}}Object(m.a)(Mg,"DocumentTraverser",null,[]);class Gi{constructor(b){this.Bc=b}shouldShowEmptyExperienceButton(){return r.AFrameworkApplication.wVd()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.Bc.Ub(Wa.a.Lce,
2,null)}onInviteOthersButtonClick(){this.Bc.Ub(Wa.a.qua,2,null)}}Object(m.a)(Gi,"EmptyCatchUpBehaviorManager",null,[654]);class oh{constructor(b,h){this.Fml=()=>{const u=document.getElementById("flyoutItem0");u&&(w.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),u.focus())};this.Zo=b;this.Vb=h}initialize(){const b=this.Vb.le(xe.AFrame.$_b);b.BK=!0;b.parent=xe.AFrame.Hp;b.hea(this.Fml);this.Zo.uS(xe.AFrame.$_b)}enableF6Focus(){this.Zo.XG(xe.AFrame.$_b)}disableF6Focus(){this.Zo.ex(xe.AFrame.$_b)}}
Object(m.a)(oh,"FlyoutFocus",null,[655]);var vh=c(345);class rj{constructor(b,h,u){this.yCg=this.EMg=this.ksc=this.qhd=!1;this.Eue=this.dad=null;this.E7m=(y,P,aa,ta,Pa)=>{Pa[ag.a.Visible]=!0;Pa[ag.a.On]=this.ksc&&this.qhd;return 32};this.i$m=(y,P,aa)=>{if(1===aa)return this.qhd?(this.EMg||(this.EMg=!0,w.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.dad)return w.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.yCg=!0;this.dad();return 32};this.ga=b;this.PKg=h;this.Vb=u}get Qdf(){return this.Eue?this.Eue:(w.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Qdf(b){this.Eue=b}initialize(){this.Wb()}registerButtonClickedEvent(b){this.dad&&w.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.dad=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.qhd&&w.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.Qdf.getTime();w.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.qhd=!0;(null===(b=r.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||vh.a.n3a("ribbon","catchUp");Ub.c(Wa.a.yBk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.ksc!==b.flyoutIsVisible&&
(this.ksc=b.flyoutIsVisible,Ra.App.xa&&Ra.App.xa.updateCommandUI(!0),this.ksc&&this.yCg&&this.Vb.Dg(xe.AFrame.$_b),this.ksc||this.PKg&&this.PKg.nIm())}logFlightTriggers(b){b.hasFlyoutData&&r.AFrameworkApplication.Ce("WoCha187;WoCha187cf")}Wb(){this.ga.pa(Wa.a.Eij,le.a.frame,this.i$m);this.ga.gb(Wa.a.aQi,le.a.frame,this.E7m,96)}}Object(m.a)(rj,"FlyoutRibbonButton",null,[653]);var La=c(153);class Za{constructor(b,h){this.GQ=null;this.JRd=this.imi=!1;this.vW=b;this.Ne=h;this.Zhb=new La.a;this.mRd=new Map;
this.Zhb.Z(1,new bm.a(new Nk.a));this.Zhb.Z(0,new bm.a(new Nk.a));this.Zhb.Z(2,new bm.a(new Nk.a));this.Zhb.Z(3,new bm.a(new Nk.a));this.mRd.set(3,"CatchUpIndicatorVisible");this.mRd.set(1,"CatchUpIndicatorPreviewed");this.mRd.set(2,"CatchUpIndicatorSelected");this.x8d=0}Hti(b,h){if(this.Zhb.J(h).add(b)){this.sKm(h);switch(h){case 0:w.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:w.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:w.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:w.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.urh()}}Y6m(b){this.Zbl();b=this.vW.OCb(b);for(const h of b)if(this.GQ.remove(h)){this.x8d++;break}}Zbl(){if(!this.GQ){this.GQ=new bm.a(new Nk.a);for(const b of this.vW.GQ)this.GQ.add(b)}}Oik(){w.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.x8d);this.urh()}urh(){this.x8d&&
(this.mDk(),this.YCk())}mDk(){!this.imi&&.5<=this.Zhb.J(0).count/this.x8d&&(this.imi=!0,Ub.c(Wa.a.ABk),w.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}YCk(){if(!this.JRd){var b="";1<=this.Zhb.J(1).count&&(this.JRd=!0,b="previews");1<=this.Zhb.J(2).count&&(this.JRd=!0,b="selections");this.JRd&&(Ub.c(Wa.a.sBk),w.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}sKm(b){(b=this.mRd.get(b))&&this.Ne.logKpiUsage(b,0)}}Object(m.a)(Za,"IndicatorTelemetryActor",
null,[]);var yb=c(509);c(1043);class lc{constructor(b,h){this.n3c=b;this.SCc=h}WZl(){return this.SCc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return yb.b(this.n3c.requestActivities(b,h))}getRelevantActivities(b,h){return this.SCc.promise.then(u=>u.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(u.getRelevantActivitiesResponse):yb.b(this.n3c.requestRelevantActivities(b,h)))}updateActivityState(b){return yb.b(this.n3c.updateActivityState(b))}getActivityFeed(){return this.SCc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):yb.b(this.n3c.requestActivityFeed()))}updateWaterline(){return yb.b(this.n3c.DJn())}}Object(m.a)(lc,"ActivityRepository",null,[]);var Ic=c(1045);class dd{constructor(b){this.vk=b}get $e(){return this.vk&&this.vk.mi?this.vk:null}FLb(b,h){return this.$e?this.$e.NZe(b,!0)?this.$e.FLb(b,h,!0,!0):(w.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(m.a)(dd,"PageViewWrapper",null,
[]);class rd{constructor(b,h,u,y,P,aa=!1){this.activityContentManager=b;this.Bc=h;this.u8k=u;this.Ne=y;this.sbm=P;this.c9b=aa}XCf(b){const h=new Map;h.set("activityType",b.type.toString());this.Ne.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}qCf(b){this.Ne.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}SWm(b){try{const h=b.activity;this.XCf(b.activity);1==h.type&&this.sbm.hYd();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.tro(h),
this.qCf("Content does not exist"),Promise.resolve(2);const u={};let y=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:u.ActivityId=h.activityId;u.NavigationId=atob(h.navigationId);y=this.Bc.Ub(Wa.a.s1e,2,u);break;case 1:u.Activity=h,u.NodeId=b.locationId,y=this.Bc.Ub(Rc.a.L5f,2,u),u.NodeId&&this.Bc.Ub(Rc.a.EXd,2,u)}8==y&&this.qCf("Action failed")}catch(h){return w.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.qCf("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.u8k.dvb.then(()=>this.SWm(b))}}Object(m.a)(rd,"WordActivityNavigationManager",null,[651]);var Wd;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Wd||(Wd={}));Object(m.b)("ProfilePhotoDimension",Wd);var Be=
c(789),sf=c(1440),Th=c(530);class hj{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(hj,"ActivityRequestPayload",null,[]);class qg{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(m.a)(qg,"Person",null,[]);class Di extends Do{constructor(){super();this.relationship=0}}Object(m.a)(Di,"TaskActivity",Do,[]);class Ej extends Do{constructor(){super();
this.contentId=null}}Object(m.a)(Ej,"CommentActivity",Do,[]);class aj extends Ej{constructor(){super()}}Object(m.a)(aj,"CommentReplyActivity",Ej,[]);class Ze extends Ej{constructor(){super();this.zKi=null}}Object(m.a)(Ze,"MentionActivity",Ej,[]);class ue{constructor(b,h,u,y){this.Epb=b;this.wab=h;this.XHe=u;this.iN=y;this.iN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Epb.WZl().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Q4e("GetWYWAActivities",b);155===b.StatusCode&&
(w.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.iN.isFirstDocumentOpen=!0);const h=this.Bag(b.People);return Object.assign(new hj,{activities:this.gge(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.Epb.getActivities(b,h).then(u=>{if(!u||u.StatusCode)throw this.Q4e("GetActivities",u);const y=
this.Bag(u.People);return Object.assign(new hj,{activities:this.gge(u.Activities,y),actors:y,hasMore:!u.RequestedRetrieved,highWaterline:u.HighWaterline,lowWaterline:u.LowWaterline})})}requestRelevantActivities(b){return this.Epb.getRelevantActivities(b,this.iN.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.Q4e("GetRelevantActivities",h);const u=this.Bag(h.People),y=this.gge(h.NewActivities,u,2);h=this.gge(h.OutstandingActivities,u,3);for(const P of h)y.push(P);return Object.assign(new hj,
{activities:y,actors:u})})}updateActivityState(b){return this.Epb.updateActivityState(b)}requestActivityFeed(){return this.Epb.getActivityFeed().then(b=>({activityFeedItems:b}))}gge(b,h,u=1){const y=[];if(!b)return y;for(const ta of b){var P=null;b=[];b.push(h[ta.CreatorIndex]);switch(ta.ActivityType){case 1:P=ta;var aa=new xp;aa.ov=new ob.a;for(const Pa of P.ChangeIds)aa.ov.add($i.b(Pa));aa.objectId=$i.b(P.ObjectId);P=aa;break;case 2:P=ta;aa=new Ej;aa.contentId=P.ContentId;aa.navigationId=P.NavigationId;
P=aa;break;case 4:P=ta;aa=new Ze;b.push(h[P.MentioneeIndex]);aa.zKi=P.ParentContentId;aa.navigationId=P.NavigationId;P=aa;break;case 3:case 10:P=ta;aa=new aj;b.push(h[P.RepliedIndex]);aa.contentId=P.ContentId;aa.navigationId=P.NavigationId;P=aa;break;case 6:case 7:case 8:case 9:P=ta,aa=new Di,b.push(h[P.MentioneeIndex]),aa.navigationId=P.NavigationId,aa.relationship=P.Relationship,P=aa}P&&(P.actors=b,P.displayTimestamp=new Date(ta.DisplayTimestamp),P.activityId=$i.b(ta.ActivityId).toString(),P.type=
ta.ActivityType,1!==u&&(P.relevancy=u),y.push(P))}return y}sMn(b,h,u){return this.XHe&&!Oe.b(b)&&this.XHe.qVd?this.XHe.E1b(h,u,r.AFrameworkApplication.Gm,Wd.default):b}Bag(b){if(!b)return null;const h=Array(b.length);for(let u=0;u<b.length;u++){if(!b[u])continue;const y=new qg;y.id=b[u].Id;y.provider=b[u].Provider;y.displayName=b[u].DisplayName;y.email=b[u].Email;y.imageUrl=this.sMn(b[u].PictureUrl,b[u].Email,b[u].Provider);this.wab&&(y.color=this.wab.HMc(new Be.a(y.email,void 0,y.displayName),sf.a.catchUpFlyout));
h[u]=y}return h}Q4e(b,h){let u="null";h&&(u=Th.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,u))}}Object(m.a)(ue,"WordActivityRequestManager",null,[652]);class $e{constructor(b,h,u){this.ukd=0;this.uwc=!1;this.zTg=null;this.updateWaterline=()=>{if(Ra.App.lostSession)w.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.uwc||3>=this.ukd){this.uwc?this.uwc=!1:this.ukd++;const y=Math.max(this.Ma.pc("WordEditorActivityManagementMaturityMiliSeconds",
30001)+5E3-(+new Date-+this.zTg),0);w.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",y);pf.Task.delay(y).continueWith(()=>{this.Epb.updateWaterline().then(()=>{this.Y9d();return null}).catch(()=>{this.Y9d();this.uwc=!0;this.ukd=0})})}else this.Y9d()};this.Ma=b;this.Epb=u;h.PTe(()=>{this.uwc=!0;this.zTg=new Date;this.ukd=0})}start(){this.Y9d()}Y9d(){window.setTimeout(this.updateWaterline,6E4)}}Object(m.a)($e,"WordEditorActivityScheduler",null,[]);class rg{constructor(){this.resolve=
null;this.promise=new Promise(b=>{this.resolve=b})}GVn(b){this.resolve(b)}}Object(m.a)(rg,"CatchUpNetworkRequestWorkerCache",null,[]);class Hf{constructor(b,h,u){this.wZk=b;this.K=h;this.Ne=u}YNf(b){b&&b.authors&&this.mKm(b.authors)}mKm(b){for(const h of b)h&&h.displayName===this.wZk&&(this.Ne.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),w.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",
h.id===this.K.lb("PresenceUserId"),h.email===this.K.lb("UserPrincipalName")))}}Object(m.a)(Hf,"WywaAuthorComparator",null,[]);class zj{constructor(b){this.X_=b}hYd(){this.X_&&this.X_.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(m.a)(zj,"IndicatorSurveyActor",null,[]);var Oi=c(1017),bj=c(1010);class Nj{constructor(){this.BBk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get uBk(){return r.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get huf(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get zii(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get Uhi(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get LRd(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get ZPc(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCatchUpActivitiesReadyTelemetryFixEnabled",
!1)}get nym(){return r.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get c9b(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}xc(b){Cl("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new rg).singleInstance()}init(){Cl("Init");this.uBk&&(K.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,
4,r.AFrameworkApplication.rootQuerySignature,Ra.App.webServiceBase+"OneNote.ashx",2,this.LRd)}),Cl("HotStore"),Ra.App.qia.wEb.execute(()=>{Cl("ChromeReady");Zh.a.get_instance().al(7,()=>{Cl("ScriptDownload");(r.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").pA.loadScript("catchUpActivity")).catch(b=>{w.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",
b)}).then(()=>this.y1m()).catch(b=>{w.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}y1m(){Cl("CreateObjectsAndInitializeState");this.pJm();this.aRk();return this.tdm()}pJm(){w.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");w.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");w.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.huf&&w.ULS.sendTraceTag(588130079,
3012,50,"ChangeSummaries is enabled");this.zii&&w.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.Uhi&&w.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");w.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.nym);this.LRd&&w.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}tdm(){this.Ydm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Qdf=new Date;Cl("InitializeCatchUpApp");return this.Z_b.initialize(Object.assign(new up,
{featuredActivityGroupsEnabled:this.huf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.zii,customDynamicEntryPointEnabled:this.Uhi,activityFeedDataEnabled:this.LRd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}aRk(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new fr(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),vk.App.Fn.jb.wc.jd)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new Oi.a(Ta.Health.instance,new bj.a,this.BBk)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Cn).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new lp(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),r.AFrameworkApplication.ya,Vj.UISurfaces.KI(),this.c9b)).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new lc(new Ic.a(Jh.a.zij(this.container.Za("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>r.AFrameworkApplication.rootQuerySignature,Ra.App.webServiceBase+"OneNote.ashx",2,Jh.a.zij(this.container.Za("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new ue(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.c9b)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new ss(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
vk.App.Fn.jb.wc,new dd(vk.App.Fn.jb.wc),Hh.a.instance,ub.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Bn.a(50,Je.a.Ye):new Mk;return new Mg(r.AFrameworkApplication.uc,b,vk.App.Fn.jb.wc.jd)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",
()=>new zj(this.container.Za("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new rd(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),r.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.c9b)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new rj(r.AFrameworkApplication.ya,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),ub.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new oh(go.a.instance,ub.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",
()=>new Qd).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new ts(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),vk.App.Fn.jb.wc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Yd(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",
()=>new Y(new pa(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Dq(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),r.AFrameworkApplication.uc),new gd(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.c9b)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Gi(r.AFrameworkApplication.ya)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").singleInstance();this.Z_b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new vp,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:r.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:r.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.LRd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:r.AFrameworkApplication.uiCulture,ulsLogger:new nm.a}));this.Z_b.setWebpackPublicPath(r.AFrameworkApplication.u4);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new Ws(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new $e(r.AFrameworkApplication.K,Aq.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Za(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Cq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.Z_b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),vk.App.Fn.jb.wc,this.container.Za("Common.IZoomManager"),r.AFrameworkApplication.uc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Ra.App.instance&&Ra.App.instance.vna,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ra.App.instance&&Ra.App.instance.bC)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Hs(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,vk.App.Fn.jb.wc.jd,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),r.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.ZPc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new jn(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),r.AFrameworkApplication.ya,ub.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Hf(r.AFrameworkApplication.userName,r.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}Ydm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.s4a(h);const u=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const y=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const P=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
aa=Hh.a.instance,ta=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");aa.DA(()=>{P.rUd?P.rUd=!1:(P.X4a&&u.ZGi(null,null,!1),P.thb&&u.hGi(null,null),y.i0e())});aa.DA(Object(v.a)(h,h.R3,"onSelectionChanged"));this.Z_b.getWywaEvent().addListener(Object(v.a)(b,b.YNf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.Z_b.getWywaEvent().addListener(Object(v.a)(b,b.YNf,"onWywaActivityReady"));const Pa=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");
ta.Afk((vb,Kb)=>{Kb&&Pa.Y6m(Kb.node)});ta.dvb.then(()=>{Pa.Oik()});this.Z_b.getWywaEvent().addListener(()=>{ta.Xqk()});y.Sdk((vb,Kb)=>{Kb&&u.hGi(Kb.yBb,Kb.Gci)});y.Tdk((vb,Kb)=>{Kb&&u.ZGi(Kb.yBb,Kb.Gci,Kb.p7n)});y.Wb(r.AFrameworkApplication.ya);this.huf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Wb(r.AFrameworkApplication.ya);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.vao()}vao(){fh.c()&&(w.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(m.a)(Nj,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var lh=c(154),Fk=c(442),Rq=c(1467),Ym=c(486),xv=c(1565),Sq=c(1470),Xs=c(1623),Ln=c(1624),gr=c(647),rt=c(1625),
Vv=c(851),hr=c(147),om=c(1476);class mu{constructor(){this.qt=this.annotation=null}}Object(m.a)(mu,"AnnotationChangedData",null,[]);class Rn{constructor(b,h,u,y,P,aa,ta,Pa=!1,vb){this.annotationType=b;this.j2=h;this.rq=u;this.Xde=y;this.V7c=P;this.xDo=aa;this.jb=ta;this.U9i=Pa;this.K=vb;this.ry=null;this.lmi=!1;this.Ld=new ie.a;this.cWc=0}lF(b){this.Ld.addHandler("AnnotationChangedEvent",b)}wH(b){this.Ld.removeHandler("AnnotationChangedEvent",b)}register(){return this.V7c().then(()=>{0===this.cWc&&
(this.U9i&&(this.ry=this.rq.jg("WebServiceCall",this.annotationType)),this.j2.mb(this,this.annotationType));this.cWc++})}unregister(){return this.V7c().then(()=>(new Promise(b=>setTimeout(b,this.K.pc(hr.a.u3k,3E3)))).then(()=>{0<this.cWc&&(this.cWc--,0===this.cWc&&this.j2.sc(this,this.annotationType))}))}n4b(){return this.V7c().then(()=>this.j2.getAnnotationsByType(this.annotationType))}qSh(b){b=Fk.a.UL(b);return(b=this.j2.pSh(b))&&0<b.count?b.toArray().filter(h=>Ap.a.matchesTypesFor(h.content,[this.annotationType])):
[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.xDo(this.jb.Yc.Bd,b.parentPath):null:(w.ULS.shipAssertTag(575930380,3016,!1),null)}bua(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new Vv.a,{parentPath:["Signal",Ap.a.getTypeNameFor(b)],items:[Object.assign(new us.a,{body:b})]});this.Xde.submitOperation(b)}W$k(b,h){b=Object.assign(new pk.a,{parentPath:["Signal",h],items:b});this.Xde.submitOperation(b)}mD(b,h){b?h?(this.U9i&&!this.lmi&&(this.ry.stop(),this.lmi=!0),this.Ld.m7&&
(b=new om.a(Object.assign(new mu,{annotation:b,qt:h})),this.Ld.raiseEvent("AnnotationChangedEvent",b))):w.ULS.shipAssertTag(575930382,3016,!1):w.ULS.shipAssertTag(575930381,3016,!1)}}Object(m.a)(Rn,"AnnotationManager",null,[661,220]);class xm{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.sI=b;this.A9d=h;this.NBb=u;this.u_a=y;this.M6=P;this.Ohj=aa;this.n0=ta;this.RNb=Pa;this.B2b=vb;this.XJb=Kb;this.Sjo=Sb}}Object(m.a)(xm,"AnnotationManagerHolder",null,[660]);class yv{constructor(b,h){this.SXa=b;this.V7c=
h}submitOperation(b){return this.V7c().then(()=>{this.SXa.getAugLoopRuntimeManager().submitOperation(Object.assign(new Lr.a,{operation:b}))})}}Object(m.a)(yv,"SubmitOperationHelper",null,[]);var bv=c(868),Dn=c(1626),Mo=c(1041),wj=c(99),ro=c(140),En=c(91),Nt=c(1071);class pl{constructor(b,h,u){this.M6=b;this.un=h;this.MJi=u;this.yCa={};this.TGh=!1;this.ykb=(y,P)=>{var aa;P.data.qt!==pk.a.getTypeName()&&P.data.qt!==Nt.n.getTypeName()||!P.data.annotation||P.data.annotation.annotationType!==Dn.a.getTypeName()||
(y=P.data.annotation.content)&&null!==(aa=y.documentTypeConfidences)&&void 0!==aa&&aa.length&&(this.SGh=y.documentTypeConfidences[0].documentTypeLabel,w.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.SGh))};this.M6.lF(this.ykb);this.M6.register();this.yCa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}zKd(){this.TGh||(this.M6.bua(new Mo.a),
w.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.TGh=!0);this.y7k();this.yCa.docType=this.SGh;this.yCa.characterCount=this.characterCount;this.yCa.paragraphCount=this.C_;this.yCa.imageCount=this.nQ;this.yCa.tableCount=this.Cpa;this.yCa.listElementsCount=this.Vri;this.yCa.blobsCount=this.llh;this.yCa.pageCount=this.MJi.DMc();this.yCa.currentPage=this.MJi.g1h();return this.yCa}y7k(){this.C_=this.llh=this.Vri=this.Cpa=this.nQ=this.characterCount=0;var b=this.un.ZCa(vk.App.Fn.jb.wc.jd,
7,7).currentNode,h=yd.GraphIterator.$a(b);for(b=Le.a.Vr(h,b);b.moveNext();)if(h=b.currentNode)if(Jd.ImageReader.Wu(h))this.nQ++;else if(xh.TableReader.yX(h))this.Cpa++;else if(wj.ListReader.E7(h))this.Vri++;else if(be.ParagraphReader.ic(h)){var u=En.e(h);for(let y=0;y<u.length;y++)5===u[y].li?this.nQ++:this.llh++;u=ro.AParagraphNode.uU(h.characterData);u=u.trim();this.characterCount+=u.length;0<u.length&&!be.ParagraphReader.Vaa(h)&&!be.ParagraphReader.sX(h)&&this.C_++}}}Object(m.a)(pl,"LoggingDocumentInfo",
null,[551]);class Iu{constructor(){this.sa=new ie.a}Tfk(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}UFn(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}Wek(b){this.sa.addHandler("BlueDotClickedEvent",b)}DFn(b){this.sa.removeHandler("BlueDotClickedEvent",b)}ifk(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}kfk(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}hfk(b){this.sa.addHandler("OnFormattingAccept",b)}jfk(b){this.sa.addHandler("OnFormattingReject",b)}Lfk(b){this.sa.addHandler("OnReviewInvalidated",
b)}xfh(b){this.sa.addHandler("OnTraigeAction",b)}NTe(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}OFn(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}Uek(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}Hfk(b){this.sa.addHandler("OnRegisterEnhancement",b)}Vfk(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}VFn(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}g_c(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new om.a(b)):w.ULS.shipAssertTag(575930374,3016,
!1)}Nrn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new om.a(b)):w.ULS.shipAssertTag(575930375,3016,!1)}Qrn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new om.a(b)):w.ULS.shipAssertTag(575930376,3016,!1)}DQi(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new om.a(b)):w.ULS.shipAssertTag(573850377,3016,!1)}Prn(b){b?this.sa.raiseEvent("OnFormattingAccept",new om.a(b)):w.ULS.shipAssertTag(575930377,3016,!1)}Rrn(b){b?this.sa.raiseEvent("OnFormattingReject",new om.a(b)):w.ULS.shipAssertTag(575930378,
3016,!1)}Srn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new om.a(b)):w.ULS.shipAssertTag(575930379,3016,!1)}MUf(b){b?this.sa.raiseEvent("OnTraigeAction",new om.a(b)):w.ULS.shipAssertTag(573850378,3016,!1)}EQi(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new om.a(b)):w.ULS.shipAssertTag(573850379,3016,!1)}Mrn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new om.a(b)):w.ULS.shipAssertTag(573687395,3016,!1)}Xdc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new om.a(b)):w.ULS.shipAssertTag(555055117,
3016,!1)}YQi(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new om.a(b)):w.ULS.shipAssertTag(540587343,3016,!1)}}Object(m.a)(Iu,"ReviewEvents",null,[550]);class zv{constructor(b){this.Ht=b;if(!b)throw lh.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}xc(b){this.W=b;b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new yv(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Fk.a.nm)).singleInstance();b.ha("WordEditor.Designer.IDesignerControl",
()=>new bv.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),r.AFrameworkApplication.uiCulture)).singleInstance();b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Iu).singleInstance();b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new xm(this.WBa(Sq.DocumentRoleDetectionAnnotation.getTypeName()),this.WBa(Sq.RoleDetectionAnnotation.getTypeName()),this.WBa(Rq.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.WBa(Rq.FormattingSuggestionsAnnotation.getTypeName()),
this.WBa(Ym.DocumentTypeClassifierAnnotation.getTypeName()),this.WBa(Ln.ThemeExtractorAnnotation.getTypeName()),this.WBa(gr.ThemeGeneratorAnnotation.getTypeName()),this.WBa(Xs.TextToImageAnnotation.getTypeName()),this.WBa(xv.DocumentPullQuoteAnnotation.getTypeName()),this.WBa(xv.PullQuoteAnnotation.getTypeName()),this.WBa(rt.TableTypeAnnotation.getTypeName()))).singleInstance();b.ha("WordEditor.Designer.DocumentInfo",()=>new pl(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").M6,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()}dispose(){}WBa(b,h=!1){return new Rn(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Fk.a.nm,Fk.a.wgb,this.Ht,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(m.a)(zv,"PackageManager",null,[1,2]);var Eq=c(1482),wr=c(1461),Q=c(1628);class ya extends Sys.EventArgs{constructor(b,
h){super();this.node=b;this.yIf=h}}Object(m.a)(ya,"RoleChangeArgs",Sys.EventArgs,[]);class kb{constructor(b){this.Mh=!1;this.kP=b;this.kP.Ngd++}dispose(){this.Mh||(this.Mh=!0,this.kP.Ngd--)}}Object(m.a)(kb,"InvalidationSuspension",null,[9]);class Mb{constructor(){this.f5c=null;this.role=this.yZd=0;this.Yxb=this.AUd=this.qna=this.Z9b=!1;this.LYd=this.EUc=this.pNa=null;this.removed=this.placeholder=!1;this.Tvd=this.CFc=null;this.Svd=0}get H1a(){return!this.role||!this.pNa||!this.pNa.length}kim(){this.Yxb=
this.AUd=!0}Dym(){return!!this.role||!!this.pNa||!!this.f5c}}Object(m.a)(Mb,"RoleState",null,[585]);class vc{constructor(b,h,u,y,P,aa){this.Ah=!1;this.vRd=null;this.UDf=new Fh.a;this.sNg=0;this.GNn=(ta,Pa)=>{Pa.data.qt===pk.a.getTypeName()&&(Pa=Pa.data.annotation,(ta=Pa.content)?(Pa=this.xWb.getParent(Pa))&&this.K2c(Pa,wr.e(ta.roleType),!1,void 0,null!=ta.listID?ta.listID:0,ta.listItemlevel,ta.listItemPrefix):w.ULS.shipAssertTag(575813856,3016,!1))};this.g8k=(ta,Pa)=>{if(Pa.data.qt===pk.a.getTypeName())if(ta=
Pa.data.annotation.content)for(w.ULS.sendTraceTag(556074199,3016,50,ta.confidence.toString()),this.UDf=new Fh.a,Pa=0;ta.listInfos&&Pa<ta.listInfos.length;Pa++){const vb=ta.listInfos[Pa];this.UDf.Z(vb.listID,vb)}else w.ULS.shipAssertTag(556323522,3016,!1)};this.bli=(ta,Pa)=>{ta=ta.AJ;if(!ta||ta.ia(Lc.a.HA,!1))return!1;ta=ta.getValue(Lc.a.la);if(!ta)return!1;ta=wr.f(ta);return 1!=ta&&ta!=Pa.role};this.rol=(ta,Pa)=>{ta=Pa.data.annotation;const vb=this.Ged.getParent(ta);if(vb)if(Pa.data.qt===pk.a.getTypeName()){const Kb=
Pa.data.annotation.content;Kb?this.lca(vb,Sb=>{this.vRd&&Sb.CFc&&this.vRd>Sb.CFc&&!Sb.Yxb||Sb.role!==Sb.yZd||this.bli(vb,Sb)?(w.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.vRd,Sb.Yxb,Sb.role===Sb.yZd),Sb.f5c=Kb.suggestions):(Sb.pNa=Kb.suggestions,Sb.Yxb=!1)}):w.ULS.shipAssertTag(575813859,3016,!1)}else Pa.data.qt===Eq.a.getTypeName()&&this.lca(vb,Kb=>{Kb.pNa=null;Kb.f5c=null});else w.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ta.id} parentPath: ${ta.parentPath}`)};
this.c4m=(ta,Pa)=>{(ta=Pa.data.paragraphNode)?this.lca(ta,vb=>{Pa.data.Hrj?(vb.Tvd=vb.pNa,vb.Svd=vb.role):(vb.Tvd=null,vb.Svd=0);vb.qna=!0}):w.ULS.shipAssertTag(575930368,3016,!1)};this.e4m=(ta,Pa)=>{(ta=Pa.data.paragraphNode)?this.lca(ta,vb=>{vb.qna=!1;vb.Tvd=null;vb.Svd=0;5!==Pa.data.state&&(vb.pNa=null)}):w.ULS.shipAssertTag(573850380,3016,!1)};this.a4m=(ta,Pa)=>{(ta=Pa.data.paragraphNode)?this.lca(ta,vb=>{vb.qna=!0}):w.ULS.shipAssertTag(575930369,3016,!1)};this.d4m=(ta,Pa)=>{(ta=Pa.data.paragraphNode)?
this.K2c(ta,1,!0,!0):w.ULS.shipAssertTag(575930370,3016,!1)};this.INf=(ta,Pa)=>{(ta=Pa.data.paragraphNode)?this.K2c(ta,Pa.data.yIf,!0,!0):w.ULS.shipAssertTag(575484484,3016,!1)};this.N0l=(ta,Pa)=>{if(Pa.node){var vb=Pa.node;ta=this.RA(vb);27==ta.role&&w.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ta.qna&&27!==ta.role&&28!==ta.role&&this.R8i(this.ifc-1);ta.H1a||27===ta.role||28===ta.role||this.K8i(this.inconsistenciesCount-1);this.lca(vb,Kb=>{Kb.removed=!0});this.$0.fii()||setTimeout(()=>
this.removeNode(vb),1E4)}else w.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ta=>{this.qVi(ta.id)};this.qVi=ta=>{let Pa;({value:Pa}=this.yq.Gc(ta));(null===Pa||void 0===Pa?0:Pa.removed)&&this.yq.remove(ta)};this.fEn=()=>{const ta=this.yq.keys.toArray().filter(Pa=>this.yq.J(Pa).removed);ta.sort((Pa,vb)=>this.yq.J(Pa).CFc.getTime()-this.yq.J(vb).CFc.getTime());ta.slice(0,10).forEach(Pa=>{this.qVi(Pa)})};this.M0l=(ta,Pa)=>{Pa.node?(ta=Pa.node,this.ARc(ta)?this.lca(ta,vb=>{vb.removed=!1}):this.lca(ta,
vb=>{vb.Yxb=!1})):w.ULS.shipAssertTag(540672206,3016,!1)};this.O0l=(ta,Pa)=>{Pa.node?this.E4f(Pa.property,Pa.node)&&(ta=Pa.node,this.Ngd||ta.V4d?this.lca(ta,vb=>{vb.Yxb=!1}):this.lca(ta,vb=>{vb.kim();vb.f5c&&(vb.pNa=vb.f5c,vb.role=vb.yZd)}).qna&&this.EWa.Srn(new Q.a(Pa.node))):w.ULS.shipAssertTag(575930372,3016,!1)};this.U7m=(ta,Pa)=>{switch(Pa.data.role){case 27:const vb=Pa.data;this.lca(Pa.data.paragraphNode,Sb=>{Sb.role=27;Sb.Z9b=!0;Sb.placeholder=vb.placeholder});break;case 28:const Kb=Pa.data;
this.lca(Pa.data.paragraphNode,Sb=>{Sb.role=28;Sb.Z9b=!0;Sb.placeholder=Kb.placeholder;Sb.sOc=Kb.sOc});break;case 2:this.lca(Pa.data.paragraphNode,Sb=>{Sb.role=2})}};this.Ged=b;this.xWb=h;this.ose=u;this.$0=aa;this.Dn=y;this.EWa=P;this.yq=new Fh.a;this.sa=new ie.a;this.Ngd=this.Jod=this.sgd=0}get Him(){return this.Ngd}mfk(b){this.sa.addHandler(vc.AEi,b)}Mfk(b){this.sa.addHandler(vc.IGi,b)}pfh(b){this.sa.addHandler(vc.eNf,b)}PFn(b){this.sa.removeHandler(vc.eNf,b)}get inconsistenciesCount(){return this.sgd}K8i(b){this.sgd!==
b&&(this.sgd=b,this.sa.raiseEvent(vc.AEi,new om.a(this.sgd)))}get ifc(){return this.Jod}R8i(b){this.Jod!==b&&(this.Jod=b,this.sa.raiseEvent(vc.IGi,new om.a(this.Jod)))}get tqf(){return this.sNg}ARc(b){return this.yq.ub(b.id)}tJl(b){var h,u;return null===(u=null===(h=this.UDf)||void 0===h?void 0:h.Gc(b))||void 0===u?void 0:u.value}w1h(b,h){var u,y,P;const aa=new Map;for(const ta of h)if((h=ta)&&h.isConnected){const Pa=null!==(P=null===(y=null===(u=this.yq.Gc(h.id))||void 0===u?void 0:u.value)||void 0===
y?void 0:y.role)&&void 0!==P?P:1;b.has(Pa)&&(aa.has(Pa)?aa.get(Pa).add(h):aa.set(Pa,new ob.a([h])))}return aa}RA(b){if(!b)return w.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.yq.Gc(b.id)).returnValue?h:Object.assign(new Mb,{role:1,Z9b:!1})}qJn(){this.vRd=new Date;return new kb(this)}register(){this.Ged.register();this.xWb.register();this.ose.register()}unregister(){this.Ged.unregister();this.xWb.unregister();this.ose.unregister()}initialize(){if(!this.Ah){const b=this.Dn.Xe(12);
b.Mv(this.N0l);b.mu(this.M0l);b.Ap(this.O0l);this.Ged.lF(this.rol);this.xWb.lF(this.GNn);this.ose.lF(this.g8k);this.EWa.jfk(this.d4m);this.EWa.hfk(this.a4m);this.EWa.ifk(this.c4m);this.EWa.kfk(this.e4m);this.EWa.xfh(this.INf);this.EWa.Hfk(this.U7m);this.Ah=!0}}he(){}K2c(b,h,u,y=!1,P=0,aa=0,ta){let Pa=0,vb=!1;this.lca(b,Kb=>{const Sb=Kb.AUd||!Kb.role||1==Kb.role;u||(Kb.yZd=h);if(y||Sb)vb=Kb.role!==h,Pa=Kb.role,Kb.role=h,Kb.Z9b=u,Kb.AUd=!1,Kb.EUc=P,Kb.LYd=aa,Kb.listItemPrefix=ta,Kb.CFc=new Date});if(vb){const Kb=
h-4;Kb>this.tqf&&8>Kb&&(this.sNg=Kb);1===h&&this.lca(b,Sb=>{Sb.pNa=null});this.sa.raiseEvent(vc.eNf,new om.a(new ya(b,h,Pa)))}}lca(b,h){let u;if(({value:u}=this.yq.Gc(b.id)).returnValue){b=u.H1a;const y=u.qna;h(u);if(27!==u.role&&28!==u.role){if(u.removed)return u;b!==u.H1a&&this.K8i(this.inconsistenciesCount+(b?1:-1));y!==u.qna&&this.R8i(this.ifc+(y?-1:1))}}else h(u=new Mb),u.Dym()&&(this.$0.fii()&&this.yq.count>hr.a.INn&&(w.ULS.sendTraceTag(525165656,3016,50,this.yq.count.toString()),this.fEn()),
this.yq.add(b.id,u));return u}E4f(b,h){({value:h}=this.yq.Gc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Ge.a.Co:!(null===h||void 0===h?0:h.placeholder)&&(b===Ge.a.Co||b===Ge.a.An||Array.contains(ro.AParagraphNode.Kfa(),b))}}vc.AEi="OnInconsistenciesChanged";vc.IGi="OnRoleReviewCount";vc.eNf="OnRoleChanged";Object(m.a)(vc,"RoleLifecycleManager",null,[553,554,555]);class id{constructor(b,h,u,y,P){this.EWa=b;this.xWb=h;this.wf=u;this.Dn=y;this.kP=
P;this.Ah=!1;this.INf=(aa,ta)=>{(aa=ta.data.paragraphNode)?this.foj(aa,()=>!0,Pa=>Pa.userSetRole=wr.d(ta.data.yIf)):w.ULS.shipAssertTag(557057378,3016,!1)};this.V6m=(aa,ta)=>{0<this.kP.Him||this.E4f(ta.property)&&this.foj(ta.node,Pa=>!(Pa&&Pa.isInvalidated),Pa=>Pa.isInvalidated=!0)}}initialize(){this.Ah||(this.EWa.xfh(this.INf),this.Dn.Xe(12).Ap(this.V6m),this.Ah=!0)}he(){}foj(b,h,u){if(b=(b=this.xWb.qSh(b))&&1===b.length&&b[0]){var y=b.content;y=y&&y.M_&&y.M_.customMetadata;h(y)&&(h=new Sq.RoleDetectionCustomMetadata,
h.isInvalidated=y&&y.isInvalidated,h.userSetRole=y&&y.userSetRole,u(h),this.wf.jvo(b,h))}}E4f(b){return b===Ge.a.Co||b===Ge.a.An||Array.contains(ro.AParagraphNode.Kfa(),b)}}Object(m.a)(id,"RoleDetectionMetadataUpdater",null,[552]);class ae{constructor(b,h){this.Xde=b;this.DAb=h;this.DWc=(u,y)=>{u=y.data;if(u.qt==Nt.a.getTypeName()||u.qt==Nt.n.getTypeName())if(u=u.annotation&&u.annotation.content)this.runId=u.runId};this.revisionId=0}initialize(){this.DAb.lF(this.DWc)}he(){this.DAb.wH(this.DWc)}M0m(){if(void 0===
this.runId)Promise.resolve();else{var b=new Sq.RoleDetectionSettings({acceptedRunId:this.runId});b=new Nt.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Xde.submitOperation(b)}}}Object(m.a)(ae,"RoleDetectionSettingsUpdater",null,[]);class we{constructor(b,h,u){this.yhm=b;this.j2=h;this.Ie=u;this.Jei=this.initialized=!1;this.ACi=()=>{this.t$i()&&(this.qdi(),this.j2.vFn(this.ACi))}}initialize(){this.initialized||(this.rsf(),
this.initialized=!0)}he(){}rsf(){this.t$i()?this.qdi():this.j2.Iek(this.ACi)}t$i(){return!this.Jei&&(this.Ie.eii()||this.j2.T7b(Sq.DocumentRoleDetectionAnnotation.getTypeName())||this.j2.T7b(Sq.RoleDetectionAnnotation.getTypeName()))}qdi(){for(const b of this.yhm)b.initialize();this.Jei=!0}}Object(m.a)(we,"RLMInitializer",null,[]);class Ee{constructor(b,h,u){this.S4=b;this.Ht=h;this.C$c=u;this.W=null;this.aia=()=>{this.EPc();this.Ht.Zlb(this.aia)};if(!b)throw lh.a.argument("AppLifecycleManager is null");
if(!h)throw lh.a.argument("Workspace is null");if(!u)throw lh.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>this.$m())}xc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new ae(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sI)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",
()=>new id(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A9d,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new vc(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").u_a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").A9d,
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sI,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new we([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}$m(){this.C$c.ZI?this.S4.al(16,()=>this.VOc()):this.VOc()}VOc(){this.Ht.pva?this.EPc():this.Ht.kea(this.aia)}EPc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}
Object(m.a)(Ee,"PackageManager",null,[1,2]);class jf{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const u=new jf;u.ContractVersion=b;u.FileName=h;u.Paragraphs=[];return u}}Object(m.a)(jf,"DocumentSwayPreviewContent",null,[]);class Ng{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static IOk(b,h,u,y){const P=new Ng;P.RawText=b;P.ParagraphFormatting=h;P.TextRuns=u;P.IsRTL=y;P.ParagraphIndex=
0;return P}}Object(m.a)(Ng,"ParagraphContent",null,[]);var Fg=c(110),ck=c(1177);class Ki{constructor(){this.Name=null;this.Size=0}static construct(b,h){const u=new Ki;u.Name=b;u.Size=h;return u}}Object(m.a)(Ki,"FontData",null,[]);class Il{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,u,y,P,aa){const ta=new Il;ta.IsBold=b;ta.IsUnderline=h;ta.IsUppercase=u;ta.Font=y;ta.Alignment=P;ta.LeftIndent=aa;return ta}}Object(m.a)(Il,
"TextFormatting",null,[]);class wl{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const u=new wl;u.RawText=b;u.RunFormatting=h;return u}}Object(m.a)(wl,"TextRunContent",null,[]);var Wi=c(109),wg=c(43);class xr{constructor(b,h){this.qRb=null;this.tTj=b;this.YM=h||""}get Wcn(){return this.tTj.value}sfl(){var b=Date.now();const h=jf.construct(2,this.YM);h.Paragraphs=this.isl();b=Date.now()-b;const u={};u.ExtractionDurationInMs=b.toString();w.ULS.sendTraceTag(25268374,382,50,
"{0}",u);return h}isl(){const b=new ob.a;var h=0;let u=0,y=!1;var P=new yd.GraphIterator;P.set(this.Wcn);P=Le.a.Dp(P.currentNode);const aa=new Fh.a(0);for(;P.moveNext()&&2100>u&&25>h;){var ta=P.currentNode;if(be.ParagraphReader.ic(ta)&&!be.ParagraphReader.Vaa(ta)){!y&&be.ParagraphReader.sX(ta)&&(y=!0);let Pa=ro.AParagraphNode.uU(ta.characterData);Pa=Pa.trim();if(0<Pa.length){const vb=this.Agb(ta);vb.ParagraphIndex=h;h++;u+=Pa.length;b.add(vb);this.yyo(aa,be.ParagraphReader.language(ta))}}}this.qRb=
this.$yl(aa);h={};h.documentHasList=y;w.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}$yl(b){let h=-1,u=1033;for(const y of b.keys.toArray())y&&b.J(y)>h&&(h=b.J(y),u=y);return zl.a.sg(u)}yyo(b,h){b.ub(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}Agb(b){const h=ro.AParagraphNode.uU(b.characterData),u=this.ONl(b),y=this.UWl(b);b=this.ptm(b);return Ng.IOk(h,u,y,b)}ONl(b){const h=be.ParagraphReader.Um(b,Ge.a.bold,!1),u=be.ParagraphReader.Um(b,Ge.a.underline,!1);var y=be.ParagraphReader.Um(b,Ge.a.fontSize,
Fg.a.qI);const P=be.ParagraphReader.Um(b,Ge.a.font,Fg.a.EF);var aa=be.ParagraphReader.Vv(b);aa=this.Jff(aa);const ta=!!be.ParagraphReader.Um(b,vi.a.capitalization,0);b=(new ck.a).oT(b).value/20;y=Ki.construct(P,y);return Il.construct(h,u,ta,y,aa,b)}UWl(b){const h=new ob.a;for(let P=0;P<b.qa.length-1;P++){var u=b.qa.J(P),y=b.qa.J(P+1);u.formatting&&(y=ro.AParagraphNode.uU(b.characterData.substr(u.cp,y.cp-u.cp)),u=this.VWl(u.formatting),u=wl.construct(y,u),h.add(u))}return h.toArray()}VWl(b){const h=
Wi.FormattingReader.qMc(b,Ge.a.bold,!1),u=Wi.FormattingReader.qMc(b,Ge.a.underline,!1);var y=Wi.FormattingReader.qMc(b,Ge.a.fontSize,Fg.a.qI);const P=Wi.FormattingReader.qMc(b,Ge.a.font,Fg.a.EF);y=Ki.construct(P,y);b=!!Wi.FormattingReader.qMc(b,vi.a.capitalization,0);return Il.construct(h,u,b,y,5,0)}Jff(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}ptm(b){const h=new yd.GraphIterator;h.set(b);h.Ab(11);return(b=h.kd(11))?wg.OutlineElementReader.qm(b):
!1}}Object(m.a)(xr,"DocumentContentExtractor",null,[528]);class Mr{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}xc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new xr(new Zf.a(()=>vk.App.Fn.jb.wc.jd),r.AFrameworkApplication.su.Nz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){K.a.instance.Kc(new Mr)}}Object(m.a)(Mr,"DocumentContentExtractorPackage",null,[1,2]);class Tq{}Tq.Hg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Object(m.a)(Tq,"EmbedDialogHtml",null,[]);class Zp{constructor(b,h,u,y){this.xcc=b;this.T0a=h;this.Q2d=u;this.value=y}}Object(m.a)(Zp,"OptionInfo",null,[]);class Vg{constructor(b,h,u){this.q0f=b;this.e7b=h;this.T0a=u}}Object(m.a)(Vg,"SectionInfo",null,[]);var Sg=c(236);class Og extends ff.a{constructor(b,h=!1){super(!1,!1,h);this.kdd=476;this.wSb=288;this.Ire=798;this.nZj=476;this.mZj=288;this.eYc={};this.wmb=[];this.qV=this.eWa=this.tub=this.crb=this.Dld=this.UVb=null;this.opc=r.AFrameworkApplication.$Nc;
this.Xub=b;this.NFe=Object(v.a)(this,this.mbn,"optionClickHandler");this.kvc=Object(v.a)(this,this.nbn,"optionKeyHandler");this.Rme=Object(v.a)(this,this.zok,"arrowClickHandler");this.tQb=Object(v.a)(this,this.Aok,"arrowKeyHandler");this.Ird=Object(v.a)(this,this.elo,"textAreaOnFocusHandler");this.RRj=h;this.Hg=Tq.Hg;this.Ed=0;this.mg="EmbedDialog"}get As(){return this.wSb}set As(b){this.wSb=b}Mbj(b){const h={["id"]:this.mg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,
["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Fa.a.zp(this.Xub,"wdPreview","1"),["initialEmbedUrl"]:this.opc,["getEmbedCode"]:Og.qWh,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const u of Object.keys(b))h[u]=b[u];this.Ed=1;this.Ue(1,CommonUIStrings.l_CopyAction);this.Ue(0,CommonUIStrings.l_Close);this.Wh(CommonUIStrings.l_Embed,null,h)}ahc(){if(this.RRj)this.Mbj({});
else{this.showDialog(CommonUIStrings.l_Embed,null);this.UVb=document.getElementById("embedpreviewpane");this.Dld=document.getElementById("embedoptionpane");this.UVb.style.width=String.format("{0}px",this.nZj);this.eWa=document.createElement("iframe");this.eWa.className=Og.lZj;this.eWa.frameBorder="0";this.eWa.style.height=String.format("{0}px",this.mZj);this.eWa.tabIndex=-1;this.UVb.appendChild(this.$Bd(CommonUIStrings.l_Preview,this.eWa,Og.W0g,Og.V0g,Og.W0g,!0));this.qV=document.createElement("textarea");
this.qV.className=Og.EKj;Sys.UI.DomElement.addCssClass(this.qV,Sg.a.JUe);this.qV.id=Og.JIg;ba.a.zi||(this.qV.readOnly=!0);this.qV.rows=4;this.qV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.qV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.qV.setAttribute(hf.a.qea,String.format("{0} {1}",Og.IIg,Og.HIg));this.UVb.appendChild(this.$Bd(CommonUIStrings.l_EmbedCode,this.qV,Og.IIg));rf.a.addHandler(this.qV,"focus",this.Ird);var b=document.createElement("span");b.className=
Og.uMj;b.innerText=CommonUIStrings.l_CopyText;b.id=Og.HIg;this.UVb.appendChild(b);this.crb=document.createElement("div");this.crb.className=Og.HJj;this.Dld.appendChild(this.$Bd(CommonUIStrings.l_Dimensions,this.crb));this.tub=document.createElement("div");this.Dld.appendChild(this.PRk(Og.KZg,this.tub));this.Ed=0;this.Ue(1,CommonUIStrings.l_Close);this.ocg();this.Upj();ba.a.zi||this.qV.focus()}}dispose(){if(this.eYc){var b=this.eYc;for(let h in b){const u=b[h];this.xq.sc(bb.a.click,u.xcc,this.NFe);
this.ie.sc(bb.a.hi,u.xcc,this.kvc);this.ie.sc(bb.a.sh,u.xcc,this.kvc)}this.kvc=this.NFe=this.eYc=null}if(this.wmb){for(b=0;b<this.wmb.length;++b)this.xq.sc(bb.a.click,this.wmb[b].e7b,this.Rme),this.ie.sc(bb.a.hi,this.wmb[b].e7b,this.tQb),this.ie.sc(bb.a.St,this.wmb[b].e7b,this.tQb),this.ie.sc(bb.a.sh,this.wmb[b].e7b,this.tQb);this.ie=this.Rme=this.wmb=null}this.Ird&&this.qV&&(rf.a.removeHandler(this.qV,"focus",this.Ird),this.Ird=null);this.qV=this.eWa=this.tub=this.crb=this.Dld=this.UVb=null;super.dispose()}Vba(){super.Vba();
this.Lc.style.width=String.format("{0}px",this.Ire);this.wBa()}Zwo(b,h){const u=Fa.a.zp(this.opc,b,h);return this.opc!==u?(this.opc=u,this.Xub=Fa.a.zp(this.Xub,b,h),!0):!1}ocg(){this.qV&&(this.qV.innerText=Og.qWh(this.opc,this.kdd,this.wSb))}Upj(){this.eWa&&this.eWa.contentWindow.location.replace(Fa.a.zp(this.Xub,"wdPreview","1"))}zhe(b,h){this.Zwo(b,h)&&(this.ocg(),this.Upj())}$Bd(b,h,u=null,y=null,P=null,aa=!1){const ta=document.createElement("div");ta.className=Og.S0j;y&&(ta.id=y);P&&ta.setAttribute(hf.a.qea,
P);aa&&(ta.tabIndex=0);y=document.createElement("span");y.className=Og.T0j;y.innerText=b;u&&(y.id=u);ta.appendChild(y);ta.appendChild(h);return ta}PRk(b,h){const u=this.$Bd(CommonUIStrings.l_Interaction,h),y=this.Gk.createElement("div");y.className=Og.yEj;y.id=Og.eBg+b;y.setAttribute(hf.a.wh,hf.a.l2);y.tabIndex=0;u.insertBefore(y,h);b=Gd.createClusteredImage(16,16,Og.zEj,Og.AEj,!0,"");y.appendChild(b);b=b.childNodes[0];b.className=Gd.getImageClass(Og.aIg);b.title=CommonUIStrings.l_Expand;y.title=
CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new Vg(h,y,b);Array.add(this.wmb,h);this.xq.xD(bb.a.click,y,this.Rme,h);this.ie.xD(bb.a.hi,y,this.tQb,h);this.ie.xD(bb.a.St,y,this.tQb,h);this.ie.xD(bb.a.sh,y,this.tQb,h);return u}zok(b){this.Hqh(b);return!0}Aok(b){return this.XSc(b,Object(v.a)(this,this.Hqh,"changeArrowState"))}Hqh(b){b=b.Lo;"visible"===b.q0f.style.visibility?(b.q0f.style.visibility="hidden",b.T0a.className=Gd.getImageClass(Og.aIg),b.T0a.title=CommonUIStrings.l_Expand,b.e7b.title=
CommonUIStrings.l_Expand):(b.q0f.style.visibility="visible",b.T0a.className=Gd.getImageClass(Og.j6j),b.T0a.title=CommonUIStrings.l_Collapse,b.e7b.title=CommonUIStrings.l_Collapse)}Vyh(b,h){const u=document.createElement("div");u.className=Og.HZg;u.id=b+Og.IZg;var y=this.Gk.createElement("div");y.tabIndex=0;y.className=Og.yDg;y.id=b+Og.Tmc;y.setAttribute(hf.a.wh,hf.a.jWe);y.setAttribute(hf.a.hBa,hf.a.ep);y.setAttribute(hf.a.qea,b+Og.URb);u.appendChild(y);u.setAttribute(hf.a.wh,hf.a.My);var P=Gd.createClusteredImage(16,
16,Og.EDg,Og.DDg,!0,"");y.appendChild(P);P=P.childNodes[0];P.id=b+Og.JZg;P.className=Gd.getImageClass(Og.Ioe);y=new Zp(u,P,y,1);this.eYc[b]=y;this.xq.xD(bb.a.click,u,this.NFe,b);y=document.createElement("span");y.className=Og.URb;y.innerText=h;y.id=b+Og.URb;u.appendChild(y);this.ie.xD(bb.a.hi,u,this.kvc,b);this.ie.xD(bb.a.sh,u,this.kvc,b);return u}mbn(b){this.JIi(b);return!0}nbn(b){return this.XSc(b,Object(v.a)(this,this.JIi,"optionHandler"))}JIi(b){const h=this.eYc[b.Lo.toString()];h.value?(h.value=
0,h.T0a.className=Gd.getImageClass(Og.DPe),h.Q2d.setAttribute(hf.a.hBa,hf.a.AL)):(h.value=1,h.T0a.className=Gd.getImageClass(Og.Ioe),h.Q2d.setAttribute(hf.a.hBa,hf.a.ep));this.zhe(b.Lo.toString(),h.value.toString())}elo(){this.qV.select()}static qWh(b,h,u){if(!Og.uEe){const y=String.format('<a target="_blank" href="{0}">{1}</a>',A.a.gOc("https://office.com"),CommonUIStrings.l_Office),P=String.format('<a target="_blank" href="{0}">{1}</a>',A.a.gOc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);
Og.uEe=String.format(CommonUIStrings.l_NoFrames,y,P)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',A.a.gOc(b),h,u,Og.uEe)}}Og.uEe=null;Og.Ioe="CheckboxChecked_16x16x32";Og.DPe="CheckboxUnchecked_16x16x32";Og.j6j="OutlookSearchChevronUp_16x16x32";Og.aIg="OutlookSearchChevronDown_16x16x32";Og.EDg="CommentChecked";Og.zEj="UpArrowServer";Og.URb="EmbedDescription";Og.S0j="EmbedSectionHeader";Og.T0j="EmbedSectionName UIFontBold";Og.uMj="EmbedCodeFooter";
Og.DDg="EmbedOptionImage";Og.lZj="EmbedPreviewFrame";Og.EKj="EmbedCodeTextArea";Og.HZg="EmbedOption";Og.HJj="EmbedDimensionSection";Og.AEj="EmbedArrowIcon";Og.yEj="WACGlyph EmbedArrowHolder";Og.yDg="EmbedCheckBoxHolder";Og.IZg="Option";Og.JZg="OptionImage";Og.JIg="EmbedCode";Og.IIg="EmbedCodeHeader";Og.W0g="Preview";Og.V0g="PreviewHeader";Og.KZg="Options";Og.eBg="Arrow";Og.Tmc="Check";Og.HIg="EmbedCodeFooter";Object(m.a)(Og,"EmbedDialog",ff.a,[]);class Gw extends Zp{constructor(b,h,u,y,P){super(b,
h,u,y);this.c1a=P}}Object(m.a)(Gw,"OptionInputInfo",Zp,[]);class wk extends Og{constructor(b,h){super(b,wk.WK);this.m$=null;this.Hoc=[];this.Eqd=Object(v.a)(this,this.ffo,"startOnOptionClickHandler");this.rXb=Object(v.a)(this,this.gfo,"startOnOptionKeyHandler");this.Wld=Object(v.a)(this,this.N6m,"onPageNumberChanged");this.Vre=Object(v.a)(this,this.f3m,"onDimensionChanged");this.EG=h}ahc(){if(wk.WK){var b=wk.ntn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.EG.NNi,
["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.EG.FSi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.EG.oej,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.EG.pej}});this.Mbj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.kdd,["defaultHeight"]:this.wSb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.EG.ptj,["heightLabel"]:this.EG.lai},
["interactionOptions"]:h})}else super.ahc(),this.xch(this.EG.ptj,"EmbedWidthInput",this.kdd),this.xch(this.EG.lai,"EmbedHeightInput",this.wSb),this.tub.appendChild(this.Vyh("wdPrint",this.EG.NNi)),this.tub.appendChild(this.Vyh("wdEmbedCode",this.EG.FSi)),this.R9j(this.EG.oej),this.wBa(),ub.FocusManager.zJ()&&(b=ub.FocusManager.instance(),h=[document.getElementById(Og.JIg),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Og.eBg+Og.KZg),
document.getElementById("wdPrint"+Og.Tmc),document.getElementById("wdEmbedCode"+Og.Tmc),document.getElementById("wdStartOn"+Og.Tmc),document.getElementById("wdStartOnText"),document.getElementById(Kh.a.V9c),document.getElementById(Og.V0g)],h=new ic(h),b.Ks().Xj=h,ba.a.zi?this.EU(document.getElementById(Kh.a.V9c)):this.qV.select())}dispose(){if(!wk.WK){if(this.Hoc){for(let b=0;b<this.Hoc.length;++b)rf.a.removeHandler(this.Hoc[b],"change",this.Vre);this.Hoc=this.Vre=null}this.Wld&&(rf.a.removeHandler(this.m$.c1a,
"change",this.Wld),this.Wld=null);this.Eqd&&(this.xq.sc(bb.a.click,this.m$.xcc,this.Eqd),this.Eqd=null);this.rXb&&(this.ie.sc(bb.a.hi,this.m$.xcc,this.rXb),this.ie.sc(bb.a.sh,this.m$.xcc,this.rXb),this.rXb=null);this.m$=null}super.dispose()}xch(b,h,u){const y=document.createElement("label");y.className="EmbedInputPrefix";y.innerText=b;this.crb.appendChild(y);b=document.createElement("input");b.className=h;b.id=h;b.value=u.toString();b.type="text";b.setAttribute("data-lpignore","true");y.setAttribute("for",
h);this.crb.appendChild(b);this.Hoc.push(b);rf.a.addHandler(b,"change",this.Vre);this.crb.appendChild(document.createElement("br"))}f3m(b){"EmbedWidthInput"===b.target.id?this.kdd=this.kFd(b.target,375):this.wSb=this.kFd(b.target,250);this.ocg()}kFd(b,h){let u=parseInt(b.value);if(isNaN(u)||u<h)u=h;b.value=u.toString();return u}N6m(b){b=this.kFd(b.target,1);1===this.m$.value&&this.zhe("wdStartOn",b.toString())}R9j(b){const h=document.createElement("div");h.className=Og.HZg+" EmbedInlineOption";h.id=
"wdStartOn"+Og.IZg;const u=this.Gk.createElement("div");u.tabIndex=0;u.className=Og.yDg;u.id="wdStartOn"+Og.Tmc;u.setAttribute(hf.a.wh,hf.a.jWe);u.setAttribute(hf.a.hBa,hf.a.AL);u.setAttribute(hf.a.qea,"wdStartOn"+Og.URb);h.appendChild(u);h.setAttribute(hf.a.wh,hf.a.My);var y=Gd.createClusteredImage(16,16,Og.EDg,Og.DDg,!0,"");u.appendChild(y);y=y.childNodes[0];y.id="wdStartOn"+Og.JZg;y.className=Gd.getImageClass(Og.DPe);const P=document.createElement("span");P.className=Og.URb;P.innerText=b;P.id=
"wdStartOn"+Og.URb;h.appendChild(P);this.tub.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.EG.pej;b.setAttribute("data-lpignore","true");this.tub.appendChild(b);rf.a.addHandler(b,"change",this.Wld);this.m$=new Gw(h,y,u,0,b);this.zhe("wdStartOn","1");this.xq.mb(bb.a.click,h,this.Eqd);this.ie.mb(bb.a.hi,h,this.rXb);this.ie.mb(bb.a.sh,h,this.rXb)}ffo(b){this.mej(b);return!0}gfo(b){return this.XSc(b,Object(v.a)(this,
this.mej,"startOnOptionHandler"))}mej(){let b=1;this.m$.value?(this.m$.value=0,this.m$.T0a.className=Gd.getImageClass(Og.DPe),this.m$.Q2d.setAttribute(hf.a.hBa,hf.a.AL)):(this.m$.value=1,this.m$.T0a.className=Gd.getImageClass(Og.Ioe),b=this.kFd(this.m$.c1a,1),this.m$.Q2d.setAttribute(hf.a.hBa,hf.a.ep));this.zhe("wdStartOn",b.toString())}static get WK(){return r.AFrameworkApplication.ta.Pb.ZA}static ntn(b,h,u,y=null){if("wdPrint"===h||"wdEmbedCode"===h)return Fa.a.zp(b,h,u?"1":"0");if("wdStartOn"===
h){let P="1";u&&y&&(y=parseInt(y),!isNaN(y)&&1<=y&&(P=y.toString()));return Fa.a.zp(b,h,u?P:"1")}return b}}Object(m.a)(wk,"WordEmbedDialog",Og,[]);class va{constructor(b,h,u,y,P){this.qda=null;this.ga=b;this.V9a=h;this.QO=u;this.EG=y;this.nqa=P}Wb(){this.ga.pa(this.QO,le.a.frame,Object(v.a)(this,this.T9n,"showEmbedCode"));this.V9a.execute(Object(v.a)(this,this.GLf,"onHostPostmessengerCreated"))}GLf(b){w.ULS.shipAssertTag(4994850,332,!!b);this.qda=b;r.AFrameworkApplication.Zfa||(this.qda.Jv(H.a.tph),
this.qda.oC(H.a.tph,Object(v.a)(this,this.ahc,"showEmbedDialog")))}ahc(b){b=b.Values.HostEmbeddedViewUrl.toString();r.AFrameworkApplication.$Nc=b;this.nqa.S$e=b;(new wk(b,this.EG)).ahc()}T9n(b,h,u){if(2===u)if(r.AFrameworkApplication.$Nc)(new wk(this.nqa.S$e,this.EG)).ahc();else return r.AFrameworkApplication.Mm.X0a(va.xwj),r.AFrameworkApplication.Gdg&&this.qda.sendMessage(H.a.Xgl,null)?32:r.AFrameworkApplication.ta.I3(!0,r.AFrameworkApplication.scf);return 32}}va.xwj=10381;Object(m.a)(va,"EmbedActor",
null,[]);class Sa{}Object(m.a)(Sa,"WordEmbedDialogStrings",null,[]);var Da=c(267);class xa extends va{constructor(b,h){super(b,h,Rc.a.D5f,Object.assign(new Sa,{ptj:WordEditorIntl.WordEditorStrings.l_Width,lai:WordEditorIntl.WordEditorStrings.l_Height,NNi:WordEditorIntl.WordEditorStrings.l_PrintOption,FSi:WordEditorIntl.WordEditorStrings.l_ReembedOption,oej:WordEditorIntl.WordEditorStrings.l_StartOnOption,pej:WordEditorIntl.WordEditorStrings.l_StartPage}),Da.WoncaApp.instance)}}Object(m.a)(xa,"EmbedActor",
va,[]);class $a{constructor(){this.W=null}get name(){return"WordEditor.Embed"}xc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new xa(r.AFrameworkApplication.ya,b.Za("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Wb()}dispose(){}}Object(m.a)($a,"EmbedPackage",null,[1,2]);class Cb{constructor(b,h,u){this.Fv=this.UIa=this.bLa=null;this.IIa=0;this.ZTb=this.TTb=this.KTb=this.hUb=this.PUa=this.OUa=!1;this.Gj=b;this.Sm=u}iO(b){return Ra.App.xa.jb.isEditingAllowed?
""!==this.bLc(b.Bf):!1}IK(b){if(!this.iO(b))return!1;this.oWn(b);this.pWn();this.qWn();this.bLa=b.yH;this.Fv=new Sys.UI.Point(0,0);w.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}iU(b){this.UIa=b.yH;this.jyk();this.Gj.Qoj(this.Fv.x,this.Fv.y,this.hUb,this.KTb,this.TTb,this.ZTb,!1);return!0}tD(){this.Gj.Qoj(this.Fv.x,this.Fv.y,this.hUb,this.KTb,this.TTb,this.ZTb,!0);w.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}PX(){this.Gj.bBk();w.ULS.sendTraceTag(22381025,
322,50,"Image Crop drag canceled")}pWn(){this.ZTb=this.TTb=this.KTb=this.hUb=!1;switch(this.IIa){case 1:this.hUb=!0;break;case 5:this.KTb=!0;break;case 3:this.ZTb=!0;break;case 7:this.TTb=!0;break;case 0:this.TTb=this.hUb=!0;break;case 2:this.ZTb=this.hUb=!0;break;case 6:this.TTb=this.KTb=!0;break;case 4:this.ZTb=this.KTb=!0}}qWn(){this.PUa=this.OUa=!1;switch(this.IIa){case 0:this.PUa=this.OUa=!0;break;case 1:case 2:this.PUa=!0;break;case 7:case 6:this.OUa=!0}}bLc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&
b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const u=b[h].toString();if(u.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==u)return u}return""}oWn(b){switch(this.bLc(b.Bf)){case "WACImageCropHandleNW":this.IIa=0;break;case "WACImageCropHandleN":this.IIa=1;break;case "WACImageCropHandleNE":this.IIa=2;break;case "WACImageCropHandleE":this.IIa=3;break;case "WACImageCropHandleSE":this.IIa=4;break;case "WACImageCropHandleS":this.IIa=5;break;case "WACImageCropHandleSW":this.IIa=
6;break;case "WACImageCropHandleW":this.IIa=7}}jyk(){var b=1;this.Sm.instance&&(b=this.Sm.instance.jj);const h=(this.UIa.x-this.bLa.x)/b;b=(this.UIa.y-this.bLa.y)/b;this.Fv.x=this.OUa?-h:h;this.Fv.y=this.PUa?-b:b}}Object(m.a)(Cb,"ImageCropDragAdapter",null,[150]);class Pb{constructor(b,h){this.ga=b;this.Sm=h}NFl(b){return new Cb(b,this.ga,this.Sm)}}Object(m.a)(Pb,"ImageCropDragAdapterFactory",null,[527]);var dc=c(243),Gc=c(201),Jc=c(468),fd=c(702),$c=c(97),Zc=c(67),Bd=c(446),ve=c(958),me=c(537),qe=
c(894),se=c(139),pe=c(37),He=c(384),Ye=c(261),bg=c(862),mg=c(213),Jf=c(94),wf=c(21),Kg=c(299),sj=c(398),Hi=c(130);class Gg{constructor(b,h,u,y,P,aa,ta,Pa,vb=null){this.$b=vb;this.vPc=null;this.TJ=b;this.Bh=h;this.Ic=u;this.Cs=y;this.Rd=P;this.ib=aa;this.Om=ta;this.YD=Pa}get wW(){return null!=this.hmg?this.hmg:this.hmg=Ja.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get nc(){return null!=this.ezg?this.ezg:this.ezg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Te(){return se.PageReader.instance}CYn(b,
h,u){const y=this.Ic.Qc(15);y.Eb(h.node);this.VRa(b,u);y.dispose()}BYn(b,h,u){const y=this.Ic.Qc(15);y.Eb(h.node);this.$Lb(b,u);y.dispose()}VRa(b,h){b.setValue(Ge.a.imageAltText,h)}$Lb(b,h){b.setValue(Lc.a.gX,h)}JYn(b,h){b.setValue(Ge.a.uhb,h)}X5i(b,h){b.setValue(Lc.a.hX,h)}FYn(b,h,u,y,P){let aa=0;var ta=0;({width:aa,height:ta}=Jd.ImageReader.pgb(b));ta-=(h+u)/1E5*ta;this.qGa(b,aa-(y+P)/1E5*aa);this.pGa(b,ta);this.p6i(b);b.setValue(Lc.a.pEb,h);b.setValue(Lc.a.mEb,u);b.setValue(Lc.a.nEb,y);b.setValue(Lc.a.oEb,
P)}D1n(b,h,u,y){const P=this.Ic.Qc(15);P.Eb(h.node);this.$$d(b,u,y);P.dispose()}$$d(b,h,u){this.qGa(b,h);this.pGa(b,u);this.p6i(b);b.removeProperty(ld.a.o4d);b.removeProperty(ld.a.n4d)}qGa(b,h){b.setValue(Ge.a.jba,h);b.setValue(ld.a.GDa,-1)}pGa(b,h){b.setValue(Ge.a.tga,h);b.setValue(ld.a.FDa,-1)}zD(b,h){b.setValue(Lc.a.VNc,h);b.setValue(Ge.a.Vh,h);b.setValue(Ge.a.Yp,h)}r2n(b,h){b.setValue(Lc.a.SNb,h)}qVn(b,h){b.setValue(Lc.a.pXe,h)}v2n(b){if(!Jd.ImageReader.p3(b)&&b.gl){var h=b.node;if(Jd.ImageReader.u7(h)){const P=
this.Ic.Qc(15);P.Eb(b.node);b=yd.GraphIterator.$a(h);b.Ab(12);b=b.parentNode;var u=b.properties.Nf(Lc.a.Sq),y=h.properties.getValue(Lc.a.runId);h.ia(Lc.a.Pc,Pg.a.lR);const aa=b.qa;h.Ng.apply(h,[Lc.a.VNc,Ge.a.Vh,Ge.a.Yp,Lc.a.pXe,Lc.a.SNb,Lc.a.VXa]);u=this.Dhf(y,u,aa);y=nf.a.Uc(b,u);this.Cs.f3e(h,y);(h=this.YD.JL(b,u,u+1))&&this.ib.setSelection(h);this.wW.fpa(b,u,u+1);P.dispose()}}}w1f(b,h){if(b.properties.hasProperty(Lc.a.g6)){const u=b.properties.Nf(Lc.a.g6);u.push(h);b.properties.setValue(Lc.a.g6,
Array.clone(u))}else b.properties.setValue(Lc.a.g6,[h])}jbe(b,h,u=0,y=!1){if(b.gl){var P=this.Ic.Qc(15),aa=b.node;P.Eb(aa);if(Jd.ImageReader.p3(b)){const Kb=this.$b&&this.$b.isFeatureEnabled(45)?new qe.a:new me.a;Kb.Hs(Jd.ImageReader.Wm(b));var ta=aa.qa,Pa=this.Jil(b.cpBegin,ta);this.Lnk(b.cpEnd,ta,Pa)&&w.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ta=ta.J(Pa).blob;Pa=ta.Je;var vb=aa.properties.Nf(Lc.a.Sq);vb=this.Nsn(vb);Pa=vb[Pa];vb=aa.ia(Lc.a.Pc,Pg.a.lR);
if(ta=Object(na.a)(ve.ImageBlobObject,ta))ta.yMb=!1;this.Rd.replaceTextRange(b,"");ta&&(ta.yMb=!0);Kb.properties.setValue(Lc.a.runId,Pa);Kb.properties.setValue(Lc.a.Pc,vb);b=yd.GraphIterator.$a(aa);b.Ab(12);b.Qf(Kb,6);this.w1f(b.currentNode,Kb.anchor.node.id);aa=Kb}u&&this.zD(aa.properties,u);this.qVn(aa.properties,y);this.r2n(aa.properties,h);this.wW.bgc(aa);(h=this.YD.kq(aa))&&this.ib.setSelection(h);P.dispose()}}a0f(b,h){if(!(0>=h)){var u=Bf.a.Ml(h,0),y=Jd.ImageReader.uE(b),P=Jd.ImageReader.RF(b);
y>u&&(P*=u/y,this.qGa(b,u),this.pGa(b,P),w.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}Lnk(b,h,u){const y=h.length;if(u>=y||!h.J(u).zf)return!1;const P=new lg.a;for(;u<y;u++){const aa=h.J(u);if(aa.cp>b||!aa.zf)break;for(let ta=0;ta<aa.zf.length;ta++){if(P.contains(aa.zf.J(ta).Wj))return!0;P.add(aa.zf.J(ta).Wj)}}return!1}Nsn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var u=0;u<b.length;)b[u]=u+1,u++;else{var y=b[h];u=h-1;for(var P=
y-1;0<=u;)b[u]=P,u--,P--;P=0;for(u=h+1;u<b.length;)(h=b[u])?h<y?(y=h+P,b[u]=y):y=h:(P+=2,y++,b[u]=y),u++}return b}cdf(b,h){let u=0;for(;u<h.length&&!(b<h[u]);)u++;return u}Dhf(b,h,u){let y=0;const P=this.cdf(b,h);let aa=0;if(P===h.length)aa=u.length-1;else for(;aa<u.length;){h=u.J(aa);if(h.formatting&&h.formatting.Je===P)break;aa++}aa<u.length?y=u.J(aa).cp:w.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:aa,["RunId"]:b,["CharacterPropertiesArrayLength"]:u.length});
return y}Jil(b,h){let u=0;for(;u<h.length&&h.J(u).cp!==b;)u++;u===h.length&&w.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:u,["CharacterPropertiesArrayLength"]:h.length});return u}p6i(b){b.setValue(Ge.a.gga,!0)}S4d(b,h,u,y=!1){h&&u?(h=Math.max(h,fd.a.nyi),u=Math.max(u,fd.a.nyi)):u=h=fd.a.nDh;b.setValue(Ge.a.jba,Bf.a.Ml(h,0));b.setValue(Ge.a.tga,Bf.a.Ml(u,1));b.setValue(Ge.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);
b.setValue(vi.a.VZ,1);b.setValue(Lc.a.ega,y)}YQd(){return null}CGh(b,h,u){let y=null;h=({cIb:y}=this.DGh(b,h,u)).returnValue;y&&b.view.Bb.setSelection(y);return h}DGh(b,h,u){var y=null;if(!this.zea(b))return{returnValue:null,cIb:y};var P=b.view;const aa=this.Ic.Qc(15,Oa.a.HEb);aa.Eb(P.jd);h||(h=new uh.DictionaryPropertySet);h.setValue(ld.a.O8k,!0);let ta=P.Bb.Lg;var Pa=new bg.a;if(!Se.SelectionEditor.pf(ta)){if(2===r.AFrameworkApplication.ya.processAction(Oa.a.Cla,2))return aa.dispose(),{returnValue:null,
cIb:y};ta=P.Bb.Lg}else if(ta.gl&&be.ParagraphReader.ic(ta.node)){Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(ta.node);P=Wi.FormattingReader.zr(ta);if(!P)return aa.dispose(),{returnValue:null,cIb:y};P.cache.$y&&(P=P.Xf(null),Gg.Jn.sU(P));Pa.formatting=P.Hj;Pa.languageId=Wi.FormattingReader.language(P);pe.a.instance.J(7)&&(Pa.Zpa=this.nc.Xn(ta.node))}if(!ta.gl)return aa.dispose(),{returnValue:null,cIb:y};if(!this.$sf(b.Yj,h))return aa.dispose(),this.vPc=null,{returnValue:null,cIb:y};b=this.vPc;this.vPc=null;1===
b.location?(y=b.node,h=sj.a.instance.Onf(y),og.OutlineElementNavigator.Jr(h,!1,!1)||(mg.OutlineNavigator.m9d(h),this.TJ.i6(h,!0,Pa)),og.OutlineElementNavigator.Ee(h),xh.TableReader.isTable(h)&&(Object(jb.a)(Hi.a,h)||Object(jb.a)(He.a,h)?(Pa=new yd.GraphIterator,Pa.set(h.currentNode),wf.moveToCellContent(Pa,0,0),h.set(Pa.currentNode)):wf.moveToCellContent(h,0,0),wg.OutlineElementReader.Oh(h)?og.OutlineElementNavigator.Ee(h):h=sj.a.instance.Onf(y)),y=be.ParagraphReader.Lt(h.currentNode)?this.YD.we(h.currentNode,
0):this.YD.kq(h.currentNode)):b.location||(Pa=b.blob.Nb.cp+1,y=this.YD.JL(b.node,Pa-1,Pa));aa.OEa(u,1);aa.Kk=Oa.a.HEb;aa.dispose();return{returnValue:b,cIb:y}}$sf(){return!1}zea(b){b.contextId===oc.a.view&&b.view.ue&&b.view.Bb&&(b=b.view.Bb.Lg);if(!b)return Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.noSelection}),!1;if(Gg.ag.xZ(b))return Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.hE}),!1;if(Gg.ag.uva(b))return Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.kei}),!1;if(this.Om&&this.Om.instance&&this.Om.instance.PT(b))return Gg.Mc.fc($c.a.vf,
{["Reason"]:Zc.a.externalSelection}),!1;if(this.Te.l3)return Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.compatMode}),!1;if(b.gl)return Jf.OutlineReader.cUd(b)?(Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.D2e}),!1):Jd.ImageReader.ZSd(b)?(Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.v2e}),!1):Kg.c(b)?(Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.w2e}),!1):Ye.a.yvf(b)?(Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.u2e}),!1):be.ParagraphReader.MT(b)||Jd.ImageReader.Wjm(b)?(Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.BN}),!1):!0;if(Bd.a.Pwf(b)){let h=!0;for(let u=
0;u<b.length;++u){const y=b.getContext(u);if(!y.gl)return!1;h&&!be.ParagraphReader.MT(y)&&(h=!1)}return h?(Gg.Mc.fc($c.a.vf,{["Reason"]:Zc.a.BN}),!1):!0}return!1}xVi(b,h){const u=this.Ic.Qc(7);u.Eb(b);if(12===b.type){h=h.Nb.cp;var y=be.ParagraphReader.textLength(b);y=nf.a.IL(h,h+1,h+1===y?!0:!1,b);this.Rd.replaceTextRange(y,"");b=nf.a.Uc(b,h);this.ib.setSelection(Kf.SelectionFactory.Vn(b))}else this.Bh.pRa(b);u.dispose()}static get Jn(){return null!=Gg.Kpg?Gg.Kpg:Gg.Kpg=Ja.a.instance.resolve("Box4.IFormattingEditor")}static get ag(){return sd.a.instance}static get Mc(){return ri.a.instance}}
Object(m.a)(Gg,"ImageEditor",null,[526]);class Aj{constructor(b,h,u,y=0){this.node=b;this.blob=h;this.location=u;this.GT=y}}Object(m.a)(Aj,"InsertPictureResult",null,[]);var ll=c(815),Pi=c(300),Bj=c(1162);class Fn extends Gg{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc){super(b,h,u,y,P,aa,ta,Pa,Sc);this.HIj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.G8a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.HJ=this.AJa=this.eza=null;this.aja=Array(8);this.fgd=this.yza=null;this.BJa=!1;this.egd=this.oxe=null;this.Jbd=this.Scd=!1;this.WR=this.VR=this.UR=this.XR=this.mV=this.lV=this.kV=this.nV=this.JV=this.KV=0;this.R3=()=>{this.BJa&&this.kaf()};this.owa=nd=>{this.BJa&&nd.Ib.keyCode!==fb.a.us&&this.kaf(!0);return!1};this.lOg=Ac;aa.DA(this.R3);this.ie=Yb;this.g1=dc.a.instance;this.ga=r.AFrameworkApplication.ya;this.Ud=Kb;this.Eo=vb;this.Wc=Sc}qae(b,h,u,y,P){b.hasProperty(ld.a.J2a)&&b.removeProperty(ld.a.J2a);
const aa=Array(4);aa[0]=h;aa[1]=u;aa[2]=y;aa[3]=P;b.setValue(Lc.a.Qba,aa)}nDn(b){b.setValue(Lc.a.IDa,0);b.setValue(Lc.a.nJb,"");this.qae(b,0,0,0,0)}t2f(b,h,u,y,P){b.setValue(Lc.a.pEb,h);b.setValue(Lc.a.mEb,u);b.setValue(Lc.a.nEb,y);b.setValue(Lc.a.oEb,P)}sae(b,h,u,y){b.setValue(Lc.a.QI,h);b.setValue(Lc.a.xNc,u);b.setValue(Lc.a.JNc,y);b.setValue(ld.a.QI,-1)}WQd(b,h){b=b.node;const u=yd.GraphIterator.$a(b);if(be.ParagraphReader.ic(b)&&be.ParagraphReader.isEmpty(u)){var y=b.properties.Nf(Lc.a.Pc);h.setValue(Lc.a.Pc,
y);h.setValue(Lc.a.runId,1);y=new Bj.a;h&&y.Hs(h);u.Qf(y,6);this.w1f(b,y.anchor.node.id);this.wW.bgc(y);return new Aj(y,null,3)}return null}YQd(b,h){var u=ll.a.instance.m9c;h&&u.Hs(h);u.setValue(Lc.a.imageType,1);let y=0;pe.a.instance.J(4)&&(y=Gc.a.lG(),u.setValue(Lc.a.GT,y));const P=b.node.Jc.av(u,u.id);u=this.Rd.Qfa(b,aa=>new ve.ImageBlobObject(aa,P));Pi.GraphTransactionManager.instance.oLf(b.node);if(this.Ud.zg){const aa=new dg.GraphTransaction(15);aa.Eb(b.node);this.Eo.lpa(b.node,b.cpBegin,b.cpBegin+
1,1,null);aa.dispose()}this.wW.VLa&&!h.ia(Lc.a.ega,!1)&&this.wW.fpa(b.node,b.cpBegin,b.cpBegin+1);return new Aj(b.node,u,0,y)}$sf(b,h){if(!this.zea(b))return!1;const u=this.Ic.Qc(7);u.Eb(b.node);r.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ia(Lc.a.kgi,!1)?this.vPc=this.WQd(b,h):this.vPc=this.YQd(b,h);u.dispose();return!0}rec(b,h,u,y){if(!u.ic(b))return!1;u=this.Ic.Qc(7,Oa.a.b1l);u.Eb(b);var P=b.properties.ia(Ge.a.vm,[]);P.push(0);for(const aa of P)if((P=y.mgf(b,aa))&&5===P.li&&P.id.equals(h))return this.Rd.replaceTextRange(nf.a.createTextRange(b,
aa,aa+1),""),u.dispose(),!0;u.dispose();w.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}BCn(b,h,u,y){if(!Jd.ImageReader.u7(b))return!1;h.set(b);h.Ab(12);const P=h.ko(12);if(!P)return w.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(u.xRc(P))return w.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;y(b);u=this.Ic.Qc(7);u.Eb(b);h.Jg();u.dispose();return!0}gIn(b,h,u,y){return Jd.ImageReader.q1a(b)?this.THn(b,u):Jd.ImageReader.p3(b)?this.jIn(b,h,u,y):null}jIn(b,h,u,y){const P=ll.a.instance.m9c;u&&P.Hs(u);u=0;pe.a.instance.J(4)&&(u=Gc.a.lG(),P.setValue(Lc.a.GT,u));u=b.node.Jc;b=b.node;y=y.YJc(b,5);for(const aa of y)if(aa.id.equals(h)){this.Rd.replaceTextRange(nf.a.createTextRange(b,aa.Nb.cp,aa.Nb.cp+1),"");const ta=u.av(P,P.id);h=nf.a.Uc(b,aa.Nb.cp);this.Rd.Qfa(h,Pa=>new ve.ImageBlobObject(Pa,
ta));return P}return null}THn(b,h){if(!Jd.ImageReader.q1a(b))return null;pe.a.instance.J(4)&&h.setValue(Lc.a.GT,Gc.a.lG());b=b.node;var u=b.anchor.node.id;b=yd.GraphIterator.$a(b);b.Ab(12);const y=b.parentNode;let P;y.properties.hasProperty(Lc.a.g6)?(P=y.properties.Nf(Lc.a.g6),u=T.a.indexOf(P,u),-1!==u&&Array.removeAt(P,u)):P=[];y.properties.setValue(Lc.a.g6,Array.clone(P));b.Jg();u=this.Wc&&this.Wc.isFeatureEnabled(45)?new qe.a:new me.a;u.Hs(h);b.Qf(u,6);this.w1f(y,u.anchor.node.id);return u}U5c(b,
h){this.BJa?this.kaf():this.Ieo(b,h)}LYn(b,h){b.setValue(ld.a.QI,h)}RFl(b){let h=null,u=null;if(!b)return w.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,Ji:u};if(!ab.InteractiveViewManager.instance.od)return w.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Ji:u};const y=b.node;if(!y)return w.ULS.sendTraceTag(22381056,322,
15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,Ji:u};u=y.Jc;var P=y.xe(ab.InteractiveViewManager.instance.od.Sb);if(!P)return w.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Ji:u};h=P.Ug;if(b.gl&&Jd.ImageReader.p3(b)){b=Jd.ImageReader.cDa(b);if(!b)return w.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),
{returnValue:null,view:h,Ji:u};P=b.oDa(h,P);if(!P)return w.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Ji:u};P=P.element}else if(Jd.ImageReader.Wu(y))P=P.htmlElement;else return w.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Ji:u};return{returnValue:P,view:h,Ji:u}}P3n(b){for(let y=0;y<
this.aja.length;y++){this.aja[y]=b.Hk(cm.a.span);this.aja[y].className="WACImageCropHandles "+this.HIj[y];if(2>=y){var h=b.Hk(cm.a.span);h.className=this.G8a[0];var u=b.Hk(cm.a.span);u.className=this.G8a[1];this.aja[y].appendChild(h);this.aja[y].appendChild(u)}else 4<y&&(h=b.Hk(cm.a.span),h.className=this.G8a[2],u=b.Hk(cm.a.span),u.className=this.G8a[3],this.aja[y].appendChild(h),this.aja[y].appendChild(u));if(!y||3===y||5===y)h=b.Hk(cm.a.span),h.className=this.G8a[4],u=b.Hk(cm.a.span),u.className=
this.G8a[5],this.aja[y].appendChild(h),this.aja[y].appendChild(u);else if(2===y||4===y||7===y)h=b.Hk(cm.a.span),h.className=this.G8a[6],u=b.Hk(cm.a.span),u.className=this.G8a[7],this.aja[y].appendChild(h),this.aja[y].appendChild(u)}}Ieo(b,h){w.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.BJa)w.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var u=null,y=null;if((this.yza=({view:u,Ji:y}=this.RFl(h)).returnValue)&&u){this.yza.classList.add("ImageCropMode");
this.eza=u.Hk(cm.a.div);this.eza.className="WACImageCropMode";this.AJa=u.Hk(cm.a.U0a);this.AJa.className="WACImageCropBase";this.HJ=u.Hk(cm.a.span);this.HJ.className="WACImageCropSrcRect";this.P3n(u);this.eza.appendChild(this.HJ);for(u=0;u<this.aja.length;u++)this.HJ.appendChild(this.aja[u]);this.eza.appendChild(this.AJa);this.AJa.style.visibility="";this.AJa.style.display="";this.yza.appendChild(this.eza);this.Gin(b);y=Jd.ImageReader.lDa(b,y);u=Jd.ImageReader.G4(b,ld.a.qoa,null);this.AJa.src=u?u:
Jd.ImageReader.xCb(y);this.lOg&&this.lOg.execute(P=>{this.fgd||(this.fgd=P.NFl(this))});this.Scd||(this.g1.sO(this.yza,this.fgd),this.Scd=!0);this.ie&&this.ie.mb(bb.a.hI,ab.InteractiveViewManager.instance.editingView.editingElement,this.owa);this.BJa=!0;this.oxe=b;this.egd=h;this.Jbd=!1;b=new dg.GraphTransaction(4);b.Eb(this.egd.node);this.oxe.setValue(ld.a.tva,this.BJa);b.dispose()}else w.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}Gin(b){const h=
Bf.a.lf(Jd.ImageReader.uE(b),0),u=Bf.a.lf(Jd.ImageReader.RF(b),1),y=Math.max(Jd.ImageReader.xma(b),0),P=Math.max(Jd.ImageReader.uma(b),0),aa=Math.max(Jd.ImageReader.vma(b),0),ta=Math.max(Jd.ImageReader.wma(b),0);this.KV=1E5*h/(1E5-(aa+ta));this.JV=1E5*u/(1E5-(y+P));this.nV=Math.floor(y*this.JV/1E5);this.kV=Math.floor(P*this.JV/1E5);this.lV=Math.floor(aa*this.KV/1E5);this.mV=Math.floor(ta*this.KV/1E5);this.HJ.style.top=this.nV+"px";this.HJ.style.bottom=this.kV+"px";this.HJ.style.left=this.lV+"px";
this.HJ.style.right=this.mV+"px";this.AJa.style.width=this.KV+"px";this.AJa.style.height=this.JV+"px";Jd.ImageReader.Yx(b)&&(this.eza.style.width=this.KV+"px",this.eza.style.height=this.JV+"px");this.XR=this.nV;this.UR=this.kV;this.VR=this.lV;this.WR=this.mV}kaf(b=!1){w.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.BJa?(b||this.NKk(),this.AJa?Hc.a.FA(this.AJa):w.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.yza?
(this.eza?this.eza.parentNode===this.yza?this.yza.removeChild(this.eza):w.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):w.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.yza.classList.remove("ImageCropMode"),this.BJa=!1,b=new dg.GraphTransaction(4),b.Eb(this.egd.node),this.oxe.setValue(ld.a.tva,this.BJa),b.dispose(),this.Scd&&(this.g1.JO(this.yza,this.fgd),
this.Scd=!1),this.ie&&this.ie.sc(bb.a.hI,ab.InteractiveViewManager.instance.editingView.editingElement,this.owa),this.yza=this.eza=null):w.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):w.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}Qoj(b,h,u,y,P,aa,ta){if(u){u=Math.max(this.nV-h,0);const Pa=Math.floor(this.JV)-this.kV-u;5<=Pa?(this.XR=u,this.UR=this.kV):5>Pa&&
0<=Pa||0>Pa&&!this.kV?(this.XR=u-(5-Pa),this.UR=this.kV):0>Pa&&5>=Math.abs(Pa)?(this.XR=Math.floor(this.JV)-this.kV,this.UR=Math.max(this.kV-(u-(this.JV-this.kV))-(5-Math.abs(Pa)),0)):(this.XR=Math.floor(this.JV)-this.kV,this.UR=Math.max(this.kV-(u-(this.JV-this.kV)),0));this.HJ.style.top=this.XR+"px";this.HJ.style.bottom=this.UR+"px";ta&&(this.nV=this.XR,this.kV=this.UR)}y&&(h=Math.max(this.kV-h,0),y=Math.floor(this.JV)-this.nV-h,5<=y?(this.UR=h,this.XR=this.nV):5>y&&0<=y||0>y&&!this.nV?(this.UR=
h-(5-y),this.XR=this.nV):0>y&&5>=Math.abs(y)?(this.UR=Math.floor(this.JV)-this.nV,this.XR=Math.max(this.nV-(h-(this.JV-this.nV))-(5-Math.abs(y)),0)):(this.UR=Math.floor(this.JV)-this.nV,this.XR=Math.max(this.nV-(h-(this.JV-this.nV)),0)),this.HJ.style.top=this.XR+"px",this.HJ.style.bottom=this.UR+"px",ta&&(this.nV=this.XR,this.kV=this.UR));P&&(P=Math.max(this.lV-b,0),h=Math.floor(this.KV)-this.mV-P,5<=h?(this.VR=P,this.WR=this.mV):5>h&&0<=h||0>h&&!this.mV?(this.VR=P-(5-h),this.WR=this.mV):0>h&&5>=
Math.abs(h)?(this.VR=Math.floor(this.KV)-this.mV,this.WR=Math.max(this.mV-(P-(this.KV-this.mV))-(5-Math.abs(h)),0)):(this.VR=Math.floor(this.KV)-this.mV,this.WR=Math.max(this.mV-(P-(this.KV-this.mV)),0)),this.HJ.style.left=this.VR+"px",this.HJ.style.right=this.WR+"px",ta&&(this.lV=this.VR,this.mV=this.WR));aa&&(b=Math.max(this.mV-b,0),aa=Math.floor(this.KV)-this.lV-b,5<=aa?(this.WR=b,this.VR=this.lV):5>aa&&0<=aa||0>aa&&!this.lV?(this.WR=b-(5-aa),this.VR=this.lV):0>aa&&5>=Math.abs(aa)?(this.WR=Math.floor(this.KV)-
this.lV,this.VR=Math.max(this.lV-(b-(this.KV-this.lV))-(5-Math.abs(aa)),0)):(this.WR=Math.floor(this.KV)-this.lV,this.VR=Math.max(this.lV-(b-(this.KV-this.lV)),0)),this.HJ.style.left=this.VR+"px",this.HJ.style.right=this.WR+"px",ta&&(this.lV=this.VR,this.mV=this.WR));ta&&(this.Jbd=!0,Ra.App.xa.updateCommandUI())}bBk(){this.XR=this.nV;this.UR=this.kV;this.VR=this.lV;this.WR=this.mV;this.HJ.style.top=this.XR+"px";this.HJ.style.bottom=this.UR+"px";this.HJ.style.left=this.VR+"px";this.HJ.style.right=
this.WR+"px"}NKk(){if(this.Jbd){w.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.nV/this.JV),h=Math.floor(1E5*this.kV/this.JV),u=Math.floor(1E5*this.lV/this.KV),y=Math.floor(1E5*this.mV/this.KV),P=new uh.DictionaryPropertySet;P.setValue(ld.a.Chb,b);P.setValue(ld.a.zhb,h);P.setValue(ld.a.Ahb,u);P.setValue(ld.a.Bhb,y);this.ga.Tf(this.egd,Rc.a.Pbi,2,!1,null,P)}else w.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}tva(){return this.BJa}ezl(){return{top:this.XR,
bottom:this.UR,left:this.VR,right:this.WR}}fyo(b,h){if(0>b)w.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.nV=this.XR=Math.min(Math.floor(this.JV)-this.UR-5,b);this.HJ.style.top=this.XR+"px";break;case 1:this.kV=this.UR=Math.min(Math.floor(this.JV)-this.XR-5,b);this.HJ.style.bottom=this.UR+"px";break;case 2:this.lV=this.VR=Math.min(Math.floor(this.KV)-this.WR-5,b);this.HJ.style.left=this.VR+"px";break;case 3:this.mV=this.WR=Math.min(Math.floor(this.KV)-
this.VR-5,b),this.HJ.style.right=this.WR+"px"}this.Jbd=!0}}}Object(m.a)(Fn,"ImageEditor",Gg,[525,526]);class mp{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}xc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Pb(r.AFrameworkApplication.ya,Ja.a.instance.Za("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new Fn(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Za("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Rb.KeyInputManager.instance,b.Za("WordEditor.IImageCropDragAdapterFactory"),b.Pa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){K.a.instance.Kc(new mp)}}
Object(m.a)(mp,"WordEditorImageEditorsPackage",null,[1,2]);class kq{}Object(m.a)(kq,"FolderContentEditor",null,[1322]);class Zk{}Object(m.a)(Zk,"PageEditor",null,[1228]);var xl=c(184);class Xo extends Zk{constructor(){super()}get mh(){return xl.PageNavigator.instance}}Object(m.a)(Xo,"PageEditor",Zk,[]);class Uq{get name(){return"WordEditor.NotebookLevelEditors"}xc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new kq).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new Xo).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){K.a.instance.Kc(new Uq)}}Object(m.a)(Uq,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Bp{get LJb(){return r.AFrameworkApplication.privacyUrl}eta(){w.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Je.a.en(this.LJb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(m.a)(Bp,"PrivacyLinkHandler",null,[812]);class il{constructor(b,h){this.iFe=null;this.i1j=
b;this.h1j=h}showDialog(b){this.iFe=b;this.h1j.create().Wh(Object(v.a)(this,this.z2l,"handleDialog"))}z2l(b){1===b&&this.i1j.w3i();this.iFe();this.iFe.prototype}}Object(m.a)(il,"SendUsYourFileController",null,[782]);class Fq extends Gh.StandardDialog{constructor(b,h,u){super();this.ZVb=null;this.qg=b;this.jwc=h;this.EG=u}Wh(b){this.Ed=1;this.Ue(1,this.EG.send);this.Ue(0,this.EG.hYm);w.ULS.shipAssertTag(37034013,342,!this.ZVb,"privacy anchor should be null before initializing it.");const h=this.dialogContent();
this.Sjb(this.EG.rkk,null,"CancelRequest_32x32x32",null,b,h);this.k4(this.mj(Fq.C3i))}dialogContent(){const b=document.createElement("span");b.innerText=this.EG.Eln;const h=document.createElement("span");h.innerText=this.EG.Oko;h.style.fontWeight=this.EG.rDo;const u=document.createElement("span");u.innerText=this.EG.bUn;const y=this.OMk(),P=document.createElement("span");P.id=this.mj(Fq.C3i);P.appendChild(b);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(h);
P.appendChild(document.createElement("br"));P.appendChild(u);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(y);return P}OMk(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.EG.mln;h.href=this.jwc.LJb||"";b.appendChild(h);this.ZVb=h;this.qg.mb(bb.a.click,this.ZVb,Object(v.a)(this.jwc,this.jwc.eta,"clickHandler"));return b}dispose(){this.ZVb&&(this.qg.sc(bb.a.click,
this.ZVb,Object(v.a)(this.jwc,this.jwc.eta,"clickHandler")),this.ZVb=null);super.dispose()}}Fq.C3i="sendUsYourFileId";Object(m.a)(Fq,"SendUsYourFileDialog",Gh.StandardDialog,[814]);class $p{create(){return Ja.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(m.a)($p,"Factory",null,[813]);var dk=c(591);class Jl extends dk.a{constructor(){super();this.FileId=null}el(){return 38}static construct(b){const h=new Jl;h.FileId=b;return h}}Object(m.a)(Jl,"CreateSendUsYourFileRequest",
dk.a,[]);var Nr=c(1064);class yr{constructor(b,h,u){this.Uca=b;this.KR=h;this.cUj=u}w3i(b=!1){if(this.KR){const h=Jl.construct(this.KR()),u=new Nr.a;u.ks=h;u.status=1;u.vH="BootErrorReport";b=b?this.Uca(null):this.Uca(y=>{this.$0c(u,y)});b.cK(u);b.HW();this.cUj()}}$0c(b){5===b.statusCode&&this.w3i(!0)}}Object(m.a)(yr,"SendUsYourFileManager",null,[783]);class Ju{constructor(b,h){this.W=null;this.EG=b;this.KR=h}xc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.EG).singleInstance();
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Fq(th.a.instance,new Bp,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new yr(h=>this.kma(0,h),this.KR,()=>{w.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new $p;return new il(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),
h)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(m.a)(Ju,"SendUsYourFilePackageManager",null,[]);var zr=c(567),Is=c(1006),Yo;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(Yo||(Yo={}));Object(m.b)("AppMode",Yo);class Or{get rkk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get hYm(){return CommonUIStrings.l_NoThanks}get Eln(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get Oko(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get rDo(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get bUn(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get mln(){return CommonUIStrings.l_PrivacyStatement}}
Object(m.a)(Or,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Ys extends Ju{constructor(){super(new Or,()=>r.AFrameworkApplication.rootQuerySignature)}kma(b,h){var u;const y=(null===(u=r.AFrameworkApplication.K)||void 0===u?0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProcessResponsesAsyncWhenTaskManagerIsYielding",!1))?lf.a.instance:null;return new Is.a(b,h,"SendUsYourFile.ashx",Yo.word,Ra.App.webServiceBase,y,zr.a.amIAlone,
zr.a.b1c,zr.a.O0c)}get name(){return"WordEditor.SendUsYourFile"}static main(){K.a.instance.Kc(new Ys)}}Object(m.a)(Ys,"PackageManager",Ju,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);var Zo=c(658),vs=c(653),Zs=c(1782),Mn=c(136),hi=c(32),Pr=c(173),rn=c(78),Wj=c(768),pi=c(165),Vq=c(979);class Zm{constructor(b,h,u,y,P,aa){this.RQh=b;this.gallerySectionId=h;this.Zel=u;this.Kik=y;this.commandId=P;this.queryCommandId=aa}}Object(m.a)(Zm,
"BorderStyleMenuPropsArguments",null,[]);class Rj{constructor(b,h,u,y,P,aa,ta){this.t_b=b;this.nfj=h;this.width=u;this.CBi=y;this.height=P;this.Ori=aa;this.altText=ta}}Object(m.a)(Rj,"TableBorderStyleProperties",null,[]);class hg{constructor(){this.Tlh=[new Rj(hg.Zcj,"","2",1,8,0,"Solid Line"),new Rj(hg.GCh,"5,3","1",1,8,0,"Dashed Line"),new Rj(hg.AHh,"1,1","1",1,8,0,"Dotted Line"),new Rj(hg.CHh,"","1",2,8,3,"Double Line")];this.Ulh=[new Rj(hg.amh,"","1",1,8,0,"0.25pt"),new Rj(hg.Ylh,"","1",1,8,0,
"0.5pt"),new Rj(hg.dmh,"","2",1,8,0,"0.75pt"),new Rj(hg.Zlh,"","2",1,8,0,"1pt"),new Rj(hg.Xlh,"","3",1,8,0,"1.5pt"),new Rj(hg.emh,"","4",1,8,0,"2.25pt"),new Rj(hg.cmh,"","4",1,8,0,"3pt"),new Rj(hg.Wlh,"","5",1,8,0,"4.5pt"),new Rj(hg.bmh,"","6",1,8,0,"6pt")]}initialize(){this.E7d()}Vpl(){const b=new Zm("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Tlh,Oa.a.Umb,Oa.a.vUf);return this.oRh(b)}Wpl(){const b=new Zm("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",
this.Ulh,Oa.a.Vmb,Oa.a.wUf);return this.oRh(b)}bTh(b){switch(b){case hg.Zcj:return pi.a.u_b;case hg.GCh:return pi.a.Ocb;case hg.AHh:return pi.a.gCc;case hg.CHh:return pi.a.q2;default:return pi.a.Xsa}}cTh(b){switch(b){case hg.amh:return pi.a.$lh;case hg.Ylh:return pi.a.XXe;case hg.dmh:return pi.a.r_b;case hg.Zlh:return pi.a.Ncb;case hg.Xlh:return pi.a.Tka;case hg.emh:return pi.a.oBa;case hg.cmh:return pi.a.wea;case hg.Wlh:return pi.a.iYa;case hg.bmh:return pi.a.nBa;default:return pi.a.rF}}oRh(b){const h=
new $f.a,u=new xi.a,y=Object.assign(new vs.a,{Id:b.RQh,ExternalId:b.gallerySectionId,ExternalGalleryId:b.Zel,Type:4,Width:1,GalleryItems:[]});for(const aa of b.Kik){var P={};const ta={};ta.width=hg.tDm;ta.height=hg.sDm;P.root=ta;P=Object.assign(new Zs.a,{Id:aa.t_b,ExternalId:String.format("{0}_GalleryButton",aa.t_b),Icon:aa.t_b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:aa.t_b,FullIconStyle:P,ShouldSetTitle:"true",Alt:aa.altText});y.GalleryItems.push(P)}u.ControlList=
[];h.MenuSectionList=[];u.ControlList.push(y);h.MenuSectionList.push(u);h.UpdateDynamically=!0;return h}E7d(){const b={};for(const h of this.Tlh)b[h.t_b]=appChrome.buildBorderStyleIcon(h.nfj,h.width,h.CBi,h.height,h.Ori);for(const h of this.Ulh)b[h.t_b]=appChrome.buildBorderStyleIcon(h.nfj,h.width,h.CBi,h.height,h.Ori);appChrome.api.registerIconProvider(()=>b)}zVn(b,h,u){if(!b)return w.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==oc.a.x4)return w.ULS.sendTraceTag(577910617,
306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.W_(Mn.a.nT(b),b.node,5,u,h);break;case 0:this.W_(Mn.a.nT(b),b.node,3,u,h);break;case 1:this.W_(Mn.a.nT(b),b.node,4,u,h);break;case 3:this.W_(Mn.a.nT(b),b.node,0,u,h);break;case 7:this.W_(Mn.a.nT(b),b.node,1,u,h);break;case 8:this.W_(Mn.a.nT(b),b.node,2,u,h);break;case 6:this.W_(Mn.a.nT(b),b.node,1,u,h);this.W_(Mn.a.nT(b),b.node,2,u,h);break;case 5:this.W_(Mn.a.nT(b),b.node,3,
u,h);this.W_(Mn.a.nT(b),b.node,5,u,h);this.W_(Mn.a.nT(b),b.node,4,u,h);this.W_(Mn.a.nT(b),b.node,0,u,h);break;case 4:this.W_(Mn.a.nT(b),b.node,3,u,h),this.W_(Mn.a.nT(b),b.node,5,u,h),this.W_(Mn.a.nT(b),b.node,4,u,h),this.W_(Mn.a.nT(b),b.node,0,u,h),this.W_(Mn.a.nT(b),b.node,1,u,h),this.W_(Mn.a.nT(b),b.node,2,u,h)}return!0}G1f(b,h,u,y){if(!h)return w.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==oc.a.c0)return w.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",
h.contextId),!1;var P=h.node;const aa=new yd.GraphIterator;aa.set(P);aa.Ab(14);P=hi.TableCellReader.CNa(aa);switch(h.border){case 2:this.SRa(b,h.node,5,y,u,P);this.Kae(h.node,5,u);this.L$d(b,h.z_a(),3,u,y,P);break;case 0:this.SRa(b,h.node,3,y,u,P);this.Kae(h.node,3,u);this.L$d(b,h.z_a(),1,u,y,P);break;case 1:this.SRa(b,h.node,4,y,u,P);this.Kae(h.node,4,u);this.L$d(b,h.z_a(),0,u,y,P);break;case 3:this.SRa(b,h.node,0,y,u,P),this.Kae(h.node,0,u),this.L$d(b,h.z_a(),2,u,y,P)}return!0}tqn(b,h){if(Se.SelectionEditor.qSc(b)&&
h)switch(b=Object(na.a)(Pr.TableNodeBorderContext,b),b.border){case 2:this.eO(b.node,hg.Ho.WL(5),h);break;case 0:this.eO(b.node,hg.Ho.WL(3),h);break;case 3:this.eO(b.node,hg.Ho.WL(0),h);break;case 1:this.eO(b.node,hg.Ho.WL(4),h);break;case 7:this.eO(b.node,hg.Ho.WL(1),h);break;case 8:this.eO(b.node,hg.Ho.WL(2),h);break;case 5:h=this.eO(b.node,hg.Ho.WL(5),h);h=this.eO(b.node,hg.Ho.WL(3),h);h=this.eO(b.node,hg.Ho.WL(0),h);this.eO(b.node,hg.Ho.WL(4),h);break;case 6:h=this.eO(b.node,hg.Ho.WL(1),h);this.eO(b.node,
hg.Ho.WL(2),h);break;case 4:h=this.eO(b.node,hg.Ho.WL(5),h),h=this.eO(b.node,hg.Ho.WL(3),h),h=this.eO(b.node,hg.Ho.WL(0),h),h=this.eO(b.node,hg.Ho.WL(4),h),h=this.eO(b.node,hg.Ho.WL(1),h),this.eO(b.node,hg.Ho.WL(2),h)}}Xon(b,h){if(Se.SelectionEditor.rSc(b)&&h)switch(b=Object(na.a)(Pr.TableNodeBorderContext,b),b.border){case 2:this.eO(b.node,hg.Ho.XN(5),h);break;case 0:this.eO(b.node,hg.Ho.XN(3),h);break;case 3:this.eO(b.node,hg.Ho.XN(0),h);break;case 1:this.eO(b.node,hg.Ho.XN(4),h)}}vgf(b,h,u){u=
null;if(!b)return w.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),u;b.properties.hasProperty(h.size)&&(u=new Vq.a,u.weight=b.properties.ia(h.size,pi.a.rF),u.style=b.properties.ia(h.style,pi.a.Xsa),u.color=b.properties.ia(h.color,0));return u}F1f(b,h,u){b?u?(b.properties.setValue(h.size,u.weight),b.properties.setValue(h.style,u.style),b.properties.setValue(h.color,u.color)):w.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):w.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}OKb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):w.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}W_(b,h,u,y,P){P=this.gBo(b,h,u,y,P);this.Zfc(h,hg.Ho.WL(u),P);switch(u){case 5:this.nRa(h,2,y,P);break;case 4:this.nRa(h,1,y,P);break;case 0:this.nRa(h,3,y,P);break;case 3:this.nRa(h,0,y,P);break;case 1:this.nRa(h,7,y,P);break;case 2:this.nRa(h,8,y,P)}}gBo(b,h,u,y,P){if(3!==y){var aa=
hg.Mg.GJd(b,h,u,3);void 0!==aa&&null!==aa&&aa!==pi.a.oZ&&(aa=rn.a.gfc(aa),P.color=hg.Kic.GBa(h,aa))}1!==y&&(aa=hg.Mg.GJd(b,h,u,1),void 0!==aa&&null!==aa&&aa!==pi.a.qF&&(P.weight=parseFloat(aa)*pi.a.s_b));2!==y&&(b=hg.Mg.GJd(b,h,u,2),void 0!==b&&null!==b&&b!==pi.a.qF&&(P.style=b));return P}SRa(b,h,u,y,P,aa){y&&(P=this.Ovo(b,h,aa,u,y,P));this.Zfc(h,hg.Ho.XN(u),P)}Ovo(b,h,u,y,P,aa){if(3!==P){var ta="",Pa=hg.Mg.nCb(b,h,y,!1,!0,u,3);Pa&&(ta=Pa.qyb);void 0!==ta&&null!==ta&&ta!==pi.a.oZ&&(ta=rn.a.gfc(ta),
aa.color=hg.Kic.GBa(h,ta))}if(1!==P){ta="";if(Pa=hg.Mg.nCb(b,h,y,!1,!0,u,1))ta=Pa.qyb;void 0!==ta&&null!==ta&&ta!==pi.a.qF&&(aa.weight=parseFloat(ta)*pi.a.s_b)}if(2!==P){P="";if(b=hg.Mg.nCb(b,h,y,!1,!0,u,2))P=b.qyb;void 0!==P&&null!==P&&P!==pi.a.qF&&(aa.style=P)}return aa}yVm(b){let h=0,u=0;({ZUm:h,FSm:u}=this.ZJl(b.style,h,u));b.weight<h&&(b.weight=h);b.weight>u&&(b.weight=u);return b}ZJl(b,h,u){switch(b){case pi.a.u_b:case pi.a.Ocb:case pi.a.gCc:h=2;u=48;break;case pi.a.q2:h=2;u=24;break;default:h=
2,u=48}return{ZUm:h,FSm:u}}L$d(b,h,u,y,P,aa){if(h)if(y)for(let ta=0;ta<h.length;ta++)switch(u){case 2:this.SRa(b,h[ta],5,P,y,aa);break;case 0:this.SRa(b,h[ta],3,P,y,aa);break;case 1:this.SRa(b,h[ta],4,P,y,aa);break;case 3:this.SRa(b,h[ta],0,P,y,aa)}else w.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else w.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}Kae(b,h,u){const y=new yd.GraphIterator;y.set(b);y.Ab(14);const P=hi.TableCellReader.Gma(b);
b=hi.TableCellReader.YN(b);wf.forEachCell(y,P,b,(aa,ta,Pa)=>{aa=aa.currentNode;hi.TableCellReader.Er(aa)&&0==Pa&&0<ta&&this.Zfc(aa,hg.Ho.XN(h),u)})}Zfc(b,h,u){b?(u=this.yVm(u),b.properties.setValue(h.color,u.color),b.properties.setValue(h.size,u.weight),b.properties.setValue(h.style,u.style)):w.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}nRa(b,h,u,y){if(b){var P=xh.TableReader.$f(b),aa=xh.TableReader.Wg(b),ta=new yd.GraphIterator,Pa=[];for(let vb=0;vb<P;vb++)for(let Kb=0;Kb<
aa;Kb++)if(ta.set(b),wf.moveToCell(ta,vb,Kb),ta&&ta.currentNode&&!hi.TableCellReader.pg(ta))switch(h){case 2:hi.TableCellReader.bga(ta)&&Pa.push(Pr.TableNodeBorderContext.D6(ta.currentNode,2));break;case 0:hi.TableCellReader.cga(ta)&&Pa.push(Pr.TableNodeBorderContext.D6(ta.currentNode,0));break;case 3:hi.TableCellReader.swf(b,ta.currentNode)&&Pa.push(Pr.TableNodeBorderContext.D6(ta.currentNode,3));break;case 1:hi.TableCellReader.twf(b,ta.currentNode)&&Pa.push(Pr.TableNodeBorderContext.D6(ta.currentNode,
1));break;case 7:hi.TableCellReader.twf(b,ta.currentNode)||Pa.push(Pr.TableNodeBorderContext.D6(ta.currentNode,1));break;case 8:hi.TableCellReader.swf(b,ta.currentNode)||Pa.push(Pr.TableNodeBorderContext.D6(ta.currentNode,3))}for(b=0;b<Pa.length;b++)switch(h=Pa[b],h.border){case 2:this.T_c(h.node,hg.Ho.XN(5),u,y);this.R7d(h.z_a(),hg.Ho.XN(0),u,y);break;case 0:this.T_c(h.node,hg.Ho.XN(3),u,y);this.R7d(h.z_a(),hg.Ho.XN(4),u,y);break;case 1:this.T_c(h.node,hg.Ho.XN(4),u,y);this.R7d(h.z_a(),hg.Ho.XN(3),
u,y);break;case 3:this.T_c(h.node,hg.Ho.XN(0),u,y),this.R7d(h.z_a(),hg.Ho.XN(5),u,y)}}else w.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}R7d(b,h,u,y){if(b)for(let P=0;P<b.length;P++)this.T_c(b[P],h,u,y);else w.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}T_c(b,h,u,y){if(b){var P=b.ia(h.color,hg.U6e),aa=b.ia(h.size,hg.W6e),ta=b.ia(h.style,hg.V6e),Pa=new Vq.a;Pa.weight=y.weight;Pa.style=y.style;Pa.color=y.color;2!==u||P===hg.U6e&&aa===hg.W6e?3!==
u||ta===hg.V6e&&aa===hg.W6e?1!==u||P===hg.U6e&&ta===hg.V6e?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Pa.color=P,Pa.style=ta,this.Zfc(b,h,Pa)):(Pa.style=ta,Pa.weight=aa,this.Zfc(b,h,Pa)):(Pa.color=P,Pa.weight=aa,this.Zfc(b,h,Pa))}else w.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}eO(b,h,u){var y=b.properties.ia(h.style,pi.a.qF);y!==pi.a.qF&&(u.lineStyle!==pi.a.qF?u.lineStyle!==y&&(u.lineStyle=pi.a.Tsk):u.lineStyle=
y);y=b.properties.ia(h.size,pi.a.rF);y!==pi.a.rF&&(u.PTc!==pi.a.rF?u.PTc!==y&&(u.PTc=pi.a.Lsk):u.PTc=y);b=b.properties.ia(h.color,0);b=rn.a.jE(b);b!==pi.a.oZ&&(u.borderColor!==pi.a.oZ?u.borderColor!==b&&(u.borderColor=pi.a.Dsk):u.borderColor=b);return u}static get Ho(){return null!=hg.bmg?hg.bmg:hg.bmg=pi.a.instance}static get Mg(){return null!=hg.yzg?hg.yzg:hg.yzg=Ja.a.instance.Pa("WordEditor.IWACTableStyleReader")}static get Kic(){return null!=hg.vxg?hg.vxg:hg.vxg=Wj.a.instance}}hg.tDm="110px";
hg.sDm="20px";hg.Zcj="SolidLineStyle";hg.GCh="DashedLineStyle";hg.AHh="DottedLineStyle";hg.CHh="DoubleLineStyle";hg.amh="BorderPointSizeOneQuarter";hg.Ylh="BorderPointSizeOneHalf";hg.dmh="BorderPointSizeThreeQuarters";hg.Zlh="BorderPointSizeOne";hg.Xlh="BorderPointSizeOneAndHalf";hg.emh="BorderPointSizeTwoAndQuarter";hg.cmh="BorderPointSizeThree";hg.Wlh="BorderPointSizeFourAndHalf";hg.bmh="BorderPointSizeSix";hg.V6e="single";hg.W6e=4;hg.U6e=0;Object(m.a)(hg,"TableBorderManager",null,[529]);var Op=
c(843),pm=c(58),Av=c(202);class Wv{constructor(b,h){this.$1g=this.GXg=null;this.XLa=b;this.e_g=h}get $Ii(){return this.e_g}get coa(){return this.GXg}get SVf(){return this.$1g}c7i(b,h){this.$1g=b;this.GXg=h}D_n(b){this.e_g=b}}Object(m.a)(Wv,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var Nf=c(104),tj=c(203),Dl=c(388),$o=c(155),so=c(262),lq=c(596),dm=c(89),Pp=c(448),Ar=c(937);class Ok extends Op.a{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb=null,Yb=null){super(b,h,u,Yb,Sb);this.t8a=Ar.a.instance;
this.sa=new ie.a;this.i_e=[Lc.a.ENb,Lc.a.a6a,Lc.a.Snb,Lc.a.CNb,Lc.a.Z5a,Lc.a.Qnb,Lc.a.BNb,Lc.a.Y5a,Lc.a.Pnb,Lc.a.DNb,Lc.a.$5a,Lc.a.Rnb];this.EGj=[Lc.a.va,Lc.a.ua,Ge.a.Vh,Ge.a.Yp];this.Ci=y;this.qwb=P;this.Zc=aa;this.ib=ta;this.r5=Pa;this.zm=vb;this.wqc=Kb;this.d9g=Sb;this.D5j=Yb;this.Gnn=this.bTf.bind(this)}get Ji(){return this.Ci.value}get Yr(){return this.r5?this.r5.instance:null}MTe(b){this.sa.addHandler("OnParagraphDelete",b)}get qh(){return!!this.wqc.instance&&this.wqc.instance.qh}rPc(b,h,u,
y,P){h.setValue(Lc.a.Pc,Gc.a.lG());h.setValue(Lc.a.Nlm,P);lq.b(y,h,[Lc.a.e0]);super.rPc(b,h,u,y,P)}JQd(b,h,u,y,P){const aa=this.jNc(h,u,y,P);this.bBd(aa,h,!1);return super.JQd(b,h,u,y,P)}mud(b,h,u,y,P){const aa=this.jNc(h,u,y,P);this.bBd(aa,h,!0);super.mud(b,h,u,y,P);return aa}u3e(b,h,u,y){h=this.jNc(b,h,u,y);this.bBd(h,b,!0);return h}insertRows(b,h,u,y){const P=pm.a.Ar(b),aa=new yd.GraphIterator;aa.ed(b);const ta=aa.currentNode;aa.Rb(1);let Pa;Pa=h?b.lD(1):b.currentNode;const vb=b.qc();if(!vb)throw Error.create("table row insertion cannot be performed on a null tableNode");
const Kb=xh.TableReader.$f(vb),Sb=vb.HS.Mg;let Yb=!1;try{vb.Zoa=1;const Ac=this.t8a.Wfb(vb,Sb.Zz(vb));this.aSa(b.currentNode);this.Spa(b);this.cbk(u,b,Pa,aa,ta,h,y);const Sc=this.t8a.Wfb(vb,Sb.Zz(vb));this.r5a(vb,xh.TableReader.$f(vb)+u);Yb=!0;this.tRd(vb,Ac,Sc)}finally{vb.Zoa=0,Yb||this.r5a(vb,xh.TableReader.$f(vb)+u)}P+1!==Kb||h?!P&&h&&Ok.ttf(vb,u):Ok.ttf(vb,P);h=P+u+(h?0:1);h<Kb+u&&this.Kfi(vb,h);return b.currentNode}cbk(b,h,u,y,P,aa,ta){let Pa=null,vb=null;for(var Kb=0;Kb<b;++Kb){var Sb=Av.a.instance.createInstance(393251);
vb||(vb=Sb);Pa=Sb;this.rPc(h,Sb,u,P,aa)}b=xh.TableReader.Wg(h.currentNode);u=!0;do{u?(h.Ii(Pa),u=!1):h.yf(1);P=Array(b);for(Kb=0;Kb<b;++Kb){Sb=this.AMa();const Yb=this.u3e(Sb,y.currentNode,aa,!0);let Ac=null;Yb.pg||(Ac=ta(Yb));P[Kb]=new Wv(Sb,Ac);P[Kb].c7i(Yb,null);y.yf(1)}for(Kb=0;Kb<b;++Kb)Sb=P[Kb].XLa,h.d2(Sb,1,Op.a.oJa?Op.a.oJa():null),hi.TableCellReader.Er(Sb)||(this.Txb(h,Sb,P[Kb].$Ii),this.Sxh(P[Kb].SVf,Sb,!0));y.j7(1)}while(h.currentNode!==vb)}insertColumns(b,h,u,y,P){let aa=b.currentNode,
ta=!1,Pa=xh.TableReader.Wg(b.currentNode);const vb=Pa;try{this.aSa(b.currentNode);this.Spa(b);const Kb=aa.HS.Mg;aa.Zoa=1;const Sb=this.t8a.Wfb(aa,Kb.Zz(aa));Pa=xh.TableReader.Wg(b.currentNode);-1===h&&(h=Pa);this.abk(b,y,u,h,P);aa=b.currentNode;Pa+=y;this.mVf(b,Pa,y,h);ta=!0;const Yb=this.t8a.Wfb(aa,Kb.Zz(aa));this.tRd(aa,Sb,Yb)}finally{aa.Zoa=0,ta||this.mVf(b,Pa,y,h)}h!==vb||u?!h&&u&&Ok.stf(aa,y):Ok.stf(aa,h-1)}abk(b,h,u,y,P){var aa=b.currentNode;y=u?y:y-1;b.Rb(1);var ta=new ob.a;do{var Pa=b.kD(y,
1);b.qc();var vb=Array(h);for(let Sb=0;Sb<h;++Sb){var Kb=this.AMa();const Yb=this.ILl(b,Pa,u),Ac=this.u3e(Kb,Pa,u,!1);Kb=new Wv(Kb,null);Kb.c7i(Ac,Yb);vb[Sb]=Kb}ta.add(vb)}while(b.yi(1));u=ta.toArray();for(y=0;y<u.length;y++)for(ta=0;ta<h;ta++)Pa=u[y][ta],vb=Pa.SVf,vb.pg||Pa.D_n(P(vb));b.set(aa);b.Rb(1);P=0;do{for(aa=0;aa<h;++aa)y=u[P][aa],ta=y.XLa,b.DEb(ta,y.coa,1,Op.a.oJa?Op.a.oJa():null),hi.TableCellReader.Er(ta)||(this.Txb(b,ta,y.$Ii),this.Sxh(y.SVf,ta,!1));P++}while(b.yi(1))}tRd(b,h,u){if(h){var y=
2===b.Zoa,P=[],aa=new yd.GraphIterator;aa.set(b);for(var ta=aa.Rb(1);ta;){for(ta=aa.Rb(1);ta;){const Pa=ta.id.toString();Pa in h&&h[Pa]===u[Pa]&&(!y||!hi.TableCellReader.cga(aa)&&!hi.TableCellReader.bga(aa))||P.push(ta);ta=aa.yi(1)}ta=aa.yi(1)}if(0<P.length){h=new dg.GraphTransaction(3);try{h.set(b.Wi);for(const Pa of P)Pa.qRd()}finally{h&&h.dispose()}}}}deleteRows(b,h){const u=pm.a.Ar(b),y=u+h;let P=b.qc();const aa=P.HS.Mg;let ta=!1;w.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",
P.id.toString(),P.type,u,h);const Pa=xh.TableReader.$f(P);try{P.Zoa=2;const vb=this.t8a.Wfb(P,aa.Zz(P));this.aSa(b.currentNode);this.Spa(b);for(let Sb=y-1;Sb>=u;--Sb){b.kD(Sb,1);let Yb=b.Rb(1);for(;Yb;)this.wWc(Yb,!0),Yb=b.yi(1);this.C0a(b);w.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.ef);b.Jg()}P=b.currentNode;const Kb=this.t8a.Wfb(P,aa.Zz(P));this.r5a(P,xh.TableReader.$f(P)-h);this.x0d(b);ta=!0;this.tRd(P,vb,Kb)}finally{P.Zoa=0,ta||
(this.r5a(b.currentNode,xh.TableReader.$f(b.currentNode)-h),this.x0d(b))}Pa===y&&0<=u-1&&Ok.ttf(P,u-1);u<Pa-h&&this.Kfi(P,u)}deleteColumns(b,h,u){b=Object(na.a)(yd.GraphIterator,b);let y=Object(na.a)(Pp.a,b.currentNode),P=xh.TableReader.Wg(b.currentNode);const aa=y.HS.Mg;let ta=!1;w.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",y.id.toString(),y.type,h,u);const Pa=P;try{y.Zoa=2;const vb=this.t8a.Wfb(y,
aa.Zz(y));this.aSa(b.currentNode);this.Spa(b);-1===h&&(h=P-u);b.Rb(1);do for(let Sb=h+u-1;Sb>=h;--Sb)b.kD(Sb,1),this.wWc(b.currentNode,!1),this.C0a(b),b.Jg();while(b.yi(1));P-=u;this.lVf(b,P,h,u);ta=!0;y=Object(na.a)(Pp.a,b.currentNode);const Kb=this.t8a.Wfb(y,aa.Zz(y));this.tRd(y,vb,Kb);this.w0d(b)}finally{y&&(y.Zoa=0),ta||(this.lVf(b,P,h,u),this.w0d(b))}Pa===h+u&&0<=h-1&&Ok.stf(y,h-1)}mergeCells(b,h,u){if(b&&(1!==h||1!==u)){var y=new yd.GraphIterator;y.ed(b);y.Ab(14);this.P4e(y,h,u);this.vvo(y,
h,u);y.qc();y.qc();this.$Ei(y)}}Ddj(b,h,u){if(b&&(1!==h||1!==u)){var y=new yd.GraphIterator;y.ed(b);y.Ab(14);this.jXk(y,h,u);y.qc();y.qc();this.pHi(y)}}wWc(b,h){w.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.q2l(b,h,this.Gnn)}bTf(b,h){const u=b.currentNode;u.pg=!1;this.bBd(h.currentNode,b.currentNode,!0);u.removeProperty(Lc.a.skippedCell);u.removeProperty(Lc.a.renderCell);1===u.colSpan&&1===u.rowSpan&&u.rDc();Op.a.TJ.i6(b,!0,Op.a.S0h(h.currentNode));
wf.returnToCell(b);this.ZPk(h,b)}Yof(b,h,u){super.Yof(b,h,u);1===h.controlCell.colSpan&&1===h.controlCell.rowSpan?h.controlCell.rDc():!u&&h.C9d&&(b.kOa?1<b.colSpan&&(h=new yd.GraphIterator,h.set(b),h.Ab(15),wf.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(u=new yd.GraphIterator,u.set(h.controlCell),u.Ab(15),h=dm.a(u),u=new yd.GraphIterator,u.set(b),u.Ab(15),wf.moveToColumnByIndex(u,h),--u.currentNode.colSpan))}jNc(b,h,u,y){const P=super.jNc(b,h,u,y);if(b.pg&&!y){var aa=h.awa;aa.C9d&&(y=
Op.a.w4b(aa.controlCell,y),!aa.xzd&&u||aa.xzd===y-1&&!u?b.colSpan=1:(u=new yd.GraphIterator,u.set(aa.controlCell),u.Ab(15),aa=dm.a(u),u=new yd.GraphIterator,u.set(h),u.Ab(15),wf.moveToColumnByIndex(u,aa),u.currentNode.colSpan+=1))}P.ia(Lc.a.skippedCell,!1)&&(b.pg=!0,b.z3=!0,b.knb=!0);return P}x0d(b){this.GOb(b,Lc.a.complexTable)}w0d(b){this.GOb(b,Lc.a.complexTable)}$Ei(b){this.GOb(b,Lc.a.complexTable)}pHi(b){this.GOb(b,Lc.a.complexTable)}ZPk(b,h){if(b&&h){let u;b=yd.GraphIterator.$a(b.currentNode);
mg.OutlineNavigator.Y7(b)&&(b.Rb(2),b=b.currentNode,12==b.type&&(u=b.Nf(Ge.a.Vh)));u&&(b=new yd.GraphIterator,b.ed(h),mg.OutlineNavigator.Y7(b)&&b.Rb(2)&&(h=b.currentNode,12==h.type&&h.Zg(Ge.a.Vh,u)))}}bBd(b,h,u){b&&(lq.b(b,h,this.i_e),lq.b(b,h,[Ge.a.wF]),u&&lq.b(b,h,[Lc.a.AM,Lc.a.DO,Lc.a.QGa,Lc.a.OGa,Lc.a.Bpa,Lc.a.skippedCell,Lc.a.renderCell]))}Sxh(b,h,u){b&&(b=yd.GraphIterator.$a(b),b.zd(),b.Vd(),h=yd.GraphIterator.$a(h),h.zd(),h.Vd(),wg.OutlineElementReader.Oh(b)&&og.OutlineElementNavigator.Ee(b)&&
wg.OutlineElementReader.Oh(h)&&og.OutlineElementNavigator.Ee(h)&&lq.b(b.currentNode,h.currentNode,this.EGj),u&&(og.OutlineElementNavigator.$d(b),og.OutlineElementNavigator.$d(h),wj.ListReader.lj(b)&&(u=Ok.dEm.Qu(b),u.gB=Nf.a.Cj,{LDa:u}=Ok.xn.Psa(u.propertySet,h,u))))}C0a(b){this.qh&&this.zm.dCn(b.currentNode);for(b=tj.a.lq(b);b.moveNext();)if(be.ParagraphReader.ic(b.currentNode)){const h=En.e(b.currentNode);for(const u of h)u.Uga();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else wj.ListReader.lj(b.iterator)&&
this.Yr&&this.Yr.axa(b.iterator)}zD(b,h){let u=null;if(this.d9g.zg){const y=Object(na.a)(Pp.a,b);y&&(u=y.TQ())}xh.TableReader.qm(b)&&(1===h?h=3:3===h&&(h=1));super.zD(b,h);this.d9g.zg&&this.D5j.nca(b,u);Object(jb.a)(Pp.a,b)&&Op.a.Bh.P7i(Object(na.a)(Pp.a,b),(new Dl.a(1,0)).yt)}P2f(b,h){const u=Array(h),y=this.G5h(b)/h;for(let P=0;P<h;P++)u[P]=Math.max(Bf.a.Ml($o.a.W8,0),y);b.setValue(Ge.a.oz,u)}H6i(b){b.setValue(Lc.a.tableLayout,0)}egh(b,h,u,y,P){const aa=Array(u);for(var ta=0,Pa=0;ta<y;++ta)aa[ta]=
h[ta],Pa+=aa[ta];for(;ta<u;++ta)aa[ta]=0>ta-P?h[0]:h[ta-P],Pa+=aa[ta];ta=this.G5h(b.currentNode);if(Pa>ta)for(Pa=ta/Pa,ta=0;ta<u;++ta)aa[ta]=Math.max(Bf.a.Ml($o.a.W8,0),aa[ta]*Pa);return aa}G5h(b){var h=yd.GraphIterator.$a(b);b=Bf.a.Ml(Bf.a.Mi(xh.TableReader.r5h(h),0),0);if(h.Ab(16))return wf.returnToCell(h),h=$o.a.$ic(h.currentNode),Bf.a.Ml(Bf.a.Mi(h,0),0)-b;h=so.a.a6c(h);return Bf.a.Ml(Bf.a.Mi(h,0),0)-b}YN(b,h,u){const y=new yd.GraphIterator;y.set(b);wf.moveToCell(y,h,u);return y.currentNode.ia(Lc.a.colSpan,
1)}dgc(b){var h=Ra.App.xa.jb.Jt;if(h.ue&&(h=b.xe(h.Sb))){var u=!1,y=xh.TableReader.Wg(b),P=b.ia(Ge.a.oz,Array(y));for(var aa of P)if(!aa){u=!0;break}if(u){P=Jj.a.clone(P);aa=b.ia(Lc.a.complexTable,!1);w.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",y,P,aa);u=1;var ta=0;for(let vb=0;vb<y;)if(aa&&(u=this.YN(b,0,vb)),1<u){for(var Pa=0;Pa<u;Pa++)P[vb]||(P[vb]=this.w_h(0)),vb++;ta+=u-1}else(Pa=h.dzl(vb-ta))||w.ULS.sendTraceTag(36726404,
341,50,"Got no width for graph column {0} (ghost cells {1})",vb,ta),P[vb]||(P[vb]=this.w_h(Pa)),vb++;b.setValue(Ge.a.oz,P)}}}w_h(b){return Bf.a.Ml(Math.max(b,$o.a.W8),0)}aSa(b){b=yd.GraphIterator.$a(b);this.dgc(b.currentNode);b.Ab(14)&&(wf.returnToContainingTable(b),this.dgc(b.currentNode))}M7i(b,h){h&&b.setValue(Lc.a.X8,h)}q3f(b,h){h&&b.setValue(Lc.a.gic,h)}xsh(b,h){const u=xh.TableReader.Wg(b);Op.a.yFk(b,h,u)}DWn(b,h,u){let y;if(!({tableNode:y}=this.R9b(b)).returnValue)return!1;if(h&&u&&h.length===
u.length){if(!this.a7k(y,h))return!1;for(let P=0;P<h.length;++P){const aa=this.qwb.u2c(b,h[P],u[P]);if(aa)return w.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",aa),!1}this.IZd(y);return!0}return!1}Qkk(b,h){let u;if(!({tableNode:u}=this.R9b(b)).returnValue||xh.TableReader.YA(u))return!1;var y=Object(na.a)(yd.GraphIterator,this.Zc.ng(u));wf.moveToLastRow(y);var P=xh.TableReader.$f(u);if(h&&0<h.length){this.insertRows(y,!1,h.length,
()=>null);y=xh.TableReader.$f(u);var aa=this.Zc.ng(u);P=this.m5h(aa,P,y-1);for(y=0;y<P.length;++y){aa=P[y];const ta=h[y];for(let Pa=0;Pa<aa.length;++Pa){let vb;if(vb=ta&&ta[Pa]?this.qwb.u2c(b,aa[Pa],ta[Pa].toString()):this.qwb.u2c(b,aa[Pa],""))return w.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",vb),!1}}}this.IZd(u);return!0}zkk(b,h){let u;if(!({tableNode:u}=this.R9b(b)).returnValue||xh.TableReader.YA(u))return!1;var y=this.Zc.ng(u),
P=xh.TableReader.Wg(u);if(h&&0<h.length){this.insertColumns(Object(na.a)(yd.GraphIterator,y),P,!1,h[1].length,()=>null);var aa=xh.TableReader.Wg(u);y=this.SVl(y,P,aa-1);for(P=0;P<y.length;++P){aa=h[P];const ta=y[P];for(let Pa=0;Pa<ta.length;++Pa){let vb;if(vb=aa&&aa[Pa]?this.qwb.u2c(b,ta[Pa],aa[Pa].toString()):this.qwb.u2c(b,ta[Pa],""))return w.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",vb),!1}}}this.IZd(u);return!0}V0k(b){let h;
if(!({tableNode:h}=this.R9b(b)).returnValue)return!1;let u=this.T_a(h);const y=xh.TableReader.$f(h);var P=this.Zc.ng(h);P=this.m5h(P,u,y-1);for(let aa=0;aa<P.length;++aa){const ta=P[aa];for(let Pa=0;Pa<ta.length;++Pa){const vb=this.qwb.ZTi(b,ta[Pa]);if(vb)return w.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",vb),!1}}u=u?u:1;b=this.Zc.ng(h);b.YF(u)&&15===b.ef&&this.deleteRows(Object(na.a)(yd.GraphIterator,b),y-u);this.IZd(h);return!0}T_a(b){let h=
0;const u=this.Zc.ng(b);let y=u.Vd();for(;y&&y.ia(Lc.a.Wib,!1);)h++,y=u.ht();return!h&&hl.StyleReader.Dca.pT(b)&32?1:h}vvo(b,h,u){var y,P;const aa=b.currentNode,ta=new yd.GraphIterator;ta.ed(b);let Pa=null,vb=null,Kb=null;const Sb=pi.a.instance.XN(3),Yb=pi.a.instance.XN(4),Ac=pi.a.instance.XN(5),Sc=pi.a.instance.XN(0);wf.forEachCell(ta,h,u,(nd,Ad,he)=>{nd=nd.currentNode;Ad||he||(Pa=Ok.nz.vgf(nd,Sb,Pa));Ad||he!==u-1||(vb=Ok.nz.vgf(nd,Yb,vb));0<Ad&&!he&&(Pa?Ok.nz.F1f(nd,Sb,Pa):Ok.nz.OKb(nd,Sb),vb?Ok.nz.F1f(nd,
Yb,vb):Ok.nz.OKb(nd,Yb),Ok.nz.OKb(nd,Ac),Ad!==h-1&&Ok.nz.OKb(nd,Sc));he||Ad!==h-1||(Kb=Ok.nz.vgf(nd,Sc,Kb))});b=null===(P=null===(y=null===Ra.App||void 0===Ra.App?void 0:Ra.App.xa)||void 0===y?void 0:y.jb)||void 0===P?void 0:P.Jt;vb?(y=Pr.TableNodeBorderContext.D6(aa,1),Ok.nz.G1f(Mn.a.Fp(b),y,vb,0)):Ok.nz.OKb(aa,Yb);y=Pr.TableNodeBorderContext.D6(aa,0);if(Pa)Ok.nz.G1f(Mn.a.Fp(b),y,Pa,0);else for(y=Object(na.a)(Pr.TableNodeBorderContext,y).z_a(),P=0;P<y.length;P++)Ok.nz.OKb(y[P],Yb);Kb?Ok.nz.F1f(aa,
Sc,Kb):Ok.nz.OKb(aa,Sc)}a7k(b,h){for(let y=0;y<h.length;++y){var u=this.Zc.ng(h[y]);if(u.Ab(14)&&(u=u.kd(14),b.id===u.id))continue;return!1}return!0}R9b(b){let h=null;if(b&&b.Ws.toString()!==b.fx.toString())return{returnValue:!1,tableNode:h};h=this.Ji.Db(b.Ws);return 14===h.type&&this.qwb.R9b(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}m5h(b,h,u){const y=[];wf.forEachCellInTable(Object(na.a)(yd.GraphIterator,b),(P,aa,ta)=>{if(aa>=h&&aa<=u)ta||y.push([]),hi.TableCellReader.pg(P)||
Array.add(y[aa-h],P.currentNode);else if(aa>u)return!1;return!0});return y}SVl(b,h,u){const y=[];wf.forEachCellInTable(Object(na.a)(yd.GraphIterator,b),(P,aa,ta)=>{ta>=h&&ta<=u&&(ta===h&&y.push([]),hi.TableCellReader.pg(P)||Array.add(y[aa],P.currentNode));return!0});return y}IZd(b){if(b&&14===b.type){b=Object(na.a)(yd.GraphIterator,this.Zc.ng(b));const h=new ob.a;be.ParagraphReader.Fgb(b,!0,!1,h);b=Kf.SelectionFactory.we(h.J(h.count-1),0);this.ib.setSelection(b)}}static get characterPropertiesEditor(){return null!=
Ok.mmg?Ok.mmg:Ok.mmg=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get nz(){Ok.esa||(Ok.esa=Ja.a.instance.Pa("WordEditor.ITableBorderManager"));return Ok.esa}static get dEm(){return null!=Ok.stg?Ok.stg:Ok.stg=Ja.a.instance.resolve("Box4.List.IListReader")}static get xn(){return null!=Ok.ntg?Ok.ntg:Ok.ntg=Ja.a.instance.resolve("Box4.List.IListEditor")}Kfi(b,h){const u=new yd.GraphIterator;u.set(b);wf.moveToFirstRow(u);wf.moveToRowByIndex(u,h);do u.currentNode.Ck(4,!0);while(wf.moveToNextRow(u))}static ttf(b,
h){if(b){var u=xh.TableReader.$f(b),y=xh.TableReader.Wg(b);if(!(!Ra.App.xa.jb.Jt.ue||0>h||h>=u))for(u=new yd.GraphIterator,u.set(b),b=0;b<y;b++){b?wf.moveToNextColumn(u):wf.moveToCell(u,h,b);if(!u||!u.currentNode||16!==u.currentNode.type)continue;let P=u.currentNode;hi.TableCellReader.Er(P)&&(P=hi.TableCellReader.kfa(P));P&&P.Ck(4,!0)}}else w.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static stf(b,h){if(b){var u=xh.TableReader.$f(b),y=xh.TableReader.Wg(b),
P=new yd.GraphIterator;if(!(!Ra.App.xa.jb.Jt.ue||0>h||h>=y))for(y=0;y<u;y++){P.set(b);wf.moveToCell(P,y,h);if(!P||!P.currentNode)continue;let aa=P.currentNode;hi.TableCellReader.Er(aa)&&(aa=hi.TableCellReader.kfa(aa));aa&&aa.Ck(4,!0)}}else w.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}Ok.esa=null;Object(m.a)(Ok,"TableEditor",Op.a,[523,524]);class Qp{get name(){return"WordEditor.TableEditors"}xc(b){r.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.TableEditors.TableEditor",()=>new Ok(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new Zf.a(()=>Ra.App.xa.jb.Yc.Bd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Zo.a,Hh.a.instance,b.Za("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),b.Za("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),
b.ha("WordEditor.TableEditors.TableBorderManager",()=>new hg).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){K.a.instance.Kc(new Qp)}}Object(m.a)(Qp,"WordEditorTableEditorsPackage",null,[1,2]);class ap{get name(){return"WordEditor.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new ap)}}Object(m.a)(ap,"WordEditorTextLevelEditorsPackage",null,[1,2]);var st=c(1880);c(445);var Ku=c(766),Cp=c(225),to=c(260);class Js{constructor(b){this.OXj=
b}HVk(){const b=Av.a.instance.createInstance(393228);b.setValue(Ge.a.KK,Cp.a.first);b.setValue(Ge.a.wlh,0);b.setValue(Ge.a.jba,Jf.OutlineReader.vDh);(new Ku.OutlineIndentInfo(!0)).e1i(b);return b}i6(b,h,u=null){const y=b.currentNode;if(!b.wE(1))return this.Qhb(b,null,h,u);wg.OutlineElementReader.AK(b)&&og.OutlineElementNavigator.KFf(b,!0);return wg.OutlineElementReader.Oh(b)?Js.ih.pD(b,!1,h,u):(b.h1c(y),null)}pAk(b){return Jf.OutlineReader.kxf(b.currentNode)||wg.OutlineElementReader.Oh(b)||wg.OutlineElementReader.AK(b)||
hi.TableCellReader.isTableCell(b)}Qhb(b,h=null,u=!1,y=null){if(!this.pAk(b))return null;const P=Js.ih.Izb();this.X0n(P,b);b.DEb(P,h,1,null);b.Ii(P);u&&(Js.ih.GN(b,y),og.OutlineElementNavigator.$d(b));return P}X0n(b,h){if(h=this.lSl(h))switch(h.type){case 11:Js.ih.k$e(h,b,!0);break;case 8:h=Js.Te.isRtl(h),Js.ih.kMb(b,h)}}lSl(b){return this.OXj.mSl(b)}jMb(b,h){b.setValue(Ge.a.Yp,h?11:9)}KWn(b,h){const u=to.WordSectionNavigator.instance.fJ(b);return u?Jf.OutlineReader.ZN(b)!==h?(u.setValue(Lc.a.f7e,
h),!0):!1:null}static get Te(){return se.PageReader.instance}static get ih(){return Js.Bh||(Js.Bh=Ja.a.instance.resolve("Box4.IOutlineElementEditor"))}static set ih(b){Js.Bh=b}}Js.Bh=null;Js.ze=null;Object(m.a)(Js,"OutlineEditor",null,[549]);const Bv=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new Js(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new st.a(b.af("Box4.IOutlineEditor"),b.af("Box4.List.IListEditor"),
b.af("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").singleInstance()};class Ks{get name(){return"Box4.OutlineLevelEditors"}xc(b){Bv(b)}init(){}dispose(){}static main(){K.a.instance.Kc(new Ks)}}Object(m.a)(Ks,"Box4OutlineLevelEditorsPackage",
null,[1,2]);class es{constructor(b){this.wCd=null;this.UBi=b.lb("OfficeOnlineChromeExtensionId");this.aCi=b.lb("ChromeClipboardAccessExtensionId");this.Ukm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.y5g=!this.Gsm();this.wCd=this.AMb?this.aCi:this.UBi}eKn(){this.wCd===this.UBi&&this.Pki&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.wCd=this.aCi;this.y5g=!0}get AMb(){return this.y5g}Gsm(){if(this.Ukm&&this.Pki){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");
if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get Pki(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){w.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(m.a)(es,"ChromeExtensionHelper",null,[947]);var Lu=c(1410),tt=c(515),Hw=c(1369);
class ik{create(b){return new Hw.a(b)}}Object(m.a)(ik,"Factory",null,[648]);var $k=c(96);class cv{constructor(b,h,u){this.u6j=b;this.me=h;this.hXa=u}Wb(){this.hXa.gb(Oa.a.G4d,oc.a.application,this.G4d.bind(this),96);this.hXa.pa(Oa.a.Pjc,oc.a.view,this.YAo.bind(this));this.hXa.gb(Oa.a.eQi,oc.a.view,this.$Ao.bind(this),96)}G4d(b,h,u,y,P){if(1===u)return 32;b=Object.assign(new $f.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];u=Object.assign(new xi.a,{ControlList:[]});
u.ControlList.push(Object.assign(new Qe.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(u);Array.addRange(b.MenuSectionList,h);P.MenuItems=b;return 32}$Ao(b,h,u,y,P){if(1===u)return 32;b=uk.a.vfj();null==b&&8;b=this.me.WF(b);P[Qm.a.LabelText]=String.format(A.a.Cf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}YAo(b,h,u){b=uk.a.bGb(h);if(1===u||b)return b?8:32;u=new Map;u.set("Source","StyleContextMenuActor");u.set("Action","UpdateStyle");Ta.Health.instance.recordKpiUsage($k.a.Kia,
0,$k.a.eD,u);this.u6j.cBo(h)?Ab.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new Ya.a,{extendedProperties:h}),Ta.Health.instance.recordKpiFailure($k.a.Kia,"UpdateStyleFailed",!1,!0,h),Ab.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(m.a)(cv,"StyleContextMenuActor",null,[]);var dv=c(1007),Iw=c(1475),$x=c(476),lx=c(1703);
class Em extends lx.a{constructor(b,h,u,y,P,aa,ta=null,Pa=null){super(b,aa,ta,Pa);this._formatting=null;this.iJa=!1;this.Orb=r.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Ytb=0;this.Gyc=new ob.a;Ab.a(8128527,307,wg.OutlineElementReader.Oh(b));this.tL=h;this.tL.k_b(this);this.Vp=u;this.xn=y;this.hd=P;this.sYe=Pa;this.VGe=wj.ListReader.lj(this.Dc)}get paragraphEditor(){return null!=this.Tug?this.Tug:this.Tug=Ja.a.instance.resolve("Box4.IParagraphEditor")}get oCd(){return null}get e1b(){return this.VGe&&
!this.tL.jCa}get bAb(){return 0<this.Ytb}Cba(b,h){if(!this.O0.Yag(this.Dc,h,!0)){Ab.a(8701077,307,be.ParagraphReader.rh(this.Dc));var u=this.Dc.currentNode,y=nf.a.Dw(u);this.Orb&&this._formatting.WP&&(u=u.qa.last,this.iJa&&(u.formatting=this._formatting.WP.Xf(u),this.iJa=!1),b=this.O0.gpf(b,h),this.O0.tGa(this.Dc.currentNode,this._formatting.Nba,h));this.characterPropertiesEditor.replaceTextRange(y,b)}}iFa(){Ab.a(8701078,307,be.ParagraphReader.rh(this.Dc));const b=nf.a.Dw(this.Dc.currentNode);this.characterPropertiesEditor.Qfa(b,
h=>new $x.a(h))}Skb(){this.O0.npf(this.Dc)}dFa(){this.Orb&&(this.iJa=!0)}oQa(){Ab.a(8701079,307,be.ParagraphReader.rh(this.Dc))}nQa(){Ab.a(8701080,307,be.ParagraphReader.rh(this.Dc))}iG(b){this.tL.jCa||(this.Orb?(this.mVe(b),this._formatting.sge(this.Dc.currentNode),b&&"P"===b.g8.KPd&&this.sYe.Qha(this.Dc.currentNode,this._formatting.BFa),this.O0.tGa(this.Dc.currentNode,this._formatting.Nba,b)):this.Zqk(b))}hG(){this.tL.jCa||this.GHc()}tQa(){}x3a(){}lFa(){Ab.a(8701081,307,wg.OutlineElementReader.Oh(this.Dc)||
Jf.OutlineReader.Kw(this.Dc)||be.ParagraphReader.rh(this.Dc)&&this.tL.jCa);let b=!1;this.bAb||(b=this.e1b||!0);b||(this.nU+=1);this.Ytb++}jFa(){this.Ytb--;let b=!1;this.bAb||(b=this.e1b||!0,this.xn.lVi(this.Gyc));b||--this.nU}sQa(b){Ab.a(8701082,307,wg.OutlineElementReader.Oh(this.Dc)||Jf.OutlineReader.Kw(this.Dc)||be.ParagraphReader.rh(this.Dc)&&this.tL.jCa);Ab.a(8701083,307,!!b.listStyleType)}kFa(){Ab.a(8701084,307,wg.OutlineElementReader.Oh(this.Dc)||be.ParagraphReader.rh(this.Dc)&&this.tL.jCa);
this.tL.jCa||Ab.a(8701085,307,this.Dc.Lq(2))}Bba(b){this.tL.Bba(b)}yba(){this.tL.yba()}dge(b){this.Gyc.add(b)}Aba(b){this.tL.Aba(b)}zba(){this.tL.zba()}xba(b){this.tL.xba(b)}wba(){this.tL.wba()}Zqk(b){this.Yac(!1);(new yd.GraphIterator).ed(this.Dc);b=lx.a.ih.GN(this.Dc,this.yLc(b));Ab.a(8128534,307,b===this.Dc.currentNode);Ab.a(8128535,307,be.ParagraphReader.ic(b))}GHc(){Ab.a(8128536,307,be.ParagraphReader.rh(this.Dc));og.OutlineElementNavigator.$d(this.Dc)}reset(){this.Orb&&(super.reset(),this._formatting=
this.Xhf(!0))}mVe(b){this.Yac(!1);(new yd.GraphIterator).ed(this.Dc);b=lx.a.ih.GN(this.Dc,this.yLc(b));Ab.a(36577367,307,b===this.Dc.currentNode);Ab.a(36577368,307,be.ParagraphReader.ic(b));-1!==this._formatting.mt&&this.paragraphEditor.zD(b,this._formatting.mt);this._formatting.lineSpacing&&this.sYe.sC(b,this._formatting.lineSpacing);this._formatting.pJ&&this.sYe.Xae(b,this._formatting.pJ);this.iJa=!0;this._formatting.paragraph=b}static r3e(b,h){let u=0;switch(h){case 3:u=Xf.a.Xy(b);break;case 7:u=
Bf.a.jy(b,0);break;case 1:u=Xf.a.q_e(b);break;case 5:u=Xf.a.Xy(Xf.a.HQf(b));break;default:w.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return u}}Object(m.a)(Em,"TextOnlyBox4PasteSteward",lx.a,[]);class Cv{constructor(b,h,u,y){this.Mld=b;this.ZH=h;this.If=u;this.O0=y}create(b,h,u,y,P=null,aa=null,ta=null){return 1===b?new Em(h,y,this.Mld,this.ZH,this.If,P,aa,this.O0):new Iw.Box4PasteSteward(h,u,y,this.Mld,this.ZH,
this.If,P,aa,this.O0,ta)}}Object(m.a)(Cv,"Box4PasteStewardFactory",null,[596]);var Jw=c(196),aq=c(396),mq=c(1529);class Xv{constructor(b,h,u){this.wy=null;this.Ztb=0;this.kL=null;this.Dc=b;this.rk=u}k_b(b){this.wy=b}get jCa(){return 0<this.Ztb}Bba(b){Ab.a(7869459,307,!!this.wy);Ab.a(7869460,307,wg.OutlineElementReader.Oh(this.Dc)||Jf.OutlineReader.Kw(this.Dc));Ab.b(38563978,307,50,"Table pasting started");this.wy.Yac(!0);const h=new yd.GraphIterator;h.ed(this.Dc);var u=mq.a.E9l[b.styleId];u||(u=mq.a.DDh);
u=this.rk.exn(this.Dc,b.rowCount,b.tdb,u,b.tableLook,this.wy.yLc(b),b.Rgi);b.Y8f&&(Ab.b(573691298,3022,100,"Applying table border properties"),mq.a.jih(b.Y8f,this.Dc,!1,!0));b.vQd&&(Ab.b(573691299,3022,100,"Applying indentation properties"),mq.a.Jlk(this.Dc,b.vQd.spaceBefore,b.vQd.spaceAfter));b.yzd&&(Ab.b(573691328,3022,100,"Applying column widths"),mq.a.slk(b.yzd,this.Dc,Object(na.a)(aq.TableNode,u),b.b2a));this.wy.Zvd(h,!1);this.Ztb++;wj.ListReader.lj(h)&&this.wy.dge(h.currentNode);Ab.a(7869461,
307,xh.TableReader.isTable(this.Dc))}yba(){Ab.a(7869462,307,!!this.wy);Ab.a(7869463,307,pm.a.isTableRow(this.Dc));Ab.b(38563979,307,50,"Table pasting finished");this.$T&&this.Dc.ut(14)&&mq.a.j1i(this.Dc.Hn);og.OutlineElementNavigator.$d(this.Dc);this.Ztb--}Aba(b){Ab.a(7869464,307,!!this.wy);Ab.b(573691329,3022,100,"Table row pasting started");xh.TableReader.isTable(this.Dc)?wf.moveToFirstRow(this.Dc):pm.a.isTableRow(this.Dc)&&wf.moveToNextRow(this.Dc);b.height&&(Ab.b(573691330,3022,100,"Applying table row height"),
mq.a.Amk(this.Dc,b.height));Ab.a(7869465,307,pm.a.isTableRow(this.Dc))}zba(){Ab.a(7869466,307,!!this.wy);Ab.a(7869467,307,hi.TableCellReader.isTableCell(this.Dc));wf.returnToContainingRow(this.Dc)}xba(b){Ab.a(7869468,307,!!this.wy);Ab.a(7869469,307,!this.wy.nU);pm.a.isTableRow(this.Dc)?wf.moveToFirstColumn(this.Dc):hi.TableCellReader.isTableCell(this.Dc)?wf.moveToNextColumn(this.Dc):Ab.a(7869471,307,!1);if(this.Dc.currentNode){Ab.b(573691331,3022,100,"Table cell pasting started");var h=Object(na.a)(Jw.TableCellNode,
this.Dc.currentNode);Ab.a(50689760,307,!h&&16!==this.Dc.currentNode.type||!!h&&16===this.Dc.currentNode.type);if(h){var u=new yd.GraphIterator;u.ed(this.Dc);if(b.J9b)Ab.b(573691332,3022,100,"Processing skipped cell"),mq.a.dnn(u,b);else{if(1<b.colSpan||1<b.rowSpan){const y=wf.returnToContainingTable(u);if(!y)return;y.setValue(Lc.a.complexTable,!0);u.ed(this.Dc);Ab.b(573691333,3022,100,"Processing merged cell");mq.a.vmn(u,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}mq.a.Fmk(this.Dc,b.shadingColor);mq.a.vnk(this.Dc,
b.verticalAlignment);mq.a.glk(this.Dc,b.Gee);mq.a.jih(b.jia,this.Dc,!b.colSpan&&!b.rowSpan,!1);(new yd.GraphIterator).ed(this.Dc);wf.forEachCell(u,b.rowSpan,b.colSpan,(y,P,aa)=>{Ab.b(573691334,3022,100,"Setting ghost cell borders");mq.a.I5i(y,b.jia,P,aa,b.rowSpan,b.colSpan)});mq.a.xnk(this.Dc,b.width,b.b2a);Ab.a(7869472,307,Jf.OutlineReader.Kw(this.Dc))}}}}wba(){Ab.a(7869473,307,!!this.wy);Ab.a(7869474,307,wg.OutlineElementReader.Oh(this.Dc)||hi.TableCellReader.isTableCell(this.Dc));wf.returnToCell(this.Dc);
Ab.a(7869475,307,0>=this.wy.nU);this.wy.o0e()}get $T(){null==this.kL&&(r.AFrameworkApplication.Ce("he991617;3eed2178"),this.kL=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.kL}}Object(m.a)(Xv,"Box4TableSteward",null,[622,180]);class ut{constructor(b,h,u){this.wy=null;this.Ztb=0;this.Dc=b;this.rk=u}k_b(b){this.wy=b}get jCa(){return 0<this.Ztb}Bba(){this.jCa&&(Ab.a(8787101,307,be.ParagraphReader.rh(this.Dc)),
og.OutlineElementNavigator.$d(this.Dc));Ab.a(8701086,307,!!this.wy);Ab.a(8701087,307,wg.OutlineElementReader.Oh(this.Dc)||Jf.OutlineReader.Kw(this.Dc));this.Ztb++}yba(){Ab.a(8701088,307,!!this.wy);og.OutlineElementNavigator.$d(this.Dc);this.Ztb--;if(this.jCa){this.wy.Yac(!0);const b=ut.ih.GN(this.Dc);Ab.a(8787102,307,b===this.Dc.currentNode);Ab.a(8787103,307,be.ParagraphReader.rh(this.Dc))}}Aba(b){Ab.a(8701089,307,!!this.wy);this.wy.Yac(!0);const h=new yd.GraphIterator;h.ed(this.Dc);this.wy.Zvd(h,
!1);wj.ListReader.lj(h)&&this.wy.dge(h.currentNode);b=ut.ih.GN(this.Dc,this.wy.yLc(b));Ab.a(8701090,307,b===this.Dc.currentNode);Ab.a(8701091,307,be.ParagraphReader.rh(this.Dc))}zba(){Ab.a(8701120,307,!!this.wy);Ab.a(8701121,307,be.ParagraphReader.rh(this.Dc));og.OutlineElementNavigator.$d(this.Dc)}xba(){Ab.a(8701122,307,!!this.wy);Ab.a(8701123,307,be.ParagraphReader.rh(this.Dc));Ab.a(8701124,307,!this.wy.nU);var b=this.Dc.currentNode;be.ParagraphReader.textLength(b)&&(b=nf.a.Dw(b),this.wy.characterPropertiesEditor.replaceTextRange(b,
", "))}wba(){Ab.a(8701125,307,!!this.wy);Ab.a(8701126,307,be.ParagraphReader.rh(this.Dc));Ab.a(8701127,307,0>=this.wy.nU);this.wy.o0e()}static get ih(){return null!=ut.hug?ut.hug:ut.hug=Ja.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(m.a)(ut,"TextOnlyBox4TableSteward",null,[622,180]);class nu{constructor(b,h,u=!1,y=!1){this.ZH=b;this.Lz=h;this.vYj=u;this.DYj=y}create(b,h){return 1===b?new ut(h,this.ZH,this.Lz):new Xv(h,this.ZH,this.Lz,this.vYj,this.DYj)}}Object(m.a)(nu,"Box4TableStewardFactory",
null,[592]);class Jz{create(){return new Hi.a}}Object(m.a)(Jz,"Factory",null,[591]);class mx{constructor(b){this.ga=b}PVm(b){if(4===b)b=Oa.a.FEa;else if(2===b)b=Oa.a.Cha;else if(1===b)b=Oa.a.AOb;else if(3===b)b=Oa.a.PZa;else return;this.ga.processAction(b,2)}afb(){this.ga.processAction(Oa.a.afb,2)}}Object(m.a)(mx,"SelectionCommands",null,[590]);var vt=c(263),wt=c(1075),xf=c(149),nx=c(645);class xt{constructor(){this.PSc=!1;this.yFo=r.AFrameworkApplication.K.lb("WordEditorVisiFontFileUri");this.AFo=
r.AFrameworkApplication.K.lb("WordEditorVisiRtlFontFileUri");this.zFo=r.AFrameworkApplication.K.lb("WordEditorVisiPilcrowFontFileUri");this.vFo=r.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnFontFileUri");this.xFo=r.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnRtlFontFileUri")}uno(){this.PSc=!this.PSc}tno(b){this.uno();let h=b.getElementsByClassName("VisiFontStyle")[0],u=b.getElementsByClassName("VisiFontRtlStyle")[0],y=b.getElementsByClassName("VisiFontPilcrowStyle")[0],P=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],
aa=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",Hc.a.oy(h,""),b.appendChild(h));u||(u=document.createElement("Style"),u.className="VisiFontRtlStyle",Hc.a.oy(u,""),b.appendChild(u));y||(y=document.createElement("Style"),y.className="VisiFontPilcrowStyle",Hc.a.oy(y,""),b.appendChild(y));P||(P=document.createElement("Style"),P.className="VisiFontCarriageReturnStyle",Hc.a.oy(P,""),b.appendChild(P));aa||(aa=document.createElement("Style"),
aa.className="VisiFontCarriageReturnRtlStyle",Hc.a.oy(aa,""),b.appendChild(aa));if(this.PSc)return w.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.rBc(h)&&this.rBc(u)&&this.rBc(y)&&this.rBc(P)&&this.rBc(aa);w.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.k0c(h)&&this.k0c(u)&&this.k0c(y)&&this.k0c(P)&&this.k0c(aa)}rBc(b){return""===Hc.a.Yz(b)?("VisiFontStyle"===b.className?Hc.a.oy(b,this.SKc("WordVisi_MSFontService",this.yFo)):"VisiFontRtlStyle"===
b.className?Hc.a.oy(b,this.SKc("WordVisiRtl_MSFontService",this.AFo)):"VisiFontPilcrowStyle"===b.className?Hc.a.oy(b,this.SKc("WordVisiPilcrow_MSFontService",this.zFo)):"VisiFontCarriageReturnStyle"===b.className?Hc.a.oy(b,this.SKc("WordVisiCarriageReturn_MSFontService",this.vFo)):"VisiFontCarriageReturnRtlStyle"===b.className&&Hc.a.oy(b,this.SKc("WordVisiCarriageReturnRtl_MSFontService",this.xFo)),!0):!1}k0c(b){return""!==Hc.a.Yz(b)?(Hc.a.oy(b,""),!0):!1}SKc(b,h){return"@font-face { font-family: "+
b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(m.a)(xt,"VisiMarkersOperation",null,[588]);var Ot=c(483),ir=c(399);class Pk extends Ot.a{constructor(b,h){super(b,h);this.Hxe=-1;this.Lrb=0;this.Cue=null;this.sOg=!1;this.Nve=[];this.Ghd=!1;this.nXg=!0;this.nFe=this.xfd=null;this.preventDismissOnScroll=this.X4d=this.sdc=!1;this.A6=null;this.qsd=!1;this.FNc=!0;this.Ku=!1;this.EQg=r.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Pk.f2g||
(r.AFrameworkApplication.ya.pa(Wa.a.showFloatie,le.a.frame,De.ActionManager.Mf),Pk.f2g=!0)}get TOh(){return this.wN}set TOh(b){this.wN=b}get ojj(){return this.qsd}get IOc(){return this.sOg}set IOc(b){this.sOg=b;this.Lrb=0}get mA(){return!0}get cssClass(){return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.I7?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Ku}URa(){for(let b of this.children)if(b.URa())return!0;return!1}get y8(){return 9}Qf(b){this.Nve[this.Nve.length]=
b;super.Qf(b)}sm(){super.sm();Oe.c(this.Nc)&&this.VB();this.Nc=kg.a.oRa(this.Nc);this.pW(this.Nc);this.dirty=!1}Pbc(b){3===b.og||this.X4d||this.Ew(b);return!1}Sbc(){return!1}Qbc(b){3!==b.og&&this.FNc&&!this.sdc&&this.szo(b);return!1}Rbc(){return!1}Nbc(b){3===b.og&&this.Ew(b);return!1}Obc(b){void 0!==this.A6&&null!==this.A6||this.preventDismissOnScroll||this.Ew(b);return!1}fC(){this.Daf();return!1}n1d(){this.IOc=!0}szo(b){if(b=Gc.a.v2b(b.clientPoint,this.Cue)){if(this.IOc){if(!this.Lrb||b<this.Lrb)this.Lrb=
b;b-=this.Lrb}b-=this.Hxe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.Ew():ba.a.setOpacity(this.Nc,Math.max(h/255,0))}else this.IOc=!1,this.Lrb=0,ba.a.setOpacity(this.Nc,1)}Nxo(b){let h=null;void 0!==this.xfd&&null!==this.xfd&&(h=this.xfd(b));b=null;for(const u of this.Nve){let y=!this.ojj&&u.Uoi;if(!y&&void 0!==h&&null!==h)for(let P=0;P<h.length;P++)if(u.id===h[P]){y=!0;break}u.Nc.style.display=y?"none":"";u.s2b=!y;y||(b=u)}b&&(b.s2b=!1)}nXh(){const b=this.Nc.style.top,h=this.Nc.style.left;this.Nc.style.top=
"0px";this.Nc.style.left="0px";const u=this.rCb();this.Nc.style.top=b;this.Nc.style.left=h;return u}rCb(){const b=this.Nc.style.visibility,h=this.Nc.style.display;this.Nc.style.visibility="hidden";this.Nc.style.display="";const u=Je.a.getElementBounds(this.Nc);this.Nc.style.display=h;this.Nc.style.visibility=b;return u}LSi(b){3===b||this.Zfe?(Sys.UI.DomElement.addCssClass(this.Nc,ir.a.nob),this.qsd=!0):(Sys.UI.DomElement.removeCssClass(this.Nc,ir.a.nob),this.qsd=!1);this.Nxo(b)}B5a(b,h,u,y=!1){this.isVisible||
(this.A6||!this.nXg&&this.preventDismissOnScroll||(this.nXg=!1,Je.a.gZd("ShowLegacyFloatie",""),r.AFrameworkApplication.ya.processAction(Wa.a.showFloatie,2)),this.LSi(u),this.FNc=!0,this.Lrb=0,this.IOc=!1,!this.EQg||void 0!==this.A6&&null!==this.A6?(this.Ghd=!1,this.uea(this,!1)):(this.Ghd=!0,this.Yqk(this)),h=y?b:this.Ein(b,h),this.Nc.style.top=h.y.toString()+"px",this.Nc.style.left=h.x.toString()+"px",this.Yt(),this.Cue=this.rCb(),this.Hxe=Gc.a.v2b(b,this.Cue),ba.a.setOpacity(this.Nc,1),this.Nc.style.zIndex=
String(r.AFrameworkApplication.ta.ysa),this.Nc.style.display="",this.Ku=!0)}Ein(b,h){const u=this.ojj?30:17,y=this.nXh(),P=Hc.a.wDb(),aa=Hc.a.c3();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=y.height:3===h?(b.y-=y.height,b.x-=y.width):2===h&&(b.x-=y.width);b.x+y.width>P&&(b.x=Math.floor(P-y.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-u:b.y+u;0>b.y&&(b.y=0);b.y+y.height>aa&&(b.y=aa-y.height);return b}Fin(b,h){const u=b.Ixi;if(u){this.LSi(h);var y=this.nXh();this.A6=b;b=u.Deg-u.jJc>y.width;var P=u.jJc+u.Rdf>
y.width,aa=u.R3b>y.height+17,ta=u.Isj-(u.R3b+u.Ndf)>y.height+17;y=new Sys.UI.Point(u.jJc,u.R3b);P||b||(P=!0,y.x=u.Deg);b=u.qjb?u.TAf?ta?P?2:0:P?3:1:aa?P?3:1:P?2:0:u.TAf?ta?b?0:2:b?1:3:aa?b?1:3:b?0:2;if(3===b||2===b)y.x=u.jJc+u.Rdf;if(2===b||0===b)y.y=u.R3b+u.Ndf;this.B5a(y,b,h);this.FNc=!1;h=this.A6.TRe.Nc;void 0!==h&&null!==h&&(h.style.zIndex=String(r.AFrameworkApplication.ta.ysa))}}M2(){let b=super.M2();this.Ew()&&(b=!0);return b}Ew(b=null){if(!this.isVisible)return!1;void 0!==this.jAc&&null!==
this.jAc&&this.jAc.Mta(null);void 0!==this.A6&&null!==this.A6&&this.A6.P$();this.P$();this.EQg&&this.Ghd?this.Ial(this):this.jaa(this,!1);this.Ghd=!1;this.Hxe=-1;this.A6=null;this.Nc.style.display="none";this.Ku=!1;this.nFe&&this.nFe(b);return!0}Daf(){void 0!==this.A6&&null!==this.A6&&(this.A6.EXa=null,this.A6.P$(),this.A6=null,this.xZd.style.zIndex=String(r.AFrameworkApplication.ta.RAa),this.Nc.style.zIndex=String(r.AFrameworkApplication.ta.ysa))}Bzn(b){this.xfd=b}mAn(b){this.nFe=b}set mA(b){super.mA=
b}}Pk.f2g=!1;Object(m.a)(Pk,"Floatie",Ot.a,[602,396,397]);class Gq{constructor(b,h){this.kv=this.fJa=null;this.evi=b;this.j0i=h}get VOh(){return this.fJa}q3n(b){this.fJa=b}rCb(){return this.kv.rCb()}c_(){return this.kv?this.kv.isVisible:!1}hlh(b){this.q3n(b)}showFloatie(b,h){this.B5a(h.location,h.ox,h.isRtl)}B5a(b,h,u){u=u?this.j0i:this.evi;this.jFd();this.kv&&this.kv.B5a(b,u,h)}Ew(){this.kv&&this.kv.Ew()}jFd(){this.fJa&&!this.kv&&(this.kv=Object(na.a)(Pk,this.fJa()))}YFd(){}}Object(m.a)(Gq,"AFloatieManager",
null,[619]);class Nm extends Gq{constructor(){super(1,3);this.whj=!1;this.PEh=""}B5a(b,h,u){u=u?this.j0i:this.evi;this.jFd();this.kv&&(this.kv.isVisible&&this.kv.Ew(),this.whj||this.kv.Nl(),this.kv.B5a(b,u,h,!0))}jFd(){this.VOh&&!this.kv&&(this.kv=this.fJa())}YFd(){if(this.kv&&this.kv.isVisible){const b=Object(na.a)(vm.Control,this.kv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.Fw(b.ggb(),1,null)}}l3f(b){this.PEh=b}GGn(b){b=b.Uhf("Menu16",null);fh.a("renderIcon")&&b&&appChrome.api.renderIcon(Nm.xJj,
b.firstElementChild)}Ojc(b,h,u){if(this.kv){const y=this.kv.controls[this.PEh];y&&(Nm.bQg||(this.GGn(y),Nm.bQg=!0),y.Qd[pj.a.labelText]=b,y.Qd[pj.a.alt]=h,u&&y.behavior.Nl())}}}Nm.bQg=!1;Nm.xJj="Designer_20";Object(m.a)(Nm,"PasteFloatieManager",Gq,[]);var Sn=c(1014);class Qr{constructor(){this.Md=null}get Cw(){return null}getTitle(){return null}PVh(){return null}reset(b){this.Md=b.node}jHa(b){b=En.d(this.Md,b);let h=null;if(!b||b.li!==this.li)return{returnValue:!1,jF:h};h=Object.assign(new Sn.a,{kG:this.key,
contentObject:b,title:this.getTitle(b),description:this.PVh(b)});return{returnValue:!0,jF:h}}}Object(m.a)(Qr,"BlobDetailsProvider",null,[245,246]);class jo extends Qr{constructor(){super()}get key(){return"EQUATION"}get li(){return 11}get Cw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(jo,"EquationDetailsProvider",Qr,[]);class ev{constructor(){this.ZNg=null}get key(){return"LINK"}get Cw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.ZNg=yi.HyperlinkReader.fLc(b.node)}jHa(b){let h=
null;for(const u of this.ZNg)if(u.cpBegin<=b&&b<u.cpEnd)return h=Object.assign(new Sn.a,{kG:this.key,contentObject:u.hyperlink}),{returnValue:!0,jF:h};return{returnValue:!1,jF:h}}}Object(m.a)(ev,"HyperlinkDetailsProvider",null,[245,246]);var fs=c(1348),gh=c(896);class Kw{constructor(){this.JSg=!1}get key(){return"IFRAMENODE"}get Cw(){return this.JSg?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}sjc(b){let h=null;b=b?be.ParagraphReader.RNa(b.currentNode):null;
if(!b)return{returnValue:!1,ola:h};h=Object.assign(new fs.a,{kG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,ola:h}}hCb(b,h){b=b?Object(na.a)(gh.a,b.contentObject):null;h=h?Object(na.a)(gh.a,h.contentObject):null;let u="";h&&b.id===h.id||(this.JSg=b.l2a,u=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Cw,this.Cw));return u}}Object(m.a)(Kw,"IFrameDetailsProvider",null,[621,246]);class NA extends Qr{constructor(){super()}get key(){return"IMAGE"}get li(){return 5}get Cw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Jd.ImageReader.WW(b.properties)}PVh(b){return Jd.ImageReader.TNa(b.properties)}}
Object(m.a)(NA,"ImageDetailsProvider",Qr,[]);class DB{get key(){return"IMAGENODE"}get Cw(){return Box4Intl.Box4Strings.l_ImageContentTitle}sjc(b){let h=null;if(!b||!Jd.ImageReader.Wu(b.currentNode))return{returnValue:!1,ola:h};h=Object.assign(new fs.a,{kG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,ola:h}}hCb(b,h){b=b.contentObject;const u=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let y="";h&&b.id===h.contentObject.id||(y=String.format(u,Jd.ImageReader.WW(b.properties),
Box4Intl.Box4Strings.l_ImageContentTitle));return y}}Object(m.a)(DB,"ImageNodeDetailsProvider",null,[621,246]);let gs,hs;class yt{constructor(b,h){this.iJg=null;this.kn=h;this.eIe=b;this.key=yt.keys.J(b);this.Cw=yt.bOk.J(b)}reset(b){this.iJg=this.kn.Y2(b.node)}jHa(b){var h=yt.pkl(this.iJg||[],u=>this.tmm(b,u));h=this.gSk(h);return{returnValue:!!h,jF:h}}tmm(b,h){return h.begin<=b&&b<h.end&&(!h.errorDetails||this.eIe===h.errorDetails.proofingType)}gSk(b){return b?Object.assign(new Sn.a,{kG:this.key,
contentObject:b.errorDetails,description:this.cgb()}):null}cgb(){return r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static pkl(b,h){for(const u of b)if(h(u))return u;return null}}yt.keys=(hs=new La.a,hs.add(1,"SPELLINGERROR"),hs.add(2,"GRAMMATICALERROR"),hs.add(3,"ADVANCEDERROR"),hs);yt.bOk=(gs=new La.a,gs.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),gs.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),
gs.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),gs);Object(m.a)(yt,"ProofingDetailsProvider",null,[245,246]);class Ch{constructor(){this.tableNode=null;this.wzd=this.B9d=this.columns=this.rows=0}}Object(m.a)(Ch,"TableInfo",null,[]);class Kz{get key(){return"TABLE"}get Cw(){return Box4Intl.Box4Strings.l_TableContentTitle}sjc(b){var h=null;if(!hi.TableCellReader.isTableCell(b))return{returnValue:!1,ola:h};h=new yd.GraphIterator;h.ed(b);b=new Ch;b.B9d=pm.a.Ar(h)+1;b.wzd=dm.a(h)+1;
wf.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=xh.TableReader.Wg(b.tableNode);b.rows=xh.TableReader.$f(b.tableNode);h=Object.assign(new fs.a,{kG:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,ola:h}}hCb(b,h){b=b.contentObject;const u=new Ah.a;h||u.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.wzd===b.wzd||u.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.wzd));h&&h.contentObject.B9d===
b.B9d||u.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.B9d));return u.toArray().join(" ")}}Object(m.a)(Kz,"TableDetailsProvider",null,[621,246]);class Br{constructor(b,h){this.kJa=b;this.kn=h}hWf(){this.kJa.execute(b=>{b.a4(new ev);b.a4(new yt(1,this.kn));b.a4(new yt(2,this.kn));b.a4(new yt(3,this.kn));b.a4(new jo);b.a4(new NA);b.jec(new Kz);b.jec(new DB);b.jec(new Kw)})}}Object(m.a)(Br,"AccessibilityActor",null,[]);class Lz{constructor(b,h,u){this.wan=(y,P,aa)=>{if(1===
aa)return 32;this.ZEj().P5f();return 32};this.hXa=b;this.ZEj=u}Wb(){this.hXa.gb(Oa.a.lIi,oc.a.view,this.wan,1028)}}Object(m.a)(Lz,"AutoCorrectActor",null,[]);var Pt=c(1881);class Lw{constructor(){this.cZd=!0}rwa(){}A3a(){}k_b(){}HMf(){}rae(){}get adc(){return!1}get mkb(){return 0}get exi(){return!1}get WS(){return Ua.a.nil}}Object(m.a)(Lw,"TextOnlyBox4ImageSteward",null,[618]);class Mz{constructor(b,h,u,y,P,aa,ta=!1,Pa=!1){this.Gj=b;this.Gb=h;this.Yl=u;this.Drc=y;this.TY=P;this.RGe=ta;this.LCe=Pa;
this.Wc=aa}create(b,h,u,y){return 1===b?new Lw:new Pt.a(h,this.Gj,this.Gb,this.Yl,this.Wc,this.Drc,this.TY,this.RGe,this.LCe,u,y)}}Object(m.a)(Mz,"Box4ImageStewardFactory",null,[587]);var ko=c(42);class Qy{constructor(b){this.lUd=b}dtm(b){if(!b||!b.SA||1>b.SA.count)return!1;const h=[ko.a.VBh,ko.a.UBh];return!!this.SId(b.SA,1,u=>this.vAd(u,h))}Aii(b){return!b||!b.SA||1>b.SA.count?!1:!!this.SId(b.SA,1,h=>this.vAd(h,[ko.a.KF]))}oqm(b){return!b||!b.SA||1>b.SA.count?!1:!!this.SId(b.SA,2,h=>this.vAd(h,
[ko.a.qWd]))}rh(b){return!b||!b.SA||1>b.SA.count?!1:!!this.SId(b.SA,1,h=>this.vAd(h,[ko.a.X3]))}eTd(b){if(!b||!b.SA)return!1;b=b.SA;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).mpk)return!1;return!0}jdl(b,h){return this.Aii(h)||this.oqm(h)?"":b}SId(b,h,u){if(b&&0<b.count)for(let y=b.count-1;0<=y;--y){if(u(b.J(y)))return b.J(y);if(b.count-y>=h)break}return null}vAd(b,h){b=b&&b.hbi?b.hbi.split(" "):null;if(!b)return!1;for(const u of h)if(0<=Array.indexOf(b,u))return!0;return!1}}Object(m.a)(Qy,"Box4PasteStewardUtils",
null,[586]);var ou=c(729);class Ry{constructor(){this.msi={};this.vCd=-1}}Object(m.a)(Ry,"LevelLists",null,[]);class Rr{constructor(b,h,u){this.c9=this.level=0;this.nMh=null;this.Ucc=!1;this.level=b;this.ykc=h;this.QIi=u}}Object(m.a)(Rr,"ListItemMetadata",null,[]);class an{constructor(){this.c9=0;this.tagName="UL";this.VIc=null;this.ignore=!1;this.bWc=0}}Object(m.a)(an,"ListMetadata",null,[]);class Fz{constructor(b){this.nodes=b;this.I2=0;this.lists={};this.Sna=[];this.A$b=null;this.dCa=[];this.dCa[0]=
new Ry}}Object(m.a)(Fz,"WordConverterArguments",null,[]);var Mq=c(1499);class bn{constructor(b=null){this.Akd=1;this.eW=b||Mq.a.iof("")}get Hc(){return this.eW}process(b,h){b&&b.querySelectorAll&&(b=b.querySelectorAll("p"))&&0<b.length&&(b=new ou.a(h,Object(v.a)(this,this.zSf,"processNodesDiscovery"),new Fz(b)),b.il("Word Converter Operation"),b.wg=!h||h.wg,b.run())}zSf(b,h){const u=h.nodes[h.I2];var y=bn.Zjf(u);if(y){let P=h.dCa[y.level-1];P||(P=new Ry,h.dCa[y.level-1]=P);h.A$b&&bn.dMc(u)!==h.A$b&&
bn.$Jn(h);let aa=P.msi[y.ykc];if(!aa)aa=new an,aa.c9=this.Akd++,aa.VIc=bn.Bif(u,5),aa.ignore=!aa.VIc||!aa.VIc.length,aa.tagName=bn.SJd(aa.VIc),P.msi[y.ykc]=aa,h.lists[aa.c9.toString()]=aa;else if(!aa.ignore&&1===aa.bWc){const ta=bn.Bif(u,5);aa.tagName=aa.VIc===ta?"UL":"OL"}y.c9=aa.c9;aa.ignore||"OL"===aa.tagName&&0<aa.bWc&&P.vCd!==y.c9?(aa.ignore=!0,h.dCa[0].vCd=-1,h.dCa=h.dCa.slice(0,1)):(h.dCa.length>y.level&&(h.dCa=h.dCa.slice(0,y.level)),P.vCd=y.c9,h.Sna[h.Sna.length]=y,aa.bWc++);h.A$b=u}else if((y=
h.A$b)&&bn.dMc(u)===y&&u.tagName===y.tagName&&u.className===y.className){y.appendChild(y.ownerDocument.createElement("BR"));for(y.appendChild(y.ownerDocument.createElement("BR"));u.firstChild;)y.appendChild(u.firstChild);u.parentNode.removeChild(u)}h.I2++;if(h.nodes.length<=h.I2){if(!h.Sna.length)return!1;h.I2=0;b.Qh(Object(v.a)(this,this.ySf,"processNodeConvert"))}return!0}ySf(b,h){var u=h.Sna[h.I2];b=u.QIi;const y=h.lists[u.c9.toString()];if(!y.ignore&&(u=bn.zMl(b,u,y))){bn.qDc(b,5);const P=b.ownerDocument.createElement("LI");
for(;b.firstChild;)P.appendChild(b.firstChild);u.appendChild(P);b.parentNode.removeChild(b);"UL"===y.tagName?this.Hc.b++:this.Hc.c++}h.I2++;return h.I2<h.Sna.length}static zMl(b,h,u){let y=bn.xSi(b,h.level,u);const P=Bh.a.Db(y,"UniqueListId");if(P&&P!==h.c9||!P&&y.firstChild)b=b.ownerDocument.createElement(u.tagName),y.parentNode.insertBefore(b,y.nextSibling),y=b;Bh.a.rl(y,"UniqueListId",h.c9);return bn.l3e(y,u)}static l3e(b,h){if(h.tagName!==b.tagName){h=b.ownerDocument.createElement(h.tagName);
for(Bh.a.rl(h,"UniqueListId",Bh.a.Db(b,"UniqueListId"));b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static xSi(b,h,u){let y=null,P;1===h?P=bn.dMc(b):(y=bn.xSi(b,h-1,null),P=y.lastChild);if(P&&1===P.nodeType){const aa=P.tagName.toUpperCase();if("UL"===aa||"OL"===aa)return P}u=b.ownerDocument.createElement(u?u.tagName:"UL");1===h?b.parentNode.insertBefore(u,b):y.appendChild(u);return u}static qDc(b,h){for(let u=0;u<b.childNodes.length;u++){const y=
b.childNodes[u];1===y.nodeType&&1<h&&bn.qDc(y,h-1);if(bn.hvf(y)||bn.SQc(y))b.removeChild(y),u--}}static Zjf(b){if(1===b.nodeType){const h=bn.T5b(b,"mso-list");if(h&&0<h.length)try{const u=h.split(" ");if(3===u.length){const y=Number.parseInvariant(u[1].substr(5));return new Rr(y,h,b)}}catch(u){}}return null}static SJd(b){return"o"!==b&&"\u00b7"!==b&&"\u00a7"!==b&&"-"!==b?"OL":"UL"}static Bif(b,h){let u=null;for(let y=0;!u&&y<b.childNodes.length;y++){const P=b.childNodes[y];bn.SQc(P)?(u="string"===
typeof P.innerText?P.innerText.trim():P.textContent.trim(),u.length||(u="o")):1===P.nodeType&&1<h&&(u=bn.Bif(P,h-1))}return u}static SQc(b){return 1===b.nodeType&&(b=bn.T5b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static hvf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static T5b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let u=0;u<b.length;u++){const y=b[u].split(":");if(2===y.length&&y[0].trim()===
h)return y[1].trim()}}return null}static dMc(b){do b=b.previousSibling;while(b&&bn.vQc(b));return b}static vQc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(bn.oCe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:bn.vQc(b.firstChild):!0}static $Jn(b){for(let h=0;h<b.dCa.length;h++){const u=b.dCa[h];u&&(u.vCd=-1)}}}bn.oCe=RegExp("[\n|\r]","gi");Object(m.a)(bn,"WordConverter",null,[181]);class LA{constructor(){this.c9=0;this.U$b=Array(9)}}
Object(m.a)(LA,"FullListMetadata",null,[]);var rs=c(1532);class Jy{constructor(){this.level=0;this.tagName="UL";this.Vjb=null;this.ignore=!1;this.bWc=0;this.listStyle="BulletListStyle1";this.Sna=new rs.a;this.font=this.levelText=""}}Object(m.a)(Jy,"ListLevelMetadata",null,[]);var kx=c(527);class Ol{}Ol.f_k="data-ccp-timestamp";Ol.HCd="data-clipservice-ccpid";Ol.j_k="data-shapeids";Ol.C0l="docs-internal-guid-";Ol.man="SCXO";Ol.djn="SCXP";Ol.AHo="SCXW";Ol.CWm="MsoListParagraphCxSpFirst";Ol.DWm="MsoListParagraphCxSpLast";
Ol.I6e="data-pkey";Ol.J6e="data-clipservice-type";Ol.G6e="data-clipservice-count";Ol.H6e="data-clipservice-dc";Ol.RFc="data-clipservice-client";Ol.K6e="data-clipservice-version";Object(m.a)(Ol,"HtmlContentMetadataConstants",null,[]);class Gz{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(m.a)(Gz,"AbsolutePosition",null,[]);var uq=c(850);class br{constructor(b,h,u="",y=0){this.Uw=!1;this.ONg=this.PNg=null;let P=!1;br.Dpm(b)&&(P=!0,this.PNg=b);br.Tpm(h)&&(this.ONg=h);this.SOj=u;this.JEj=
y;this.Uw=P&&this.KPd?!0:!1}get isValid(){return this.Uw}get kbi(){return this.PNg}get KPd(){return this.ONg}get hbi(){return this.SOj}get mpk(){return this.JEj}static Dpm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static Tpm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(m.a)(br,"HtmlElementInfo",null,[]);class Qg{constructor(b){this.next=null;this.data=b}}Object(m.a)(Qg,"StackNode",null,[]);class lo{constructor(){this.Aq=null;this.gj=0}get count(){return this.gj}get isEmpty(){return!this.count||
!this.Aq}push(b){b=new Qg(b);b.next=this.Aq;this.Aq=b;this.gj=this.count+1}iz(){return this.count&&this.Aq?this.Aq.data:null}pop(){if(!this.count||!this.Aq)return null;const b=this.Aq;this.Aq=b.next;this.gj=this.count-1;return b.data}clear(){this.Aq=null;this.gj=0}toArray(){const b=Array(this.count);let h=this.Aq;for(let u=this.count-1;0<=u&&h;u--)b[u]=h.data,h=h.next;return b}}Object(m.a)(lo,"Stack",null,[]);class Tj{constructor(b){this.pqc=this.dld=null;this.$cd=!1;this.Xi=b}get oCd(){return this.pqc.iz()}reset(){this.Xi.reset();
this.dld=new lo;this.pqc=new lo;this.pqc.push(this.Xi.$Fc);this.$cd=!1}e0d(){this.$cd=!1}mJ(b){this.$cd||(this.dld.push(null),this.$cd=!0);this.dld.push(b)}onClose(){for(;;){const b=this.dld.pop();if(!b)break;b()}}G5i(){return!1}uZm(){this.Tu(()=>!0)}Tu(b){const h=this.oCd.clone();return b(h)?(this.pqc.push(h),this.Xi.dFa(h),this.mJ(Object(v.a)(this,this.b4m,"onFormattingEnd")),!0):!1}Sof(b){return b.style?this.Tu(h=>this.G5i(h,b))?1:2:2}b4m(){this.pqc.pop();this.Xi.dFa(this.oCd)}Cba(){}X_d(){return 2}LJf(){return 2}MJf(){return 2}RJf(){return 2}gKf(){return 3}iKf(){}d0d(){return 2}jKf(){}kKf(){}lKf(){return 2}g0d(){return 2}h0d(){return 2}zKf(){return 2}i0d(){}BKf(){return 2}j0d(){return 2}k0d(){return 2}n0d(){return 2}o0d(){return 2}MKf(){}NKf(){return 2}u0d(){return 2}v0d(){return 2}z0d(){return 2}A0d(){return 2}C0d(){return 2}D0d(){return 2}G0d(){return 2}I0d(){return 2}mLf(){return 2}P0d(){return 2}tLf(){return 2}vLf(){}wLf(){return 2}S0d(){return 2}T0d(){return 2}U0d(){return 2}V0d(){return 2}W0d(){return 2}X0d(){return 2}BLf(){return 3}Y0d(){}HLf(){return 2}Z0d(){return 2}ILf(){return 3}b1d(){}OLf(){}c1d(){return 2}ULf(){return 3}f1d(){return 2}h1d(){return 2}j1d(){return 2}k1d(){return 2}gMf(){}jMf(){return 3}l1d(){return 2}onMenuOpen(){return 2}nMf(){}vMf(){return 2}wMf(){return 2}xMf(){return 3}x1d(){return 2}zMf(){return 2}y1d(){return 2}C1d(){return 2}GMf(){}J1d(){return 2}QMf(){return 2}R1d(){return 2}S1d(){return 2}jNf(){return 3}pNf(){return 2}$1d(){return 2}a2d(){return 2}c2d(){return 2}d2d(){return 2}tNf(){return 3}e2d(){return 2}g2d(){return 2}i2d(){return 2}xNf(){return 2}hXc(){return 2}zNf(){return 2}ANf(){return 2}l2d(){return 2}BNf(){return 2}ENf(){return 3}p2d(){return 2}q2d(){return 2}r2d(){return 2}s2d(){return 2}v2d(){return 2}static Ffa(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(A.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static fUl(b){if(!b||""===b)return-1;const h=A.a.jh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(A.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(A.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static $1h(b){return b&&""!==b?Tj.Ffa(b):null}static vD(b){let h=null,u=null,y=null,P=null;b&&b.tf&&(h=Tj.aO(b.tf,"id"),u=Tj.aO(b.tf,"lang"),y=b.tf.tagName,
b.dlk&&(P=Object.assign(new Gz,{x:Tj.Ffa(b.tf.style.left),y:Tj.Ffa(b.tf.style.top),left:Tj.$1h(b.tf.style.left),top:Tj.$1h(b.tf.style.top)})),void 0===h&&(h=""),void 0===u&&(u=""));return new uq.a(new br(h,y),b.SA,null,u,P)}static aO(b,h){return b[h]}}Object(m.a)(Tj,"AHtmlTranslator",null,[237]);class qp extends uq.a{constructor(b,h,u,y=0,P=0,aa=null){super(aa?aa.g8:null,aa?aa.SA:null,aa?aa.roa:null,aa?aa.cultureName:null,aa?aa.PAa:null);this.width=y;this.height=P}}Object(m.a)(qp,"AugmentationSemanticArgs",
uq.a,[]);class Nq{constructor(b,h,u,y,P,aa,ta){this.ccpId=b;this.pKey=h;this.type=u;this.count=y;this.dc=P;this.client=aa;this.version=ta}}Object(m.a)(Nq,"ClipServiceArgs",null,[]);var Gu;(Gu||(Gu={})).Chart="chart";Object(m.b)("ClipServiceDataType",Gu);var pt;(pt||(pt={})).ExcelOnline="XLO";Object(m.b)("ClipServiceClientApp",pt);class Qi{constructor(){this.stop=this.color=null}}Object(m.a)(Qi,"ColorStopPair",null,[]);var Hk=c(1887);class uv{constructor(){this.direction=null;this.KDc=new rs.a}c$h(){return!!this.direction&&
0<this.direction.length}}Object(m.a)(uv,"LinearGradient",null,[]);class Fs{constructor(){this.n8b=!1}}Object(m.a)(Fs,"HtmlTranslatorContext",null,[]);class Ir{constructor(b=!1,h=!1,u=!1,y=!1,P=!1,aa=!0,ta=!1,Pa=!0,vb=!0,Kb=!0,Sb=!1,Yb=!1,Ac=!1,Sc=!1,nd=!1,Ad=!1,he=!1,ce=!1,Nd=!1,re=null,Xd=null,vg=null,Vf=null,kj=null,zm=null,rm=null,os=null,Us=null){this.n8b=!1;this.AYj=b;this.wYj=h;this.CYj=u;this.M1j=y;this.K1j=P;this.F1j=aa;this.G1j=ta;this.I1j=Pa;this.J1j=vb;this.H1j=Kb;this.X1j=Sb;this.t2j=
Yb;this.W1j=Ac;this.R3j=Sc;this.Q1j=nd;this.RPj=Ad;this.k2j=he;this.v2j=ce;this.AGj=Nd;this.O1j=re;this.V1j=Xd;this.L1j=kj;this.T1j=vg;this.N1j=Vf;this.S1j=zm;this.U1j=rm;this.P1j=os;this.R1j=Us}get slb(){return this.AYj}get SKi(){return this.wYj}get yfn(){return this.CYj}get i$i(){return this.M1j}get h$i(){return this.K1j}get Z5n(){return this.F1j}get $5n(){return this.G1j}get b6n(){return this.I1j}get c6n(){return this.J1j}get a6n(){return this.H1j}get inb(){return this.Q1j}get ffm(){return this.RPj}get Q$i(){return this.k2j}get uaj(){return this.v2j}get iBk(){return this.AGj}get m$i(){return this.X1j}get b8n(){return this.t2j}get l6n(){return this.W1j}get Aho(){return this.R3j}get j$i(){return this.O1j||
Object(v.a)(this,this.$ec,"returnFalse")}get k6n(){return this.V1j||Object(v.a)(this,this.$ec,"returnFalse")}get j6n(){return this.T1j||Object(v.a)(this,this.YZf,"returnTrue")}get e6n(){return this.N1j||Object(v.a)(this,this.YZf,"returnTrue")}get d6n(){return this.L1j||Object(v.a)(this,this.$ec,"returnFalse")}get i6n(){return this.S1j||Object(v.a)(this,this.YZf,"returnTrue")}get l$i(){return this.U1j||Object(v.a)(this,this.$ec,"returnFalse")}get f6n(){return this.P1j||Object(v.a)(this,this.$ec,"returnFalse")}get h6n(){return this.R1j||
Object(v.a)(this,this.$ec,"returnFalse")}YZf(){return!0}$ec(){return!1}}Object(m.a)(Ir,"HtmlTranslatorSettings",null,[236]);var uC=c(1785);class My{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(m.a)(My,"IndentationProperties",null,[]);var Kt=c(1354);class bq extends uq.a{constructor(b,h,u,y,P=null,aa=0,ta=null,Pa=null,vb=!1,Kb=!1,Sb=69905,Yb=null){super(Yb?Yb.g8:null,Yb?Yb.SA:null,Yb?Yb.roa:null,Yb?Yb.cultureName:null,Yb?Yb.PAa:null);this.colSpan=b;this.rowSpan=h;this.width=u;this.J9b=
Kb;this.height=y;this.b2a=vb;this.shadingColor=P;this.verticalAlignment=aa;this.jia=ta;this.Gee=Pa;this.q6=Sb}}Object(m.a)(bq,"TableCellSemanticArgs",uq.a,[]);class Ph extends uq.a{constructor(b,h=null){super(h?h.g8:null,h?h.SA:null,h?h.roa:null,h?h.cultureName:null,h?h.PAa:null);this.height=b}}Object(m.a)(Ph,"TableRowSemanticArgs",uq.a,[]);class Xj extends uq.a{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb=null,Sb=-1,Yb=null){super(Yb?Yb.g8:null,Yb?Yb.SA:null,Yb?Yb.roa:null,Yb?Yb.cultureName:null,Yb?Yb.PAa:
null);this.yzd=null;this.rowCount=b;this.tdb=h;this.width=u;if(P)for(this.yzd=Array(P.length),b=0;b<P.length;++b)this.yzd[b]=P[b];this.Rgi=aa;this.Y8f=Pa;this.Nkm=ta;this.b2a=y;this.vQd=vb;this.styleId=Kb;this.tableLook=Sb}}Object(m.a)(Xj,"TableSemanticArgs",uq.a,[]);let hq;class El extends Tj{constructor(b,h=null,u=null,y=null){super(b);this.ytb=null;this.PTj=Ma.a.B4("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",
7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Pd=h||new Ir;this._context=u||new Fs;this.BCe=y}get hsi(){return this.PTj}f_h(b,h){var u;if((u=b.style?b.style.listStyleType:"")&&""!==u&&(u=this.hsi[A.a.jh(u)])||(u=Tj.aO(b,"type"))&&""!==u&&(u=this.hsi[u]))return u;if(this.Pd.slb&&(u=b.tagName.toLowerCase())&&("ol"===u||"ul"===u)&&(b=b.className)&&""!==b)if("ul"===u)switch(b=El.fNd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;
case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===u)switch(b=El.fNd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}XZh(b){let h=-1,u=b.tagName.toLowerCase();if("ol"===u||"ul"===u){b=Hc.a.WWh(b,"li");if(!b)return h;u="li"}if("li"===u){h=(h=this.DId(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=Hc.a.WWh(b,"p"))return El.vIl(b)-
1}return h}DId(b,h,u){b=this.Pd.slb?b.getAttribute(h):Tj.aO(b,h);b=parseInt(b);return isNaN(b)||0>b?u:b}J5m(){this.ytb.pop();this.Xi.jFa()}kNc(b,h){this.Tu(P=>P.Qha(0,0));const u=this.f_h(b.tf,h?6:2);let y=1;h&&(y=this.DId(b.tf,"start",1));h=!1;this.Pd.slb&&(h=b.tf.getAttribute("data-pasteFromRc"),(h=!!h&&"true"===h)&&b.tf.removeAttribute("data-pasteFromRc"),(ba.a.r3||ba.a.kj)&&El.$yd(b.tf));b=new Kt.a(u,y,Tj.vD(b),0,-1,h,this.Pd.slb);this.ytb.push(b);this.Xi.lFa(b);this.mJ(Object(v.a)(this,this.J5m,
"onListElementClose"));return 1}nXk(b,h,u){return(h=h.getAttribute(u))?b.r5e(h):!1}reset(){super.reset();this.ytb=new lo}G5i(b,h){let u=!1;try{var y=h.getAttribute("xml:lang")||Tj.aO(h,"lang")}catch(Pa){y=null}y&&""!==y&&(u=b.z2f(y)||u);(y=Tj.aO(h,"dir"))&&(u=b.Agc(y)||u);if(this.Pd.f6n(this._context)&&h.getAttribute)for(y=0;y<El.ofj.length;y++)u=this.nXk(b,h,El.ofj[y])||u;if(y=h.style){if(y.fontWeight){var P=A.a.lA(y.fontWeight),aa=parseInt(P);isNaN(aa)?"BOLD"===P?u=b.mG(!0)||u:"NORMAL"===P&&(u=
b.mG(!1)||u):u=600<=aa?b.mG(!0)||u:b.mG(!1)||u}this.Pd.h$i&&y.fontSize&&(P=Tj.fUl(y.fontSize),0<P&&(u=b.jae(Math.floor(2*P))||u));this.Pd.j6n(this._context)&&(this.Pd.m$i&&h.getAttribute?(P=h.getAttribute("data-indent"))&&0<P.length&&(P=Bf.a.Mi(parseInt(P),0)+"px",u=b.fbe(P)||u):y.textIndent&&(u=b.fbe(y.textIndent)||u));this.Pd.e6n(this._context)&&y.marginLeft&&(this.Pd.m$i&&h.getAttribute?(P=h.getAttribute("data-margin"))&&0<P.length&&(u=b.Pha(y.marginLeft)||u):"TABLE"!==h.tagName&&(u=b.Pha(y.marginLeft)||
u));if(this.Pd.h6n(this._context)&&(P=h.getAttribute("style"))&&""!==P)for(P=P.split(";"),aa=0;aa<P.length;aa++){var ta=P[aa].trim();ta.startsWith("tab-stops")&&(u=b.p3f(ta.replace("tab-stops:",""))||u)}this.Pd.d6n(this._context)&&y.lineHeight&&(u=b.sC(y.lineHeight)||u);this.Pd.a6n&&(P=y.textTransform?A.a.jh(y.textTransform):null,aa=y.fontVariantCaps?A.a.jh(y.fontVariantCaps):null,ta=y.fontVariant?A.a.jh(y.fontVariant):null,"uppercase"===P?u=b.$2c("uppercase")||u:"small-caps"===aa||ta&&0<=ta.indexOf("small-caps")?
u=b.$2c("small-caps")||u:this.Pd.iBk&&"none"===P&&(u=b.$2c("none")||u));this.Pd.i6n(this._context)&&y.textAlign&&(u=b.pMb(A.a.jh(y.textAlign))||u);y.fontStyle&&(P=A.a.lA(y.fontStyle),"ITALIC"===P||"OBLIQUE"===P?u=b.Mmb(!0)||u:"NORMAL"===P&&(u=b.Mmb(!1)||u));P=El.OWl(h);if(y.textDecoration||P)aa=A.a.jh(y.textDecoration||""),P=A.a.jh(P||""),h.parentNode&&h.parentNode.tagName&&"a"===A.a.jh(h.parentNode.tagName)?(ta=(h.querySelector(".TextRun")||h).className)&&-1<ta.indexOf("Underlined")&&(u=b.o4(!0)||
u):y.v0o||El.isUnderline(aa)||El.isUnderline(P)?u=b.o4(!0)||u:this.Pd.uaj&&(u=b.o4(!1)||u),y.u0o||El.Iki(aa)||El.Iki(P)?u=b.K8(!0)||u:this.Pd.uaj&&(u=b.K8(!1)||u);if(y.verticalAlign){P=A.a.lA(y.verticalAlign);aa=this.Ftn(P);if("SUB"===P||this.Pd.l$i(this._context)&&h.className&&-1<h.className.indexOf("Subscript")||0>aa&&this.Pd.Q$i)u=b.kpa(!0)||u;else if("SUPER"===P||this.Pd.l$i(this._context)&&h.className&&-1<h.className.indexOf("Superscript")||0<aa&&this.Pd.Q$i)u=b.mca(!0)||u;this.Pd.h$i&&("SUB"===
P||"SUPER"===P)&&h.getAttribute&&(P=parseFloat(h.getAttribute("data-fontsize")),isNaN(P)||(u=b.jae(Math.floor(2*P))||u))}P=!1;r.AFrameworkApplication.K&&(P=r.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.Pd.c6n&&y.fontFamily&&(this.Pd.l6n&&h.getAttribute?(aa=h.getAttribute("data-usefontface"))&&"true"===aa&&(P&&w.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),u=this.D5i(b,y.fontFamily,u)):u=this.D5i(b,y.fontFamily,u));aa=null;this.Pd.b6n&&y.color&&(aa=Hk.a.wta(y.color));
ta=!!aa;this.Pd.k6n(this._context)&&h.getAttribute&&(aa=h.getAttribute("data-scheme-color"),aa=null!==aa?aa:"",ta=""!==aa||!this._context.n8b||El.Hxm(h));ta&&(u=b.Us(aa)||u);this.Pd.Z5n&&y.backgroundColor&&(h.tagName&&El.Qjo.contains(A.a.lA(h.tagName))||(u=b.xxa(Hk.a.wta(y.backgroundColor))||u));if(this.Pd.$5n&&y.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(y=El.AZl(y.backgroundImage))&&0<y.KDc.count){aa=y.KDc.J(0).color;ta=!0;for(let Pa=0;Pa<y.KDc.count&&(ta=ta&&aa===y.KDc.J(Pa).color,
ta);Pa++);ta&&(P&&w.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),u=b.xxa(Hk.a.wta(aa))||u)}}this.Pd.j$i(this._context)&&h.getAttribute&&(y=h.getAttribute("data-ccp-props"))&&(u=b.tGa(y)||u);h.getAttribute&&((y=h.getAttribute("data-ccp-charstyle"))&&this.Pd.inb&&(u=b.Q$d(y)||u),(h=h.getAttribute("data-ccp-parastyle"))&&this.Pd.inb&&(u=b.Qae(h)||u));return u}a8n(b){if(this.Pd.b8n)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<A.a.lA(b.className).indexOf("MSOCOM"))return!0;
if("DIV"===A.a.lA(b.tagName))break;b=b.parentNode}return!1}D5i(b,h,u){h=El.rXh(h);return b.e5a(h,this.Pd.Aho)||u}Ftn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Cba(b,h){"\u200b"===b&&(b="\u00a0");h&&h.tf&&this.a8n(h.tf)&&(b="");this.Xi.Cba(b,Tj.vD(h))}X_d(b){const h=Tj.aO(b.tf,"href");return h&&""!==h?(this.Xi.oQa(h,Tj.vD(b)),this.mJ(Object(v.a)(this.Xi,this.Xi.nQa,"onAnchorEnd")),1):2}d0d(){return this.Tu(b=>b.mG(!0))?1:2}g0d(){return this.Tu(b=>b.Nof())?1:2}h0d(b){this.Xi.iG(Tj.vD(b));
this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}i0d(b){this.Xi.iFa(Tj.vD(b))}j0d(b){this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}n0d(){return this.Tu(b=>b.Mmb(!0))?1:2}k0d(b){this.Tu(h=>h.pMb("center"));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}o0d(){return this.Tu(b=>b.e5a("consolas"))?1:2}v0d(){return this.Tu(b=>b.K8(!0))?1:2}u0d(b){return this.kNc(b,!1)}z0d(){return this.Tu(b=>b.Mmb(!0))?
1:2}A0d(b){return this.kNc(b,!1)}C0d(b){var h=b.tf.getAttribute("data-render-src");const u=b.tf.getAttribute("data-render-method");if(h&&""!==h&&u&&""!==u){const ta=b.tf.getAttribute("data-render-fallback");let Pa=0,vb=0;if(b.tf.currentStyle){var y=b.tf.currentStyle.width,P=b.tf.currentStyle.height;y&&-1!==y.indexOf("px")&&(y=parseInt(A.a.substring(y,0,y.indexOf("px"))),isNaN(y)||(Pa=y));P&&-1!==P.indexOf("px")&&(P=parseInt(A.a.substring(P,0,P.indexOf("px"))),isNaN(P)||(vb=P))}b=new qp(h,u,ta,Pa,
vb,Tj.vD(b));this.Xi.A3a(b);return 2}this.Pd.slb&&(ba.a.r3||ba.a.kj)&&(h=b.tf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Pd.slb&&h&&h.length&&El.$yd(b.tf));const aa=b.tf.getAttribute("align");this.Tu(ta=>ta.pMb(aa));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}D0d(b){this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}G0d(b){this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}I0d(){return this.Tu(b=>
b.Mmb(!0))?1:2}P0d(b){return this.Tu(h=>{var u=El.rXh(b.tf.getAttribute("face"));u=h.e5a(u);h=h.Us(Hk.a.wta(b.tf.getAttribute("color")));return u||h})?1:2}S0d(b){this.Tu(h=>this.Pd.inb?h.Nmb(1):h.Pmb(1));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}T0d(b){this.Tu(h=>this.Pd.inb?h.Nmb(2):h.Pmb(2));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}U0d(b){this.Tu(h=>this.Pd.inb?h.Nmb(3):h.Pmb(3));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,
this.Xi.hG,"onParagraphEnd"));return 1}V0d(b){this.Tu(h=>this.Pd.inb?h.Nmb(4):h.Pmb(4));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}W0d(b){this.Tu(h=>this.Pd.inb?h.Nmb(5):h.Pmb(5));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}X0d(b){this.Tu(h=>this.Pd.inb?h.Nmb(6):h.Pmb(6));this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}Y0d(b){this.Xi.iFa(Tj.vD(b))}b1d(b){var h=b.tf;const u=
h.src,y=h.alt,P=h.jWo,aa=h.getAttribute("data-external-content-url");let ta=0,Pa=0;h.style&&(ta=Tj.Ffa(h.style.width),Pa=Tj.Ffa(h.style.height));ta&&Pa||(ta=h.width,Pa=h.height);let vb=0,Kb=0;b.tf.currentStyle&&(ta||Pa||(ta=Tj.Ffa(b.tf.currentStyle.width),Pa=Tj.Ffa(b.tf.currentStyle.height)),vb=Tj.Ffa(b.tf.currentStyle.maxWidth),Kb=Tj.Ffa(b.tf.currentStyle.maxHeight));let Sb=null;const Yb=h.getAttribute(Ol.HCd);if(Yb&&(w.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Ac=h.getAttribute(Ol.I6e),Sc=h.getAttribute(Ol.J6e),nd=h.getAttribute(Ol.G6e),Ad=h.getAttribute(Ol.H6e),he=h.getAttribute(Ol.RFc);h=h.getAttribute(Ol.K6e);Ac&&Ad&&(Sb=new Nq(Yb,Ac,Sc,nd,Ad,he,h))}b=new uC.a(u,y,ta,Pa,Tj.vD(b),vb,Kb,P,null,aa,Sb);this.Xi.rwa(b)}Z0d(){return this.Tu(b=>b.Mmb(!0))?1:2}c1d(){return this.Tu(b=>b.o4(!0))?1:2}f1d(){return this.Tu(b=>b.e5a("consolas"))?1:2}h1d(b){this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,
this.Xi.hG,"onParagraphEnd"));return 1}j1d(b){this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}k1d(b){let h;const u=this.f_h(b.tf,0);let y=this.DId(b.tf,"value",0);var P=!1;0<this.ytb.count?h=this.ytb.iz():(h=new Kt.a(2,1,Tj.vD(b)),y||(y=1));var aa=El.GIl(b.tf,Kt.a.imj);3!==aa&&(h.Gr=aa);if(this.Pd.slb){P=h.listLevel;aa=h.listId;this.Pd.i$i?(P=this.XZh(b.tf),P=0>P&&0>h.listLevel&&0<this.ytb.count?h.listLevel=this.ytb.count-1:h.listLevel=0<=P?P:h.listLevel,this.BCe&&
this.BCe.b<P&&(this.BCe.b=P)):0>P&&(P=h.listLevel=this.XZh(b.tf));1>aa&&(aa=h.listId=this.DId(b.tf,Kt.a.UTc,0));b.tf.getAttribute(Kt.a.xWd)&&(h.levelText=b.tf.getAttribute(Kt.a.xWd));var ta=b.tf.getAttribute(Kt.a.DBf);ta&&(h.font=ta);ta=!1;r.AFrameworkApplication.K&&(ta=r.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ta){var Pa=b.tf.getAttribute("data-charcodes");ta=[];if(Pa&&""!==Pa)if(-1<Pa.indexOf(",")){Pa=Pa.split(",");for(var vb=0;vb<Pa.length;vb++)ta.push(parseInt(Pa[vb]))}else ta.push(parseInt(Pa));
if(ta&&0<ta.length){Pa=Array(ta.length);for(vb=0;vb<ta.length;vb++)Pa[vb]=ta[vb];h.D_e=Pa}(ta=b.tf.getAttribute("data-buAutoNum"))&&0<ta.length&&(h.buAutoNum=parseInt(ta))}(P=0<=P&&0<aa)&&El.$yd(b.tf)}h.dmk(u,y,P);h.CBf=this.mIl(b.tf);this.Xi.sQa(h.clone());this.mJ(Object(v.a)(this.Xi,this.Xi.kFa,"onListItemEnd"));return 1}mIl(b){var h=b.getAttribute(Kt.a.Xri);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch(u){w.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;
h=new uh.DictionaryPropertySet;for(const u in b)h.bSa(+u,b[u]);return h}onMenuOpen(b){return this.kNc(b,!1)}l1d(b){if(this.Tu(h=>h.mgc(!0))){const h=b.tf.getAttribute("OuterHtml");this.Xi.tQa(h,Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.x3a,"onMathEnd"))}return 1}x1d(b){return this.kNc(b,!0)}y1d(b){this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}C1d(b){const h=b.tf.getAttribute("align");this.Tu(u=>u.pMb(h));if(this.Pd.slb){const u=b.tf.parentNode;u&&u.tagName.toLowerCase().startsWith("li")&&
El.$yd(b.tf,ba.a.r3||ba.a.kj)}this.Xi.iG(Tj.vD(b));this.mJ(Object(v.a)(this.Xi,this.Xi.hG,"onParagraphEnd"));return 1}J1d(){this.Tu(b=>b.e5a("consolas"));this.Xi.Pkb();this.mJ(Object(v.a)(this.Xi,this.Xi.Okb,"onPreFormattedTextEnd"));return 1}R1d(){return this.Tu(b=>b.K8(!0))?1:2}S1d(){return this.Tu(b=>b.e5a("consolas"))?1:2}$1d(){return this.Tu(b=>b.o6f())?1:2}a2d(b){var h=b.tf.attributes.getNamedItem("style"),u="";h&&h.value&&(u=h.value);h=Hk.a.Oen(u);if(0<h&&this.Pd.ffm){for(u=0;u<h;u++)this.Xi.Skb(Tj.vD(b));
return 3}return 2}c2d(){return this.Tu(b=>b.K8(!0))?1:2}d2d(){return this.Tu(b=>b.mG(!0))?1:2}e2d(){return this.Tu(b=>b.kpa(!0))?1:2}g2d(){return this.Tu(b=>b.mca(!0))?1:2}i2d(b){this.Tu(Sb=>Sb.clearFormatting()&&Sb.lZf());Hk.a.HOd(b.tf,this);const h=Hk.a.o7h(b.tf),u=Hk.a.yTh(b.tf),y=Hk.a.JI(b.tf),P=Hk.a.sK(b.tf),aa=!parseInt(Tj.aO(b.tf,"border")),ta=Hk.a.fxm(b.tf);let Pa=-1,vb="";var Kb=-1;b.tf.attributes.hasOwnProperty("style")&&-1!==(Kb=b.tf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?
Pa=parseInt(b.tf.attributes.getNamedItem("style").value.substr(Kb+17)):b.tf.attributes.hasOwnProperty(kx.a.ICd.toString())&&(Pa=parseInt(b.tf.attributes.getNamedItem(kx.a.ICd.toString()).value));Kb=-1;b.tf.attributes.hasOwnProperty("class")&&-1!==(Kb=b.tf.attributes.getNamedItem("class").value.indexOf("Mso"))?vb=b.tf.attributes.getNamedItem("class").value.substr(Kb).split(" ")[0]:b.tf.attributes.hasOwnProperty(kx.a.SFc.toString())&&(vb=b.tf.attributes.getNamedItem(kx.a.SFc.toString()).value);this.Xi.Bba(new Xj(0,
0,h.value,h.Vmi,null,aa,ta,u,new My(y.value,P.value),vb,Pa,Tj.vD(b)));this.mJ(Object(v.a)(this.Xi,this.Xi.yba,"onTableEnd"));r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}hXc(b){const h=Hk.a.fYh(b.tf),u=Hk.a.o7h(b.tf);if(!u.value&&u.hTd&&(r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Pd.SKi))return 3;let y=parseInt(Tj.aO(b.tf,"colSpan"));if(void 0===y||null===
y||""===y+"")y=u.value?1:0;let P=parseInt(Tj.aO(b.tf,"rowSpan"));if(void 0===P||null===P||""===P+"")P=h.value?1:0;let aa=!1;b.tf.attributes.hasOwnProperty("style")&&(aa=-1!==b.tf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.tf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!aa&&b.tf.attributes.hasOwnProperty("class")&&(aa=-1!==b.tf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ta=69905;if(b.tf.attributes.hasOwnProperty(kx.a.F6e.toString())){var Pa=
parseInt(b.tf.attributes.getNamedItem(kx.a.F6e.toString()).value);isNaN(Pa)||(ta=Pa)}Pa=Hk.a.wta(b.tf.style.backgroundColor);const vb=Hk.a.DZl(b.tf);this.Tu(Yb=>Yb.Qha(0,0));Hk.a.HOd(b.tf,this);const Kb=Hk.a.yTh(b.tf),Sb=this.Pd.yfn?Hk.a.rvl(b.tf):null;b=new bq(y,P,u.value,h.value,Pa,vb,Kb,Sb,u.Vmi,aa,ta,Tj.vD(b));this.Xi.xba(b);this.mJ(Object(v.a)(this.Xi,this.Xi.wba,"onTableCellEnd"));this.uZm();return 1}l2d(b){const h=this.hXc(b);if(3===h)return h;this.Tu(u=>{const y=u.mG(!0);u=u.pMb("center");
return y||u});Hk.a.HOd(b.tf,this);return 1}p2d(b){Hk.a.HOd(b.tf,this);const h=Hk.a.fYh(b.tf);if(h.hTd&&!h.value&&(r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Pd.SKi))return 3;this.Xi.Aba(new Ph(h.value,Tj.vD(b)));this.mJ(Object(v.a)(this.Xi,this.Xi.zba,"onTableRowEnd"));return 1}q2d(){return this.Tu(b=>b.e5a("consolas"))?1:2}r2d(){return this.Tu(b=>b.o4(!0))?1:2}s2d(b){return this.kNc(b,!1)}v2d(){return this.Tu(b=>b.o4(!0))?1:2}static oBl(b){return b?
b.split(",")[0]:null}static Opo(b){if(!b)return null;b=A.a.CXf(b,'"');return b=A.a.CXf(b,"'")}static rXh(b){if(!b)return null;b=El.oBl(b);return b=El.Opo(b)}static Tdh(b,h){h=h.trim();var u=h.match(RegExp("^-?[0-9]+deg$"));if(u&&0<u.length){if(b.c$h())return!1;b.direction=h;return!0}if((u=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<u.length){if(b.c$h())return!1;b.direction=h;return!0}var y=(u=h.match(RegExp("^rgb\\(.*\\)")))&&0<u.length?h.indexOf(")")+
1:h.indexOf(" ");u=-1===y?h:Hk.a.wta(h.substr(0,y).trim());if(!u||""===u)return!1;h=-1===y?"":h.substr(y).trim();y=new Qi;y.color=u;y.stop=h;b.KDc.add(y);return!0}static AZl(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const u=new uv;for(;0<h.trim().length;){let y=h.indexOf(",");const P=h.indexOf("(");if(0<P&&P<y){const aa=h.indexOf(")");if(aa<P)return null;y=h.indexOf(",",aa)}if(-1===y){if(!El.Tdh(u,
h))return null;h=""}else{const aa=h.substr(0,y);h=h.substr(y+1);if(!El.Tdh(u,aa))return null}}return u}catch(h){return null}}static fNd(b,h){b=b.split(" ");if(0<b.length)for(let u=0;u<b.length;u++)if(0<=b[u].indexOf(h))return b[u];return""}static $yd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&El.wsh(b,h))}static wsh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&El.wsh(b,h)),b=b.nextSibling}static vIl(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&
0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let u=0;u<b.length;u++){var h=b[u].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static GIl(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static Hxm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static OWl(b){b=
b.style.textDecorationLine;return void 0===b||null===b?null:b}static Iki(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}El.Qjo=(hq=new ob.a,hq.add("TABLE"),hq.add("THEAD"),hq.add("TBODY"),hq.add("TFOOT"),hq.add("TR"),hq.add("TH"),hq.add("TD"),hq);El.ofj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(m.a)(El,"DefaultHtmlTranslator",Tj,[]);class Rh{constructor(b=null){this.eW=
b||Mq.a.iof("");this.Akd=Number.parseInvariant((new Date).format("HHmmss"))}get Hc(){return this.eW}process(b,h){if(b&&b.querySelectorAll){const aa=b.querySelectorAll("p");if(aa&&0<aa.length){for(var u=0,y=!1,P=aa[0].parentNode;5>u&&P&&P!==b;){u++;const ta=P.id.toLowerCase();if(ta&&ta.length&&-1!==ta.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(P,"WACEditing")&&Sys.UI.DomElement.containsCssClass(P,"EditingSurfaceBody")){y=!0;break}P=P.parentNode}if(y&&P!==b){u=b.firstChild;for(y=
!1;0<P.children.length&&P.children[0]!==u;)b.insertBefore(P.children[0],u),y=!0;if(y)for(;u;)P=u.nextSibling,b.removeChild(u),u=P}b=new ou.a(h,Object(v.a)(this,this.zSf,"processNodesDiscovery"),new Fz(aa));b.il("Word Converter Operation");b.wg=!h||h.wg;b.run()}}}zSf(b,h){const u=h.nodes[h.I2];var y=Rh.Zjf(u);if(y){let aa=y.ykc.replace(RegExp("level[0-9]"),"").trim();aa=aa&&aa.length?aa:y.ykc;let ta=h.lists[aa];ta||(ta=new LA,ta.c9=this.Akd++);let Pa=ta.U$b[y.level-1];Pa||(Pa=new Jy,Pa.level=y.level);
var P=u.parentNode;if(P&&"li"===P.tagName.toLowerCase()){if(P=P.parentNode)!(P=P.tagName.toUpperCase())||"OL"!==P&&"UL"!==P||(Pa.tagName=P)}else Pa.Vjb=Rh.IWh(u,5),Pa.Vjb&&Pa.Vjb.length||(Pa.Vjb=Rh.Vmf(u,5)),Pa.ignore=!Pa.Vjb||!Pa.Vjb.length,Pa.tagName=Rh.SJd(Pa.Vjb),"UL"===Pa.tagName&&(Pa.font=this.uXh(u,5));y.c9=ta.c9;Pa.bWc++;Pa.ignore||"li"===u.parentNode.tagName.toLowerCase()||(P=(P=Rh.Vmf(u,5))?P:Pa.Vjb)&&P.length&&(y.nMh=P,(P=Rh.IZn(u,P,Pa.listStyle,y.level-1))&&P.length&&(Pa.listStyle=P));
h.Sna[h.Sna.length]=y;Pa.Sna.contains(y)||Pa.Sna.add(y);if(void 0===ta.U$b[y.level-1]||null===ta.U$b[y.level-1]||ta.U$b[y.level-1]!==Pa)ta.U$b[y.level-1]=Pa;h.lists[aa]&&h.lists[aa]===ta||(h.lists[aa]=ta);h.A$b=u}else if((y=h.A$b)&&Rh.dMc(u)===y&&u.tagName===y.tagName&&u.className===y.className){y.appendChild(y.ownerDocument.createElement("BR"));for(y.appendChild(y.ownerDocument.createElement("BR"));u.firstChild;)y.appendChild(u.firstChild);u.parentNode.removeChild(u)}h.I2++;if(h.nodes.length<=h.I2){if(!h.Sna.length)return!1;
h.I2=0;b.Qh(Object(v.a)(this,this.ySf,"processNodeConvert"))}return!0}ySf(b,h){b=h.Sna[h.I2];var u=b.QIi,y=b.ykc.replace(RegExp("level[0-9]"),"").trim();y=y&&y.length?y:b.ykc;y=h.lists[y];var P=y.U$b[b.level-1],aa=u.parentNode.tagName.toLowerCase();if(!P.ignore&&u.parentNode&&"li"!==aa){if(aa=Rh.sUk(u,P)){Rh.qDc(u,5);const ta=u.ownerDocument.createElement("LI");ta.setAttribute("data-aria-level",String.format("{0}",b.level));ta.setAttribute(Kt.a.UTc,String.format("{0}",y.c9));"UL"===P.tagName&&(ta.setAttribute(Kt.a.xWd,
String.format("{0}",b.nMh)),ta.setAttribute(Kt.a.DBf,String.format("{0}",P.font)));for(;u.firstChild;)ta.appendChild(u.firstChild);aa.appendChild(ta);u.parentNode.removeChild(u);"UL"===P.tagName?this.Hc.b++:this.Hc.c++}}else"li"===aa&&(P=P.tagName,u=u.parentNode,b.Ucc&&(b=u.parentNode)&&b.tagName.toUpperCase()===P&&b.setAttribute("data-pasteFromRc","true"),u.setAttribute(Kt.a.UTc,String.format("{0}",y.c9)),"UL"===P?this.Hc.b++:this.Hc.c++);h.I2++;return h.I2<h.Sna.length}uXh(b,h){let u=null;for(let y=
0;!u&&y<b.childNodes.length;y++){const P=b.childNodes[y];u=Rh.xDl(P);!u&&1===P.nodeType&&1<h&&(u=this.uXh(P,h-1))}return u}static sUk(b,h){b=Rh.qUk(b,h.tagName);return Rh.l3e(b,h)}static l3e(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static qUk(b,h){h=b.ownerDocument.createElement(h?h:"UL");var u=b.getAttribute("start");u&&0<u.length&&(h.setAttribute("start",
u),b.removeAttribute("start"));(u=b.className)&&0<u.length&&(u="OL"===h.tagName?El.fNd(u,"NumberListStyle"):El.fNd(u,"BulletListStyle"),0<u.length&&(Sys.UI.DomElement.addCssClass(h,u),Sys.UI.DomElement.removeCssClass(b,u)));b.parentNode.insertBefore(h,b);return h}static qDc(b,h){for(let u=0;u<b.childNodes.length;u++){const y=b.childNodes[u];1===y.nodeType&&1<h&&Rh.qDc(y,h-1);if(Rh.hvf(y)||Rh.SQc(y))b.removeChild(y),u--}}static Zjf(b){if(1===b.nodeType){var h=Rh.T5b(b,"mso-list");if(h&&0<h.length)try{var u=
h.split(" ");if(3===u.length){const y=Number.parseInvariant(u[1].substr(5)),P=new Rr(y,h,b);P.Ucc=!0;return P}}catch(y){}else if((u=b.parentNode)&&"li"===u.tagName.toLocaleLowerCase()&&(h=u.getAttribute("data-"+hf.a.jwd),u=u.getAttribute(Kt.a.UTc),h&&u&&0<h.length&&0<u.length))return b=new Rr(Number.parseInvariant(h),u+" level"+h,b),b.Ucc=!1,b}return null}static IZn(b,h,u,y){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===Rh.SJd(h))return u=Rh.Iul(h),Sys.UI.DomElement.addCssClass(b,u),u;
var P=h.match(RegExp("^[0-9]+"));return P&&P.length?(u="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,u),b.setAttribute("start",P[0]),u):(P=h.match(RegExp("^[a-zA-Z]+")))&&P.length&&(P=P[0],y=(h=P.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Rh.WRl(u,y):1,1!==y&&((u=Rh.UAd(b,P,RegExp("^[ivxlcdm]+"),A.a.txh,"NumberListStyle3"))||(u=Rh.UAd(b,P,RegExp("^[IVXLCDM]+"),A.a.txh,"NumberListStyle5")))||y&&((u=Rh.UAd(b,P,RegExp("^[a-z]+"),A.a.rxh,"NumberListStyle2"))||(u=Rh.UAd(b,P,RegExp("^[A-Z]+"),
A.a.rxh,"NumberListStyle4"))))?u:"NumberListStyle1"}return null}static Iul(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static WRl(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static UAd(b,h,u,y,P){return(h=h.match(u))&&
h.length?(y=y(h[0]),y=1>y?1:y,Sys.UI.DomElement.addCssClass(b,P),b.setAttribute("start",y+""),P):null}static SJd(b){return Rh.Vkm(b)?"UL":"OL"}static Vkm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Vmf(b,h){let u=null;var y;let P,aa;for(let ta=-1;!u&&ta<b.childNodes.length;ta++){const Pa=-1===ta?b:b.childNodes[ta];if(Pa)if((y=Pa.innerHTML)&&0<y.length){if(P=y.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=P&&(aa=
y.indexOf("\x3c!--[endif]--\x3e"),0<=aa)){y=y.substring(P,aa+14);Pa.innerHTML=Pa.innerHTML.replace(y,"");if(y.length){b=b.ownerDocument.createElement("span");b.innerHTML=y;u=b.innerText.trim();break}u&&u.length||(u="o")}}else 0<=ta&&1===Pa.nodeType&&1<h&&(u=Rh.Vmf(Pa,h-1))}return u}static xDl(b){let h=null;1===b.nodeType&&((h=Rh.tXh(b,"font-family"))||(h=Rh.tXh(b,"mso-ascii-font-family")));return h}static tXh(b,h){return(b=Rh.T5b(b,h))&&0<b.length?b.trim():null}static IWh(b,h){let u=null;for(let y=
0;!u&&y<b.childNodes.length;y++){const P=b.childNodes[y];Rh.SQc(P)?(u="string"===typeof P.innerText?P.innerText.trim():P.textContent.trim(),u.length||(u="o"),P.parentNode.removeChild(P)):1===P.nodeType&&1<h&&(u=Rh.IWh(P,h-1))}return u}static SQc(b){return 1===b.nodeType&&(b=Rh.T5b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static hvf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static T5b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=
b.split(";");for(let u=0;u<b.length;u++){const y=b[u].split(":");if(2===y.length&&y[0].trim()===h)return y[1].trim()}}return null}static dMc(b){do b=b.previousSibling;while(b&&Rh.vQc(b));return b}static vQc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Rh.oCe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Rh.vQc(b.firstChild):!0}}Rh.oCe=RegExp("[\n|\r]","gi");Object(m.a)(Rh,"WacAndRichClientWordConverter",null,[181]);class vq{constructor(b){this.HZ=
b.$("ExternalPasteImprovementsEnabled")&&b.$("ListMarkerIsEnabled")}create(b=null){return this.HZ?new Rh(b):new bn(b)}}Object(m.a)(vq,"Box4WordConverterFactory",null,[584]);var Ny=c(1706);class Wx{constructor(b,h,u,y,P){this.cJg=0;this.ZFo=aa=>{let ta=!0;const Pa=this.Uda.bcl;null!=Pa?(aa.poa=Pa,ta=!1):Date.now()-this.cJg>this.Soe&&(w.ULS.sendTraceTag(18354843,307,50,null),this.rd.fc($c.a.ama,{["Reason"]:Zc.a.GIi}),ta=aa.poa=!1);return ta};this.rd=b;this.Oe=h;this.Soe=P;this.Uda=u;this.tAa=y}mEk(b,
h,u){w.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,u,this.Oe.tF);b.wg&&this.Oe.Wp&&window.chrome&&w.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.Uda.UHc(!!(h&16));this.tAa.create(b,this.ZFo,null).il("ClipboardPreProcess");this.cJg=Date.now()}OKn(){this.Uda.reset()}}Object(m.a)(Wx,"ClipboardOperationClipboardAccessHelper",null,[582]);var km=c(359);class jr{constructor(b,
h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad){this.kVa=null;this.ga=b;this.rd=h;this.Bz=u;this.Bh=y;this.ib=P;this.Uda=aa;this.eb=ta;this.He=Pa;this.ro=vb;this.Zc=Kb;this.jab=Sb;this.UIe=Yb;this.YD=Ac;this.ak=nd;this.wTb=Sc?Sc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.Lhd=Sc?Sc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Wc=Ad;this.Fl=Hm.a.getInstance(km.a.xYa)}get ih(){return this.Bh}get Mc(){return this.rd}get mQc(){if(null==this.kVa)if(this.Wc)if(this.Wc.hp.isCompleted)this.kVa=this.Wc.isFeatureEnabled(30)&&
this.Wc.isFeatureEnabled(2);else return!1;else this.kVa=!1;return this.kVa}SFo(b){b.UU();return!0}Vxh(b,h){b=h.Jy;w.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let y=!1,P;ba.a.vEa&&r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.mQc&&h.ye&&h.ye.oh&&(y=this.ak.adh(h.ye.oh.editingElement));P=this.ak.qpf(h.ye.oh.editingElement,!1);var u=h.ye.oh.editingElement;this.ak.Etf(u,!1,1);this.wTb&&ba.a.vEa?(u=h.ye.oh.editingElement,this.ak.CYf(u,
"data-src","data-srcurl"),b=this.Uda.copy(),this.ak.CYf(u,"data-srcurl","data-src")):this.Lhd&&h.ye&&h.ye.oh?(u=this.ak.u_e(h.ye.oh.editingElement,h.ye.Ux,!0),b=this.Uda.copy(),u&&this.ak.u_e(h.ye.oh.editingElement,h.ye.Ux,!1)):(this.ak.cWi(h.ye.oh.editingElement),b=this.Uda.copy());this.mQc&&y&&this.ak.PEn(h.ye.oh.editingElement);P&&this.ak.qpf(h.ye.oh.editingElement,!0);u=h.ye.oh.editingElement;this.ak.Etf(u,!1,0);if(!b)return w.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,
b.set("ErrorLevel","info"),this.Fl.logKpiFailure({kpiName:km.a.gyd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Mc.fc($c.a.lBb,{["Reason"]:Zc.a.U8f}),h.LQ&&h.LQ.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}x3e(b,h){const u=h.ye;w.ULS.shipAssertTag(18130961,307,!!(h.Jy&16));h.Rbo?this.Bz.Fsh():this.Bz.gBd(u,b);return!0}iEh(b,h){var u=h.context,y=h.vd;const P=h.x8;var aa=!1;b=this.ib.hb.kb.Tc;if(this.eb.em(b)||this.He.Dk(b)){const ta=
this.Zc.ng(b.node),Pa=ta.zd();w.ULS.shipAssertTag(18130962,307,Pa);this.ro.$d(ta);this.jab.Aib(ta)&&(aa=!0)}y=h.Jy&64?new uh.DictionaryPropertySet:y||new uh.DictionaryPropertySet;y.setValue(ld.a.SGc,!1);u=this.ga.Tf(u,Oa.a.gH,2,!0,P,y);8===u&&(w.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Mc.fc($c.a.ama,{["Reason"]:Zc.a.hEh}),h.LQ&&h.LQ.fail("DeleteKey failed",!1),this.Fl.logKpiFailure({kpiName:km.a.h_e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===u&&this.Fl.logKpiSuccess({kpiName:km.a.h_e});
32===u&&aa&&(h=this.ib.hb.kb,this.He.om(h)&&h.Qa.node===b.node&&!this.eb.textLength(h.Qa.node)&&(h=this.Zc.ng(h.Qa.node),b=this.He.eu(h),w.ULS.shipAssertTag(18130964,307,b),this.ro.$d(h),this.jab.USd(h)||(b=this.UIe.create(),b.ed(h),this.ro.u_(b,!1,!1),aa=this.ro.Ee(b),this.eb.ic(aa)&&(this.ro.$d(b),this.ih.merge(b,h,!1,!1),this.ib.setSelection(this.YD.we(aa,this.eb.textLength(aa)))))));return!0}}Object(m.a)(jr,"ClipboardOperationCutCopy",null,[609]);class ay{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,
Sb,Yb,Ac,Sc,nd,Ad){this.ga=b;this.rd=h;this.Bz=u;this.Uda=aa;this.ib=P;this.Bh=y;this.eb=ta;this.He=Pa;this.ro=vb;this.Zc=Kb;this.jab=Sb;this.UIe=Yb;this.YD=Ac;this.Ma=Sc;this.ak=nd;this.Wc=Ad}create(){return new jr(this.ga,this.rd,this.Bz,this.Bh,this.ib,this.Uda,this.eb,this.He,this.ro,this.Zc,this.jab,this.UIe,this.YD,this.Ma,this.ak,this.Wc)}}Object(m.a)(ay,"Factory",null,[581]);var OA=c(1630);class Xx{constructor(b,h){this.lbd=null;this.SPk=(u,y)=>{if(!Object(jb.a)(105,y.vd))return!1;const P=
Object(na.a)(105,y.vd);if(!P.hasProperty(ld.a.qof))return!1;const aa=P.getValue(ld.a.qof),ta=y.ye,Pa=ta.Bb;this.Bz.srj();Pa.yLb(()=>{Pa.setSelection(aa,void 0,!0);this.Bz.gBd(ta,u)},!0);return!0};this.Bz=b;this.Z4=h;this.OH=0}process(b,h){this.OH||(this.lbd=[this.SPk,Object(v.a)(this.Z4,this.Z4.rfn,"pasteGlossaryPlaceholder")]);let u=!0;this.OH<this.lbd.length&&(u=this.lbd[this.OH++](b,h));return u?this.OH<this.lbd.length:!1}}Object(m.a)(Xx,"ClipboardOperationContentControlShowPlaceholderProcessor",
null,[613]);class vv{constructor(b){this.Qqb=null;this.Q0=b;this.OH=-1}process(b,h){-1===this.OH&&(this.RZk(b,h),this.OH=0);let u=!1;this.OH<this.Qqb.length&&(u=this.Qqb[this.OH++](b,h));return u?this.OH<this.Qqb.length:!1}RZk(b,h){ba.a.t3||h.Jy&512?(this.Qqb=[Object(v.a)(this.Q0,this.Q0.x3e,"copyInternal")],w.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.wg&&h.Jy&256?(this.Qqb=[Object(v.a)(this.Q0,this.Q0.SFo,"waitBeforeCopy"),Object(v.a)(this.Q0,
this.Q0.Vxh,"copyExternal"),Object(v.a)(this.Q0,this.Q0.x3e,"copyInternal")],w.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.Qqb=[Object(v.a)(this.Q0,this.Q0.Vxh,"copyExternal"),Object(v.a)(this.Q0,this.Q0.x3e,"copyInternal")],w.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.Jy&32&&(b=Object(v.a)(this.Q0,this.Q0.iEh,"deleteForCut"),
this.Qqb.push(b),w.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));km.a.DIm(h)}}Object(m.a)(vv,"ClipboardOperationCutCopyProcessor",null,[612]);class Hz{constructor(b,h,u,y){this.mkd=null;this.VPk=(P,aa)=>{aa=aa.ye;this.Bz.KCo();this.Bz.gBd(aa,P);return!0};this.oVc=(P,aa)=>{aa=new Bq.Selection([aa.vd],!0);this.ib.setSelection(aa,P);return!0};this.Bz=b;this.ib=h;this.Q0=u;this.Z4=y;this.OH=0}process(b,h){this.OH||(this.mkd=[this.VPk,
Object(v.a)(this.Q0,this.Q0.iEh,"deleteForCut"),this.oVc,Object(v.a)(this.Z4,this.Z4.WKi,"pasteInternal"),Object(v.a)(this.Z4,this.Z4.v7i,"setSelectionAfterPaste")]);let u=!0;this.OH<this.mkd.length&&(u=this.mkd[this.OH++](b,h));return u?this.OH<this.mkd.length:!1}}Object(m.a)(Hz,"ClipboardOperationMoveProcessor",null,[608]);var Oy=c(1629);class Vs{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce){this.Bz=b;this.ga=h;this.Wmc=u;this.rd=y;this.He=P;this.Oe=aa;this.Ic=ta;this.Fad=Pa;this.YGj=
vb;this.ZQb=Kb;this.gpe=Sb;this.Kmc=Yb;this.tAa=Ac;this.PC=Sc;this.Ud=nd;this.Yl=Ad;this.VY=he;this.Wda=ce}create(b,h,u,y,P,aa,ta,Pa,vb=!0){const Kb=this.Fad.create(y,Object(na.a)(105,Pa));var Sb=this.YGj.create();const Yb=new Xx(this.Bz,Kb),Ac=new Hz(this.Bz,Hh.a.instance,Sb,Kb);Sb=new vv(Sb);y=new Oy.a(r.AFrameworkApplication.K,Lu.a.instance,y,ri.a.instance,Kb,this.ZQb);return new OA.a(b,h,u,P,aa,ta,Pa,this.Wmc,this.ga,this.rd,this.He,this.Oe,this.Ic,Yb,Ac,Sb,y,this.ZQb,this.gpe,this.Kmc,this.tAa,
this.PC,this.Ud,this.Yl,this.VY,this.Wda,r.AFrameworkApplication.m5f(),vb)}}Object(m.a)(Vs,"Factory",null,[580]);var Yx=c(270);class Tv{constructor(b,h){this.DDb=b.fjf(h);this.G3e=b.Iyl(h);this.Syb=b.Qgf(h);this.Jcb=b.ngf(h)}static sE(b){return Tv.yr(b)}static yr(b){return new Tv(nx.a.instance,b)}}Object(m.a)(Tv,"CpUsageHelper",null,[]);class MA{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb){this.kL=null;this.P1=!1;this.rd=b;this.Bz=h;this.Jvc=u;this.qsa=y;this.ib=P;this.ga=aa;this.Lwe=ta;this.EPe=vb;
this.SGe=Pa;this.sse=Kb;this.epe=Sb;this.Ud=Yb;this.X_g=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled");this.Fl=Hm.a.getInstance(km.a.xYa);this.P1=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get Kh(){return this.EPe.value}get Upa(){return this.qsa}get Mc(){return this.rd}get KQa(){return this.SGe.KQa}paste(b,h){const u=this.Ud.gYa();try{const y=h.ye,P=h.Jy;this.$T&&(this.ib&&this.ib.hb&&this.ib.hb.kb&&
Yx.TableBorderSelectionCache.t3n(this.ib.hb.kb.Lw||this.ib.hb.kb.hGb),mq.a.r1n(this.ib));w.ULS.shipAssertTag(18131010,307,!!(P&1));Object(jb.a)(105,h.vd)&&h.vd.setValue(zi.a.$ea,y.oh.editingElement.clientWidth);this.epe.Pro(b,h);let aa;if(!({JAd:aa}=this.Lwe.value.alj()).returnValue)return this.mUc(h,"HTML import strategy failed",!1),this.P1?this.Fl.logKpiFailure({kpiName:km.a.WLa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:km.a.rlb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):
Ta.Health.instance.recordQosError("HtmlImportStrategyFailed",[km.a.rlb],!1,!0,!0,!1,null),!1;this.Kh.aG();let ta=!0,Pa=null;const vb=this.sse.create(aa),Kb=h.prj;if((!y||!y.Bb)&&this.X_g)return this.mUc(h,"Fail to set selection.",!1),this.P1?this.Fl.logKpiFailure({kpiName:km.a.WLa,errorName:"SetSelectionFailed",optionalVeto:{name:km.a.rlb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):Ta.Health.instance.recordQosError("SetSelectionFailed",[km.a.rlb],!1,!0,!0,!1,null),!1;
y.Bb.yLb(()=>{Kb&&2===this.ga.processAction(Oa.a.Cla,2)?ta=!1:(Pa=Kb?this.ib&&this.ib.hb&&this.ib.hb.kb?this.ib.hb.kb.Qa:null:h.vd)?(w.ULS.shipAssertTag(18158338,307,Se.SelectionEditor.pf(Pa)),this.Rti(Pa,"paste")):w.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Kb)},this.SGe.kmi);if(!ta)return this.mUc(h,"fail to deleteForReplace.",!0),!1;if(!Pa&&this.X_g)return this.mUc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Pa.node||!Pa.node.isConnected)return this.mUc(h,
"node is null or not connected in ip context.",!0),!1;y.editingView.disable(!0,25);vb.restore();this.Jvc.lfn(aa,Pa,b);return!0}finally{u&&u.dispose()}}mUc(b,h,u){b.failed=!0;b.LQ&&b.LQ.fail(h,u)}rfn(b,h){const u=Object(na.a)(105,h.vd).getValue(ld.a.b8h);w.ULS.shipAssertTag(20492440,307,Se.SelectionEditor.pf(u));if(!this.Lrh(u,h))return!1;this.Kh.aG();h=(new oi.a).Qc(15);h.Eb(this.Bz.pia);this.Jvc.nfi(u,b);this.Bz.Fsh();h.dispose();return!0}WKi(b,h){const u=this.ib.hb.kb.Qa;if(!this.Lrh(u,h))return!1;
this.Kh.aG();this.ga.processAction(Oa.a.Cla,2);this.Rti(u,"intPaste");this.Jvc.nfi(u,b);return!0}Lrh(b,h){if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return w.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.xSc),h.LQ&&(h.LQ.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.Fl.logKpiFailure({kpiName:km.a.WLa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",
optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!Se.SelectionEditor.pf(b))return w.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.xSc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.Fl.logKpiFailure({kpiName:km.a.WLa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),
h.LQ&&(h.LQ.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}Rti(b,h){h=Tv.sE(h);this.Upa.Iun(h,b.node,b.cpBegin);this.Upa.FIm(h.G3e);this.Upa.xCf(h.DDb);this.Upa.lCf(h.Syb);this.Upa.jCf(h.Jcb)}v7i(b,h){if(!h.prj)return!1;h.Jy&64&&this.Bz.rrj();if(!h.h_a)return w.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Mc.fc($c.a.s0,{["Reason"]:Zc.a.$hb}),h.LQ&&h.LQ.fail("No selection after paste",!1),h.failed=!0,!1;this.SGe.cCo(h);this.Kh.aG();return!1}get $T(){null==
this.kL&&(r.AFrameworkApplication.Ce("he991617;3eed2178"),this.kL=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.kL}}Object(m.a)(MA,"ClipboardOperationPaste",null,[606]);class Bw{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.rd=b;this.Bz=h;this.Jvc=u;this.qsa=y;this.ib=P;this.ga=aa;this.EPe=Pa;this.BYj=ta;this.sse=vb;this.epe=Kb;this.Ud=Sb}create(b,h){h=this.BYj.create(this.ib,h);return new MA(this.rd,
this.Bz,this.Jvc,this.qsa,this.ib,this.ga,b,h,this.EPe,this.sse,this.epe,this.Ud)}}Object(m.a)(Bw,"Factory",null,[578]);var wv=c(1567);class Zx{constructor(b,h){this.Sgo=b;this.jen=h}}Object(m.a)(Zx,"ParagraphFormatStore",null,[]);class Cw{constructor(b,h,u,y){this.ib=b;this.eb=h;this.me=u;this.qAe=y}Pro(b,h){if(h.i9b&&this.qAe){h=b.poa;var u=this.ib.hb.kb.Qa.node,y=null;this.eb.ic(u)&&(y=this.me.Xn(u),u=this.eb.f0a(u),y=new Zx(y,u));h=new wv.a(h.context,h.Jy,h.LQ,h.x8,h.vd,y);b.poa=h}}}Object(m.a)(Cw,
"ClipboardOperationPasteOvertypeStrategy",null,[575]);class Uv{constructor(b){this.CCe=null;this.ib=b;b.yLb(h=>{this.CCe=h},!1)}get kmi(){return!1}cCo(b){b=this.sUe(b);this.setSelection(this.ib,b)}sUe(b){let h=b.h_a;(b.fTa||b.pxa)&&b.Bde&&(h=Kf.SelectionFactory.Vz(b.Bde,h.Qa));return h}setSelection(b,h){b.setSelection(h)}}Object(m.a)(Uv,"AClipboardOperationPasteStrategy",null,[626]);class Py extends Uv{constructor(b){super(b)}get KQa(){return this.CCe}}Object(m.a)(Py,"ClipboardOperationPasteToLiveSelectionStrategy",
Uv,[]);class wo extends Uv{constructor(b,h){super(b);this.GQe=null;this.QUj=h;b.yLb(u=>{this.GQe=u},!0)}get kmi(){return!0}get KQa(){return this.GQe}sUe(b){let h=super.sUe(b);b.vd.setValue(ld.a.$Ki,h);return h=this.QUj.F_h(this.CCe.kb,this.GQe.kb,h)}}Object(m.a)(wo,"ClipboardOperationPasteToVirtualSelectionStrategy",Uv,[]);class Sy{constructor(b){this.FQe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ia(ld.a.fTa,!1)&&this.FQe?new wo(b,this.sFo):new Py(b)}get sFo(){return null!=
this.Gyg?this.Gyg:this.Gyg=Ja.a.instance.Pa("Box4.Actors.IVirtualSelectionMerger")}}Object(m.a)(Sy,"ClipboardOperationPasteStrategyFactory",null,[574]);class PA{constructor(b,h,u,y){this.Mc=b;this.Bb=h;this.wo=u;this.ag=y}Tjn(b){(b&1||b&32)&&this.wo.Xp&&this.Bb.JYb()}slm(b,h){return b&1&&this.ag.xZ(h,!0)?(this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.hE}),!1):!0}}Object(m.a)(PA,"ClipboardOperationWordStrategy",null,[]);class em{constructor(){}tPk(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var u=Array.clone(h);
u.reverse();var y=h=0,P=0,aa=0;for(const Pa of u){u=Pa.style;var ta=Pa.selectorText;u=u?u.cssText:null;ta=ta?ta.split(","):null;if(u&&ta&&Pa.type===Pa.STYLE_RULE){aa+=ta.length;for(const vb of ta){0<=vb.indexOf("#")&&h++;0<=vb.indexOf(".")&&y++;0>vb.indexOf("#")&&0>vb.indexOf(".")&&P++;ta=null;try{ta=b.querySelectorAll(vb)}catch(Kb){w.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",vb,Kb.message)}if(ta)for(let Kb=0;Kb<ta.length;Kb++)ta[Kb].setAttribute("style",
u+(ta[Kb].getAttribute("style")||""))}}}w.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",aa,h,y,P)}else this.yui();else this.yui()}yui(){w.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",ba.a.tF)}}Object(m.a)(em,"ExternalPasteCssConverter",null,[572]);class bh{constructor(b){this.I2=0;this.fth=null;this.node=b}}Object(m.a)(bh,
"ChartConverterArguments",null,[]);class Qt{constructor(b=null){this._imgNodesConverted=0;this.eW=b||Mq.a.NTh("")}get Hc(){return this.eW}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new ou.a(h,this.mfl.bind(this),new bh(b[0])),b.il("Chart Converter Operation"),b.wg=!h||h.wg,b.run())))}mfl(b,h){var u=h.node;if(1<h.I2)return!1;if(1===u.nodeType&&"DIV"===u.tagName){const y=u.getAttribute(Ol.HCd);if(y){const P=u.getAttribute(Ol.I6e),aa=
u.getAttribute(Ol.J6e),ta=u.getAttribute(Ol.G6e),Pa=u.getAttribute(Ol.H6e),vb=u.getAttribute(Ol.RFc);u=u.getAttribute(Ol.K6e);P&&Pa&&aa&&"chart"===aa&&vb&&"XLO"===vb&&(h.fth=new Nq(y,P,aa,ta,Pa,vb,u))}}b.Qh(this.rVm.bind(this));return!0}rVm(b,h){var u=h.node;if(b=h.fth)1===u.childElementCount&&1===u.firstChild.nodeType&&"IMG"===u.firstChild.tagName?(u=u.firstChild,u.setAttribute(Ol.HCd,b.ccpId),u.setAttribute(Ol.I6e,b.pKey),u.setAttribute(Ol.J6e,b.type),u.setAttribute(Ol.H6e,b.dc),u.setAttribute(Ol.RFc,
b.client),b.version&&u.setAttribute(Ol.K6e,b.version),b.count&&u.setAttribute(Ol.G6e,b.count),this._imgNodesConverted++):w.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.eW._imgNodesConverted=this._imgNodesConverted;h.I2++;return!1}}Object(m.a)(Qt,"ChartConverter",null,[]);class Fo{constructor(b,h=null,u=null){this.rf=b;this.eW=h||Mq.a.b4h("");this.s4j=u||Mq.a.c4h("")}get Hc(){return this.eW}get r9f(){return this.s4j}Bba(b){this.r9f.b++;this.rf.Bba(b)}yba(){this.rf.yba()}Aba(b){this.r9f.c++;
this.rf.Aba(b)}zba(){this.rf.zba()}xba(b){this.r9f.d++;this.rf.xba(b)}wba(){this.rf.wba()}reset(){this.rf.reset()}get $Fc(){return this.rf.$Fc}Cba(b,h){this.Hc.b++;this.rf.Cba(b,h)}iFa(b){this.Hc.c++;this.rf.iFa(b)}Skb(b){this.Hc.b++;this.rf.Skb(b)}rwa(b){this.Hc.d++;this.rf.rwa(b)}dFa(b){this.Hc.f++;this.rf.dFa(b)}oQa(b,h){this.Hc.g++;this.rf.oQa(b,h)}nQa(){this.rf.nQa()}iG(b){this.Hc.h++;this.rf.iG(b)}hG(){this.rf.hG()}Pkb(){this.rf.Pkb()}Okb(){this.rf.Okb()}tQa(b,h){this.Hc.i++;this.rf.tQa(b,h)}x3a(){this.rf.x3a()}lFa(b){this.Hc.j++;
this.rf.lFa(b)}jFa(){this.rf.jFa()}sQa(b){this.Hc.k++;this.rf.sQa(b)}kFa(){this.rf.kFa()}A3a(b){this.Hc.l++;this.rf.A3a(b)}}Object(m.a)(Fo,"SemanticEventUsageCollector",null,[179,180]);class Sm{constructor(b,h=null,u=null,y=null){this.DHj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.rf=b;this.eW=h||Mq.a.qYh(ba.a.ryb,"");this.Ju=u;this.f2j=y?y.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.g2j=y?y.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):
!1;this.KEg=new bm.a(la.a.Ri());for(const P of this.DHj)this.KEg.add(P)}get Hc(){return this.eW}get Ro(){return this.Ju}Ih(b){return b?b+1:1}reset(){this.rf.reset()}e0d(){this.rf.e0d()}Sof(b){if(b&&this.Ro&&(b.getAttribute&&(b.getAttribute(Ol.f_k)&&(this.Ro.xQh=!0),b.getAttribute(Ol.HCd)&&(this.Ro.tol=!0),b.getAttribute(Ol.RFc)&&(this.Ro.I0e=b.getAttribute(Ol.RFc)),b.getAttribute(Ol.j_k)&&(this.Ro.yQh=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Ol.C0l)&&(this.Ro.wol=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Ol.man)&&
(this.Ro.yol=!0);h.startsWith(Ol.djn)&&(this.Ro.AQh=!0);h.startsWith(Ol.AHo)&&(this.Ro.BQh=!0);if(h.startsWith(ba.a.BYe)&&h.length===ba.a.BYe.length+1){const u=parseInt(A.a.substring(h,h.length-1,h.length));isNaN(u)||(this.Ro.LEc=u)}if(h===Ol.CWm||h===Ol.DWm)this.Ro.eId=!0}return this.rf.Sof(b)}onClose(){this.rf.onClose()}Cba(b,h){this.Ro&&(this.Ro.zol=!0);this.Hc.d=this.Ih(this.Hc.d);this.rf.Cba(b,h)}X_d(b){this.Hc.e=this.Ih(this.Hc.e);this.ni(b);return this.rf.X_d(b)}LJf(b){this.Hc.f=this.Ih(this.Hc.f);
this.ni(b);return this.rf.LJf(b)}MJf(b){this.Hc.g=this.Ih(this.Hc.g);this.ni(b);return this.rf.MJf(b)}RJf(b){this.Hc.h=this.Ih(this.Hc.h);this.ni(b);return this.rf.RJf(b)}gKf(b){this.Hc.i=this.Ih(this.Hc.i);this.ni(b);return this.rf.gKf(b)}iKf(b){this.Hc.j=this.Ih(this.Hc.j);this.ni(b);this.rf.iKf(b)}d0d(b){this.Hc.k=this.Ih(this.Hc.k);this.ni(b);return this.rf.d0d(b)}jKf(b){this.Hc.l=this.Ih(this.Hc.l);this.ni(b);this.rf.jKf(b)}kKf(b){this.Hc.m=this.Ih(this.Hc.m);this.ni(b);this.rf.kKf(b)}lKf(b){this.Hc.n=
this.Ih(this.Hc.n);this.ni(b);return this.rf.lKf(b)}g0d(b){this.Hc.o=this.Ih(this.Hc.o);this.ni(b);return this.rf.g0d(b)}h0d(b){this.Hc.p=this.Ih(this.Hc.p);this.ni(b);return this.rf.h0d(b)}zKf(b){this.Hc.q=this.Ih(this.Hc.q);this.ni(b);return this.rf.zKf(b)}i0d(b){this.Hc.r=this.Ih(this.Hc.r);this.ni(b);this.rf.i0d(b)}BKf(b){this.Hc.s=this.Ih(this.Hc.s);this.ni(b);return this.rf.BKf(b)}j0d(b){this.Hc.t=this.Ih(this.Hc.t);this.ni(b);return this.rf.j0d(b)}k0d(b){this.Hc.u=this.Ih(this.Hc.u);this.ni(b);
return this.rf.k0d(b)}n0d(b){this.Hc.v=this.Ih(this.Hc.v);this.ni(b);return this.rf.n0d(b)}o0d(b){this.Hc.w=this.Ih(this.Hc.w);this.ni(b);return this.rf.o0d(b)}MKf(b){this.Hc.x=this.Ih(this.Hc.x);this.ni(b);this.rf.MKf(b)}NKf(b){this.Hc.y=this.Ih(this.Hc.y);this.ni(b);return this.rf.NKf(b)}u0d(b){this.Hc.z=this.Ih(this.Hc.z);this.ni(b);return this.rf.u0d(b)}v0d(b){this.Hc.ba=this.Ih(this.Hc.ba);this.ni(b);return this.rf.v0d(b)}z0d(b){this.Hc.bb=this.Ih(this.Hc.bb);this.ni(b);return this.rf.z0d(b)}A0d(b){this.Hc.bc=
this.Ih(this.Hc.bc);this.ni(b);return this.rf.A0d(b)}C0d(b){this.Hc.bd=this.Ih(this.Hc.bd);this.ni(b);return this.rf.C0d(b)}D0d(b){this.Hc.be=this.Ih(this.Hc.be);this.ni(b);return this.rf.D0d(b)}G0d(b){this.Hc.bf=this.Ih(this.Hc.bf);this.ni(b);return this.rf.G0d(b)}I0d(b){this.Hc.bg=this.Ih(this.Hc.bg);this.ni(b);return this.rf.I0d(b)}mLf(b){this.Hc.bh=this.Ih(this.Hc.bh);this.ni(b);return this.rf.mLf(b)}P0d(b){this.Hc.bi=this.Ih(this.Hc.bi);this.ni(b);return this.rf.P0d(b)}tLf(b){this.Hc.bj=this.Ih(this.Hc.bj);
this.ni(b);return this.rf.tLf(b)}vLf(b){this.Hc.bk=this.Ih(this.Hc.bk);this.ni(b);this.rf.vLf(b)}wLf(b){this.Hc.bl=this.Ih(this.Hc.bl);this.ni(b);return this.rf.wLf(b)}S0d(b){this.Hc.bm=this.Ih(this.Hc.bm);this.ni(b);return this.rf.S0d(b)}T0d(b){this.Hc.bm=this.Ih(this.Hc.bm);this.ni(b);return this.rf.T0d(b)}U0d(b){this.Hc.bm=this.Ih(this.Hc.bm);this.ni(b);return this.rf.U0d(b)}V0d(b){this.Hc.bm=this.Ih(this.Hc.bm);this.ni(b);return this.rf.V0d(b)}W0d(b){this.Hc.bm=this.Ih(this.Hc.bm);this.ni(b);
return this.rf.W0d(b)}X0d(b){this.Hc.bm=this.Ih(this.Hc.bm);this.ni(b);return this.rf.X0d(b)}BLf(b){this.Hc.bn=this.Ih(this.Hc.bn);return this.rf.BLf(b)}Y0d(b){this.Hc.bo=this.Ih(this.Hc.bo);this.ni(b);this.rf.Y0d(b)}HLf(b){this.Hc.bp=this.Ih(this.Hc.bp);return this.rf.HLf(b)}Z0d(b){this.Hc.bq=this.Ih(this.Hc.bq);this.ni(b);return this.rf.Z0d(b)}ILf(b){this.Hc.br=this.Ih(this.Hc.br);this.ni(b);return this.rf.ILf(b)}b1d(b){this.Ro&&(this.Ro.xol=!0);this.ni(b);this.Hc.bs=this.Ih(this.Hc.bs);this.rf.b1d(b)}OLf(b){this.Hc.bt=
this.Ih(this.Hc.bt);this.ni(b);this.rf.OLf(b)}c1d(b){this.Hc.bu=this.Ih(this.Hc.bu);this.ni(b);return this.rf.c1d(b)}ULf(b){this.Hc.bv=this.Ih(this.Hc.bv);this.ni(b);return this.rf.ULf(b)}f1d(b){this.Hc.bw=this.Ih(this.Hc.bw);this.ni(b);return this.rf.f1d(b)}h1d(b){this.Hc.bx=this.Ih(this.Hc.bx);this.ni(b);return this.rf.h1d(b)}j1d(b){this.Hc.by=this.Ih(this.Hc.by);this.ni(b);return this.rf.j1d(b)}k1d(b){this.Ro&&(this.Ro.eId=!0);this.Hc.bz=this.Ih(this.Hc.bz);this.ni(b);return this.rf.k1d(b)}gMf(b){this.Hc.ca=
this.Ih(this.Hc.ca);this.ni(b);this.rf.gMf(b)}jMf(b){this.Hc.cb=this.Ih(this.Hc.cb);this.ni(b);return this.rf.jMf(b)}l1d(b){this.Ro&&(this.Ro.uol=!0);this.Hc.cc=this.Ih(this.Hc.cc);this.ni(b);return this.rf.l1d(b)}onMenuOpen(b){this.Hc.cd=this.Ih(this.Hc.cd);this.ni(b);return this.rf.onMenuOpen(b)}nMf(b){this.Hc.ce=this.Ih(this.Hc.ce);this.rf.nMf(b)}vMf(b){this.Hc.cf=this.Ih(this.Hc.cf);this.ni(b);return this.rf.vMf(b)}wMf(b){this.Hc.cg=this.Ih(this.Hc.cg);this.ni(b);return this.rf.wMf(b)}xMf(b){this.Hc.ch=
this.Ih(this.Hc.ch);this.ni(b);return this.rf.xMf(b)}x1d(b){this.Ro&&(this.Ro.eId=!0);this.Hc.ci=this.Ih(this.Hc.ci);this.ni(b);return this.rf.x1d(b)}zMf(b){this.Hc.cj=this.Ih(this.Hc.cj);this.ni(b);return this.rf.zMf(b)}y1d(b){this.Hc.ck=this.Ih(this.Hc.ck);this.ni(b);return this.rf.y1d(b)}C1d(b){this.Hc.cl=this.Ih(this.Hc.cl);this.ni(b);return this.rf.C1d(b)}GMf(b){this.Hc.cm=this.Ih(this.Hc.cm);this.ni(b);this.rf.GMf(b)}J1d(b){this.Hc.cn=this.Ih(this.Hc.cn);this.ni(b);return this.rf.J1d(b)}QMf(b){this.Hc.co=
this.Ih(this.Hc.co);this.ni(b);return this.rf.QMf(b)}R1d(b){this.Hc.cp=this.Ih(this.Hc.cp);this.ni(b);return this.rf.R1d(b)}S1d(b){this.Hc.cq=this.Ih(this.Hc.cq);this.ni(b);return this.rf.S1d(b)}jNf(b){this.Hc.cr=this.Ih(this.Hc.cr);return this.rf.jNf(b)}pNf(b){this.Hc.cs=this.Ih(this.Hc.cs);this.ni(b);return this.rf.pNf(b)}$1d(b){this.Hc.ct=this.Ih(this.Hc.ct);this.ni(b);return this.rf.$1d(b)}a2d(b){this.Hc.cu=this.Ih(this.Hc.cu);this.ni(b);return this.rf.a2d(b)}c2d(b){this.Hc.cv=this.Ih(this.Hc.cv);
this.ni(b);return this.rf.c2d(b)}d2d(b){this.Hc.cw=this.Ih(this.Hc.cw);this.ni(b);return this.rf.d2d(b)}tNf(b){this.Hc.cx=this.Ih(this.Hc.cx);return this.rf.tNf(b)}e2d(b){this.Hc.cy=this.Ih(this.Hc.cy);this.ni(b);return this.rf.e2d(b)}g2d(b){this.Hc.cz=this.Ih(this.Hc.cz);this.ni(b);return this.rf.g2d(b)}i2d(b){this.Ro&&(this.Ro.c4b=!0);this.Hc.da=this.Ih(this.Hc.da);this.ni(b);return this.rf.i2d(b)}xNf(b){this.Ro&&(this.Ro.c4b=!0);this.Hc.db=this.Ih(this.Hc.db);this.ni(b);return this.rf.xNf(b)}hXc(b){this.Ro&&
(this.Ro.c4b=!0);this.Hc.dc=this.Ih(this.Hc.dc);this.ni(b);return this.rf.hXc(b)}zNf(b){this.Hc.dd=this.Ih(this.Hc.dd);this.ni(b);return this.rf.zNf(b)}ANf(b){this.Hc.de=this.Ih(this.Hc.de);this.ni(b);return this.rf.ANf(b)}l2d(b){this.Ro&&(this.Ro.c4b=!0);this.Hc.df=this.Ih(this.Hc.df);this.ni(b);return this.rf.l2d(b)}BNf(b){this.Ro&&(this.Ro.c4b=!0);this.Hc.dg=this.Ih(this.Hc.dg);this.ni(b);return this.rf.BNf(b)}ENf(b){this.Hc.dh=this.Ih(this.Hc.dh);this.ni(b);return this.rf.ENf(b)}p2d(b){this.Ro&&
(this.Ro.c4b=!0);this.Hc.di=this.Ih(this.Hc.di);this.ni(b);return this.rf.p2d(b)}q2d(b){this.Hc.dj=this.Ih(this.Hc.dj);this.ni(b);return this.rf.q2d(b)}r2d(b){this.Hc.dk=this.Ih(this.Hc.dk);this.ni(b);return this.rf.r2d(b)}s2d(b){this.Ro&&(this.Ro.eId=!0);this.Hc.dl=this.Ih(this.Hc.dl);this.ni(b);return this.rf.s2d(b)}v2d(b){this.Hc.dm=this.Ih(this.Hc.dm);this.ni(b);return this.rf.v2d(b)}ni(b){const h=b.tf;if(h&&this.Ro){var u=h.tagName.toLowerCase();if(this.f2j&&this.shi(u)||this.g2j&&!this.shi(u))if("font"===
u&&this.$en(b),h.style&&(b=h.style))for(const y of b)y&&0<y.length&&this.Ro.rQd(h.tagName,y)}}$en(b){if((b=b.tf)&&"font"===b.tagName.toLowerCase()&&this.Ro){var h=b.getAttribute("face");h&&0<h.length&&this.Ro.rQd(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Ro.rQd(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Ro.rQd(b.tagName,"font-attr-size")}}shi(b){return this.KEg.contains(b)}}Object(m.a)(Sm,"HtmlEventUsageCollector",null,[237]);class sn{constructor(b,
h,u=!1){this.tf=b;this.SA=h;this.dlk=u}}Object(m.a)(sn,"TagEventParam",null,[]);class Mu{constructor(b,h=null){this.Ncd=this._prunedElements=this.rPe=this._voidElements=null;this.ud=b;this.eW=h||Mq.a.rYh("");this.N2n()}get Hc(){return this.eW}EZm(b,h,u){this.rPe[h]?this.qBi():(this.Hc.e++,(h=this.Ncd[h])&&h(new sn(b,u,!1)),this.Hc.b++)}qBi(){this.Hc.d++}zZm(){this.Hc.c++}oZm(b,h,u){if(this.rPe[h])this.qBi();else{if(h=this.Ncd[h])return this.Hc.b++,h(new sn(b,u,!1));this.Hc.f++}return 2}N2n(){this._voidElements=
Ma.a.B4("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.rPe=Ma.a.B4("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=Ma.a.B4("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",
!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,h=this.ud,u=this.ud,y=this.ud,P=this.ud,aa=this.ud,ta=this.ud,Pa=this.ud,vb=this.ud,Kb=this.ud,Sb=this.ud,Yb=this.ud,Ac=this.ud,Sc=this.ud,nd=this.ud,Ad=this.ud,he=this.ud,ce=this.ud,Nd=this.ud,re=this.ud;this.Ncd=Ma.a.B4("A",Object(v.a)(this.ud,this.ud.X_d,"onAOpen"),"ABBR",Object(v.a)(this.ud,this.ud.LJf,"onAbbrOpen"),"ACRONYM",Object(v.a)(this.ud,this.ud.MJf,"onAcronymOpen"),"ADDRESS",Object(v.a)(this.ud,this.ud.RJf,"onAddressOpen"),
"APPLET",Object(v.a)(this.ud,this.ud.gKf,"onAppletOpen"),"AREA",Object(v.a)(this.ud,this.ud.iKf,"onAreaTag"),"B",Object(v.a)(this.ud,this.ud.d0d,"onBOpen"),"BASE",Object(v.a)(this.ud,this.ud.jKf,"onBaseTag"),"BASEFONT",Object(v.a)(this.ud,this.ud.kKf,"onBasefontTag"),"BDO",Object(v.a)(this.ud,this.ud.lKf,"onBdoOpen"),"BIG",Object(v.a)(this.ud,this.ud.g0d,"onBigOpen"),"BLOCKQUOTE",Object(v.a)(this.ud,this.ud.h0d,"onBlockquoteOpen"),"BODY",Object(v.a)(this.ud,this.ud.zKf,"onBodyOpen"),"BR",Object(v.a)(this.ud,
this.ud.i0d,"onBrTag"),"BUTTON",Object(v.a)(this.ud,this.ud.BKf,"onButtonOpen"),"CAPTION",Object(v.a)(this.ud,this.ud.j0d,"onCaptionOpen"),"CENTER",Object(v.a)(this.ud,this.ud.k0d,"onCenterOpen"),"CITE",Object(v.a)(this.ud,this.ud.n0d,"onCiteOpen"),"CODE",Object(v.a)(this.ud,this.ud.o0d,"onCodeOpen"),"COL",Object(v.a)(this.ud,this.ud.MKf,"onColTag"),"COLGROUP",Object(v.a)(this.ud,this.ud.NKf,"onColgroupOpen"),"DD",Object(v.a)(this.ud,this.ud.u0d,"onDdOpen"),"DEL",Object(v.a)(this.ud,this.ud.v0d,"onDelOpen"),
"DFN",Object(v.a)(this.ud,this.ud.z0d,"onDfnOpen"),"DIR",Object(v.a)(this.ud,this.ud.A0d,"onDirOpen"),"DIV",Object(v.a)(this.ud,this.ud.C0d,"onDivOpen"),"DL",Object(v.a)(this.ud,this.ud.D0d,"onDlOpen"),"DT",Object(v.a)(this.ud,this.ud.G0d,"onDtOpen"),"EM",Object(v.a)(this.ud,this.ud.I0d,"onEmOpen"),"FIELDSET",Object(v.a)(this.ud,this.ud.mLf,"onFieldsetOpen"),"FONT",Object(v.a)(this.ud,this.ud.P0d,"onFontOpen"),"FORM",Object(v.a)(this.ud,this.ud.tLf,"onFormOpen"),"FRAME",Object(v.a)(this.ud,this.ud.vLf,
"onFrameTag"),"FRAMESET",Object(v.a)(this.ud,this.ud.wLf,"onFramesetOpen"),"H1",Object(v.a)(this.ud,this.ud.S0d,"onH1Open"),"H2",Object(v.a)(this.ud,this.ud.T0d,"onH2Open"),"H3",Object(v.a)(this.ud,this.ud.U0d,"onH3Open"),"H4",Object(v.a)(this.ud,this.ud.V0d,"onH4Open"),"H5",Object(v.a)(this.ud,this.ud.W0d,"onH5Open"),"H6",Object(v.a)(this.ud,this.ud.X0d,"onH6Open"),"HEAD",Object(v.a)(this.ud,this.ud.BLf,"onHeadOpen"),"HR",Object(v.a)(this.ud,this.ud.Y0d,"onHrTag"),"HTML",Object(v.a)(this.ud,this.ud.HLf,
"onHtmlOpen"),"I",Object(v.a)(this.ud,this.ud.Z0d,"onIOpen"),"IFRAME",Object(v.a)(this.ud,this.ud.ILf,"onIframeOpen"),"IMG",Object(v.a)(this.ud,this.ud.b1d,"onImgTag"),"INPUT",Object(v.a)(this.ud,this.ud.OLf,"onInputTag"),"INS",Object(v.a)(this.ud,this.ud.c1d,"onInsOpen"),"ISINDEX",Object(v.a)(this.ud,this.ud.ULf,"onIsindexOpen"),"KBD",Object(v.a)(this.ud,this.ud.f1d,"onKbdOpen"),"LABEL",Object(v.a)(this.ud,this.ud.h1d,"onLabelOpen"),"LEGEND",Object(v.a)(this.ud,this.ud.j1d,"onLegendOpen"),"LI",Object(v.a)(this.ud,
this.ud.k1d,"onLiOpen"),"LINK",Object(v.a)(this.ud,this.ud.gMf,"onLinkTag"),"MAP",Object(v.a)(this.ud,this.ud.jMf,"onMapOpen"),"MATH",Object(v.a)(this.ud,this.ud.l1d,"onMathOpen"),"MENU",Object(v.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(v.a)(this.ud,this.ud.nMf,"onMetaTag"),"NOFRAMES",Object(v.a)(this.ud,this.ud.vMf,"onNoframesOpen"),"NOSCRIPT",Object(v.a)(this.ud,this.ud.wMf,"onNoscriptOpen"),"OBJECT",Object(v.a)(this.ud,this.ud.xMf,"onObjectOpen"),"OL",Object(v.a)(this.ud,this.ud.x1d,
"onOlOpen"),"OPTGROUP",Object(v.a)(this.ud,this.ud.zMf,"onOptgroupOpen"),"OPTION",Object(v.a)(this.ud,this.ud.y1d,"onOptionOpen"),"P",Object(v.a)(this.ud,this.ud.C1d,"onPOpen"),"PARAM",Object(v.a)(this.ud,this.ud.GMf,"onParamTag"),"PRE",Object(v.a)(this.ud,this.ud.J1d,"onPreOpen"),"Q",Object(v.a)(this.ud,this.ud.QMf,"onQOpen"),"S",Object(v.a)(this.ud,this.ud.R1d,"onSOpen"),"SAMP",Object(v.a)(this.ud,this.ud.S1d,"onSampOpen"),"SCRIPT",Object(v.a)(this.ud,this.ud.jNf,"onScriptOpen"),"SELECT",Object(v.a)(this.ud,
this.ud.pNf,"onSelectOpen"),"SMALL",Object(v.a)(b,b.$1d,"onSmallOpen"),"SPAN",Object(v.a)(h,h.a2d,"onSpanOpen"),"STRIKE",Object(v.a)(u,u.c2d,"onStrikeOpen"),"STRONG",Object(v.a)(y,y.d2d,"onStrongOpen"),"STYLE",Object(v.a)(P,P.tNf,"onStyleOpen"),"SUB",Object(v.a)(aa,aa.e2d,"onSubOpen"),"SUP",Object(v.a)(ta,ta.g2d,"onSupOpen"),"TABLE",Object(v.a)(Pa,Pa.i2d,"onTableOpen"),"TBODY",Object(v.a)(vb,vb.xNf,"onTbodyOpen"),"TD",Object(v.a)(Kb,Kb.hXc,"onTdOpen"),"TEXTAREA",Object(v.a)(Sb,Sb.zNf,"onTextareaOpen"),
"TFOOT",Object(v.a)(Yb,Yb.ANf,"onTfootOpen"),"TH",Object(v.a)(Ac,Ac.l2d,"onThOpen"),"THEAD",Object(v.a)(Sc,Sc.BNf,"onTheadOpen"),"TITLE",Object(v.a)(nd,nd.ENf,"onTitleOpen"),"TR",Object(v.a)(Ad,Ad.p2d,"onTrOpen"),"TT",Object(v.a)(he,he.q2d,"onTtOpen"),"U",Object(v.a)(ce,ce.r2d,"onUOpen"),"UL",Object(v.a)(Nd,Nd.s2d,"onUlOpen"),"VAR",Object(v.a)(re,re.v2d,"onVarOpen"))}}Object(m.a)(Mu,"AHtmlProcessor",null,[]);class Ty{constructor(b,h){this.childNodes=b.childNodes;this.SA=h;this.S5e=0;this.FSd=!1}}
Object(m.a)(Ty,"HtmlProcessorArguments",null,[]);class is extends Mu{constructor(b,h=null){super(b,h);this.Bze=null}get Atm(){null==this.Bze&&(this.Bze=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.Bze}process(b,h=null){b&&(this.ud.reset(),this.gOi(new Ty(b,new rs.a),h))}gOi(b,h){b.childNodes.length&&(b=new ou.a(h,Object(v.a)(this,this.Uln,"processChild"),b),b.il("HTML Processing Operation"),h||(b.wg=!0),b.run())}Uln(b,h){const u=
h.childNodes[h.S5e];if(3===u.nodeType)return this.ud.e0d(),this.ud.Cba(u.nodeValue,new sn(u,h.SA.dVh())),is.zjc(h);if(1!==u.nodeType)return is.zjc(h);if(!h.FSd){const P=A.a.lA(u.tagName);if(!is.F5l(u))if(this._prunedElements[P])this.zZm();else{is.OQm(u);this.ud.e0d();var y=u.id;const aa=u.tagName,ta=h.SA.dVh(),Pa=u.getAttribute?u.getAttribute("class"):null;y=new br(y,aa,Pa?Pa:"",u.attributes?u.attributes.length:0);y.isValid&&ta.add(y);if(this._voidElements[P])return this.EZm(u,P,ta),is.zjc(h);y=!1;
switch(this.oZm(u,P,ta)){case 1:y=!0;break;case 3:return is.zjc(h)}switch(this.ud.Sof(u)){case 1:y=!0}h.FSd=y;this.gOi(new Ty(u,ta),b);if(!b.wg)return!0}}if(h.FSd){if(this.Atm&&!this.Ncd[A.a.lA(u.tagName)])return is.zjc(h);this.ud.onClose()}return is.zjc(h)}static OQm(b){3!==b.nodeType&&Bh.a.rl(b,"alreadyPasted",!0)}static F5l(b){return 3!==b.nodeType&&Bh.a.Db(b,"alreadyPasted")}static zjc(b){b.S5e++;b.FSd=!1;return b.S5e<b.childNodes.length}}Object(m.a)(is,"HtmlProcessor",Mu,[]);var ih=c(1944);class Uy{constructor(){this.Jy=
0;this.LEc=6;this.tol=this.xQh=!1;this.I0e=null;this.BQh=this.AQh=this.yol=this.wol=this.yQh=!1;this.progId=null;this.xol=this.c4b=this.eId=this.uol=this.zol=!1;this.Ffn=this.Tcc=0;this.lOf=this.platform=null;this.tsb={}}get F6f(){if(null!==this.I0e)switch(this.I0e){case "XLO":return"Excel Online"}if(this.BQh)return"Word Online";if(this.AQh||this.yQh)return"PowerPoint Online";if(this.xQh)return"Excel Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";
case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}aKm(){w.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.Ruk()))}bKm(){const b=this.tsb;for(const u in b){var h=u;const y=b[u];y&&(y.SourceApp=this.F6f,y.Browser=ih.a[this.Tcc],y.TagName=h,y.OperationId=this.lOf,w.ULS.sendTraceTag(51406242,307,50,JSON.stringify(y)))}}rQd(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.tsb||(this.tsb[b]={}),this.tsb[b][h]=this.YUl(b,h)+1)}YUl(b,
h){if(!(b&&b.length&&h&&h.length&&this.tsb&&b in this.tsb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.tsb[b])&&h in b?b[h]:0}Ruk(){const b={};b.ActionIdFlags=this.Jy;b.SourceApp=this.F6f;b.CopySourceBrowser=this.LEc;b.PasteBrowser=this.Tcc;b.IsSameBrowserPaste=this.qvm(this.LEc,this.Tcc);b.IsCrossBrowserPaste=this.xmm(this.LEc,this.Tcc);b.IsUncategorizedBrowserPaste=this.dym(this.LEc,this.Tcc);b.Platform=this.platform;b.OperationId=this.lOf;return b}qvm(b,h){return 5===b||6===b?!1:
b===h}xmm(b,h){return 6===b?!1:b!==h}dym(b,h){return 5===b&&5===h}}Object(m.a)(Uy,"HtmlContentMetadata",null,[]);var by=c(292),zt=c(1408),Vy=c(1028),Sr=c(311),Rt=c(192),Nz=c(1631),Fj=c(64);class Gn{get vj(){return null!=this.Cwg?this.Cwg:this.Cwg=Ja.a.instance.Pa("Box4.Styles.StyleSettings")}constructor(b,h,u,y,P,aa){this.dSg=!1;this.Zij=this.Kye=null;this.pfn=ta=>{kh.a.mark(5568);this.tLh(ta);let Pa=this.gTm;if(this.fli){const vb=this.iaj();vb&&(Pa=this.tlb);w.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",
vb)}ta.Qh(Pa);return!0};this.gTm=ta=>{kh.a.mark(5569);var Pa=new yd.GraphIterator;this.OQa.restore(Pa);Gn.$T||(this.OQa=null);var vb=new yd.GraphIterator;this.Wdf.restore(vb);this.Wdf=null;w.ULS.shipAssertTag(6305489,307,wg.OutlineElementReader.Oh(Pa));w.ULS.shipAssertTag(6305490,307,wg.OutlineElementReader.Oh(vb));og.OutlineElementNavigator.Ee(Pa);var Kb=be.ParagraphReader.rh(Pa)?be.ParagraphReader.textLength(Pa.currentNode):0;og.OutlineElementNavigator.$d(Pa);og.OutlineElementNavigator.Ee(vb);w.ULS.shipAssertTag(6305491,
307,be.ParagraphReader.rh(vb));var Sb=be.ParagraphReader.textLength(vb.currentNode);og.OutlineElementNavigator.$d(vb);let Yb=this.z3c;var Ac=new Hi.a;Ac.ed(Pa);og.OutlineElementNavigator.Jr(Ac,!1,!1);var Sc=Ac.currentNode===vb.currentNode,nd=!!this.Ki&&!!(this.Ki.Jy&8192);let Ad=!1;if(!nd&&this.Ki.vd&&Object(jb.a)(uh.DictionaryPropertySet,this.Ki.vd)){var he=this.Ki.vd.Nf(ld.a.Ycc);nd=he&&""!==he?!0:!1}he=!1;this.Ki.vd instanceof by.APropertySet&&(he=this.Ki.vd.ia(ld.a.B7,!1));if(Sc){Kb=yd.GraphIterator.$a(Pa.currentNode);
be.ParagraphReader.Lt(og.OutlineElementNavigator.Ee(Kb))||(Pa=vb);Pa.currentNode.id!==vb.currentNode.id&&(w.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",wj.ListReader.lj(Pa),wj.ListReader.lj(vb)),nd=Gn.ih.merge(Pa,vb,!0,nd),w.ULS.shipAssertTag(6305492,307,nd));vb=Pa;var ce=!0}else{Sc=!!(this.Ki.Jy&4);ce=this.Kd.zg&&Sc&&this.Ki.D1a;var Nd=!!(this.Ki.Jy&262144);this.SPf&&this.Ki&&!Sc&&!Nd&&(this.SPf.A9h(Pa,!1),this.SPf.A9h(vb,
!0));og.OutlineElementNavigator.Ee(Ac);Sc=be.ParagraphReader.rh(Ac)?be.ParagraphReader.textLength(Ac.currentNode):0;og.OutlineElementNavigator.$d(Ac);Fj.a.er&&this.Ki.Jy&65536||this.qnk(Ac,Pa,vb);Nd=new Hi.a;Nd.ed(Ac);og.OutlineElementNavigator.Jr(Nd,!1,!1);Gn.$T&&Nd.currentNode.id===vb.currentNode.id&&(this.dSg=!0);if(this.wW.VLa||this.g6n)if(Nd.Hn.id!==vb.Hn.id){for(;Ac.currentNode.id!==vb.currentNode.id;)og.OutlineElementNavigator.Ee(Ac,!1),this.wW.oGa(nf.a.create(Ac.currentNode)),Ac.qc(),og.OutlineElementNavigator.Jr(Ac,
!1,!1);Ac.ed(Pa);og.OutlineElementNavigator.Jr(Ac,!1,!1)}else Ad=!0;this.AY&&({z3c:Yb,sua:Ac}=this.AY.Kmn(Pa,vb,Yb,Ac));if(this.Ki.G8d&&(w.ULS.shipAssertTag(6305493,307,this.Ki.i9b),Nd=new yd.GraphIterator,Nd.ed(Ac),Nd=og.OutlineElementNavigator.Ee(Nd))){var re=this.Ki.G8d.Xf(Nd.qa.J(0));Nd.qa.J(0).formatting=re}Nd=0;nd&&this.TGe&&(Nd=1);re=this.F6n(Pa,Ac,Nd);this.Ki.Bde=null;if(this.Ki.pxa||this.Ki.fTa)this.Ki.Bde=this.DUl(re?Pa.currentNode:Ac.currentNode,re);var Xd=!1;re&&(Xd=wj.ListReader.lj(Pa),
w.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Xd,wj.ListReader.lj(vb)),this.Kye=Xd=Gn.ih.merge(Pa,Ac,!0,nd,vb,void 0,Ad,ce,this.TGe),this.G6n(Pa,Nd)&&this.ETm(Pa,vb,Nd,nd));Nd=Gn.Efn.hem(Pa,Ac,vb,Kb,Xd,this.yQc);var vg=!1;if(Yb){const Vf=new Hi.a;Vf.ed(vb);og.OutlineElementNavigator.u_(Vf,!1,!1);vg=wj.ListReader.lj(Vf);const kj=wj.ListReader.lj(vb),zm=he&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImageInsertionBug",
!1);w.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",zm);ce=Gn.ih.merge(Vf,vb,!0,nd,void 0,!0,void 0,ce,this.TGe,zm);w.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",vg,kj,ce?"True":"False, will cause IP to reset to zero.");vb=(vg=ce)?Vf:vb}else ce=!1,w.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.wW.VLa&&Ad&&(re&&!this.Nom(Nd,Xd)?(Ac=new yd.GraphIterator,
Ac.ed(Pa),Pa=og.OutlineElementNavigator.Ee(Ac),this.wW.fpa(Pa,Kb,Kb+Sc)):Yb&&!this.lrm(Nd,vg)?(Pa=new yd.GraphIterator,Pa.ed(Ac),Pa=og.OutlineElementNavigator.Ee(Pa),this.wW.fpa(Pa,0,Sc)):(Pa=new yd.GraphIterator,Pa.ed(Ac),Pa=og.OutlineElementNavigator.Ee(Pa),this.wW.oGa(nf.a.create(Pa))));this.Uin(Nd);this.isProgressiveStyleEnabled&&!nd&&this.LF.Nmn(Nd)}w.ULS.shipAssertTag(6305494,307,vb.isValid);nd=og.OutlineElementNavigator.Ee(vb);Sb=ce?be.ParagraphReader.textLength(nd)-Sb:0;this.Ki.h_a=he?Kf.SelectionFactory.JL(nd,
Sb-1,Sb):Kf.SelectionFactory.we(nd,Sb);pe.a.instance.J(7)&&this.Ki&&this.Ki.i9b&&be.ParagraphReader.ic(nd)&&this.Ki.S2d&&((Sb=this.Ki.S2d.Sgo)&&this.HM.QK(Sb,nd,!0),(Sb=this.Ki.S2d.jen)&&this.paragraphEditor.Nih(nd,Sb));ta.Qh(this.tlb);return!0};this.p1n=ta=>{const Pa=yd.GraphIterator.$a(this.Zij);Pa.wE(1);this.Ki.h_a=Kf.SelectionFactory.Un(Pa.currentNode,!1);ta.Qh(this.tlb);return!0};this.tlb=()=>{var ta=void 0===this.Ki.Jy||null===this.Ki.Jy?"not available":Object(zt.a)(Nz.a,this.Ki.Jy);w.ULS.sendTraceTag(8765523,
307,50,"PasteTeardown: {0} [{1}].",this.Ki.Jy,ta);w.ULS.shipAssertTag(6305497,307,!!this.Ki.h_a);this.yQc?Object(Ub.a)("ExternalPasteAction",!0):Object(Ub.a)("InternalPasteAction",!0);Gn.$T&&this.OQa&&(ta=new yd.GraphIterator,this.OQa.restore(ta),this.OQa=null,this.T4l(ta));this.transaction.dispose();ta=this.Ht.Jt;if(!ta.ue||!ta.editingView.Kj)return!1;ta.editingView.yko();return!1};this.eEa=b;this.Wdf=this.OQa=null;this.Ki=h;this.transaction=u;this.AY=y;this.Ht=P;this.v5=aa}get K(){return r.AFrameworkApplication.K}get TGe(){return!!this.K&&
this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get LF(){return null!=this.upg?this.upg:this.upg=Ja.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.vj&&this.vj.isProgressiveStyleEnabled}get HM(){return null!=this.Lyg?this.Lyg:this.Lyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get nc(){return null!=this.ozg?this.ozg:this.ozg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.$ug?this.$ug:this.$ug=
Ja.a.instance.resolve("Box4.IParagraphEditor")}get hd(){return null!=this.Gtg?this.Gtg:this.Gtg=Ja.a.instance.resolve("Box4.List.IListReader")}get xn(){return null!=this.rtg?this.rtg:this.rtg=Ja.a.instance.resolve("Box4.List.IListEditor")}get Oma(){return null!=this.dqg?this.dqg:this.dqg=Ja.a.instance.resolve("Box4.IBox4GraphWriter")}get j4c(){return null!=this.ewg?this.ewg:this.ewg=Ja.a.instance.Pa("Box4.List.ISingleLevelListEditor")}get Dj(){return null!=this.Oxg?this.Oxg:this.Oxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Dh(){return null!=
this.nyg?this.nyg:this.nyg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Kd(){return null!=this.Xxg?this.Xxg:this.Xxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get wW(){return null!=this.jmg?this.jmg:this.jmg=Ja.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get SPf(){return null!=this.mvg?this.mvg:this.mvg=Ja.a.instance.Pa("Box4.IPastedParagraphSpaceHandler")}get jLi(){return!1}get k$i(){return this.K.$("WordEditorAutoResizeImageIsEnabled")}uLh(){}get yQc(){return!1}ZKi(b){var h=
void 0===this.Ki.Jy||null===this.Ki.Jy?"not available":Object(zt.a)(Nz.a,this.Ki.Jy);w.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Ki.Jy,h);w.ULS.shipAssertTag(6305487,307,Se.SelectionEditor.pf(this.eEa));if(this.A_d)return w.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Ki.h_a=Kf.SelectionFactory.Vn(this.eEa),b.Qh(this.tlb),!0;if(!this.eEa.node)return w.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new yd.GraphIterator;
h.set(this.eEa.node);Se.SelectionEditor.eu(h);og.OutlineElementNavigator.$d(h);this.Zij=h.origin;if(this.jLi)return h.ut(10),this.uLh(h,b),b.Qh(this.p1n),!0;this.AY&&this.AY.e1m(this.eEa);if(!this.aeo(this.eEa))return this.Ki.LQ&&(this.Ki.LQ.fail("SplitLine Failed",!0),this.Ki.failed=!0),this.Ki.h_a=Kf.SelectionFactory.Vn(this.eEa),b.Qh(this.tlb),!0;const u=new Hi.a;u.ed(h);og.OutlineElementNavigator.Jr(u,!1,!1);this.OQa=new Vy.a(h);this.Wdf=new Vy.a(u);b.Qh(this.pfn);return!0}iaj(){return!1}get fli(){return this.K.$("PptCcpFix2IsEnabled")}get g6n(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}Nom(b,
h){return!h&&!!b&&wg.OutlineElementReader.Oh(b.sua)&&wg.OutlineElementReader.Gdb(b.sua)}lrm(b,h){return!h&&!!b&&wg.OutlineElementReader.Oh(b.ljb)&&wg.OutlineElementReader.Gdb(b.ljb)}Uin(b){Gn.RMi&&b&&Gn.RMi.Imn(b)}F6n(b,h,u){var y;wj.ListReader.lj(b)?(null===(y=this.j4c)||void 0===y?void 0:y.Srf(b),h=wj.ListReader.lj(h)?this.A$i:!0):wg.OutlineElementReader.isEmpty(b,!0)&&!u?(Gn.ih.KZa(b),h=!1):h=!0;this.AY&&(h=this.AY.eEk(b,h));return h}G6n(b,h){return wj.ListReader.lj(b)||1===h?!0:!1}ETm(b,h,u,y){const P=
wj.ListReader.lj(b);if(P){if(y=new Hi.a,y.ed(b),og.OutlineElementNavigator.Jr(y,!1,!1),y.Hn.id!==h.Hn.id){u=this.hd.Qu(b);this.hd.fG(b);var aa=b.currentNode.ia(Lc.a.listID,0);b.qc();var ta=this.hd.Hcj,Pa=!0;for(u.gB=Nf.a.Cj;y.currentNode.id!==h.currentNode.id;){if(!ta||!wg.OutlineElementReader.g8n(y))if(!wj.ListReader.lj(y))({LDa:u}=this.xn.Psa(u.propertySet,y,u)),Pa=!1;else if(P){Pa=this.hd.bkf(y);var vb=this.hd.hx(b.currentNode,aa,Pa);vb=vb?Sr.a.F2(vb,null):u;Pa=Sr.a.KP(vb.listType,u.listStyle,
null,0,Pa,"","");Pa.pkb=b.currentNode;this.xn.X_n(Pa);this.xn.Fae(y,!0);Pa=!1}og.OutlineElementNavigator.Jr(y,!1,!1)}ta&&Pa&&this.xn.Cpk()}}else if(1===u)for(u=new Hi.a,u.ed(b),og.OutlineElementNavigator.Ee(u),b=be.ParagraphReader.rh(u)?u.currentNode:null,aa=this.nc.GMd(u),og.OutlineElementNavigator.$d(u),og.OutlineElementNavigator.Jr(u,!1,!1);u.currentNode.id!==h.currentNode.id;)og.OutlineElementNavigator.Ee(u),ta=be.ParagraphReader.rh(u)?u.currentNode:null,og.OutlineElementNavigator.$d(u),ta&&b&&
y&&(aa&&this.HM.QK(aa,ta,!0),this.v5.Txi(b,ta,P),this.v5.a3a(b,ta,1,!0)),og.OutlineElementNavigator.Jr(u,!1,!1)}qnk(b,h,u){var y=!1;if(this.Kd.zg)if(Fj.a.er)y=!0;else{var P=!1;this.AY&&(P=h.currentNode,P=this.AY.Dtm(P)||this.AY.rxf(P));P?this.Kd.T3a=4:y=!0}if(y){for(;b.currentNode!==u.currentNode;){og.OutlineElementNavigator.Ee(b,!1);y=this.Dh.w4c(nf.a.create(b.currentNode));let aa;({type:aa}=y.gNd()).returnValue&&this.Kd.Ds(aa);for(P=0;P<y.length;P++){let ta;const Pa=({kVd:ta}=y.getContext(P)).returnValue;
ta&&(Gn.hyperlinkEditor.jkb(Pa,1),this.Dj.Xmb(Pa,1,null,!0))}b.qc();og.OutlineElementNavigator.Jr(b,!1,!1)}b.ed(h);og.OutlineElementNavigator.Jr(b,!1,!1)}}DUl(b,h){b=yd.GraphIterator.$a(b);og.OutlineElementNavigator.Ee(b);return be.ParagraphReader.ic(b.currentNode)?(h=h?be.ParagraphReader.textLength(b.currentNode):0,Kf.SelectionFactory.we(b.currentNode,h)):xh.TableReader.yX(b.currentNode)?Kf.SelectionFactory.kq(b.currentNode):null}T4l(b){if(b){if(this.yQc&&xh.TableReader.Jw(b)&&this.dSg){if(null!=
this.Kye&&0==this.Kye){var h=new Hi.a;h.ed(b);og.OutlineElementNavigator.Jr(h,!1,!1);b.ed(h)}h=mq.a.qIn(b);const u=be.ParagraphReader.Il(h);h&&u&&(this.Ki.h_a=Kf.SelectionFactory.we(u,0),b=yd.GraphIterator.$a(h))}else Gn.ytm&&mq.a.xfn(b);b&&xh.TableReader.Jw(b)&&wf.returnToContainingCell(b)&&mq.a.Chk(b.currentNode)}else w.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}i5n(b,h){const u=new yd.GraphIterator;u.ed(b);b=og.OutlineElementNavigator.Ee(u);h=be.ParagraphReader.ic(b)&&
h===be.ParagraphReader.textLength(b);w.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}aeo(b){var h;w.ULS.shipAssertTag(6305498,307,Se.SelectionEditor.pf(b));if(null===(h=this.Oma)||void 0===h?0:h.splitParagraph)return!!this.Oma.splitParagraph(b.node,b.cpBegin);h=yd.GraphIterator.$a(b.node);var u=h.zd();og.OutlineElementNavigator.$d(h);u&&b.isValid||w.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:u,["ipContextNodeType"]:b.node.type,
["isValidIpContext"]:b.isValid});if(!wg.OutlineElementReader.Oh(h)&&(w.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;u=Gn.ih.bna(h,!0);const y=this.i5n(h,b.cpBegin);Gn.ih.P8(h,u,b,!1,!1,!0,y);return!0}static get hyperlinkEditor(){return null!=Gn.jqg?Gn.jqg:Gn.jqg=Ja.a.instance.resolve("Box4.IHyperlinkEditor")}static get Te(){return se.PageReader.instance}static get ih(){return null!=Gn.lug?Gn.lug:Gn.lug=
Ja.a.instance.resolve("Box4.IOutlineElementEditor")}static get hh(){return Rt.a.getInstance()}static get $b(){return null!=Gn.Hog?Gn.Hog:Gn.Hog=Ja.a.instance.Pa("Box4.IFeatureHelper")}static get RMi(){return null!=Gn.rvg?Gn.rvg:Gn.rvg=Ja.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get Efn(){return null!=Gn.lvg?Gn.lvg:Gn.lvg=Ja.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get $T(){null==this.kL&&(r.AFrameworkApplication.Ce("he991617;3eed2178"),
this.kL=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.kL}static get ytm(){null==this.Aze&&(r.AFrameworkApplication.Ce("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.Aze=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.Aze}}Gn.kL=null;Gn.Aze=null;
Object(m.a)(Gn,"APasteExecutionManager",null,[]);class ws{constructor(b){this.Nj=b}reset(){this.Nj.reset()}get $Fc(){return this.Nj.$Fc}Cba(b,h){this.Nj.Cba(b,h)}iFa(b){this.Nj.iFa(b)}Skb(b){this.Nj.Skb(b)}rwa(b){this.Nj.rwa(b)}dFa(b){this.Nj.dFa(b)}oQa(b,h){this.Nj.oQa(b,h)}nQa(){this.Nj.nQa()}iG(b){this.Nj.iG(b)}hG(){this.Nj.hG()}Pkb(){this.Nj.Pkb()}Okb(){this.Nj.Okb()}lFa(b){this.Nj.lFa(b)}jFa(){this.Nj.jFa()}sQa(b){this.Nj.sQa(b)}kFa(){this.Nj.kFa()}A3a(b){this.Nj.A3a(b)}Bba(b){this.Nj.Bba(b)}yba(){this.Nj.yba()}Aba(b){this.Nj.Aba(b)}zba(){this.Nj.zba()}xba(b){this.Nj.xba(b)}wba(){this.Nj.wba()}tQa(b,
h){this.Nj.tQa(b,h)}x3a(){this.Nj.x3a()}}Object(m.a)(ws,"AHtmlNormalizer",null,[179,180]);class Oz extends ws{constructor(b){super(b);this.kJ=!1}Cba(b,h){this.kJ?this.qM.OL(()=>{this.PSf(b,h)}):this.PSf(b,h)}PSf(b,h){this.Nj.Cba(b,h)}iFa(b){this.kJ?this.qM.OL(()=>{this.sSf(b)}):this.sSf(b)}sSf(b){this.Nj.iFa(b)}rwa(b){this.kJ?this.qM.OL(()=>{this.RYc(b)}):this.RYc(b)}RYc(b){this.Nj.rwa(b)}dFa(b){this.kJ?this.qM.OL(()=>{this.rSf(b)}):this.rSf(b)}rSf(b){this.Nj.dFa(b)}oQa(b,h){this.kJ?this.qM.OL(()=>
{this.mSf(b,h)}):this.mSf(b,h)}mSf(b,h){this.Nj.oQa(b,h)}nQa(){this.kJ?this.qM.OL(Object(v.a)(this,this.lSf,"processAnchorEnd")):this.lSf()}lSf(){this.Nj.nQa()}iG(b){this.kJ?this.qM.OL(()=>{this.CSf(b)}):this.CSf(b)}CSf(b){this.Nj.iG(b)}hG(){this.kJ?this.qM.OL(Object(v.a)(this,this.BSf,"processParagraphEnd")):this.BSf()}BSf(){this.Nj.hG()}Pkb(){this.kJ?this.qM.OL(Object(v.a)(this,this.ESf,"processPreFormattedTextStart")):this.ESf()}ESf(){this.Nj.Pkb()}Okb(){this.kJ?this.qM.OL(Object(v.a)(this,this.DSf,
"processPreFormattedTextEnd")):this.DSf()}DSf(){this.Nj.Okb()}lFa(b){this.kJ?this.qM.OL(()=>{this.wSf(b)}):this.wSf(b)}wSf(b){this.Nj.lFa(b)}jFa(){this.kJ?this.qM.OL(Object(v.a)(this,this.tSf,"processListEnd")):this.tSf()}tSf(){this.Nj.jFa()}sQa(b){this.kJ?this.qM.OL(()=>{this.vSf(b)}):this.vSf(b)}vSf(b){this.Nj.sQa(b)}kFa(){this.kJ?this.qM.OL(Object(v.a)(this,this.uSf,"processListItemEnd")):this.uSf()}uSf(){this.Nj.kFa()}Bba(b){this.kJ?this.qM.OL(()=>{this.OSf(b)}):this.OSf(b)}OSf(b){this.Nj.Bba(b)}yba(){this.kJ?
this.qM.OL(Object(v.a)(this,this.LSf,"processTableEnd")):this.LSf()}LSf(){this.Nj.yba()}Aba(b){this.kJ?this.qM.OL(()=>{this.NSf(b)}):this.NSf(b)}NSf(b){this.Nj.Aba(b)}zba(){this.kJ?this.qM.OL(Object(v.a)(this,this.MSf,"processTableRowEnd")):this.MSf()}MSf(){this.Nj.zba()}xba(b){this.kJ?this.qM.OL(()=>{this.KSf(b)}):this.KSf(b)}KSf(b){this.Nj.xba(b)}wba(){this.kJ?this.qM.OL(Object(v.a)(this,this.JSf,"processTableCellEnd")):this.JSf()}JSf(){this.Nj.wba()}tQa(b,h){this.kJ?this.qM.OL(()=>{this.xSf(b,
h)}):this.xSf(b,h)}xSf(b,h){this.Nj.tQa(b,h)}x3a(){this.kJ?this.qM.OL(Object(v.a)(this,this.COi,"processMathEnd")):this.COi()}COi(){this.Nj.x3a()}}Object(m.a)(Oz,"AQueuingHtmlNormalizer",ws,[]);var EB=c(1890);class At{constructor(){this.pIe=new EB.a}OL(b){this.pIe.enqueue(b)}flush(b=!1){for(b&&this.W$d();!this.pIe.isEmpty;)this.pIe.dequeue()();b&&this.U8d()}W$d(){}U8d(){}}Object(m.a)(At,"QueuedEventManager",null,[]);class Mw extends At{constructor(b){super();this.id=void 0;this.f6e=null;this.yTd=
!1;this.IQa="";this.xTd=this.oUd=!1;this.V5e=this.M1b=null;this.BVc=0;this.gRc=this.BSc=this.$yf=!1;this.table=null;this.hIf=0;this.SY=b}get YAc(){return!!this.table}W$d(){this.SY.Ccc.push(this.SY.currentState);this.SY.currentState=this}U8d(){this.SY.currentState=this.SY.Ccc.pop()}}Mw.nextId=void 0;Object(m.a)(Mw,"ContentState",At,[]);class cy{constructor(b,h,u){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.b2a=b.b2a;this.shadingColor=b.shadingColor;this.verticalAlignment=
b.verticalAlignment;this.jia=b.jia;this.Gee=b.Gee;this.J9b=b.J9b;this.q6=b.q6;this.contents=u;this.q0l=h}}Object(m.a)(cy,"TableCell",null,[]);var fv=c(1632),gC=c(1633);class Pz extends At{constructor(b,h){super();this.SY=b;this.R7g=new rs.a;this.rqa=new rs.a;this.CDe=[];this.Rod=[];this.DIa=-1;this.aUa=0;this.JQj=h.Rgi;this.IQj=h.Nkm;this.i4j=h.Y8f;this.Bq=h.width;this.SRg=h.b2a;this.XNj=new uq.a(new br(h.g8.kbi,h.g8.KPd),h.SA,h.roa,h.cultureName,h.PAa);this.FPj=h.vQd;this.urd=h.styleId;this.o4j=
h.tableLook}get Nj(){return this.SY.Nj}ikn(b){this.DIa++;this.R7g.add(b);this.Rod[this.DIa]=b.height;this.aUa=0}get fZk(){for(;this.aUa>=this.rqa.count;)this.rqa.add(Array(this.DIa+1));return this.rqa.J(this.aUa)}N9j(b,h,u,y,P,aa,ta){if(0>this.DIa)return!1;for(;this.CDe[this.aUa]>=this.DIa;)this.aUa++;b=new cy(b,new uq.a(h,u,y,P,aa),ta);this.fZk[this.DIa]=b;if(1<b.rowSpan)for(h=this.DIa+b.rowSpan-1,y=this.aUa,u=this.aUa+b.colSpan-1;y<=u;y++)this.CDe[y]>=h||(this.CDe[y]=h);this.aUa+=b.colSpan;this.Rod[this.DIa]<
b.height&&(this.Rod[this.DIa]=b.height);return!0}W$d(){this.SY.currentState.table=this}U8d(){this.SY.currentState.table=null}fPh(){this.flush(!0);const b=this.DIa+1;var h=Array(b);for(var u=0;u<b;u++)h[u]=Array(this.rqa.count);u=!0;var y=0;for(var P=0;P<this.rqa.count;P++){var aa=this.rqa.J(P),ta=!0;for(var Pa=0;Pa<b;Pa++){var vb=aa[Pa];vb&&(ta=!1,h[Pa][P+y]=new bq(vb.colSpan,vb.rowSpan,vb.width,vb.height,void 0,void 0,void 0,void 0,vb.b2a,vb.J9b))}ta?(this.rqa.removeAt(P),P--,++y):u=!1}if(!u){(h=
this.SRg?this.SY.$oh(h,this.Bq/100):this.SY.$oh(h))&&h.length!==this.rqa.count&&(h=null);this.SY.Ueb(!0);this.SY.pzd();this.Nj.Bba(new Xj(b,this.rqa.count,this.Bq,this.SRg,h,this.JQj,this.IQj,this.i4j,this.FPj,this.urd,this.o4j,this.XNj));for(h=0;h<b;h++){u=this.R7g.J(h);this.Nj.Aba(new Ph(this.Rod[h],new uq.a(u.g8,u.SA,u.roa,u.cultureName,u.PAa)));for(u=0;u<this.rqa.count;u++){y=this.rqa.J(u)[h];var Kb=!!this.urd&&""!==this.urd&&"Custom"!==this.urd;P=y?y.colSpan:0;aa=y?y.rowSpan:0;ta=y?y.width:0;
Pa=y?y.height:0;vb=y?y.q6:0;const Sb=y?y.b2a:!1,Yb=y&&(65536&vb||!Kb)?y.shadingColor:"",Ac=y?y.verticalAlignment:0,Sc=y?y.J9b:!1;Kb=y?this.SY.PLl(y.jia,u,h,this.rqa,Kb,y.q6):new fv.a;const nd=y?y.Gee:new gC.a,Ad=y?y.q0l:null;this.Nj.xba(new bq(P,aa,ta,Pa,Yb,Ac,Kb,nd,Sb,Sc,vb,new uq.a(Ad?Ad.g8:null,Ad?Ad.SA:null,Ad?Ad.roa:null,Ad?Ad.cultureName:null,Ad?Ad.PAa:null)));y&&!y.J9b&&(y.contents.W$d(),y.contents.flush(),this.SY.Ueb(!1),this.SY.pzd(),y.contents.U8d());this.Nj.wba()}this.Nj.zba()}this.Nj.yba();
this.SY.currentState.gRc=!1;this.SY.lKh(!1)}}}Object(m.a)(Pz,"NormalizedTable",At,[]);class dy{constructor(b=!1,h=!1){this.uRj=b;this.R1=h}get Aqm(){return this.uRj}get yca(){return this.R1}}Object(m.a)(dy,"HtmlNormalizerSettings",null,[253]);class Ls extends Oz{constructor(b,h=null){super(b);this.Ccc=new lo;this.uTb=h||new dy}reset(){super.reset();this.currentState=new Mw(this);this.Ccc.clear();this.kJ=!1}get qM(){return this.currentState&&this.currentState.YAc?this.currentState.table:this.currentState}nFd(b=
!1){this.currentState.yTd||(this.pzd(),this.Nj.iG(this.currentState.f6e),this.currentState.yTd=!0,this.currentState.gRc=!1);b||!this.currentState.M1b||this.currentState.xTd||(this.Nj.oQa(this.currentState.M1b,this.currentState.V5e),this.currentState.xTd=!0)}THc(){this.currentState.xTd&&(this.Nj.nQa(),this.currentState.xTd=!1)}ccl(){this.currentState.yTd&&(this.Nj.hG(),this.currentState.yTd=!1,this.currentState.IQa="")}lKh(b){this.currentState.BSc&&(this.currentState.gRc?b||(this.Nj.iG(null),this.Nj.hG(),
this.Nj.kFa(),this.currentState.BSc=!1):(this.Nj.kFa(),this.currentState.BSc=!1,this.currentState.gRc=!0))}Ueb(b){this.THc();this.ccl();this.lKh(b)}$an(b){this.Nj.lFa(new Kt.a(2,1,b));this.currentState.BVc++;this.currentState.$yf=!0}pzd(){!this.currentState.BSc&&this.currentState.$yf&&(this.Nj.jFa(),this.currentState.BVc--,this.currentState.$yf=!1)}PSf(b,h){b=this.IYm(b);if(""!==b)if(this.nFd(),this.currentState.oUd)this.QSf(b,h);else{b=b.split(Ls.yxk);for(let u=0;u<b.length-1;u++)this.QSf(b[u],h),
this.Nj.Skb(h);this.QSf(b[b.length-1],h)}}xSf(b,h){""!==b&&(this.nFd(),this.Nj.tQa(b,h))}sSf(b){this.uTb.yca||this.THc();this.nFd(!0);this.Nj.iFa(b)}rSf(b){this.currentState.YAc||this.Nj.dFa(b)}RYc(b){this.currentState.M1b&&(b.href=this.currentState.M1b);super.RYc(b)}mSf(b,h){this.THc();this.currentState.M1b=b;this.currentState.V5e=h}lSf(){this.THc();this.currentState.M1b=null;this.currentState.V5e=null}CSf(b){this.currentState.f6e=b;this.Ueb(!0)}BSf(){this.currentState.f6e=null;this.Ueb(!0)}ESf(){this.currentState.oUd=
!0}DSf(){this.currentState.oUd=!1}wSf(b){this.Ueb(!1);this.pzd();this.Nj.lFa(b);this.currentState.BVc++}tSf(){this.Ueb(!1);this.Nj.jFa();this.currentState.BVc--}vSf(b){this.Ueb(!1);this.currentState.BVc||this.$an(b);this.Nj.sQa(b);this.currentState.BSc=!0;this.currentState.gRc=!0}uSf(){this.Ueb(!1)}Bba(b){this.currentState.YAc||(this.kJ=!0,this.currentState.table=new Pz(this,b))}OSf(){}yba(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.Ccc.isEmpty?(this.kJ=
!1,b.fPh()):this.qM.OL(Object(v.a)(b,b.fPh,"flushTable"))}}LSf(){}Aba(b){this.currentState.YAc&&this.currentState.table.ikn(b)}NSf(){}zba(){}MSf(){}xba(b){let h=!1;if(this.currentState.YAc){const u=new Mw(this);this.currentState.table.N9j(b,new br(b.g8.kbi,b.g8.KPd),b.SA,b.roa,b.cultureName,b.PAa,u)?(this.Ccc.push(this.currentState),this.currentState=u):h=!0}else h=!0;h&&this.currentState.hIf++}KSf(){}wba(){0<this.currentState.hIf?this.currentState.hIf--:this.currentState=this.Ccc.pop()}JSf(){}$oh(b,
h=1){if(!b)return null;const u=b.length;if(!u)return null;const y=b[0].length;for(var P=1;P<u;P++)if(b[P].length!==y)return null;P=Array(y+1);P[0]=0;const aa=Array(y+1);for(var ta=0;ta<aa.length;ta++)aa[ta]=!1;ta=new ob.a;for(let vb=0;vb<y;vb++){for(var Pa=0;Pa<u;Pa++){const Kb=b[Pa][vb];if(Kb&&0<Kb.width){const Sb=Math.min(vb+Kb.colSpan,y);P[Sb]=P[vb]+Kb.width*(Kb.b2a?h:1);aa[Sb]=!0}}if(aa[vb+1]){Pa=P[vb+1]-P[vb];if(0>=Pa)return null;ta.add(Pa)}else P[vb+1]=P[vb]}return ta.toArray()}wRm(b,h){1&h||
(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}PLl(b,h,u,y,P,aa){if(!b)return null;P&&(b=this.wRm(b,aa));if(0>u||0>h||h>y.count-1)return b;0<=h-1&&u<=y.J(h-1).length-1&&1===b.borderLeftStyle&&(P=y.J(h-1)[u])&&1!==P.jia.borderRightStyle&&(b.borderLeftStyle=P.jia.borderRightStyle,b.borderLeftColor=P.jia.borderRightColor,b.borderLeftWidth=P.jia.borderRightWidth);0<=u-1&&u<=y.J(h).length-1&&1===b.borderTopStyle&&(h=y.J(h)[u-
1])&&1!==h.jia.borderBottomStyle&&(b.borderTopStyle=h.jia.borderBottomStyle,b.borderTopColor=h.jia.borderBottomColor,b.borderTopWidth=h.jia.borderBottomWidth);return b}IYm(b){this.currentState.oUd||(b=this.uTb.Aqm?b.replace(Ls.O9l," "):b.replace(Ls.N9l," "));b.startsWith(" ")&&(this.currentState.IQa.endsWith(" ")||""===this.currentState.IQa)&&(b=A.a.substring(b,1,b.length));return b}QSf(b,h){""!==b&&(this.Nj.Cba(b,h),this.currentState.IQa+=b)}}Ls.N9l=RegExp("[ \t\f\u200b\r\n]+","g");Ls.O9l=RegExp("[ \f\u200b\r\n]+",
"g");Ls.yxk="\t";Object(m.a)(Ls,"DefaultHtmlNormalizer",Oz,[]);class Wy extends Ls{constructor(b,h,u){super(b,u);this.dNg=!1;this.ysb=h}static cnm(b){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=Wy.Z2k.exec(b))&&0<b.length:!1}RYc(b){this.ysb.adc&&(r.AFrameworkApplication.Qna?this.dNg||(b=new Gh.StandardDialog,b.Ed=0,b.Ue(1,CommonUIStrings.l_DialogClose),b.xv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.dNg=!0):this.ysb.exi?this.ysb.cZd=!0:b.src&&""!==b.src?Fa.a.getOrigin(b.src)!==Fa.a.getOrigin(window.location.href)||Wy.cnm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?r.AFrameworkApplication.ya.processAction(Oa.a.eLi,2):b.src.startsWith("webkit-fake-url")?r.AFrameworkApplication.ya.processAction(Oa.a.dLi,2):(this.THc(),this.nFd(!0),this.Nj.rwa(b)):r.AFrameworkApplication.ya.processAction(Oa.a.gLi,2):r.AFrameworkApplication.ya.processAction(Oa.a.fLi,2))}}Wy.Z2k=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(m.a)(Wy,"Box4HtmlNormalizer",Ls,[]);class ox{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.htmlProcessor=b;this.urf=h;this.uCk=u;this.Gtj=y;this.qol=P;this.vSn=aa;this.wSn=ta;this.JPd=Pa;this.H9l=vb;this.J9l=Kb;this.kEm=Sb}}Object(m.a)(ox,"ExecutePasteArguments",null,[]);class Tr extends Gn{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad){super(h,u,y,Kb,Yb,nd);this.Aja=null;this.BYm=he=>{this.Jfd.rqi(this.Qja)&&r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.n2j&&this.Jfd.Tpo(this.Qja);he.Qh(this.nkn);return!0};this.nkn=he=>{if(this.B1j){const ce=this.Qja.getElementsByTagName("style");if(ce&&0<ce.length){w.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let Nd=0;Nd<ce.length;Nd++)this.Mte.tPk(this.Qja,ce[Nd]),ce[Nd]&&(ce[Nd].parentNode.removeChild(ce[Nd]),Nd--)}}he.Qh(this.KPk);return!0};this.KPk=(he,ce)=>{this.$Qe.value.create(ce.Gtj).process(this.Qja,he);(ce=Ja.a.instance.Pa("Box4.IFeatureHelper"))&&
ce.isFeatureEnabled(11)?he.Qh(this.NOk):he.Qh(this.uOi);return!0};this.NOk=(he,ce)=>{(new Qt(ce.uCk)).process(this.Qja,he);he.Qh(this.uOi);return!0};this.uOi=(he,ce)=>{ce.htmlProcessor.process(this.Qja,he);he.Qh(ce.urf&&ce.urf.adc?this.$Kb:this.xJh);return!0};this.$Kb=(he,ce)=>{if(ce=ce.urf){let Nd=!1,re=!1,Xd=!1,vg=!1,Vf=-1;const kj=new uh.DictionaryPropertySet,zm=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(jb.a)(105,this.Ki.vd)){Nd=this.Ki.vd.ia(Lc.a.ega,!1);const rm=this.Ki.vd.ia(ld.a.PQ,
"");Xd=this.Ki.vd.ia(ld.a.B7,!1);vg=this.Ki.vd.ia(Ge.a.gga,!1);zm.test(rm)&&(re=!0);this.k$i&&(Vf=this.Ki.vd.ia(zi.a.$ea,-1))}else this.Ki.Jy&256&&this.Qja&&(Nd=!0,zm.test(this.Qja.innerHTML)&&(re=!0));kj.setValue(Lc.a.ega,Nd);kj.setValue(ld.a.ISc,re);kj.setValue(ld.a.B7,Xd);kj.setValue(zi.a.$ea,Vf);kj.setValue(Ge.a.gga,vg);ce.rae(kj);ce.HMf();ce.mkb&&(this.Ki.XQc=!0,this.Ki.Qrf=ce.WS,this.Ki.rJf=ce.mkb,Nd&&!Xd&&Ub.c(Oa.a.efl),r.AFrameworkApplication.ya.processAction(Oa.a.$Kb,2))}he.Qh(this.xJh);
return!0};this.xJh=(he,ce)=>{Mq.a.LOm(ce.Gtj);Mq.a.dKm(ce.J9l);Mq.a.jNm(ce.vSn);Mq.a.kNm(ce.wSn);Mq.a.HKm(ce.kEm);he="Others";ce.JPd&&(ce.JPd.aKm(),ce.JPd.bKm(),he=ce.JPd.F6f);Mq.a.cKm(ce.H9l,he);Mq.a.HJm(ce.qol,he);return!1};this.Qja=b;this.Hne=P;this.rxe=aa;this.ONe=ta;this.$Qe=Pa;this.grc=vb;this.uTb=Sc;this.Ma=Sb;this.SNg=Object.assign(new Fs,{n8b:2===this.Ki.g1b||3===this.Ki.g1b});this.Mte=Ac;this.Jfd=Ad;this.cXb=Sb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.B1j=Sb.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.n2j=Sb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get A_d(){return!1}get yQc(){return!0}tLh(b){this.Aja=new yd.GraphIterator;this.OQa.restore(this.Aja);w.ULS.shipAssertTag(6305550,307,wg.OutlineElementReader.Oh(this.Aja));this.Ki.LQ&&this.Ki.LQ.MZb("external");var h=this.Ki.Jy&8192?1:0,u=this.rxe.value.create(h,this.Aja,this.Ki.DDc,this.Ki.lmb);const y=this.ONe.value.create(h,this.Aja),P=Mq.a.NTh(r.AFrameworkApplication.userSessionId),aa=Mq.a.iof(r.AFrameworkApplication.userSessionId),ta=Mq.a.Zif(ba.a.ryb,
this.Ki.DDc),Pa=Mq.a.b4h(r.AFrameworkApplication.userSessionId),vb=Mq.a.c4h(r.AFrameworkApplication.userSessionId),Kb=this.cXb?this.Ndm():null,Sb=Mq.a.qYh(ba.a.ryb,this.Ki.DDc),Yb=Mq.a.rYh(r.AFrameworkApplication.userSessionId),Ac=this.grc.i$i?Mq.a.VIl(r.AFrameworkApplication.userSessionId):null;h=this.Hne.value.create(h,this.Aja,u,y,null,ta,this.mjk);h=new Fo(h,Pa,vb);h=new Wy(h,u,this.uTb);h=new El(h,this.grc,this.SNg,Ac);h=new Sm(h,Sb,Kb,this.Ma);h=new is(h,Yb);u=new ox(h,u,P,aa,ta,Pa,vb,Kb,Sb,
Yb,Ac);u=new ou.a(b,this.BYm,u);u.il("paste and request pictures");u.wg=!b||b.wg;u.run()}get mjk(){return this.Qja.getElementsByTagName("a").length}Ndm(){const b=new Uy;b.Tcc=ba.a.ryb;this.Ki&&(b.Jy=this.Ki.Jy,b.lOf=this.Ki.DDc,this.Ki.vd&&(b.progId=this.Ki.vd.ia(ld.a.cLi,"")));this.Qja&&this.Qja.innerHTML&&(b.Ffn=this.Qja.innerHTML.length);r.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=r.AFrameworkApplication.sessionStartInfoSettings.Platform);return b}get A$i(){return!0}get z3c(){w.ULS.shipAssertTag(6305551,
307,!!this.Aja);if(this.grc.j$i(this.SNg)){let b=!1;wg.OutlineElementReader.Oh(this.Aja)&&(this.Aja.Haa(),b=!0);const h=be.ParagraphReader.rh(this.Aja)&&!this.Aja.currentNode.ia(ld.a.Rii,!1);b&&this.Aja.qc();return h}return be.ParagraphReader.rh(this.Aja)}}Object(m.a)(Tr,"ExternalPasteExecutionManager",Gn,[]);class Nw{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.Hne=b;this.rxe=h;this.ONe=u;this.$Qe=y;this.grc=P;this.AY=aa;this.Ma=ta;this.Mte=Pa;this.uTb=vb;this.v5=Kb;this.Jfd=Sb}create(b,h,u,y){return new Tr(b,
h,u,y,this.Hne,this.rxe,this.ONe,this.$Qe,this.grc.value,this.AY,this.Ma,Ra.App.xa.jb,this.Mte,this.uTb,this.v5,this.Jfd)}}Object(m.a)(Nw,"Factory",null,[573]);class FB{rqi(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.aom(b.childNodes[h-2])&&this.jzm(b.childNodes[h-1])}Tpo(b){this.rqi(b)&&(b.removeChild(b.lastChild),w.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}Hlm(b){return!!b&&8===b.nodeType}Exm(b){return!!b&&3===b.nodeType}aom(b){return this.Hlm(b)&&
"EndFragment"===b.nodeValue}jzm(b){if(!this.Exm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(m.a)(FB,"HtmlNormalizerHelper",null,[571]);var Kl=c(1879),GB=c(646);class Bt extends Gn{constructor(b,h,u,y,P,aa,ta,Pa){super(b,h,u,P,aa,Pa);this.Bz=y;this.YH=ta}get ml(){return this.YH.value}get A_d(){return this.Bz.A_d()}get jLi(){const b=this.Bz;return b.E2e&&!b.gfi()}uLh(b,h){w.ULS.shipAssertTag(6305616,307,Jf.OutlineReader.Kw(b));const u=GB.a(b.currentNode);if(Jf.OutlineReader.isEmpty(b)){var y=
nf.a.create(b.currentNode);b.ut(8);r.AFrameworkApplication.ya.Tf(y,Oa.a.gH,2,!0,null,null)}else b.ut(8);(y=b.wE(1))&&b.qc();this.Bz.UKi(this.Ki.ye,b.currentNode,y,-1,u,h)}tLh(b){const h=new yd.GraphIterator;this.OQa.restore(h);w.ULS.shipAssertTag(6305618,307,wg.OutlineElementReader.Oh(h));this.Ki.LQ&&this.Ki.LQ.MZb("internal");let u=-1;if(this.k$i&&Object(jb.a)(105,this.Ki.vd))u=this.Ki.vd.ia(zi.a.$ea,-1);else{const y=this.Ezl(h.currentNode);u=y?y.clientWidth:u}this.Bz.UKi(this.Ki.ye,h.parentNode,
h.currentNode,u,null,b);this.fli&&(this.OQa.restore(h),wg.OutlineElementReader.Oh(h)&&this.Bz.ooi(h)&&(b=og.OutlineElementNavigator.Ee(h)))&&(this.Ki.h_a=Kf.SelectionFactory.we(b,0))}Ezl(b){return b?(b=b?b.xe(this.ml.Sb):null)?b.htmlElement:null:null}iaj(){const b=new yd.GraphIterator;this.OQa.restore(b);return this.Bz.ooi(b)}get A$i(){return!0}get z3c(){return!this.Bz.hua&&!this.Bz.E2e}}Object(m.a)(Bt,"InternalPasteExecutionManager",Gn,[]);class px{constructor(b,h,u,y){this.Bz=b;this.AY=h;this.YH=
u;this.v5=y}create(b,h,u){return new Bt(b,h,u,this.Bz,this.AY,Ra.App.xa.jb,this.YH,this.v5)}}Object(m.a)(px,"Factory",null,[568]);var gv;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(gv||(gv={}));Object(m.b)("CopySource",gv);class ey{constructor(b,h,u){this.Bz=b;this.ePg=h;this.iLj=u}lfn(b,h,u){w.ULS.shipAssertTag(6305620,307,!!b);w.ULS.shipAssertTag(6305621,
307,Se.SelectionEditor.pf(h));w.ULS.shipAssertTag(6305622,307,!!u);w.ULS.shipAssertTag(6305623,307,Object(jb.a)(wv.a,u.poa));const y=u.poa;y.g1b=this.Bz.fVh(b);this.tKm(b,y);const P=this.Pqm(y);var aa=new dg.GraphTransaction(7,Oa.a.paste);aa.Eb(h.node);h.node.BI().ZF.H$(8);P?(w.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",y.Jy,y.browserName),b=this.ePg.create(h,y,aa)):(w.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",y.Jy,y.g1b,y.browserName),
ey.kKm(b),b=this.iLj.create(b,h,y,aa));u=new ou.a(u,Object(v.a)(b,b.ZKi,"pasteSetup"),null);u.il("Paste");u.run()}Pqm(b){return!this.Btm(b)&&3===b.g1b}Btm(b){return 1===(b.Jy&8192?1:0)}nfi(b,h){w.ULS.shipAssertTag(6305624,307,Se.SelectionEditor.pf(b));w.ULS.shipAssertTag(6305625,307,!!h);w.ULS.shipAssertTag(6305626,307,Object(jb.a)(wv.a,h.poa));const u=new dg.GraphTransaction(7,Oa.a.oRd);u.Eb(b.node);b=this.ePg.create(b,h.poa,u);h=new ou.a(h,Object(v.a)(b,b.ZKi,"pasteSetup"),null);h.il("InternalPasteAtIp");
h.run()}tKm(b,h){if(b){let u=!1,y=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?y=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(u=!0);(u||y)&&w.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",gv[h.g1b],u,y)}}static kKm(b){b&&ey.w7j.test(b.innerText)&&w.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}ey.w7j=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(m.a)(ey,"PasteCoordinator",null,[]);class Xy{constructor(b,h,u,y,P){this.sua=b;this.ljb=h;this.Cfn=u;this.Bfn=y;this.yQc=P}}Object(m.a)(Xy,"PastedContentsPostProcessorParams",null,[]);class Dv{hem(b,h,u,y,P,aa){b=this.eDl(b,h,P);u=this.LHl(u);if(!b||!u)return null;y=this.MOl(b,y,P);P=this.LOl(u);return new Xy(b,u,y,P,aa)}eDl(b,h,u){b=u?b:h;if(!wg.OutlineElementReader.Oh(b))return null;h=new Hi.a;h.ed(b);return h}LHl(b){if(!wg.OutlineElementReader.Oh(b))return null;const h=new Hi.a;h.ed(b);
og.OutlineElementNavigator.u_(h,!1,!1);return h}MOl(b,h,u){og.OutlineElementNavigator.Ee(b);let y=-1;be.ParagraphReader.rh(b)&&(y=u?h:0);og.OutlineElementNavigator.$d(b);return y}LOl(b){og.OutlineElementNavigator.Ee(b);const h=be.ParagraphReader.rh(b)?be.ParagraphReader.textLength(b.currentNode):-1;og.OutlineElementNavigator.$d(b);return h}}Object(m.a)(Dv,"PastedContentsPostProcessorHelper",null,[]);var Hq=c(613),Ev=c(1068),Ff=c(1067);class Yy{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac=null){this.voa=
b;this.m8=h;this.Nq=u;this.yNi=y;this.ta=P;this.Q3a=aa;this.K=ta;this.qfn=Pa;this.Mba=vb;this.EDb=Kb;this.vta=Sb;this.Bb=Yb;this.lga=Ac;this.MCh=100;this.X9b=!1;this.Gqe=null;this.kze=!1;this.omd=null;this.kid=this.LJa=!1;this.Peo()}Peo(){this.m8.sfh(Object(v.a)(this,this.i$n,"showFloatieHandler"));this.m8.Zeh(Object(v.a)(this,this.Ull,"floatieDismissedHandler"))}cTk(b,h){var u,y,P;(null===(y=null===(u=this.Bb.hb)||void 0===u?void 0:u.kb)||void 0===y?0:y.DQc)?w.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.Q3a.rtf(),1===this.qfn.sTk(h.iYc)?w.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.LJa?this.LJa=!1:this.IBn(),this.E_c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Oa.a.qT(h.WX)||"Unknown",h.correlationId),w.ULS.sendTraceTag(40379588,307,50,b),Ub.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ca.a,{name:"PasteCommand",int64:Oa.a.qT(h.WX)||"Unknown"}),Object.assign(new ca.a,
{name:"CorrelationId",string:null===(P=h.correlationId)||void 0===P?void 0:P.toString()})]),this.DOb()):w.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}Ew(b){var h;!this.kze&&(this.LJa||(this.lga?null===(h=this.vta)||void 0===h?0:h.c_:this.voa.c_()))&&(b&&(this.Q3a.rtf(),this.Omj(),w.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.omd)),this.LJa=!b,this.ghe(),this.lga?r.AFrameworkApplication.ya.processAction(Oa.a.aEb,
2):this.voa.Ew())}IBn(){this.kid||(this.Gqe=this.Nq.od,rf.a.addHandler(this.Gqe.container,"scroll",Object(v.a)(this,this.ELb,"scrollHandler")),this.ta.jZ(Object(v.a)(this,this.zha,"resizeHandler")),this.kid=!0)}Omj(){this.kid&&(rf.a.removeHandler(this.Gqe.container,"scroll",Object(v.a)(this,this.ELb,"scrollHandler")),this.ta.Zba(Object(v.a)(this,this.zha,"resizeHandler")),this.kid=!1)}DOb(){if(this.lga)this.vta.c_&&r.AFrameworkApplication.ya.processAction(Oa.a.aEb,2),r.AFrameworkApplication.ya.processAction(Oa.a.X3c,
2),this.X9b=!1;else{const b=new Ff.a(0,r.AFrameworkApplication.isRtl);b.location=this.Q3a.QNa();this.Q3a.Uom(b.location)?this.showFloatie(null,b):this.m8.PFa(new Ev.a(!1))}}zha(){this.lga?(r.AFrameworkApplication.ya.processAction(Oa.a.aEb,2),this.UFc()):this.DOb()}ELb(){this.lga?(r.AFrameworkApplication.ya.processAction(Oa.a.aEb,2),this.UFc()):this.DOb()}Ull(b,h){this.Ew(h.Qhl)}i$n(b,h){this.cTk(b,h)}E_c(){this.yNi.ofk(Object(v.a)(this,this.vFi,"onOnlyKeyPressed"));this.m8.efh(Object(v.a)(this.voa,
this.voa.YFd,"expandFloatie"));this.m8.nfh(Object(v.a)(this,this.aLi,"pastedFloatieStatusChange"));this.Mba.mu(Object(v.a)(this,this.Wga,"onParagraphConnect"));this.Mba.Mv(Object(v.a)(this,this.KIb,"onParagraphDisconnected"));this.Mba.Ap(Object(v.a)(this,this.P3,"onParagraphPropertyChanged"))}ghe(){this.yNi.KFn(Object(v.a)(this,this.vFi,"onOnlyKeyPressed"));this.m8.xWi(Object(v.a)(this.voa,this.voa.YFd,"expandFloatie"));this.m8.FWi(Object(v.a)(this,this.aLi,"pastedFloatieStatusChange"));this.Mba.vU(Object(v.a)(this,
this.Wga,"onParagraphConnect"));this.Mba.yha(Object(v.a)(this,this.KIb,"onParagraphDisconnected"));this.Mba.YX(Object(v.a)(this,this.P3,"onParagraphPropertyChanged"))}aLi(b,h){this.kze=h.CQc;h.WX&&(this.omd=h.WX);h.g5f&&this.voa.c_()&&this.DOb()}P3(b,h){h.property===Ge.a.lastModifiedTime?(w.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.EDb.c6e.contains(Oa.a.Ycg)||this.IUf(h)):w.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")}KIb(b,
h){this.IUf(h)}Wga(b,h){h.Luf||this.IUf(h)}IUf(b){b.node.loading||this.m8.PFa(new Ev.a(!0))}showFloatie(b,h){h||(h=new Ff.a(0,r.AFrameworkApplication.isRtl));h.location||(h.location=this.Q3a.QNa());if(!h.location)return!1;this.LJa&&(this.LJa=!1,this.E_c());this.lga?r.AFrameworkApplication.ya.processAction(Oa.a.X3c,2):this.voa.showFloatie(b,h);return!0}UFc(){if(!this.X9b){const b=new sc.a(3,1,this.MCh,()=>{this.DOb()},215);lf.a.instance.Xb(b);this.X9b=!0}}vFi(){Hq.a.instance.keyCode===fb.a.jya&&this.m8.xQi()}}
Object(m.a)(Yy,"PasteFloatieEventManager",null,[]);class Zy{constructor(b,h){this.ak=b;this.JH=h}sTk(b){return Qj.any(Qj.where(Qj.asEnumerable(Zy.Dho),h=>this.JH.VRc(h)))?(b=this.ak.olb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Zy.Dho=[Oa.a.reformatPastedContent.toString(),Oa.a.eRa.toString(),Oa.a.Uwa.toString()];Object(m.a)(Zy,"PasteFloatieFeatureSetBuilder",null,[]);var QA=c(163);class $y{constructor(){this.lha=null;this.Wcc=0}}Object(m.a)($y,"PasteFloatieAnchorData",null,[]);class Yv{constructor(b,
h,u,y,P,aa=!1){this.rab=null;this.ib=b;this.gsa=h;this.fd=u;this.$Mj=y;this.PGe=P;this.Ize=aa}rtf(){this.rab=null}QNa(){const b=this.Qif(this.rab)||this.Moh();if(!b){let h="null",u="null";if(this.rab&&this.rab.lha){if(!this.fd.od)return w.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.rab.lha).getName();let y;(y=QA.a.BO?this.fd.od.gh(this.rab.lha):this.rab.lha.gh(this.fd.od.Sb))&&(u=Object.getType(y).getName())}w.ULS.shipAssertTag(40641054,
307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,u)}return b}Uom(b){if(!b)return!1;const h=this.PGe.rCb(),u=this.$Mj(this.fd.od.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=u.y&&b.y+b.height<=u.y+u.height}Moh(){if(!this.ib||!this.ib.hb||!this.ib.hb.kb)return w.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.ib.hb.kb.Qa,h=!b.cpBegin&&!b.cpEnd;let u=b.node;if(u&&h){do u=this.k2h(u);
while(u&&Object(jb.a)(ro.AParagraphNode,u)&&!u.characterData.trim().length)}let y="";const P=Object(na.a)(ro.AParagraphNode,u);P&&(y=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():P.characterData.substring(0,b.cpBegin).trimEnd());h=P?y.length:b.cpBegin;b=Object.assign(new $y,{lha:Object(na.a)(37,(P?Object(na.a)(37,P):Object(na.a)(37,u))||b.node),Wcc:h});return this.Qif(b)}k2h(b){const h=new yd.GraphIterator;if(!b.anchor)return null;h.set(b);if(!h.zd())return null;h.kd(11);return h.MI()?
h.Rb(2):null}Qif(b){if(!b||!b.lha)return null;this.rab=b;const h=this.fd.od;if(!h)return w.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.tYh(b,h);if(!b)return null;r.AFrameworkApplication.isRtl&&this.PGe.c_()&&(b.x-=this.PGe.rCb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}tYh(b,h){h=QA.a.BO?h.xe(b.lha):Object(na.a)(199,b.lha.gh(h.Sb));if(!h)return null;let u=null;if(Object(jb.a)(ro.AParagraphNode,b.lha)){const y=Object(na.a)(132,
h);if(!y)return null;try{u=this.gsa.pZ(b.Wcc,y,0<b.Wcc,!1,!1,!1),u.height+=this.Ize?Yv.Zsn:Yv.Xll}catch(P){w.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",P),u=null}}else Object(jb.a)(aq.TableNode,b.lha)&&(u=Object(na.a)(340,h).fnf());u||(u=h.getBounds());return u}}Yv.Xll=2;Yv.Zsn=60;Object(m.a)(Yv,"PasteFloatiePositionProvider",null,[]);class Ms{constructor(b,h){this.Doc=b;this.UGj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get wQh(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get B6e(){return CommonUIStrings.l_ClipboardCut}get MDf(){return CommonUIStrings.l_ClipboardCut_Mac}get z3e(){return CommonUIStrings.l_ClipboardCopy}get LDf(){return CommonUIStrings.l_ClipboardCopy_Mac}get PPf(){return CommonUIStrings.l_ClipboardPaste}get NDf(){return CommonUIStrings.l_ClipboardPaste_Mac}get n8(){return CommonUIStrings.l_ClipboardPasteText}get ODf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get J0e(){return this.UGj}get hth(){return CommonUIStrings.l_ClipboardExtensionLink}get qdb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}MLh(){w.ULS.sendTraceTag(8716421,
307,50,null);Je.a.en(this.J0e,"_blank",void 0,"ClipboardAccessExtensionLink")}aca(b,h){let u=ba.a.Kl;r.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(u=ba.a.zi||u);return u?String.format(h,"\u2318"):b}dispose(){this.Doc=null}WUf(b){this.$xh(b)}SCm(b){this.$xh(b)}$xh(b){this.Doc&&this.Doc(b)}}Ms.id="CopyPasteShortcutDialog";Ms.zhj="CopyPasteText";Object(m.a)(Ms,"ACopyPasteShortcutDialog",null,[9]);class RA extends Ms{constructor(b,h,u){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Ms.zhj;var y=document.createElement("span");y.innerText=this.wQh;var P=document.createElement("span");P.className="UIFontBold";P.innerText=this.aca(this.B6e,this.MDf);const aa=document.createElement("span");aa.className="UIFontBold";aa.innerText=this.aca(this.z3e,this.LDf);const ta=document.createElement("span");ta.className="UIFontBold";ta.innerText=this.aca(this.PPf,this.NDf);h.appendChild(y);h.appendChild(document.createElement("br"));
h.appendChild(P);h.appendChild(aa);h.appendChild(ta);u.$("PasteTextOnlyShortcutDialogIsEnabled")&&(ba.a.Wp||ba.a.kj)&&(u=document.createElement("span"),u.className="UIFontBold",u.innerText=this.aca(this.n8,this.ODf),h.appendChild(u));b.appendChild(h);this.J0e?(w.ULS.sendTraceTag(8716420,307,50,null),u=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.hth,rf.a.addHandler(h,"click",Object(v.a)(this,this.MLh,"extensionLinkHandler")),u.appendChild(h),P=this.qdb.indexOf("{0}"),
-1!==P&&(y=this.qdb.substring(0,P),P=this.qdb.substring(P+3,this.qdb.length),y=document.createTextNode(y),P=document.createTextNode(P),u.insertBefore(y,h),u.appendChild(P)),b.appendChild(document.createElement("br")),b.appendChild(u)):w.ULS.sendTraceTag(8716422,307,50,null);u=new Gh.StandardDialog;u.Ed=0;u.mg=Ms.id;u.xv(this.titleText,null,0,Object(v.a)(this,this.SCm,"legacyCopyPasteShortcutDialogHandler"),b);u.k4(Ms.zhj)}}Object(m.a)(RA,"CopyPasteShortcutDialog",Ms,[]);class qx extends Ms{constructor(b,
h){super(b,h);h={};b=this.xhm;h.extensionStartText=this.Uel;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.R4n;h.cutText=this.aca(this.B6e,this.MDf);h.copyText=this.aca(this.z3e,this.LDf);h.pasteText=this.aca(this.PPf,this.NDf);4!==r.AFrameworkApplication.ta.Pb.$n&&(h.pasteTextOnly=this.aca(this.n8,this.ODf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const u=new ff.a(!1,!1,!0);u.mg="CopyPasteInstallDialog";u.Ed=0;u.Ue(1,this.whm);u.DU(1);u.Wh(b,Object(v.a)(this,
this.WUf,"reactCopyPasteShortcutDialogHandler"),h)}get R4n(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get whm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get xhm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get Uel(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static U8n(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(m.a)(qx,"ReactCopyPasteInstallDialog",Ms,[]);class Zv extends Ms{constructor(b){super(b,null);this.zri="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.YXm;var u="";let y="";this.messageText&&(u=this.messageText.split(" {")[0],y=this.messageText.split("} ")[1]);h.startText=u;h.endText=y;h.cutText=this.SZk;h.copyText=this.UPk;h.pasteText=this.tfn;
h.cutShortcutText=this.aca(this.TZk,this.KPm);h.copyShortcutText=this.aca(this.eQk,this.JPm);h.pasteShortcutText=this.aca(this.wfn,this.MPm);h.imageSrc=Td.a.T$("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.dln;this.zri&&(w.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.sjb,["onExecute"]:()=>{this.NCm()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
u=new ff.a(!1,!1,!0);u.Ed=0;u.mg="CopyPasteNoClipboardAccessDialog";u.Wh(b,Object(v.a)(this,this.WUf,"reactCopyPasteShortcutDialogHandler"),h)}get YXm(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get sjb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get dln(){return CommonUIStrings.l_DialogOk}get SZk(){return CommonUIStrings.l_CutString}get TZk(){return CommonUIStrings.l_CutShortcut}get KPm(){return CommonUIStrings.l_CutShortcut_Mac}get UPk(){return CommonUIStrings.l_CopyString}get eQk(){return CommonUIStrings.l_CopyShortcut}get JPm(){return CommonUIStrings.l_CopyShortcut_Mac}get tfn(){return CommonUIStrings.l_PasteString}get wfn(){return CommonUIStrings.l_PasteShortcut}get MPm(){return CommonUIStrings.l_PasteShortcut_Mac}NCm(){w.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Je.a.en(this.zri,"_blank",void 0,"learnMoreLink")}}Object(m.a)(Zv,"ReactCopyPasteNoClipboardAccessDialog",Ms,[]);class Ow extends Ms{constructor(b,h,u){super(b,h);b={};b.forwardElementText=this.wQh;b.cutText=this.aca(this.B6e,this.MDf);b.copyText=this.aca(this.z3e,this.LDf);b.pasteText=this.aca(this.PPf,this.NDf);u.$("PasteTextOnlyShortcutDialogIsEnabled")&&(ba.a.Wp||ba.a.kj)&&(b.pasteTextOnly=this.aca(this.n8,this.ODf));this.J0e?(w.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.hth,["onExecute"]:y=>{this.MLh(y)}},u=this.qdb.indexOf("{0}"),-1!==u&&(b.suggestionPrefixElement=this.qdb.substring(0,u),b.suggestionSuffixElement=this.qdb.substring(u+3,this.qdb.length))):w.ULS.sendTraceTag(40726915,307,50,null);u={["id"]:Ms.id,["bodyControls"]:b};b=new ff.a(!1,!1,!0);b.Ed=0;b.mg=Ms.id;b.Wh(this.titleText,Object(v.a)(this,this.WUf,"reactCopyPasteShortcutDialogHandler"),u)}}Object(m.a)(Ow,"ReactCopyPasteShortcutDialog",
Ms,[]);class Dp{constructor(){this.tra=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA}b4e(b,h,u=!1){w.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.tra,u));this.tra?u?new qx(b,h):new Ow(b,h,r.AFrameworkApplication.K):new RA(b,h,r.AFrameworkApplication.K)}static get instance(){return Dp._instance||(Dp._instance=new Dp)}}Dp._instance=null;Object(m.a)(Dp,"CopyPasteShortcutDialogFactory",null,[1055]);class HB{constructor(b,h,u,y,
P,aa,ta,Pa){this.I5g=this.XQg=this.SMe=!1;this.b4j=b;this.fd=h;this.Ht=u;this.Vb=y;this.ke=P;this.fg=aa;this.Oe=ta;Pa&&(this.I5g=Pa.$("ShouldLogExecCommandCopySuccess"))}get xSa(){return this.b4j}get S1a(){return this.XQg}set S1a(b){this.XQg=b;this.fg.ignoreClipboardEvents=b}UHc(b){this.xSa.UHc(b);b||this.z5c(!0)}get bcl(){return this.xSa.HZf}prepareForPaste(b){this.S1a=!0;this.xSa.prepareForPaste(b,this.w9f)}reset(){this.S1a=!1}paste(){var b=null;let h=null;if(!this.xSa.nPb){(b=this.fd.od)&&this.Vb.Dg(b.vI);
var u=this.Ht.Jt;if(!u.ue||!u.editingView.Kj)return null;h=u.editingView;b=this.ke.Zr();this.S1a=!0;u.FHa()}u=null;try{h&&h.Qjn(),u=b=this.xSa.gIc(this.w9f,b)}catch(y){w.ULS.shipAssertTag(6305672,307,!1),this.T8h()}this.S1a=!1;return u}copy(){var b=this.fd.od;b&&this.Vb.Dg(b.vI);b=this.Ht.Jt;if(!b.ue||1!==b.editingView.mode)return!1;this.S1a=!0;let h;try{const u=new Map;u.set("View","ContentEditableView");Ta.Health.instance.recordKpiUsage(km.a.e0b,0,km.a.iyd,u);const y=this.xSa.Cbf(this.w9f);h=!0;
this.I5g&&w.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",y,this.Oe.tF);if(!y){const P=Object.assign(new Ya.a,{extendedProperties:u});Ta.Health.instance.recordKpiFailure(km.a.e0b,km.a.g_e,!0,!0,P)}}catch(u){w.ULS.shipAssertTag(6305673,307,ba.a.kj),w.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",ba.a.tF),h=!1}this.S1a=!1;return h?!0:!1}z5c(){if(this.SMe)return!0;var b=this.Ht.Jt;if(!b.ue||!b.editingView.Kj)return!1;
const h=b.editingView;b=this.ke.Zr();this.S1a=!0;const u=new Hw.a(b);let y=!1;try{y=this.xSa.z5c(b,()=>{h.bzd()},()=>{h.iGa()})}catch(P){}u.restore();this.S1a=!1;y?this.SMe=!0:(w.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",ba.a.tF),this.T8h());return y}T8h(){this.SMe=!1;if(r.AFrameworkApplication.HFo)Dp.instance.b4e(null,null);else{const b=new Gh.StandardDialog;b.Ed=0;b.GU(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,
null)}}get w9f(){const b=this.ke.hgb();return b?b.In:null}}Object(m.a)(HB,"SystemClipboard",null,[567]);class hv{constructor(b,h,u){this.btd=!1;this.Atd=this.gS=this.OTg=this.dpe=this.Ead=null;this.zin=y=>{1===y?(w.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Roe)),this.rYb&&(w.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.rYb)),Je.a.en(this.Gve+this.UEe,"_blank",void 0,"ChromeCCPInstallDialog"))):y||w.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",
this.Roe))};this.Roe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.Gve=b.lb("ChromeClipboardAccessExtensionLink");this.r9a=h;this.ak=u;this.UEe=b.lb("ChromeClipboardAccessExtensionId");this.D6j=b.$("UseGetClipboardDataIsEnabled");this.V1g=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.rYb=!1;b.$("CcpInstallDialogIsEnabled")&&r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA&&(this.rYb=qx.U8n()||b.$("IgnoreDomainCheckCcpInstallDialog"),w.ULS.sendTraceTag(587314304,
307,50,"_useInstallDialog: {0}",this.rYb));this.Hpc=null}UHc(b){b?this.gS=!0:(this.gS=null,chrome.runtime&&chrome.runtime.sendMessage?(this.Hpc=this.r9a.wCd,this.r9a.AMb?(this.btd=this.D6j,this.rrh()):(this.btd=!0,this.rrh(),w.ULS.sendTraceTag(19256732,307,50,T.a.create().toString()))):(this.WMb(),this.gS=!1))}get HZf(){return this.gS}get nPb(){return this.Atd}z5c(){return!0}Cbf(b){w.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Je.a.dBb(b,"copy"))||w.ULS.sendTraceTag(24402116,307,10,
String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}Sgf(b){if(!b)return null;var h=b.img;const u=b.text;b=b.html;const y=this.ak.r2i(!!h,!!u,b);let P=null;if(3===y){if(!b)return null;h=this.ak.VLh(b);(h=this.ak.bMh(h))&&(b+=h);P=this.ak.olb(b)}else 2===y?P=this.ak.EPf(u,!0):1===y&&(P=this.ak.olb(h));return P}gIc(b,h){if(this.nPb)h=this.Sgf(this.dpe),this.dpe=null;else{if(!this.Ead)return h;b=document.implementation.createHTMLDocument("doc");
b.body.innerHTML=this.Ead;h=b.body;this.Ead=null}return h}prepareForPaste(b){const h=T.a.create();this.OTg=h;this.r9a.AMb?w.ULS.sendTraceTag(7377737,307,50,h.toString()):w.ULS.sendTraceTag(19256735,307,50,h.toString());const u={};u.command=this.nPb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.Hpc,u,y=>{h.equals(this.OTg)?this.nPb?this.dpe=y:this.Ead=y:w.ULS.sendTraceTag(7385868,307,50,null);w.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.i9k(),this.r9a.AMb?
w.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):w.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}WMb(){w.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.rYb?b=this.Gve+this.UEe:this.Roe&&(b=this.Gve+this.Hpc);Dp.instance.b4e(this.zin,b,this.rYb)}i9k(){this.r9a.eKn();this.WMb()}A3i(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}GCk(){const b=T.a.create();this.r9a.AMb?w.ULS.sendTraceTag(592491466,307,50,b.toString()):w.ULS.sendTraceTag(591984031,
307,50,b.toString());chrome.runtime.sendMessage(this.Hpc,{command:"getAvailableCommands"},h=>{w.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(jb.a)(Array,h)?(w.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.Atd=-1!==Array.indexOf(h,"getClipboardData")):(w.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.Atd=!1):(w.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:
null),this.Atd=!1)})}rrh(){const b=T.a.create();this.r9a.AMb?w.ULS.sendTraceTag(7726105,307,50,b.toString()):w.ULS.sendTraceTag(591984032,307,50,b.toString());this.btd&&this.GCk();this.A3i(this.Hpc,h=>{w.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.gS=!0:(h?"ping"!==h&&w.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):w.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.WMb(),this.gS=!1);this.btd&&!this.nPb&&w.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}Lti(b,h){const u={};u.OfficeOnlineExtensionInstallationStatus=b;u.OfficeClipboardExtensionInstallationStatus=h;w.ULS.sendTraceTag(51144839,307,50,JSON.stringify(u));this.V1g&&(b&&Ta.Health.instance.recordKpiSuccess(hv.qYg,null),h&&Ta.Health.instance.recordKpiSuccess(hv.nYg,null))}iJm(){this.V1g&&(Ta.Health.instance.recordKpiUsage(hv.qYg,
1,hv.yJg,null),Ta.Health.instance.recordKpiUsage(hv.nYg,1,hv.yJg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.r9a.AMb;this.A3i(this.UEe,h=>{this.Lti(b,!!h)})}else this.Lti(!1,!1)}}hv.qYg="OfficeOnlineExtensionInstallationStatus";hv.nYg="OfficeClipboardExtensionInstallationStatus";hv.yJg="wwccp";Object(m.a)(hv,"ChromeSystemClipboardAccessManager",null,[595]);class IB{constructor(b,h){this.gS=null;this.Oe=b;this.Ma=h;this.oFj=!this.Ma.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Ma.$("BlockCopyCutOnFirefoxIsEnabled");this.t1j=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}UHc(b){this.oFj&&b&&this.Oe.kj?(this.WMb(),this.gS=!1):this.gS=!0}get HZf(){return this.gS}get nPb(){return!1}Cbf(b){return Je.a.dBb(b,"copy")}gIc(b,h){Je.a.dBb(b,"paste");return h}prepareForPaste(b){b()}z5c(b,h,u){if(this.Oe.n3)return this.t1j&&(this.gS=!1),!1;h();u();b=this.gIc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=Ua.a.create().toString();u();b=this.gIc(b.ownerDocument,b);return this.gS=
b=h===b.innerHTML}WMb(){Dp.instance.b4e(null,null)}}Object(m.a)(IB,"DefaultSystemClipboardAccessManager",null,[595]);class Qz{constructor(b,h,u){this.gS=this.G9=this.IVb=this.Rja=this.$Va=this.Aad=null;this.ak=h;this.iWa=u;this.wUj=b.pc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.Y1j=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}UHc(b){this.Y1j&&b&&(this.gS=!0)}get HZf(){return this.gS}get nPb(){return!1}Cbf(b){return b?Je.a.dBb(b,
bb.a.copy):!1}gIc(b,h){this.$Va&&(h=this.$Va,this.$Va=null);return h}prepareForPaste(b,h=null){if(b&&h){this.Aad=b;this.IVb=h;$addHandler(this.IVb,bb.a.paste,Object(v.a)(this,this.NFi,"onPasteEvent"));this.G9=this.Rja=null;if(this.Hlj(this.IVb)){if(this.G9&&0<this.G9.length&&(!this.Rja||this.ak.eie(this.Rja))){this.iWa.uxh(this.G9,Object(v.a)(this,this.R4m,"onImageConverted"));this.$Va&&!this.$Va.hasChildNodes()&&w.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Rja&&
this.Rja.innerHTML&&((this.$Va=this.lbi(this.Rja.innerHTML))&&!this.$Va.hasChildNodes()&&w.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Hc.a.FA(this.Rja))}this.lOh()}else b&&b()}z5c(b){return this.gS=b=this.Hlj(b.ownerDocument)}NFi(b){try{b&&b.rawEvent&&((this.Rja=b.rawEvent.target)&&this.Rja.id&&-1<this.Rja.id.indexOf("Paste")?(w.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Rja.id),this.Rja=null):this.G9=this.KFl(b.rawEvent))}catch(h){w.ULS.sendTraceTag(22073952,
307,15,"Exception while processing context menu paste event: "+h.toString())}}R4m(b){b&&(this.iWa.H$i&&(b=String.format('<img src="{0}">',b)),this.$Va=this.lbi(b));this.lOh()}lOh(){this.IVb&&($removeHandler(this.IVb,bb.a.paste,Object(v.a)(this,this.NFi,"onPasteEvent")),this.IVb=null);this.Aad&&(this.Aad(),this.Aad=null)}KFl(b){let h=null;(b=this.ak.fUh(b))&&({lrf:h}=this.ak.hlj(b,this.wUj,this.iWa.Wwi));return h}Hlj(b){return Je.a.dBb(b,bb.a.paste)}lbi(b){const h=document.implementation.createHTMLDocument("doc");
h.body.innerHTML=b;return h.body}WMb(){}}Object(m.a)(Qz,"EdgeSystemClipboardAccessManager",null,[595]);class JB{constructor(b,h,u,y){this.Ma=b;this.KGj=h;this.ak=u;this.Oe=y}create(){let b=null;r.AFrameworkApplication.j5f()&&this.Oe.Wp&&window.chrome?(w.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new hv(this.Ma,this.KGj,this.ak),this.Ma.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.iJm()):this.Ma.$("EdgeContextMenuPasteFixIsEnabled")&&this.Oe.jt?(w.ULS.sendTraceTag(22073953,
307,50,"EdgeSystemClipboardAccessManager"),b=new Qz(this.Ma,Ja.a.instance.resolve("Box4.IClipboardDataHelper"),Ja.a.instance.resolve("Box4.IProcessImageStrategy"),Ja.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(w.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new IB(this.Oe,this.Ma));return b}}Object(m.a)(JB,"SystemClipboardAccessManagerFactory",null,[566]);class cq{Edl(b){return b}}Object(m.a)(cq,"DeleteTableSegmentStrategy",null,[564]);
var Ct=c(598),Ur=c(1008);class xs{get Vp(){return dv.a.SCb}get paragraphEditor(){return null!=this.Sug?this.Sug:this.Sug=Ja.a.instance.resolve("Box4.IParagraphEditor")}get D_(){return this.paragraphEditor.Vp}get Mc(){return ri.a.instance}get jC(){return null!=this.dvg?this.dvg:this.dvg=Ja.a.instance.resolve("Box4.IParagraphIndentationReader")}qBc(b,h,u,y,P,aa,ta){let Pa=2;if(!b.ue)return 2;const vb=b.Bb;if(!vb)return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.Nga}),8;if(r.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=
this.Aph(h===Oa.a.GE,u,!0);if(1===y)return b?32:8;b&&(Pa=Ur.a.$cc(h,u,y,P,aa,ta))}else Pa=Ur.a.$cc(h,u,1,P,aa,ta),1!==y&&32===Pa?(b.Bb.W1d(),b=new dg.GraphTransaction(15),b.Eb(u.view.jd),Pa=this.Aph(h===Oa.a.GE,u,!1)?Ur.a.$cc(h,u,y,P,aa,ta):8,b.dispose()):1!==y&&8===Pa&&(b.Bb.W1d(),this.sLk(h,u,vb));return Pa}Aph(b,h,u){h=h.view.Bb;if(!h||!h.hb.kb)return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.fIb}),!1;if(h.hb.YI)return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.D2e}),!1;h=Ct.OutlineElementGeneralizer.ima(h.hb,
!1);if(!h)return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.jGd}),!1;let y=!1;for(let P=0;P<h.length;P++){const aa=h.getContext(P),ta=new yd.GraphIterator;ta.set(aa.node);Se.SelectionEditor.eu(ta);if(!wg.OutlineElementReader.Oh(ta))if(u)continue;else return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.yeb}),!1;if(b?!this.Vp.Gyb(ta):!this.Vp.R_b(ta))if(u)continue;else return this.Mc.fc($c.a.w2b,{["Reason"]:Zc.a.a_e}),!1;y=!0}return u?y:!0}sLk(b,h,u){const y=new dg.GraphTransaction(15);try{y.Eb(h.view.jd);h=!0;const P=
Ct.OutlineElementGeneralizer.ima(u.hb,!1);for(let aa=0;aa<P.length;aa++){const ta=P.getContext(aa),Pa=new yd.GraphIterator;Pa.set(ta.node);Se.SelectionEditor.eu(Pa);if(!wg.OutlineElementReader.Oh(Pa))h=!1;else if(b===Oa.a.GE?this.Vp.Gyb(Pa):this.Vp.R_b(Pa))switch(h=!1,b){case Oa.a.GE:this.Vp.SQa(Pa,-1,0);break;case Oa.a.ML:this.Vp.kGc(Pa,1)}}if(h){const aa=u.hb.kb;for(u=0;u<aa.length;u++){const ta=aa.J(u);if(ta.gl){const Pa=this.jC.sgb(ta.node),vb=Pa.wca;if(b===Oa.a.GE?Pa.UA>vb:Pa.UA<18*vb){const Kb=
new yd.GraphIterator;Kb.set(ta.node);this.D_.zxa(Kb,1,b===Oa.a.GE?Pa.UA>=2.5*vb?Pa.UA-2*vb:vb:Pa.UA<16*vb?Pa.UA+2*vb:18*vb)}}}}}finally{y&&y.dispose()}}}Object(m.a)(xs,"IndentationActorExtension",null,[565]);var hC=c(747),Fv=c(1200);class pu{constructor(b,h){this.Po=new uh.DictionaryPropertySet;this.Usb=!1;this.aAa=this.xqb=null;this.t5=b;this.YKg=h}get bob(){return null!=this.jxg?this.jxg:this.jxg=Ja.a.instance.Pa("Box4.ITextFormattingCommands")}get Jn(){return null!=this.Ipg?this.Ipg:this.Ipg=Ja.a.instance.resolve("Box4.IFormattingEditor")}get nc(){return null!=
this.izg?this.izg:this.izg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}E4a(){this.Usb||(this.Po.RWf(),this.xqb=null,this.QDn())}dQk(b){var h;const u=null!==(h=Wi.FormattingReader.zr(b))&&void 0!==h?h:Wi.FormattingReader.$Jd(b.node,b.cpBegin,-1);!u.cache.$y&&(b=u.Vm)&&(h=new uh.DictionaryPropertySet,h.Hs(b),h.Hs(this.Po),h.hasProperty(vi.a.Rv)&&(this.xqb=u.paragraph.Jc),this.Po=h)}hasProperty(b){return this.Po.hasProperty(b)}CNc(){return 0<this.Po.pI()}get p1a(){return this.Po}freeze(){this.Usb=
!0}WGa(){this.Usb=!1}VF(b,h){return this.p1a.ia(b,h)}Av(b){this.Po.setValue(Ge.a.fontSize,this.Jn.Q0b(b));this.U_()}fontSize(){return this.Po.ia(Ge.a.fontSize,Fg.a.qI)}iae(b){this.Po.setValue(Ge.a.font,b);this.YKg&&this.YKg.execute(h=>{null==h?w.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.iae(this.Po)});this.t5&&this.t5.enabled&&(Ab.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.t5.VXn(this.Po,b));this.U_()}Bgc(b){this.Po.setValue(Lc.a.ve,
b);this.t5&&this.t5.enabled&&(Ab.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.t5.s2n(this.Po,b));this.U_()}Us(b){b=Wj.a.instance.GBa(Hh.a.instance.hb.kb.Qa.node,b);this.Po.setValue(Ge.a.fontColor,b);this.U_()}u2(){this.Po.setValue(Ge.a.fontColor,rn.a.auto);this.U_()}fontColor(){return this.Po.ia(Ge.a.fontColor,rn.a.nil)}xxa(b){this.Po.setValue(Ge.a.highlight,parseInt(b,16));this.U_()}Xyd(){this.Po.setValue(Ge.a.highlight,rn.a.auto);this.U_()}isBold(){return this.Po.ia(Ge.a.bold,
!1)}mG(b){this.Po.setValue(Ge.a.bold,b);this.U_()}isItalic(){return this.Po.ia(Ge.a.italic,!1)}setItalic(b){this.Po.setValue(Ge.a.italic,b);this.U_()}isUnderline(){return this.Po.ia(Ge.a.underline,!1)}o4(b){this.Po.setValue(Ge.a.underline,b);this.Po.setValue(Ge.a.underlineType,b?Fg.a.uOb:Fg.a.SU);this.U_()}underlineType(){return this.Po.ia(Ge.a.underlineType,Fg.a.SU)}Uha(b){b<Fg.a.uOb||b>Fg.a.SU||(this.Po.setValue(Ge.a.underline,b!==Fg.a.SU),this.Po.setValue(Ge.a.underlineType,b),this.U_())}isSuperscript(){return this.Po.ia(Ge.a.superscript,
!1)}mca(b){this.Po.setValue(Ge.a.superscript,b);b&&this.isSuperscript()&&this.Po.setValue(Ge.a.subscript,!1);this.U_()}isSubscript(){return this.Po.ia(Ge.a.subscript,!1)}kpa(b){this.Po.setValue(Ge.a.subscript,b);b&&this.isSubscript()&&this.Po.setValue(Ge.a.superscript,!1);this.U_()}isStrikethrough(){return this.Po.ia(Ge.a.strikethrough,!1)}K8(b){this.Po.setValue(Ge.a.strikethrough,b);this.U_()}isDoubleStrikethrough(){return this.Po.ia(vi.a.ur,!1)}ggc(b){this.Po.setValue(vi.a.ur,b);this.U_()}MTh(){return this.Po.ia(vi.a.Rv,
null)}$mb(b,h){this.Po.RWf();this.Po.setValue(vi.a.Rv,b.id);this.xqb=h.Jc;this.U_()}l4(b){let h=Ge.a.cC;if(pe.a.instance.J(1)){const u=hC.a.mWd(b);switch(u){case 1:h=Lc.a.zGb;break;case 2:h=Lc.a.AGb}this.Po.setValue(Lc.a.languageHint,u)}this.Po.setValue(h,b);this.U_()}language(){let b=Ge.a.cC;if(pe.a.instance.J(1))switch(this.Po.ia(Lc.a.languageHint,0)){case 1:b=Lc.a.zGb;break;case 2:b=Lc.a.AGb}return this.Po.ia(b,0)}i_n(b){this.Po.setValue(Lc.a.noProof,b);this.U_()}DFb(){return this.Po.ia(Lc.a.noProof,
!1)}usm(){return this.Po.hasProperty(Lc.a.noProof)}hrm(){return pe.a.instance.J(1)?this.Po.hasProperty(Ge.a.cC)||this.Po.hasProperty(Lc.a.zGb)||this.Po.hasProperty(Lc.a.AGb):this.Po.hasProperty(Ge.a.cC)}U_(){if(ba.a.cic){var b=Hh.a.instance.hb.kb.Qa,h=b.node;if(h===this.aAa)this.aAa.Ck(16,!0);else{this.aAa=h;h=this.aAa.hY();try{this.aAa.kaa(b.cpBegin).wva=!0}finally{h&&h.dispose()}}}}QDn(){if(ba.a.cic&&this.aAa){var b=0,h=this.aAa.hY();try{for(let u=this.aAa.qa.length-1;0<=u;u--){const y=this.aAa.qa.J(u);
y.wva&&(y.wva=!1,b++,y.isEmpty&&this.aAa.qa.removeAt(u))}}finally{h&&h.dispose()}this.aAa=null}}gOk(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.ei(b.cpBegin);return!!b&&b.wva}DVe(b){if(this.bob){this.freeze();var h=new dg.GraphTransaction(7);h.Eb(b.node);this.bob.kae(b);this.WGa();this.E4a();h.dispose()}}tmf(b){const h=be.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!A.a.uv(h.charCodeAt(b.cpBegin))&&Fv.a.instance.Q_a(h,b.cpBegin-1)!==b.cpBegin&&Se.SelectionEditor.Rib(b)?
(b=Se.SelectionEditor.Q2(b,!1))?1<b.length||Se.SelectionEditor.Ek(b.Qa)?b:null:null:null}}Object(m.a)(pu,"InsertionPointFormatting",null,[563]);class dq{constructor(b){this.ga=b}get Bc(){return this.ga}Xwk(b,h,u=null){const y=new uh.DictionaryPropertySet;y.setValue(ld.a.$v,b);y.setValue(ld.a.Rva,h);u&&y.Hs(u);y.CommandSource="autobulleting";this.Bc.Ub(Oa.a.qB,2,y)}numbering(b,h,u,y,P){const aa=new uh.DictionaryPropertySet;aa.setValue(ld.a.$v,b);aa.setValue(ld.a.Rva,h);aa.setValue(ld.a.D2a,u);P&&aa.setValue(zi.a.tP,
P);y&&aa.setValue(Lc.a.Vt,y);Rt.a.uX&&(aa.setValue(zi.a.Rna,"autocorrect"),P&&aa.setValue(zi.a.vga,P));aa.CommandSource="autonumbering";return 32===this.Bc.Ub(Oa.a.uJ,2,aa)}}Object(m.a)(dq,"ListCommands",null,[562]);var iv=c(241);class Dg extends iv.a{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){super();this.cWb=this.Qo=this.BIa=null;this.$ln=(Yb,Ac)=>{Ac=this.Mra.h5d(this.BIa,Ac);Yb.Qh(this.bpl);return Ac};this.bpl=(Yb,Ac)=>{if(this.Qo.moveNext())return Yb=this.Qo.currentNode,12!==Yb.type||Yb===this.BIa.node?
!0:this.Mra.TYc(Yb,Ac);this.mwk();Yb.Qh(this.cpl);return!0};this.cpl=(Yb,Ac)=>{if(this.Qo.moveNext()){const Sc=this.Qo.currentNode;return 12!==Sc.type?!0:Sc===this.BIa.node?(Yb.Qh(this.amn),!0):this.Mra.TYc(Sc,Ac)}return!1};this.amn=(Yb,Ac)=>{this.Mra.i5d(this.BIa,Ac);return!1};this.init(b);this.il(Sb);this.Lhb(Pa,h,y,P,aa);this.GD=aa;this._context=u;this.ib=vb;this.He=Kb;this.Mra=ta;this.Ez=0}run(){this.M_e();this.Ez||this.d4n();1===this.Ez&&this.enn();2===this.Ez&&this.Ako();3===this.Ez&&this.bkl()}M_e(){this.ib.hb&&
this.ib.hb.kb?1===this.behavior&&(this.Mra.M_e(this._context)?this.nr=32:this.nr=2,this.Ez=3):(w.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.nr=2,this.Ez=3)}d4n(){this.Gvk();this.Mra.W3f(this.BIa)?(this.Puk(),this.Ez=1):(this.nr=8,this.Ez=3)}enn(){this.xF||new ou.a(this,this.$ln,this.GD);do if(this.xF.run(),this.xF.inProgress&&!this.wg)return;while(this.xF.inProgress);this.Tyd();this.Ez=2}Ako(){this.Mra.I9f(this)?this.nr=32:this.nr=8;this.Ez=3}bkl(){this.hpa()}Gvk(){let b=
this.ib.hb.kb;if(b=this.He.Vj(b,!0,!1))this.BIa=b.Qa;this.BIa&&this.BIa.node&&(this.cWb=this.Mra.B2h(this.BIa.node))}Puk(){if(!this.cWb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Hi.a;b.set(this.BIa.node);b.Ab(this.cWb.type);this.Qo=tj.a.Vr(b,this.cWb);this.Qo.ho(Object(v.a)(this.Mra,this.Mra.Dhc,"spellErrorFilter"),null)}mwk(){if(!this.cWb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Hi.a;b.set(this.cWb);this.Qo=tj.a.lq(b);this.Qo.ho(Object(v.a)(this.Mra,
this.Mra.Dhc,"spellErrorFilter"),null)}}Object(m.a)(Dg,"ProofingWholeDocumentOperation",iv.a,[]);var nq=c(290);class Gk extends Hl{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(m.a)(Gk,"ContextMenuRootProperties",Hl,[]);var fy=c(1336);class co{constructor(b){const h=new Gk;h.ImageSideArrow=r.AFrameworkApplication.Cr;h.ImageSideArrowClass=Gd.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=
Oa.a.E4d.toString();this.r8g=new fy.ContextMenuRoot("ContextMenuRootName",h);b.execute(u=>{this.l0.ME=u});this.l0.refresh();r.AFrameworkApplication.ya.pa(Wa.a.showContextMenu,le.a.frame,De.ActionManager.Mf);r.AFrameworkApplication.ya.pa(Wa.a.Zgc,le.a.frame,De.ActionManager.Mf)}get l0(){return this.r8g}dispose(){this.l0&&(this.l0.dispose(),this.r8g=null)}showContextMenu(b,h){this.TMb(b,h.clientPoint,h.og)}j1b(b,h,u,y,P){this.l0.j1b(b,h,u,y,P)}y5a(b,h,u){Je.a.gZd(this.l0.EXa?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");Ra.App.xa.Qnl();this.Yt();this.l0.y5a(b,h,u);this.l0.EXa?r.AFrameworkApplication.ya.processAction(Wa.a.Zgc,2):r.AFrameworkApplication.ya.processAction(Wa.a.showContextMenu,2)}TMb(b,h,u){this.y5a(b,new Sys.UI.Bounds(h.x,h.y,0,0),u)}Yt(){this.l0.root.Nl()}M2(){return this.l0.M2()}Zgc(b,h,u,y){const P=this.l0;let aa=!1;u=Object(na.a)(Pk,u);P.EXa=u;y.Cxa(b,h);P.TRe?u&&(u.Fin(P,h),aa=!0):(w.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
y.sZk()),P.EXa=null);return aa}}Object(m.a)(co,"AContextMenuController",null,[594,9]);class Nu{}Nu.zdc="faProofing";Nu.kIh="EditorMenuSection";Object(m.a)(Nu,"ContextMenuControlId",null,[]);var az=c(550);class Ou{constructor(b){this.He=b}M_e(b){b=Object(na.a)(az.a,b);return!!b&&!!b.view&&b.view.ue}W3f(){return!0}h5d(){return!0}TYc(){return!0}i5d(){}I9f(){return!0}Dhc(b){if(b.Dr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}B2h(b){if(!b||!this.He)return b;const h=new Hi.a;h.set(b);if(this.He.eu(h)){for(;!h.Dr;)h.qc();
return h.currentNode}return b}}Object(m.a)(Ou,"SimpleProofingWholeDocumentCallBacks",null,[577]);class qu{constructor(b){this.value=b}}Object(m.a)(qu,"RefBool",null,[]);class kn{constructor(){this.aIc=this.dIb=null;this.smj=new qu(!1)}}Object(m.a)(kn,"FindNextErrorOperationParam",null,[]);class No{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=No.dal;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=
0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}No.dal=[];Object(m.a)(No,"Critique",null,[]);class rx{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(rx,"Suggestion",null,[]);var js=c(617);class Vr extends Sys.EventArgs{constructor(b,h,u,y,P,aa){super();this.cOj=b;this.bQj=h;this.cQj=u;this.Ble=y;
this.uz=P;this.D7a=aa}}Object(m.a)(Vr,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var St=c(356);class Oo{constructor(b,h,u){this.tte=b;this.vp=h;this.sa=u}vxh(b){const [h,u,y]=this.a7h(b);return this.yWh(h,u,y)}vmm(b){return Ap.a.getTypeNameFor(b.content)===St.a.getTypeName()}yWh(b,h,u){if(u&&this.vmm(u)){r.AFrameworkApplication.Ce("0847a482;1b717180");if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideSpellingSectionForIgnoredWordsFixEnabled",
!1)&&this.bBc(u.content))return null;const P=u.content;var y=new No;y.ExplanationTitle=P.explanationTitle;y.Suggestions=this.sVl(u);y.CategoryTitle=P.categoryName;y.TypeId=P.typeId;y.CritiqueActions=P.critiqueActions;y.Priority=P.priority;u=this.tte.create(y);y=P.context;u.token=y.substring(P.range.start,P.range.start+P.range.length);u.lcid=zl.a.sg(P.language).LCID;u.originalText=y;return new js.a(b,h,u)}return null}sVl(b){var h=b.content.suggestions;b=[];for(const u of h)h=new rx,h.Action=u.suggestionActions,
h.Text=u.text,h.Description=u.description,b.push(h);return b}bBc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}a7h(b){const h=this.vp.nLc(b,0),u=b.cpBegin,y=b.cpEnd,P=Se.SelectionEditor.pf(b);b=be.ParagraphReader.text(b.node,0);for(const aa of h)if(P){if(aa.begin<=u&&aa.end>=y)return[aa.begin,aa.end,aa.intent]}else if(aa.begin<=u&&aa.end>=u&&A.a.Fwh(b,aa.end,y))return[aa.begin,aa.end,aa.intent];return[null,null,null]}static XA(){return!!r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}Tof(b,h,u){const [y,P,aa]=this.a7h(b);aa&&this.sa.raiseEvent(Oo.zkh,new Vr(b,y,P,h,aa,u))}Mek(b){this.sa.addHandler(Oo.zkh,b)}Ggl(b,h,u){b=this.vp.EKd(b,0,0,b.characterData.length);for(let y=0;y<b.count;y++){const P=b.J(y);if(P.intent){const aa=P.intent;if(aa.content&&(0==aa.content.priority||1==aa.content.priority)&&P.begin>=h&&(!u||u(P.intent)))return this.yWh(P.begin,P.end,P.intent)}}return null}}
Oo.zkh="augloopProofingContextMenuActionEventKey";Object(m.a)(Oo,"AugLoopProofingErrorDetailHelper",null,[]);class Xi extends Ou{constructor(b,h,u,y){super(h);this.kn=b;this.Txc=u;this.REj=y}h5d(b,h){return!this.dCf(b.node,b.cpBegin,h)}TYc(b,h){return!this.dCf(b,0,h)}i5d(b,h){this.dCf(b.node,0,h);Object(na.a)(kn,h)}dCf(b,h,u){u=Object(na.a)(kn,u);if(be.ParagraphReader.ic(b)&&!b.VI)if(Wi.FormattingReader.zr(nf.a.Uc(b,h)).cache.DFb)u.smj.value=!0;else{if(Oo.XA())return h=this.REj.Ggl(b,h,this.Txc),
null!=h?(u.dIb=h,u.aIc=b,!0):!1;const y=this.kn.Y2(b);for(let P=0;P<y.length;P++){const aa=y[P];if(aa.begin>=h&&!aa.errorDetails.N1a()&&(!this.Txc||this.Txc(aa.errorDetails)))return u.dIb=aa,u.aIc=b,!0}return!1}}}Object(m.a)(Xi,"FindNextErrorCallbackSteps",Ou,[]);var bp=c(354);class Wr{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad){this.nIk=(he,ce,Nd,re,Xd)=>{ce=this.ib.hb.kb;if(!ce)return this.rd.fc($c.a.vf,{["Reason"]:Zc.a.noSelection}),2;ce=this.He.Vj(ce,!0,!1);return this.ga.Tf(ce.Qa,
he,Nd,!1,re,Xd)};this.Wan=(he,ce,Nd)=>{if(1===Nd)return this.ga.processAction(Oa.a.l4,1);this.XSj().P5f();return 32};this.pCa=(he,ce,Nd)=>{if(1===Nd)return 32;kh.a.mark(4670);Nd=this.kn.qma(ce);if(this.Cge(Nd))return 8;ce=ce.node;const re=this.Ic.Qc(15);let Xd=Nd.begin;" "===be.ParagraphReader.text(ce).charAt(Xd-1)&&Xd--;re.Eb(ce);const vg=this.Rd.replaceTextRange(nf.a.createTextRange(ce,0<Nd.begin?Nd.begin-1:0,Nd.end),"",!0,!1);this.ib.setSelection(Kf.SelectionFactory.we(ce,vg+Xd));re.dispose();
Nd.errorDetails.oob(he);kh.a.mark(4671);return 32};this.cva=(he,ce,Nd)=>{if(1===Nd)return 32;w.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(Oo.XA())return this.T7a.Tof(ce,null,bp.b.IgnoreOnce),32;kh.a.mark(4670);Nd=this.kn.qma(ce);if(this.Cge(Nd))return 8;ce=ce.node;const re=this.Ic.Qc(15);re.Eb(ce);this.kn.Wlb(ce,[Nd],!0);ce.setValue(Ge.a.z2e,!0);re.dispose();Nd.errorDetails.oob(he);kh.a.mark(4671);w.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");
this.OMm(Nd);this.mWa.Hbi(Nd,ce,!0);return 32};this.qQk=(he,ce,Nd)=>{var re,Xd=!this.Tk.C7(ce);this.Om&&this.Om.instance&&this.Om.instance.PT(ce)&&(Xd=!1);if(1===Nd||!Xd)return Xd?32:8;this.ga.processAction(Oa.a.Qxa,2);kh.a.mark(4670);Xd=this.xyl(he);if(0>Xd)return 8;if(Oo.XA())return this.T7a.Tof(ce,Xd,bp.b.Apply),32;Nd=this.kn.qma(ce);if(this.Cge(Nd))return 8;ce=ce.node;var vg=Nd.errorDetails.suggestions;if(!vg)return this.rd.fc($c.a.lBb,{["Reason"]:"NoSuggestionsFound"}),kh.a.mark(4671),8;Xd=Xd<
vg.length?vg[Xd]:null;if(!Xd)return this.rd.fc($c.a.lBb,{["Reason"]:"RequestedSuggestionIsNull"}),kh.a.mark(4671),8;(null===(re=Ra.App.yd)||void 0===re?0:re.Xp)&&Ra.App.yd.Vq.WG(ce);Xd=Xd.replace("  "," \u00a0");re=this.Ic.Qc(15);re.Eb(ce);vg=this.Rd.replaceTextRange(nf.a.createTextRange(ce,Nd.begin,Nd.end),Xd,!0,!1,Oa.a.Qxa);this.ib.setSelection(Kf.SelectionFactory.we(ce,Nd.begin+Xd.length+vg));re.dispose();Nd.errorDetails.oob(he);kh.a.mark(4671);this.KHm(Nd);return 32};this.ISn=(he,ce)=>{ce=this.kn.qma(ce);
if(this.Cge(ce))return 8;ce.errorDetails.oob(he);return 32};this.gjl=(he,ce,Nd,re,Xd)=>{if(!ce.view.ue)return 2;const vg=ce.view;if(!this.ib.hb.kb)return this.rd.fc($c.a.vf,{["Reason"]:Zc.a.noSelection}),2;if(1===Nd)return 32;const Vf=new kn,kj=new Xi(this.kn,this.He,this.Txc,this.T7a);ce=new Dg(null,he,ce,Nd,re,Vf,kj,this.ga,this.ib,this.He,null);ce.wg=!0;ce.run();if(ce.isCompleted&&Vf.dIb){if(ce=Kf.SelectionFactory.we(Vf.aIc,Vf.dIb.begin),ce=Kf.SelectionFactory.Vz(ce,nf.a.Uc(Vf.aIc,Vf.dIb.end)),
!this.p1g.instance||!this.p1g.instance.wkn(Vf.dIb,ce,vg)){this.ib.setSelection(ce);let zm=0;Xd&&(zm=Xd.ox);vg.Pbe=!1;lf.a.instance.Xb(new sc.a(1,1,1,()=>{this.OQn(vg,zm,Vf.aIc,Vf.dIb)}))}}else{const zm=new Gh.StandardDialog;zm.Ed=0;Ra.App.BM.kSc?zm.Yha(CommonUIStrings.l_DefaultDialogTitle,Vf.smj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(zm.Yha(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,
null),Ra.App.BM.Lud(()=>{zm.nga&&(zm.hide(),this.ga.processAction(he,2))}))}return 32};this.E4d=(he,ce,Nd)=>{if(1===Nd)return 32;this.ada&&this.ada.l0&&(he=this.ada.l0.Xnf(Nu.zdc))&&!he.FK&&(he.h_(0),he.menu.nK(0));return 32};this.ga=h;this.kn=b;this.XSj=u;this.Rd=y;this.Ic=P;this.ib=aa;this.Om=ta;this.He=Pa;this.a1j=vb;this.Tk=Kb;this.rd=Sb;this.T7a=Ad;this.ada=Object(na.a)(co,Yb);this.UTb=Ac.LRc;this.p1g=Sc;this.mWa=nd;this.olc=new Map;this.olc.set(1,Oa.a.a7f);this.olc.set(2,Oa.a.yof);this.olc.set(3,
Oa.a.a8f);this.Fwc=new Map;this.Fwc.set(1,Oa.a.b7f);this.Fwc.set(2,Oa.a.zof);this.Fwc.set(3,Oa.a.b8f)}Wb(){const b=this.ga,h=this.qQk,u=this.nIk;b.gb(Oa.a.D2d,oc.a.view,this.Wan,1028);b.pa(Oa.a.pCa,oc.a.Vc,this.pCa);b.pa(Oa.a.cva,oc.a.Vc,this.cva);b.pa(Oa.a.Xnb,oc.a.Vc,h);b.pa(Oa.a.Ynb,oc.a.Vc,h);b.pa(Oa.a.Znb,oc.a.Vc,h);b.pa(Oa.a.HNb,oc.a.Vc,h);b.pa(Oa.a.INb,oc.a.Vc,h);b.pa(Oa.a.pCa,oc.a.view,u);b.pa(Oa.a.cva,oc.a.view,u);b.pa(Oa.a.Xnb,oc.a.view,u);b.pa(Oa.a.Ynb,oc.a.view,u);b.pa(Oa.a.Znb,oc.a.view,
u);b.pa(Oa.a.HNb,oc.a.view,u);b.pa(Oa.a.INb,oc.a.view,u);b.Xc(Oa.a.pCa,1028);b.Xc(Oa.a.cva,1028);b.Xc(Oa.a.Xnb,1028);b.Xc(Oa.a.Ynb,1028);b.Xc(Oa.a.Znb,1028);b.Xc(Oa.a.HNb,1028);b.Xc(Oa.a.INb,1028);b.pa(Oa.a.Qxa,le.a.frame,De.ActionManager.Mf);this.UTb&&b.gb(Oa.a.E4d,oc.a.view,this.E4d,1124);b.gb(Oa.a.HVc,oc.a.view,this.gjl,1028);b.gb(Oa.a.dTf,oc.a.Fd,this.ISn,1124);this.Zzn([Oa.a.jde,Oa.a.a7f,Oa.a.b7f,Oa.a.zNd,Oa.a.yof,Oa.a.zof,Oa.a.Sde,Oa.a.a8f,Oa.a.b8f,Oa.a.dPi,Oa.a.Azi,Oa.a.odj])}Zzn(b){for(let h=
0;h<b.length;h++)this.ga.gb(b[h],oc.a.view,De.ActionManager.FZ,1028)}kBn(b){this.Txc=b}Cge(b){return b?b.errorDetails?!1:(w.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.rd.fc($c.a.lBb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),kh.a.mark(4671),!0):(w.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.rd.fc($c.a.lBb,{["Reason"]:"RequestedErrorRangeNotFound"}),kh.a.mark(4671),!0)}OMm(b){b=b.errorDetails.proofingType;if(this.Fwc.has(b)){const h=
this.Fwc.get(b);this.ga.processAction(h,2);w.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}xyl(b){switch(b){case Oa.a.Xnb:return 0;case Oa.a.Ynb:return 1;case Oa.a.Znb:return 2;case Oa.a.HNb:return 3;case Oa.a.INb:return 4;default:return-1}}KHm(b){b=b.errorDetails.proofingType;if(this.olc.has(b)){const h=this.olc.get(b);this.ga.processAction(h,2);w.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}OQn(b,
h,u,y){b.h4();(b=u.xe(b.Sb))?(y=nq.a.Cq(b,r.AFrameworkApplication.isRtl?y.begin:y.end),this.a1j.Cxa(new Sys.UI.Point(y.x,y.y+y.height),h)):w.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(m.a)(Wr,"ProofingActor",null,[]);var Yi=c(45),jv=c(335),kr=c(1517),kv=c(1789);class $s{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.Vhc=null;this.dml="StyleUsageActivity";this.eml="StylesFloodgateSurveyIsEnabled";this.NLa=(Sb,Yb,Ac,Sc)=>{Sb=this.XUl(Sb);return 0>Sb||Sb>this.Vhc.length?
2:(Sb=this.Vhc[Sb])?r.AFrameworkApplication.ya.Tf(Yb,Oa.a.applyStyle,Ac,!0,Sc,Sb):2};this.xJb=(Sb,Yb,Ac,Sc,nd)=>{Sb=!0;Yb.contextId!==oc.a.paragraph&&Yb.contextId!==oc.a.Fd&&Yb.contextId!==oc.a.Vc&&(Sb=!1);if(1===Ac||!Sb)return Sb?32:8;if(2===Ac&&!nd)return 8;Yb=this.nc.jx(Yb.node);Ac=pe.a.instance.J(6);nd.MenuItems=jv.a.uKl(Yb,Ac);return 32};this.oqn=(Sb,Yb,Ac,Sc,nd)=>{Sb=!0;Yb.contextId!==oc.a.paragraph&&(Sb=!1);if(1===Ac&&!Sb)return 8;Yb=Yb.node;Ac=this.nc.Xn(Yb);if(!Ac||!nd)return w.ULS.sendTraceTag(51218391,
324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",nd,Yb,Ac),8;nd.sSa.Hs(Ac.$h());return 32};this.Pmk=(Sb,Yb,Ac,Sc,nd)=>{if(Yb.contextId!==oc.a.paragraph)return 8;if(this.ag.$1a(Yb,!1))return this.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),8;if(1===Ac)return 32;const Ad=Yb.node;if(be.ParagraphReader.rta(Ad)||!nd)return 8;const he=this.Qmf(nd,Ad);if(!he)return this.Mc.fc($c.a.s0,{["Reason"]:Zc.a.mBb}),8;if(2!==this.nc.lx(he))return 2;Ac=new dg.GraphTransaction(15);this.vj&&this.vj.isProgressiveStyleEnabled&&
this.LF.jhc(nd);Ac.Eb(Ad);this.uj.E4a();const ce=[];Sb!=Oa.a.clearFormatting&&ce.push(Yi.a.U6a);this.zca.QK(he,Ad,!1,void 0,void 0,void 0,Fj.a.$l?new kv.a(ce,!1,!0):null);(Sb=this.nc.jx(Ad))&&this.nc.ee(he,Sb)&&Ab.b(593078098,3017,50,"Custom linked style applied by user");Ad.es&&(Sb=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],Ub.a("TOCFormatting",!0,void 0,Sb));Ac.dispose();nd=A.a.uW(nd);Sc.Xr=nd>>>16^nd&65535;Sc&&kr.a.$nb&&(Sc.RB|=kr.a.agb(Yb.node));return 32};this.pqn=(Sb,Yb,Ac,
Sc,nd)=>{Sb=!0;Yb.contextId!==oc.a.Fd&&(Sb=!1);if(1===Ac&&!Sb)return 2;Yb=Wi.FormattingReader.zr(Yb);Yb=Wi.FormattingReader.Kma(Yb);if(!Yb)return 2;if(!nd)return 8;nd.sSa.Hs(Yb.$h());return 32};this.Qmk=(Sb,Yb,Ac,Sc,nd)=>{if(Yb.contextId!==oc.a.Fd||!pe.a.instance.J(6))return 8;this.ag.$1a(Yb);if(1===Ac)return 32;Sb=Yb.node;if(!nd)return 8;const Ad=this.Qmf(nd,Yb.node);if(!Ad)return this.Mc.fc($c.a.s0,{["Reason"]:Zc.a.mBb}),8;if(1!==this.nc.lx(Ad))return 2;Ac=this.nc.jx(Sb);if(!Ac)return this.Mc.fc($c.a.s0,
{["Reason"]:Zc.a.jMh}),8;if(!Ac.fh(this.nc.qf(Ad)))return this.Mc.fc($c.a.s0,{["Reason"]:Zc.a.mBb}),8;const he=new dg.GraphTransaction(7);try{if(this.vj&&this.vj.isProgressiveStyleEnabled&&this.LF.jhc(nd),he.Eb(Sb),this.zca.jdg(Sb,Ac),this.VGa.k2(Yb,ce=>{this.Jn.dla(ce);this.Jn.$mb(ce,Ad)}),Sb.es){const ce=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})];Ub.a("TOCFormatting",!0,void 0,ce)}}finally{he&&he.dispose()}Ac&&this.nc.ee(Ad,Ac)&&Ab.b(593078097,3017,50,"Custom linked style applied by user");
nd=A.a.uW(nd);Sc.Xr=nd>>>16^nd&65535;Sc&&kr.a.$nb&&(Sc.RB|=kr.a.agb(Yb.node));return 32};this.nqn=(Sb,Yb,Ac,Sc,nd)=>{Sb=!0;Yb.contextId!==oc.a.Vc&&(Sb=!1);if(1===Ac&&!Sb)return 2;Yb=this.zca.bVl(Yb);if(!Yb)return 2;if(!nd)return 8;nd.sSa.Hs(Yb.$h());return 32};this.Omk=(Sb,Yb,Ac,Sc,nd)=>{if(Yb.contextId!==oc.a.Vc||!pe.a.instance.J(6))return 8;if(this.ag.$1a(Yb,!1))return this.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),8;if(1===Ac)return 32;var Ad=Yb.node;if(!nd)return 8;Ac=this.Qmf(nd,Yb.node);if(!Ac)return this.Mc.fc($c.a.s0,
{["Reason"]:Zc.a.mBb}),8;const he=this.nc.lx(Ac);if(1!==he&&2!==he)return 2;(Yb=this.uj.tmf(Yb))?(Yb=Hh.a.Fzb(Yb),Sb=r.AFrameworkApplication.ya.Tf(Yb,Sb,2,!1,Sc,nd)):(Sb=new dg.GraphTransaction(7),this.vj&&this.vj.isProgressiveStyleEnabled&&this.LF.jhc(nd),Sb.Eb(Ad),this.zca.S1n(Ac,Ad),Sb.dispose(),Sb=32);Ad.es&&(Yb=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],Ub.a("TOCFormatting",!0,void 0,Yb));(Ad=this.nc.jx(Ad))&&this.nc.ee(Ac,Ad)&&Ab.b(593078096,3017,50,"Custom linked style applied by user");
nd=A.a.uW(nd);Sc.Xr=nd>>>16^nd&65535;return Sb};this.qqn=(Sb,Yb,Ac,Sc,nd)=>{if(pe.a.instance.J(6)){const Ad=this.h8c.yoa(Sb,Yb,Ac,Sc,nd,null,0);if(2!==Ad)return Ad}return this.h8c.yoa(Sb,Yb,Ac,Sc,nd,null,12)};this.Rmk=(Sb,Yb,Ac,Sc,nd)=>{const Ad={};Ad[this.h8c.JHa]=6168;Ad[this.h8c.IHa]=6169;let he=12;if(pe.a.instance.J(6)){if(!Yb.view.ue)return 2;var ce=Yb.view.Bb,Nd=ce?ce.Lg:null;if(!Nd)return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.noSelection}),8;if(this.Yg.RBa(Jd.ImageReader.q1a,Nd))return this.Mc.fc($c.a.vf,
{["Reason"]:Zc.a.oEc}),8;if(this.Yg.lya(be.ParagraphReader.MT,Nd))return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.BN}),8;if(this.ag.m8b(Nd,!1))return this.Mc.fc($c.a.vf,{["Reason"]:Zc.a.hE}),8;Nd=this.nc.Yn();if(nd&&Nd){const re=Nd.fh(nd);if(re){const Xd=this.nc.NZ(re,Nd);let vg=this.nc.lx(re);Xd&&(ce=ce.hb.J(0),ce.Nx&&ce.Qa.contextId===oc.a.Fd||2===ce.length&&ce.Qa.contextId===oc.a.Fd&&ce.Tc.contextId===oc.a.endOfParagraph)&&(vg=1,nd=Xd.getValue(vi.a.ja));1===vg?he=0:3===vg&&(he=14);!this.nc.ee(re,Nd)&&
this.nc.Cd(re)&&(ce=this.nc.qf(re),Ab.b(562317522,3017,50,String.format("{0}: style applied by user",ce)));this.Ipa(this.dml,this.eml)}}}return this.h8c.yoa(Sb,Yb,Ac,Sc,nd,Ad,he)};this.sL=h;this.ze=u;this.SM=y;this.zz=P;this.Tk=aa;this.rd=ta;this.Z1=Pa;this.g7j=vb;this.me=Kb}get vj(){return null!=this.Gwg?this.Gwg:this.Gwg=Ja.a.instance.Pa("Box4.Styles.StyleSettings")}get zca(){return this.sL}get Yg(){return this.SM}get uj(){return this.zz}get Jn(){return this.ze}get ag(){return this.Tk}get Mc(){return this.rd}get VGa(){return this.Z1}get h8c(){return this.g7j}get nc(){return this.me}Wb(){const b=
r.AFrameworkApplication.ya,h=Ra.App.GSa.gzh(12);pe.a.instance.J(6)&&(b.pa(Oa.a.applyStyle,oc.a.Fd,this.Qmk),b.pa(Oa.a.NFa,oc.a.Fd,this.pqn),b.pa(Oa.a.applyStyle,oc.a.Vc,this.Omk),b.pa(Oa.a.NFa,oc.a.Vc,this.nqn));b.pa(Oa.a.applyStyle,oc.a.paragraph,this.Pmk);b.pa(Oa.a.applyStyle,oc.a.view,this.Rmk);b.Xc(Oa.a.applyStyle,1036);b.pa(Oa.a.NFa,oc.a.view,this.qqn);b.pa(Oa.a.NFa,oc.a.paragraph,this.oqn);b.Xc(Oa.a.NFa,99);b.pa(Oa.a.xJb,oc.a.view,h);b.pa(Oa.a.xJb,oc.a.paragraph,this.xJb);b.Xc(Oa.a.xJb,1127);
b.gb(Oa.a.NVe,oc.a.view,this.NLa,4);b.gb(Oa.a.OVe,oc.a.view,this.NLa,4);b.gb(Oa.a.PVe,oc.a.view,this.NLa,4);b.gb(Oa.a.QVe,oc.a.view,this.NLa,4);b.gb(Oa.a.RVe,oc.a.view,this.NLa,4);b.gb(Oa.a.SVe,oc.a.view,this.NLa,4);b.gb(Oa.a.TVe,oc.a.view,this.NLa,4);b.gb(Oa.a.Xih,oc.a.view,this.NLa,4);b.gb(Oa.a.Yih,oc.a.view,this.NLa,4);b.gb(Oa.a.Zih,oc.a.view,this.NLa,4);this.Vhc=Array(10);hl.StyleReader.Zae(this.Vhc)}XUl(b){switch(b){case Oa.a.NVe:return 0;case Oa.a.OVe:return 1;case Oa.a.PVe:return 2;case Oa.a.QVe:return 3;
case Oa.a.RVe:return 4;case Oa.a.SVe:return 5;case Oa.a.TVe:return 6;case Oa.a.Xih:return 7;case Oa.a.Yih:return 8;case Oa.a.Zih:return 9;default:return-1}}Ipa(b,h){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const u=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");u&&u.execute(y=>{y.logActivity(b,h)})},$s.oCa)}Qmf(b,h){if(b&&h&&be.ParagraphReader.ic(h))h=this.nc.jx(h);else return null;return h.fh(b)}get LF(){return null!=this.vpg?this.vpg:this.vpg=Ja.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
$s.oCa=5E3;Object(m.a)($s,"StyleActor",null,[]);var Wq=c(1889);class Rz{constructor(b){this.ga=b}get Bc(){return this.ga}kae(b,h=!1){this.Bc.Tf(b,Oa.a.p1a,2,!0,null,h)}l4(b){this.Bc.Ub(Oa.a.l4,2,b)}}Object(m.a)(Rz,"TextFormattingCommands",null,[561]);class Iq{constructor(b,h,u,y){this.ePe=this.$8g=!1;this.doo=(P,aa,ta)=>{if(2!==ta)return 2;this.$8g||(this.$8g=!0);r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.mmn=(P,aa,ta,Pa,vb)=>{if(2!==ta)return 2;this.vOi(vb,!0);return 32};this.lmn=(P,aa,ta,Pa,vb)=>{if(2!==ta)return 2;this.vOi(vb,!1);return 32};this.fnn=(P,aa,ta)=>{if(2!==ta)return 2;if(!this.N9a)return 8;this.N9a.g8l();return 32};this.hmn=(P,aa,ta)=>{if(2!==ta)return 2;if(!this.N9a)return 8;this.N9a.OLn();return 32};this.joa=(P,aa)=>{3===aa.ox&&Se.SelectionEditor.om(aa.Ll.kb)&&(Ub.c(Oa.a.Zno),r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.ePe=!0)};this.ga=b;this.Ma=h;this.N9a=u;this.ib=y}get coo(){return this.ePe}Wb(){var b;this.ga.gb(Wa.a.HO,oc.a.view,this.doo,4);this.ga&&this.Ma&&(this.Ma.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.gb(Oa.a.oag,oc.a.view,this.mmn,4),this.ga.gb(Oa.a.qag,oc.a.view,this.lmn,4)),this.ga.gb(Wa.a.rej,oc.a.application,this.fnn,4),this.ga.gb(Wa.a.paf,oc.a.application,this.hmn,4),iq.EventHandlerManager.instance.rAn(()=>{this.o$m()}));(null===(b=Ra.App.xa.jb.wc)||void 0===b?0:b.ue)&&Ra.App.xa.jb.wc.Gka(()=>
{this.TQn()});this.ib&&this.ib.DA(this.joa)}Fsn(){Ub.c(Oa.a.boo);this.ePe=!0}TQn(){const b=window.performance.now();Iq.QBe&&250>b-Iq.QBe&&1E3<b-Iq.aUg&&(Ub.c(Oa.a.aoo),Iq.aUg=b);this.N9a&&Iq.$b&&Iq.$b.Xx(117)&&this.N9a.showFloatie()}kjm(b,h){if(h){var u=null;ba.a.sJ&&b&&(u=b.getSelection());b=null;u&&"Caret"===u.type&&(b=u.getRangeAt(0))&&this.N9a&&this.N9a.Lxo(b.getBoundingClientRect(),h)}}o$m(){Iq.QBe=window.performance.now()}vOi(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Iq.iam)){for(b=
b.firstChild;b;)this.Ihk(b,h),b=b.nextSibling;break}b=b.nextSibling}}Ihk(b,h){if(b.classList.contains(Iq.Ubi)){const u="WACImageResizeHandleTouch"+this.BEl(b);h?b.classList.add(Iq.Vbi,u):b.classList.remove(Iq.Vbi,u)}}BEl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Iq.Ubi)return A.a.substring(h,20,h.length);return""}static get $b(){return null!=Iq.uog?Iq.uog:Iq.uog=Ja.a.instance.Pa("Box4.IFeatureHelper")}}Iq.Ubi="WACImageResizeHandles";Iq.Vbi="WACImageResizeHandlesTouch";
Iq.iam="WACImgSelection";Iq.QBe=0;Iq.aUg=0;Object(m.a)(Iq,"TouchInputActor",null,[560]);class Ns{get JHa(){return Ur.a.JHa}get IHa(){return Ur.a.IHa}get okc(){return Ur.a.okc}yoa(b,h,u,y,P,aa,ta){return Ur.a.yoa(b,h,u,y,P,aa,ta)}$cc(b,h,u,y,P,aa){return Ur.a.$cc(b,h,u,y,P,aa)}static get instance(){Ns._instance||(Ns._instance=new Ns);return Ns._instance}}Ns._instance=null;Object(m.a)(Ns,"ViewActionHandlerProxy",null,[559]);class eq{constructor(b,h){this.kpiName="VisiMarkersUsage";this.S6="wwaengidc";
this.gjb=new Map;this.gbo=(u,y,P,aa,ta)=>{if(1===P)return 32;if(!ta)return 2;this.gjb.set("Source",Zn.a[this.ga.t7]);this.HQe.PSc?this.gjb.set("Action","Removed"):this.gjb.set("Action","Applied");Ta.Health.instance.recordKpiUsage(this.kpiName,1,this.S6,this.gjb);u=document.getElementsByTagName("head")[0];if(!this.HQe.tno(u))return w.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Ra.App.xa.xG({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.Jpn=(u,y,P,aa,ta)=>{if(1===
P)return 32;ta[ag.a.On]=this.HQe.PSc;return 32};this.ga=b;this.HQe=h}Wb(){this.ga.gb(Oa.a.Mce,oc.a.application,this.gbo,1);this.ga.gb(Oa.a.XPi,oc.a.application,this.Jpn,96)}}Object(m.a)(eq,"VisiMarkersActor",null,[]);var at=c(118);class Sz{constructor(b,h,u,y,P){this.xn=b;this.t_m=h;this.Dj=u;this.Kd=y;this.characterPropertiesEditor=P}get JBi(){return this.t_m.value}execute(b,h,u,y){const P=ri.a.instance.Xo(Oa.a.vZn);wg.OutlineElementReader.isEmpty(b,!1)?this.gel(b):this.hel(b,h,u,y);P.end()}gel(b){this.JBi.KZe(b,
-1)?this.JBi.SQa(b,-1,0):this.xn.rRa(b,{aVi:!0})}hel(b,h,u,y){h=y(b,h,u);b=be.ParagraphReader.Il(b.currentNode);!this.xn.eNb&&this.Wxm(b)&&this.xdk(h);this.xn.Rpa();(null===b||void 0===b?0:b.qa)&&!b.qa.last.formatting&&this.characterPropertiesEditor.VMa(b)}Wxm(b){return b.Zi&&!b.mC.hasProperty(Lc.a.listID)}xdk(b){og.OutlineElementNavigator.Ee(b);b=b.currentNode;const h=new at.a;b.Jc.av(h);this.Dj.FU(b,h,this.Kd.zg)}}Object(m.a)(Sz,"ListNewLineStrategy",null,[]);class Tz{xc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",
()=>new Cv(dv.a.SCb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new Qy(r.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new Ny.ClipboardActor(b.af("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),
ri.a.instance,b.resolve("Box4.IClipboardDataHelper"),Hh.a.instance,r.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),r.AFrameworkApplication.K,ub.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),r.AFrameworkApplication.m5f(),r.AFrameworkApplication.zaj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ja.a.instance.resolve("Common.IReactContextualUILauncher"),
!!Ra.App.instance&&Ra.App.instance.lga)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new es(r.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new JB(r.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Lu.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();
b.ha("Box4.Actors.ISystemClipboard",()=>new HB(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),ab.InteractiveViewManager.instance,Ra.App.xa.jb,ub.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Lu.a.instance,r.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new cq).singleInstance();b.ha("Box4.ISelectionFactory",()=>new wt.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>
new Jz).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new ik).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new Cw(Hh.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"),pe.a.instance.J(7))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new Dv).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new Yv(Hh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),ab.InteractiveViewManager.instance,
Je.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Ra.App.instance&&Ra.App.instance.lga)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new Zy(b.resolve("Box4.IClipboardDataHelper"),Ra.App.Bw.kI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new Yy(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),ab.InteractiveViewManager.instance,tt.a.instance(),r.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ra.App.kk.sl.Xe(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Ra.App.instance&&Ra.App.instance.lga)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new Bw(ri.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),nx.a.instance,Hh.a.instance,r.AFrameworkApplication.ya,
b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.af("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new ay(r.AFrameworkApplication.ya,ri.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),Hh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Box4.IParagraphReader"),vt.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Pa("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Wx(ri.a.instance,Lu.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Common.ISimpleOperationFactory"),r.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Sy(r.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new Vs(b.resolve("Box4.Actors.InternalClipboard"),r.AFrameworkApplication.ya,r.AFrameworkApplication.j5f(),ri.a.instance,vt.a.instance,Lu.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),
b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Nw(b.af("Box4.Actors.IBox4PasteStewardFactory"),b.af("Box4.Actors.IBox4ImageStewardFactory"),b.af("Box4.Actors.IBox4TableStewardFactory"),b.af("Box4.Actors.IBox4WordConverterFactory"),b.af("HtmlImport.IHtmlTranslatorSettings"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new Kl.a(b.resolve("Box4.Images.IImageEditor"),b.af("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Ra.App.kk,b.resolve("Box4.IParagraphIndentationReader"),r.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").D3i,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new px(b.resolve("Box4.Actors.InternalClipboard"),b.Pa("Box4.IContentControlCopyPasteHelper"),new Zf.a(()=>Ra.App.xa.jb.wc),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
b.ha("Box4.List.IListCommands",()=>new dq(r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.List.ListNewLineStrategy",()=>new Sz(b.resolve("Box4.List.IListEditor"),b.af("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).singleInstance();b.ha("Box4.Actors.PasteCoordinator",()=>new ey(b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"))).singleInstance();b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new Mz(b.resolve("Box4.Images.IImageEditor"),r.AFrameworkApplication.uc,b.resolve("Box4.IUndoManager"),b.Pa("Box4.Actors.IImageStewardBridge"),Ra.App.xa.notificationBar,b.Pa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("NotificationBarImageErrorIsEnabled"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4TableStewardFactory",()=>new nu(Ja.a.instance.resolve("Box4.List.IListEditor"),Ja.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new PA(ri.a.instance,Hh.a.instance,Ra.App.yd,sd.a.instance)).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",
()=>new vq(r.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new em(r.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new FB).singleInstance();b.ha("Box4.ISelectionCommands",()=>new mx(r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new Rz(r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new Br(b.Za("Box4.Accessibility.IAccessibilityContextManager"),
b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new pu(b.Pa("Box4.IFontSlotProvider"),b.Za("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();b.ha("Box4.UI.PasteFloatieManager",()=>new Nm).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new Wr(Ja.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),r.AFrameworkApplication.ya,()=>Ja.a.instance.resolve("Box4.UI.ILanguageDialog"),
Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ja.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Hh.a.instance,Ja.a.instance.Za("Box4.IExternalSelectionManager"),vt.a.instance,Ja.a.instance.resolve("Box4.ISelectionContextMenuProvider"),sd.a.instance,ri.a.instance,Ja.a.instance.resolve("Box4.IContextMenuController"),Ja.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ja.a.instance.Za("Box4.Actors.IProofingErrorPresenter"),Ja.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
Ja.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new $s(Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ja.a.instance.resolve("Box4.IFormattingEditor"),im.ContextSetEditor.instance,Ja.a.instance.resolve("Box4.IInsertionPointFormatting"),sd.a.instance,ri.a.instance,Ja.a.instance.resolve("Box4.TextFormattingHelper"),Ns.instance,Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();
b.ha("Box4.Actors.StyleContextMenuActor",()=>new cv(Ja.a.instance.resolve("Box4.IUpdateStyleManager"),Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"),r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",()=>new Wq.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Pa("Box4.IFontSlotProvider"),b.Pa("Box4.IContentControlChpHelper"),Ja.a.instance.resolve("Box4.IFormattingEditor"),Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"),
Ja.a.instance.resolve("Box4.IParagraphEditor"),Ja.a.instance.resolve("Box4.ILineSpacingHelper"),Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ja.a.instance.resolve("Box4.IOutlineElementEditor"),Ja.a.instance.resolve("Box4.List.IListFormattingEditor"),Ja.a.instance.resolve("Box4.IParagraphIndentationReader"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",()=>new Lz(r.AFrameworkApplication.ya,ri.a.instance,()=>Ja.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();
b.ha("Box4.Actors.TouchInputActor",()=>new Iq(r.AFrameworkApplication.ya,r.AFrameworkApplication.K,xf.GrippersManager.instance,Hh.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(xt,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new eq(r.AFrameworkApplication.ya,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();b.ha("Box4.Actors.IndentationActorExtension",()=>new xs).as("Box4.Actors.IIndentationActorExtension").singleInstance()}}
Object(m.a)(Tz,"Box4ActorsComponentConfiguration",null,[2]);var Xr=c(230),ru=c(1069);const KA=()=>{const b=gy;r.AFrameworkApplication.ya.pa(Oa.a.X9e,oc.a.embeddedFile,b);r.AFrameworkApplication.ya.pa(Oa.a.X9e,oc.a.Q3b,b);r.AFrameworkApplication.ya.pa(Oa.a.W9e,oc.a.embeddedFile,Ky);r.AFrameworkApplication.ya.pa(Oa.a.W9e,oc.a.Q3b,Ky)},gy=(b,h,u)=>Ra.App.JDd?8:2===u?(b=new Gh.StandardDialog,b.Ed=4,b.DU(1),b.Ue(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ue(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),
b.$5f(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,Ez),32):2,Ez=b=>{1===b&&r.AFrameworkApplication.ya.processAction(Oa.a.W9e,2)},Ky=(b,h,u)=>{if(Ra.App.JDd)return 8;if(1===u)return h.node.hasProperty(Ge.a.embeddedFileContainer)?32:2;if(2===u&&(h.contextId===oc.a.view&&h.view.Bb&&(h=h.view.Bb.Lg),Xr.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=ru.a.yCl(h.node);Xa.a.d3n();try{Ly(b)}catch(y){w.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",
y)}}return 32},Ly=b=>{Je.a.en(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Pw=c(778),Aw=c(505),ot=c(1186),$v=c(1201);class Pu{constructor(b){this.Eza=this.fV=null;this.$ga=(h,u,y,P,aa)=>{if(1===y)return 32;r.AFrameworkApplication.ya.Ub(Oa.a.g4a,2,aa);h=aa&&0<=aa.fontColor&&16777215>=aa.fontColor?aa.fontColor:0;Ra.App.xa.Ew();(new ot.a(Pu.cuh,Oa.a.Nha)).O3c(h);return 32};this.wJb=(h,u,y,P,aa)=>{if(1===y)return 32;if(2===y&&!aa)return 8;h=Pu.Te.wLd(u);u=new Pw.a;y=null;32===r.AFrameworkApplication.ya.Ub(Oa.a.g4a,
2,u)&&u&&(y=u.fontColor);P="";y&&!u.U3b&&(P=rn.a.jE(y)||"");this.zPh.Hfc=P;this.QRc&&this.recentColors.gdg(P);h=this.zPh.mId(h,Ra.App.D0b);if(!h)return 8;aa.MenuItems=h;w.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.xDe=b}get zPh(){this.fV||(this.fV=new $v.a(Pu.cuh),this.b1a(this.fV));return this.fV}b1a(b){b.gea(1,Oa.a.u2);b.gea(3,Oa.a.Us);b.gea(4,Oa.a.Us);b.gea(5,Oa.a.Nha);b.gea(6,Oa.a.$ga);b.iZb(this.xDe,1)}Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.$ga,
oc.a.view,this.$ga);b.pa(Oa.a.wJb,oc.a.view,this.wJb);b.Xc(Oa.a.wJb,1127)}static tDl(){return new Pu(Aw.a.instance)}static get instance(){return null!=Pu.rrg?Pu.rrg:Pu.rrg=Pu.tDl()}get recentColors(){return null!=this.Bvg?this.Bvg:this.Bvg=Ja.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}static get Te(){return se.PageReader.instance}get QRc(){null==this.Eza&&(r.AFrameworkApplication.Ce("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.Eza=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",
!1):!1);return this.Eza}}Pu.cuh="Font";Object(m.a)(Pu,"FontColorActor",null,[]);class su{constructor(b){this.$ga=(h,u,y,P,aa)=>{if(1===y)return 32;r.AFrameworkApplication.ya.Ub(Oa.a.g4a,2,aa);h=aa&&0<=aa.highlight&&16777215>=aa.highlight?aa.highlight:0;Ra.App.xa.Ew();(new ot.a("Highlighter",Oa.a.E8)).O3c(h);return 32};this.ga=b}Wb(){this.ga.pa(Oa.a.xIi,oc.a.view,this.$ga)}static kFl(){return new su(r.AFrameworkApplication.ya)}static get instance(){return null!=su.csg?su.csg:su.csg=su.kFl()}}Object(m.a)(su,
"HighlighterColorActor",null,[]);var fq=c(303),Uz;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";b.Url="Url";b.RecentLinks="RecentLinks"})(Uz||(Uz={}));Object(m.b)("InsertLinkUserActivitySource",Uz);class bi{constructor(b,h,u){this.Trb=this.Eo=this.ul=null;this.fsc=!1;this.GD=null;this.gg=ab.InteractiveViewManager.instance.od;this.Zk=b;this.ul=u;this.GD=h;bi.f2&&Se.SelectionEditor.Ek(b)&&(b=Se.SelectionEditor.v6c(this.Zk),Se.SelectionEditor.Ek(b)?this.Zk=b:w.ULS.sendTraceTag(41522313,324,
15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));b=Se.SelectionEditor.kOb(this.Zk);Se.SelectionEditor.Ek(b)&&(this.Zk=b)}get nva(){return null!=this.psg?this.psg:this.psg=Ja.a.instance.Pa("Box4.IInternalLinkManager")}get Dj(){return this.Eo||(this.Eo=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get Vdi(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}HLh(b,
h,u){if(h!==this.Zk.cpEnd||b!==this.Zk.cpBegin)b=Kf.SelectionFactory.JL(u,b,h),this.gg.Bb.setSelection(b),this.Zk=Se.SelectionEditor.kOb(b.Qa.clone())}UVh(b){const h=yi.HyperlinkReader.kMc(this.Zk);let u=this.Zk.cpBegin,y=this.Zk.cpEnd,P="";if(!h.length)return this.Trb=b.substring(this.Zk.cpBegin,this.Zk.cpEnd),{returnValue:!0,n$d:P,WFd:u,XFd:y,PPd:h};if(h[0].hyperlink){let aa,ta=0,Pa=Math.max(0,b.length-1),vb=0;for(let Kb=0;Kb<h.length;Kb++)h[Kb].cpBegin>=ta&&({cpBegin:aa,cpEnd:ta}=bi.OI.waa(this.Zk,
h[Kb]),Pa=Math.min(aa,Pa),vb=Math.max(ta,vb));u=Math.min(Pa,u);y=Math.max(vb,y);this.Trb=b.substring(u,y);u===Pa&&(P=h[0].hyperlink.url);return{returnValue:!0,n$d:P,WFd:u,XFd:y,PPd:h}}return{returnValue:!1,n$d:P,WFd:u,XFd:y,PPd:h}}Lag(b){pe.a.instance.J(3)&&bi.Kd.Kag(b)}TQd(b,h){var u;if(this.gg.$r){var y=yi.HyperlinkReader.kMc(this.Zk),P=this.gg.Bb.hb.kb;if(P){P=P.Qa;be.ParagraphReader.em(P)&&(P=nf.a.createTextRange(P.node,0,be.ParagraphReader.textLength(P.node)));if(bi.f2&&Se.SelectionEditor.Ek(P)){var aa=
Se.SelectionEditor.v6c(P);Se.SelectionEditor.Ek(aa)?P=aa:w.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}aa=Se.SelectionEditor.kOb(P);Se.SelectionEditor.Ek(aa)&&(P=aa);if(0!==b&&32===r.AFrameworkApplication.ya.Tf(P,Oa.a.insertHyperlink,1,!0,null,null)&&this.Zk.equals(P)){kh.a.mark(5562);(null===(u=Ra.App.yd)||void 0===u?0:u.Xp)&&this.gg.Bb.JYb();b=new dg.GraphTransaction(15);b.Eb(this.Zk.node);this.Zk.node.BI().ZF.H$(4);
u=h.txtDisplay;P=!1;if(null!=h.linkurl)if(P=!0,h.isHeading){l(this.GD,"Heading");aa=h.paragraphNode;const ta=h.startCp,Pa=h.endCp;h=this.ul.ZSh(aa);this.ul.QYb(h,ta,Pa,aa,aa,!1)}else l(this.GD,"Bookmark"),h=h.linkurl;else l(this.GD,"Url"),h=h.txtLink.trim();this.insertLink(u,h,y,P);b.Kk=Oa.a.insertHyperlink;b.dispose();kh.a.mark(5563);this.Zk.node.Veb();this.zS()}else this.gg.b0()}else w.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}Jjj(b,
h,u,y,P,aa=!1){y?(y=nf.a.createTextRange(this.Zk.node,this.Zk.cpBegin,this.Zk.cpBegin+b.length),bi.hyperlinkEditor.dIh(y,u,h),b=Kf.SelectionFactory.we(this.Zk.node,this.Zk.cpBegin+b.length)):(bi.hyperlinkEditor.jkb(this.Zk,2),this.Dj.Xmb(this.Zk,2),u=nf.a.Uc(this.Zk.node,this.Zk.cpEnd),bi.characterPropertiesEditor.replaceTextRange(u,b,!0),y=nf.a.createTextRange(this.Zk.node,this.Zk.cpEnd,this.Zk.cpEnd+b.length),bi.hyperlinkEditor.eH(y,h,P,!1,!0,aa),b=Kf.SelectionFactory.we(this.Zk.node,this.Zk.cpEnd+
b.length));b&&this.gg.Bb.setSelection(b)}insertLink(b,h,u,y=!1){var P=null;b||(b=h,r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!u.length||h!==u[0].hyperlink.url)&&!y){h=yi.HyperlinkReader.ZNa(h);var aa="";this.nva&&({HWf:aa}=this.nva.Qag(h)).returnValue&&(h=aa)}this.fsc||(b=bi.hyperlinkEditor.vIn(b));let ta=!1;aa=!1;if(h){P=0<u.length;var Pa=!0;bi.crm&&(Pa=be.ParagraphReader.text(this.Zk.node).substring(this.Zk.cpBegin,
this.Zk.cpEnd)!==b);if(bi.Kd.zg&&1===u.length&&!u[0].hyperlink.cG&&!(u[0].cpBegin>this.Zk.cpBegin&&u[0].cpEnd<=this.Zk.cpEnd)){this.Jjj(b,h,u[0].hyperlink,!Pa,P,y);return}if(P)for(var vb=0;vb<u.length;vb++)u[vb].hyperlink.cG&&(aa=!0),bi.hyperlinkEditor.VQ(this.Zk.node,u[vb].hyperlink,!1);Pa&&bi.characterPropertiesEditor.replaceTextRange(this.Zk,b,!aa);Pa||!bi.Kd.zg||aa||this.Dj.Xmb(this.Zk,1);u=nf.a.createTextRange(this.Zk.node,this.Zk.cpBegin,this.Zk.cpBegin+b.length);bi.hyperlinkEditor.eH(u,h,P,
aa,!0,y);P=Kf.SelectionFactory.we(this.Zk.node,this.Zk.cpBegin+b.length)}else if(0<u.length){Pa=u[0];const Kb=({cpBegin:y,cpEnd:vb}=bi.OI.waa(this.Zk,Pa)).returnValue;Pa.hyperlink.cG&&(aa=!0);h?Pa.hyperlink.dhb?(h!==Pa.hyperlink.url&&(bi.Kd.zg&&!aa?(u=nf.a.createTextRange(this.Zk.node,y,y+b.length),bi.hyperlinkEditor.dIh(u,Pa.hyperlink,h)):bi.OI.ayo(h,Kb)),b!==this.Trb&&(bi.characterPropertiesEditor.replaceTextRange(nf.a.createTextRange(this.Zk.node,y,vb),b,!0),h=nf.a.createTextRange(this.Zk.node,
y,y+b.length),this.Lag(h),P=Kf.SelectionFactory.we(this.Zk.node,y+b.length),ta=!0)):bi.Kd.zg&&!aa?(y=be.ParagraphReader.text(this.Zk.node).substring(this.Zk.cpBegin,this.Zk.cpEnd)===b,this.Jjj(b,h,u[0].hyperlink,y,!1)):(bi.OI.kXf(this.Zk,Kb),bi.characterPropertiesEditor.replaceTextRange(nf.a.createTextRange(this.Zk.node,y,vb),b,!aa),u=nf.a.createTextRange(this.Zk.node,y,y+b.length),bi.hyperlinkEditor.eH(u,h,!1,aa),P=Kf.SelectionFactory.we(this.Zk.node,y+b.length)):bi.hyperlinkEditor.VQ(Pa.paragraph,
Pa.hyperlink)}(ta||aa)&&bi.Kd.Ds(aa?2:7);P&&this.gg.Bb.setSelection(P);Ra.App.Ipo()}static get hyperlinkEditor(){return bi.GC||(bi.GC=Ja.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return bi.Rd||(bi.Rd=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Kd(){return bi.Ud||(bi.Ud=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get OI(){return bi.$Ng||(bi.$Ng=Ja.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get crm(){null==
bi.eze&&(bi.eze=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("KeepHyperlinkFormatFixIsEnabled"):!1);return bi.eze}static get pFb(){null==bi.Wsb&&(bi.Wsb=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return bi.Wsb}static get f2(){null==bi.WU&&(bi.WU=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return bi.WU}}bi.GC=null;bi.Rd=null;bi.Ud=null;bi.$Ng=null;bi.eze=null;bi.Wsb=null;bi.WU=null;
bi.source="Source";bi.tuh="CommandingInterface";bi.xAb="DisplayText";bi.url="Url";bi.id="InsertLinkDialog";Object(m.a)(bi,"AInsertLinkDialog",null,[9]);class Gv{static get Hg(){return ff.a.Sy(Gv.am,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Gv.am="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(Gv,"InsertLinkDialogHtml",null,[]);class aw extends bi{constructor(b,h){super(b,h);this.eg=new ff.a;this.eg.mg=bi.id;let u=this.Trb="";var y=be.ParagraphReader.text(this.Zk.node);let P=this.Zk.cpBegin,aa=this.Zk.cpEnd;({n$d:u,WFd:P,XFd:aa,PPd:y}=this.UVh(y));(h="object"===typeof h?h:null)&&(h[bi.source]&&h[bi.source]===bi.tuh||h[bi.url]&&h[bi.xAb])?this.insertLink(h[bi.xAb],h[bi.url],y):(y[0]&&this.HLh(P,aa,y[0].paragraph),this.eg.Hg=Gv.Hg,""===u.trim()&&this.eg.Ue(1,this.Vdi),h={["txtLink"]:u,
["txtDisplay"]:this.Trb},this.eg.BDd=Object(v.a)(this,this.L2,"dialogDefaultEnterKeyHandler"),this.eg.ADd=Object(v.a)(this,this.L2,"dialogDefaultEnterKeyHandler"),this.eg.Wh(this.titleText,Object(v.a)(this,this.TQd,"insertLinkDialogHandler"),h),bi.pFb&&(h=document.getElementById("txtLink"),rf.a.addHandler(h,bb.a.input,Object(v.a)(this,this.w3a,"onLinkChanged")),rf.a.addHandler(h,bb.a.change,Object(v.a)(this,this.w3a,"onLinkChanged"))),document.getElementById("txtLink").focus(),bi.f2?0<En.g(nf.a.IL(P,
aa,!1,this.Zk.node)).length&&(this.fsc=!0,document.getElementById("txtDisplay").disabled=!0):1>=y.length&&bi.OI.twh(b,y[0],1===y.length)&&(this.fsc=!0,document.getElementById("txtDisplay").disabled=!0))}w3a(){if(this.eg){const b=document.getElementById("txtLink");this.eg.Lha(1,!b||!b.value.length||yi.HyperlinkReader.uPa(b.value))}}L2(b){return this.eg?bi.pFb?this.eg.lTh(this.eg.PRb)?this.eg.L2(b):!1:this.eg.L2(b):!1}zS(){if(bi.pFb){const b=document.getElementById("txtLink");b&&(rf.a.removeHandler(b,
bb.a.change,Object(v.a)(this,this.w3a,"onLinkChanged")),rf.a.removeHandler(b,bb.a.input,Object(v.a)(this,this.w3a,"onLinkChanged")))}this.eg&&(this.eg=null)}}Object(m.a)(aw,"InsertLinkDialog",bi,[]);class bw{constructor(b,h,u,y,P){this.linkurl=b;this.isHeading=h;this.startCp=u;this.endCp=y;this.paragraphNode=P}}Object(m.a)(bw,"HeadingDataForLinkDialog",null,[]);class ku{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(m.a)(ku,"BookmarkDataForLinkDialog",null,[]);class Vz{constructor(b,h,u,
y,P,aa){this.key=b;this.name=h;this.startIndex=u;this.count=y;this.level=P;this.isCollapsed=aa}}Object(m.a)(Vz,"GroupHeaderDataForLinkDialog",null,[]);class bz{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(m.a)(bz,"SelectedItemFromLinkDialogGroupedList",null,[]);class Wz extends bi{constructor(b,h,u,y,P){super(b,h,y);this.gKj=u;this.Lh=P;const aa=new ff.a(!1,!1,!0);u={};u.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;u.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
u.insertInternalLinkEnabled=!0;u.enterLinkTabLabel=Box4Intl.Box4Strings.l_EnterLinkText;u.thisDocumentTabLabel=Box4Intl.Box4Strings.l_ThisDocumentText;u.groupedList=this.tEl();var ta=this.Trb="";ta=be.ParagraphReader.text(this.Zk.node);y=this.Zk.cpBegin;P=this.Zk.cpEnd;let Pa;({n$d:ta,WFd:y,XFd:P,PPd:Pa}=this.UVh(ta));if((h="object"===typeof h?h:null)&&(h[bi.source]&&h[bi.source]===bi.tuh||h[bi.url]&&h[bi.xAb]))this.insertLink(h[bi.xAb],h[bi.url],Pa);else{Pa[0]&&this.HLh(y,P,Pa[0].paragraph);h=CommonUIStrings.l_DialogOk;
""===ta.trim()&&(h=this.Vdi);aa.Ue(1,h);ta&&ta.startsWith(A.a.Kcb)?(h=this.ZSl(ta,u.groupedList))?u.groupedList.selectedItem=h:u.txtLink=ta:u.txtLink=ta;u.txtDisplay=this.Trb;bi.f2?0<En.g(nf.a.IL(y,P,!1,this.Zk.node)).length&&(this.fsc=!0,u.textDisplayDisabled=!0):1>=Pa.length&&bi.OI.twh(b,Pa[0],1===Pa.length)&&(this.fsc=!0,u.textDisplayDisabled=!0);var vb={["id"]:bi.id,["bodyControls"]:u};this.Lh.Sd(()=>{aa.Wh(this.titleText,Object(v.a)(this,this.TQd,"insertLinkDialogHandler"),vb)},"RILD:IAS")}}ZSl(b,
h){h=h.items;const u=b.substring(A.a.Kcb.length),y=this.ul.llf(u);b=-1;let P=0;for(let aa=0;aa<h.length;aa++)if(h[aa].isHeading&&0!=y.count&&h[aa].paragraphNode.id==y.J(0).id){b=aa;break}else if(!h[aa].isHeading&&h[aa].linkurl==u){b=aa;P=1;break}h=new bz(b,P);return-1!=b?h:null}tEl(){const b={};let h=[],u=0,y=0;var P=this.gKj.XEl();null!=P&&(u=P.count,h=h.concat(this.bFl(P)));P=this.ul.LJc(!1);null!=P&&(y=P.count,h=h.concat(this.hul(P)));b.groups=this.PEl(u,y);b.items=h;return b}PEl(b,h){const u=
[],y=new Vz("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);u.push(y);b=new Vz("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);u.push(b);return u}bFl(b){const h=[],u=/\uFFFC/;for(const y of b)b=y.characterData.replace(u," "),b=new bw(b,!0,y.begin,y.end,y.paragraphNode),h.push(b);return h}hul(b){const h=[];for(const u of b)b=u.Nf(Lc.a.at).toString(),b=new ku(b,!1),h.push(b);return h}zS(){}}Object(m.a)(Wz,"ReactInsertLinkDialog",bi,[]);class cw{constructor(){this.tra=
!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA}Uzh(b,h,u,y){this.tra?new Wz(b,h,u,y,fq.a.instance):new aw(b,h)}static get instance(){return null!=cw.Wqg?cw.Wqg:cw.Wqg=new cw}}Object(m.a)(cw,"InsertLinkDialogFactory",null,[650]);class cp extends ff.a{constructor(b){super();this.w3a=()=>{const h=document.getElementById("txtLink");this.Lha(1,!h||!h.value.length||yi.HyperlinkReader.uPa(h.value))};this.TQd=(h,u)=>{if(this.gg.$r){var y=this.gg.Bb.hb.kb;if(y)if(y.equals(this.Vw)&&0!==h){h=
new dg.GraphTransaction(15);h.Eb(this.kS[0].node);for(y=0;y<this.kS.length;y++)this.kS[y].node.BI().ZF.H$(4);y=u.txtLink.trim();u=this.W0k();y=this.Zfm(y);(u||y)&&cp.Kd.Ds(7);this.hide();h.dispose()}else this.gg.b0()}};this.kS=b;this.gg=ab.InteractiveViewManager.instance.od;this.Vw=this.gg.Bb.hb.kb;this.jdf=b[0].cpBegin;this.iAf=b[b.length-1].cpEnd;this.mg="InsertMultiParagraphLinkDialog";b=this.hxo();this.showDialog("",b)}showDialog(b,h){w.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");
this.Hg=Gv.Hg;""===h.trim()&&this.Ue(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Wh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.TQd,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;cp.pFb&&(b=document.getElementById("txtLink"),rf.a.addHandler(b,bb.a.input,this.w3a),rf.a.addHandler(b,bb.a.change,this.w3a))}hide(){if(cp.pFb){const b=document.getElementById("txtLink");b&&(rf.a.removeHandler(b,bb.a.change,this.w3a),
rf.a.removeHandler(b,bb.a.input,this.w3a))}super.hide()}L2(b){return cp.pFb?this.lTh(this.PRb)?super.L2(b):!1:super.L2(b)}hxo(){let b;var h="";const u=this.kS.length,y=yi.HyperlinkReader.iD(this.kS[0],!1);0<y.length&&({cpBegin:P,cpEnd:b}=cp.OI.waa(this.kS[0],y[0]),P<=this.kS[0].cpBegin&&(h=y[0].hyperlink.url),this.jdf=Math.min(this.jdf,P));var P=yi.HyperlinkReader.iD(this.kS[u-1],!1);0<P.length&&({cpBegin:P,cpEnd:b}=cp.OI.waa(this.kS[u-1],P[P.length-1]),this.iAf=Math.max(this.iAf,b));this.pqo(this.jdf,
this.iAf);return h}pqo(b,h){const u=this.kS.length;if(b!==this.kS[0].cpBegin||h!==this.kS[u-1].cpEnd){b=nf.a.Uc(this.kS[0].node,b);b=Kf.SelectionFactory.Vn(b);h=nf.a.Uc(this.kS[u-1].node,h);h=Kf.SelectionFactory.Vz(b,h);b=this.d6h(h.Qa.clone());const y=this.d6h(h.Tc.clone());b&&y&&(this.kS[0]=b,this.kS[u-1]=y,this.gg.Bb.setSelection(h),this.Vw=h)}}Zfm(b){if(!b)return!1;b=yi.HyperlinkReader.ZNa(b);for(let u=0;u<this.kS.length;u++){var h=this.kS[u];if(cp.f2&&Se.SelectionEditor.Ek(h)&&(h=Se.SelectionEditor.v6c(h),
!Se.SelectionEditor.Ek(h)))continue;h=nf.a.createTextRange(this.kS[u].node,h.cpBegin,h.cpEnd);this.Lag(h);cp.hyperlinkEditor.eH(h,b,!1)}return!0}Lag(b){pe.a.instance.J(3)&&cp.Kd.Kag(b)}d6h(b){return be.ParagraphReader.em(b)&&!Se.SelectionEditor.x7(b)&&be.ParagraphReader.textLength(b.node)?nf.a.createTextRange(b.node,0,be.ParagraphReader.textLength(b.node)):Se.SelectionEditor.Ek(b)?b:null}W0k(){let b=!1;for(const h of this.kS){const u=yi.HyperlinkReader.iD(h,!1);u&&(b=cp.OI.kXf(h,u)||b)}return b}static get OI(){return null!=
cp.wqg?cp.wqg:cp.wqg=Ja.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Kd(){return null!=cp.Yxg?cp.Yxg:cp.Yxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=cp.nqg?cp.nqg:cp.nqg=Ja.a.instance.resolve("Box4.IHyperlinkEditor")}static get f2(){null==cp.WU&&(cp.WU=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return cp.WU}static get pFb(){null==cp.Wsb&&(cp.Wsb=r.AFrameworkApplication.K?
r.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return cp.Wsb}}cp.WU=null;cp.Wsb=null;Object(m.a)(cp,"InsertMultiParagraphLinkDialog",ff.a,[]);class Pe{static get bookmarkManager(){return null!=Pe.amg?Pe.amg:Pe.amg=Ja.a.instance.af("WordEditor.Bookmark.FullBookmarkManager").value}static get z2b(){return null!=Pe.Hng?Pe.Hng:Pe.Hng=Ja.a.instance.af("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value}static get ag(){return sd.a.instance}static get B2(){return null!=Pe.Kmg?
Pe.Kmg:Pe.Kmg=Ja.a.instance.Pa("Box4.IContentControlChpHelper")}static get OI(){return null!=Pe.yqg?Pe.yqg:Pe.yqg=Ja.a.instance.resolve("Box4.IHyperlinkStrategy")}static Gw(){return Pe.Om||(Pe.Om=Ja.a.instance.Za("Box4.IExternalSelectionManager"))}static get Kd(){return null!=Pe.kyg?Pe.kyg:Pe.kyg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Dh(){return null!=Pe.ryg?Pe.ryg:Pe.ryg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Yg(){return im.ContextSetEditor.instance}static get Mc(){return ri.a.instance}static get tVc(){null==
Pe.vpb&&(Pe.vpb=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Pe.vpb}static get f2(){null==Pe.WU&&(Pe.WU=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Pe.WU}static get hyperlinkEditor(){return null!=Pe.uqg?Pe.uqg:Pe.uqg=Ja.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=Pe.Amg?Pe.Amg:Pe.Amg=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Z1a(){Pe.uze||
(Pe.uze=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("IsO365CommercialHost")||r.AFrameworkApplication.K.$("IsO365ConsumerHost"):!1);return Pe.uze}static get gmo(){Pe.C8g||(Pe.C8g=r.AFrameworkApplication.K?r.AFrameworkApplication.K.pc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return Pe.C8g}static Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.insertHyperlink,oc.a.view,Pe.hEb);b.pa(Oa.a.insertHyperlink,oc.a.Vc,Pe.insertLink);b.pa(Oa.a.insertHyperlink,oc.a.Fd,Pe.insertLink);b.Xc(Oa.a.insertHyperlink,
1028);b.pa(Oa.a.M2b,oc.a.view,Pe.hEb);b.pa(Oa.a.M2b,oc.a.Vc,Pe.insertLink);b.pa(Oa.a.M2b,oc.a.Fd,Pe.insertLink);b.Xc(Oa.a.M2b,1028);b.pa(Oa.a.VQ,oc.a.view,Pe.hEb);b.pa(Oa.a.VQ,oc.a.Vc,Pe.iVi);b.pa(Oa.a.VQ,oc.a.Fd,Pe.iVi);b.Xc(Oa.a.VQ,1028);b.pa(Oa.a.i$d,oc.a.view,Pe.hEb);b.pa(Oa.a.i$d,oc.a.Vc,Pe.v2i);b.pa(Oa.a.i$d,oc.a.Fd,Pe.v2i);b.pa(Oa.a.B3a,oc.a.view,Pe.hEb);b.pa(Oa.a.B3a,oc.a.Vc,Pe.AIi);b.pa(Oa.a.B3a,oc.a.Fd,Pe.AIi);b.pa(Oa.a.B3a,oc.a.image,Pe.fOf);b.pa(Oa.a.B3a,oc.a.CBb,Pe.fOf);pe.a.instance.J(4)&&
b.pa(Oa.a.B3a,oc.a.anchoredObject,Pe.fOf);b.pa(Oa.a.wDc,oc.a.application,Pe.wDc);b.pa(Oa.a.eBd,oc.a.view,Pe.hEb);Pe.Z1a&&(b.gb(Wa.a.o4a,oc.a.view,this.hEb.bind(this),1028),b.pa(Wa.a.o4a,oc.a.Vc,this.o4a.bind(this)),b.pa(Wa.a.o4a,oc.a.Fd,this.o4a.bind(this)),b.Xc(Wa.a.o4a,1028),b.pa(Wa.a.Rsf,oc.a.Vc,this.o4a.bind(this)),b.pa(Wa.a.Rsf,oc.a.Fd,this.o4a.bind(this)),b.Xc(Wa.a.Rsf,1028),b.pa(Wa.a.dRf,oc.a.view,this.dRf.bind(this)),b.pa(Wa.a.YQf,oc.a.view,this.YQf.bind(this)),b.gb(Wa.a.Rhb,oc.a.Vc,this.Rhb.bind(this),
1028),b.gb(Wa.a.Rhb,oc.a.Fd,this.Rhb.bind(this),1028))}static wDc(){return 32}static o4a(b,h,u){if(!Pe.Z1a)return 2;b=Pe.bsj(h);if(32!=b)return b;if(!Pe.tPa(h,!0).returnValue||Pe.U0b(h))return 8;1!==u||Pe.xOh||(Pe.Mhe(!0),Pe.xOh=!0);return 32}static dRf(b,h,u,y,P){if(!Pe.Z1a)return 2;if(1===u)return 32;Pe.t7d(Pe.ZYj,Pe.$Yj,Pe.R1g);fq.a.instance.Sd(()=>{Pe.Mhe();P.MenuItems=Object.assign(new $f.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const aa=this.QAh();aa?(w.ULS.sendTraceTag(526242130,
324,50,"Recent Links data load success in ribbon"),P.MenuItems.MenuSectionList.push(aa)):Pe.uMi(P,Pe.R1g)},"HA:PRLF");return 32}static YQf(b,h,u,y,P){if(!Pe.Z1a)return 2;if(1===u)return 32;Pe.t7d(Pe.XYj,Pe.YYj,Pe.Q1g);fq.a.instance.Sd(()=>{Pe.Mhe();P.MenuItems=Object.assign(new $f.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});P.MenuItems.MenuSectionList.push(this.WTk());const aa=this.QAh(!0);aa?(w.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),
P.MenuItems.MenuSectionList.push(aa)):Pe.uMi(P,Pe.Q1g)},"HA:PILF");return 32}static uMi(b,h){w.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);Pe.t7d(Pe.CVj,Pe.DVj,h);b.MenuItems.MenuSectionList.push(this.sWk());Pe.Mhe(!0)}static sWk(){const b=this.d5e("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new Qe.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static WTk(){const b=this.d5e("InsertLinkSection");
b.ControlList.push(Object.assign(new Qe.a,{ExternalId:"InsertLink"}));return b}static QAh(b=!1){if(Pm.instance.Mnd){var h=this.d5e("RecentLinksSection",b);b=JSON.parse(Pm.instance.Mnd);this.Lnd.clear();b.forEach((u,y)=>{this.Lnd.set(y,[u.FileName,u.DocumentUrl]);const P=Pe.QQl(u.FileName);var aa=Pe.SDl(u.TimeStamp),ta=h.ControlList,Pa=ta.push,vb=Object,Kb=vb.assign,Sb=new Qe.a,Yb=Wa.a.Rhb,Ac=Wa.a.Rhb;aa=P!==u.FileName?u.FileName+"\n"+aa:aa;var Sc=u.FileName;let nd="SaveAsWordDocx_32";switch(u.App){case "Word":nd=
"SaveAsWordDocx_32";break;case "PowerPoint":nd="SaveAsPowerPointPptx_32";break;case "Excel":nd="SaveAsExcelXlsx_32"}Pa.call(ta,Kb.call(vb,Sb,{ExternalId:y,Command:Yb,CommandValueId:Ac,LabelText:P,Alt:aa,AriaDescription:Sc,ExternalImageId:nd,KeyTip:u.FileName}))});return h}}static d5e(b,h=!1){return Object.assign(new xi.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Rhb(b,h,u,y,P){if(!Pe.Z1a)return 2;
if(!P||P.CommandValueId!=Wa.a.Rhb)return 32;Pe.t7d(Pe.UPj,Pe.VPj,Pe.k_j);u=h;h=new dg.GraphTransaction(15);h.Kk=b;h.Eb(u.node);y=Pe.tPa(u,!0).hyperlink;u=Se.SelectionEditor.kOb(u);if(y)Pe.zXf(u),b=Kf.SelectionFactory.JL(u.node,Math.min(u.cpBegin,y.cpBegin),Math.max(u.cpEnd,y.cpEnd)),Hh.a.instance.setSelection(b),u=b.Qa;else if(Se.SelectionEditor.pf(u)){var aa;Se.SelectionEditor.Rib(u)&&(aa=Se.SelectionEditor.Q2(u,!1));aa||(aa=this.Lnd.get(P.SourceControlId)[0],Pe.characterPropertiesEditor.replaceTextRange(u,
aa,!0,void 0,b),aa=Kf.SelectionFactory.JL(u.node,u.cpBegin,u.cpBegin+aa.length));if(aa&&(Hh.a.instance.setSelection(aa),u=aa.Qa,Pe.U0b(u)))return Pe.Kd.UMb(!1),8}try{Pe.hyperlinkEditor.eH(u,this.Lnd.get(P.SourceControlId)[1],0<yi.HyperlinkReader.kMc(u).length);const ta=Kf.SelectionFactory.we(u.node,u.cpEnd);ta&&Hh.a.instance.setSelection(ta);l(P,"RecentLinks")}finally{h&&h.dispose()}w.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static hEb(b,h,u,y,P){if(Pe.tVc)return Pe.X9l(b,
h,u,y,P);if(!h.view.ue)return 2;var aa=h.view.Bb;if(!aa||!aa.hb||!aa.hb.length)return 8;var ta=aa.hb.kb;let Pa=ta.Qa.clone();if(2===ta.length){if(ta=ta.J(1),!Se.SelectionEditor.Ek(Pa)||!Se.SelectionEditor.Dk(ta)||Pa.node!==ta.node)return 8}else if(2<ta.length)return 8;if(aa.hb.YI)return 8;if(Pe.Yg.lya(be.ParagraphReader.MT,aa.Lg))return Pe.Mc.fc($c.a.vf,{["Reason"]:Zc.a.BN}),8;be.ParagraphReader.em(Pa)&&!Se.SelectionEditor.x7(Pa)&&(aa=Pa.node,Pa=nf.a.createTextRange(aa,0,be.ParagraphReader.textLength(aa)));
return b===Oa.a.eBd?Pe.Zxh(h,Pa,u,y):r.AFrameworkApplication.ya.Tf(Pa,b,u,!0,y,P)}static X9l(b,h,u,y,P){if(!h.view.ue)return 2;var aa=h.view.Bb;if(!aa||!aa.hb||!aa.hb.length||aa.hb.YI)return 8;var ta=aa.hb.kb;if(aa=Pe.pyf(ta))ta=Pe.snf(ta.Qa.clone(),!0);else{let Pa=ta.J(0).clone(),vb=1;for(;vb<ta.length&&(!be.ParagraphReader.textLength(Pa.node)||Se.SelectionEditor.Dk(Pa)||Pe.f2&&En.l(Pa));)Pa=ta.J(vb).clone(),vb++;ta=Pe.snf(Pa,!1)}return Pe.f2&&Se.SelectionEditor.Ek(ta)&&En.l(ta)||!Se.SelectionEditor.Ek(ta)&&
!aa?8:b===Oa.a.eBd?Pe.Zxh(h,ta,u,y):r.AFrameworkApplication.ya.Tf(ta,b,u,!0,y,P)}static pyf(b){if(1===b.length)return!0;if(2===b.length){const h=b.Qa.clone();b=b.J(1);return Se.SelectionEditor.Ek(h)&&Se.SelectionEditor.Dk(b)&&h.node===b.node?!0:!1}return!1}static yvh(b){let h=null;const u=[];for(let y=0;y<b.length;y++){const P=Pe.snf(b.J(y).clone(),!1);if(Se.SelectionEditor.Ek(P))Pe.f2&&En.l(P)||u.push(P);else if(!Se.SelectionEditor.Dk(P)&&!be.ParagraphReader.em(P))return{returnValue:!1,Mdb:h}}h=
u;return{returnValue:!Pe.f2||0<h.length?!0:!1,Mdb:h}}static insertLink(b,h,u,y,P){if(Pe.tVc)return Pe.fgm(h,u,P);y=Pe.bsj(h);if(32!==y)return y;let aa;if(!({hyperlink:aa}=Pe.tPa(h,!0)).returnValue||Pe.U0b(h)||!aa&&b==Oa.a.M2b)return 8;if(1===u)return 32;if(!aa&&Se.SelectionEditor.pf(h)&&Se.SelectionEditor.Rib(h)&&(b=Se.SelectionEditor.Q2(h,!1))&&(Hh.a.instance.setSelection(b),h=b.Qa,Pe.U0b(h)))return Pe.Kd.UMb(!1),8;aa&&w.ULS.sendTraceTag(593875799,324,50,"Edit link");cw.instance.Uzh(h,P,Pe.z2b,Pe.bookmarkManager);
return 32}static bsj(b){return!Pe.IZe()||!Pe.Lxd(b)||b.node.es||Hh.a.instance.hb.YI?8:pe.a.instance.J(4)&&Se.SelectionEditor.p3(b)||Ye.a.Avf(b)?2:32}static fgm(b,h,u){var y=Hh.a.instance.hb.kb;const P=Pe.pyf(y);if(P)b=[b];else if(!({Mdb:b}=Pe.yvh(y)).returnValue)return 8;if(!Pe.IZe())return 8;for(y=0;y<b.length;y++)if(!Pe.Lxd(b[y]))return 8;if(Hh.a.instance.hb.YI)return 8;y=Array(b.length);let aa=null;for(let ta=0;ta<b.length;ta++)if(y[ta]=b[ta],!({hyperlink:aa}=Pe.tPa(y[ta],!0)).returnValue||Pe.U0b(y[ta]))return 8;
if(1===h)return 32;if(!aa&&1===y.length&&P&&Se.SelectionEditor.pf(y[0])&&Se.SelectionEditor.Rib(y[0])&&(h=Se.SelectionEditor.Q2(y[0],!1))&&(Hh.a.instance.setSelection(h),y[0]=h.Qa,Pe.U0b(y[0])))return Pe.Kd.UMb(!1),8;P?cw.instance.Uzh(y[0],u,Pe.z2b,Pe.bookmarkManager):new cp(y,u);return 32}static iVi(b,h,u){if(Pe.tVc)return Pe.RDn(b,h,u);if(!Pe.Lxd(h)||pe.a.instance.J(4)&&Se.SelectionEditor.p3(h))return 2;let y;if(!({hyperlink:y}=Pe.tPa(h,!1)).returnValue)return 2;if(2===u){u=new dg.GraphTransaction(15);
try{u.Kk=b,u.Eb(y.paragraph),Pe.zXf(h)}finally{u&&u.dispose()}y.hyperlink.cG&&Pe.Kd.Ds(2)}return 32}static RDn(b,h,u){var y=Hh.a.instance.hb.kb;if(Pe.pyf(y))h=[h];else if(!({Mdb:h}=Pe.yvh(y)).returnValue)return 8;if(!Pe.IZe())return 8;for(y=0;y<h.length;y++)if(!Pe.Lxd(h[y]))return 8;if(1===u&&!Pe.tPa(h[0],!1).returnValue)return 2;if(2===u){for(u=0;u<h.length;u++)if(!Pe.tPa(h[u],!0).returnValue)return 2;u=new dg.GraphTransaction(15);try{const P=h[0];u.Kk=b;u.Eb(P.node);for(b=0;b<h.length;b++)Pe.zXf(h[b])}finally{u&&
u.dispose()}Pe.Kd.Ds(7)}return 32}static zXf(b){const h=yi.HyperlinkReader.kMc(b);let u=0;for(let y=0;y<h.length;y++)if(h[y].cpBegin>=u){const P=({cpEnd:u}=Pe.OI.waa(b,h[y])).returnValue;Pe.OI.kXf(b,P)}}static v2i(b,h,u){if(pe.a.instance.J(4)&&Jd.ImageReader.r1a(h)||!({hyperlink:b}=Pe.tPa(h,!1)).returnValue)return 2;2===u&&({cpBegin:h,cpEnd:u}=Pe.OI.waa(h,b),Hh.a.instance.setSelection(Kf.SelectionFactory.JL(b.paragraph,h,u)));return 32}static AIi(b,h,u){let y;if(pe.a.instance.J(4)&&({hyperlink:y}=
Pe.Gym(h)).returnValue)w.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:y}=Pe.tPa(h,!1)).returnValue)return 2;2===u&&Ra.App.IBb(y.hyperlink.url);return 32}static fOf(b,h,u){b=Jd.ImageReader.waa(h.node);if(!b)return 2;2===u&&Ra.App.IBb(b);return 32}static Zxh(b,h,u,y){if(pe.a.instance.J(4)&&Jd.ImageReader.r1a(h)||!ab.InteractiveViewManager.instance.editingView.Kj)return 2;let P;if(!({hyperlink:P}=Pe.tPa(h,!1)).returnValue)return 2;if(1===u)return 32;
({cpBegin:h,cpEnd:u}=Pe.OI.waa(h,P));Hh.a.instance.setSelection(Kf.SelectionFactory.JL(P.paragraph,h,u));h=ab.InteractiveViewManager.instance.EBa.ownerDocument.createElement("span");h.innerText=P.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return r.AFrameworkApplication.ya.Tf(b,Oa.a.dBd,2,!0,y,h)}static tPa(b,h){if(Se.SelectionEditor.Ek(b)){const u=En.g(b),y=Jj.a.all(u,P=>6===P.li);if(0<u.length&&(!Pe.f2||!y)||Pe.ag.qh&&Pe.B2&&0<Pe.B2.jJd(b).count)return{returnValue:!1,hyperlink:null}}return Pe.wym(b,
h)}static Gym(b){let h=null;return Jd.ImageReader.r1a(b)&&(h=yi.HyperlinkReader.b5b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static wym(b,h){let u=null;const y=yi.HyperlinkReader.kMc(b);return y.length?y[0].hyperlink?(u=y[0],b.cpBegin<y[0].cpBegin?{returnValue:h,hyperlink:u}:{returnValue:!0,hyperlink:u}):{returnValue:!1,hyperlink:u}:{returnValue:h,hyperlink:u}}static U0b(b){if(pe.a.instance.J(3)){b=Pe.Dh.aOa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Jd.changeType)return!0}return!1}static IZe(){return pe.a.instance.J(3)?
!0:!pe.a.instance.J(3)||!Ra.App.Bw.ejc}static Lxd(b){return Pe.ag.xZ(b)||Pe.ag.uva(b)||Pe.Gw()&&Pe.Gw().instance&&Pe.Gw().instance.PT(b)?!1:!0}static snf(b,h){return be.ParagraphReader.em(b)&&!Se.SelectionEditor.x7(b)&&(be.ParagraphReader.textLength(b.node)||h)?nf.a.createTextRange(b.node,0,be.ParagraphReader.textLength(b.node)):b}static QQl(b){return b&&b.length<=Pe.GRi?b:b.substring(0,Pe.GRi)+"..."}static SDl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,
h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static Mhe(b=!1){const h=Date.now();if(b||h-Pe.Cqi>Pe.gmo)Pm.instance.$Pm(),Pe.Cqi=h}static t7d(b,h,u){const y=new Map;y.set("Source",u);y.set("Action",h);Ta.Health.instance.recordKpiUsage(b,0,this.MUa,y)}}Pe.Om=null;Pe.vpb=null;Pe.WU=null;Pe.Lnd=new Map;Pe.uze=null;Pe.GRi=35;Pe.Cqi=Date.now();Pe.xOh=!1;Pe.MUa="wwaengidc";Pe.k_j="RecentLinks";Pe.R1g="RecentLinksRibbonOptions";Pe.Q1g=
"RecentLinksContextMenuOptions";Pe.ZYj="PopulateRecentLinksRibbon";Pe.$Yj="PopulateRecentLinksRibbonAction";Pe.XYj="PopulateRecentLinksContextMenu";Pe.YYj="PopulateRecentLinksContextMenuAction";Pe.CVj="PopulateRecentLinksContextMenu";Pe.DVj="PopulateRecentLinksContextMenuAction";Pe.UPj="InsertRecentLinks";Pe.VPj="InsertRecentLinksAction";Object(m.a)(Pe,"HyperlinkActor",null,[]);class sx{}sx.$Sc=Object.freeze({fbm:"WordIndentationShortcutUsage"});sx.eD="wwaengidc";Object(m.a)(sx,"IndentationConstants",
null,[]);class Ll{static get Vp(){return dv.a.SCb}static get Yg(){return im.ContextSetEditor.instance}static get ag(){return sd.a.instance}static get Mc(){return ri.a.instance}static get Nq(){return ab.InteractiveViewManager.instance}static Gw(){return Ll.Om||(Ll.Om=Ja.a.instance.Za("Box4.IExternalSelectionManager"))}static get ebm(){return null!=Ll.Eqg?Ll.Eqg:Ll.Eqg=Ja.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.GE,oc.a.view,
Ll.qBc);b.pa(Oa.a.GE,oc.a.outlineElement,Ll.Tih);b.Xc(Oa.a.GE,1036);b.pa(Oa.a.ML,oc.a.view,Ll.qBc);b.pa(Oa.a.ML,oc.a.outlineElement,Ll.Tih);b.Xc(Oa.a.ML,1036)}static Cvn(b){const h=new Map;b=b?b.ia(zi.a.vci,"Unknown"):"tab";h.set("actionCallSource",b);Ta.Health.instance.recordKpiUsage(sx.$Sc.fbm,1,sx.eD,h)}static qBc(b,h,u,y,P){const aa=h.view;if(!aa.ue)return 2;var ta=aa.Bb;if(!ta)return Ll.Mc.fc($c.a.vf,{["Reason"]:Zc.a.Nga}),8;ta=ta.Lg;if(!ta)return Ll.Mc.fc($c.a.vf,{["Reason"]:Zc.a.noSelection}),
8;if(Ye.a.dga(h))return 8;if(r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Ll.ag.m8b(ta))return Ll.Mc.fc($c.a.vf,{["Reason"]:Zc.a.hE}),8;if(1===u)return 32;if(Ll.Yg.RBa(Ll.SUe,ta))return Ll.Mc.fc($c.a.vf,{["Reason"]:Zc.a.oEc}),8;if(Ll.Yg.lya(be.ParagraphReader.MT,ta))return Ll.Mc.fc($c.a.vf,{["Reason"]:Zc.a.BN}),8;if(!r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Ll.ag.m8b(ta))return Ll.Mc.fc($c.a.vf,
{["Reason"]:Zc.a.hE}),8;if(Ll.Gw()&&Ll.Gw().instance&&Ll.Gw().instance.PT(ta))return Ll.Mc.fc($c.a.vf,{["Reason"]:Zc.a.externalSelection}),8;ta={};ta[Ur.a.JHa]=5794;ta[Ur.a.IHa]=5795;return Ll.ebm.qBc(aa,b,h,u,y,P,ta)}static Tih(b,h,u,y,P){var aa,ta;if(h.contextId!==oc.a.outlineElement)return 2;var Pa=h.clone().X6f();if(xh.TableReader.roi(Pa)){if(Ll.ag.soi(Pa))return Ll.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),8}else if(Ll.ag.$1a(Pa))return Ll.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),2;Pa=new yd.GraphIterator;
Pa.set(h.node);Se.SelectionEditor.eu(Pa);if(!wg.OutlineElementReader.Oh(Pa))return 2;let vb;switch(b){case Oa.a.GE:vb=Ll.Vp.Gyb(Pa);break;case Oa.a.ML:vb=Ll.Vp.R_b(Pa);break;default:return 2}if(1===u||!vb)return vb?32:8;u=0;b===Oa.a.ML&&P&&P.ia(ld.a.Jkh,!1)&&(u|=2);if(wg.OutlineElementReader.GP(Pa))return Ll.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.BN}),2;(null===(ta=null===(aa=Ll.Nq)||void 0===aa?void 0:aa.od)||void 0===ta?0:ta.sQ)&&Ll.Nq.editingView&&(Ll.Nq.editingView.CH=!0);switch(b){case Oa.a.GE:Ll.Vp.SQa(Pa,
-1,u);break;case Oa.a.ML:Ll.Vp.kGc(Pa,1)}y&&kr.a.$nb&&(y.Xr|=kr.a.agb(h.node,!0));Ll.Cvn(P);return 32}}Ll.Om=null;Ll.SUe=Jd.ImageReader.q1a;Object(m.a)(Ll,"IndentationActor",null,[]);var tn=c(1533);class ml{static get paragraphEditor(){return null!=ml.Qug?ml.Qug:ml.Qug=Ja.a.instance.resolve("Box4.IParagraphEditor")}static get rk(){return null!=ml.cxg?ml.cxg:ml.cxg=Ja.a.instance.resolve("Box4.ITableEditor")}static get ag(){return sd.a.instance}static get Mc(){return ri.a.instance}static Gw(){return ml.Om||
(ml.Om=Ja.a.instance.Za("Box4.IExternalSelectionManager"))}static Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.xhj,oc.a.view,(h,u)=>Ye.a.dga(u)?8:32);b.pa(Oa.a.leftJustify,oc.a.view,tn.a.Nv);b.pa(Oa.a.leftJustify,oc.a.paragraph,ml.bBa);b.pa(Oa.a.leftJustify,oc.a.table,ml.UVe);b.Xc(Oa.a.leftJustify,1036);b.pa(Oa.a.centerJustify,oc.a.view,tn.a.Nv);b.pa(Oa.a.centerJustify,oc.a.paragraph,ml.bBa);b.pa(Oa.a.centerJustify,oc.a.table,ml.UVe);b.Xc(Oa.a.centerJustify,1036);b.pa(Oa.a.rightJustify,oc.a.view,
tn.a.Nv);b.pa(Oa.a.rightJustify,oc.a.paragraph,ml.bBa);b.pa(Oa.a.rightJustify,oc.a.table,ml.UVe);b.Xc(Oa.a.rightJustify,1036);b.pa(Oa.a.fullJustify,oc.a.view,tn.a.Nv);b.pa(Oa.a.fullJustify,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.fullJustify,1036);b.pa(Oa.a.NGc,oc.a.view,tn.a.Nv);b.pa(Oa.a.NGc,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.NGc,1036);b.pa(Oa.a.xGb,oc.a.view,tn.a.Nv);b.pa(Oa.a.xGb,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.xGb,1036);b.pa(Oa.a.a3c,oc.a.view,tn.a.Nv);b.pa(Oa.a.a3c,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.a3c,
1036);b.pa(Oa.a.N$b,oc.a.view,tn.a.Nv);b.pa(Oa.a.N$b,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.N$b,1036);b.pa(Oa.a.h0b,oc.a.view,tn.a.Nv);b.pa(Oa.a.h0b,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.h0b,1036);b.pa(Oa.a.hfc,oc.a.view,tn.a.Nv);b.pa(Oa.a.hfc,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.hfc,1036);b.pa(Oa.a.h4b,oc.a.view,tn.a.Nv);b.pa(Oa.a.h4b,oc.a.paragraph,ml.bBa);b.Xc(Oa.a.h4b,1036)}static UVe(b,h,u,y){let P=!0;if(!h)return 8;xh.TableReader.roi(h)?ml.ag.soi(h)?(ml.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),P=!1):ml.Gw()&&ml.Gw().instance&&
ml.Gw().instance.PT(h)&&(ml.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.externalSelection}),P=!1):(ml.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.Q9e}),P=!1);if(1===u||!P)return P?32:8;h=h.node;switch(b){case Oa.a.leftJustify:ml.rk.zD(h,1);break;case Oa.a.centerJustify:ml.rk.zD(h,2);break;case Oa.a.rightJustify:ml.rk.zD(h,3)}y&&kr.a.$nb&&(y.Xr|=2);return 32}static bBa(b,h,u,y,P){let aa=!0;h.contextId!==oc.a.paragraph?aa=!1:ml.ag.$1a(h)?(ml.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),aa=!1):ml.Gw()&&ml.Gw().instance&&ml.Gw().instance.PT(h)&&
(ml.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.externalSelection}),aa=!1);if(1===u||!aa)return aa?32:8;h=h.node;u=be.ParagraphReader.Vv(h);switch(b){case Oa.a.leftJustify:case Oa.a.N$b:ml.paragraphEditor.zD(h,1===u&&ml.hVd(P)?6:1);break;case Oa.a.centerJustify:case Oa.a.h0b:ml.paragraphEditor.zD(h,2===u&&ml.hVd(P)?1:2);break;case Oa.a.rightJustify:case Oa.a.hfc:ml.paragraphEditor.zD(h,3===u&&ml.hVd(P)?1:3);break;case Oa.a.fullJustify:case Oa.a.h4b:ml.paragraphEditor.zD(h,6===u&&ml.hVd(P)?1:6);break;case Oa.a.xGb:ml.paragraphEditor.zD(h,
11);break;case Oa.a.NGc:ml.paragraphEditor.zD(h,7);break;case Oa.a.a3c:ml.paragraphEditor.zD(h,13)}y&&kr.a.$nb&&(y.Xr|=kr.a.agb(h));return 32}static hVd(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}ml.Om=null;Object(m.a)(ml,"JustificationActor",null,[]);const SA=()=>{const b=r.AFrameworkApplication.ya;b.pa(Oa.a.save,le.a.frame,Xz);b.pa(Oa.a.sync,le.a.frame,dw)},dw=(b,h,u)=>{if(1===u)return 32;r.AFrameworkApplication.ya.processAction(Oa.a.Iyb,
2);Ra.App.kk.xee();return 32},Xz=(b,h,u)=>{if(1===u)return 2===Ra.App.xa.mode?32:8;r.AFrameworkApplication.ya.processAction(Oa.a.Iyb,2);if(2!==Ra.App.xa.mode)return 32;Ra.App.kk.U0i(null,null);return 32};class ym{constructor(){this.activateRibbonTab=(b,h,u,y,P)=>{Ra.App.Bw.kI.s9d(P.toString());return 32};this.eCm=(b,h,u,y,P)=>{r.AFrameworkApplication.Bga("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Ra.App.Bw.kI.Wpi(1,P.toString());return 32};this.l$m=(b,h)=>{if(h.contextId!==
le.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.activateRibbonTab,oc.a.view,this.activateRibbonTab);b.Xc(Oa.a.activateRibbonTab,5);b.pa(Oa.a.Xpi,oc.a.view,this.eCm);b.pa(Oa.a.Pij,le.a.frame,this.l$m)}static get instance(){return null!=ym.hrg?ym.hrg:ym.hrg=ym.Jl()}static Jl(){return new ym}}Object(m.a)(ym,"RibbonActor",null,[]);var Tt=c(570);class Os{constructor(b,h){this.Yl=null;this.Wso=(u,y,P,aa,ta)=>{let Pa;aa=y.view;if(!aa.ue)return Os.Mc.fc($c.a.vf,
{["Reason"]:Zc.a.fIb}),8;Pa=u===Oa.a.undo?this.Kh.bX:this.Kh.nOa;if(1===P)return Ye.a.dga(y)&&Ye.a.B8b()?8:Pa?32:8;if(!Pa)return w.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",u===Oa.a.undo?"undo":"redo"),this.oIa.value.vmj(),Os.Mc.fc($c.a.vf,{["Reason"]:Zc.a.Rso}),2;y=new dg.GraphTransaction(3);y.Eb(aa.jd);y.B1f();u=u===Oa.a.undo?this.Kh.undo():this.Kh.redo();y.dispose();ta&&xf.GrippersManager.instance.MOb(ta.ox);if(u)return 32;Os.Mc.fc($c.a.w2b,{["Reason"]:Zc.a.EAi});
return 8};this.wka=b;this.oIa=h}get Kh(){return this.Yl||(this.Yl=this.wka())}Wb(){const b=r.AFrameworkApplication.ya,h=this.Wso;b.gb(Oa.a.undo,oc.a.view,h,1028);b.gb(Oa.a.redo,oc.a.view,h,1028)}static get instance(){return null!=Os.Qqg?Os.Qqg:Os.Qqg=Os.Jl()}static Jl(){const b=Ja.a.instance;return new Os(()=>b.resolve("Box4.IUndoManager"),b.af("Box4.ICoauthCashTelemetry"))}static get Mc(){return ri.a.instance}}Object(m.a)(Os,"UndoActor",null,[]);class Qw{constructor(){this.W=null}get name(){return"Box4.Actors"}xc(b){this.W=
b;(new Tz).xc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");b.Wb();b.c4();KA();Pu.instance.Wb();Pe.Wb();Ll.Wb();ml.Wb();this.W.resolve("Box4.Actors.TouchInputActor").Wb();su.instance.Wb();this.W.resolve("Box4.ISelectAllHandlers").Wb();SA();this.W.resolve("Box4.Actors.ProofingActor").Wb();ym.instance.Wb();(b=this.W.Pa("Box4.IFeatureHelper"))?b.hp.continueWith(()=>{this.ITi()}):this.ITi();Tt.a.Wb(Ra.App.GSa);this.W.resolve("Box4.Actors.TextFormattingActor").Wb();Os.instance.Wb();this.W.resolve("Box4.Actors.AccessibilityActor").hWf();
this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Ra.App.xa.updateCommandUI()}ITi(){pe.a.instance.J(7)&&(this.W.resolve("Box4.Actors.StyleContextMenuActor").Wb(),this.W.resolve("Box4.Actors.StyleActor").Wb())}dispose(){}static main(){K.a.instance.Kc(new Qw)}}Object(m.a)(Qw,"Box4ActorsPackage",null,[1,2]);class Yz extends Ou{constructor(b,h,u,y){super(b);this.Xla=u;this.Dha=y;this.Hfg=0;this.ry=h.XPa("UserAction","WordOnlineAddToDictionary")}W3f(b){this.BFd=
this.Xla.qma(b);if(!this.VCk())return!1;const h=this.BFd.errorDetails.token;this.Dha.peh(h);if(!this.Dha.A5c(h))return w.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;w.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.ry.start();this.transaction=new dg.GraphTransaction(15);this.transaction.Eb(b.node);return!0}h5d(b){this.QJb(b.node);return!0}TYc(b){this.QJb(b);return!0}i5d(b){this.QJb(b.node)}I9f(b){this.transaction.dispose();
this.BFd.errorDetails.oob(b.actionId);this.Dha.X9d("unused corelation id.");this.ry.stop();w.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.Hfg,this.ry.vi,this.BFd.errorDetails.proofingType));return!0}Dhc(b,h){const u=b.role;return super.Dhc(b,h)||9===u||10===u||13===u||7===u||8===u}QJb(b){if(b){var h=this.Xla.Y2(b,u=>this.Dha.A5c(u.errorDetails.token));this.Xla.Wlb(b,h,!0);this.Hfg+=h.length}}VCk(){var b,
h;return null!==(h=null===(b=this.BFd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(w.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(m.a)(Yz,"AddToDictionaryCallbackSteps",Ou,[]);class hy{constructor(b,h,u,y,P,aa,ta){this.Bc=b;this.Bb=h;this.X1c=u;this.Xla=y;this.rq=P;this.Dha=aa;this.Knn=ta;this.D1l=(Pa,vb,Kb,Sb,Yb,Ac)=>{const Sc=new Yz(this.X1c,this.rq,this.Xla,this.Dha);return new Dg(Pa,vb,Kb,Sb,Yb,Ac,Sc,
this.Bc,this.Bb,this.X1c,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Wb(){this.Bc.tS(Oa.a.addToDictionary,oc.a.view,this.D1l,1124);this.Knn.dBn(this.Dha)}}Object(m.a)(hy,"PersonalDictionaryOrchestrator",null,[]);class cz{get name(){return"Box4.PersonalDictionary"}xc(b){this.container=b;b.register(hy,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Xd(()=>new hy(r.AFrameworkApplication.ya,Hh.a.instance,vt.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),
b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Wb()}dispose(){}static main(){Zh.a.get_instance().al(7,()=>{K.a.instance.Kc(new cz)})}}Object(m.a)(cz,"PersonalDictionaryPackage",null,[1,2]);class Dt{constructor(b,h,u,y,P,aa){this.Eza=this.n8a=this.fV=null;this.VCc=(ta,Pa,vb,Kb,Sb)=>this.Jni(Pa,vb,Sb,!1)?32:8;this.wF=
(ta,Pa,vb,Kb,Sb)=>{if(!({Lx:ta}=this.c$i(Pa,vb,Sb,!0)).returnValue)return ta;w.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Sb=this.a5j.GBa(Pa.node,Sb);this.kgn(Pa.node,Sb);this.MO();return 32};this.Uyb=(ta,Pa,vb,Kb,Sb)=>{if(!({Lx:ta}=this.c$i(Pa,vb,Sb,!1)).returnValue)return ta;this.ggn(Pa.node);return 32};this.Yon=(ta,Pa,vb,Kb,Sb)=>{if(1===vb)return 32;if(!Pa||!Pa.view.ue)return 2;ta=Pa.view.Bb;if(!ta)return 2;ta=ta.Lg;if(!ta)return 2;ta=Dt.Yg.XP(ta,
16);if(!ta||!ta.length)return 2;Pa=null;for(vb=0;vb<ta.length;vb++){Kb=ta.getContext(vb);if(!Kb||Kb.contextId!==oc.a.tableCell)return 2;const Yb={};this.t9h(Kb,Yb);if(Yb.CellShading)if(Pa&&Pa!==Yb.CellShading){Pa=null;break}else Pa=Yb.CellShading;else{Pa=null;break}}Sb.CellShading=Pa;return 32};this.$Jb=(ta,Pa,vb,Kb,Sb)=>1===vb?32:this.t9h(Pa,Sb);this.uJb=(ta,Pa,vb,Kb,Sb)=>{if(1===vb)return 32;ta=Pa.contextId===oc.a.view?this.Yza.wLd(Pa):this.hlf(Pa);vb={};Pa=null;32===r.AFrameworkApplication.ya.Ub(Oa.a.$Jb,
2,vb)&&vb&&(Pa=vb.CellShading);vb="";Pa&&(vb=rn.a.jE(Pa)||"");this.c9i.Hfc=vb;this.QRc&&this.recentColors.gdg(vb);ta=this.c9i.mId(ta,Ra.App.D0b);if(!ta)return 8;Sb.MenuItems=ta;w.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.$ga=(ta,Pa,vb,Kb,Sb)=>{if(1===vb)return 32;Ra.App.xa.Ew();r.AFrameworkApplication.ya.Ub(Oa.a.$Jb,2,Sb);this.n8a=new ot.a("Shading",Oa.a.agc);this.n8a.O3c(Sb&&Sb.CellShading?Sb.CellShading:0);return 32};this.PBk=(ta,Pa,vb,Kb,Sb)=>{if(1===
vb)return 32;r.AFrameworkApplication.ya.Ub(Oa.a.C8,2,Sb);this.recentColors.fcb(Sb)||w.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.a5j=h;this.xDe=u;this.Yza=y;this.Ud=P;this.Eo=aa}get recentColors(){return null!=this.zvg?this.zvg:this.zvg=Ja.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get c9i(){this.fV||(this.fV=new $v.a("Shading"),this.b1a(this.fV));return this.fV}b1a(b){b.gea(2,Oa.a.Uyb);b.gea(3,Oa.a.C8);b.gea(4,
Oa.a.C8);b.iZb(this.xDe,1)}Wb(){this.ga.pa(Oa.a.uJb,oc.a.view,this.uJb);this.ga.pa(Oa.a.uJb,oc.a.tableCell,this.uJb);this.ga.Xc(Oa.a.uJb,1126);this.ga.pa(Oa.a.VCc,oc.a.view,Tt.a.AJc);this.ga.pa(Oa.a.VCc,oc.a.tableCell,this.VCc);this.ga.Xc(Oa.a.VCc,1028);this.ga.pa(Oa.a.C8,oc.a.view,Tt.a.AJc);this.ga.pa(Oa.a.C8,oc.a.tableCell,this.wF);this.ga.Xc(Oa.a.C8,1028);this.ga.pa(Oa.a.Uyb,oc.a.view,Tt.a.AJc);this.ga.pa(Oa.a.Uyb,oc.a.tableCell,this.Uyb);this.ga.Xc(Oa.a.Uyb,1028);this.ga.pa(Oa.a.$Jb,oc.a.view,
this.Yon);this.ga.pa(Oa.a.$Jb,oc.a.tableCell,this.$Jb);this.ga.Xc(Oa.a.$Jb,1124);this.ga.pa(Oa.a.agc,oc.a.view,Tt.a.AJc);this.ga.pa(Oa.a.agc,oc.a.tableCell,this.PBk);this.ga.Xc(Oa.a.agc,1028);this.ga.pa(Oa.a.hOf,oc.a.view,this.$ga);this.ga.Xc(Oa.a.hOf,1028)}MO(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport",
"WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}c$i(b,h,u,y){return this.Jni(b,h,u,y)?{returnValue:2===h,Lx:32}:(2==h&&Tt.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Zc.a.Ufl),{returnValue:!1,Lx:8})}Jni(b,h,u,y){return b.contextId!==oc.a.tableCell||2===h&&(y&&!u||!b.node)?!1:!0}kgn(b,h){const u=new dg.GraphTransaction(15);u.Eb(b);this.O7i(b);b.properties.setValue(Ge.a.wF,h);u.dispose()}ggn(b){const h=new dg.GraphTransaction(15);h.Eb(b);this.O7i(b);b.properties.removeProperty(Ge.a.wF);
h.dispose()}hlf(b){return b.contextId!==oc.a.tableCell?null:(b=Dt.mh.Wt(b.node))?b:null}O7i(b){if(this.Ud&&this.Ud.zg&&(b=Object(na.a)(Jw.TableCellNode,b))){const h=b.TQ();this.Eo.Z2c(b,h)}}t9h(b,h){if(b.contextId!==oc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(Ge.a.wF)&&(h.CellShading=b.getValue(Ge.a.wF));return 32}static xvl(){return new Dt(r.AFrameworkApplication.ya,Wj.a.instance,Aw.a.instance,se.PageReader.instance,Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get mh(){return xl.PageNavigator.instance}static get Yg(){return null!=Dt.hng?Dt.hng:Dt.hng=im.ContextSetEditor.instance}static get instance(){return null!=Dt.ksg?Dt.ksg:Dt.ksg=Dt.xvl()}get QRc(){null==this.Eza&&(r.AFrameworkApplication.Ce("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.Eza=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",
!1):!1);return this.Eza}}Object(m.a)(Dt,"CellShadingActor",null,[]);class iy{constructor(){this.W=null}get name(){return"Box4.CellShading"}xc(b){this.W=b}init(){const b=this.W.Pa("Box4.IFeatureHelper");b?b.hp.continueWith(()=>{this.$m()}):this.$m()}$m(){Dt.instance.Wb();Ra.App.xa.updateCommandUI()}dispose(){}}Object(m.a)(iy,"CellShadingPackage",null,[1,2]);var Yr;(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=
5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Yr||(Yr={}));Object(m.b)("ListStyle",Yr);const tu={[Yr.style1]:{[1]:"disc",[0]:"decimal"},[Yr.style2]:{[1]:"circle",[0]:"lower-alpha"},[Yr.style3]:{[1]:"square",[0]:"lower-roman"},[Yr.style4]:{[0]:"upper-alpha"},[Yr.style5]:{[0]:"upper-roman"},[Yr.bullet]:{[1]:"bullet"}};var Rw;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(Rw||
(Rw={}));Object(m.b)("ListType",Rw);var TA=c(654);class Xq{constructor(b,h){this.bB=this.HTc=null;this.levelText=b;this.font=h}get Y4d(){return this.levelText}get listStyle(){return 6}get mt(){return"left"}}Object(m.a)(Xq,"ListMarkerBullet",null,[547]);class Qh{static get xn(){return null!=Qh.jtg?Qh.jtg:Qh.jtg=Ja.a.instance.resolve("Box4.List.IListEditor")}static get hd(){return Qh.If||(Qh.If=Ja.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){Qh.If=b}static get uj(){return null!=Qh.Jqg?
Qh.Jqg:Qh.Jqg=Ja.a.instance.resolve("Box4.IInsertionPointFormatting")}static Gw(){return Qh.Om||(Qh.Om=Ja.a.instance.Za("Box4.IExternalSelectionManager"))}static get Yg(){return im.ContextSetEditor.instance}static get ag(){return sd.a.instance}static get Mc(){return ri.a.instance}static get hh(){return Rt.a.getInstance()}static get j4c(){return null!=Qh.dwg?Qh.dwg:Qh.dwg=Ja.a.instance.Pa("Box4.List.ISingleLevelListEditor")}static Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.qB,oc.a.view,Qh.mBc);
b.pa(Oa.a.qB,oc.a.outlineElement,Qh.Psa);b.Xc(Oa.a.qB,1036);b.pa(Oa.a.uJ,oc.a.view,Qh.mBc);b.pa(Oa.a.uJ,oc.a.outlineElement,Qh.Psa);b.Xc(Oa.a.uJ,1036);Qh.hd.Ir&&(b.pa(Oa.a.sba,oc.a.view,Qh.mBc),b.pa(Oa.a.sba,oc.a.outlineElement,Qh.Psa),b.Xc(Oa.a.sba,1036));b.pa(Oa.a.IVe,oc.a.view,De.ActionManager.Mf);b.pa(Oa.a.Hsh,oc.a.view,De.ActionManager.Mf);b.pa(Oa.a.joinList,oc.a.view,Qh.VJn);b.pa(Oa.a.rVe,oc.a.view,De.ActionManager.Mf);b.pa(Oa.a.JVe,oc.a.view,De.ActionManager.Mf);b.pa(Oa.a.O8f,oc.a.view,De.ActionManager.Mf);
b.pa(Oa.a.ggj,oc.a.view,De.ActionManager.Mf);b.pa(Oa.a.Sge,oc.a.view,De.ActionManager.Mf)}static VJn(){TA.a.$Yi();return 32}static mBc(b,h,u,y,P){var aa,ta,Pa;if(!h.view.ue)return 2;const vb=Qh.Mc.Xo(Oa.a.mBc);y.Xr=42;y.RB=42;const Kb={[Ur.a.JHa]:5796,[Ur.a.IHa]:5797};var Sb=h.view;if(Qh.Yg.RBa(Qh.I$l,Sb.Bb.Lg))return Qh.Mc.fc($c.a.vf,{["Reason"]:Zc.a.A2e}),vb.end(),8;if(Qh.Yg.RBa(Qh.SUe,Sb.Bb.Lg))return Qh.Mc.fc($c.a.vf,{["Reason"]:Zc.a.oEc}),vb.end(),8;if(Qh.Yg.lya(be.ParagraphReader.MT,Sb.Bb.Lg))return Qh.Mc.fc($c.a.vf,
{["Reason"]:Zc.a.BN}),vb.end(),8;if(Qh.ag.m8b(Sb.Bb.Lg))return Qh.Mc.fc($c.a.vf,{["Reason"]:Zc.a.hE}),vb.end(),8;if(null===(ta=null===(aa=Qh.Gw())||void 0===aa?void 0:aa.instance)||void 0===ta?0:ta.PT(h))return Qh.Mc.fc($c.a.vf,{["Reason"]:Zc.a.externalSelection}),vb.end(),8;if(1===u)return vb.end(),32;P||(P=new uh.DictionaryPropertySet);aa=null;if(2===u){aa=new dg.GraphTransaction(15);aa.Eb(h.view.jd);Qh.pSc=!1;ta=Ct.OutlineElementGeneralizer.ima(Sb.Bb.hb,!1);if(!ta)return aa.dispose(),Qh.Mc.fc($c.a.ama,
{["Reason"]:Zc.a.jGd}),vb.end(),8;1<ta.length&&P.setValue(ld.a.Bzi,null);const Yb=P.ia(ld.a.bJ,-1),Ac=P.ia(ld.a.$v,-1);null===(Pa=Qh.j4c)||void 0===Pa?void 0:Pa.oEk(ta);if(Pa=Qh.f5n(Yb,Ac,ta))P.setValue(ld.a.$v,16),P.setValue(ld.a.Rva,0);if(!Se.SelectionEditor.pf(Sb.Bb.Lg)&&!Pa&&0<ta.length&&Yb){Sb=new yd.GraphIterator;Pa=Array(ta.length);for(let Sc=0;Sc<ta.length;Sc++)Sb.set(ta.getContext(Sc).node),Pa[Sc]=Qh.hd.Qu(Sb);Qh.e5n(Pa,P)&&(Sb=new uh.DictionaryPropertySet,Sb.setValue(ld.a.$v,16),Sb.setValue(ld.a.Rva,
0),Rt.a.uX&&(Sb.setValue(zi.a.Rna,"clean-list-before-apply-new-list-style"),Sb.setValue(zi.a.vga,P.ia(zi.a.Rna,"unknown")+"@"+P.ia(zi.a.vga,"undefined"))),Ur.a.yoa(b,h,u,y,Sb,Kb,11),r.AFrameworkApplication.ya.processAction(Oa.a.ggj,2),w.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Qh.pSc=!0)}Sb=new yd.GraphIterator;Sb.set(ta.getContext(0).node);Sb=Qh.hd.Qu(Sb);Qh.GKm(Yb,Ac,Sb,ta.length)}b=Ur.a.yoa(b,h,u,y,P,Kb,11);32===b&&P.ia(ld.a.Jkh,!1)&&(b=Ur.a.yoa(Oa.a.ML,
h,u,y,P,Kb,11));aa&&aa.dispose();vb.end();return b}static e5n(b,h){let u=null;var y=!1;for(let P=b.length-1;0<=P&&(u?(y=b[P],y=-1!==h.ia(ld.a.bJ,-3)?y?u.listType!==y.listType||u.listStyle!==y.listStyle:!0:y?u.listType!==y.listType:!0):u=b[P],!y);P--);return u&&(b=!1,y||(b=h.ia(ld.a.$v,42),h=h.ia(ld.a.bJ,-3),b=b!==u.listType||0<h),y||b)?!0:!1}static GKm(b,h,u,y){0>=y||Qh.pSc||(b?u?(u=u.listType,-1===b&&h===u?(r.AFrameworkApplication.ya.processAction(Oa.a.Sge,2),w.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):
0<b&&(!h||1===h)&&(r.AFrameworkApplication.ya.processAction(h?Oa.a.rVe:Oa.a.JVe,2),w.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(r.AFrameworkApplication.ya.processAction(h?Oa.a.rVe:Oa.a.JVe,2),Qh.Jpo(),w.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(r.AFrameworkApplication.ya.processAction(Oa.a.Sge,2),w.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static f5n(b,
h,u){if(-1!==b&&b||!u.length)return!1;b=new yd.GraphIterator;let y=null;for(let P=u.length-1;0<=P&&!(b.set(u.getContext(P).node),y=Qh.hd.Qu(b));P--);return y&&h===y.listType?!0:!1}static Psa(b,h,u,y,P){if(h.contextId!==oc.a.outlineElement)return 2;var aa=h.clone().X6f();if(Qh.ag.$1a(aa))return Qh.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),2;const ta=new yd.GraphIterator;ta.set(h.node);Se.SelectionEditor.eu(ta);if(!wg.OutlineElementReader.Oh(ta))return 2;if(1===u)switch(b){case Oa.a.qB:return 32;case Oa.a.uJ:return 32;
case Oa.a.sba:return 32;default:return 2}if(wg.OutlineElementReader.GP(ta))return Qh.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.BN}),2;h=Qh.hd.Qu(ta);var Pa;Rt.a.uX&&(Pa=Object.freeze(null===h||void 0===h?void 0:h.clone()));let vb=P;if(!vb)return 8;Qh.hd.Ir?(b===Oa.a.uJ||b===Oa.a.qB||b===Oa.a.sba?(vb=Qh.xn.j3b(b,vb),aa=Sr.a.KP(vb.getValue(ld.a.$v),vb.getValue(ld.a.Rva))):aa=null,Qh.m_(b,vb),Qh.FZn(aa,vb)):(vb=Qh.xn.j3b(b,vb),aa=Sr.a.KP(vb.getValue(ld.a.$v),vb.getValue(ld.a.Rva)));let Kb=!1;b===Oa.a.qB&&vb&&(vb.hasProperty(Lc.a.Vt)&&
(aa.levelText=vb.ia(Lc.a.Vt,"")),vb.hasProperty(Ge.a.font)&&(aa.font=vb.ia(Ge.a.font,"")),vb.hasProperty(ld.a.pef)&&(Kb=vb.ia(ld.a.pef,!1)));Qh.t0n(vb,ta);aa=Qh.xn.Psa(vb,ta,aa,Kb);if(!aa.returnValue)return Qh.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.HBf}),2;aa=aa.LDa;Rt.a.uX&&Qh.Ivn(P,Pa,aa);2===u&&(u=P.ia(ld.a.$v,-1),aa&&-1!==u&&((Pa=P.ia(Lc.a.Gr,"Invalid MultiLevel Type"),b===Oa.a.uJ&&w.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===P||void 0===
P?void 0:P.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:Yr[null==(null===h||void 0===h?void 0:h.listStyle)?null===aa||void 0===aa?void 0:aa.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:Rw[null==(null===h||void 0===h?void 0:h.listType)?null===aa||void 0===aa?void 0:aa.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===aa||void 0===aa?void 0:aa.listType)})),h)?aa.listType&&1!==aa.listType||Qh.pSc||(r.AFrameworkApplication.ya.processAction(Oa.a.O8f,
2),w.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",u?"Bullet":"Numbering",Pa)):16===aa.listType?(r.AFrameworkApplication.ya.processAction(Oa.a.Hsh,2),w.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",u?"Bullet":"Numbering",Pa)):aa.listType&&1!==aa.listType||Qh.pSc||(r.AFrameworkApplication.ya.processAction(Oa.a.IVe,2),w.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",u?"Bullet":"Numbering",Pa))),(b=ub.FocusManager.instance())&&
b.currentScope&&b.currentScope.name===$g.AppFrame.Xoa&&b.qC(xe.AFrame.So));y.Xr=aa.listType;y.RB=aa.listStyle;return 32}static Ivn(b,h,u){var y,P,aa,ta,Pa,vb,Kb,Sb;const Yb=new Map;Yb.set("actionCallSource",b.ia(zi.a.Rna,"unknown"));Yb.set("actionCallSourceTrigger",b.ia(zi.a.vga,"undefined"));Yb.set("fromListType",Rw[null!==(y=null===h||void 0===h?void 0:h.listType)&&void 0!==y?y:16]);Yb.set("fromListStyle",Yr[null!==(P=null===h||void 0===h?void 0:h.listStyle)&&void 0!==P?P:0]);Yb.set("fromListMarkerType",
null!==(Pa=a(null!==(aa=null===h||void 0===h?void 0:h.listStyle)&&void 0!==aa?aa:0,null!==(ta=null===h||void 0===h?void 0:h.listType)&&void 0!==ta?ta:16))&&void 0!==Pa?Pa:"undefined");Yb.set("fromLevelText",(null===h||void 0===h?0:h.Qma)?h.levelText:"undefined");Yb.set("toListType",null!==(vb=Rw[null===u||void 0===u?void 0:u.listType])&&void 0!==vb?vb:"undefined");Yb.set("toListStyle",null!==(Kb=Yr[null===u||void 0===u?void 0:u.listStyle])&&void 0!==Kb?Kb:"undefined");Yb.set("toListMarkerType",null!==
(Sb=a(null===u||void 0===u?void 0:u.listStyle,null===u||void 0===u?void 0:u.listType))&&void 0!==Sb?Sb:"undefined");Yb.set("toLevelText",(null===u||void 0===u?0:u.Qma)?u.levelText:"undefined");Ta.Health.instance.recordKpiUsage(Nf.a.$Sc.nEm,0,Nf.a.eD,Yb)}static t0n(b,h){var u=new yd.GraphIterator;u.ed(h);(h=u.Rb(2))&&be.ParagraphReader.ic(h)&&(u=Hh.a.instance.hb.kb)&&u.Qa&&u.Qa.node===h&&Se.SelectionEditor.LUd(u)&&(Qh.UXn(b),Qh.RXn(b))}static FZn(b,h){h.hasProperty(Lc.a.Gr)&&b.Gae(h.getValue(Lc.a.Gr));
h.hasProperty(zi.a.tP)&&(b.tP=h.getValue(zi.a.tP));h.hasProperty(Lc.a.Vt)&&(b.levelText=h.getValue(Lc.a.Vt));b.bJ=h.ia(ld.a.bJ,-1);let u=null;b.Ena&&(u=Qh.xIl(b,h));b.Ena&&u?Qh.o0n(b,u):(b.Ena?w.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.bJ,b.Gr,b.Rt):w.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),Qh.IWn(b))}static IWn(b){if(b.Rt)b.cPd&&
-1===b.bJ||(b.levelText="%1.",b.propertySet.hasProperty(Ge.a.L3)||b.F8(0,1));else if(1===b.listType)b.cPd&&-1===b.bJ||(b.font=Nf.a.YFc,b.levelText=Nf.a.OCd,b.propertySet.hasProperty(Ge.a.L3)||b.F8(1,6));else return;b.mt="left"}static o0n(b,h){1===b.Gr?Qh.$Zn(b,h):Qh.uYn(b,h)}static $Zn(b,h){(b.bB=h.bB)?b.H4=h.bB.H4:h.bB||w.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.bJ,b.Gr,b.Rt)}static uYn(b,h){b.levelText=
h.levelText;b.Rt?b.F8(0,h.listStyle):(b.font=h.font,b.F8(1,1));b.mt=h.mt}static xIl(b,h){let u=null;2===b.Gr?u=b.Rt?Ja.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ja.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Gr&&(u=Ja.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let y=u.YGb.value;const P=b.bJ+"";P in y||(y=u.Q7,w.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
P,b.Gr,b.Rt));if(!(P in y)){w.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",P,b.Gr,b.Rt);if(h.hasProperty(Ge.a.font))return w.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",P,b.Gr,b.Rt),b=h.ia(Ge.a.font,""),new Xq(A.a.fromCharCode(parseInt(P)),b);w.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
P,b.Gr,b.Rt)}return y[P]}static RXn(b){Qh.uj.hasProperty(Ge.a.fontColor)&&b.setValue(Ge.a.fontColor,Qh.uj.fontColor())}static UXn(b){Qh.uj.hasProperty(Ge.a.fontSize)&&b.setValue(Ge.a.fontSize,Qh.uj.fontSize())}static m_(b,h){b=b===Oa.a.qB?0:b===Oa.a.uJ?1:b===Oa.a.sba?2:-1;h=h.ia(ld.a.bJ,-1);w.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static Jpo(){const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");if(b){var h=r.AFrameworkApplication.K.pc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(u=>{window.setTimeout(()=>{u.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else w.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Qh.I$l=Jd.ImageReader.UQc;Qh.SUe=Jd.ImageReader.q1a;Qh.If=null;Qh.Om=null;Qh.pSc=!1;Object(m.a)(Qh,"ListActor",null,[]);class uu{constructor(){this.YGb=new Zf.a(Object(v.a)(this,this.J4e,"createListMarkerDictionary"));this.Q7={}}BRh(b){return b}}Object(m.a)(uu,"AListMarkerGalleryLoader",
null,[647]);var Hv=c(1352),tx=c(441);class dp extends uu{constructor(){super();this.ztb=new bm.a(la.a.Ri())}BRh(b){dp.uP||this.DVn();b in dp.uP&&(b=dp.uP[b]);return b}J4e(){const b={};b["0"]=new Xq(Box4Intl.Box4Strings.L_ListStyleNone,Hv.a.vfi);b["1"]=new Xq(String.fromCharCode(61623),"Symbol");b["2"]=new Xq(String.fromCharCode(111),"Courier New");b["3"]=new Xq(String.fromCharCode(61607),"Wingdings");b["4"]=new Xq(String.fromCharCode(9643),"Courier New");b["5"]=new Xq(String.fromCharCode(61611),"Wingdings");
b["6"]=new Xq(String.fromCharCode(61614),"Symbol");b["7"]=new Xq(String.fromCharCode(61483),"Symbol");b["8"]=new Xq(String.fromCharCode(61485),"Symbol");b["9"]=new Xq(String.fromCharCode(9830),"Courier New");b["10"]=new Xq(String.fromCharCode(61664),"Symbol");b["11"]=new Xq(String.fromCharCode(61558),"Wingdings");b["12"]=new Xq(String.fromCharCode(61656),"Wingdings");b["13"]=new Xq(String.fromCharCode(61514),"Wingdings");b["14"]=new Xq(String.fromCharCode(61516),"Wingdings");b["15"]=new Xq(String.fromCharCode(61692),
"Wingdings");b["16"]=new Xq(String.fromCharCode(61691),"Wingdings");b["17"]=new Xq(String.fromCharCode(61553),"Wingdings");return b}Ehe(b){b&&b.length&&this.QYe(b)}DRf(){if(this.Q7){var b=tx.a(this.Q7),h=b.length;for(let u=0;u<h;u++){const y=this.Q7[b[u]];this.ztb.add(y.levelText+"_"+y.font)}}}QYe(b){this.DRf();for(const h of b)if(h&&!h.Rt&&h.Qma&&h.w6b&&(b=h.levelText+"_"+h.font,!this.ztb.contains(b))){const u=tx.a(this.Q7).length+tx.a(this.YGb.value).length+"";this.Q7[u]=new Xq(h.levelText,h.font);
this.ztb.add(b)}}DVn(){dp.uP={};dp.uP["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;dp.uP["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;dp.uP["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;dp.uP["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;dp.uP["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;dp.uP["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;dp.uP["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;dp.uP["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;
dp.uP["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;dp.uP["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;dp.uP["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;dp.uP["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;dp.uP["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;dp.uP["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;dp.uP["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;dp.uP["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;
dp.uP["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}dp.uP=null;Object(m.a)(dp,"ListMarkerBulletLoader",uu,[]);class Yq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(Yq,"InfoAtLevel",null,[]);class ks{constructor(b){this.bB=b}get font(){return"Calibri"}get listStyle(){return 42}get mt(){return"left"}get Y4d(){return this.bB?this.Skn():this.Ukn()}get HTc(){return this.bB?this.Tkn():null}get levelText(){return""}XCl(b){switch(b){case 1:return"1";case 2:return"a";
case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Skn(){let b="";for(let h=0;3>h;h++)b+=this.XLc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',ks.Jhf(),b)}Tkn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new Yq,{textAtLevel:this.i2h(h),styleAtLevel:this.ZUl(h)}));return b}Ukn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',ks.Khf(),Box4Intl.Box4Strings.L_ListStyleNone)}i2h(b){b=this.bB.ITc[b];
for(let h=0;9>h;h++)b=A.a.replaceAll(b,"%"+(h+1),this.XCl(this.bB.$Gb[h]));return b}ZUl(b){const h={};h.fontFamily=6===this.bB.$Gb[b]?this.bB.RCa[b]:this.font;return h}XLc(b){const h=this.i2h(b),u=new Sys.StringBuilder;6===this.bB.$Gb[b]&&u.append(String.format("font-family:{0};",this.bB.RCa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,u.toString(),h)}static Jhf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Khf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(ks,"ListMarkerMultilevel",null,[547]);var Sw=c(779);class lr extends uu{constructor(){super()}J4e(){const b=new Sw.a,h={};h["0"]=new ks(null);h["1"]=new ks(b.e4e());h["2"]=new ks(b.V4e("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new ks(b.Pyh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}Ehe(){}}Object(m.a)(lr,"ListMarkerMultilevelLoader",uu,[]);var np=c(148);class oq{constructor(b,h){this.bB=null;this.levelText=b;this.mjd=h}get font(){return"Calibri"}get listStyle(){return this.mjd}get mt(){switch(this.mjd){case 3:case 5:return"right";default:return"left"}}get Y4d(){switch(this.mjd){case 1:return this.tdc("1",
"2","3");case 2:return this.tdc("a","b","c");case 3:return this.tdc("i","ii","iii");case 4:return this.tdc("A","B","C");case 5:return this.tdc("I","II","III");case 0:return this.Vkn();default:return this.tdc("1","2","3")}}get HTc(){const b=[],h={};h.fontFamily=np.FontUtils.VBa(this.font);switch(this.mjd){case 1:return b.push(Object.assign(new Yq,{textAtLevel:this.YW("1"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("2"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new Yq,{textAtLevel:this.YW("a"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("b"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new Yq,{textAtLevel:this.YW("i"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("ii"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new Yq,
{textAtLevel:this.YW("A"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("B"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new Yq,{textAtLevel:this.YW("I"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("II"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new Yq,{textAtLevel:this.YW("1"),
styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("2"),styleAtLevel:h})),b.push(Object.assign(new Yq,{textAtLevel:this.YW("3"),styleAtLevel:h})),b}}tdc(b,h,u){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',oq.Jhf(),this.XLc(b),this.XLc(h),this.XLc(u))}Vkn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',oq.Khf(),Box4Intl.Box4Strings.L_ListStyleNone)}XLc(b){b=this.YW(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}YW(b){return A.a.replaceAll(this.levelText,"%1",b)}static Jhf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Khf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(oq,"ListMarkerNumbering",null,[547]);class UA extends uu{constructor(){super();this.ztb=new bm.a(la.a.Ri())}kwm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}J4e(){const b=
{};b["0"]=new oq(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new oq("%1.",5);b["2"]=new oq("%1.",4);b["3"]=new oq("%1.",1);b["4"]=new oq("%1.",2);b["5"]=new oq("%1.",3);b["6"]=new oq("%1)",5);b["7"]=new oq("%1)",4);b["8"]=new oq("%1)",1);b["9"]=new oq("%1)",2);b["10"]=new oq("%1)",3);b["11"]=new oq("(%1)",5);b["12"]=new oq("(%1)",4);b["13"]=new oq("(%1)",1);b["14"]=new oq("(%1)",2);b["15"]=new oq("(%1)",3);return b}Ehe(b){b&&b.length&&this.QYe(b)}DRf(){if(this.Q7){var b=tx.a(this.Q7),h=b.length;
for(let u=0;u<h;u++){const y=this.Q7[b[u]];this.ztb.add(y.levelText+"_"+y.listStyle)}}}QYe(b){this.DRf();for(const h of b)if(h&&h.Rt&&h.Qma&&this.kwm(h.levelText)&&h.listStyle&&(b=Hv.a.dff(h.levelText))){const u=b+"_"+h.listStyle;if(!this.ztb.contains(u)){const y=tx.a(this.Q7).length+tx.a(this.YGb.value).length+"";this.Q7[y]=new oq(b,h.listStyle)}this.ztb.add(u)}}}Object(m.a)(UA,"ListMarkerNumberingLoader",uu,[]);class Qu{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){Qh.Wb()}dispose(){}xc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new dp).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new UA).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new lr).singleInstance()}static main(){K.a.instance.Kc(new Qu)}}Object(m.a)(Qu,"Box4ListMarkerPackage",null,[1,2]);class Et{static get Hg(){return ff.a.Sy(Et.am,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}Et.am="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(m.a)(Et,"DefineNewBulletDialogHtml",null,[]);class Cr extends ff.a{constructor(b,h,u,y){super();this.vtc=this.vCe=this.xUb=this.rUb=null;this.iub=0;this.IBc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.bdi=!0;this.y0k=P=>{if(this.rUb&&P.target!==this.rUb){const aa=this.Hh.Ks();aa&&aa.Xj&&(aa.Xj.vy(P.target),this.rUb=P.target)}this.Y8m(P.target.id)};this.TDm=P=>{P=P.Bf;if(!this.rpi(P))return!1;this.Hh.Ks().Xj.vy(P);P.focus();return!0};this.UDm=P=>{var aa=P.Bf;if(!this.rpi(aa))return!1;
var ta=aa.id;ta=parseInt(ta.substr(ta.lastIndexOf("_")+1))-this.iub;if(P.Ib.ctrlKey||P.Ib.altKey||P.Ib.keyCode>=fb.a.NPb&&P.Ib.keyCode<=fb.a.OPb)return!1;const Pa=P.Ib.keyCode;if(P.eventName===bb.a.hi){P=-1;if(Pa===Sys.UI.Key.enter)return this.Hh.Ks().Xj.vy(aa),aa.focus(),this.FEi(aa.id),this.hide(),!0;Pa===Sys.UI.Key.up?P=ta-17:Pa===Sys.UI.Key.down?P=ta+17:Pa===Sys.UI.Key.left?P=r.AFrameworkApplication.isRtl?ta+1:ta-1:Pa===Sys.UI.Key.right&&(P=r.AFrameworkApplication.isRtl?ta-1:ta+1);0<=P&&(aa=this.ZZh(Cr.c2b+
"_"+(P+this.iub)))&&aa.focus()}return!0};this.x0k=P=>{1===P&&this.FEi(this.xUb);this.hide()};this.ku=b;this.Hh=h;this.ga=u;this.eL=!1;y&&(b=y.indexOf(","),-1!==b&&(y=y.substring(0,b)));this.fontName=y;this.mg="DefineNewBulletDialog";this.Hg=Et.Hg;this.Ue(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ue(0,CommonUIStrings.l_DialogClose);this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.x0k,null);this.D9=!1;this.RFa();document.getElementById(Cr.JHd).focus()}RFa(){this.Hh.Ks().scope.Mr(ub.FocusManager.instance().XV);
this.Hh.Ks().scope.Mr(ub.FocusManager.instance().YV);this.Hh.Ks().scope.bindAction(ub.FocusManager.instance().XV,Oa.a.ZCd);this.Hh.Ks().scope.bindAction(ub.FocusManager.instance().YV,Oa.a.YCd)}QX(){this.kxd(Cr.JHd,"DefineNewBulletFontPlaceholder",Oa.a.XCd.toString(),Oa.a.dKb.toString(),Oa.a.uYc.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.puk()}SK(){super.SK();document.getElementById(this.mj("WACDialogPanel")).style.width="auto"}kxd(b,h,u,y,P,aa,ta){u=ke.c(b,u,!0,!0,y,P,A.a.Cf(aa),!0,
ta);this.CBd(b,h,u,"Medium")}puk(){const b=document.getElementById(Cr.c2b);b&&(b.innerHTML=this.LVh(),this.rTi(b))}rTi(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)rf.a.addHandler(b[h],bb.a.focus,this.y0k)}txo(){var b=document.getElementById(Cr.c2b);if(b){let h=this.fontName;const u=Hv.a.Wtf(this.fontName);u&&61472!==this.iub||!u&&32!==this.iub?(b.innerHTML=this.LVh(),this.rTi(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&h&&(h=this.Bdh(h),b[0].style.fontFamily=
h)}}Y8m(b){this.z6i(this.xUb,!1);this.xUb=b;this.z6i(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.xUb){let h=parseInt(this.xUb.substr(this.xUb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.iub?61440:0,b.innerText=A.a.nI(h,4))}}z6i(b,h){(b=this.ZZh(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}ZZh(b){const h=document.getElementById(Cr.c2b);return h?h.querySelector("#"+b):null}Qka(){const b=document.getElementById(Cr.c2b);b&&(this.vCe||(this.vCe=this.TDm,
this.xq.mb(bb.a.click,b,this.vCe)),this.vtc||(this.vtc=this.UDm,this.ie.mb(bb.a.hi,b,this.vtc),this.ie.mb(bb.a.St,b,this.vtc),this.ie.mb(bb.a.sh,b,this.vtc)));super.Qka()}rpi(b){return b.classList.contains("DefineNewBulletTableCell")}FEi(b){if(b){b=b.split("_");const h=new uh.DictionaryPropertySet;h.setValue(ld.a.bJ,parseInt(b[1]));h.setValue(Ge.a.font,this.fontName);h.setValue(ld.a.$v,1);Rt.a.uX&&(h.setValue(zi.a.Rna,"command-ui"),h.setValue(zi.a.vga,"define-new-bullet-dialog"));this.ga.Ub(Oa.a.qB,
2,h)}this.Hh.LK(this.oK,!0)}LVh(){const b=new Sys.StringBuilder,h=Hv.a.Wtf(this.fontName);let u=this.fontName;u=this.Bdh(u);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',u));h?(this.iub=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.iub=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}Bdh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}CBd(b,h,u,y){h=document.getElementById(h);this.ku.BLa(b,u);u=this.ku.fgb(b,y);h.appendChild(u);this.ku.pU(b)}dispose(){this.eL||(this.ku.LE(Cr.JHd),this.eL=!0);super.dispose()}}Cr.JHd="DefineNewBulletFontStyleComboBox";Cr.c2b="DefineNewBulletTableContainer";Object(m.a)(Cr,"DefineNewBulletDialog",ff.a,[]);class bt{rLc(){return Oa.a.ODm}WLc(){return Oa.a.ZQf}}Object(m.a)(bt,"ListMarkerGalleryBulletCommands",
null,[546]);class dz{rLc(){return Oa.a.QDm}WLc(){return Oa.a.ein}}Object(m.a)(dz,"ListMarkerGalleryMultilevelCommands",null,[546]);class jy{rLc(){return Oa.a.RDm}WLc(){return Oa.a.$Qf}}Object(m.a)(jy,"ListMarkerGalleryNumberingCommands",null,[546]);class Tw{constructor(b,h,u,y,P){this.cza=this.WJa=null;this.HDh=aa=>{if(!this.cza)return 2;if(this.cza.Hh.Ks().Xj.G2.id.startsWith(Cr.c2b)){let ta=null;aa===Oa.a.ZCd?ta=this.cza.nYa:aa===Oa.a.YCd&&(ta=document.getElementById(Cr.JHd));if(!ta)return 2;this.cza.Hh.Ks().Xj.vy(ta);
ta.focus()}else if(aa===Oa.a.ZCd)this.cza.Hh.Ks().Uac();else if(aa===Oa.a.YCd)this.cza.Hh.Ks().Sac();else return 2;return 32};this.dsi=(aa,ta)=>{aa=null;ta.view.ue&&(aa=ta.view);return aa&&aa.Bb?32:(Ab.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ta.toString()),8)};this.OBm=(aa,ta,Pa)=>1===Pa?32:2===Pa?(aa=this.L5b(ta),aa=Wi.FormattingReader.zr(aa).cache.lH,this.cza=new Cr(this.o3j,ub.FocusManager.instance(),
r.AFrameworkApplication.ya,aa),32):8;this.uYc=(aa,ta,Pa,vb,Kb)=>{if(1===Pa)return 32;if(2===Pa&&!Kb)return 8;if(this.cza.bdi){for(aa=0;aa<Hv.a.IBc.length;aa++)np.FontUtils.Tlj(Hv.a.IBc[aa]);this.cza.bdi=!1}Fg.a.EQd(ta);Kb.PopulationXML=np.FontUtils.jRh(Fg.a.Vbe,Fg.a.Fef,Oa.a.XCd);return 32};this.din=(aa,ta,Pa,vb,Kb)=>{aa=ta.contextId===oc.a.outlineElement;if(1===Pa||!aa)return aa?32:8;if(2===Pa&&!Kb)return 8;Kb.MenuItems=this.LTj.BIl();return 32};this.w0k=(aa,ta,Pa,vb,Kb)=>{if(1===Pa)return 32;if(2===
Pa){aa=Object(na.a)(18,Kb);if(!aa||!aa.vd)return 8;this.cza.fontName=aa.vd.fontName;this.cza.txo();return 32}return 8};this.ga=b;this.If=y.resolve("Box4.List.IListReader");this.E5=h;this.o3j=u;switch(this.E5){case 0:b=y.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.WJa=new bt;break;case 1:b=y.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.WJa=new jy;break;case 2:b=y.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.WJa=new dz;break;default:b=y.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),
this.WJa=new bt}P=this.If?this.If.qIl(P):null;b.Ehe(P);this.LTj=new Hv.a(h,b,P,!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.XFb)}Wb(){this.ga.pa(this.WJa.WLc(),oc.a.view,Ra.App.GSa.gzh(11));this.ga.pa(this.WJa.WLc(),oc.a.outlineElement,this.din);this.ga.Xc(this.WJa.WLc(),1124);this.E5||(this.ga.gb(Oa.a.IAf,oc.a.view,this.OBm,1028),this.ga.gb(Oa.a.uYc,oc.a.view,this.uYc,1124),this.ga.gb(Oa.a.XCd,oc.a.view,this.w0k,1028),this.ga.gb(Oa.a.ZCd,le.a.frame,this.HDh,64),this.ga.gb(Oa.a.YCd,
le.a.frame,this.HDh,64));this.ga.pa(this.WJa.rLc(),oc.a.view,this.dsi);this.ga.pa(this.WJa.rLc(),oc.a.outlineElement,this.dsi);this.ga.Xc(this.WJa.rLc(),1124)}L5b(b){return this.UId(b).Qa}UId(b){let h=null;b=b.view;return b?h=Se.SelectionEditor.Vj(b.Bb.hb.J(0),!1,!1):h}}Object(m.a)(Tw,"ListMarkerGalleryActor",null,[522]);class ls{constructor(){this.Re=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(ab.InteractiveViewManager.instance){var b=ab.InteractiveViewManager.instance;b.editingView&&
(this.Re=b.editingView.jd,this.Wzn())}}dispose(){}xc(b){this.W=b}Wzn(){(new Tw(r.AFrameworkApplication.ya,1,this.W.resolve("Common.IStandaloneRootController").L8,this.W,this.Re)).Wb();(new Tw(r.AFrameworkApplication.ya,0,this.W.resolve("Common.IStandaloneRootController").L8,this.W,this.Re)).Wb();(new Tw(r.AFrameworkApplication.ya,2,this.W.resolve("Common.IStandaloneRootController").L8,this.W,this.Re)).Wb()}static main(){K.a.instance.Kc(new ls)}}Object(m.a)(ls,"Box4ListMarkerGalleryPackage",null,[1,
2]);var lv=c(337),ky=c(404),ly=c(368),Jq=c(103);const Zz=b=>{b.element.style.top=""};var Ut=c(716);class VA{constructor(b,h,u){this.VG=!1;this.O8a=0;this.bda=this.VZg=null;this.Xl=b;this.u4j=h;this.Xs=u;this.y5=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.ww=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.vX)&&!this.Xs.j9e&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";ba.a.kj&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"FireFox")}get htmlElement(){return this.y5}get visible(){return this.VG}set_visible(b){if(this.VG!==b)return(this.VG=b)?this.DWe():this.pGc(),b}dispose(){this.visible&&this.pGc();Hc.a.tZ(this.htmlElement);this.Xl=this.y5=null}Saj(b,h){const u=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(u):this.htmlElement.insertBefore(u,this.htmlElement.childNodes[h]);b.oZi();this.O8a+=b.htmlElement.clientHeight;var y=this.htmlElement.childNodes,P=b.Rgh,aa=
Object(v.a)(this,this.v0m,"onAfterShowEntry");Jq.WacAirSpace.BU(u,"Shared_BasicClass");var ta=new ly.a(u);ta.Ksa(0,1);const Pa=new ky.a(u);Pa.ZAa(u.clientTop-30,u.clientTop);P?(Jq.WacAirSpace.Xjb(ta,null,null),Jq.WacAirSpace.Xjb(Pa,null,aa)):(Jq.WacAirSpace.animate(ta,null,null),Jq.WacAirSpace.animate(Pa,null,aa));for(h+=1;h<y.length;h++)aa=y[h],Jq.WacAirSpace.BU(aa,"Shared_BasicClass"),ta=new ky.a(aa),ta.ZAa(aa.clientTop-u.clientHeight,aa.clientTop),P?Jq.WacAirSpace.Xjb(ta,null,null):Jq.WacAirSpace.animate(ta,
null,null);b.V9n();this.set_visible(!0)}wai(b){const h=b.htmlElement;if(Hc.a.tFb(h)){this.O8a-=b.htmlElement.clientHeight;var u=h.parentNode.children;b=b.Rgh;var y=Object(v.a)(this,this.m0m,"onAfterHideEntry");Jq.WacAirSpace.BU(h,"Shared_BasicClass");var P=new lv.a(h);P.Ksa(1,0);b?Jq.WacAirSpace.Xjb(P,null,y):Jq.WacAirSpace.animate(P,null,y);y=!1;for(P=0;P<u.length;P++){if(y){const aa=u[P];Jq.WacAirSpace.BU(aa,"Shared_BasicClass");const ta=new ky.a(aa);ta.ZAa(aa.clientTop,-h.clientHeight);b?Jq.WacAirSpace.Xjb(ta,
null,Zz):Jq.WacAirSpace.animate(ta,null,Zz)}y||u[P]!==h||(y=!0)}}}v0m(b){b.element.style.top="";r.AFrameworkApplication.ta.UVc()}m0m(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);r.AFrameworkApplication.ta.UVc()}DWe(){""===this.Xl.style.top.trim()&&(this.Xl.style.top=this.Xl.offsetTop+"px");this.htmlElement.style.left=this.Xl.style.left;this.htmlElement.style.top=this.Xl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility=
"visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.VZg=this.Xl.style.top;this.O8a=b.height;this.Qhe();r.AFrameworkApplication.ta.jZ(Object(v.a)(this,this.onResize,"onResize"));rf.a.addHandler(this.htmlElement,bb.a.Ffc,rf.a.$cb);this.bda=Object(v.a)(this,this.TBa,"contextMenuHandler");r.AFrameworkApplication.ta.Txa.mb(this.htmlElement,this.bda,null);if(ub.FocusManager.zJ()){var h=ub.FocusManager.instance();b=h.le(Ut.a.RLa);b.parent=xe.AFrame.Hp;const u=new ng.DOMFocusListing(()=>this.htmlElement);
u.Go(1);u.Go(2);u.Go(8);h.Wka(()=>this.htmlElement,b,u);h=h.getRegion(Ut.a.RLa);h.jRa();h.HX=!0;h.RYa=!0;const y=r.AFrameworkApplication.ta.Bv;b.dcb(()=>{y.ex(Ut.a.RLa)});y.uS(Ut.a.RLa);(u.nfa||r.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&y.XG(Ut.a.RLa)}}pGc(){this.waj()&&(this.Xl.style.top=this.VZg);this.htmlElement.style.visibility="hidden";r.AFrameworkApplication.ta&&(ub.FocusManager.zJ()&&ub.FocusManager.instance().Xlb(Ut.a.RLa),this.bda&&(r.AFrameworkApplication.ta.Txa.sc(this.htmlElement,
this.bda),this.bda=null));rf.a.removeHandler(this.htmlElement,bb.a.Ffc,rf.a.$cb)}Qhe(){if(this.waj()&&this.visible){var b=this.Xl,h=this.O8a+this.u4j;const u=Hc.a.mM(b.style.top);Jq.WacAirSpace.BU(b,"Shared_BasicClass");b=new ky.a(b);b.ZAa(u,h);Jq.WacAirSpace.animate(b,null,null)}}waj(){return!this.ww&&!this.Xs.j9e}onResize(){const b=this.Xs.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let u;for(let y=0;y<b;++y)u=this.Xs.entries[y],u.htmlElement&&u.oZi();this.O8a=Sys.UI.DomElement.getBounds(this.htmlElement).height;
h!==this.O8a&&this.Qhe()}TBa(){return!0}}Object(m.a)(VA,"BusinessBarDom",null,[1088,9]);var ew;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=
10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]="unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";
b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]=
"dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=
40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(ew||(ew={}));Object(m.b)("BusinessBarId",ew);class vu{constructor(b,h=0,u=null,y=null){this.ORg=this.KHg=!1;this.XVb=null;this.qA=[];this.GTa=y||new VA(b,h,this);this.iem(u)}iem(b){if(b){this.XVb={};b=b.ranking;for(let h=0;h<b.length;h++)this.XVb[ew[b[h]]]=h}}dispose(){this.GTa.dispose();mj.a.I_f(this.qA);
this.qA=null}get htmlElement(){return this.GTa.htmlElement}get visible(){return this.GTa.visible}get j9e(){return this.KHg}set j9e(b){this.KHg=b}get Lxf(){return this.ORg}set Lxf(b){this.ORg=b}get entries(){return this.qA}set entries(b){this.qA=b}o3(b){for(let h=0;h<this.qA.length;h++)if(this.qA[h].id===b)return!0;return!1}BA(b,h=!1,u=null,y=null,P=null){b.vP=this;let aa=this.mGl(b.id);h&&!this.XVb&&(aa=0);aa<vu.FHb&&(this.GTa.Saj(b,aa),this.qA.length>=vu.FHb&&this.GTa.wai(this.qA[vu.FHb-1]),this.GTa.Qhe());
Array.insert(this.qA,aa,b);w.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",ew[b.id],void 0===b.SYa||null===b.SYa?"":b.SYa);b.errorCode&&r.AFrameworkApplication.WQ(b.errorCode,u,y,P)}removeEntry(b){const h=Array.indexOf(this.qA,b);-1!==h&&h<vu.FHb&&(this.qA.length>vu.FHb&&this.GTa.Saj(this.qA[vu.FHb],vu.FHb),this.GTa.wai(b),this.GTa.Qhe());Array.remove(this.qA,b);b.vP=null;b.dispose()}mGl(b){if(!this.XVb||0===b)return this.qA.length;b=this.XVb[ew[b]];if(void 0===
b||null===b)return this.qA.length;for(let h=0;h<this.qA.length;h++)if(b<this.XVb[ew[this.qA[h].id]])return h;return this.qA.length}}vu.FHb=2;Object(m.a)(vu,"BusinessBar",null,[1064,9,1065]);class my{create(b,h,u){return new sh.a(b,h,u)}}Object(m.a)(my,"Factory",null,[1086]);class Ft{static XLk(b,h){b.register(vu,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Xd(()=>new vu(h.value,0,b.Pa("CommonUI.IBusinessBarRankProvider")));b.register(my,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}
Object(m.a)(Ft,"CommonUIComponentConfiguration",null,[]);var ny=c(980);class Ru extends ny.a{constructor(){super()}static get instance(){return Ru._instance||Ru.usf()}static usf(){Ru._instance=new Ru;return Ru._instance}}Ru._instance=null;Object(m.a)(Ru,"ReactRootManager",ny.a,[511,512]);class oy extends Qe.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(oy,"CompoundButtonProps",Qe.a,[]);class $z{constructor(b,h,u,y,P,aa,ta){this.PV=h;this.Lwc=b;this.dQg=h.unm;this.UTb=h.LRc;this.Yye=
aa;this.cgd=y;this.dgd=P;this.Yfd=u;this.cF=ta;this.$9a=new La.a;this.$9a.Z(1,"SpellingIssue_16x16x32");this.$9a.Z(2,"GrammarIssue_16x16x32");this.$9a.Z(3,"WritingIssue_16x16x32");this.$9a.Z(4,null);this.$9a.Z(0,null)}create(b,h,u){h=Object(na.a)(Gf.a,h);if(!h)return w.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const y=new Sys.StringBuilder;b=this.zZh(b);this.vFc(y,h,u,b);this.D4e(y,h);this.iWk(y,h,b);return y.toString()}Vdb(b,h,u){const y=Object(na.a)(Gf.a,h);if(!y)return w.ULS.sendTraceTag(39188232,
375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.zZh(b);this.o5e(h,y,u,b);this.E4e(h,y);this.jWk(h,y,b);for(u=0;u<h.length;u++)h[u].Id=`${Nu.kIh}_${u}`;return h}vFc(b,h,u,y=null){h.errorType?1===h.errorType&&(this.m3b(h)||b.append(this.MYe(h,u,y))):b.append(this.Lwc.build())}o5e(b,h,u,y=null){h.errorType?1===h.errorType&&(this.m3b(h)||b.push(this.muk(h,u,y))):b.push(this.Lwc.pnh())}D4e(b,h){const u=new Sys.StringBuilder;this.Lbj(h)?u.append(ke.a("btnIgnoreAllSpellingError",(2===h.errorType?
Oa.a.rHa:Oa.a.Vma).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.m3b(h)||u.append(ke.a("btnIgrnoreSpellingError",this.yYh(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.Qbj(h)&&(this.PV.mii&&u.append(ke.a("btnDoNotCheckForThisIssue",Oa.a.zAb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),u.append(ke.a("btnGrammarOptions",Oa.a.Xkb.toString(),A.a.Cf(Box4Intl.Box4Strings.l_GrammarOptions),null)));u.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),
b.append(u.toString()),b.append("</Controls></MenuSection>"))}E4e(b,h){const u=Object.assign(new xi.a,{ControlList:[]});if(this.Lbj(h)){var y=Oo.XA()?Object.assign(new Qe.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Oa.a.Vma,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Qe.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});u.ControlList.push(y)}else this.m3b(h)||(y=Object.assign(new Qe.a,{ExternalId:"btnIgrnoreSpellingError",
Command:this.yYh(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),u.ControlList.push(y));this.Qbj(h)&&(this.PV.mii&&(h=Object.assign(new Qe.a,{ExternalId:"DoNotCheckForThisIssue"}),u.ControlList.push(h)),h=Object.assign(new Qe.a,{ExternalId:"GrammerSettingsContext"}),u.ControlList.push(h));b.push(u)}zZh(b){if(!this.cF)return null;b=this.cF.language(this.cF.zr(b.Qa));return zl.a.sg(b)?zl.a.sg(b).name:null}yYh(b){return 2===b?Oa.a.rHa:this.PV.cqm?Oa.a.u$l:Oa.a.cva}iWk(b,
h,u=null){if(this.s4f(h)){var y=A.a.Cf(h.ft.CategoryTitle);y=ke.o(Nu.zdc,Wa.a.Jka,this.$9a.J(h.proofingType),""!==y?y:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.cgd,this.dgd);y=ke.d("cgProofingOuter",[y]);b.clear();b.append(ke.h("msProofingOuter",y,"Menu16",void 0,void 0,u,"ariaLabelledById"));w.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}jWk(b,h,u=null){if(this.s4f(h)){var y=A.a.Cf(h.ft.CategoryTitle);
u=Object.assign(new Hd.a,{ExternalId:String.format("{0}_{1}",Nu.zdc,h.proofingType),Command:Wa.a.Jka.toString(),Image16by16Class:this.$9a.J(h.proofingType),LabelText:""!==y?y:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:u,Menu:Object.assign(new $f.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.jtl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});u.Menu.MenuSectionList.push(...b);Array.clear(b);
y=Object.assign(new xi.a,{ControlList:[]});y.ControlList.push(u);b.push(y);w.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}MYe(b,h,u=null){const y=this.DBl(b);var P=[];let aa=!1;var ta=b.ft.Suggestions;if(ta)if(ta=ta.slice(0,Math.min(3,ta.length)),this.dQg&&(aa=!Jj.a.any(ta,Pa=>!Pa||!Pa.Description)),1!==ta.length||ta[0].Action){let Pa=0,vb=null;aa&&(vb="font-weight: bold;");for(const Kb of ta){if(!Kb)continue;ta=null;let Sb="";
const Yb=A.a.Cf(Kb.Text);aa&&(ta=this.kTh(Kb.Description),Sb=this.jTh(Kb.Description));P.push(ke.a("btnCorrectWord"+Pa,h[Pa].toString(),Yb,null,null,null,null,null,vb,null,ta,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,y,Yb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.Exh(b.token)),"ariaDescribedById",Sb));Pa++}}else h=A.a.Cf(ta[0].Text),P.push(ke.a("btnCorrectWord0",
Oa.a.rHa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,y,h)));h="Menu16";0<P.length?aa&&(h="Menu16DescriptionEnabled"):P=[ke.a("btnNoSuggestions",Oa.a.rHa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return ke.h("msUnknownWord",ke.d(null,P),h,y,this.FJl(b),u,"ariaLabelledById")}muk(b,h,u=null){var y=1!==b.proofingType&&0!==b.proofingType?b.ft.ExplanationTitle:"";y=Object.assign(new xi.a,{Title:y,
Lang:u,ControlList:[]});let P=!1;var aa=b.ft.Suggestions;if(aa)if(aa=aa.slice(0,Math.min(3,aa.length)),this.dQg&&(P=!Jj.a.any(aa,ta=>!ta||!ta.Description)),1!==aa.length||aa[0].Action){let ta=0;for(const Pa of aa){if(!Pa)continue;aa=null;let vb="";P&&(aa=this.kTh(Pa.Description),vb=this.jTh(Pa.Description));if(ta>=h.length)break;aa?(aa=Object.assign(new oy,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ta,b.proofingType),Command:h[ta].toString(),LabelText:Pa.Text,Description:aa,
Lang:u,AriaDescription:vb}),y.ControlList.push(aa)):(aa=Object.assign(new Qe.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ta,b.proofingType),Command:h[ta].toString(),LabelText:Pa.Text,Lang:u,RoleInMenu:"menuitem"}),y.ControlList.push(aa));ta++}}else b=aa[0],b=Object.assign(new Qe.a,{ExternalId:"NoSuggestion",Command:Oa.a.rHa.toString(),LabelText:b.Text}),y.ControlList.push(b);0>=y.ControlList.length&&y.ControlList.push(Object.assign(new Qe.a,{ExternalId:"btnNoSuggestions",Command:Oa.a.rHa.toString(),
LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return y}DBl(b){return A.a.Cf(0!==b.proofingType?b.ft.ExplanationTitle:"")}FJl(b){return this.s4f(b)?null:this.$9a.J(b.proofingType)}s4f(b){return this.UTb&&2!==b.errorType&&(1!==b.errorType||!this.m3b(b))}Lbj(b){return this.Yye&&!!b.errorType&&1===b.proofingType&&!this.m3b(b)}jtl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.Exh(b.token)):""}Qbj(b){return this.PV.sUd&&this.UTb&&
1===b.errorType&&(2===b.proofingType||3===b.proofingType)}m3b(b){return!!b.errorType&&!!this.Yfd&&this.Yfd.contains(b.token,b.lcid)}kTh(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}jTh(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}Exh(b){let h="";if(b){let u;for(u=0;u<b.length-1;u++)h=h+b.charAt(u)+",";h+=b.charAt(u)}return h}}Object(m.a)($z,"EditorServiceProofingContextMenuCreator",null,[]);class fw{get ranking(){return[24,
23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(m.a)(fw,"BusinessBarRankProvider",null,[520]);class pq{constructor(){this.W=null}get name(){return"Wonca.UI"}xc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new fw).singleInstance();Ft.XLk(b,new Zf.a(()=>Ra.App.xa.Zea));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new $z(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),
b.resolve("Box4.Proofing.IIgnoreAllKeywords"),r.AFrameworkApplication.mQ,r.AFrameworkApplication.Cr,r.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>Ru.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){K.a.instance.Kc(new pq)}}Object(m.a)(pq,"WoncaUIPackage",null,[1,2]);class Uw{constructor(b){this.UM=
this.Tuc=null;this.ul=b}get key(){return"BOOKMARK"}get Cw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get xla(){return this.UM}reset(b){this.UM=b.node}jHa(b){let h=null;r.AFrameworkApplication.Ce("bookmarks-core-ex;bookmarks-core-ex-cf");if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Tuc&&this.ul.zuf(b,this.xla,this.Tuc))return h=Object.assign(new Sn.a,{kG:this.key,contentObject:this.Tuc}),{returnValue:!0,
jF:h};this.Tuc=null;if(!this.xla.hasBookmark)return{returnValue:!1,jF:h};const u=new yd.GraphIterator;u.set(this.xla.Hi());this.ul.Xac(u);if(this.ul.Pgi(u)){let y=u.Vd();for(;y;){if(this.ul.zuf(b,this.xla,y))return this.Tuc=y,h=Object.assign(new Sn.a,{kG:this.key,contentObject:y,description:this.cgb()}),{returnValue:!0,jF:h};y=u.Rj()}}}return{returnValue:!1,jF:h}}cgb(){return null}}Object(m.a)(Uw,"BookmarkDetailsProvider",null,[245,246]);class py{constructor(b,h,u,y,P=null){this.BPg=this.Ah=!1;this.qkd=
this.CVb=null;this.RCi=(aa,ta)=>{aa=ta.node;1074135152!==aa.Rc?w.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",aa.Rc):(w.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.$Ed(!0))};this.DB=u;this.Lh=y;this.Ex=h;this.ZBg=b;this.uB=P}get fy(){return this.Ex.value}initialize(){this.nWf();this.Ah=!0}$Ed(b=!1){if(!this.Ah)return w.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.BPg)return!0;let h=
!1;this.Lh.Sd(()=>{this.CVb={};this.qkd={};if(this.fy){const u=new yd.GraphIterator;u.set(this.fy);if(this.gWm(u)){if(u.Rb(1)){do this.dbk(u.currentNode);while(u.yf(1))}h=this.BPg=!0}}},"BGM:EBGL");return h}$Sh(b){var h,u,y,P;if(!this.$Ed())return null;const aa=new ob.a;if(b.toString()in this.CVb){const ta=this.CVb[b.toString()];for(const Pa of ta)this.uB.Ska.has(null===(h=Pa.id)||void 0===h?void 0:h.toString())&&this.uB.Ska.get(null===(u=Pa.id)||void 0===u?void 0:u.toString()).equals(b)&&this.uB.hYa.has(null===
(y=Pa.id)||void 0===y?void 0:y.toString())&&this.uB.hYa.get(null===(P=Pa.id)||void 0===P?void 0:P.toString()).equals(b)?aa.add(Pa):w.ULS.sendTraceTag(24155015,324,100,"GetBookmarksInParagraph: bookmarkNode does not have same paragraph for start and end value (shouldn't happen for TOC)")}return aa}qfa(b){return this.$Ed()?b in this.qkd?this.qkd[b]:null:null}dispose(){this.Ah?this.Oto():w.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}gWm(b){if(this.DB.EQ(b))return(b=b.Rb(30))||
w.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;w.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}nWf(){w.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.ZBg.mfh(this.RCi)}Oto(){w.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.ZBg.BWi(this.RCi)}dbk(b){var h,u,y,P;b?(this.mdh(null!==(u=this.uB.Ska.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==u?
u:T.a.nil,b),this.mdh(null!==(P=this.uB.hYa.get(null===(y=b.id)||void 0===y?void 0:y.toString()))&&void 0!==P?P:T.a.nil,b),(h=b.properties.ia(Lc.a.at,null))&&(this.qkd[h]=b)):w.ULS.sendTraceTag(24155022,324,50,"Node is null")}mdh(b,h){b===T.a.nil?w.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.CVb||(this.CVb[b]=new ob.a),b=this.CVb[b],b.contains(h)||b.add(h))}}Object(m.a)(py,"BookmarkGraphManager",null,[521]);class Su{constructor(b,h){this.I$=b;this.EFj=h}get vKb(){return this.EFj}}
Object(m.a)(Su,"FoundBookmarkRangeObject",null,[539]);class WA{constructor(b,h=null){this.ETa=b;this.$Ad={};this.S1b={};this.uB=h}y3a(b,h){if(b=this.ETa.$Sh(h.node.id)){w.ULS.sendTraceTag(24462027,3029,50,String.format("Removing {0} bookmarks from paraId {1}",b.count,h.node.id));for(const u of b)u.id.toString()in this.$Ad&&(h=this.$Ad[u.id.toString()],h.id.toString()in this.S1b?b=this.S1b[h.id.toString()]:(b=new ob.a,this.S1b[h.id.toString()]=b),b.add(u),delete this.$Ad[u.id.toString()])}else w.ULS.sendTraceTag(24691925,
3029,50,"Failed to get bookmarks on paragraph deletion")}SWc(b,h){if(b=this.ETa.$Sh(h.original.id))for(const u of b)this.$Ad[u.id.toString()]=h.clone;else w.ULS.sendTraceTag(24691926,3029,50,"Failed to get bookmarks on paragraph copy")}UWc(b,h){var u,y;if(h.original.id.toString()in this.S1b){b=this.S1b[h.original.id.toString()];for(const P of b)this.uB.Ska.set(null===(u=P.id)||void 0===u?void 0:u.toString(),h.clone.id),this.uB.hYa.set(null===(y=P.id)||void 0===y?void 0:y.toString(),h.clone.id);delete this.S1b[h.original.id.toString()];
w.ULS.sendTraceTag(24691927,3029,50,"OnParagraphPaste: Refreshing out of date bookmarks");this.ETa.$Ed(!0)}}HFi(){w.ULS.sendTraceTag(36820239,3029,10,"New Interface Not Implemented!")}lud(){w.ULS.sendTraceTag(36471763,3029,10,"New Interface Not Implemented!");return!1}QYb(){w.ULS.sendTraceTag(591730835,3029,10,"New Interface Not Implemented!");return!1}$_d(){w.ULS.sendTraceTag(36209185,3029,10,"New Interface Not Implemented!")}qfa(){w.ULS.sendTraceTag(34936480,3029,10,"New interface not implemented");
return null}Tfb(){w.ULS.sendTraceTag(34936481,3029,10,"New interface not implemented");return null}lma(){w.ULS.sendTraceTag(35992273,3029,10,"New Interface Not Implemented!");return new Su(null,2)}FMf(){w.ULS.sendTraceTag(35992274,3029,10,"New interface not implemented")}lec(){w.ULS.sendTraceTag(573673489,3029,10,"New interface not implemented")}LJc(){w.ULS.sendTraceTag(559228954,3029,10,"getAllBookmarks not implemented");return null}P9h(){w.ULS.sendTraceTag(512328972,3029,10,"hasBookmarksOnBoot not implemented");
return!1}uwh(){w.ULS.sendTraceTag(524321507,3029,10,"containsBookmark not implemented");return!1}VWf(){w.ULS.sendTraceTag(559228956,3029,10,"removeBookmark not implemented");return!1}llf(){w.ULS.sendTraceTag(553951760,3029,10,"getParaNodesFromBookmarkName not implemented");return null}ZSh(){w.ULS.sendTraceTag(544814809,3029,10,"getBookmarkNameForHeading not implemented");return null}rof(){w.ULS.sendTraceTag(544777299,3029,10,"goToBookmark not implemented")}JKc(){w.ULS.sendTraceTag(545118154,3029,
10,"getEnclosingBookmark not implemented");return null}Xac(){w.ULS.sendTraceTag(540382879,3029,10,"moveToBookmarkContainer not implemented");return null}Pgi(){w.ULS.sendTraceTag(540382880,3029,10,"isBookmarkContainer not implemented");return null}vnj(){w.ULS.sendTraceTag(525133728,3029,10,"updateBookmarkNameOnly not implemented");return!1}D3d(){w.ULS.sendTraceTag(523106501,3029,10,"paragraphContainsAnyBookmarks not implemented");return!1}tgf(){w.ULS.sendTraceTag(523106502,3029,10,"getBookmarksFromParagraph not implemented");
return null}rgf(){w.ULS.sendTraceTag(522735619,3029,10,"getBookmarkRangeOnly not implemented");return null}mlf(){w.ULS.sendTraceTag(522735620,3029,10,"getParagraphContainingGivenBookmarkAnchors not implemented");return null}zuf(){w.ULS.sendTraceTag(521462493,3029,10,"isCpInsideBookmark not implemented");return!1}}Object(m.a)(WA,"BookmarkManager",null,[519]);var KB=c(799),qy=c(1095);class ez{create(){return new qy.a}}Object(m.a)(ez,"BookmarkContainerNodeFactory",null,[204]);class Gj{constructor(b,
h,u,y=null){this.HFi=(P,aa)=>{this.ul.FMf(aa)};this.SWc=(P,aa)=>{var ta=this.mNh(aa.clone);P=aa.original.Jc;const Pa=new Tb.a;for(const vb of ta)ta=vb.an.toString(),Pa.ub(ta)||(Pa.add(ta,!0),(ta=P.Db(vb.an))&&!ta.anchor&&(ta=this.ul.Tfb(vb.an)),ta?ta.anchor?this.WPk(ta,aa.clone):w.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ta.id,ta.ia(Lc.a.oyb,-1))):w.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.UWc=(P,aa)=>{P=aa.clone;aa=this.mNh(P);
this.ul.lec(P,aa)};this.Lz=h;this.ul=u;this.tFj=y||new ez}init(){KB.a.Uxn(Object(v.a)(this.ul,this.ul.$_d,"onAfterFullBookmarkRangeDeleted"));this.Lz.MTe(this.HFi);Kl.a.evd(this.SWc);Kl.a.FAc(this.UWc)}mNh(b){const h=new ob.a;for(let u=0;u<b.qa.length;u++){const y=b.qa.J(u);if(y.Ph)for(let P=0;P<y.Ph.length;P++)h.add(y.Ph.J(P))}return h}WPk(b,h){var u=h.Hi().Bd;u=lq.a(b,u,!0);h=yd.GraphIterator.$a(h);this.dbl(h);h.Rb(30);h.d2(u,1,b.id);h.Ii(u)}dbl(b){if(b.Ab(25)&&b.kd(25)&&!b.Lq(30)){const h=this.tFj.create(1074135152);
b.Qf(h,30)}}}Object(m.a)(Gj,"BookmarksEventHandler",null,[]);var Zq=c(277),ys=c(288),Wh=c(484),Tm=c(1153),ms=c(151),Of=c(1030);class ux{create(){return new Of.a}}Object(m.a)(ux,"BookmarkNodeFactory",null,[204]);class Iv{constructor(b,h,u,y,P,aa,ta,Pa=null,vb,Kb=null){this.u1="_";this.bCg=40;this.k3j=" ";this.Ex=b;this.DB=h;this.Rd=u;this.eCe=y;this.Ic=P;this.eb=aa;this.ib=ta;this.DFj=Pa||new ux;this.uB=Kb}OLc(b,h){return b?this.uB.Ska.get(null===h||void 0===h?void 0:h.toString()):this.uB.hYa.get(null===
h||void 0===h?void 0:h.toString())}get fy(){return this.Ex.value}get KHa(){return this.eCe.value}lud(b,h){if(!h||!h.Qa||!h.Tc)return w.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const u=h.Qa.node,y=h.Tc.node,P=Zq.a.dgb(h,!0);h=Zq.a.dgb(h,!1);return this.QYb(b,P,h,u,y)}QYb(b,h,u,y,P,aa=!1){w.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",aa));const ta=this.qfa(b);if(ta)if(aa)this.sUi(ta);else return w.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),
!1;if(!y||!P)return w.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;aa=this.Ic.Qc(15);aa.Eb(this.KHa);b=this.D9j(b);if(!b)return!1;this.z9j(y,h,b,P,u);aa.dispose();return!0}qfa(b){w.ULS.shipAssertTag(34936482,3029,!!b);return this.pNh(h=>b===h.properties.ia(Lc.a.at,null))}Tfb(b){return b&&b!==T.a.nil?this.pNh(h=>b.equals(h.id)):(w.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}$_d(b){const h=this.Tfb(b);h?(w.ULS.sendTraceTag(36844636,
3029,50,String.format("Removing bookmark {0}",b.toString())),this.rUi(h),this.S_c(h)):w.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}lma(b,h){var u;const y=null!==(u=this.OLc(h,b.id))&&void 0!==u?u:T.a.nil;if(y===T.a.nil)return w.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Su(null,2);u=this.fy.Bd.Db(y);return u?u.isConnected?this.getBookmarkRange(u,b,h):(w.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Su(null,
3)):(w.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new Su(null,2))}FMf(b){const h=this.Ejl(b);h[Symbol.iterator]().next().done||this.dWm(b,h)}lec(b,h){const u=new ob.a;let y=0,P=!1;for(const aa of h)aa&&aa.Nb.Ph?(y++,aa.Nb.Ph.remove(aa),0<=aa.Je&&aa.Je<b.wordRunProperties.length&&(aa.Nb.cp||(P=!0),u.add(aa.Je))):w.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Roa(u);w.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",
y,u.count));P&&!b.wordRunProperties.length&&b.wordRunProperties.append(ys.CharacterPropertiesEditor.IQ,1024)}LJc(b=!1){w.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new ob.a,u=yd.GraphIterator.$a(this.fy);if(null!==this.Xac(u)){var y=u.Sp();w.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",y);if(0<y)for(y=u.Vd();null!==y;){const P=y.ia(Lc.a.at,"");A.a.kf(P)||(b?h.add(y):P.startsWith(this.u1)||h.add(y));y=u.Rj()}}!b&&0<h.count&&w.ULS.sendTraceTag(556889755,
3029,50,"User Bookmarks count: {0}",h.count);return h}P9h(b=!1){return this.fy?this.uwh(b):!1}uwh(b=!1){w.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",b);const h=yd.GraphIterator.$a(this.fy);if(null!==this.Xac(h)&&0<h.Sp()){var u=h.Vd();if(b&&u)return!0;for(;null!==u;){u=u.ia(Lc.a.at,"");if(!A.a.kf(u)&&(b||!u.startsWith(this.u1)))return!0;u=h.Rj()}}return!1}llf(b){var h=this.qfa(b);const u=new ob.a;if(h){b=this.OLc(!0,h.id);h=this.OLc(!1,h.id);var y=this.fy.Bd.Db(b);
y&&u.add(y);if(b.equals(h))return u;b=y;do(b=y=this.eb.Tg(b,!1,!1,!0))&&u.add(y);while(y&&!y.id.equals(h))}else w.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",b);return u}VWf(b){if(null===b)return w.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.Tfb(b);return this.sUi(b)}ZSh(b){let h="";const u=b.id;b=b.characterData.split(this.k3j);for(let y=0;3>y&&y<b.length;y++)h+=this.u1+b[y];h.length>this.bCg&&(h=h.substring(0,this.bCg));return this.Fvj(h,
u)}Fvj(b,h){const u=this.LJc(!0),y=[];let P;for(let ta=0;ta<u.count;ta++){var aa=u.J(ta);P=aa.ia(Lc.a.at,"");aa=this.OLc(!0,aa.id);P.startsWith(b)&&!h.equals(aa)&&y.push(P)}return 0<y.length?(y.sort((ta,Pa)=>ta.localeCompare(Pa,void 0,{numeric:!0})),(h=y[y.length-1].substring(b.length+1))?b+this.u1+(parseInt(h)+1):b+this.u1+1):b}rof(b){A.a.kf(b)?w.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.qfa(b),null===b?w.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):
(b=this.lma(b,!0))?(b=Kf.SelectionFactory.we(b.I$.paragraph,b.I$.Nb.cp))&&this.ib.setSelection(b):w.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}sUi(b){if(!b)return w.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;w.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Ic.Qc(15);h.Eb(this.KHa);this.rUi(b);this.S_c(b);h.dispose();return!0}JKc(b,h){if(!b||0>h)return w.ULS.sendTraceTag(545118153,
3029,10,String.format("Got null paragraph or negative cp value")),null;let u=null;const y=new ob.a,P=new ob.a;var aa=b.qa;for(var ta=0;ta<aa.length;ta++){var Pa=aa.J(ta);if(Pa.cp>h||Pa.cp===h&&0<y.count)break;if(Pa.Ph){var vb=Pa.Ph;if(2===vb.length&&vb.J(0).an.equals(vb.J(1).an)&&Pa.cp===h){y.add(vb.J(0).an.toString());break}for(let Kb=0,Sb=vb.length;Kb<Sb;Kb++){Pa=vb.J(Kb);const Yb=b.Jc.Db(Pa.an).ia(Lc.a.at,"");A.a.kf(Yb)||Yb.startsWith(this.u1)||(Pa.Oc?y.add(Pa.an.toString()):y.contains(Pa.an.toString())?
y.remove(Pa.an.toString()):P.add(Pa.an.toString()))}}}0<y.count&&(u=b.Jc.Db(T.a.Gf(y.J(y.count-1))));if(!u)for(h=be.ParagraphReader.Tg(b,!0);h&&!u;){for(aa=0;aa<h.qa.length;aa++)if(ta=h.qa.J(aa),ta.Ph){ta=ta.Ph;for(let Kb=0,Sb=ta.length;Kb<Sb;Kb++)vb=ta.J(Kb),Pa=b.Jc.Db(vb.an).ia(Lc.a.at,""),A.a.kf(Pa)||Pa.startsWith(this.u1)||(vb.Oc?P.contains(vb.an.toString())?P.remove(vb.an.toString()):y.add(vb.an.toString()):y.contains(vb.an.toString())?y.remove(vb.an.toString()):P.add(vb.an.toString()))}0<y.count?
u=h.Jc.Db(T.a.Gf(y.J(y.count-1))):h=be.ParagraphReader.Tg(h,!0)}return u}vnj(b,h){if(null===b)return w.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.Jkm(h)||this.A8k(h))return!1;const u=this.Ic.Qc(15);u.Eb(this.KHa);this.tvo(b,h);u.dispose();return!0}pNh(b){if(!this.fy)return w.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new yd.GraphIterator;h.set(this.fy);if(!this.Xac(h))return w.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),
null;if(!h.Rb(1))return null;do{const u=h.currentNode;if(b(u))return u}while(h.yf(1));return null}getBookmarkRange(b,h,u){for(let y=0;y<b.qa.length;y++){const P=b.qa.J(y);if(P.Ph)for(let aa=0;aa<P.Ph.length;aa++){const ta=P.Ph.J(aa);if(ta.an.equals(h.id)&&u===ta.Oc)return new Su(ta,0)}}w.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ia(Lc.a.oyb,-1),u,h.id,b.qa.length,this.UL(b));return new Su(null,1)}Xac(b){if(this.DB.EQ(b))return b=
b.Rb(30),w.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;w.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}Ejl(b){const h=new Tb.a;for(let u=0;u<b.qa.length;u++){const y=b.qa.J(u);if(y.Ph)for(let P=0;P<y.Ph.length;P++){const aa=y.Ph.J(P),ta=aa.an.toString();h.ub(ta)?(w.ULS.shipAssertTag(36218379,3029,aa.Oc!==h.J(ta).Oc),h.remove(ta)):h.add(ta,aa)}}return h.values}dWm(b,h){this.lec(b,h);this.KVm(b,h)}KVm(b,h){let u=be.ParagraphReader.Tg(b,
!1,!0);b=be.ParagraphReader.Tg(b,!0,!0);u||b?(u||this.Llh(h,!0)&&w.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||this.Llh(h,!1)&&w.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),u=u||b,b=b||u,this.Lyi(u,h,0,!0),this.Lyi(b,h,b.qa.last.cp,!1)):w.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}Llh(b,h){for(const u of b)if(h===u.Oc)return!0;
return!1}Lyi(b,h,u,y){const P=new ob.a;u=this.Pgf(b,u);for(const aa of h)aa.Oc===y&&(u?(h=this.F9j(b,y,u,aa.an))&&P.add(h):w.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",y));P.count&&(b.Cn(),this.vdg(b,P),w.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",P.count,y)))}F9j(b,h,u,y){const P=this.Tfb(y);return P?this.cSe(b,h,u,P):(w.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",y)),null)}cSe(b,
h,u,y){var P;if(!y)return w.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!u)return w.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),null;u.Ph||(u.Ph=new Wh.a(u));const aa=new Tm.a(u,null,y.id,h);u.Ph.add(aa);(h?this.uB.Ska:this.uB.hYa).set(null===(P=y.id)||void 0===P?void 0:P.toString(),b.id);return aa}vdg(b,h){if(h){w.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((u,
y)=>u.Je-y.Je);for(let u=0;u<h.count;u++){const y=h.J(u);y.Je?b.wordRunProperties.WZ(y.Je-1,1024):b.wordRunProperties.lva(y.Je,1024);b.wordRunProperties.Sq.Z(y.Je,ys.CharacterPropertiesEditor.IQ);b.wordRunProperties.rt.Z(y.Je,ys.CharacterPropertiesEditor.hU)}}else w.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}Pgf(b,h){if(!b||!b.qa||!b.qa.last)return null;w.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var u=
b.qa.length-1;if(!b.qa.J(u).formatting)for(var y=u-1;0<=y;y--){var P=b.qa.J(y);if(P.formatting){this.Rd.gY(b,u,h,P.formatting);break}}return b.qa.last}u=null;for(y=0;y<b.qa.length;y++){P=b.qa.J(y);if(P.cp>=h){if(P.cp>h||!P.formatting)this.Rd.gY(b,y,h,u),P=b.qa.J(y);P.Ph||(P.Ph=new Wh.a(P));w.ULS.shipAssertTag(36471768,3029,P!==b.qa.last);return P}P.formatting&&(u=P.formatting)}return null}D9j(b){const h=new yd.GraphIterator;h.set(this.fy);if(!this.Xac(h))return w.ULS.sendTraceTag(36471769,3029,10,
"Unable to move to BookmarkContainer"),null;b=this.xRk(b);h.d2(b,1,null);h.Ii(b);return b}xRk(b){const h=this.DFj.create(1074135153);h.setValue(Lc.a.at,b);h.setValue(Lc.a.oyb,Gc.a.lG());return h}S_c(b){if(b&&b.anchor){w.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",b.ia(Lc.a.oyb,-1),b.id);var h=new yd.GraphIterator;h.set(b);h.Ab(64);h.Jg()}}UL(b){const h=[];let u=0;for(;b.anchor.gr&&7!==b.type;)h[u]=ms.a[b.type],b=b.anchor.gr.Kr.node,u++;h[u]=ms.a[b.type];return h.join(" ")}tvo(b,
h){b.setValue(Lc.a.at,h)}rUi(b){const h=this.lma(b,!0).I$;b=this.lma(b,!1).I$;if(h&&b&&h.paragraph===b.paragraph){let u;this.lec(h.paragraph,(u=new ob.a,u.add(h),u.add(b),u))}else{if(h){let u;this.lec(h.paragraph,(u=new ob.a,u.add(h),u))}if(b){let u;this.lec(b.paragraph,(u=new ob.a,u.add(b),u))}}}z9j(b,h,u,y,P){if(h=this.cSe(b,!0,this.Pgf(b,h),u)){b.Cn();var aa;this.vdg(b,(aa=new ob.a,aa.add(h),aa));(u=this.cSe(y,!1,this.Pgf(y,P),u))?(y.Cn(),this.vdg(b,(aa=new ob.a,aa.add(u),aa))):w.ULS.sendTraceTag(520646733,
3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else w.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}mlf(b,h){var u;if(!b)return null;h=null!==(u=this.OLc(h,b.id))&&void 0!==u?u:T.a.nil;return b.Jc.Db(h)?b.Jc.Db(h):null}Pgi(b){return!!b&&64===b.ef}D3d(b,h){var u;if(0===b.Q8)return!1;for(let y=0;y<(null===(u=b.qa)||void 0===u?void 0:u.length);y++){const P=b.qa.J(y);if(null!=P.Ph)for(let aa=
0;aa<P.Ph.length;aa++){const ta=P.Ph.J(aa),Pa=b.Jc.Db(ta.an).yNa();if(!A.a.kf(Pa)&&(!Pa.startsWith(this.u1)||h)&&ta.Oc)return!0}}return!1}tgf(b,h){var u;const y=[];if(0===b.Q8)return y;for(let P=0;P<(null===(u=b.qa)||void 0===u?void 0:u.length);P++){const aa=b.qa.J(P);if(null!=aa.Ph)for(let ta=0;ta<aa.Ph.length;ta++){const Pa=aa.Ph.J(ta),vb=b.Jc.Db(Pa.an),Kb=vb.yNa();A.a.kf(Kb)||Kb.startsWith(this.u1)&&!h||!Pa.Oc||y.push(vb)}}return y}c8n(b){return b.ia(Lc.a.dG,!1)}Jkm(b){return A.a.kf(b)?(w.ULS.sendTraceTag(559228948,
3029,50,"bookmark name is null or empty"),!0):!1}A8k(b){return null!==this.qfa(b)?(w.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}rgf(b,h,u){return this.getBookmarkRange(b,h,u).I$}zuf(b,h,u){if(this.c8n(u)||this.Opm(u))return!1;const y=this.mlf(u,!0),P=this.mlf(u,!1);if(y&&P&&this.eb.yRc(h,y,P)){if(h!==y&&h!==P)return!0;const aa=this.rgf(y,u,!0);if(aa&&(y!==h||aa.Nb.cp<=b)&&(u=this.rgf(P,u,!1))&&(P!==h||u.Nb.cp>=b))return!0}return!1}Opm(b){b=
null===b||void 0===b?void 0:b.ia(Lc.a.at,"");return!A.a.kf(b)&&b.startsWith(this.u1)?!0:!1}}Object(m.a)(Iv,"FullBookmarkManager",null,[519]);class Vw{constructor(){this.ETa=this.Dn=this.W=null}get name(){return"WordEditor.Bookmark"}xc(b){this.W=b;this.Dn=this.W.resolve("Box4.INotebookManager").sl;const h=new Iv(new Zf.a(()=>Ra.App.xa.jb.Yc),xl.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new Zf.a(()=>Ra.App.xa.jb.wc.jd),oi.a.instance,this.W.resolve("Box4.IParagraphReader"),
this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new Gj(this.Dn.Xe(12),this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();vk.App.aje&&(this.ETa=new py(this.Dn.Xe(64),new Zf.a(()=>Ra.App.xa.jb.Yc),xl.PageNavigator.instance,
fq.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.ETa).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()})}dispose(){this.ETa.dispose()}$m(){w.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");if(vk.App.Xie)this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();else if(vk.App.aje){this.ETa.initialize();const b=
new WA(this.ETa,this.W.resolve("Box4.BookmarkParagraphMapping"));this.Dn.Xe(12).Mv(Object(v.a)(b,b.y3a,"onParagraphDelete"));Kl.a.evd(Object(v.a)(b,b.SWc,"onParagraphCopy"));Kl.a.FAc(Object(v.a)(b,b.UWc,"onParagraphPaste"))}w.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.Zxn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}Zxn(b,h){b&&b.execute(u=>{u.a4(new Uw(h))})}static main(){K.a.instance.Kc(new Vw)}}
Object(m.a)(Vw,"BookmarkPackage",null,[1,2]);var Tu=c(870),XA=c(1024),qq=c(1503),Vt=c(1375);class mv extends Vt.a{constructor(b){super();this.k6j=b}get index(){return 3}run(){this.k6j()}BH(){this.OX()}}Object(m.a)(mv,"FootnoteEndnoteGraphUpdateTracker",Vt.a,[]);class aA{constructor(){this.cfd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}xc(){}init(){aA.$b.hp.continueWith(()=>{this.$m()})}$m(){Tu.a.xfb=qq.a.instance;this.zqf()}dispose(){}zqf(){this.cfd=new mv(()=>{qq.a.instance.Iu()});
XA.a.F7d(Object(v.a)(this.cfd,this.cfd.BH,"setUpdateNeeded"));Pi.GraphTransactionManager.instance.epa(this.cfd,3)}static get $b(){return Ja.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(aA,"PackageManager",null,[1,2]);var Dr=c(770),bA=c(210),vx=c(551),Ww=c(499),wx=c(1594);class xx extends Qr{constructor(){super()}get Cw(){return null}getTitle(b){b=b.sma();if(!b||!vx.a.instance.nna(b))return"";const h=new Sys.StringBuilder,u=vx.a.instance.f7(b);h.append(1===u?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:
WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(vx.a.instance.sCb(b));return h.toString()}}Object(m.a)(xx,"FootnoteEndnoteBaseDetailsProvider",Qr,[]);class fz extends xx{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get li(){return 7}}Object(m.a)(fz,"FootnoteEndnoteDetailsProvider",xx,[]);var ry=c(1551),Uu=c(1568),Gt=c(1636);class yx extends xx{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get li(){return 10}}Object(m.a)(yx,"FootnoteEndnoteRefMarkDetailsProvider",
xx,[]);class Wt{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce){this.eei=(Nd,re,Xd,vg,Vf)=>{vg=re.view;if(!vg.features.hee||this.BC.Lhi)return 8;const kj=vg.Bb.Lg;if(!kj)return 2;if(this.Tk.xZ(kj))return 8;vg=Nd===Rc.a.insertFootnote?1:0;var zm=this.UId(re);if(!zm)return w.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;re=!0;zm=zm.Qa;Vf&&Vf.x9b&&Vf.eEa&&(zm=Vf.eEa,re=!Vf.keepCurrentFocus);if(1===Xd&&Ye.a.dga(kj)||!zm||!Se.SelectionEditor.pf(zm)||this.ZEg.instance&&
this.ZEg.instance.Xqm(zm)||yi.HyperlinkReader.fga(zm,!0))return 8;if(1===Xd)return 32;2===Xd&&(Xd=this.VV.jg("UserAction","InsertFootnoteEndnote"),Nd=this.vMj.ngm(zm,vg,Nd),Vf&&Vf.x9b&&(Vf.ZAi=Nd),re&&this.C2d(Nd,!0,!0),Xd.stop(),this.Ud.Ds(6));return 32};this.ibc=(Nd,re,Xd)=>{const vg=re.view;if(Nd===Rc.a.mnb||Nd===Rc.a.VMb){if(!vg.features.hee)return 8}else if(!vg.features.D8f)return 8;if(!vg.Bb.Lg)return 2;re=this.L5b(re);return re?Nd!==Rc.a.mnb&&Nd!==Rc.a.VMb||this.hJa.c6l(re.node,Nd===Rc.a.mnb?
1:0)?1===Xd?32:2===Xd&&32===this.ga.Ub(Rc.a.eaa,2,!0)?(this.ga.Ub(Rc.a.Hzi,2,Nd),32):8:8:2};this.onl=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;if(2===Xd){Nd=this.rTl(re);if(!Nd)return 8;Xd=re=null;switch(Vf){case Rc.a.VHf:Xd=Nd.Tc;re=this.XSb.yNd(Xd,1);break;case Rc.a.UHf:Xd=Nd.Tc;re=this.XSb.yNd(Xd,0);break;case Rc.a.XHf:Xd=Nd.Qa;re=this.XSb.q8h(Xd,1);break;case Rc.a.WHf:Xd=Nd.Qa;re=this.XSb.q8h(Xd,0);break;case Rc.a.mnb:Xd=Nd.Qa;(re=this.XSb.yNd(Xd,1,!0))||(re=this.hJa.XWh(Xd.node,1));break;case Rc.a.VMb:Xd=
Nd.Qa,(re=this.XSb.yNd(Xd,0,!0))||(re=this.hJa.XWh(Xd.node,0))}if(re)this.C2d(re);else{if(!this.Ht.wc)return 8;(Vf=En.d(Xd.node,Xd.cpBegin))&&7===Vf.li&&this.hJa.t2i(Vf)}}return 32};this.l$n=(Nd,re,Xd,vg,Vf)=>1===Xd?32:2===Xd?(w.ULS.shipAssertTag(4520066,308,!!Vf),w.ULS.shipAssertTag(4520067,308,!!Vf.WYa),Nd=Vf.WYa,w.ULS.shipAssertTag(4520068,308,this.bF.nna(Nd)),this.C2d(Nd,Vf.Ebe)?32:8):32;this.m$n=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;2===Xd&&(Nd=Vf.footnoteEndnoteNode,Vf=Vf.rnl)&&(this.Yqa.h3b(),
re=this.bF.oib(Nd),Vf.title=this.bF.QDl(Nd)+(re?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.Wkb=(Nd,re,Xd,vg,Vf)=>2===Xd?(w.ULS.shipAssertTag(4520069,308,!!Vf),w.ULS.shipAssertTag(4520070,308,!!Vf.WYa),w.ULS.shipAssertTag(4520071,308,be.ParagraphReader.ic(Vf.WYa)),Nd=this.bF.U4b(Vf.WYa),this.C2d(Nd,Vf.Ebe)?32:8):32;this.DXn=(Nd,re,Xd)=>{2===Xd&&this.BC.aY();return 32};this.U5k=(Nd,re,Xd,vg,Vf)=>{if(1===
Xd)return 32;if(2===Xd)return void 0!==Vf&&null!==Vf?this.BC.U8e(Vf,Vf):this.BC.U8e(),32;w.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.$Bm=(Nd,re,Xd)=>{Nd=this.L5b(re);return Nd&&Se.SelectionEditor.pf(Nd)?1===Xd?32:2===Xd?(Xd=0<this.so.Z2(Nd.node).yt,this.BC.n4e(),this.BC.dialog.ehb=Xd,32):8:(w.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.mnl=(Nd,re,Xd)=>1===Xd?32:2===Xd?(this.BC.dialog.ehb=!1,32):8;this.ipn=
(Nd,re,Xd,vg,Vf)=>this.RPh(Nd,Xd,Vf);this.gpn=(Nd,re,Xd,vg,Vf)=>1===Xd?32:this.BC.dialog&&this.BC.dialog.fontName?(Vf[te.a.Value]=this.BC.dialog.fontName,32):this.IIj.aNa(Oa.a.dKb.toString(),Vf,null)?32:8;this.lnl=(Nd,re,Xd)=>1===Xd?32:2===Xd?(this.BC.dialog.ehb=!0,32):8;this.hpn=(Nd,re,Xd,vg,Vf)=>this.RPh(Nd,Xd,Vf);this.jnl=(Nd,re,Xd)=>{if(1===Xd)return 32;if(2===Xd){Nd=this.L5b(re);if(!Nd)return w.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;re=this.bF.U4b(Nd.node);
this.bF.nna(re)&&(Xd=this.Ic.Qc(15),Xd.Eb(re),this.xoj(Nd),this.hJa.uih(re,this.BC.dialog),Xd.dispose());this.BC.T0c();return 32}return 8};this.inl=(Nd,re,Xd)=>{if(1===Xd)return 32;if(2===Xd){Nd=this.L5b(re);if(!Nd)return w.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;re=this.bF.U4b(Nd.node);this.bF.nna(re)&&(Xd=this.Ic.Qc(15),Xd.Eb(re),this.xoj(Nd),this.hJa.Flk(re,this.BC.dialog),Xd.dispose());this.BC.T0c();return 32}return 8};this.knl=(Nd,re,Xd)=>1===Xd?32:2===Xd?(this.BC.T0c(),
32):8;this.gnl=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;if(2===Xd){Nd=Object(na.a)(18,Vf);if(!Nd||!Nd.vd)return 8;this.BC.dialog.fontName=Nd.vd.fontName;return 32}return 8};this.hnl=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;if(2===Xd){Nd=Object(na.a)(18,Vf);if(!Nd||!Nd.vd)return 8;this.BC.dialog.WSb=Nd.vd;return 32}return 8};this.ga=b;this.Ht=h;this.IIj=u;this.fd=y;this.bF=P;this.vMj=aa;this.hJa=ta;this.Yqa=Pa;this.BC=vb;this.so=Kb;this.XSb=Sb;this.Ic=Yb;this.Tk=Ac;this.Gb=Sc;this.VV=nd;this.Ud=Ad;this.LCj=
he;this.ZEg=ce}xoj(b){(b=Wi.FormattingReader.zr(b))?(this.BC.dialog.fontName||(this.BC.dialog.fontName=b.cache.lH),-1===this.BC.dialog.fontSize&&(this.BC.dialog.WSb=b.cache.fontSize)):w.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}RPh(b,h,u){return 1===h&&this.BC.dialog?32:2===h&&this.BC.dialog?(u[Bi.a.On]=b===Rc.a.NTf?this.BC.dialog.ehb:!this.BC.dialog.ehb,32):8}Wb(){this.ga.gb(Rc.a.insertFootnote,oc.a.view,this.eei,4);this.ga.gb(Rc.a.insertEndnote,
oc.a.view,this.eei,4);this.ga.pa(Rc.a.VHf,oc.a.view,this.ibc);this.ga.pa(Rc.a.Hzi,oc.a.view,this.onl);this.ga.pa(Rc.a.UHf,oc.a.view,this.ibc);this.ga.pa(Rc.a.XHf,oc.a.view,this.ibc);this.ga.pa(Rc.a.WHf,oc.a.view,this.ibc);this.ga.pa(Rc.a.mnb,oc.a.view,this.ibc);this.ga.pa(Rc.a.VMb,oc.a.view,this.ibc);this.ga.pa(Rc.a.abj,oc.a.view,this.l$n);this.ga.gb(Rc.a.PPh,oc.a.view,this.lnl,4);this.ga.gb(Rc.a.NTf,oc.a.view,this.hpn,100);this.ga.gb(Rc.a.QPh,oc.a.view,this.mnl,4);this.ga.gb(Rc.a.FPi,oc.a.view,this.ipn,
100);this.ga.pa(Rc.a.bbj,oc.a.view,this.m$n);this.ga.gb(Rc.a.Wkb,oc.a.view,this.Wkb,96);this.ga.gb(Rc.a.eef,oc.a.view,this.DXn,96);this.ga.pa(Rc.a.eaa,oc.a.view,this.U5k);this.ga.gb(Rc.a.fri,oc.a.view,this.$Bm,4);this.ga.gb(Rc.a.MPh,oc.a.view,this.jnl,4);this.ga.gb(Rc.a.NPh,oc.a.view,this.inl,4);this.ga.gb(Rc.a.OPh,oc.a.view,this.knl,4);this.ga.gb(Rc.a.MHd,oc.a.view,this.gnl,4);this.ga.gb(Rc.a.EPi,oc.a.view,this.gpn,100);this.ga.gb(Rc.a.NHd,oc.a.view,this.hnl,4);this.ga.gb(Rc.a.xYc,oc.a.view,Wt.xYc,
100);this.ga.gb(Rc.a.yYc,oc.a.view,Wt.yYc,100)}gWf(){this.LCj.execute(b=>{b.a4(new fz);b.a4(new yx)})}L5b(b){b=this.UId(b);return b?b.Qa:(w.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}UId(b){let h=null;b=b.view;if(!b)return w.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.Bb;if(!b)return w.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.hb;if(!b||!b.length)return w.ULS.sendTraceTag(51512528,308,
10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return w.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=Se.SelectionEditor.Vj(b,!1,!1))||w.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}rTl(b){return(b=b.view)?b.Bb.hb.J(0):null}C2d(b,h=!0,u=!1){if(b){this.Yqa.h3b();var y=b.fma;if(y){var P=y.Nb,aa=Kf.SelectionFactory.JL(P.paragraph,P.cp,P.cp+1);P=this.Ht.wc;if(!P)return!1;this.fd.pca(P,aa);P.tmb=150;
P.h4();b=new Ww.a(b,h);aa=bA.a.a5b(y,P);y=y.oDa(P,aa);if(!y)return w.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;u||y.element?this.BC.v5f(b):(this.BC.v5f(new Ww.a(b.WYa,!1)),h&&(h=new sc.a(2,1,10,()=>{this.BC.aY()}),this.Gb.Xb(h)));return!0}}return!1}static HDl(){return new Wt(r.AFrameworkApplication.ya,Ra.App.xa.jb,Ja.a.instance.resolve("Box4.IGeneralCuiUser"),ab.InteractiveViewManager.instance,vx.a.instance,Uu.a.instance,ry.a.instance,qq.a.instance,wx.FootnoteEndnoteControlManager.instance,
Ja.a.instance.resolve("Box4.IParagraphIndentationReader"),Gt.a.instance,new oi.a,sd.a.instance,lf.a.instance,r.AFrameworkApplication.ta.tq,Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ja.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Ja.a.instance.Za("Box4.IContentControlReader"))}static GDl(){return Wt.HDl()}static xYc(b,h,u,y,P){if(1===u)return 32;if(2===u&&!P)return 8;Fg.a.EQd(h);P.PopulationXML=np.FontUtils.jRh(Fg.a.Vbe,Fg.a.Fef,Rc.a.MHd);return 32}static yYc(b,
h,u,y,P){if(1===u)return 32;if(2===u&&!P)return 8;P.PopulationXML=np.FontUtils.kRh(Rc.a.NHd);return 32}}Object(m.a)(Wt,"FootnoteEndnoteActor",null,[670]);class gz extends Vt.a{constructor(b){super();this.WPe=b}get index(){return 1}run(){this.WPe()}BH(){this.OX()}}Object(m.a)(gz,"FootnoteEndnoteControlUpdateTracker",Vt.a,[]);var hz=c(372);class zx extends hz.a{constructor(b,h,u,y,P,aa,ta,Pa){super(b,h,u,y);this.Qs=()=>{this.$6c(this.yb)};this.KH=b.container;this.Ev=document.createElement("div");b.container.appendChild(this.Ev);
this.rC(this.Ev);this.Q_j=P;this.Wn.execute(vb=>{vb.u8(this.Qs)});this.lJa=aa;this.UJ=ta;this.WH=Pa;this.lJa.execute(vb=>{vb.V3f(this.Yb,this.KH)});this.WH&&(this.KH.style.backgroundColor=this.UJ.w5b())}dispose(){super.dispose();this.Wn.instance&&this.Wn.instance.Ylb(this.Qs)}get Wn(){return null!=this.Zpg?this.Zpg:this.Zpg=Ja.a.instance.Za("Common.IZoomManager")}qz(b){this.KH.classList.add("FootnoteEndnoteViewElement");this.$6c(b.currentNode)}$6c(b){this.Wn.instance&&(this.Wn.instance.M8c(this.Ev),
this.Ev.style.width=Math.round(100/this.Wn.instance.jj)+"%");this.Q_j(b)}}Object(m.a)(zx,"FootnoteEndnoteViewElement",hz.a,[]);class YA{constructor(){this._initialized=!1;this.xbd=this.Iue=this.W=null;this.tnl=(b,h,u,y)=>b.L1a?new zx(b,h,u,y,P=>{wx.FootnoteEndnoteControlManager.instance.gJn(P)},this.W.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ra.App.instance&&Ra.App.instance.bC):null}get name(){return"WordEditor.FootnoteEndnote"}xc(b){this.W=
b}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()})}$m(){to.WordSectionNavigator.instance.$Hf=Object(v.a)(ry.a.instance,ry.a.instance.ZWm,"navigateToWordSectionNodeWithFootnoteEndnote");Dr.a.K3f(this.tnl);wx.FootnoteEndnoteControlManager.instance.bind(Ra.App.xa.vC);this.Iue=Wt.GDl();this.Iue.Wb();this.Iue.gWf();Ra.App.xa.updateCommandUI();this.zqf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,wx.FootnoteEndnoteControlManager.instance.dispose())}zqf(){this.xbd=
new gz(()=>{wx.FootnoteEndnoteControlManager.instance.a7c()});XA.a.F7d(Object(v.a)(this.xbd,this.xbd.BH,"setUpdateNeeded"));Pi.GraphTransactionManager.instance.epa(this.xbd,3)}}Object(m.a)(YA,"PackageManager",null,[1,2]);class cA{constructor(b,h,u,y,P=null){this.gTj=b;this.ib=h;this.yda=y;this.uB=P}get Jlh(){return this.gTj.value}get bookmarkManager(){return this.yda.value}Oqm(b){return vk.App.aje||vk.App.Xie?b.startsWith(A.a.Kcb):!1}m3l(b){var h,u;try{if(vk.App.Xie)this.n3l(b);else if(vk.App.aje&&
this.Jlh){var y=b.split("/"),P=this.Jlh.qfa(y[y.length-1]);if(P&&P.anchor)if(this.uB.Ska.has(null===(h=P.id)||void 0===h?void 0:h.toString())){var aa=this.uB.Ska.get(null===(u=P.id)||void 0===u?void 0:u.toString());if(void 0===aa||null===aa)w.ULS.sendTraceTag(24691933,324,50,"Empty StartBookmarkParaId in the bookmark node"),this.JVd();else{var ta=Ra.App.xa.jb.Yc.Bd.Db(aa);if(ta&&ta.anchor){var Pa=Kf.SelectionFactory.we(ta,0);this.ib.setSelection(Pa)}else w.ULS.sendTraceTag(24691934,324,50,"Paragraph node is invalid for bookmark"),
this.JVd()}}else w.ULS.sendTraceTag(24691932,324,50,"Missing StartBookmarkParaId in the bookmark node"),this.JVd();else w.ULS.sendTraceTag(24691931,324,15,"Cannot find bookmark node"),this.JVd()}}catch(vb){w.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",vb.message))}}Qag(b){return{returnValue:!1,HWf:b,DQh:""}}n3l(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.qfa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.lma(h,!0).I$,h=this.bookmarkManager.lma(h,
!1).I$,b||h?b?this.x7i(b):(w.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.x7i(h)):(w.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.zzf(!1))):(w.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.zzf(!0))}}JVd(){this.zzf(!0)}zzf(b){b=Kf.SelectionFactory.Un(Ra.App.xa.jb.Yc.vhf(),b);this.ib.setSelection(b)}x7i(b){b.paragraph&&b.Nb?(b=Kf.SelectionFactory.we(b.paragraph,b.Nb.cp),b.Qgi=!0,this.ib.setSelection(b)):w.ULS.shipAssertTag(35992279,
324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(m.a)(cA,"InternalLinkManager",null,[367]);class iz{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}xc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",()=>new cA(new Zf.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new Zf.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){K.a.instance.Kc(new iz)}}
Object(m.a)(iz,"WordEditorInternalLinksPackage",null,[1,2]);class gw{constructor(b){this.RJa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){kh.a.mark(4763);var u=yd.GraphIterator.$a(h);if(u.Ab(8)&&u.kd(8)&&u.qlj(h)===h){if(Jf.OutlineReader.isEmpty(u)){let y=!1;for(let P=0;P<Hh.a.instance.hb.length;P++){const aa=Hh.a.instance.hb.J(P);for(let ta=0;ta<aa.length;ta++)if(aa.J(ta).node===h){y=!0;break}}y||this.mEh(u)}kh.a.mark(4764)}}};gw.TJ=b}PBd(b){if(!gw.Te.hUd(b))return null;
b.Rb(1)&&(b.currentNode.Ck(8,!0),b.qc());const h=gw.TJ.HVk();gw.Te.isRtl(b.currentNode)?h.setValue(Ge.a.Yp,11):h.setValue(Ge.a.Yp,9);b.Qf(h,1);b.Ii(h);return h}bZn(b){if(this.RJa&&b!==this.RJa){const h=new sc.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.RJa;r.AFrameworkApplication.uc.Xb(h)}this.RJa=b}mEh(b){this.RJa===b.currentNode&&(this.RJa=null);const h=new dg.GraphTransaction(7);h.ev(b);b.Jg();h.dispose()}csh(){if(this.RJa&&this.RJa.anchor){const b=yd.GraphIterator.$a(this.RJa);
b.jo()&&Jf.OutlineReader.xQc(b)&&this.mEh(b);this.RJa=null}}static get Te(){return se.PageReader.instance}}gw.TJ=null;Object(m.a)(gw,"PageContentEditor",null,[1229]);var ZA=c(1149),uo=c(650);class Jv extends Tg{constructor(){super()}C$i(b,h,u,y,P){let aa=!1,ta=!0;Se.SelectionEditor.pf(P)&&(h=wj.ListReader.lj(b)&&h,P=wg.OutlineElementReader.cA(b,P,!1)&&!wg.OutlineElementReader.cA(b,P,!0),h&&u.KZe(b,y)&&(aa=!0),Ra.App.yd.Xp&&(P||h&&!aa)&&(ta=!1));return{B$i:ta,rtj:aa}}}Object(m.a)(Jv,"CursorMoveValidator",
Tg,[]);class Om{constructor(b,h,u,y){this.EGe=b;this.r5=y;this.RH=h;this.Bh=u;this.EPj=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("QoEIndentLeftForListImprovementIsEnabled")}get Kd(){return null!=this.Wxg?this.Wxg:this.Wxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Dj(){return null!=this.Gxg?this.Gxg:this.Gxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get nc(){return null!=this.mzg?this.mzg:this.mzg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Yr(){return this.r5.value}get ih(){return this.Bh.value}get Uo(){return this.RH}n1l(b){const h=
window.performance.now(),u=new Oh.ScriptSharpLegacyMap,y=new lg.a,P=new Oh.ScriptSharpLegacyMap;if(b&&b.Hw){var aa=null;for(let ta=0;ta<b.length;ta++){const Pa=b.getContext(ta);aa=aa||Om.mh.Wt(Pa.node);let vb;if(!({groupId:vb}=this.Lqo(Pa.node,aa)).returnValue)continue;let Kb;u.ub(vb)||(Kb=[],u.add(vb,Kb));Kb=u.J(vb);Kb.push(Pa)}for(const ta of Qj.toArray(u.keys))b=u.J(ta),aa=new yd.GraphIterator,aa.set(b[0].node),({GZi:b,Ut:aa}=this.RH.iqo(aa)).returnValue?(u.Z(ta,b),P.add(ta,aa)):y.add(ta)}w.ULS.sendTraceTag(589592455,
338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:u,q1l:y,p1l:P}}Gyb(b){return this.DAk(b)}R_b(b){return this.dAk(b)}Nxd(b,h,u=!0){return yd.GraphIterator.Q6(()=>{var y=!1;if(wj.ListReader.lj(b))return this.KZe(b,h,u);y||(og.OutlineElementNavigator.Ee(b),y=be.ParagraphReader.rh(b)||xh.TableReader.isTable(b),og.OutlineElementNavigator.$d(b),y=y&&this.BAk(b,h));return y})}KZe(b,h,u=!0){return yd.GraphIterator.Q6(()=>{const y=wg.OutlineElementReader.eDa(b),
P=Jf.OutlineReader.ZN(b.currentNode);if(u?!this.ksm(b,h):!this.lsm(b,h))return!1;var aa=yd.GraphIterator.$a(b.currentNode);if(0<h&&aa.Ab(14)){aa.kd(16);var ta=aa.currentNode;const Pa=hi.TableCellReader.dnf(aa);aa.kd(14);const vb=aa.currentNode;aa=$o.a.LI(ta,vb,Lc.a.AM,Lc.a.za,0);ta=$o.a.LI(ta,vb,Lc.a.DO,Lc.a.Aa,0);aa=Bf.a.jy(aa,0);ta=Bf.a.jy(ta,0);return y+P<Pa-aa-ta}return!0})}BAk(b,h){const u=wg.OutlineElementReader.eDa(b);var y=wg.OutlineElementReader.QF(b);if(0<h){h=Jf.OutlineReader.ZN(b.currentNode);
y=0;const {Ao:Pa,marginLeft:vb,marginRight:Kb}=Om.uLd(b.currentNode);var P=yd.GraphIterator.$a(b.currentNode);og.OutlineElementNavigator.Ee(b);if(xh.TableReader.isTable(b)){y=xh.TableReader.tfa(b);var aa=0;for(var ta of y)aa+=ta;y=Bf.a.jy(Bf.a.lf(aa,0),0)}og.OutlineElementNavigator.$d(b);return P.Ab(14)?(P.kd(16),ta=P.currentNode,b=hi.TableCellReader.dnf(P),P.kd(14),aa=P.currentNode,P=$o.a.LI(ta,aa,Lc.a.AM,Lc.a.za,0),ta=$o.a.LI(ta,aa,Lc.a.DO,Lc.a.Aa,0),P=Bf.a.jy(P,0),ta=Bf.a.jy(ta,0),u+h<b-P-ta-y):
u+h<Pa-vb-Kb-y}return 0<u-y}SQa(b,h){this.aJi(b,-1*Math.abs(h))}kGc(b,h){this.aJi(b,Math.abs(h))}T3k(b,h,u,y,P){let aa=Om.hyi;if(h>=Om.hyi){aa=h-=u;const ta=y*P,Pa=Math.abs(ta),vb=Math.abs(h)%Pa;vb&&(aa=0>aa?0>y?aa+vb:aa-(Pa-vb):0<y?aa-vb:aa+(Pa-vb));aa+=ta;aa+=u;Om.G3d&&(u=wg.OutlineElementReader.Z2(b),aa=Om.G3d.gUh(b.currentNode,h+u,aa+u,P,aa<h)-u)}return aa}zAk(b,h,u){if(!b||!b.length)return!1;h=u?h?-1:1:this.OVh(b[0].node,h);return this.AAk(b,h,u)}Vbn(b,h,u){if(!b)return w.ULS.shipAssertTag(589345600,
338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return w.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!u)return w.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!u.length)return w.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const y=b[0].node;h=this.OVh(y,h);if(!this.sVm(y,u[0],h)||!this.pVm(b,
h))return 8;this.Yr.Rpa();return 32}pVm(b,h){for(let u=0;u<b.length;u++){const y=new yd.GraphIterator;y.set(b[u].node);let P=null;og.OutlineElementNavigator.Ee(y);if(be.ParagraphReader.rh(y)){if(P=y.currentNode,!P)return w.ULS.shipAssertTag(589592461,338,!P,"The paraNode is null for the list OE node"),!1}else if(!be.ParagraphReader.rh(y)&&!xh.TableReader.isTable(y))return w.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;y.qc();if(P){if(this.j6l(P)){const aa=
P.hD(),ta=wg.OutlineElementReader.eDa(y);this.ih.zxa(y,1,ta+h);aa&&this.Dj.FU(P,aa,this.Kd.zg)}P.setValue(Ge.a.bU,new Date)}}return!0}sVm(b,h,u){for(let y=0;y<Nf.a.Jga;y++){const P=this.RH.hx(b,h,y);if(!P)return w.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const aa=P.getValue(Lc.a.fe);aa&&P.setValue(Lc.a.fe,aa+u)}return!0}j6l(b){return b.hasProperty(Lc.a.fe)||b.hasProperty(Lc.a.tt)||b.hasProperty(Lc.a.iC)}dAk(b){return this.Nxd(b,1,!0)}DAk(b){return this.Nxd(b,
-1,!0)}OVh(b,h){var u=new yd.GraphIterator;u.set(b);const y=wg.OutlineElementReader.eDa(u),P=wg.OutlineElementReader.QF(u),aa=wg.OutlineElementReader.Z2(u);u=Jf.OutlineReader.ZN(b);Om.uLd(b);b=(P?y-P:aa)%u;return h?-1*(b?b:u):u-b>Om.oDh?Om.oDh:u-b}Lqo(b,h){let u;const y=new yd.GraphIterator;y.set(b);b=y.Rb(4).getValue(Lc.a.listID);return({id:u}=this.RH.mOb(b,h)).returnValue?{returnValue:!0,groupId:u}:{returnValue:!1,groupId:u}}AAk(b,h,u){var y=!1;for(let P=0;P<b.length;P++){y=b[P];const aa=new yd.GraphIterator;
aa.set(y.node);Se.SelectionEditor.eu(aa);if(!wg.OutlineElementReader.Oh(aa))return Om.Mc.fc($c.a.vf,{["Reason"]:Zc.a.yeb}),!1;if(this.Nxd(aa,h,u))y=!0;else return Om.Mc.fc($c.a.w2b,{["Reason"]:Zc.a.a_e}),!1}return y}aJi(b,h){if(this.Nxd(b,h,!0)){var u=!1;if(wj.ListReader.lj(b)){var y=new yd.GraphIterator;y.ed(b);this.Uo.fG(y);var P=y.currentNode;y.qc();const ta=P.getValue(Lc.a.listLevel);u=!0;var aa=P.getValue(Lc.a.listID);if(aa=this.TUl(aa,ta+h))og.OutlineElementNavigator.Ee(y),be.ParagraphReader.rh(y)&&
Om.HM.QK(aa,y.currentNode,!1),y.qc();else{aa=null;let Pa;og.OutlineElementNavigator.Ee(y);be.ParagraphReader.rh(y)&&(aa=y.currentNode);y.qc();Pa=aa?aa.hD():null;this.EPj&&(aa||(og.OutlineElementNavigator.Ee(y),be.ParagraphReader.rh(y)&&(aa=y.currentNode),y.qc()),aa&&(aa.hasProperty(Lc.a.fe)&&aa.removeProperty(Lc.a.fe),aa.hasProperty(Lc.a.tt)&&aa.removeProperty(Lc.a.tt)));this.Yr.uYf(y,ta,h);P.setValue(Lc.a.listLevel,ta+h);P.removeProperty(Lc.a.xga);aa&&Pa&&(this.Dj.FU(aa,Pa,this.Kd.zg),this.Yr.Rpa());
this.Bio(b,P)}}u||(u=wg.OutlineElementReader.eDa(b),y=wg.OutlineElementReader.QF(b),P=Jf.OutlineReader.ZN(b.currentNode),h=this.T3k(b,u,y,h,P),this.ih.zxa(b,1,h))}}lsm(b,h){const u=wg.OutlineElementReader.eDa(b),y=wg.OutlineElementReader.QF(b),P=wg.OutlineElementReader.Z2(b),{Ao:aa,marginLeft:ta,marginRight:Pa}=Om.uLd(b.currentNode);if(0<h){if(b=aa-ta-Pa,P&&P+h+Ra.App.oya>b||u+h+Ra.App.oya>b)return!1}else if(P&&0>u+h||0>u-y+h)return!1;return!0}ksm(b,h){var u=this.Yr.NA(b);const y=u.level+h;if(Cp.a.bWd<
y||y<Cp.a.qdf)return!1;u=this.Uo.hx(b.currentNode,u.listID,y);if(!u)return w.ULS.shipAssertTag(590700875,338,!!u),!1;if(0<h&&u.hasProperty(Lc.a.fe)){h=u.getValue(Lc.a.fe);const {Ao:P,marginLeft:aa,marginRight:ta}=Om.uLd(b.currentNode);if(h+Ra.App.oya>P-aa-ta)return!1}return!0}TUl(b,h){const u=this.nc.Yn();for(let y=0;y<u.GL;y++){const P=u.Hfa(y);if(this.Uo.FAb(P)&&P.ia(Lc.a.listID,this.Yr.N7+1)===b&&P.ia(Lc.a.listLevel,-1)===h)return P}return null}Bio(b,h){og.OutlineElementNavigator.Ee(b);if(be.ParagraphReader.rh(b)&&
b.currentNode.hasProperty(Lc.a.fe)&&(h=this.Uo.sLc(h))){if(h.hasProperty(Lc.a.tt)){var u=h.getValue(Lc.a.tt);this.EGe.Kmb(b.currentNode,u)}h.hasProperty(Lc.a.fe)&&(u=h.getValue(Lc.a.fe),this.EGe.zxa(b,1,u));h.hasProperty(Lc.a.iC)&&(h=h.getValue(Lc.a.iC),this.EGe.jca(b.currentNode,h))}og.OutlineElementNavigator.$d(b)}static get HM(){return null!=Om.Myg?Om.Myg:Om.Myg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get G3d(){return null!=Om.hvg?Om.hvg:Om.hvg=Ja.a.instance.Pa("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return Om.Cs||
(Om.Cs=Ja.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){Om.Cs=b}static get Mc(){return ri.a.instance}static get Uf(){return so.a.instance}static get mh(){return xl.PageNavigator.instance}static uLd(b){var h=to.WordSectionNavigator.instance.fJ(b);b=Om.Uf.Pt(h);const u=Om.Uf.JI(h);h=Om.Uf.sK(h);return{Ao:b,marginLeft:u,marginRight:h}}}Om.oDh=Xf.a.Xy(.25);Om.Cs=null;Om.hyi=Xf.a.Xy(-11);Object(m.a)(Om,"OutlineElementIndentationEditor",null,[368,369]);var yl=c(495),$A=c(215),
jz;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(jz||(jz={}));Object(m.b)("StyleTargetType",jz);var LB=c(168);class kz{constructor(b,h){this.RC=null;this.ZH=h;this.If=b}get paragraphEditor(){return null!=this.Pug?this.Pug:this.Pug=Ja.a.instance.resolve("Box4.IParagraphEditor")}get LF(){return null!=this.spg?this.spg:this.spg=Ja.a.instance.resolve("Box4.IFontStylesGalleryCache")}get vj(){return null!=this.Jwg?this.Jwg:this.Jwg=Ja.a.instance.Pa("Box4.Styles.StyleSettings")}get Jn(){return null!=
this.Lpg?this.Lpg:this.Lpg=Ja.a.instance.resolve("Box4.IFormattingEditor")}get nc(){return null!=this.pzg?this.pzg:this.pzg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Oca(){return this.RC||(this.RC=new uo.WACStyleSet)}set Oca(b){this.RC=b}get $b(){return null!=this.apg?this.apg:this.apg=Ja.a.instance.Pa("Box4.IFeatureHelper")}get xn(){return this.ZH.value}get uj(){return null!=this.Mqg?this.Mqg:this.Mqg=Ja.a.instance.Pa("Box4.IInsertionPointFormatting")}get YTc(){return this.If||(this.If=
Ja.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=this.zmg?this.zmg:this.zmg=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Kd(){return null!=this.myg?this.myg:this.myg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Dj(){return null!=this.Nxg?this.Nxg:this.Nxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}bVl(b){const h=b.node;var u=this.uj?this.uj.MTh():null;if(u&&!u.equals(T.a.nil)){b=
h.Jc;if(!b)return null;u=b.Db(u);if(!u||(u=new LB.a(u),1!==this.nc.lx(u)))return null}else u=Wi.FormattingReader.zr(b),u=Wi.FormattingReader.Kma(u);return u}S1n(b,h){const u=this.nc.jx(h);u&&u.fh(this.nc.qf(b))&&(this.jdg(h,u),this.uj&&(this.uj.E4a(),this.uj.$mb(b,h)))}hlk(b,h){if(h)if(h.v_a&&0<h.v_a.length){let P=new Ea.a;for(var u of h.v_a)P.add(u);if(h.Lzf){u=Wi.FormattingReader.YRh(b);const aa=[];for(var y of u)y.formatting&&y.formatting.Vm&&aa.push(y.formatting.Vm);if(0<aa.length){y=by.APropertySet.jZh(aa);
u=new Ea.a;for(const ta of P)(!y.hasProperty(ta)||h.sAm&&ta===Yi.a.U6a)&&u.add(ta);P=u}}this.paragraphEditor.s0b(b,!0,P)}else this.paragraphEditor.s0b(b,!0);else Ab.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}QK(b,h,u,y=!1,P=!1,aa=!1,ta=null){if(be.ParagraphReader.ic(h))if(b)if(this.nc.$I(b.$h()))if(2!==this.nc.lx(b))w.ULS.shipAssertTag(593506381,324,!1);else{var Pa=this.nc.jx(h);if(Pa){var vb=this.nc.qf(b);if(!vb)w.ULS.shipAssertTag(593506377,
324,!1);else if(Pa.fh(vb)){var Kb=null,Sb=pe.a.instance.J(3)&&!y?h.hD():null;u||(ta&&ta.Vzk&&this.$b&&this.$b.isFeatureEnabled(101)?(this.hlk(h,ta),Fj.a.$l&&1==ta.v_a.length&&ta.v_a[0]==Yi.a.U6a?Kb=this.xn.DRi(Kb,h):this.Uyo(h,b,ta)):(Kb=this.xn.DRi(Kb,h),this.paragraphEditor.s0b(h,!0)));this.jdg(h,Pa);pe.a.instance.J(6)||(b=Pa.fh(this.nc.qf(b)));P&&Sb&&Sb.hasProperty(vi.a.paragraphStyle)&&Sb.removeProperty(vi.a.paragraphStyle);h.properties.setValue(vi.a.paragraphStyle,b.id);null!=yl.a.hh&&(!yl.a.hh.jO||
Fj.a.$l&&yl.a.hh.jO&&this.YTc.YB(h))&&this.$b&&this.$b.isFeatureEnabled(101)&&this.noj(h,b,ta);h.AJ=b;h.w4=null;for(u=0;u<h.qa.length;u++)h.qa.J(u).formatting&&h.qa.J(u).formatting.I7b();this.YTc.FAb(b)&&(Kb||(Kb=new yd.GraphIterator,Kb.set(h),Kb.zd(),og.OutlineElementNavigator.$d(Kb)),wj.ListReader.lj(Kb)||(h.Ng(Lc.a.fe,Lc.a.lM,Lc.a.iC,Lc.a.A_,Lc.a.GQa,Lc.a.yv),this.Yvd(Kb,b)));this.vj&&this.vj.isProgressiveStyleEnabled&&null!=this.LF&&this.LF.jhc(vb);y||!Sb||aa||this.Dj.FU(h,Sb,this.Kd.zg)}}else w.ULS.shipAssertTag(593506379,
324,!1)}else w.ULS.shipAssertTag(593506382,324,!1);else w.ULS.shipAssertTag(593506383,324,!1);else w.ULS.shipAssertTag(593506384,324,!1)}Uyo(b,h,u){const y=this.YTc.YB(b),P=this.YTc.FAb(h);if(y){if(null!=yl.a.hh&&yl.a.hh.jO)this.noj(b,h,u);else{u=u&&!u.Lzf&&u.v_a?u.v_a:null;var aa=this.YTc.dO(y);aa&&this.xn.Tyo(y,h,u,aa.Rt)}P||b.setValue(Lc.a.xga,!1)}else P&&b.setValue(Lc.a.xga,!0)}noj(b,h,u){const y=b.Jc;if(b=this.characterPropertiesEditor.VMa(b)){var P=null==b.Vm?new $A.a:b.Vm.clone();uk.a.Yzo(P,
h,u&&!u.Lzf&&u.v_a?u.v_a:null);P.Ana?h=y.UQ(P,!0):(y.av(P,null),h=P);b.Hj=h.id}else w.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}Yvd(){}$ae(b,h){if(h){w.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var u=this.nc.jx(h);u?(b=u.Qua(b))?this.nc.$I(b.$h())?this.QK(b,h,!1,void 0,void 0,void 0,null):w.ULS.shipAssertTag(593506368,324,this.nc.$I(b.$h())):w.ULS.shipAssertTag(593506369,324,!!b):w.ULS.shipAssertTag(593506370,324,
!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else w.ULS.shipAssertTag(593506372,324,!1)}t0e(b,h=!1,u=!1){const y=this.nc.jx(b).fh(pe.a.instance.J(6)?hl.StyleReader.wordStyleIdNormal:hl.StyleReader.styleIdNormal);this.QK(y,b,h,void 0,u)}jdg(b,h){(b=kz.mh.Wt(b))&&h.wgc(b,!1)}s1k(b){var h=null;if(this.$b&&this.$b.isFeatureEnabled(34)){if(!b||!b.count)return w.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=uk.a.Xv(),!h))return w.ULS.sendTraceTag(592221653,
3018,15,"Couldn't retreive PageContentNode."),!1;var u=this.Oca.VL(h);if(!u)return w.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var y=new Map;y.set("NumberOfStyles",b.count.toString());y.set("Source","DeleteStyleAPI");Ta.Health.instance.recordKpiUsage($k.a.Vie,0,$k.a.eD,y);y=0;const ta=(new Date).getTime();var P=null;let Pa=null,vb=null,Kb=null;const Sb=this.$b.isFeatureEnabled(33)&&!0;Sb&&(P=new ob.a,Pa=new ob.a,vb=new ob.a,Kb=new ob.a);for(var aa of b){if(!aa)return w.ULS.sendTraceTag(592221655,
3018,50,"Style ID is null."),!1;const Yb=u.fh(aa);if(!Yb||!this.nc.ee(Yb,u))return w.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Yb,!!Yb&&this.nc.ee(Yb,u)),!1;const Ac=this.nc.lx(Yb);if(2!==Ac&&1!==Ac)return w.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Ac),!1;const Sc=this.nc.NZ(Yb,u);let nd=0;if(Sc){if(!this.nc.ee(Sc,u))return w.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),
!1;nd=this.nc.lx(Sc);if(2!==nd&&1!==nd)return w.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Ac,nd),!1}else w.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Ad=this.pAb(Yb,u);if(!Ad)return!1;y++;Sb&&(1===Ac?(Pa.add(aa),Kb.add(Yb.id)):(P.add(aa),vb.add(Yb.id)));if(Sc){Ad=this.pAb(Sc,u);if(!Ad)return!1;y++;Sb&&(1===nd?(Pa.add(this.nc.qf(Sc)),Kb.add(Sc.id)):(P.add(this.nc.qf(Sc)),vb.add(Sc.id)))}}jv.a.UEb();
u=uk.a.Omf(u);aa=new dg.GraphTransaction(15);aa.Eb(h);Sb&&this.REn(P,Pa,vb,Kb,h);h.setValue(vi.a.cia,u);Ab.b(572302817,3018,50,String.format("Style Object Ids - {0}",u));aa.aae();aa.dispose();h=(new Date).getTime();P=new Map;P.set("Source","DeleteStyleAPI");P.set("NumberOfStyles",b.count.toString());P.set("TrueStyleCount",y.toString());P.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Ya.a,{extendedProperties:P,durationMs:h-ta});Ta.Health.instance.recordKpiSuccess($k.a.Vie,b);return!0}return!1}REn(b,
h,u,y,P){if(b&&b.count||h&&h.count)if(P){var aa=(new Date).getTime();if(P=this.XAl(P)){for(;P.moveNext();){if(!be.ParagraphReader.rh(P.iterator))continue;const ta=P.currentNode;this.BEn(ta,b,u);this.CEn(ta,h,y)}u=(new Date).getTime();w.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",u-aa));y=new Map;y.set("Source","DeleteStyleRemoveStylesReferences");y.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new Ya.a,{extendedProperties:y,durationMs:u-
aa});Ta.Health.instance.recordKpiSuccess($k.a.Vie,b)}}else Ab.b(577520338,3018,50,"PageContentNode not provided.");else Ab.b(577520337,3018,50,"No style IDs provided")}BEn(b,h,u){if(h&&h.count&&b){var y=b.mC;y&&y.hasProperty(vi.a.paragraphStyle)&&u.contains(y.getValue(vi.a.paragraphStyle))&&(y.removeProperty(vi.a.paragraphStyle),b.mC=y,b.hD()&&this.Dj.FU(b,b.hD(),this.Kd.zg));(u=this.nc.Xn(b))&&(u=this.nc.qf(u))&&h.contains(u)&&this.t0e(b,!0,!0)}}CEn(b,h,u){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let ta=
0;ta<b.qa.length;ta++){var y=b.qa.J(ta);if(y&&y.formatting&&(y=y.formatting)&&y.Nb){var P=Wi.FormattingReader.Kma(y);P&&(P=this.nc.qf(P))&&h.contains(P)&&this.Jn.k0e(y);if(P=y.Nb.yn){var aa=P.Vm;aa&&(aa=aa.clone(),aa.hasProperty(vi.a.Rv)&&u.contains(aa.getValue(vi.a.Rv))&&this.PCn(b,aa,P,y));pe.a.instance.J(3)&&(aa=ta===b.qa.length-1?b.characterData.length:b.qa.J(ta+1).cp,this.Dj.YLb(b,y.Nb,y.Nb.cp,aa,P,y,this.Kd.zg))}}}}PCn(b,h,u,y){b&&h&&u&&y&&(b=b.Jc)&&(h.removeProperty(vi.a.Rv),h.Ana?h=b.UQ(h,
!0):b.av(h,null),u.Hj=h.id,y.Nb.yn=u)}XAl(b){if(!b)return null;b=yd.GraphIterator.$a(b);return b.jo()?Le.a.Vr(b,b.origin):null}pAb(b,h){if(!b)return w.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var u=b.$h();return this.nc.$I(u)?h.QEn(b)?!0:(u=new Map,u.set("Source","DeleteStyle"),u.set("StyleType",jz[this.nc.lx(b)]),u.set("IsCustomStyle",this.nc.ee(b,h).toString()),u.set("IsLinkedStyle",(!!this.nc.NZ(b,h)).toString()),b=Object.assign(new Ya.a,{extendedProperties:u}),
Ta.Health.instance.recordKpiFailure($k.a.Vie,"UnableToDeleteStyle",!1,!0,b),w.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(w.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}PHb(b,h,u,y){var P,aa,ta;if(this.$b&&this.$b.isFeatureEnabled(81)){if(!b)return w.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!u&&(u=uk.a.Xv(),!u))return w.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),
!1;const vb=this.Oca.VL(u);if(!vb)return w.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=vb.fh(b);if(!b)return w.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Pa=this.nc.lx(b);if(2!==Pa&&1!==Pa)return w.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",Pa),!1;Ta.Health.instance.recordKpiUsage($k.a.vfg,0,$k.a.eD,new Map([["Source","ModifyStyleAPI"]]));Pa=Date.now();const Kb=new dg.GraphTransaction(15);
let Sb,Yb;try{Kb.Eb(u);if(!(y&&0!=y.length||h&&0!=h.count))return!1;if(y&&0!=y.length){if(null===(P=yl.a.hh)||void 0===P?0:P.wRc)Sb=uk.a.TKd(b);if(!vb.c2k(b,y))return this.Vva("ModifyStyleAPI",b,vb,Pa,"UnableToDeleteStyleProperties"),!1}if(h&&0!=h.count){const he=vb.WAo(b,h);if(null===(aa=yl.a.hh)||void 0===aa?0:aa.wRc)Yb=uk.a.TKd(b);if(!he)return this.Vva("ModifyStyleAPI",b,vb,Pa,"UnableToModifyStyle"),!1}(null===(ta=yl.a.hh)||void 0===ta?0:ta.wRc)&&this.uVm(b,u,Yb,Sb);jv.a.UEb();const Ac=uk.a.Omf(vb);
u.setValue(vi.a.cia,Ac);Ab.b(572302818,3018,50,String.format("Style Object Ids - {0}",Ac));const Sc=Date.now(),nd=new Map([["Source","ModifyStyleAPI"]]),Ad=Object.assign(new Ya.a,{extendedProperties:nd,durationMs:Sc-Pa});Ta.Health.instance.recordKpiSuccess($k.a.vfg,Ad);return!0}finally{Kb&&Kb.dispose()}}return!1}uVm(b,h,u,y){var P,aa;if(null!==b){var ta;y&&((ta=null===(P=this.xn)||void 0===P?void 0:P.Ihe(h,y,b,!0))||Ab.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));
u&&((ta=null===(aa=this.xn)||void 0===aa?void 0:aa.Ihe(h,u,b,!1))||Ab.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}Vva(b,h,u,y,P){const aa=Date.now();b=new Map([["Source",b],["StyleType",jz[this.nc.lx(h)]],["IsCustomStyle",this.nc.ee(h,u).toString()],["IsLinkedStyle",(!!this.nc.NZ(h,u)).toString()]]);y=Object.assign(new Ya.a,{extendedProperties:b,durationMs:aa-y});Ta.Health.instance.recordKpiFailure($k.a.vfg,P,!1,!0,y)}static get mh(){return xl.PageNavigator.instance}}
Object(m.a)(kz,"WACStyleEditor",null,[1120]);class hw extends kz{constructor(b,h,u){super(b,u);this.r5=h}get Yr(){return this.r5.value}Yvd(b,h){this.Yr.Yvd(b,h)}}Object(m.a)(hw,"WACStyleEditor",kz,[]);class Xw{m5a(b,h){b.properties.setValue(Lc.a.marginTop,h)}k5a(b,h){b.properties.setValue(Lc.a.marginBottom,h)}Pha(b,h){b.properties.setValue(Lc.a.marginLeft,h)}l5a(b,h){b.properties.setValue(Lc.a.marginRight,h)}T2f(b,h){b.properties.setValue(Lc.a.Ao,h)}S2f(b,h){b.properties.setValue(Lc.a.ew,h)}l6i(b,
h){b.properties.setValue(Lc.a.oqi,h)}VLb(b,h){b.properties.setValue(Yi.a.fE,h)}YVn(b,h){b.properties.setValue(Yi.a.hla,h)}dgc(b,h){b.properties.setValue(Yi.a.zF,h)}x1n(b,h){b.properties.setValue(Yi.a.separator,h)}}Object(m.a)(Xw,"WordSectionEditor",null,[366]);class sy{get name(){return"WordEditor.OutlineLevelEditors"}xc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new Xw).as("Box4.IWordSectionEditor").singleInstance();r.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new gw(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Om(dv.a.XNa,b.resolve("WordEditor.List.IFlatListReader"),b.af("Box4.IOutlineElementEditor"),b.af("WordEditor.IFlatListEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Om(dv.a.XNa,b.resolve("WordEditor.List.IFlatListReader"),
b.af("Box4.IOutlineElementEditor"),b.af("WordEditor.IFlatListEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new Jv).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new ZA.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),new uo.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",
()=>new hw(b.resolve("Box4.List.IListReader"),b.af("WordEditor.IFlatListEditor"),b.af("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){K.a.instance.Kc(new sy)}}Object(m.a)(sy,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var iw=c(1179),aB=c(575),ep=c(806),wu=c(340);class $q{constructor(b,h,u,y,P,aa){this.If=P;this._pageContent=u;this.aub=Array($q.Jga);this.pXb=Array($q.Jga);this.N6g=Array($q.Jga);this.vJe=Array($q.Jga);this.T2g=Array($q.Jga);
this.M1=y;this.zzc=aa;for(y=0;y<$q.Jga;y++){var ta=this.PZh(b,y,u,P);ta?(aa=ta.ia(Ge.a.l_,Nf.a.Cj),ta=ta.ia(Lc.a.d1c,Nf.a.Cj)):ta=aa=Nf.a.Cj;this.pXb[y]=aa!==Nf.a.Cj?aa:Nf.a.bGc;this.vJe[y]=ta===Nf.a.Cj?y-1:ta-1;$q.S7(h)&&(this.N6g[y]=Nf.a.Cj,this.T2g[y]=Nf.a.Cj);this.aub[y]=this.pXb[y]}}PZh(b,h,u,y){y.P2(u);return Rt.a.getInstance().dQc&&this.zzc?this.If.hkf(b,h,this.M1,u):this.If.h5b(b,h,u.Jc,u)}restart(b){this.aub[b]=this.pXb[b]}uAi(b){for(var h=0;h<b;h++)this.aub[h]===this.pXb[h]&&this.aub[h]++;
for(h=b+1;h<$q.Jga;h++)this.vJe[h]>=b&&this.restart(h);return this.aub[b]++}static S7(b){return!!b&&b.isFeatureEnabled(70)}}$q.Jga=9;Object(m.a)($q,"AWordList",null,[47]);class dA{constructor(b,h,u,y){this.H$a=new Oh.ScriptSharpLegacyMap;this.If=b;this.Fz=h;this.M1=u;this.zzc=y}Qu(b,h){this.H$a.ub(b)||this.H$a.Z(b,new $q(b,h,this.Fz,this.M1,this.If,this.zzc));return this.H$a.J(b)}HIf(b,h,u){return this.Qu(b,u).uAi(h)}}Object(m.a)(dA,"AListNumberingMap",null,[1302]);class ty extends $q{constructor(b,
h,u,y,P,aa){super(b,h,u,y,P,aa)}bNl(b,h,u,y){y.P2(u);return Rt.a.getInstance().dQc&&this.zzc?this.If.MIl(b,h,this.M1):this.If.LIl(b,h,this._pageContent.Jc)}hoj(b,h,u){var y=this.bNl(b,h,this._pageContent,this.If);y?(b=y.ia(Ge.a.l_,Nf.a.bGc),y=y.ia(Lc.a.d1c,Nf.a.Cj),this.aub[h]=this.N6g[h]=this.pXb[h]=b,y!==Nf.a.Cj&&(this.T2g[h]=this.vJe[h]=y-1)):u&&(y=this.PZh(b,h,this._pageContent,this.If),b=Nf.a.bGc,y&&(b=y.ia(Ge.a.l_,Nf.a.bGc)),this.aub[h]=this.pXb[h]=b)}}Object(m.a)(ty,"WordList",$q,[]);class lz extends dA{constructor(b){super(b.hd,
b.pageContentNode,b.oLb,b.nrj);this.m1g=new ob.a}oIl(b,h,u){let y;Rt.a.getInstance().CX?{value:y}=this.If.aJ.Gc(b,y):{value:y}=this.If.k_.Gc(b,y);this.H$a.ub(y)||this.H$a.Z(y,new ty(b,u,this.Fz,this.M1,this.If,this.zzc));if(!this.m1g.contains(b))for(this.m1g.add(b);h<Nf.a.Jga;h++)this.H$a.J(y).hoj(b,h,!1);else if(!h)for(h+=1;h<Nf.a.Jga;h++)this.H$a.J(y).hoj(b,h,!0);return this.H$a.J(y)}HIf(b,h,u){return $q.S7(u)?this.oIl(b,h,u).uAi(h):super.HIf(b,h,u)}}Object(m.a)(lz,"ListNumberingMap",dA,[]);class nv{constructor(){this.XEa=
0;this.Wsj=!1}}Object(m.a)(nv,"LastNumber",null,[]);var xj=c(829),Ax=c(724),Yw=c(883);class Ml{constructor(){this.startAt=this.N_=0}}Object(m.a)(Ml,"WordListRestartInfo",null,[]);class Tn{constructor(b,h,u,y){this.x_d=!1;this.Yr=b;this.xki=u;this.R7b=y;this.Mw=this.Yr.NA(h);this.outlineElement=new yd.GraphIterator;this.outlineElement.ed(h)}static get hd(){return Tn.If||(Tn.If=Ja.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){Tn.If=b}static get hh(){return Rt.a.getInstance()}static Qil(b,
h,u,y=!1,P=!1){var aa=h.currentNode;let ta=null;new yd.GraphIterator;let Pa=!1,vb=!1;h=h.eTa();const Kb=Le.a.Dp(h);Kb.moveNext();for(h=Kb.iterator;h.currentNode!==aa;){let Yb=vb=Pa=!1;var Sb=Tn.G8k(h);if(wg.OutlineElementReader.Oh(h)&&!Sb){Sb=!1;if(h.Lq(4))if(Tn.KBi(h,u,!0,y,P))if(wj.ListReader.HZ){if(Yb=!0,ta=new Tn(b,h,!1,!1),Kb.moveNext(),Kb.iterator===aa&&(Pa=!0),y)break}else ta=new Tn(b,h,!1,!1),Pa=!0;else wg.OutlineElementReader.isEmpty(h,!1)||(Sb=!0),vb=!0;else!wg.OutlineElementReader.isEmpty(h,
!1)&&h.bhb(12)&&(wg.OutlineElementReader.GP(h)||(Sb=!0));!y&&Sb&&ta&&(u.propertySet.hasProperty(Lc.a.listLevel)?ta.Mw.level=0:ta=null)}Yb||Kb.moveNext();h=Kb.iterator}ta&&(ta.R7b=Pa);if(!ta&&h.yf(1))for(aa=!0;h.currentNode;){if(wg.OutlineElementReader.Oh(h)){if(h.Lq(4)&&Tn.KBi(h,u,!1,y,P)){ta=new Tn(b,h,!0,aa);break}if(!wg.OutlineElementReader.isEmpty(h,!1))break}if(!h.yf(1))break;aa=!1}ta&&(ta.x_d=vb);return ta}static G8k(b){var h=b.Rb(2);if(!h)return!1;h=be.ParagraphReader.rh(b)&&Tn.otm(h);b.qc();
return h}static otm(b){return En.a(b,8)}static KBi(b,h,u,y=!1,P=!1){Tn.hd.fG(b);var aa=b.currentNode;b.qc();const ta=Tn.hd.dO(aa);(b=h.Rt===ta.Rt)&&h.listStyle&&1!==h.Gr&&(b=h.listStyle===ta.listStyle);Tn.hd.Ir&&b&&(h.Ena&&1!==h.Gr||h.e4b||P)&&(b=Tn.srm(h,ta),h.Rt||(b=b&&h.font===ta.font));if(1===h.Gr)if(1===ta.Gr&&ta.propertySet.hasProperty(zi.a.Ejb))b=h.H4===ta.H4;else return!1;b&&h.Rt&&h.gB!==Nf.a.Cj&&(b=ta.hs,u&&(y&&1===h.gB&&1===b||b++),b=h.gB===b);b&&(y||h.e4b)&&(h=h.propertySet.ia(Lc.a.listID,
0),aa=aa.ia(Lc.a.listID,0),0<h&&0<aa&&(b=h===aa));return b}static srm(b,h){h=h.sBf;b.Ena&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.sBf.toLocaleLowerCase()}static Ril(b,h,u){var y=h.currentNode;let P=null;const aa=new yd.GraphIterator,ta=b.tT(y,u);var Pa=!1;let vb=!1;aa.ed(h);aa.qc();for(aa.Rb(1);aa.currentNode!==y;)vb=Pa=!1,wg.OutlineElementReader.Oh(aa)&&aa.Lq(4)&&(h=b.NA(aa),Tn.LBi(h,u,!0)?(P=new Tn(b,aa,!1,!1),Pa=!0):(vb=!0,h.listID===u.listID&&h.level<=ta.N_&&(P=null))),
aa.yf(1);P&&(P.R7b=Pa);if(!P&&aa.yf(1))for(y=!0;aa.currentNode;){if(wg.OutlineElementReader.Oh(aa)&&aa.Lq(4)){Pa=b.NA(aa);if(Pa.listID===u.listID&&Pa.level<=ta.N_)break;if(Tn.LBi(Pa,u,!1)){P=new Tn(b,aa,!0,y);break}}if(!aa.yf(1))break;y=!1}P&&(P.x_d=vb);return P}static LBi(b,h,u){let y=b.listID===h.listID&&b.level===h.level;y&&h.hs!==Nf.a.Cj&&(b=b.hs,u&&b++,y=h.hs===b);return y}}Tn.If=null;Object(m.a)(Tn,"JoinTargetInfo",null,[]);class Um{constructor(b,h){this.Mw=null;this.action=b;h&&(this.Mw=h)}static mbc(){return new Um(0)}static fEm(){return new Um(1)}static zDm(b){return new Um(3,
b)}static NDm(b){return new Um(2,b)}static BDm(b){return new Um(4,b)}}Object(m.a)(Um,"ApplyListInfoResult",null,[]);class Bx{constructor(b,h,u){this.Khc=u;this.tbn=h;this.y9=u-h.hs;this.vXc=h.listID}get delta(){-1!==this.y9&&(this.y9=this.Khc-this.tbn.hs);return this.y9}set delta(b){this.y9=b}}Object(m.a)(Bx,"ListTransferInfo",null,[]);class Po extends yl.a{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb){super(b,u,vb);this.r6g=!1;this.joc=this.qcd=this.RRb=null;this.Qce=(Ac,Sc)=>Sc.listID===Ac.listID&&
Sc.level===Ac.level;this.nbo=(Ac,Sc,nd)=>Sc.listID!==Ac.listID&&Sc.listID!==nd.vXc||Sc.level!==Ac.level?!1:!0;this.cEf=(Ac,Sc,nd)=>Sc.listID===Ac.listID||nd&&Sc.listID===nd.vXc?!0:!1;this.kcj=(Ac,Sc,nd,Ad)=>{const he=Ac.ia(yl.a.hh.NO,-1);this.jcj(Ac,he+Sc,nd,Ad)};this.jcj=(Ac,Sc,nd,Ad)=>{Ac.setValue(Lc.a.listID,nd);Sc=this.gDa(Ac);Ac=yd.GraphIterator.$a(Ac);Ac.zd();Ac.qc();this.kef(Ac,Sc,this.cEf,this.j8f,Ad)};this.obo=(Ac,Sc,nd,Ad)=>{Sc=this.Uo.Z_a(Ac);const {Mw:he,iterator:ce}=this.VGc(Sc,()=>{Ac.setValue(Lc.a.listID,
nd);const Nd=this.gDa(Ac),re=yd.GraphIterator.$a(Ac);re.zd();re.qc();return{Mw:Nd,iterator:re}});this.RHd(ce,he,this.Bfj,this.Vde,Ad)};this.fho=(Ac,Sc,nd,Ad,he)=>{this.kRi(Ac,Sc,nd,Ad,he)};this.Vde=(Ac,Sc,nd,Ad)=>{nd.listID=Sc.listID;Ad.Rb(4);Ac=this.Uo.Z_a(Ad.currentNode);this.VGc(Ac,()=>{this.pBc(Ad.currentNode,nd);Ad.qc()})};this.j8f=(Ac,Sc,nd,Ad)=>{wj.ListReader.lj(Ad)&&(Ac=new yd.GraphIterator,Ac.ed(Ad),Ac.zd(),this.hd.fG(Ac),this.Efi(Ad.currentNode,Ac.currentNode))};this.gho=(Ac,Sc,nd,Ad,he)=>
{nd.listID=Sc.listID;this.kRi(Ac,Sc,nd,Ad,he);this.Vde(Ac,Sc,nd,Ad,he)};this.Afj=(Ac,Sc)=>Sc.listID===Ac.listID;this.eho=(Ac,Sc)=>Sc.level<=Ac.level;this.Bfj=(Ac,Sc,nd)=>Sc.listID===nd.vXc;this.so=P;this.RH=b;this.ugd=h;this.Ic=y;this.QPf={};this.rCe=aa;this.Ud=ta;this.Eo=Pa;this.Wc=Kb;this.Kz=Sb;this.sL=Yb}get S7(){return this.RH.hga}get eNb(){return this.r6g}set eNb(b){this.r6g=b}get Uo(){return this.RH}get zca(){return this.sL}get nc(){return this.Kz}get Ut(){return this.Uo.Ut}get pq(){return this.Uo.pq}get xsa(){return this.Uo.xsa}get Ir(){return this.hd.Ir}get N7(){return this.Uo.N7}set N7(b){this.Uo.N7=
b}get APa(){return this.Uo.APa}set APa(b){this.Uo.APa=b}get j4c(){return null!=this.cwg?this.cwg:this.cwg=Ja.a.instance.Pa("Box4.List.ISingleLevelListEditor")}yhk(b,h,u,y){w.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const P=u.ia(ld.a.hSd,!1);let aa=!1,ta=-1;!P||h.listStyle&&1!==h.Gr||(aa=!u.ia(ld.a.xzf,!1),ta=u.ia(ld.a.rBf,-1));b=this.oBc(b,h,{Kci:aa,cDm:ta,Hnl:y,propertySet:u});P||u.setValue(ld.a.xzf,2===b.action);3===b.action&&!u.hasProperty(ld.a.rBf)&&b.Mw&&
u.setValue(ld.a.rBf,b.Mw.level)}merge(b,h,u,y=null){const P=wj.ListReader.lj(b)||wj.ListReader.lj(h);b=super.merge(b,h,u,y);P&&this.Rpa();return b}DOi(b,h){this.oBk(b,h)}oBk(b,h){b=this.hd.bkf(b);const u=this.hd.bkf(h);-1!==b&&-1!==u&&(b-=u,0<b?this.ugd.value.kGc(h,b):0>b&&this.ugd.value.SQa(h,b,0))}rVi(b){this.hd.fG(b);this.leaveList(b);b.Jg();pe.a.instance.J(3)&&this.Rpa()}Uoo(b,h,u,y){var P=yd.GraphIterator.$a(u);P=this.NA(P);this.Voo(P,b,h,u,y);Ra.App.Bjb&&!yl.a.hh.jO&&this.Woo(u,y)}NA(b){this.hd.fG(b);
const h=this.gDa(b.currentNode);b.qc();return h}e_n(b,h){this.hd.fG(b);b.currentNode.setValue(Lc.a.listID,h);h=this.gDa(b.currentNode);b.qc();return h}gDa(b){const h=new ep.a;if(pe.a.instance.J(3)){var u=this.hd.cO(b,!1,!0);h.listID=u.listId;h.level=u.listLevel}else h.listID=b.ia(Lc.a.listID,0),h.level=b.ia(Lc.a.listLevel,-1);h.xga=b.ia(Lc.a.xga,!1);this.Ir&&(u=this.YKd(b),h.PXn(u));h.hs=b.ia(yl.a.hh.NO,Nf.a.Cj);h.bHc=b.ia(yl.a.hh.Qca,Nf.a.Cj);return h}pBc(b,h){b||ri.a.instance.fc("CrashWhenApplyingList",
{["Reason"]:"ListNodeIsNull"});h||ri.a.instance.fc("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});b.setValue(Lc.a.listID,h.listID);b.setValue(Lc.a.listLevel,h.level);h.xga&&b.setValue(Lc.a.xga,!0)}kpj(b){this.Uo.P2(b);b=Po.mh.Wt(b);let h=b.ia(Lc.a.pq,null);h=h?Array.clone(h):[];b.setValue(Lc.a.pq,h);this.Uo.K7b()}qfj(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}uIl(b){b=b.view;if(!b.Bb||!b.Bb.hb)return null;b=
Ct.OutlineElementGeneralizer.ima(b.Bb.hb,!1);if(1!==b.length)return null;b=yd.GraphIterator.$a(b.getContext(0).node);if(!wj.ListReader.lj(b))if(14===b.Vd().type){const h=this.Uo.w0l(b.currentNode);h&&b.set(h)}else Ab.b(589177753,393,15,"Encountered an OE of non list type."),b.qc();b.zd();return b}aVk(b,h,u,y){const P=b.BI(),aa=new ep.a;aa.listID=this.sAh(b);this.S7?(aa.tWd=yl.a.hh.CX?this.tAh(b):this.kAh(b),this.gSi(b,aa.listID,aa.tWd)):this.iSi(b,aa.listID);aa.r6i(h.propertySet,this.GTc(u));this.dFd(b);
u=this.TZh(b,h);for(let Pa=0;9>Pa;Pa++){const vb=new at.a;P.Bd.av(vb);this.hSi(b,this.S7?T.a.nil:vb.id,this.S7?vb.id:T.a.nil);this.F$j(vb,h.Rt,Pa);this.tdh(vb,u,Pa);var ta=y.$Gb[Pa];ta=6===ta?Sr.a.KP(1,1):Sr.a.KP(0,ta);ta.wga&&vb.setValue(Ge.a.L3,ta.wga);h.gB!==Nf.a.Cj&&Pa===aa.level&&vb.setValue(Ge.a.l_,h.gB);y.RCa&&y.RCa[Pa]&&vb.setValue(Ge.a.font,y.RCa[Pa]);ta=y.ITc[Pa];w.ULS.shipAssertTag(22127636,338,!!ta);vb.setValue(Lc.a.Vt,ta);vb.setValue(Lc.a.lba,y.KVd[Pa]);wu.a.pbe(y.H4,vb)}return aa}$Uk(b,
h,u){const y=b.BI(),P=new ep.a;P.listID=this.sAh(b);this.S7?(P.tWd=yl.a.hh.CX?this.tAh(b):this.kAh(b),this.gSi(b,P.listID,P.tWd)):this.iSi(b,P.listID);P.r6i(h.propertySet,this.GTc(u));if(!h.listStyle)switch(P.level%3){case 0:h.F8(h.listType,1);break;case 1:h.F8(h.listType,2);break;case 2:h.F8(h.listType,3)}this.dFd(b);u=this.TZh(b,h);for(let aa=0;9>aa;aa++){const ta=new at.a;y.Bd.av(ta);this.hSi(b,this.S7?T.a.nil:ta.id,this.S7?ta.id:T.a.nil);this.E$j(ta,h.Rt,aa);this.tdh(ta,u,aa);this.Ir&&(2===aa%
3&&h.Rt?ta.setValue(Lc.a.lba,"right"):ta.setValue(Lc.a.lba,"left"));aa===P.level&&(h.wga&&ta.setValue(Ge.a.L3,h.wga),h.gB!==Nf.a.Cj&&ta.setValue(Ge.a.l_,h.gB),this.Ir&&(h.Rt?this.w6i(h,ta,aa):(Po.t6i(h,ta),Po.v6i(h,ta)),Po.u6i(h,ta)),h.e4b&&ta.oI(h.propertySet,Lc.a.listID,Lc.a.listLevel))}return P}w6i(b,h,u){b.Ena?(b=b.levelText,b=A.a.replaceAll(b,"%1","%"+(u+1))):b=b.RPc||b.Qma?b.levelText:"%"+(u+1)+".";w.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Lc.a.Vt,b)}paj(b,h,u,y){if(b.RPc)return!1;if(1===
b.Gr)return y;if(y)return!0;if(h){y=b.listType===h.listType;const P=!b.listStyle&&b.gB===Nf.a.Cj;let aa=b.listStyle===h.listStyle&&b.gB===h.gB;this.Ir&&(b=(!b.Ena||this.L_f(h,b))&&!u,aa=aa&&b);return y&&(P||aa)}return!1}dFd(b){this.RRb||(this.RRb=b.ia(Lc.a.Y_k,null));this.qcd||(this.qcd=b.ia(Lc.a.X_k,null));this.joc||(this.joc=b.ia(Lc.a.Z_k,null))}GTc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}jGl(b){return b?this.so.oT(b).yt-this.so.QF(b).yt:-1}iSi(b,h){const u=b.ia(Lc.a.Ut,
null),y=u?u.length:0,P=Array(y+1);let aa=0;for(;aa<y;aa++)P[aa]=u[aa];P[aa]=h;b.setValue(Lc.a.Ut,P);this.Uo.K7b()}gSi(b,h,u){this.ISe(Lc.a.Ut,b,h);if(yl.a.hh.CX){this.ISe(Yi.a.p3a,b,u);var y=this.Uo.VKd(b);y.add(h,u);b.setValue(Yi.a.aJ,Ax.b(iw.a.Sic(y)))}else this.ISe(Lc.a.xsa,b,u),y=this.Uo.UKd(b),y.add(h,u),b.setValue(Lc.a.k_,Ax.b(iw.a.Sic(y)))}hSi(b,h,u){this.S7?(this.jdh(Lc.a.pq,b,u),this.jdh(Lc.a.f8,b,h)):(u=(u=b.ia(Lc.a.pq,null))?Array.clone(u):[],u.push(h),b.setValue(Lc.a.pq,u),this.Uo.K7b())}ISe(b,
h,u){const y=h.ia(b,null),P=y?y.length:0,aa=Array(P+1);let ta=0;for(;ta<P;ta++)aa[ta]=y[ta];aa[ta]=u;h.setValue(b,aa)}jdh(b,h,u){let y=h.ia(b,null);y=y?Array.clone(y):[];y.push(u);h.setValue(b,y)}E$j(b,h,u){var y=u%3+1;const P=h?this.joc:this.qcd;P&&u<P.length?b.setValue(Lc.a.tt,P[u]):b.setValue(Lc.a.tt,360);y=wj.ListReader.HZ?Sr.a.KP(h?0:1,this.qfj(y),null,0,u):Sr.a.KP(h?0:1,this.qfj(y));b.Hs(y.propertySet);b.setValue(Lc.a.eXe,h?-1:-2);this.Ir&&(h?b.setValue(Lc.a.Vt,"%"+(u+1)+"."):(b.setValue(Ge.a.font,
this.cAl(u)),b.setValue(Lc.a.Vt,String.fromCharCode(this.Szl(u)))),wu.a.lgc(2,b))}F$j(b,h,u){const y=h?this.joc:this.qcd;y&&u<y.length?b.setValue(Lc.a.tt,y[u]):b.setValue(Lc.a.tt,360);b.setValue(Lc.a.eXe,h?-1:-2);wu.a.lgc(1,b)}Szl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}cAl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}sAh(b){if(this.S7)this.N7<Nf.a.VTc&&this.Uo.P2(b),this.N7=
this.Q_h(this.Ut,this.N7,Nf.a.VTc);else{if(this.N7<Nf.a.VTc&&(this.Uo.P2(b),this.Ut&&this.pq)){b=this.Ut.length;for(let h=0;h<b;h++)this.Ut[h]>=this.N7&&(this.N7=this.Ut[h])}this.N7+=1}return this.N7}kAh(b){this.APa<Nf.a.Jtd&&this.Uo.P2(b);return this.APa=this.Q_h(this.xsa,this.APa,Nf.a.Jtd)}tAh(b){var h;this.Uo.P2(b);do b=Math.floor(Math.random()*(Po.kSm-Po.oyi))+Po.oyi;while(null===(h=this.Uo.hIb)||void 0===h?0:h.includes(b));return b}Q_h(b,h,u){if(h<u&&b){u=b.length;for(let y=0;y<u;y++)b[y]>h&&
(h=b[y])}h++;return h}LHn(b,h,u,y=!1){this.VPh(b,h,u,this.Qce,this.kcj,null,y)}KHn(b,h,u){this.ynl(b,h,u,this.Qce,this.jcj)}uYf(b,h,u){if(!Po.Wmi){var y=ri.a.instance.Xo(Oa.a.uYf);1>Math.abs(u)&&ri.a.instance.fc("PossiblyIncorrectListPromoteDemote",{["Reason"]:"DepthIsIncorrect"});(h<Cp.a.qdf||h>Cp.a.bWd)&&ri.a.instance.fc("PossiblyIncorrectListPromoteDemote",{["Reason"]:"LevelHasInvalidRange"});(h+u<Cp.a.qdf||h+u>Cp.a.bWd)&&ri.a.instance.fc("PossiblyIncorrectListPromoteDemote",{["Reason"]:"Level+DepthHasInvalidRange"});
var P={},aa=null,ta=this.NA(b),Pa=b.currentNode,vb=ta.listID,Kb=h+u,Sb=Nf.a.Cj,Yb=!0,Ac=!0,Sc=!1,nd=Array(9),Ad=!1,he=!1,ce=new ep.a;ce.listID=ta.listID;ce.level=ta.level+u;ce=this.Uo.Iua(b.currentNode,ce);var Nd=this.hd.Qu(b);ce=ce.Rt;Nd=Nd.Rt;var re=this.Ir&&(ce||Nd);if(Nd||ce){var Xd=new ep.a;Xd.listID=ta.listID;Xd.level=h;P[h.toString()]=this.tT(Pa,Xd);var vg=P[h.toString()].N_;Xd.level=Kb;P[Kb.toString()]=this.tT(Pa,Xd);var Vf=P[Kb.toString()].N_;for(var kj=0;9>kj;kj++)nd[kj]=!1;kj=new yd.GraphIterator;
kj.ed(b);Xd=kj.eTa();var zm=Le.a.Vr(kj,Xd);for(zm.moveNext();zm.moveNext();){kj=zm.iterator;var rm=void 0;if(!kj.Lq(4))continue;Xd=this.NA(kj);if(Xd.listID!==vb)continue;var os=this.hd.Qu(kj);var Us=os.Rt;Xd.level<=vg&&(Yb=!1);Xd.level<=Vf&&(Ac=!1);if(!Yb&&!Ac)break;const Bu=Xd.level.toString();P[Bu]||(P[Bu]=this.tT(Pa,Xd));os=P[Bu];this.cKo(os,nd)||(os.N_>=h?(aa||(aa=this.Y1e(ta,b,P)),rm=Nf.a.Cj,aa[Bu]?rm=!this.Ir||Us?aa[Bu]+1:Nf.a.Cj:Xd.level===Kb&&(rm=!this.Ir||Us?os.startAt:Nf.a.Cj),rm!==Nf.a.Cj?
(Xd.level!==Kb||Sc||(Sb=rm,Sc=!0,this.hd.fG(kj),kj.qc(),rm++),this.Nyb(kj,rm),aa[Bu]=rm):re&&this.ncg(kj,Xd)):os.N_>=Kb?(aa||(aa=this.Y1e(ta,b,P)),rm=nd[Xd.level]?!this.Ir||Us?aa[Bu]+1:Nf.a.Cj:!this.Ir||Us?os.startAt:Nf.a.Cj,this.Ir&&rm===Nf.a.Cj?re&&this.ncg(kj,Xd):this.Nyb(kj,rm),aa[Bu]=rm):Xd.level===h&&Nd||Xd.level===Kb&&ce?(this.hd.fG(kj),rm=kj.currentNode,kj.qc(),rm=rm.getValue(yl.a.hh.NO),Us=rm===(os.startAt===Nf.a.Cj?1:os.startAt)+1,Xd.level===h?!(0>u)&&Us||Ad?Ad=!0:rm--:(he?rm--:0>u&&Us&&
this.$vf(kj,os,null)&&(rm--,he=!0),Sc||(Sb=rm,Sc=!0),rm++),this.Nyb(kj,rm)):Xd.level!==h&&Xd.level!==Kb||!re||this.ncg(kj,Xd),nd[Xd.level]=!0)}ce&&!Sc&&(h=P[Kb.toString()],ta.level=Kb,Sb=this.ZVd(ta,b,h).XEa,Sb===Nf.a.Cj?Sb=h.startAt:Sb++);ce&&this.Nyb(b,Sb)}y.end()}}Cpk(){this.Rpa()}Rpa(){var b=null,h,u;if(pe.a.instance.J(3)){var y=new yd.GraphIterator;if(b)if(8===b.type)y.set(b);else{w.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else y.set(Ra.App.xa.jb.Yc),
Po.mh.ebg(y),b=Po.mh.Wt(y.currentNode);if(y.Ab(7)||y.kd(7)){y=Le.a.Vr(y,y.origin);var P=new lz({hd:this.Uo,pageContentNode:b,oLb:null,nrj:!1});for(b=new lz({hd:this.Uo,pageContentNode:b,oLb:null,nrj:!1});y.moveNext();){var aa=y.iterator;if(!aa.Lq(4)&&!aa.Lq(31))continue;this.hd.VHb(aa);const Pa=aa.currentNode;aa.qc();if(!Pa){w.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",aa.isValid);continue}if(!this.S7&&63!==Pa.type&&this.hd.dO(Pa).listType)continue;
var ta=this.hd.cO(Pa,!1,!1);if(this.S7&&ta&&this.hd.ATd(ta.listId)){w.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ta.listId);continue}const vb=Object(na.a)(ro.AParagraphNode,og.OutlineElementNavigator.Ee(aa,!0));vb&&(vb.qa?(null==vb.qa.last&&w.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),aa.qc(),this.S7&&this.Uo.P2(aa.currentNode),12===vb.type&&(vb.Zi&&vb.mC.hasProperty(Lc.a.listID)||null===(h=vb.qa.last)||
void 0===h||!h.aj)&&((aa=this.hd.cO(Pa,!0,!0))?this.x6i(Pa,b,yl.a.hh.Wkc,aa):w.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Pa.type)),!ta||null!==(u=vb.qa.last)&&void 0!==u&&u.gi||!this.x6i(Pa,P,yl.a.hh.NO,ta)||(ta=Pa.getValue(yl.a.hh.NO),this.S7&&this.hd.dO(Pa).listType||Pa.setValue(yl.a.hh.Qca,ta))):w.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else w.ULS.shipAssertTag(593234060,376,7===y.ef,
"Couldnt reach to page manifest node")}}x6i(b,h,u,y){u||w.ULS.shipAssertTag(571757918,393,!!u,"Prop definition is null");h=h.HIf(y.listId,y.listLevel,this.Wc);y=-1;b.hasProperty(u)&&(y=b.getValue(u));return h===y||this.S7&&63!==b.type&&this.hd.dO(b).listType&&(u!==yl.a.hh.Wkc||1!==this.hd.dO(b).listType)?!1:(b.setValue(u,h),!0)}ncg(b,h){this.hd.fG(b);const u=b.currentNode;b.qc();u&&this.hd.Xaa(u)&&this.kef(b,h,this.cEf,this.j8f)}$vf(b,h,u){let y=!1,P=!0,aa=0;const ta=this.NA(b),Pa=b.currentNode;let vb=
null;b=b.eTa();b=Le.a.Dp(b);for(b.ho(Yw.a.V$b,null);b.moveNext();){const Kb=b.iterator.currentNode;if(Kb===Pa)break;if(!wj.ListReader.E7(Kb))continue;const Sb=this.NA(b.iterator);Sb.listID===ta.listID&&(Sb.level>ta.level?(y=!0,vb=Kb,aa++):Sb.level===ta.level?(P=!1,vb=null,aa=0):Sb.level<=h.N_&&(P=!0,vb=null,aa=0))}return y&&P&&(!u||1===aa&&vb===u)}cKo(b,h){for(b=b.N_;0<=b;b--)if(h[b])return!0;return!1}Nyb(b,h){this.hd.fG(b);const u=b.currentNode;b.qc();const y=this.NA(b);y&&this.Uo.T$b(u,y.listID,
y.level)&&this.KHn(b.currentNode,y,h)}MHn(b,h,u){const y={};let P=null;const aa=new yd.GraphIterator;const ta=b.hs===h.startAt;let Pa=!1;var vb=new yd.GraphIterator;vb.ed(u);var Kb=u.eTa();Kb=Le.a.Vr(vb,Kb);Kb.ho(Yw.a.V$b,null);Kb.moveNext();let Sb=!1;for(;Kb.moveNext();)if(aa.ed(Kb.iterator),aa.Lq(4)){var Yb=this.NA(aa);if(Yb.listID===b.listID)if(Yb.level>b.level)Pa=!0,vb=Yb.level.toString(),y[vb]||(y[vb]=this.tT(u.currentNode,Yb)),Yb=y[vb].N_,Yb===b.level&&(P||(P=this.Y1e(b,u,y)),P[vb]&&(Yb=P[vb]+
1,this.Nyb(aa,Yb),P[vb]=Yb));else if(Yb.level===b.level||Yb.level<=h.N_){Sb=!0;break}}return!Sb||ta&&Pa?null:aa}get S$i(){return this.Ir}WZh(b){const h=this.hd.Qu(b);if(this.Ir){h.e4b=!0;this.hd.fG(b);const u=b.currentNode.ia(Lc.a.listID,0);h.propertySet.setValue(Lc.a.listID,u);b.kd(11)}return h}Y1e(b,h,u){const y={},P=new yd.GraphIterator,aa=h.currentNode;var ta=h.eTa();const Pa=Le.a.Dp(ta);for(Pa.ho(Yw.a.V$b,null);Pa.moveNext();){P.ed(Pa.iterator);if(P.currentNode===aa)break;if(P.Lq(4)&&(ta=this.NA(P),
ta.listID===b.listID)){if(ta.level>b.level){this.hd.fG(P);var vb=P.currentNode;P.qc();y[ta.level.toString()]=vb.ia(yl.a.hh.NO,Nf.a.Cj)}for(vb=ta.level;vb<=Cp.a.bWd;vb++){const Kb=vb.toString();y[Kb]&&(u[Kb]||(u[Kb]=this.tT(h.currentNode,ta)),u[Kb].N_>=ta.level&&delete y[Kb])}}}return y}ZVd(b,h,u){const y=new yd.GraphIterator,P=h.currentNode;let aa;var ta=Nf.a.Cj;let Pa=!1,vb=!1,Kb=!1,Sb=null;var Yb=h.eTa();Yb=Le.a.Dp(Yb);for(Yb.ho(Yw.a.V$b,null);Yb.moveNext();){y.ed(Yb.iterator);if(y.currentNode===
P)break;Pa=!1;y.Lq(4)&&(aa=this.NA(y),aa.listID===b.listID&&(aa.level===b.level?(this.hd.fG(y),ta=y.currentNode,y.qc(),ta=ta.ia(yl.a.hh.NO,Nf.a.Cj),Pa=!0,Sb=y.Vjc(1),vb=!0):aa.level>b.level?Kb=!0:aa.level<=u.N_&&(ta=Nf.a.Cj,Kb=vb=!1)))}!vb&&Kb&&(ta=u.startAt);Pa&&(Pa=h.Vjc(1)===Sb);b=new nv;b.XEa=ta;b.Wsj=Pa;return b}GHn(b,h){const u=this.gDa(b),y=this.tT(b,u),P=this.Uo.Iua(b,u);var aa=new yd.GraphIterator;const ta=P.Rt;let Pa=y.startAt,vb=!1,Kb=!1;w.ULS.shipAssertTag(22127639,338,P.Qma,"Info does not have a level Text.");
aa.set(b);if(aa.zd()&&(b=aa.I4a()))for(b=Le.a.Dp(b),b.ho(Yw.a.V$b,u);b.moveNext();){aa=b.iterator.currentNode;if(!wj.ListReader.E7(aa))continue;var Sb=this.NA(b.iterator);Sb.listID===h&&(Sb=this.e_n(b.iterator,u.listID));if(Sb.listID!==u.listID)continue;const Yb=b.iterator.Rb(4);Yb&&b.iterator.qc();Sb.level>u.level?(this.Uo.T$b(Yb,u.listID,Sb.level)&&this.Efi(aa,Yb),Kb=!0):(Sb.level<=y.N_?(Pa=y.startAt,Kb=vb=!1):(Sb=b.iterator,this.hd.fG(Sb),!yl.a.hh.WT&&this.Ir&&Sb.currentNode.setValue(Lc.a.Vt,P.sBf),
{vRn:vb,XEa:Pa}=this.JHn(ta,Kb,vb,Sb,Pa,aa)),Po.gim(b))}}Efi(b,h){w.ULS.shipAssertTag(22819227,338,!!b&&!!h);h.setValue(Jc.a.csi,T.a.create().toString())}JHn(b,h,u,y,P,aa){b?(h&&!u&&P++,og.OutlineElementNavigator.$d(y),this.Nyb(y,P),P++,u=!0,y.Rb(2),xj.a.NTd(y.currentNode)&&y.currentNode.Ck(4,!0)):(y.currentNode.removeProperty(yl.a.hh.NO),og.OutlineElementNavigator.$d(y));aa.Ck(4,!0);(b=y.ko(16))&&b.Ck(8,!0);return{vRn:u,XEa:P}}tT(b,h){const u=ri.a.instance.Xo(Oa.a.tT),y=new Ml;(b=this.Uo.hx(b,h.listID,
h.level))?(y.N_=b.ia(Lc.a.d1c,h.level-1),y.startAt=b.ia(Ge.a.l_,1)):ri.a.instance.fc("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});u.end();return y}ZWk(b){const h=Av.a.instance.createInstance(1074135151);b.Qf(h,31)}Voo(b,h,u,y,P){const aa=this.createList(h);this.pBc(aa,b);h=this.Uo.Iua(h.currentNode,b);h.listType||(aa.setValue(yl.a.hh.NO,b.hs),aa.setValue(yl.a.hh.Qca,b.bHc),this.B8d(aa,b,u?y:P,1));switch(h.listType){case 0:u="Numbering";break;case 1:u="Bullet";break;default:u=
"Invalid List Type"}r.AFrameworkApplication.ya.processAction(Oa.a.joinList,2);w.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",u);wj.ListReader.HZ&&(aa.setValue(Lc.a.listID,b.listID),aa.setValue(Lc.a.listLevel,b.level))}Woo(b,h){b=yd.GraphIterator.$a(b).Rb(4);h=yd.GraphIterator.$a(h).Rb(4);b.hasProperty(Ge.a.fontColor)&&h.setValue(Ge.a.fontColor,b.getValue(Ge.a.fontColor));b.hasProperty(Ge.a.fontSize)&&h.setValue(Ge.a.fontSize,b.getValue(Ge.a.fontSize));b.hasProperty(Ge.a.font)&&
h.setValue(Ge.a.font,b.getValue(Ge.a.font));b.hasProperty(Lc.a.ve)&&h.setValue(Lc.a.ve,b.getValue(Lc.a.ve));b.hasProperty(Ge.a.bold)&&h.setValue(Ge.a.bold,b.getValue(Ge.a.bold));b.hasProperty(Ge.a.italic)&&h.setValue(Ge.a.italic,b.getValue(Ge.a.italic));b.hasProperty(Ge.a.superscript)&&h.setValue(Ge.a.superscript,b.getValue(Ge.a.superscript));b.hasProperty(Ge.a.subscript)&&h.setValue(Ge.a.subscript,b.getValue(Ge.a.subscript));b.hasProperty(Ge.a.strikethrough)&&h.setValue(Ge.a.strikethrough,b.getValue(Ge.a.strikethrough))}kVi(b){if(pe.a.instance.J(7)){var h=
this.nc.Xn(b);h?this.nc.qf(h)===hl.StyleReader.wordStyleIdListParagraph&&(h=this.nc.jx(b),this.zca.QK(h.fh(hl.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.eNb&&r.AFrameworkApplication.K.$("WordEditorSkipTrackingChangeForList"))):w.ULS.shipAssertTag(8271188,315,!1)}}DZn(b){if(pe.a.instance.J(7)){if(this.nc.qf(this.nc.Xn(b))===hl.StyleReader.wordStyleIdNormal){const h=this.nc.jx(b);this.zca.QK(h.fh(hl.StyleReader.wordStyleIdListParagraph),b,!0,!0)}b.Ng(Lc.a.fe,Lc.a.lM,Lc.a.iC,Lc.a.A_,Lc.a.tt,Lc.a.fha);
b.setValue(Lc.a.GQa,0)}}fCk(b,h){const u=b.getValue(Lc.a.listID),y=b.getValue(Lc.a.listLevel);for(let aa=0;9>aa;aa++){const ta=this.Uo.hx(b,u,aa);if(!ta)return ri.a.instance.fc("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var P=h.$Gb[aa];P=6===P?Sr.a.KP(1,1):Sr.a.KP(0,P);P.wga&&ta.setValue(Ge.a.L3,P.wga);ta.hasProperty(Ge.a.font)&&ta.removeProperty(Ge.a.font);h.RCa&&h.RCa[aa]&&ta.setValue(Ge.a.font,h.RCa[aa]);P=h.ITc[aa];w.ULS.shipAssertTag(22127641,338,!!P);ta.setValue(Lc.a.Vt,
P);ta.setValue(Lc.a.Gr,wu.a.$ac);wu.a.pbe(h.H4,ta);ta.setValue(Lc.a.lba,h.KVd[aa]);ta.Ng(Lc.a.d1c,Ge.a.l_);this.kpj(b)}b=new ep.a;b.listID=u;b.level=y;return b}dCk(b,h,u,y){if(this.Ir&&y)return this.fCk(b,y);y=b.getValue(Lc.a.listID);const P=b.getValue(Lc.a.listLevel),aa=this.Uo.hx(b,y,P);if(!aa)return ri.a.instance.fc("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&w.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,
h.listType,y,P),null;h.e4b&&(aa instanceof by.APropertySet?aa.oI(h.propertySet,Lc.a.listID,Lc.a.listLevel):w.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===aa||void 0===aa?void 0:aa.constructor.name));var ta=aa.ia(Lc.a.Gr,null);ta&&ta===wu.a.$ac&&this.cCk(b,y);if(!h.listStyle){ta=0;if(-1!==u){for(ta+=P-u;0>ta;)ta+=3;ta%=3}switch(ta){default:u=1;break;case 1:u=2;break;case 2:u=3}h.F8(h.listType,u)}h.wga&&aa.setValue(Ge.a.L3,h.wga);
this.Ir&&(h.Rt?(this.w6i(h,aa,P),aa.hasProperty(Ge.a.font)&&aa.removeProperty(Ge.a.font)):(Po.t6i(h,aa),Po.v6i(h,aa)),Po.u6i(h,aa));aa.Ng(Lc.a.d1c,Ge.a.l_,Lc.a.GRc);this.kpj(b);b=new ep.a;b.listID=y;b.level=P;return b}cCk(b,h){let u;for(let y=0;9>y;y++){u=this.Uo.hx(b,h,y);if(!u){w.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,y);break}u.setValue(Lc.a.Gr,wu.a.NPd);u.removeProperty(zi.a.Ejb)}}Fae(b,h){const u=ri.a.instance.Xo(Oa.a.Fae);this.ugd.value||ri.a.instance.fc("PossibleIncorrectListIndentation",
{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.yKa?(u.properties.Z("PendingListInfo","true"),wj.ListReader.lj(b)&&(u.properties.Z("RemoveCurrentListInfo","true"),this.eNb=!0,this.rRa(b),this.ugd.value.SQa(b,-1,0),this.eNb=!1),16!==this.yKa.listType&&this.oBc(b,this.yKa,{Kci:!0,lpl:wj.ListReader.HZ}),this.yKa=null):h||(u.properties.Z("CurrentlyUnderPastedList","true"),this.rRa(b,{aVi:!0}));u.end()}Abe(b,h){var u;if(wj.ListReader.lj(b))return!1;b.Rb(2);var y=Fi.a.aqk;const P=[!0,!1].map(aa=>
be.ParagraphReader.Tg(b.currentNode,aa,void 0,!1));b.qc();for(let aa=0;aa<P.length;aa++){const ta=P[aa];if(ta&&!wj.ListReader.zva(ta))for(const Pa of y)if(Pa.test(ta.characterData))return y=null===(u=Pa.exec(ta.characterData))||void 0===u?void 0:u[0],this.Zvn(h,aa?"nextPara":"prevPara",y),!1}return!0}Zvn(b,h,u){const y=new Map;y.set("CurrentAutoListPreventedAutoListText",b);y.set("UndoAutoListPreferenceFoundIn",h);y.set("UndoAutoListPreferenceAutoListText",u);Ta.Health.instance.recordKpiUsage(Nf.a.$Sc.lCn,
0,Nf.a.eD,y)}t8n(b,h){return b&&h}lVi(b){for(let h=0;h<b.count;h++){const u=yd.GraphIterator.$a(b.J(h));u.jo();this.axa(u)}b.clear()}IHn(b){wj.ListReader.E7(b)&&this.Rpa()}DRi(b,h){b=new yd.GraphIterator;b.set(h);b.zd();og.OutlineElementNavigator.$d(b);b.ahb(h)||ri.a.instance.fc("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.rRa(b);return b}hZn(b,h,u){this.Bh.zxa(b,h,u,!0)}qZn(b){b.F8(1,1)}Yvd(b,h){const u=ri.a.instance.Xo(Oa.a.$lk);if(this.nc.$I(h.$h())){if(wj.ListReader.lj(b)&&
this.rRa(b),h=this.Uo.d_h(h)){u.properties.Z("EarlyReturn","False");this.Uo.Iua(b.currentNode,h);var y=Tn.Ril(this,b,h),P=this.createList(b);if(y)this.joinList(P,y,!0);else{if(y=this.RHd(b,h,this.Afj,this.fho)){const aa=this.NA(y);if(aa.listID===h.listID&&aa.level<h.level&&this.hd.Qu(y).Rt){const ta=this.tT(y.currentNode,aa);aa.hs===(ta.startAt===Nf.a.Cj?1:ta.startAt)&&(aa.bHc=aa.hs,this.B8d(P,aa,y.currentNode,1))}}y=this.tT(P,h);b=this.ZVd(h,b,y);b=b.XEa!==Nf.a.Cj?b.XEa+1:y.startAt===Nf.a.Cj?1:y.startAt;
this.pBc(P,h);P.setValue(yl.a.hh.NO,b);P.setValue(yl.a.hh.Qca,b)}P.setValue(Lc.a.xga,!0);u.end()}}else ri.a.instance.fc("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}B8d(b,h,u,y,P=!1){this.Uo.T$b(b,h.listID,h.level)&&this.LHn(u,h,y,P)}Kih(b,h,u,y,P=null){b=this.Ir&&P?this.aVk(b,u,y,P):this.$Uk(b,u,y);this.pBc(h,b);u.listType||(y=u.gB,y===Nf.a.Cj&&(y=1),h.setValue(yl.a.hh.NO,y),h.setValue(yl.a.hh.Qca,y));this.Ir&&(!yl.a.hh.WT&&u.Qma?(u=u.levelText,P||(u=u.replace("%1","%"+(b.level+
1))),h.setValue(Lc.a.Vt,u)):(w.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),h.setValue(Lc.a.Vt,"")));return b}leaveList(b){if(!Po.Wmi){var h=this.gDa(b.currentNode),u=this.Uo.Iua(b.currentNode,h),y=new yd.GraphIterator;y.ed(b);y.qc();wj.ListReader.lj(y)||ri.a.instance.fc("PossibleErrorInLeaveList",{["Reason"]:aB.a.C2b});var P=this.tT(y.currentNode,h),aa=h.hs===P.startAt;Po.jim(y);if(P=this.MHn(h,P,y)){const ta=this.hd.Qu(P);ta.Lla=ta.Rt?
ta.hs:Nf.a.Cj}u.Rt&&P&&this.B8d(b.currentNode,h,P.currentNode,-1);aa&&P&&(u=this.NA(P),this.Uo.Iua(P.currentNode,u).Rt&&(aa=this.tT(P.currentNode,u),u.hs===(aa.startAt===Nf.a.Cj?1:aa.startAt)+1&&this.$vf(P,aa,y.currentNode)&&this.B8d(b.currentNode,h,P.currentNode,-1,!0)));!P&&this.Uo.T$b(b.currentNode,h.listID,h.level)&&this.kef(y,h,this.cEf,this.j8f)}}joinList(b,h,u,y=null){if(b)if(22!==b.type&&63!==b.type)w.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",
b.type);else{var P=this.Uo.Z_a(b);this.VGc(P,()=>{this.pBc(b,h.Mw);if(this.Uo.Iua(b,h.Mw).Rt){var aa=new yd.GraphIterator;aa.set(b);aa.zd();aa.qc();const ta=this.Jll(aa,h,y);aa=this.Bll(aa,b,h,u,y,ta);this.Gll(h,u,y,ta,aa)}})}else w.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}Jll(b,h,u){if(h.xki)h=h.outlineElement;else{let y,P;u?(y=this.Bfj,P=this.Vde):h.R7b?(y=this.Afj,P=this.Vde):(y=this.eho,P=this.gho);h=this.RHd(b,h.Mw,y,P,u)}!h&&u&&(u=new yd.GraphIterator,
u.ed(b),u.TMc()&&wj.ListReader.lj(u)&&(h=u));return h}Bll(b,h,u,y,P,aa){y?(P?b=P.Khc:(aa=this.tT(h,u.Mw),u=this.ZVd(u.Mw,b,aa),b=u.XEa!==Nf.a.Cj?u.XEa+1:aa.startAt===Nf.a.Cj?1:aa.startAt),h.setValue(yl.a.hh.NO,b),h.setValue(yl.a.hh.Qca,b)):(b=Nf.a.Cj,this.k_n(h,aa,u));return b}Gll(b,h,u,y,P){if(y){var aa=!1,ta=this.NA(y),Pa=ta.level===b.Mw.level,vb=!!u&&ta.listID===u.vXc;(ta.listID===b.Mw.listID||vb)&&Pa&&(Pa=this.tT(y.currentNode,ta),vb=Pa.startAt===Nf.a.Cj?1:Pa.startAt,ta.hs===vb+1&&(aa=h?P===vb:
this.$vf(y,Pa,null)));if(!aa||u)u?(h=u.delta,P=this.nbo,aa=this.obo):(h=1,P=this.Qce,aa=this.kcj),ta=new yd.GraphIterator,ta.set(y.currentNode),ta.zd(),this.hd.fG(ta),ta.qc(),this.VPh(y.currentNode,b.Mw,h,P,aa,u)}}k_n(b,h,u){let y=null;h&&(y=this.NA(h));if(y&&y.listID===u.Mw.listID&&y.level===u.Mw.level){const P=this.hd.Qu(h),aa=P.hs;b.setValue(yl.a.hh.NO,aa);b.setValue(yl.a.hh.Qca,aa);wj.ListReader.HZ&&(P.propertySet.setValue(Lc.a.listID,y.listID),P.propertySet.setValue(Lc.a.listLevel,y.level));
if(!u.R7b||u.x_d)u.xki&&!u.x_d&&(this.hd.fG(h),b=h.currentNode,og.OutlineElementNavigator.$d(h)),b.setValue(yl.a.hh.Qca,b.getValue(yl.a.hh.NO))}else h=u.Mw.hs+1,b.setValue(yl.a.hh.NO,h),b.setValue(yl.a.hh.Qca,h)}oBc(b,h,{Kci:u=!1,cDm:y=-1,Hnl:P=!1,propertySet:aa,lpl:ta=!1}={}){return h&&16!==h.listType?yd.GraphIterator.Q6(()=>{if(!wg.OutlineElementReader.Oh(b))return w.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),Um.mbc();const Pa=wg.OutlineElementReader.Agb(b);
return Pa&&En.a(Pa,8)?(w.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Um.mbc()):pe.a.instance.J(3)&&(null===Pa||void 0===Pa?0:Pa.qa.last.gi)?(w.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),Um.mbc()):this.VGc(Pa,()=>{var vb=Po.mh.Wt(b.currentNode);const Kb=h.bB,Sb=this.infoAtLevel(b,h);var Yb=b.Rb(4);if(Yb)return b.qc(),vb=this.Eih(Sb,Yb,y,Kb),vb.Mw=this.NA(b),vb;Yb=this.wUk(b);const Ac=h.propertySet.ia(Lc.a.listID,
-1),Sc=this.nIl(Ac,ta),nd=this.jGl(Pa),Ad=this.iHl(h,b,Sb,ta,P,u);this.Ir&&this.QXn(Ad,Sb);Pa&&(yl.a.hh.jO||this.Dae(Yb,Pa,aa),this.DZn(Pa));return null==Ad||P||Sb.Rt!==this.hd.Iua(Yb,Ad.Mw).Rt?this.F8k(Sb,Sc,Ad,Yb)?(this.GZn(Yb,Sb,Sc,nd),this.Eih(Sb,Yb,-1,Kb)):this.amk(Yb,Sb,b,vb,nd,Kb,Sc,Ac):(Sb.listStyle||(Ad.R7b=!0),this.cmk(Sc,Ad,Yb))})}):(h||w.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.rRa(b))}iHl(b,h,u,y,P,aa){var ta;P=b.pkb?new Tn(this,yd.GraphIterator.$a(b.pkb),
!1,!0):Tn.Qil(this,h,u,y,P);if(!P)return null;aa?(P.Mw.level=this.vGl(h,u,y),this.kll(h,P)):P.Mw&&(null===(ta=b.propertySet)||void 0===ta?0:ta.hasProperty(Lc.a.listLevel))&&(P.Mw.level=b.propertySet.getValue(Lc.a.listLevel));return P}nIl(b,h){return wj.ListReader.HZ&&h&&0<b&&b+""in this.QPf?this.QPf[b+""]:-1}GZn(b,h,u,y){var P;b.properties.setValue(Lc.a.listID,u);b.properties.hasProperty(Lc.a.listLevel)||(u=(null===(P=h.propertySet)||void 0===P?0:P.hasProperty(Lc.a.listLevel))?h.propertySet.Nf(Lc.a.listLevel):
this.GTc(y),b.properties.setValue(Lc.a.listLevel,u),this.Ir&&(h.propertySet&&h.Qma&&!yl.a.hh.WT&&(y=h.levelText.replace("%1","%"+(u+1)),b.setValue(Lc.a.Vt,y)),h.propertySet&&h.w6b&&!yl.a.hh.jO&&b.setValue(Ge.a.font,h.font)))}Eih(b,h,u,y){b=this.dCk(h,b,u,y);return Um.zDm(b)}cmk(b,h,u){let y=null;wj.ListReader.HZ&&0<b&&(y=new Bx(0,h.Mw,-1),y.vXc=b,y.delta=-1);this.joinList(u,h,!1,y);return Um.NDm(h.Mw)}amk(b,h,u,y,P,aa,ta,Pa){u=wg.OutlineElementReader.Z2(u);0<u&&(P+=u);h=this.Kih(y,b,h,P,aa);this.Myo(ta,
Pa,h,b);return Um.BDm(h)}rRa(b,{aVi:h=!1}={}){return yd.GraphIterator.Q6(()=>{if(!wg.OutlineElementReader.Oh(b))return w.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),Um.mbc();const u=wg.OutlineElementReader.Agb(b);return pe.a.instance.J(3)&&(null===u||void 0===u?0:u.qa.last.gi)?(w.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),Um.mbc()):this.VGc(u,()=>{var y;const P=b.Rb(4);if(!P)return Um.mbc();u&&(this.kVi(u),
this.TDn(u),u.IS=null);this.hd.ATd(P.ia(Lc.a.listID,0))?(P.Xbe=!1,this.leaveList(b),b.Jg()):b.qc();!h&&u&&this.HWn(b);b.Rb(4)&&(P.Xbe=!1,this.leaveList(b),b.Jg());u&&(this.Ud.zg&&!this.eNb||!this.Ud.zg&&u.Zi)&&(!u.Zi||(null===(y=u.mC)||void 0===y?0:y.hasProperty(Lc.a.listID)))&&this.ZWk(b);return Um.fEm()})})}HWn(b){const h=Po.mh.Wt(b.currentNode),u=wg.OutlineElementReader.eDa(b),y=wg.OutlineElementReader.QF(b),P=wg.OutlineElementReader.Z2(b);this.dFd(h);this.Bh.zxa(b,1,Math.max(0,u+(P||-1*y)-this.joc[0]))}VGc(b,
h){let u=null;pe.a.instance.J(3)&&b&&(u=b.hD());h=h();pe.a.instance.J(3)&&!this.eNb&&(b&&u&&this.Eo.FU(b,u,this.Ud.zg),this.Rpa());return h}wUk(b){b.Rb(31)&&b.Jg();return this.createList(b)}TDn(b){b.hasProperty(Lc.a.fe)&&b.removeProperty(Lc.a.fe);b.hasProperty(Lc.a.iC)&&b.removeProperty(Lc.a.iC);b.hasProperty(Lc.a.tt)&&b.removeProperty(Lc.a.tt)}infoAtLevel(b,h){if(!h)return null;const u=h.bB;if(this.Ir)if(1===h.Gr){if(h.Ena&&!h.bJ||!h.W_e(!1))return h;b=wg.OutlineElementReader.eDa(b);const y=this.GTc(b),
P=u.$Gb[y];b=Sr.a.F2(h.propertySet,h.propertySet);6===P?b.F8(1,1):b.F8(0,P);b.Gae("multilevel");b.levelText=u.ITc[y];u.RCa&&u.RCa[y]&&(b.font=u.RCa[y]);b.mt=u.KVd[y];b.H4=u.H4;b.uWd=h.uWd}else b=h;else b=h;return b}QXn(b,h){null!==b&&void 0!==b&&b.Mw&&(h.levelText=b.Mw.levelText,h.Rt||(h.font=b.Mw.font))}vGl(b,h,u){let y=wg.OutlineElementReader.eDa(b);if(this.Ir){const P=wg.OutlineElementReader.Z2(b);0<P?y+=P:(b=wg.OutlineElementReader.QF(b),0<b&&(y-=b))}h=h.propertySet.ia(Lc.a.listLevel,-1);return u&&
0<=h?h:this.GTc(y)}kll(b,h){if(!this.Uo.Iua(b.currentNode,h.Mw).listType){const u=this.tT(b.currentNode,h.Mw);b=this.ZVd(h.Mw,b,u);h.Mw.bHc=h.Mw.hs=b.XEa===Nf.a.Cj?u.startAt-1:b.XEa;h.R7b=b.Wsj}}Myo(b,h,u,y){wj.ListReader.HZ&&(0>=b?this.QPf[h+""]=u.listID:(y.properties.setValue(Lc.a.listID,b),u.listID=b))}F8k(b,h,u,y){if(!wj.ListReader.HZ||0>=h)return!1;const P=(aa,ta)=>r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixIncorrectListFormatComparison",!1)?aa.length!==ta.length||
aa.some((Pa,vb)=>Pa!==ta[vb]):aa!==ta;if(u)return h=this.hd.Iua(y,u.Mw),b.Rt!==h.Rt||P(b.wga,h.wga);u=b.propertySet.ia(Lc.a.listLevel,-1);return 0<=u&&(h=this.Uo.hx(y,h,u))&&(h=h.ia(Ge.a.L3,null))&&b.wga?P(h,b.wga):!1}SDn(b,h){const u=!!h&&be.ParagraphReader.ic(h);let y=0,P=0;u&&(y=this.so.oT(b.currentNode).yt,P=this.so.QF(h).yt);u&&this.kVi(h);b.Jg();u&&this.Bh.zxa(b,1,y-P)}W$(b,h,u,y=-1,P=!1,aa=null,ta=!1){w.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");
const Pa=ri.a.instance.Xo(Oa.a.W$),vb=this.Ic.Qc(15);vb.ev(b);let Kb=null,Sb=0;({bAm:Kb,MZm:Sb,returnValue:y}=this.sjl(b,h,y,Kb,Sb,P,aa));if(!Kb||ta&&(1===u||0>u-Kb.Mw.hs||2<u-Kb.Mw.hs))return vb.dispose(),Pa.end(),!1;for(;0<Sb;)b.TMc(),Sb--;this.Gyo(b,h,y,Kb);vb.dispose();Pa.end();return!0}Gyo(b,h,u,y){for(;b.TMc();)if(b.Rb(4)){if(this.gDa(b.currentNode).listID===h.listID){h=new Bx(0,h,u);this.joinList(b.currentNode,y,!0,h);break}b.qc()}}sjl(b,h,u,y,P,aa=!1,ta=null){for(var Pa;b.xNd();){if(b.Lq(4)){const vb=
this.NA(b),Kb=this.hd.Qu(b);if(Kb.listType!==ta.listType){P++;continue}if(aa&&Kb.listStyle!==ta.listStyle||!aa&&h.level<vb.level){P++;continue}-1===u&&(u=vb.hs+1);y=null;if(h.level===vb.level||aa)null===(Pa=this.j4c)||void 0===Pa?void 0:Pa.Srf(b),y=new Tn(this,b,!1,!1);aa&&vb.level!==h.level&&b.Lq(4)&&(b.Rb(4).setValue(Lc.a.listLevel,vb.level),b.qc());break}P++}return{returnValue:u,bAm:y,MZm:P}}YKd(b){let h=0;var u=0;pe.a.instance.J(3)&&(u=this.hd.cO(b,!1,!0),h=u.listId,u=u.listLevel);return this.hd.hx(b,
h,u)}startNewList(b,h,u){w.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var y=ri.a.instance.Xo(Oa.a.startNewList),P=this.Ic.Qc(15);P.ev(b);var aa=Sr.a.KP(0,h.listStyle,null,0,h.propertySet.ia(Lc.a.listLevel,-1));b.Rb(4);var ta=b.currentNode.ia(Lc.a.listID,0),Pa=b.currentNode.ia(Lc.a.listLevel,-1);b.qc();aa.uWd=ta;var vb=h.propertySet.ia(Lc.a.fe,0);0<vb&&aa.propertySet.setValue(Lc.a.fe,vb);-1===aa.propertySet.ia(Lc.a.listLevel,-1)&&aa.propertySet.setValue(Lc.a.listLevel,
Pa);1===h.Gr&&((Pa=new Sw.a,ta=h.S6h(b.currentNode,ta),ta)?1===ta&&(aa.Gae(wu.a.$ac),aa.bB=Pa.V4e(Pa.wJf,Pa.xJf),aa.H4=aa.bB.H4):(aa.Gae(wu.a.$ac),aa.bB=Pa.e4e(),aa.H4=aa.bB.H4));h.Bma()&&1>u&&(u=1);aa.gB=u;ta=new uh.DictionaryPropertySet;ta=this.j3b(Oa.a.uJ,ta);Pa=b.Rb(2);b.qc();b.Rb(4);h=this.gDa(b.currentNode);this.Ir&&(vb=this.YKd(b.currentNode))&&(aa.levelText=vb.ia(Lc.a.Vt,""),aa.bJ=42,aa.mt=vb.ia(Lc.a.lba,"left"));this.SDn(b,Pa);({LDa:aa}=this.Psa(ta,b,aa,!0));b.Rb(4);22!==b.currentNode.type&&
63!==b.currentNode.type&&w.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);b.currentNode.setValue(Lc.a.listLevel,h.level);b.qc();aa=new Tn(this,b,!1,!1);this.hd.fG(b);u=new Bx(1,h,u);this.joinList(b.currentNode,aa,!0,u);P.dispose();y.end()}else w.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}mxf(b){if(!b)return!1;const h=b.Rb(2);h&&b.qc();return pe.a.instance.J(3)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.gi?!0:!1}d4d(b,h,u,
y){return this.rCe.d4d(b,h,u,y)}L_f(b,h){if(!b||!h)return!1;const u=b.propertySet.ia(Lc.a.Vt,null);h=h.propertySet.ia(Lc.a.Vt,null);if(!u||!h)return!1;const y=b.propertySet.ia(Ge.a.font,null);b=b.propertySet.ia(Ge.a.font,null);return u===h&&y===b}h7i(b,h,u){u||h.listType||(h.gB=b.ia(Ge.a.l_,Nf.a.Cj))}TZh(b,h){if(!h)return null;const u=Array(9),y=h.uWd;if(!this.Arm(h,b)||1>y)return null;for(h=0;9>h;h++){const P=this.hd.hx(b,y,h);if(null===P||void 0===P?0:P.hasProperty(Lc.a.fe))u[h]=P.getValue(Lc.a.fe);
else return null}return u}Arm(b,h){if(!b)return!1;const u=b.propertySet.ia(Lc.a.listLevel,-1);b=b.propertySet.ia(Lc.a.fe,-1);if(0>u||0>b)return!1;this.dFd(h);return b!==this.RRb[u]?!0:!1}tdh(b,h,u){b&&b.setValue(Lc.a.fe,h?h[u]:this.RRb&&u<this.RRb.length?this.RRb[u]:720*(u+1))}VPh(b,h,u,y,P,aa=null,ta=!1){const Pa=new yd.GraphIterator,vb=this.tT(b,h);Pa.set(b);Pa.zd();b=tj.a.Vr(Pa,Pa.eTa());b.ho(Yw.a.V$b,null);let Kb=-1;for(;b.moveNext();){if(!wj.ListReader.lj(Pa))continue;this.hd.fG(Pa);const Sb=
Pa.currentNode,Yb=this.gDa(Sb);Pa.qc();if(y!==this.Qce||Yb.listID===h.listID){if(ta){if(-1!==Kb&&Kb>Yb.level)break;if(-1===Kb)Kb=Yb.level;else if(Yb.level!==Kb)continue}else{if(Yb.level<=vb.N_)break;if(!y(h,Yb,aa))continue}P(Sb,u,h.listID,aa)}}}ynl(b,h,u,y,P){const aa=new yd.GraphIterator,ta=this.tT(b,h);aa.set(b);aa.zd();if(wj.ListReader.lj(aa)){this.hd.fG(aa);b=aa.currentNode;var Pa=this.gDa(b);aa.qc();Pa.level<=ta.N_||y(h,Pa,null)&&P(b,u,h.listID,null)}}kef(b,h,u,y,P=null){const aa=new yd.GraphIterator;
aa.ed(b);y(b,h,this.NA(aa),aa,0);this.RHd(b,h,u,y,P)}RHd(b,h,u,y,P=null){let aa=new yd.GraphIterator;const ta=this.tT(b.currentNode,h);let Pa=null,vb=0;var Kb=new yd.GraphIterator;Kb.ed(b);Kb.Ab(10);const Sb=Le.a.Vr(Kb,Kb.origin);for(Sb.moveNext();Sb.moveNext();)if(Pa=null,aa=Sb.iterator,1===aa.role&&(Pa=Sb.currentNode,aa.Lq(4)&&(Kb=this.NA(aa),u(h,Kb,P))))if(Kb.level>h.level)y(b,h,Kb,aa,vb),vb++;else if(Kb.level===h.level||Kb.level<=ta.N_)break;return Pa?aa:null}kRi(b,h,u,y,P){b=this.tT(b.currentNode,
u);b.N_>=h.level&&this.Nyb(y,b.startAt+P)}static get Wmi(){null==Po.Vnd&&(r.AFrameworkApplication.K?(r.AFrameworkApplication.Ce("i75ig452;a229j208"),Po.Vnd=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):Po.Vnd=!1);return Po.Vnd}static get mh(){return xl.PageNavigator.instance}static t6i(b,h){h.setValue(Ge.a.font,b.Ena||b.RPc||b.w6b?b.font:"Symbol")}static v6i(b,h){b=b.Ena||b.RPc||b.Qma?b.levelText:Nf.a.OCd;w.ULS.shipAssertTag(22127637,
338,!!b);h.setValue(Lc.a.Vt,b)}static u6i(b,h){b=b.propertySet.ia(Lc.a.lba,"left");h.setValue(Lc.a.lba,b)}static gim(b){b=b.iterator.parentNode;const h=yd.GraphIterator.$a(b);b&&wg.OutlineElementReader.ixf(h,null)&&b.Ck(8,!0)}static jim(b){const h=new yd.GraphIterator;h.set(b.currentNode);og.OutlineElementNavigator.$d(b);for(b=h.Vd();b&&!xj.a.NTd(b);)b=h.Rj();b&&b.Ck(4,!0)}}Po.kSm=2147450879;Po.oyi=1;Po.Vnd=null;Object(m.a)(Po,"FlatListEditorCssVersion",yl.a,[422,326]);class Rg{constructor(b,h,u,
y,P,aa,ta,Pa,vb,Kb,Sb,Yb){this.RH=b;this.Bh=u;this.Mld=h;this.Ic=y;this.so=P;this.rCe=aa;this.Ud=ta;this.Eo=Pa;this.QJ=vb;this.Wc=Kb;this.me=Sb;this.Sbb=Yb}create(){return new Po(this.RH,this.Mld,this.Bh,this.Ic,this.so,this.rCe,this.Ud,this.Eo,this.QJ,this.Wc,this.me,this.Sbb)}}Object(m.a)(Rg,"FlatListEditorFactory",null,[]);class jw{constructor(){this.startAt=this.listLevel=this.listId=0;this.pkb=null}}Object(m.a)(jw,"ListAutoCorrectionRefInfo",null,[]);class Zw{get zzm(){if(null!=this.Vsg)var b=
this.Vsg;else{var h;b=this.Vsg=null===(h=r.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isZeroSupportedForListAutocorrect",!1)}return b}constructor(b,h){this.jTj=b;this.If=h}d4d(b,h,u,y){if(!b.hasProperty(ld.a.D2a))return!0;h=yd.GraphIterator.$a(h.currentNode);Se.SelectionEditor.eu(h);let P=!0;if(!u.listType&&!y){23===h.ef&&h.wE(1);y=b.ia(ld.a.D2a,1);if(this.zzm?1<y:1!==y){var aa=new yd.GraphIterator;aa.ed(h);aa.Ab(10);aa=Le.a.Dp(aa.origin);y=this.rjl(aa,
y,u,h.currentNode);u.pkb||(P=!1)}b.setValue(ld.a.D2a,y)}return P}rjl(b,h,u,y){const P=new ob.a;for(;b.moveNext()&&b.iterator.currentNode!==y;){const aa=b.iterator;if(!aa.Lq(4))continue;const ta=this.jTj.value.NA(aa),Pa=this.If.Qu(aa);this.Non(P,ta);Pa.listType===u.listType&&Pa.listStyle===u.listStyle&&(0>h-ta.hs||2<h-ta.hs||P.add(Object.assign(new jw,{listId:ta.listID,listLevel:ta.level,pkb:aa.currentNode,startAt:ta.hs+1})))}0<P.count&&(h=P.J(P.count-1).startAt,u.pkb=P.J(P.count-1).pkb);return h}Non(b,
h){let u=0;for(;u<b.count;){const y=b.J(u);y.listId===h.listID&&y.listLevel>=h.level?b.removeAt(u):u++}}}Object(m.a)(Zw,"ListAutoCorrector",null,[371]);class bB{constructor(b,h,u,y,P){this.M5a=(aa,ta,Pa)=>{var vb;aa=this.mFc(ta);if(!aa||this.Yr.mxf(aa))return 8;ta=this.Yr.NA(aa);if(1===ta.hs||this.bRc(ta.level))return 8;ta=null===(vb=this.hd)||void 0===vb?void 0:vb.Qu(aa);if(!ta||this.Mki(ta))return 8;if(1===Pa)return 32;this.Yr.startNewList(aa,ta,1);return 32};this.L5a=(aa,ta,Pa)=>{aa=this.mFc(ta);
if(!aa||this.Yr.mxf(aa))return 8;ta=this.Yr.NA(aa);if(this.bRc(ta.level))return 8;const vb=this.hd.Qu(aa);if(!vb||this.Mki(vb))return 8;if(1===Pa)return 32;this.uGc.UKl(aa.currentNode,ta.hs,this.hd,this.Yr,this.HSa);return 32};this.W$=(aa,ta,Pa)=>{aa=this.mFc(ta);if(!aa||this.Yr.mxf(aa))return 8;ta=this.Yr.NA(aa);if(1!==ta.hs||this.bRc(ta.level))return 8;if(1===Pa)return 32;Pa=this.hd.Qu(aa);return this.Yr.W$(aa,ta,Pa.gB,-1,!1,Pa)?32:8};this.ynb=(aa,ta,Pa,vb,Kb)=>{aa=this.mFc(ta);if(!aa)return 8;
ta=this.Yr.NA(aa);if(this.bRc(ta.level))return 8;if(1===Pa)return 32;Pa=this.hd.Qu(aa);this.Yr.startNewList(aa,Pa,Kb);return 32};this.Ndb=(aa,ta,Pa,vb,Kb)=>{aa=this.mFc(ta);if(!aa)return 8;ta=this.Yr.NA(aa);return this.bRc(ta.level)?8:1===Pa?32:this.Yr.W$(aa,ta,ta.hs,Kb)?32:8};this.Bc=b;this.hd=u;this.Yr=y;this.uGc=P}bRc(b){return 0>b}Wb(){this.Bc.pa(Oa.a.M5a,oc.a.outlineElement,this.M5a);this.Bc.pa(Oa.a.M5a,oc.a.Vc,this.M5a);this.Bc.pa(Oa.a.M5a,oc.a.view,this.M5a);this.Bc.Xc(Oa.a.M5a,12);this.Bc.pa(Oa.a.L5a,
oc.a.outlineElement,this.L5a);this.Bc.pa(Oa.a.L5a,oc.a.Vc,this.L5a);this.Bc.pa(Oa.a.L5a,oc.a.view,this.L5a);this.Bc.Xc(Oa.a.L5a,12);this.Bc.pa(Oa.a.W$,oc.a.outlineElement,this.W$);this.Bc.pa(Oa.a.W$,oc.a.Vc,this.W$);this.Bc.pa(Oa.a.W$,oc.a.view,this.W$);this.Bc.Xc(Oa.a.W$,12);this.Bc.pa(Oa.a.ynb,oc.a.outlineElement,this.ynb);this.Bc.pa(Oa.a.ynb,oc.a.Vc,this.ynb);this.Bc.pa(Oa.a.ynb,oc.a.view,this.ynb);this.Bc.Xc(Oa.a.ynb,12);this.Bc.pa(Oa.a.Ndb,oc.a.outlineElement,this.Ndb);this.Bc.pa(Oa.a.Ndb,oc.a.Vc,
this.Ndb);this.Bc.pa(Oa.a.Ndb,oc.a.view,this.Ndb);this.Bc.Xc(Oa.a.Ndb,12)}get HSa(){return Ja.a.instance.resolve("Common.IStandaloneRootController").L8}mFc(b){return this.Yr.uIl(b)}Mki(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(m.a)(bB,"ListContextMenuSectionActor",null,[]);var ek=c(597);class mz{static get EDm(){return ff.a.Sy(mz.am,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}mz.am="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(mz,"ListSetStartValueDialogHtml",null,[]);class Zr extends ff.a{constructor(b,h,u,y,P){super();this.eld=this.bqe=this.yld=this.DMe=null;this.Wre=!0;this.eL=!1;this.T$a=0;this.pdj=[Oa.a.F2f,Oa.a.d7f,Oa.a.VTf];this.J1n=(aa,ta)=>{aa=ta[Df.a.Number];this.v9=Number.isInteger(ta[Df.a.Number])&&aa>=this.T$a?aa:this.T$a};this.qUl=(aa,ta)=>{this.v9=this.v9>=this.T$a?this.v9:this.T$a;ta[Df.a.Number]=this.v9;ta[Df.a.UnitType]=0};this.HZn=(aa,ta)=>{if(1===aa){var Pa=ta.ListRadioStartNew,vb=ta.ListRadioContinue,
Kb=yd.GraphIterator.$a(this.Re);Kb.zd();ta=this.Yr.NA(Kb);aa=this.If.Qu(Kb);if(Pa)this.Yr.startNewList(Kb,aa,this.v9);else if(vb)if(this.Wre)this.Yr.W$(Kb,ta,this.RFe,-1,!1,aa);else{Pa=!0;for(vb=null;Kb.MI();)if(Kb.Lq(4)){vb=new Tn(this.Yr,Kb,!1,!1);break}if(!vb||this.Yr.NA(Kb).hs>=this.v9)Pa=!1;Pa?(Kb=yd.GraphIterator.$a(this.Re),Kb.zd(),this.Yr.W$(Kb,ta,this.RFe,this.v9,!1,aa)):(this.dispose(),this.wxa(CommonUIStrings.l_ErrorDialogMessage,this.DDm))}}};this.DDm=()=>{new Zr(this.Re,this.RFe,this.If,
this.Yr,this.Ad)};this.D9m=()=>{document.getElementById(Zr.fsi).style.visibility="visible"};this.C2m=()=>{document.getElementById(Zr.fsi).style.visibility="hidden"};this.mg="ListSetStartValueDialog";this.Hg=mz.EDm;this.Re=b;this.v9=h;this.If=u;this.RFe=h;this.r5=y;h=new yd.GraphIterator;b?(h.set(b),h.zd(),wg.OutlineElementReader.Oh(h)||og.OutlineElementNavigator.$d(h),wj.ListReader.lj(h)&&(h.Rb(4),b=h.currentNode,22===b.type&&(this.If.dO(b).Bma()?this.T$a=1:this.T$a=0))):this.T$a=1;this.Ad=P;this.Wh(Box4Intl.Box4Strings.l_SetNumberingValueList,
this.HZn,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Wre&&(this.DMe=document.getElementById("ListRadioStartNew"),this.yld=this.D9m,this.bqe=document.getElementById("ListRadioContinue"),this.eld=this.C2m,rf.a.addHandler(this.DMe,"click",this.yld),rf.a.addHandler(this.bqe,"click",this.eld));for(const aa of this.pdj)Object(ek.a)(aa,this.J1n,this.qUl);this.Ad.Nl()}get Yr(){return this.r5}dispose(){if(!this.eL){for(const b of this.pdj)Object(ek.b)(b);this.Wre&&(this.yld&&rf.a.removeHandler(this.DMe,
"click",this.yld),this.eld&&rf.a.removeHandler(this.bqe,"click",this.eld));this.Ad.LE("ListStartSpinner");super.dispose();this.eL=!0}}ivk(){const b=ke.n("none",this.T$a+"","100","1");return ke.l(Zr.gsi,Oa.a.F2f,Oa.a.VTf,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Oa.a.d7f)}cyb(b){const h=document.getElementById(Zr.gsi);this.Ad.BLa("ListStartSpinner",b);b=this.Ad.fgb("ListStartSpinner","Medium");h.appendChild(b)}QX(){const b=this.ivk();this.cyb(b)}}Zr.gsi="SetListStartSpinnerContainer";Zr.fsi="ListStartAtSpinnerBox";
Object(m.a)(Zr,"ListSetStartValueDialog",ff.a,[]);class Cx{UKl(b,h,u,y,P){new Zr(b,h,u,y,P)}static get instance(){return Cx._instance||(Cx._instance=new Cx)}}Cx._instance=null;Object(m.a)(Cx,"ListDialogFactory",null,[364]);class Kv{constructor(b,h,u){this.r5=b;this.If=h;this.Ic=u}Srf(b){w.ULS.shipAssertTag(40420184,393,wg.OutlineElementReader.Oh(b));const h=b.Rb(4);b.qc();if(h){const u=this.If.dO(h);u.Gr||this.tbm(b,h,u)}}oEk(b){for(let h=0;h<b.length;h++){const u=new yd.GraphIterator;u.set(b.getContext(h).node);
this.Srf(u)}}tbm(b,h,u){const y=xl.PageNavigator.instance.Wt(h),P=this.r5.gDa(h),aa=this.Ic.Qc(15);aa.ev(b);b=this.r5.Kih(y,h,u,0,null);this.r5.GHn(h,P.listID);aa.dispose();this.If.Iua(h,b)}}Object(m.a)(Kv,"SingleLevelListEditor",null,[365]);var MB=c(332);class Xt extends Nh{constructor(b){super();Xt.Frc=b}kOi(b,h,u,y,P,aa){if(!b||!b.length)return 8;let ta;const Pa=({q1l:b,p1l:ta}=Xt.Vp.n1l(b)).returnValue;let vb=1;for(const Sb of Pa.keys){var Kb=b.contains(Sb);const Yb=Pa.J(Sb);Xt.Vp.zAk(Pa.J(Sb),
this.gDc(h),Kb)?Kb?(w.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.gDc(h)?"Promote":"Demote"),Kb=r.AFrameworkApplication.ya.Tf(MB.a.aCa(Yb),h,u,y,P,aa)):(w.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.gDc(h)?"Promote":"Demote"),Kb=Xt.Vp.Vbn(Pa.J(Sb),this.gDc(h),ta.J(Sb))):(w.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.gDc(h)?"Promote":"Demote"),Kb=8);vb=De.ActionManager.cVc(vb,
Kb)}return vb}gDc(b){return b===Oa.a.GE?!0:!1}static get Vp(){return Xt.Frc||(Xt.Frc=Ja.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Xt.Frc=null;Object(m.a)(Xt,"WordEditorListContextManager",Nh,[]);class $r{get name(){return"WordEditor.ListEditors"}xc(b){r.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new Zw(b.af("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).singleInstance(),
b.ha("WordEditor.IFlatListEditor",()=>(new Rg(b.resolve("WordEditor.List.IFlatListReader"),b.af("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new oi.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),
b.resolve("Box4.Styles.IWACStyleEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new Kv(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new Xt(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new bB(r.AFrameworkApplication.ya,
new Zo.a,$r.hd,$r.Yr,Cx.instance)).Wb();const b=r.AFrameworkApplication.ya;b.gb(Oa.a.VTf,oc.a.view,ek.d,96);b.gb(Oa.a.d7f,oc.a.view,ek.c,96);b.gb(Oa.a.F2f,oc.a.view,ek.c,96)}dispose(){}static get hd(){return null!=$r.ztg?$r.ztg:$r.ztg=Ja.a.instance.resolve("Box4.List.IListReader")}static get Yr(){return null!=$r.ipg?$r.ipg:$r.ipg=Ja.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){K.a.instance.Kc(new $r)}}Object(m.a)($r,"WordEditorListEditorsPackage",null,[1,2]);var $w=c(1637),Lv=c(528),
zs=c(71),eA=c(1951);class kw extends Xb.a{constructor(b,h,u,y,P,aa){super(b,h);this.styleId=null;this.si=0;this.IPa=null;this.characterData=u;this.paragraphNode=y;this.listMarker=P;this.n7=aa}}Object(m.a)(kw,"HeadingText",Xb.a,[]);var un=c(365);class cB{constructor(b,h,u,y,P,aa,ta){this.AOg=!0;this.CVg=0;this.a$g=8;this.eha=null;this.M7l=Pa=>{if(Pa.Dr)return!0;Pa=Pa.role;return 1===Pa||2===Pa||4===Pa};this.cTj=b;this.DB=h;this.me=u;this.If=y;this.BB=P;this.Uca=aa;this.dCe=ta}get fy(){return this.cTj.value}get Mrf(){return this.AOg}set Mrf(b){this.AOg=
b}get qHb(){return this.CVg}set qHb(b){this.CVg=b}get NOb(){return this.a$g}set NOb(b){this.a$g=b}WEl(){return Object(zs.__awaiter)(this,void 0,void 0,function*(){var b=this.dCe.value;if(!isNullOrUndefined(b)&&b.Zv)return b=yield this.mNl(),this.CRf(b,!0);b=this.eha;return isNullOrUndefined(b)?null:Promise.resolve(this.CRf(b,!0))})}XEl(){return this.CRf([],!1)}CRf(b,h){const u=window.performance.now(),y=this.dYh();if(!y)return null;const P=new ob.a;let aa=0;for(;y.moveNext();){var ta=y.iterator;if(11===
ta.ef){const Pa=this.If.LCb(ta),vb=og.OutlineElementNavigator.Ee(ta,!0);h&&b[aa]&&b[aa].ParaId===be.ParagraphReader.eQ(vb)&&aa++;og.OutlineElementNavigator.$d(ta);if(!vb||!be.ParagraphReader.ic(vb)||vb.es||""===vb.characterData||"\ufffc"===vb.characterData)continue;const Kb=this.nKd(vb);Kb&&(Pa&&(Kb.listMarker=this.BB.Fjb(Pa,!1).P7,ta=this.If.Qu(ta),1===ta.listType&&ta.w6b&&(Kb.IPa=ta.font)),h&&(b[aa-1]&&b[aa-1].ParaId===be.ParagraphReader.eQ(vb)?Kb.si=aa:Kb.si=aa+1),P.add(Kb))}}w.ULS.sendTraceTag(591963592,
3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-u));return P}mNl(){const b=new Jk.a;var h=eA.a.U$(r.AFrameworkApplication.rootQuerySignature,null);const u=new Nr.a;u.ks=h;u.status=1;this.AXj=window.performance.now();h=this.Uca.kma(0,()=>{if(2!=u.statusCode||null==u.jk||0==u.jk.length||null==u.jk[0]){const y=String.format("GetPageEndsOperation Failed with status code: {0};",u.statusCode);b.setException(Error.create(y));w.ULS.sendTraceTag(543802465,3019,10,y)}else b.Cg(u.jk[0].PageEnds),
w.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.AXj))});h.cK(u);h.HW();return yb.b(b.task)}TEl(){const b=this.dYh();if(!b)return-1;let h=0;for(;b.moveNext();){const u=b.iterator;if(11===u.ef){const y=og.OutlineElementNavigator.Ee(u,!0);og.OutlineElementNavigator.$d(u);y&&be.ParagraphReader.ic(y)&&!y.es&&""!==y.characterData&&"\ufffc"!==y.characterData&&this.nKd(y)&&h++}}return h}dYh(){if(!this.fy)return w.ULS.sendTraceTag(591000526,
3019,10,"PageNode is null"),null;var b=this.DB.dQ(this.fy);if(!b)return w.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=yd.GraphIterator.$a(b);if(!b.jo())return w.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Le.a.Vr(b,b.origin);b.ho(this.M7l,null);return b}nKd(b){var h;return null!==(h=this.g_l(b))&&void 0!==h?h:this.DNl(b)}g_l(b){if(!Fj.a.$l)return this.h_l(b);if(!this.kzm(b))return null;var h=[Object(un.b)(1),Object(un.c)()];h=Object(un.a)(h);
h=[...be.ParagraphReader.Ecf(b,h)];if(0===h.length)return null;const u=be.ParagraphReader.Cma(b)+1;return this.awh(b,h,u)}DNl(b){var h,u,y,P;if(!Fj.a.$l)return this.QEl(b);var aa=[Object(un.b)(1),Object(un.c)()];aa=Object(un.a)(aa);const ta=be.ParagraphReader.cMd(b),Pa=this.me.jx(b),{O7l:vb,Bkl:Kb}=this.EVl(ta,Pa,aa);aa=null!==(P=null!==(u=null===(h=Kb.Ac)||void 0===h?void 0:h.n7)&&void 0!==u?u:null===(y=Kb.Rv)||void 0===y?void 0:y.n7)&&void 0!==P?P:10;return this.GFb(aa-1)?this.awh(b,vb,aa):null}awh(b,
h,u){var y;if(!this.GFb(u-1))return null;const {Gkj:P,Fkj:aa}=this.Upo(b,h);return 0===P.length?null:(h=null===(y=be.ParagraphReader.qnf(b,P))||void 0===y?void 0:y.trim())&&""!=h?new kw(aa.xd,aa.endCp,h,b,null,u):null}EVl(b,h,u){const y=[];let P={Ac:null,Rv:null},aa=null,ta=null;for(const Pa of b)if(aa=Pa.chp.formatting?this.SEl(h,Pa.chp):aa,b=u(Pa)){if(!ta&&b){ta=aa;if(!ta)break;P=aa}else if(!this.Kpm(aa,ta))break;y.push(Pa)}return{O7l:y,Bkl:P}}Upo(b,h){var u;let y=-1,P;for(P=0;P<h.length;P++){var aa=
h[P],ta=b.characterData.substring(aa.chp.cp,aa.cpEnd),Pa=null===ta||void 0===ta?void 0:ta.trimStart();if(Pa){y=aa.chp.cp+(ta.length-Pa.length);break}}if(-1===y)return{Gkj:[],Fkj:{xd:-1,endCp:-1}};aa=-1;for(ta=h.length;0<ta;ta--){Pa=h[ta-1];const vb=b.characterData.substring(Pa.chp.cp,Pa.cpEnd),Kb=null===vb||void 0===vb?void 0:vb.trimEnd();if(Kb){aa=Pa.cpEnd-(vb.length-Kb.length);break}}return{Gkj:null!==(u=h.slice(P,ta))&&void 0!==u?u:[],Fkj:{xd:y,endCp:aa}}}Kpm(b,h){return null==b&&null==h&&b===
h?!0:null==b||null==h?!1:h.Ac&&b.Ac&&h.Ac.n7===b.Ac.n7||h.Rv&&b.Rv&&h.Rv.Wqh==b.Rv.Wqh?!0:!1}SEl(b,h){h=Wi.FormattingReader.Kma(h.formatting);b=this.VEl(b,h);h=this.REl(h);return b||h?{Ac:b,Rv:h}:null}VEl(b,h){b=this.me.NZ(h,b);if(!b)return null;h=b.ia(Lc.a.Yi,9);return this.D3c(h)?{cWo:b.id,n7:h+1}:null}REl(b){var h;b=this.me.qf(b);if(!b||!uk.a.rVd(b))return null;const u=null!==(h=uk.a.$4b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(u);return this.GFb(h-1)?{Wqh:b,n7:h}:null}h_l(b){const h=be.ParagraphReader.Cma(b);
if(this.D3c(h))return new kw(0,b.characterData.length,b.characterData,b,null,h+1);if(this.GFb(h)){var u=this.me.Xn(b);u=this.me.qf(u);if(uk.a.nGb(u))return new kw(0,b.characterData.length,b.characterData,b,null,h+1)}return null}QEl(b){var h;let u=h=null,y=-1;var P=-1,aa=this.me.jx(b);for(let Pa=0;Pa<b.qa.length;Pa++)if(h=b.qa.J(Pa),h.formatting){var ta=Wi.FormattingReader.Kma(h.formatting);const vb=this.me.qf(ta);if(!u&&(u=vb,P=(P=uk.a.$4b(u))?Number.parseInvariant(P):0,!this.GFb(P-1)))break;ta=(ta=
this.me.NZ(ta,aa))?ta.ia(Lc.a.Yi,9):9;y=-1===y?ta:y;if(!(this.D3c(ta)&&y===ta||uk.a.rVd(vb)&&u===vb))break}h=h.cp;aa=b.characterData.substring(0,h);return this.D3c(y)?new kw(0,h,aa,b,null,y+1):uk.a.rVd(u)?new kw(0,h,aa,b,null,P):null}kzm(b){const h=be.ParagraphReader.Cma(b);if(!this.GFb(h))return!1;if(this.D3c(h))return!0;b=this.me.Xn(b);b=this.me.qf(b);return uk.a.nGb(b)?!0:!1}D3c(b){return this.Mrf&&this.GFb(b)}GFb(b){return b>=this.qHb&&b<=this.NOb}}Object(m.a)(cB,"StyleBasedDocumentHeadings",
null,[406]);var As=c(988);class lw{constructor(){this.startTime=0}}Object(m.a)(lw,"TocCallbackData",null,[]);class Ep{static get TIf(){if(null!=Ep.Hkd)return Ep.Hkd;r.AFrameworkApplication.Ce("53i00313-t;gd0ad849-c");Ep.Hkd=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.NormalizeGraphAfterTOCRemoval",!1);return Ep.Hkd}constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.ldg=(Yb,Ac,Sc)=>{const nd=Ac.node;if(!nd)return w.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==nd.type)return w.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!nd.es)return 2;if(1===Sc)return ui.SessionStatusManager.instance.zj?8:32;this.Wc&&this.Wc.isFeatureEnabled(121)?this.esd.kxo(nd).then(Ad=>{Ad||this.Kqj(nd)}):this.Kqj(nd);return 32};this.FBo=Yb=>{Yb=window.performance.now()-Yb.startTime;w.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",Yb));Yb=Object.assign(new Ya.a,{durationMs:Yb});Ta.Health.instance.recordKpiSuccess(Ep.kuj,
Yb);Ep.s6a()};this.ehm=(Yb,Ac,Sc)=>{if(be.ParagraphReader.ic(Ac.node)&&Ac.node.es)return 2;if(1===Sc)return ui.SessionStatusManager.instance.zj?8:32;if(Ac.contextId!==oc.a.Vc||this.Tk.C7(Ac)||!be.ParagraphReader.ic(Ac.node))return 32;this.Ud.Ds(17);this.esd.URk(Ac);return 32};this.FXf=(Yb,Ac,Sc)=>{Yb=Ac.node;if(!Yb)return w.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==Yb.type)return w.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),
2;if(!Yb.es)return 2;if(1===Sc)return ui.SessionStatusManager.instance.zj?8:32;Sc=null;Yb.isConnected&&Ep.TIf&&(Sc=As.a.q5b(Yb,!0),Sc.djc(Yb));Ac=new yd.GraphIterator;Ac.set(Yb);Ac.Ab(8);Ac.kd(8);const nd=this.Ic.Qc(15);nd.ev(Ac);this.esd.sDn(Yb)?(nd.dispose(),Sc&&Ep.TIf&&Sc.normalize(),Ep.s6a()):(Sc&&Ep.TIf&&Sc.cancel(),nd.dispose(),w.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.S$c=h;this.Zc=y;this.Ic=P;this.Tk=aa;this.esd=ta;this.Ud=Pa;this.Wc=vb;this.zLg=
Kb;this.HC=Sb}Wb(){this.ga.pa(Oa.a.Qjc,oc.a.paragraph,this.ldg);this.ga.pa(Oa.a.Qjc,oc.a.Fd,this.ldg);this.ga.pa(Oa.a.Qjc,oc.a.Vc,this.ldg);this.ga.Xc(Oa.a.Qjc,1028);this.ga.pa(Rc.a.dtf,oc.a.Vc,this.ehm);this.ga.Xc(Rc.a.dtf,1028);this.ga.pa(Rc.a.g0c,oc.a.paragraph,this.FXf);this.ga.pa(Rc.a.g0c,oc.a.Fd,this.FXf);this.ga.pa(Rc.a.g0c,oc.a.Vc,this.FXf);this.ga.Xc(Rc.a.g0c,1028)}Kqj(b){Ta.Health.instance.recordKpiUsage(Ep.kuj,1,Ep.eD,null);const h=this.vtl(b),u=new lw;u.startTime=window.performance.now();
this.S$c.x3i(h,Lc.a.tcg,this.MYl(this.ANl(b)),this.FBo,null,u);this.esd.TCk()}lyj(b){if(null!=b&&b.es)if(null==this.zLg.instance)w.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.zLg.instance.g1h();b=this.kjl(b);var u=!1;1===this.HC.Tv&&(u=!0);0!=b&&h!=b&&(h=[Object.assign(new ca.a,{name:"TOCPageNo",string:b}),Object.assign(new ca.a,{name:"HeadingPageNo",string:h}),Object.assign(new ca.a,{name:"isPageView",string:u})],Ub.a("TOCPageNoMismatch",!0,void 0,h))}}kjl(b){for(let h=
0;h<b.qa.length;h++){const u=b.qa.J(h);if(null!=u.ff)for(let y=0;y<u.ff.length;y++){const P=u.ff.J(y);if(1===P.fm&&P.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(u.cp,b.characterData.length-u.cp))}}return 0}ANl(b){return b?b.ia(Lc.a.EM,null):(w.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}vtl(b){return this.Zc.ZCa(b,7,7).Rb(35)}MYl(b){const h=[];h.push(b+",TOC,0");return h}static s6a(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Ep.oCa)}}Ep.oCa=5E3;Ep.Hkd=null;Ep.kuj="WordUpdateTOC";Ep.eD="wwaengidc";Object(m.a)(Ep,"TableOfContentsActor",null,[408]);class fA{}Object(m.a)(fA,"FieldData",null,[]);class yh extends fA{constructor(){super();this.hob=null}}Object(m.a)(yh,"TOCFieldData",fA,[]);class ov{constructor(b,h,u,y,P,aa=null){this.P7l=b;this.at=h;this.si=
u;this.rfj=y;this.listMarker=P;this.IPa=aa}}Object(m.a)(ov,"TOCHeadingData",null,[]);class Lg{constructor(b,h){this.xUa=b;this.ul=h}eYh(b){return Object(zs.__awaiter)(this,void 0,void 0,function*(){this.xUa.Mrf=b.Nrf;this.xUa.qHb=b.qHb;this.xUa.NOb=b.NOb;return this.xUa.WEl()})}eul(b){if(b=this.dul(b))return this.ul.qfa(b)}dul(b){const h=b.qa.length;for(let u=0;u<h;u++){const y=b.qa.J(u);if(y.hyperlink&&y.hyperlink.Xfa&&y.hyperlink.url.startsWith(A.a.Kcb))return y.hyperlink.url.substr(y.hyperlink.url.indexOf("_Toc"))}return null}U7d(b){(b=
this.eul(b))&&this.ul.$_d(b.id)}FVl(){return this.xUa.TEl()}pNi(b,h){const u=new yh,y=new ob.a;for(const P of b){b=this.DVl(P,h);if(!b)return null;y.add(b)}u.hob=y;return u}DVl(b,h){let u;if(h&&(u=this.vRk(b),!u))return w.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=ro.AParagraphNode.uU(b.characterData.trim());const y=this.pXl(b.n7);return new ov(h,u,b.si,y,b.listMarker,b.IPa)}vRk(b){const h=String.format("{0}{1}","_Toc",Gc.a.lG());return this.ul.QYb(h,
b.begin,b.end,b.paragraphNode,b.paragraphNode)?h:null}pXl(b){return String.format("toc {0}",b)}}Object(m.a)(Lg,"TOCDataManager",null,[407]);class mw{U5f(){const b=Object.assign(new Gh.StandardDialog,{Qt:r.AFrameworkApplication.Qaa,Ed:0,yGa:!1});b.DU(1);b.Yha(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=mw.Wrg?mw.Wrg:mw.Wrg=new mw}}Object(m.a)(mw,"TOCDialogHelper",null,[]);var gA=c(193),dB=
c(688),nz=c(305),eB=c(170);class oz{constructor(b,h,u,y,P,aa,ta){this.V5f=b;this.rib=h;this.Nrf=u;this.qHb=y;this.NOb=P;this.uxb=aa;this.V6c=[];this.instruction=ta}toString(){return"showPageNumber:"+this.V5f+"  isHyperlink:"+this.rib+" includeOutlineLevels:"+this.Nrf+" lowerOutlineLevel:"+this.qHb+" upperOutlineLevel:"+this.NOb+" addContentControl:"+this.uxb+" unsupportedSwitches:"+this.V6c.toString()}}Object(m.a)(oz,"TOCSettings",null,[]);class Cj{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,
nd,Ad,he,ce,Nd){this.bPg="TOC";this.Pqe=this.LOe=null;this.h6a=b;this.Bh=h;this.GC=u;this.sL=y;this.Kz=P;this.Tk=aa;this.ib=ta;this.Rd=Pa;this.P8g=vb;this.ze=Kb;this.JOe=Sb;this.Yo=Ac;this.aI=Sc;this.ro=nd;this.Ic=Ad;this.Gb=he;this.Hd=ce;this.eb=Nd}get yPc(){return this.bPg}set yPc(b){this.bPg=b}get iob(){this.LOe||(this.LOe=this.KVh());return this.LOe}KVh(){return new oz(!0,!0,!0,0,8,!0,this.Njn())}URk(b){Object(zs.__awaiter)(this,void 0,void 0,function*(){Ub.a(Cj.PXk);const h=window.performance.now();
if(this.eb.ic(b.node))if(this.Tk.C7(b))w.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Cj.PPa("IP is in locked range");else{var u=yield this.h6a.eYh(this.iob);if(u){var y=new sc.a(2,1,0,()=>{this.RXk(b,u,this.iob.rib,h)});this.Gb.Xb(y)}else w.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Cj.PPa("Failed to get TOC data")}else w.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),
Cj.PPa("Context should be paragraph")})}RXk(b,h,u,y=0){let P;try{if(0==y&&(y=window.performance.now()),this.MMh(b.node)){var aa=new yd.GraphIterator;aa.set(b.node);aa.Ab(7);aa.kd(7);P=this.Ic.Qc(15);P.ev(aa);var ta=this.h6a.pNi(h,u);ta||Cj.PPa("Failed to prepare TOC Field data");var Pa=ta.hob?ta.hob.count:0;if(Pa){h=null;var vb;for(u=0;u<Pa;u++){const Ac=ta.hob.J(u);if(!({Xzb:vb}=this.zei(b,h,u,Pa,Ac,Sb?Sb.toString():void 0)).returnValue){Cj.PPa("Failed to populate new TOC paragraph");return}if(0==
u){var Kb=vb.currentNode;var Sb=be.ParagraphReader.eQ(Kb)}h=vb}if(this.iob.uxb&&!this.Z3e(Kb.id,h.Hn.id))Cj.PPa("Failed to add content control block");else{var Yb=window.performance.now()-y;Ub.a(Cj.x5e,!0,Yb)}}else if(this.JOe.U5f(),this.MSk(b)){const Ac=window.performance.now()-y;Ub.a(Cj.x5e,!0,Ac)}}else Cj.PPa("Failed to fetch style set")}catch(Ac){Cj.PPa(String.format("{0} {1}",Ac.message,Ac.stack))}finally{P&&P.dispose()}}MMh(b){this.Pqe=this.Kz.jx(b);return this.Pqe?!0:(w.ULS.sendTraceTag(592233796,
3019,15,"Failed to fetch style set"),!1)}static MEa(b){b=[Object.assign(new ca.a,{name:Cj.DBo,string:b})];Ub.a(Cj.ndg,!1,void 0,b)}static TCf(b){b=[Object.assign(new ca.a,{name:Cj.VEn,string:b})];Ub.a(Cj.VVi,!1,void 0,b)}static PPa(b){b=[Object.assign(new ca.a,{name:Cj.QXk,string:b})];Ub.a(Cj.x5e,!1,void 0,b)}kxo(b){return Object(zs.__awaiter)(this,void 0,void 0,function*(){const h=this.k5h(b);if(null==h)Cj.MEa("Cannot update TOC when firstTocPara = null");else{var u=this.HVl(h);if(0<u.V6c.length)return this.oOm(u.V6c),
!1;Ub.a(Cj.CBo);var y=window.performance.now(),P=yield this.h6a.eYh(u);if(!P)return w.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Cj.MEa("Failed to fetch TOC data"),!1;var aa=new sc.a(1,1,0,()=>{this.EBo(h,P,u,y)});this.Gb.Xb(aa);return!0}})}EBo(b,h,u,y=0){let P;try{if(null==b)Cj.MEa("Attempt to update TOC when firstTocPara = null");else{0==y&&(y=window.performance.now());var aa=new yd.GraphIterator;aa.set(b);aa.Ab(7);aa.kd(7);P=this.Ic.Qc(15);P.ev(aa);var ta=this.h6a.pNi(h,
u.rib);if(null==ta)Cj.MEa("Attempt to update TOC when tocFieldData = null");else{var Pa;if(({f_e:Pa}=this.sVi(b,u)).response){w.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",u.toString()));var vb=ta.hob?ta.hob.count:0;if(this.MMh(b)){var Kb;this.Zli(b)&&(this.UVi(b),(b=this.eb.Tg(b,!1,!0))&&(Kb=b.ia(Lc.a.Pc,null).toString()));var Sb=b.ia(Lc.a.EM,null);h=Sb;Kb=null!==Kb&&void 0!==Kb?Kb:Sb;if(vb){for(var Yb=0,Ac;b.es&&h==Sb&&Yb<vb;){const Ad=ta.hob.J(Yb);
u.rib&&this.h6a.U7d(b);if(!this.fBo(b,Yb,vb,Ad,u)){w.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Cj.MEa("Failed to update TOC paragraph");return}b.setValue(Lc.a.EM,Kb);Yb++;Ac=b;b=this.eb.Tg(Ac,!1,!0);if(!b){h=null;break}this.emi(b)&&this.TVi(b);h=b.ia(Lc.a.EM,null)}h==Sb&&this.vXf(b);var Sc;if(({oAf:Sc}=this.Ubk(ta,Yb,vb,Ac,Kb)).response)if(u.uxb&&!this.Z3e(Pa,Sc.id))Cj.MEa("Failed to add content control block");else{var nd=window.performance.now()-y;Ub.a(Cj.ndg,!0,nd)}else Cj.MEa("Failed to add new paragraph")}else this.JOe.U5f(),
this.zBo(b,u.uxb,Pa,u.instruction,Kb)&&(Yb=window.performance.now()-y,Ub.a(Cj.ndg,!0,Yb))}else Cj.MEa("Failed to fetch style set")}else Cj.MEa("Failed to remove Content Control")}}}catch(Ad){Cj.MEa(String.format("{0} {1}",Ad.message,Ad.stack))}finally{P&&P.dispose()}}Ubk(b,h,u,y,P){let aa=new yd.GraphIterator;for(aa.set(y);h<u;){y=b.hob.J(h);if(!({Xzb:y}=this.zei(null,aa,h,u,y,P)).returnValue)return{oAf:aa.currentNode,response:!1};aa=y;h++}return{oAf:aa.currentNode,response:!0}}sVi(b,h){var u,y,P;
let aa,ta;const Pa=null===(u=null===b||void 0===b?void 0:b.qa)||void 0===u?void 0:u.first.Jb;if(Pa&&0<Pa.length)if(b=b.qa.first.Jb.J(0),b.Yf){u=b.contentControlNode.getValue(Lc.a.Ox);aa=Fj.a.hk?this.Hd.Jq(b.contentControlNode.id,!0):this.Hd.Gs.get(null===(y=b.contentControlNode.id)||void 0===y?void 0:y.toString());ta=Fj.a.hk?this.Hd.Jq(b.contentControlNode.id,!1):this.Hd.Ot.get(null===(P=b.contentControlNode.id)||void 0===P?void 0:P.toString());if(0!=this.Yo.Tlb(u))return w.ULS.sendTraceTag(558952907,
3019,10,"Failed to release content control"),{response:!1,f_e:aa,yqh:ta};h.uxb=!0}else w.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.uxb=!1;else h.uxb=!1;return{response:!0,f_e:aa,yqh:ta}}zBo(b,h,u,y,P){w.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.h6a.U7d(b);const aa=this.nJd(b);if(!this.vMi(aa,h,u,y))return Cj.MEa("Failed to populate empty TOC."),!1;if(h=this.eb.Tg(b,!1,!0))u=b.ia(Lc.a.EM,null),y=h.ia(Lc.a.EM,null),u==y&&this.vXf(h);b.setValue(Lc.a.EM,
P);return!0}vMi(b,h,u,y){this.Rd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.$yi(b);this.ze.mG(b.qa.first.formatting,!0);this.k4e(b,0,1,y);return h&&u&&!this.Z3e(u,b.id)?!1:!0}nJd(b){b.qa.reset();b.FYa();const h=new gA.a(b,0);h.formatting=new eB.a(h,T.a.nil);h.Uh=!0;b.qa.add(h);return nf.a.createTextRange(b,0,b.characterData.length)}Zli(b){if(be.ParagraphReader.wT(b)){var h=b.qa.last.ff;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).fm;const u=
1===h.J(h.length-3).fm&&h.J(h.length-3).instruction.trim().startsWith(this.yPc),y=2===h.J(h.length-2).fm;h=5===h.J(h.length-1).fm;return b&&u&&y&&h}}return!1}emi(b){if(be.ParagraphReader.wT(b)){var h=b.qa.first.ff;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).fm,h=3===h.J(1).fm,b&&h}return!1}UVi(b){const h=b.qa.last.ff,u=h.J(h.length-4),y=h.J(h.length-3),P=h.J(h.length-2),aa=h.J(h.length-1);h.remove(u);h.remove(y);h.remove(P);h.remove(aa);b.removeProperty(Lc.a.EM)}TVi(b){const h=b.qa.first.ff,
u=h.J(0),y=h.J(1);h.remove(u);h.remove(y);b.removeProperty(Lc.a.EM)}vXf(b){if(b){var h=b.ia(Lc.a.EM,null),u=b.ia(Lc.a.Pc,null).toString(),y=h;u==h&&this.Zli(b)&&(this.UVi(b),(b=this.eb.Tg(b,!1,!0))&&(y=b.ia(Lc.a.EM,null)));u=new yd.GraphIterator;u.set(b);u.Ab(8);w.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var P;b&&b.es&&y==h&&P!=b;){if(this.emi(b)){this.TVi(b);break}this.h6a.U7d(b);this.ro.$d(u);y=this.ro.Jr(u,!1,!0);this.Bh.pRa(b);if(!y)return null;P=b;u.Rb(2);
y=(b=u.currentNode)?b.ia(Lc.a.EM,null):null}return b}}HVl(b){var h=b.qa,u=h?h.length:0,y=null;b=new oz(!0,!1,!1,0,8,!0,void 0);for(let P=0;P<u&&(y=this.GVl(h.J(P)),b.instruction=y,y=this.PSl(y),y[0]!==this.yPc);P++);h=y?y.length:0;for(u=1;u<h;u++)switch(y[u]){case "\\h":b.rib=!0;break;case "\\u":b.Nrf=!0;break;case "\\o":this.F_n(y[u+1],b)&&u++;break;case "\\z":break;case "\\n":b.V5f=!1;b.V6c.push(y[u]);break;default:b.V6c.push(y[u])}return b}F_n(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&
3===b.length?(h.qHb=Number.parseInvariant(b[1])-1,h.NOb=Number.parseInvariant(b[2])-1,!0):!1}sDn(b){try{Ub.a(Cj.UEn);const h=window.performance.now(),u=this.k5h(b);if(null==u){Cj.TCf("Attempt to remove TOC when firstTocPara = null");return}let y,P,aa;const ta=this.KVh();if(!({f_e:y,yqh:P}=this.sVi(u,ta)).response)return Cj.TCf("Failed to remove content control"),!1;if(void 0==y&&void 0==P)aa=this.vXf(u);else{aa=u.Jc.Db(y);const vb=new yd.GraphIterator;vb.set(aa);vb.Ab(8);b=!1;let Kb;for(;!b&&aa&&
Kb!=aa;){aa.id.equals(P)&&(b=!0);aa&&aa.es&&this.h6a.U7d(aa);this.ro.$d(vb);const Sb=this.ro.Jr(vb,!1,!0);this.Bh.pRa(aa);if(!Sb){aa=null;break}vb.Rb(2);Kb=aa;aa=vb.currentNode}}aa&&this.oVc(aa);const Pa=window.performance.now()-h;Ub.a(Cj.VVi,!0,Pa)}catch(h){Cj.TCf(String.format("{0} {1}",h.message,h.stack))}return!0}oVc(b){b=nf.a.Uc(b,0);b=new Bq.Selection([b],!0);this.ib.setSelection(b)}Z3e(b,h){return this.Yo.Cka(b,h,null,Cj.Q7k,!0).returnValue?(w.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),
!1):!0}TCk(){this.h6a.FVl()||this.JOe.U5f()}k5h(b){if(!b.es)return w.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(Lc.a.EM,null);return this.aI.KNl(b)}oOm(b){b.length&&(b=[Object.assign(new ca.a,{name:"UnsupportedSwitches",string:b.toString()})],Ub.a("UnsupportedTocInstruction",void 0,void 0,b))}GVl(b){const h=(b=b.ff)?b.length:0;for(let u=0;u<h;u++)if(1===b.J(u).fm&&b.J(u).instruction.trim().startsWith(this.yPc))return b.J(u).instruction.trim();
return null}PSl(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}MSk(b){b=this.uAh(b,null,!0,void 0).returnValue;if(!b)return Cj.PPa("Failed to create paragraph"),!1;const h=nf.a.Uc(b,0);if(!this.vMi(h,!0,b.id,this.iob.instruction))return Cj.PPa("Failed to populate empty TOC"),!1;w.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}uAh(b,h,u,y){let P,aa;u&&b?(P=this.bTk(b),aa=P.currentNode,y=be.ParagraphReader.eQ(aa).toString()):h&&(P=this.WKl(h),aa=
this.Bh.GN(P));if(!aa)return w.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,Xzb:P};aa.setValue(Lc.a.EM,y);return{returnValue:aa,Xzb:P}}Njn(){const b=new Sys.StringBuilder(this.yPc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}akn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.iob.rib&&h.append(" \\h");return h.toString()}WKl(b){b.zd();this.ro.$d(b);return this.Bh.bna(b,!1)}bTk(b){const h=new yd.GraphIterator;
h.set(b.node);h.zd();this.ro.$d(h);let u=this.R_h(h);const y=!b.cpBegin;if(wg.OutlineElementReader.isEmpty(h,!0))return this.mei(u);if(y)return this.Bh.pD(u,!0,!1),this.Bh.P8(h,u,b,!1,!1,!1),b=this.R_h(u),this.mei(b);u=this.Bh.bna(h);this.Bh.P8(h,u,b,!1,!1,!0);b=this.Bh.bna(h);this.Bh.kMb(b.currentNode,!1);this.Bh.GN(b);this.ro.Ee(b);return b}R_h(b){const h=new yd.GraphIterator;h.ed(b);h.zd();return h}mei(b){this.Bh.pD(b,!0,!0);this.Bh.kMb(b.currentNode,!1);this.ro.Ee(b);return b}$yi(b){const h=b.qa;
1===h.length&&(h.first.Uh=!1,b.bFd().Uh=!0)}fBo(b,h,u,y,P){const aa=this.nJd(b);this.Rd.replaceTextRange(aa,"");this.zMi(b,y,P);this.k4e(b,h,u,P.instruction);return P.rib&&!this.eH(b,y.at)?!1:!0}zei(b,h,u,y,P,aa){h=({Xzb:b}=this.uAh(b,h,0==u,aa)).returnValue;if(!h)return{returnValue:!1,Xzb:b};this.zMi(h,P,this.iob);this.k4e(h,u,y,this.iob.instruction);return this.iob.rib&&!this.eH(h,P.at)?{returnValue:!1,Xzb:b}:{returnValue:!0,Xzb:b}}zMi(b,h,u){this.Tfm(b,h.P7l,h.listMarker,h.rfj,h.IPa);this.P8g.ohm(b,
b.characterData.length);u.V5f&&this.Kgm(b,h);this.$yi(b);this.Y1n(b,h.rfj)}CIl(b,h){if(!b)return 0;const u=Cj.qXl();return 4<b.length?u.J(h)+.5*Math.floor(b.length/3):u.J(h)}Tfm(b,h,u,y,P){u&&this.ggm(b,u,y);u=nf.a.Uc(b,b.characterData.length);this.Rd.replaceTextRange(u,h);P&&(b=b.qa.ei(0),this.ze.S_(b.formatting,P))}ggm(b,h,u){u=this.CIl(h,u);const y=nf.a.Uc(b,0);this.Rd.replaceTextRange(y,h);this.P8g.hgm(b,h.length,u)}Kgm(b,h){var u=nf.a.Uc(b,b.characterData.length);this.Rd.replaceTextRange(u,h.si.toString());
u=b.qa.ei(b.characterData.length-h.si.toString().length);h=this.akn(h.at);this.FOa(b,u,0,2,h);this.FOa(b,u,1,2,h);this.FOa(b,u,2,2,h);u=b.qa.ei(b.characterData.length);this.FOa(b,u,3,2,h)}Y1n(b,h){h=this.Pqe.fh(h);this.sL.QK(h,b,!0)}k4e(b,h,u,y){const P=b.qa.first,aa=b.qa.last;h?this.FOa(b,P,4,1,y):(this.FOa(b,P,0,1,y),this.FOa(b,P,1,1,y),this.FOa(b,P,2,1,y));h===u-1?this.FOa(b,aa,3,1,y):this.FOa(b,aa,5,1,y)}FOa(b,h,u,y,P=null){u=new dB.a(h,null,u,y,!0,!1,!1,P);h.ff||(h.ff=new nz.a(h));h.ff.add(u);
b.Cn();this.uYk(u,b)}uYk(b,h){b.Je?h.wordRunProperties.WZ(b.Je-1,2):h.wordRunProperties.lva(b.Je,2);h.wordRunProperties.Sq.Z(b.Je,ys.CharacterPropertiesEditor.IQ);h.wordRunProperties.rt.Z(b.Je,ys.CharacterPropertiesEditor.hU)}eH(b,h){b=nf.a.createTextRange(b,0,b.characterData.length);return this.GC.eH(b,h,!1,!1,!1,!0)?!0:(w.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static qXl(){Cj.lsa||(Cj.lsa=new Tb.a,Cj.lsa.Z("toc 1",1),Cj.lsa.Z("toc 2",1.5),
Cj.lsa.Z("toc 3",2),Cj.lsa.Z("toc 4",2.5),Cj.lsa.Z("toc 5",3),Cj.lsa.Z("toc 6",3.5),Cj.lsa.Z("toc 7",4),Cj.lsa.Z("toc 8",4.5),Cj.lsa.Z("toc 9",5));return Cj.lsa}}Cj.lsa=null;Cj.Q7k="Table of Contents";Cj.PXk="CreateTocClient";Cj.x5e="CreateTocSuccess";Cj.QXk="CreateTocFailureCause";Cj.CBo="UpdateTocClient";Cj.ndg="UpdateTocSuccess";Cj.DBo="UpdateTocFailureCause";Cj.UEn="RemoveTocClient";Cj.VVi="RemoveTocSuccess";Cj.VEn="RemoveTocFailureCause";Object(m.a)(Cj,"TOCField",null,[404,405]);var Nn=c(648);
class uy{constructor(b,h){this.$ya=b;this.$Ha=h}ohm(b,h){if(be.ParagraphReader.ic(b)&&!(0>h)){var u=so.a.N_b(b);u=new Nn.a(u,4,1,1);this.$ya.MQd(b,u);b=nf.a.Uc(b,h);this.$Ha.$Qd(b)}}hgm(b,h,u){var y=Fg.a.qI/2;const P=b.qa.qCb(h);y=Wi.FormattingReader.Um(P.formatting,Ge.a.fontSize,2*y)/2;u=new Nn.a(Xf.a.Xy(y/36)*u,1,0,1);this.$ya.MQd(b,u);b=nf.a.Uc(b,h);this.$Ha.$Qd(b)}}Object(m.a)(uy,"TOCTabUtility",null,[401]);class ax{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}xc(b){this.W=
b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new $w.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Lv.a.VP)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new cB(new Zf.a(()=>Ra.App.xa.jb.Yc),xl.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new zr.a,new Zf.a(()=>Ra.App.xa.jb.wc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new Lg(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new uy(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new Cj(this.W.resolve("Box4.ITOCDataManager"),
this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),sd.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),mw.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Pa("WordEditor.ParagraphWordIdMapping"),
this.W.resolve("Box4.IOutlineElementNavigator"),oi.a.instance,r.AFrameworkApplication.uc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new Ep(r.AFrameworkApplication.ya,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),oi.a.instance,
sd.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Za("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Wb()}dispose(){}}Object(m.a)(ax,"PackageManager",null,[1,2]);class Id{constructor(b,h,u,
y,P,aa,ta,Pa){this.YQa=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:vb}=this.gnb(Kb,Sb,Ac,!0,!0)).returnValue)return vb;this.vrd.Fzh(Ac,Kb.node);return 32};this.Qwa=(vb,Kb,Sb,Yb,Ac)=>this.G9h(Kb,Sb,Yb,Ac,!0);this.yJb=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:vb}=this.gnb(Kb,Sb,Ac,!1,!0)).returnValue)return vb;this.vrd.MUk(Ac,Kb.node);w.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Oka=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:Yb}=this.gnb(Kb,Sb,Ac,!1,!0)).returnValue)return 2==Sb&&8==Yb&&Tt.a.recordQosError("TableStyleButtonClickNoResponse",
["TableInteractionFailed"],Zc.a.mBb),Yb;const Sc=Kb.node;let nd=null;(nd=vb===Oa.a.Oka?this.vrd.gPb(Ac[ag.a.SourceControlId],Sc):this.Kx.mDb(Sc,Ac))?(this.c4d(Sc,()=>{this.ttd.$Ra(nd,Sc)}),this.MO(),Yb=32):(Tt.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Zc.a.mBb),Yb=8);vb===Oa.a.Oka&&32===Yb&&w.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");w.ULS.shipAssertTag(0,324,32===Yb);return Yb};this.Qsa=(vb,Kb,Sb,Yb,Ac)=>this.G9h(Kb,Sb,Yb,Ac,!1);this.Qee=(vb,
Kb,Sb,Yb,Ac)=>Ur.a.yoa(vb,Kb,Sb,Yb,Ac,{},14);this.Wyb=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:vb}=this.gnb(Kb,Sb,Ac,!1,!1)).returnValue)return vb;const Sc=Kb.node;this.c4d(Sc,()=>{this.ttd.Wsh(Sc)});return 32};this.Kx=b;this.vrd=h;this.ga=u;this.ttd=y;this.Ic=P;this.zz=aa;this.oSj=Pa}Wb(){this.fec(Ra.App.GSa.hzh())}fec(b){this.ga.pa(Oa.a.YQa,oc.a.view,b);this.ga.pa(Oa.a.YQa,oc.a.table,this.YQa);this.ga.Xc(Oa.a.YQa,1127);this.ga.pa(Oa.a.Oka,oc.a.view,this.Qee);this.ga.pa(Oa.a.Oka,oc.a.table,this.Oka);this.ga.Xc(Oa.a.Oka,
1030);this.ga.pa(Oa.a.applyStyle,oc.a.table,this.Oka);this.ga.pa(Oa.a.Qsa,oc.a.view,this.Qee);this.ga.pa(Oa.a.Qsa,oc.a.table,this.Qsa);this.ga.Xc(Oa.a.Qsa,1038);this.ga.pa(Oa.a.Qwa,oc.a.view,b);this.ga.pa(Oa.a.Qwa,oc.a.table,this.Qwa);this.ga.Xc(Oa.a.Qwa,1127);this.ga.pa(Oa.a.yJb,oc.a.view,b);this.ga.pa(Oa.a.yJb,oc.a.table,this.yJb);this.ga.Xc(Oa.a.yJb,1126);this.ga.pa(Oa.a.Wyb,oc.a.view,this.Qee);this.ga.pa(Oa.a.Wyb,oc.a.table,this.Wyb);this.ga.Xc(Oa.a.Wyb,1028)}MO(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}G9h(b,h,u,y,P){if(!({Lx:aa}=this.gnb(b,h,y,P,!0)).returnValue)return 2==h&&8==aa&&Tt.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],Zc.a.Vfl),aa;b=b.node;h=this.Kx.pT(b);var aa=y[ag.a.On];const ta=Id.$Vl(y.MenuItemId);P?y[ag.a.On]=Id.z7n(h,ta):(this.Vmk(h,ta,aa,b),u.Xr=
ta,u.RB=aa?0:1,w.ULS.shipAssertTag(0,324,!!ta));return 32}c4d(b,h){const u=this.Ic.Qc(15);try{u.Eb(b),this.zz.E4a(),h()}finally{u&&u.dispose()}}gnb(b,h,u,y,P){return this.rxm(b,h,u,y,P)?{returnValue:y||2===h,Lx:32}:{returnValue:!1,Lx:8}}rxm(b,h,u,y,P){if(b.contextId!==oc.a.table)return!1;if(y||2===h)if(P&&!u||!Object(jb.a)(aq.TableNode,b.node)||this.oSj(b.node))return!1;return!0}Vmk(b,h,u,y){const P=(512===h||1024===h?!u:u)?b|h:b&~h;P!==b&&this.c4d(y,()=>{this.ttd.ipa(P,y)})}static nA(){Id.ubb[Id.skl]=
32;Id.ubb[Id.jkl]=128;Id.ubb[Id.vBm]=64;Id.ubb[Id.mBm]=256;Id.ubb[Id.yqk]=512;Id.ubb[Id.xqk]=1024}static z7n(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static $Vl(b){let h=0;b in Id.ubb&&(h=Id.ubb[b]);return h}}Id.skl="buttonFirstRow";Id.jkl="buttonFirstColumn";Id.vBm="buttonLastRow";Id.mBm="buttonLastColumn";Id.yqk="buttonBandedRow";Id.xqk="buttonBandedColumn";Id.ubb={};Object(m.a)(Id,"TableStyleActor",null,[]);Id.nA();var Dx=c(773),Ii=c(447);class hA extends Ii.a{constructor(){super();this.TableStyles=
this.TableCellStyles=null;this.columns=0}}Object(m.a)(hA,"TableGalleryButtonProps",Ii.a,[]);class vy extends hA{constructor(){super()}get Type(){return 6}}Object(m.a)(vy,"TableStyleGalleryButtonProps",hA,[]);class iA{}iA.NYm=2147483647;Object(m.a)(iA,"TableStyleUtil",null,[]);class ct{constructor(b,h,u){this.w0e="Clear";this.jBb=null;this.q4j=b;this.me=h;this.Kx=u;this.mQ=r.AFrameworkApplication.mQ;this.Cr=r.AFrameworkApplication.Cr}ZZa(){}kak(b,h){this.ZZa(b);const u=this.gSh(b),y=u.length;if(!(0>=
y)){var P=iA.NYm,aa=null;for(let vb=0;vb<y;vb++){var ta=u[vb],Pa=this.Kx.mWl(ta);P!==Pa&&(P=Object.assign(new xi.a,{Id:"msMoreTableStyles"+Pa,Title:this.nWl(Pa),ControlList:[]}),aa=Object.assign(new vs.a,{Type:6,Id:"galleryMoreTableStyles"+Pa,ExternalGalleryId:"TableStylesGallery",Width:ct.f8f,ElementDimensions:"Size64by48",GalleryItems:[]}),this.jBb&&(aa.ExternalId=this.jBb[Pa.toString()]),P.ControlList.push(aa),h.MenuSectionList.push(P),P=Pa);Pa=this.me.WF(ta);ta=ct.p9f+vb;Pa=Object.assign(new vy,
{Id:ta,ExternalId:ta,Command:Oa.a.Oka.toString(),QueryCommand:Oa.a.YQa.toString(),LabelText:Pa?A.a.Cf(Pa):"",Alt:Pa,VerticalCenterAlign:"true"});Pa.TableCellStyles=this.KMd(ta,b);Pa.TableStyles=this.uMc(ta,b);aa&&aa.GalleryItems.push(Pa)}}}jak(b){const h=Object.assign(new xi.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),u=Object.assign(new Qe.a,{Id:"fseaClearTableFormatting",Command:Oa.a.Wyb.toString(),LabelText:A.a.Cf(this.w0e),Alt:A.a.Cf(this.w0e),
Image16by16:this.Cr,Image16by16Class:Gd.getImageClassWithCluster(this.mQ,ct.wGk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(u);b.MenuSectionList.push(h)}Fzh(b,h){this.ZZa(h);const u=b[ag.a.SourceControlId];var y=this.gPb(u,h);if(y){var P=this.Kx.Zz(h);P=P?this.me.qf(P):null;var aa=this.me.WF(y);y=this.me.qf(y);b[Bi.a.Alt]=aa;b[Bi.a.On]=y===P;h=Object.assign(new vy,{Id:u,ExternalId:u,Command:Oa.a.Oka.toString(),QueryCommand:Oa.a.YQa.toString(),TableCellStyles:this.KMd(u,
h),TableStyles:this.uMc(u,h),Alt:aa});b[Bi.a.GalleryButtonProps]=h}else b[Bi.a.InnerHTML]=null,b[Bi.a.Alt]=null,b[Bi.a.On]=!1,b[Bi.a.GalleryButtonProps]=null}KMd(b,h){this.ZZa(h);return(b=this.gPb(b,h))?this.q4j.ETh(b,h):null}uMc(b,h){this.ZZa(h);return this.gPb(b,h),null}MUk(b,h){b.MenuItems=this.vKl(h)}vKl(b){const h=Object.assign(new $f.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.kak(b,h);this.jak(h);return h}gPb(b,h){return b?b.startsWith(ct.p9f)?this.gof(parseInt(b.substr(ct.p9f.length)),
h):this.oLn(parseInt(b.substr(ct.Kjo.length)),h):null}}ct.p9f="buttonTableStyleMenu";ct.Kjo="buttonTableStyleRibbon";ct.f8f=7;ct.wGk="ClearTableStyle_16x16x32";Object(m.a)(ct,"ATableStyleRibbonControl",null,[411]);class jA extends ct{constructor(b,h,u){super(null,h,u);this.U7g=b}Fzh(b,h){this.ZZa(h);const u=b[ag.a.SourceControlId];var y=this.gPb(u,h);if(y){var P=this.Kx.Zz(h);P=P?this.me.qf(P):null;var aa=this.me.WF(y);y=this.me.qf(y);b[Bi.a.Alt]=aa;b[Bi.a.On]=y===P;h=Object.assign(new vy,{Id:u,ExternalId:u,
Command:Oa.a.Oka.toString(),QueryCommand:Oa.a.YQa.toString(),TableCellStyles:this.KMd(u,h),TableStyles:this.uMc(u,h),Alt:aa});b[Bi.a.GalleryButtonProps]=h}else b[Bi.a.InnerHTML]=null,b[Bi.a.Alt]=null,b[Bi.a.On]=!1,b[Bi.a.GalleryButtonProps]=null}KMd(b,h){this.ZZa(h);return(b=this.gPb(b,h))?this.U7g.ETh(b,h,5,5):null}uMc(b,h){this.ZZa(h);return this.gPb(b,h),null}}Object(m.a)(jA,"ATableStyleRibbonControlVariableSizePreviews",ct,[]);var wy=c(1426),kA=c(1084);class uj{constructor(b,h,u,y){this.vul=(P,
aa)=>this.getBorder(P,this.qY.WL(aa));this.uul=(P,aa)=>this.getBorder(P,this.qY.XN(aa));this.Kz=b;this.Mu=h;this.bXa=u;this.qY=y;this.IFj=new Zf.a(()=>this.tul());this.b8a=new Zf.a(()=>this.sul())}tul(){const b={},h=r.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}sul(){const b={};b[pi.a.pBa]=pi.a.Pcb;b[pi.a.Pcb]=
pi.a.Pcb;b[pi.a.jYa]=pi.a.jYa;return b}WRk(b,h,u,y){const P=new kA.a;P.rowCount=u;P.tdb=y;P.tSa=this.bXa.yVl(b);P.Ha=b.ia(Lc.a.Ha,1);P.Ga=b.ia(Lc.a.Ga,1);P.tableLook=h;P.Kee=1;return P}ETh(b,h,u,y){if(!this.Kz.qf(b)||!Object(jb.a)(114,b)||!Object(jb.a)(Pp.a,h))return null;const P=this.Mu.pT(h);u=this.WRk(b,P,u,y);y=[];for(u.rowIndex=0;u.rowIndex<u.rowCount;u.rowIndex++)this.ock(b,h,u,y);return y}uMc(){return null}h3(){}ock(b,h,u,y){u.j7b=!u.rowIndex;for(u.cellIndex=0;u.cellIndex<u.tdb;u.cellIndex++)this.O9j(b,
h,u,y)}O9j(b,h,u,y){h=this.bXa.mLk(u,this.bXa.ehf(u),h,b);const P={};var aa=this.Mu.YId(b,h,Ge.a.fontColor,!0,Mn.a.SN(),"None");P.color=aa?aa:"inherit";aa=this.Mu.YId(b,h,Ge.a.wF,!0,Mn.a.SN(),"None");P["background-color"]=aa?aa:"inherit";this.Sck(u,b,h,P);y.push(P)}Sck(b,h,u,y){b=this.bXa.CNa(b);this.uud(5,b,h,u,y);this.uud(3,b,h,u,y);this.uud(0,b,h,u,y);this.uud(4,b,h,u,y)}uud(b,h,u,y,P){h=this.mBl(b,h,u,y);h!==pi.a.qF&&(P[this.IFj.value[wy.a[b]]]=h)}mBl(b,h,u,y){let P=pi.a.qF;if(({Uka:P}=this.lHa(y,
b,1,h,this.uul,P)).returnValue)return P;({Uka:P}=this.lHa(u,b,3,h,this.vul,P));return P}lHa(b,h,u,y,P,aa){return this.qY.e$i(u,h,y)&&(aa=P(b,h))!==pi.a.qF||!h&&({Uka:aa}=this.lHa(b,1,u,y,P,aa)).returnValue||4===h&&({Uka:aa}=this.lHa(b,2,u,y,P,aa)).returnValue?{returnValue:!0,Uka:aa}:{returnValue:aa!==pi.a.qF,Uka:aa}}getBorder(b,h){let u="",y,P;({borderStyle:y,borderWidth:P}=this.xul(b,h));if(y===pi.a.jYa)return u;u=String.format(pi.a.Vwd,P,y,this.mul(b,h));return u.trim()}mul(b,h){if(!h)return pi.a.oZ;
b=this.Mu.qBb(b,h.color,rn.a.auto);return b!==rn.a.auto?rn.a.jE(b):pi.a.oZ}xul(b,h){var u=pi.a.Xsa;let y=pi.a.rF+pi.a.x_b;if(!h)return{borderStyle:u,borderWidth:y};u=this.Mu.qBb(b,h.style,pi.a.jYa);b=this.Mu.qBb(b,h.size,pi.a.rF);y=this.wul(u,b)+pi.a.x_b;u=this.nul(u);return{borderStyle:u,borderWidth:y}}wul(b,h){let u=2;b===pi.a.u_b&&h<pi.a.Tka&&(u=1);return u}nul(b){return this.b8a.value[b]||pi.a.v_b}static oWl(){return new uj(Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ja.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Ar.a.instance,pi.a.instance)}static get instance(){return null!=uj.erg?uj.erg:uj.erg=uj.oWl()}}Object(m.a)(uj,"TableStylePreviewGenerator",null,[412]);var bx;(function(b){b[b.tQo=0]="background1";b[b.s0o=1]="text1";b[b.uQo=2]="background2";b[b.t0o=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.NTo=11]="followedHyperlink";b[b.KRo=12]="dark1";b[b.WVo=13]=
"light1";b[b.LRo=14]="dark2";b[b.XVo=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(bx||(bx={}));Object(m.b)("ThemeColor",bx);class nw{constructor(b){this.Oza=b}wsl(b,h,u){let y;({gRi:h,Wkh:y}=this.JQl(h));b=[];const P=[];for(let ta=0;16>ta;ta++){if(!(bx[ta]in u.zwb))continue;const Pa=ta,vb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[y[Pa]],this.wHl(ta));var aa=h[Pa];aa=aa&4278190080|(aa&255)<<16|aa&65280|(aa&16711680)>>>16;P.push(Object.assign(new ol.a,
{Color:Pa.toString(),DisplayColor:"#"+A.a.nI(aa,6),Alt:A.a.Cf(vb)}));b[b.length]=ta}return{returnValue:P,Klo:b}}wHl(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;
case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}JQl(b){let h=null,u=null;b=this.Oza(b);if(!b)return{gRi:h,Wkh:u};h=b.properties.ia(Lc.a.themeColors,null);u=b.properties.getValue(Lc.a.xfe).split(" ");return{gRi:h,Wkh:u}}static qWl(){return new nw(Object(v.a)(nw.mh,nw.mh.Wt,"navigateToPageContentNode"))}static get mh(){return xl.PageNavigator.instance}static get instance(){return null!=nw.xrg?nw.xrg:nw.xrg=nw.qWl()}}Object(m.a)(nw,
"TableStyleThemeHelper",null,[429]);var Yt=c(854);class Ex{constructor(b,h){this.PNe={};this.zwb={};this.me=b;this.Kx=h}Xaf(b,h){const u=this.PNe[bx[h]];return u&&u.length?u:this.tql(b,h)}PYh(b,h,u){if(h=this.Xaf(h,u))for(b=this.me.qf(b),u=0;u<h.length;u++)if(this.me.qf(h[u])===b)return u;return-1}h3(){this.PNe={};this.zwb={}}tql(b,h){const u=[];this.zwb={};b=this.Kx.$Na(b);this.Pvd(u,this.zwb,0,h,b);this.Pvd(u,this.zwb,1,h,b);this.Pvd(u,this.zwb,2,h,b);this.Pvd(u,this.zwb,3,h,b);return this.PNe[bx[h]]=
u}Pvd(b,h,u,y,P){const aa=P.GL;for(let ta=0;ta<aa;ta++){const Pa=P.Hfa(ta);if(3!==this.me.lx(Pa))continue;const vb=this.Kx.lWl(Pa),Kb=this.Kx.tMc(Pa);h[bx[Kb]]=!0;vb!==u||Kb!==y&&16!==Kb||this.me.qf(Pa)===Yt.a.E8c||(b[b.length]=Pa)}}static VZl(){return new Ex(Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ja.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static nYk(){return Ex.VZl()}}Object(m.a)(Ex,"WACTableStyleRibbonList",null,[427]);class vo extends jA{constructor(b,h,u,y,P){super(b,
h,u);this.CRb=4;this.Prd=[];this.Cim=()=>{this.yYb.h3();this.U7g.h3()};this.r4j=P;this.yYb=y;this.w0e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.Yhn()}QRk(b,h){b.MenuItems=this.Cpl(h)}Yhn(){this.jBb={};this.jBb["0"]="CustomTableStyles";this.jBb["1"]="PlainTableStyles";this.jBb["2"]="GridTableStyles";this.jBb["3"]="ListTableStyles"}Cpl(b){const h=Object.assign(new $f.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.Fwm(b))return h;const u=Object.assign(new xi.a,{Id:"msTableStyleTheme",
ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),y=Object.assign(new Dx.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Rc.a.ucb.toString(),QueryCommand:Rc.a.qKb.toString(),Width:vo.Llo});y.Colors=({Klo:this.Prd}=this.r4j.wsl(this.Prd,b,this.yYb)).returnValue;u.ControlList.push(y);h.MenuSectionList.push(u);return h}ZZa(b){if(b=this.Kx.Zz(b))b=this.Kx.tMc(b),16!==b&&(this.CRb=b)}gSh(b){return this.yYb.Xaf(b,this.CRb)}gof(b,h){h=this.yYb.Xaf(h,this.CRb);return 0>b||
b>=h.length?null:h[b]}oLn(b,h){var u=this.Kx.Zz(h);u=this.yYb.PYh(u,h,this.CRb);u=-1!==u?Math.floor(u/ct.f8f)*ct.f8f:0;return this.gof(u+b,h)}nWl(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}Fwm(b){this.ZZa(b);return 0>=this.gSh(b).length}xBo(b,
h){if(!b||!h)return null;b=parseInt(b[Up.Color]);var u=this.Kx.Zz(h);const y=this.Kx.tMc(u);if(y===b)return null;if(16===y)return this.CRb=b,null;u=this.yYb.PYh(u,h,y);this.CRb=b;return this.gof(u,h)}Y3k(b){b=this.Kx.Zz(b);b=this.Kx.tMc(b);if(16!==b)for(let h=0;h<this.Prd.length;h++)if(this.Prd[h]===b)return h;return-1}iZb(b){b.eSe(this.Cim,2)}static pWl(){return new vo(uj.instance,Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ja.a.instance.resolve("WordEditor.IWACTableStyleReader"),Ex.nYk(),
nw.instance)}static get instance(){return null!=vo.bsg?vo.bsg:vo.bsg=vo.pWl()}}vo.Llo=4;Object(m.a)(vo,"TableStyleRibbonControls",jA,[410,411]);var lA=c(1518);class Ht extends Id{constructor(b,h,u,y,P,aa,ta,Pa){super(b,h,u,y,P,aa,ta,Pa);this.ldc=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:vb}=this.gnb(Kb,Sb,Ac,!1,!0)).returnValue)return vb;this.q9f.QRk(Ac,Kb.node);return 32};this.ucb=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:vb}=this.gnb(Kb,Sb,Ac,!1,!0)).returnValue)return 2==Sb&&8==vb&&Tt.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],Zc.a.Wfl),vb;const Sc=Kb.node,nd=this.q9f.xBo(Ac,Sc);nd&&this.c4d(Sc,()=>{this.ttd.$Ra(nd,Sc)});return 32};this.qKb=(vb,Kb,Sb,Yb,Ac)=>{if(!({Lx:vb}=this.gnb(Kb,Sb,Ac,!0,!0)).returnValue)return vb;Ac[Up.IndexColorSelected]=this.q9f.Y3k(Kb.node);return 32}}fec(b){super.fec(b);this.ga.pa(Rc.a.ucb,oc.a.view,this.Qee);this.ga.pa(Rc.a.ucb,oc.a.table,this.ucb);this.ga.Xc(Rc.a.ucb,1030);this.ga.pa(Rc.a.ldc,oc.a.view,b);this.ga.pa(Rc.a.ldc,oc.a.table,this.ldc);this.ga.Xc(Rc.a.ldc,
1126);this.ga.pa(Rc.a.qKb,oc.a.view,b);this.ga.pa(Rc.a.qKb,oc.a.table,this.qKb);this.ga.Xc(Rc.a.qKb,1127)}get q9f(){return this.vrd}static kWl(){return new Ht(Ja.a.instance.resolve("WordEditor.IWACTableStyleReader"),vo.instance,r.AFrameworkApplication.ya,lA.a.instance,new oi.a,Ja.a.instance.resolve("Box4.IInsertionPointFormatting"),Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(v.a)(sd.a.instance,sd.a.instance.Xib,"isTableNodeInLockedRange"))}static get instance(){return null!=
Ht.lrg?Ht.lrg:Ht.lrg=Ht.kWl()}}Object(m.a)(Ht,"TableStyleActor",Id,[]);var fB=c(1569);class Hj{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}xc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>uj.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>fB.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>lA.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>
{this.$m()})}$m(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(Ht.instance.Wb(),vo.instance.iZb(Aw.a.instance),hl.StyleReader.Ree=fB.a.instance,Ra.App.xa.updateCommandUI())}dispose(){}}Object(m.a)(Hj,"TableStylePackage",null,[1,2]);var Rp=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},
children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",
LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",
QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},
children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",
Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",
Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",
Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},NB=c(1422);class wh{constructor(b,h){this.vJa=b;this.Vya=h}nAn(b){this.vJa.dvd(b)}MBa(b){this.Vya.MBa(b)}EMb(b,
h){return this.Vya.EMb(b,h)}DMb(b,h){return this.Vya.DMb(b,h)}ige(b,h,u){this.Vya.ige(b,h,u)}}Object(m.a)(wh,"ClientPaginationHeaderFooterBridge",null,[460]);class ns{constructor(b,h){this.Rl=b;this.ga=h;this.S9=new kl.a;this.T9=new kl.a}MBa(b){b=yd.GraphIterator.$a(b);if(b.jo()&&b.Sp()){b.Vd();do 10===b.ef&&this.WQf(b.currentNode),b.ht();while(8!==b.ef)}}EMb(b,h){var u=this.gDb(h);if(!this.S9.ub(u))return w.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
u),!1;h=this.S9.J(u);w.ULS.shipAssertTag(573400389,336,this.T9.ub(u),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");u=this.T9.J(u);return this.aqf(h,b,u)}DMb(b,h){var u=this.gDb(h);if(!this.S9.ub(u))return w.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+u),!1;h=this.S9.J(u);w.ULS.shipAssertTag(573400391,336,this.T9.ub(u),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
u=this.T9.J(u);return this.aef(h,b,u)}ige(b,h,u){h=this.mnf(h,u);this.ga.Ub(b?Rc.a.Die:Rc.a.i8c,2,h)}mnf(b,h){h=this.Rl.tCb(h);if(!h)return w.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.Rl.Jfa(h);const u=1===b;b=!(b%2);return 1===h?1:2===h?u?2:1:3===h?b?3:4:u?2:b?3:4}WQf(b){if(10===b.type){var h=new kl.a,u=this.Rl.tCb(b);w.ULS.shipAssertTag(573400393,336,!!u,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var y=this.Rl.Jfa(u);b=this.gDb(b);this.fdg(b,y);this.edg(b,h);u=yd.GraphIterator.$a(u);if(u.Sp()){u.Vd();do b=u.currentNode,y=this.Rl.dLc(b),b=this.Rl.eai(b),h.add(y,b),u.ht();while(36===u.ef)}}}fdg(b,h){this.T9.ub(b)?this.T9.Z(b,h):this.T9.add(b,h)}edg(b,h){this.S9.ub(b)?this.S9.Z(b,h):this.S9.add(b,h)}gDb(b){w.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(Lc.a.Hha,0)}aqf(b,h,u){const y=1===h;h=!(h%2);switch(u){case 2:if(y){if(b.ub(2))return b.J(2)}else if(b.ub(0))return b.J(0);
break;case 3:if(h){if(b.ub(1))return b.J(1)}else if(b.ub(0))return b.J(0);break;case 4:if(y){if(b.ub(2))return b.J(2)}else if(h){if(b.ub(1))return b.J(1)}else if(b.ub(0))return b.J(0);break;case 1:if(b.ub(0))return b.J(0)}return!1}aef(b,h,u){const y=1===h;h=!(h%2);switch(u){case 2:if(y){if(b.ub(5))return b.J(5)}else if(b.ub(3))return b.J(3);break;case 3:if(h){if(b.ub(4))return b.J(4)}else if(b.ub(3))return b.J(3);break;case 4:if(y){if(b.ub(5))return b.J(5)}else if(h){if(b.ub(4))return b.J(4)}else if(b.ub(3))return b.J(3);
break;case 1:if(b.ub(3))return b.J(3)}return!1}}Object(m.a)(ns,"ClientPaginationPageAdornmentContentManager",null,[459]);class Fx{constructor(b,h,u,y,P,aa){this.dMk=ta=>{1===ta&&this.OD.RD&&(ta=this.Zc.ZCa(this.OD.RD,8,8),this.Rl.$zk(ta)?this.F1k(ta):this.t9n())};this.Iso=ta=>{1===ta&&this.ga.Ub(Oa.a.openInClient,2,!1)};this.OD=b;this.Rl=h;this.Zc=u;this.Ic=y;this.Oqc=P;this.ga=aa}H9n(){const b=new Gh.StandardDialog;b.Ed=1;b.Ue(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.DU(0);b.xv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.dMk)}F1k(b){b.kd(8);const h=this.Ic.Qc(15);h.set(b.Hn.Wi);this.Oqc.wCn(b);this.OD.dismiss();h.dispose();w.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}t9n(){const b=new Gh.StandardDialog;b.Ed=1;b.Ue(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ue(0,CommonUIStrings.l_Close);b.DU(0);b.xv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.Iso);w.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(m.a)(Fx,"DeleteHeaderFooterDialog",null,[]);class Ps{constructor(b,h,u,y,P){this.Rl=b;this.Zc=h;this.Ic=u;this.Oqc=y;this.ga=P}create(b){return new Fx(b,this.Rl,this.Zc,this.Ic,this.Oqc,this.ga)}}Object(m.a)(Ps,"DeleteHeaderFooterDialogFactory",null,[458]);class xy{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.C9=null;this.T$f=(Sb,Yb,Ac,Sc,nd)=>{var Ad=this.kof(Yb);return Ad?1===Ac?32:(Ac=this.control)?
(Yb=this.Ic.Qc(15),Yb.Eb(Ad),Yb.Kk=Sb,Ac.gaa?this.ga.processAction(Rc.a.ZS,2):(Ad=this.rKh(Ad),Sc.Xr=Ad?1:0,Sc=Sb!==Rc.a.i8c,(Sb=this.kjf(Sb,nd))&&Ac.uxa(Sb),this.ga.Ub(Rc.a.SDd,2,Sc)),Yb.dispose(),32):8:8};this.q7e=(Sb,Yb,Ac)=>{if(1===Ac)return 32;this.rJj.create(this.control).H9n();return 32};this.tpn=(Sb,Yb,Ac,Sc,nd)=>1===Ac?32:(Sb=this.control)?(nd[ag.a.On]=Sb.gaa,32):8;this.Wmb=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac||!this.control.gaa)return 32;Yb=this.cYh(Sb,nd);Ac=xy.v7h(this.control.RD);Sc=this.Ic.Qc(15);
Sc.Eb(Ac);Sc.Kk=Sb;Sb=this.Zc.Bk();Sb.set(Ac);this.wJa.Vaf(Sb.currentNode,Yb);this.Rl.THb(Sb);this.Oqc.S7i(Sb,Yb);Sc.dispose();return 32};this.uxa=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac)return 32;Sb=this.kjf(Sb,nd);this.control.gaa&&this.control.uxa(Sb);return 32};this.J$d=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac)return 32;Sb=this.Q3h(Sb,nd);Sc.Xr=Sb;Yb=this.kof(Yb);if(!Yb)return 8;Sc=this.Zc.Bk();Sc.set(Yb);Sc.Ab(8);Sc.ut(8);if(!this.Pk.nWm(Sc,Sb))return 8;this.Rl.THb(Sc);this.control.efa(Sc.currentNode);return 32};this.XQf=
(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac)return 32;Sb=this.w5j.TWk(this.kof(Yb));nd.PopulationXML=Sb;return 32};this.A6d=(Sb,Yb,Ac,Sc,nd)=>{Sb=this.cYh(Sb,nd);Yb=this.control.RD;Ac=this.Rl.Jfa(Yb);nd[ag.a.On]=Sb===Ac;1===Sb&&(nd[ag.a.LabelText]=this.v8h(Yb)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.D5d=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac||!this.control.gaa)return 32;Yb=this.control.RD;void 0!==Yb&&null!==Yb&&(Yb=this.Rl.Jfa(Yb),
Sb=this.kjf(Sb,nd),Ac=this.control.ERb,nd[ag.a.Visible]=this.Pko(Sb,Yb),nd[ag.a.On]=Sb===Ac);return 32};this.Gpn=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac||!this.control.gaa)return 32;Sb=this.control.RD;void 0!==Sb&&null!==Sb&&this.rin(Sb,nd);return 32};this.Son=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac||!this.control.gaa)return 32;Sb=this.Q3h(Sb,nd);Yb=this.control.RD;Ac=0;void 0!==Yb&&null!==Yb&&(Ac=Yb.getValue(Lc.a.Hha));nd[ag.a.On]=Sb===Ac;return 32};this.ZS=(Sb,Yb,Ac)=>{if(1===Ac)return 32;this.control.dismiss();return 32};
this.qPd=()=>32;this.SDd=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac)return 32;this.control.show(nd);return 32};this.pjb=(Sb,Yb,Ac,Sc,nd)=>{if(1===Ac)return 32;if(!nd)return 8;Yb=nd.WYa;if(!Yb||!Yb.isConnected)return 8;Sb=this.Rl.d_d(Yb);if(!({isHeader:Ac,$9f:Yb}=this.Rl.X5h(Yb)).returnValue)return 8;this.control.efa(Sb);this.control.uxa(Yb);this.control.show(Ac,nd.Ebe);return 32};this.ga=b;this.Rl=h;this.Oqc=u;this.wJa=y;this.Pk=P;this.Zc=aa;this.Ic=ta;this.w5j=Pa;this.UNj=vb;this.rJj=Kb}get control(){return this.C9}set control(b){this.C9=
b}Wb(){this.ga.pa(Rc.a.PQd,oc.a.view,this.T$f);this.ga.gb(Rc.a.STf,oc.a.application,this.tpn,96);this.ga.pa(Rc.a.Die,oc.a.view,this.T$f);this.ga.pa(Rc.a.i8c,oc.a.view,this.T$f);this.ga.gb(Rc.a.qPd,oc.a.view,this.qPd,64);this.ga.pa(Rc.a.SDd,oc.a.view,this.SDd);this.ga.gb(Rc.a.ZS,oc.a.application,this.ZS,96);this.ga.gb(Rc.a.pjb,oc.a.application,this.pjb,96);this.ga.gb(Rc.a.OUn,oc.a.view,this.uxa,96);this.ga.pa(Rc.a.X3i,oc.a.view,this.uxa);this.ga.pa(Rc.a.Z3i,oc.a.view,this.uxa);this.ga.pa(Rc.a.Y3i,
oc.a.view,this.uxa);this.ga.pa(Rc.a.$3i,oc.a.view,this.uxa);this.ga.gb(Rc.a.mYn,oc.a.view,this.Wmb,100);this.ga.gb(Rc.a.N5i,oc.a.view,this.Wmb,4);this.ga.gb(Rc.a.M5i,oc.a.view,this.Wmb,4);this.ga.gb(Rc.a.K5i,oc.a.view,this.Wmb,4);this.ga.gb(Rc.a.L5i,oc.a.view,this.Wmb,4);this.ga.pa(Rc.a.J$d,oc.a.view,this.J$d);this.ga.pa(Rc.a.t1f,oc.a.view,this.J$d);this.ga.gb(Rc.a.XQf,oc.a.view,this.XQf,96);this.ga.gb(Rc.a.q7e,oc.a.view,this.q7e,4);this.ga.gb(Rc.a.qPi,oc.a.view,this.D5d,97);this.ga.gb(Rc.a.sPi,oc.a.view,
this.D5d,97);this.ga.gb(Rc.a.rPi,oc.a.view,this.D5d,97);this.ga.gb(Rc.a.tPi,oc.a.view,this.D5d,97);this.ga.gb(Rc.a.MPi,oc.a.view,this.A6d,97);this.ga.gb(Rc.a.LPi,oc.a.view,this.A6d,97);this.ga.gb(Rc.a.JPi,oc.a.view,this.A6d,97);this.ga.gb(Rc.a.KPi,oc.a.view,this.A6d,97);this.ga.gb(Rc.a.npn,oc.a.view,this.Gpn,97);this.ga.gb(Rc.a.qTf,oc.a.view,this.Son,97)}rKh(b){const h=this.Rl.tCb(b),u=this.Rl.Jfa(h);b=this.wJa.Vaf(b,u);this.control.efa(h);return b}cYh(b,h){switch(b){case Rc.a.N5i:case Rc.a.MPi:b=
1;break;case Rc.a.M5i:case Rc.a.LPi:b=2;break;case Rc.a.K5i:case Rc.a.JPi:b=3;break;case Rc.a.L5i:case Rc.a.KPi:b=4;break;default:b=h}return b}kjf(b,h){switch(b){case Rc.a.X3i:case Rc.a.qPi:b=1;break;case Rc.a.Z3i:case Rc.a.sPi:b=2;break;case Rc.a.Y3i:case Rc.a.rPi:b=3;break;case Rc.a.$3i:case Rc.a.tPi:b=4;break;case Rc.a.Die:case Rc.a.i8c:b=h;break;case Rc.a.PQd:b=0;break;default:b=h}return b}Q3h(b,h){return b===Rc.a.t1f||b===Rc.a.qTf?parseInt(h.MenuItemId):h}kof(b){return this.Pk.i7(b.Yj)}Pko(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}rin(b,h){const u=this.v8h(b);if(h[ei.a.Visible]=u)b=this.Pk.w7h(this.UNj(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[ei.a.LabelText]=b}v8h(b){const h=this.Zc.Bk();h.set(b);h.Ab(8);h.ut(8);return 1<this.Pk.Jnf(h)}static v7h(b){const h=new yd.GraphIterator;h.set(b);h.Ab(10);return to.WordSectionNavigator.RMn(h)}}Object(m.a)(xy,
"HeaderFooterActor",null,[]);var yy=c(612),It=c(710);class pv{constructor(b,h,u,y,P){this.GVj=b;this.Rl=h;this.Pk=u;this.Zc=y;this.ga=P}dKh(b,h){this.Rl.THb(b);h=this.Kbl(b,h);b.qc();return h}Vaf(b,h){b=this.Zc.ZCa(b,8,8);let u=!1;this.Pk.oNa(b,y=>{const P=this.Zc.Bk();P.set(y);u=(y=this.dKh(P,h))||u;return y});return u}Kbl(b,h){if(3!==this.ga.mode)return!1;let u=!1;h=It.a.e8e(h);for(let y=0;y<h.length;++y)u=this.GVj.Jbl(b,h[y])||u;return u}}pv.o0k=1;Object(m.a)(pv,"HeaderFooterInserter",null,[320]);
class Qs{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.f5g=this.LHg=!1;this.RD=null;this.Sye=!1;this.ERb=0;this.wIb=()=>{this.Sye=!0};this.e5=b;b.bind(this);this.UPe=y;this.QJj=vb;this.NYg=P;this.wWj=aa;this.K9a=ta;this.header=h;this.footer=u;this.header.TXk();this.e5.jz();this.bOe=pv.o0k;this.wJa=Pa;Qs.ga=Kb;this.RM=Sb}get gaa(){return this.LHg}static get G_e(){if(null!=Qs.Bmg)var b=Qs.Bmg;else{var h,u;b=null!==(u=null===(h=r.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeaderFooterControlCheckAppChromeReady",
!1))&&void 0!==u?u:!1;b=Qs.Bmg=b}return b}show(b=!0,h=!0){this.gaa||(this.Fqj(),this.h5i(!0),this.header.Gxn(),this.QJj(),this.afo(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna&&(Qs.G_e&&!fh.c()?w.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready"):appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new yy.a,{state:0,disablePopover:!0})))));(this.f5g=h)&&this.NYg(b)}dismiss(b=!1){this.gaa&&(this.wWj(b),this.h5i(!1),this.uAb(),
this.ERb=0,this.igo(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna&&(Qs.G_e&&!fh.c()?w.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready"):appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new yy.a,{disablePopover:!1})))))}h5i(b){this.LHg=b;Qs.ga.processAction(Oa.a.Bef,2);this.e5.R_(b);this.header.R_(b);this.footer.R_(b);this.UPe()}efa(b){this.RD!==b&&(this.RD=b,this.header.efa(b),this.footer.efa(b),this.ERb=0,this.Wmb(this.K9a.Jfa(b)))}uAb(){this.RD&&
(this.header.reb(),this.footer.reb(),this.RD=null)}update(){this.gaa&&this.FOb()}FOb(){this.RD&&(this.K9a.C8k(this.RD)&&this.K9a.A7l(this.RD)?this.Fqj():this.dismiss())}Fqj(){const b=this.K9a.Jfa(this.RD);b!==this.bOe&&this.Wmb(b)}Wmb(b){this.bOe=b;this.uxa(this.LWl(b))}LWl(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}uxa(b,h=!0){this.ERb!==b&&(this.wJa.Vaf(this.RD,this.bOe),this.header.W3i(b),this.header.lkh($g.AppFrame.Jaa),this.footer.W3i(b),this.footer.lkh($g.AppFrame.oaa),
this.ERb=b,this.gaa&&this.f5g&&this.qcl(h))}qcl(b){this.NYg(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.e5.d9();this.header.dispose();this.footer.dispose()}afo(){this.RM.cvd(this.wIb);this.Sye=!1}igo(){this.RM.PXf(this.wIb);this.Sye&&Qs.ga.processAction(Rc.a.qPd,2)}static Z5k(){Qs.ga.Ub(Wa.a.nhb,2,!0);Qs.ga.processAction(Rc.a.eaa,2)}}Qs.ga=null;Object(m.a)(Qs,"HeaderFooterControl",null,[294,9]);class Zt{constructor(b,h,u,y,P){this.UPe=b;this.K9a=h;this.wJa=
u;this.ga=y;this.RM=P}create(b,h,u,y,P){return new Qs(b,h,u,this.UPe,y,P,this.K9a,this.wJa,Qs.Z5k,this.ga,this.RM)}}Object(m.a)(Zt,"Factory",null,[457]);class mA{constructor(){this.C9=null}get control(){return this.C9}set control(b){this.C9=b}lff(b){return this.mff(this.control.RD,this.control.ERb,b.isHeader,b)}mff(b,h,u,y){return()=>{if(!b.isConnected)return null;this.control.efa(b);this.control.uxa(h);this.control.show(u);return y}}dismiss(){this.C9.gaa&&this.C9.dismiss()}}Object(m.a)(mA,"HeaderFooterControlLauncher",
null,[]);var Vu=c(1136),nA=c(534),Fp=c(333),gB=c(808);class ow{constructor(b,h,u){this.Wic=null;const y=h?"Header":"Footer";this.kr=b.ownerDocument.createElement("div");this.kr.id=h?"HeaderPane":"FooterPane";this.kr.classList.add(ow.D7l,y);this.$wb=(new gB.a(this.kr,"WACViewPanel_"+y)).FH;this.kr.appendChild(this.$wb);b.appendChild(this.kr);h&&(this.Wic=b.ownerDocument.createElement("div"),this.Wic.classList.add(ow.I7l),this.kr.appendChild(this.Wic));this.GAg=u.wNl(this.kr)}bind(){}R_(b){b?this.GAg.ojk():
this.GAg.qjk()}vrk(b){b.Icb(this.$wb)}}ow.I7l="HeaderToolbarContainer";ow.D7l="HeaderFooterPane";Object(m.a)(ow,"PaneControlDom",null,[494]);class Un{constructor(b,h,u,y,P){this.OD=this.zq=null;this.AFi=()=>{this.OD.dismiss(!0);if(this.HSb){const aa=new Ev.a(!0);this.HSb.PFa(aa)}return!0};this.dB=aa=>{aa.Ib.preventDefault();return!1};this.kr=b.ownerDocument.createElement("div");this.kr.id=Un.hxh;this.kr.className=Un.hxh;this.VY=y;this.HSb=P;this.cai=new ow(this.kr,!0,h);this.JVk(this.kr);this.LPh=
new ow(this.kr,!1,h);this.R_(!1);b.appendChild(this.kr)}JVk(b){this.zq=b.ownerDocument.createElement("div");this.zq.id=Un.icn;this.zq.className=Un.gcn;this.zq.tabIndex=0;this.zq.setAttribute(hf.a.wh,hf.a.l2);this.zq.setAttribute(hf.a.pea,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.zq)}bind(b){this.OD=b}R_(b){if(!b&&this.VY){var h=new Ev.a(!0);this.VY.PFa(h)}!b&&this.HSb&&(h=new Ev.a(!0),this.HSb.PFa(h));this.kr.style.display=b?"":"none";this.cai.R_(b);
this.LPh.R_(b)}EXn(){this.zq.focus()}jz(){th.a.instance.mb(bb.a.click,this.zq,this.AFi);Re.a.instance.mb(bb.a.qx,this.kr,this.dB)}d9(){th.a.instance.sc(bb.a.click,this.zq,this.AFi);Re.a.instance.sc(bb.a.qx,this.kr,this.dB)}}Un.hxh="HeaderFooterControl";Un.icn="HeaderFooterOverlay";Un.gcn="EditingSurfaceOverlay HeaderFooterOverlay";Object(m.a)(Un,"HeaderFooterControlDom",null,[475]);class Wu{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.e5=null;this.sa=new ie.a;this.OD=this.gpd=null;this.DLf=Sb=>{this.D8(Sb);
this.sa.raiseEvent("OnShowEventKey")};this.CLf=Sb=>{this.$e&&(this.gpd=new Vu.a(this.$e));this.Vb.TFc($g.AppFrame.Jaa);this.Vb.TFc($g.AppFrame.oaa);this.kca(Sb);this.sa.raiseEvent("OnDismissEventKey")};this.p3d=()=>{this.gpd&&(this.gpd.dispose(),this.gpd=null)};this.Vb=b;this.Zo=h;this.B_g=u;this.uOj=y;this.oYj=P;this.ga=aa;this.mFg=nA.a.create();this.dJg=Rb.KeyInputManager.lc(fb.a.us,0);this.JY=Rb.KeyInputManager.lc(fb.a.A0,0);this.l3j=Rb.KeyInputManager.lc(fb.a.BHa,0);this.YH=ta;this.Ma=Pa;this.VY=
vb;this.HSb=Kb;this.$e&&this.$e.Gka(this.p3d)}rfh(b){this.sa.addHandler("OnShowEventKey",b)}QFn(b){this.sa.removeHandler("OnShowEventKey",b)}dvd(b){this.sa.addHandler("OnDismissEventKey",b)}vWi(b){this.sa.removeHandler("OnDismissEventKey",b)}get $e(){const b=this.YH.value;return b?b.mi?b:(w.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(w.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.OD}get zOk(){return this.mFg}bind(b){this.OD=
this.HMk(b);this.mFg.instance=this.OD}HMk(b){this.e5=new Un(b,this.oYj.value,this.Ma,this.VY,this.HSb);b=this.B_g.value.create(this.ga,this.e5.cai,!0,$g.AppFrame.Jaa);const h=this.B_g.value.create(this.ga,this.e5.LPh,!1,$g.AppFrame.oaa);this.OD=this.uOj.value.create(this.e5,b,h,this.DLf,this.CLf);this.psf();this.uS();return this.control}psf(){var b=3===this.ga.mode?$g.AppFrame.oE:$g.AppFrame.bec;const h=this.Vb.le($g.AppFrame.Jaa);h.parent=b;this.Vb.tSe($g.AppFrame.Jaa);const u=this.Vb.le($g.AppFrame.oaa);
u.parent=b;this.Vb.tSe($g.AppFrame.oaa);b=this.Vb.le(Fp.a.YDb);b.parent=xe.AFrame.Hp;b.hea(()=>{this.e5.EXn()});b.bindAction(this.dJg,Rc.a.ZS);b.bindAction(this.JY,Rc.a.ZS);b.bindAction(this.l3j,Rc.a.ZS);h.bindAction(this.JY,Rc.a.ZS);u.bindAction(this.JY,Rc.a.ZS)}uS(){this.Zo.uS($g.AppFrame.Jaa);this.Zo.uS(Fp.a.J0a);this.Zo.uS($g.AppFrame.oaa);this.Zo.uS(Fp.a.YDb)}D8(b){this.Zo.XG($g.AppFrame.Jaa);this.Zo.XG(Fp.a.J0a);this.Zo.XG($g.AppFrame.oaa);this.Zo.XG(Fp.a.YDb);this.Zo.ex(xe.AFrame.So);this.Vb.fAc($g.AppFrame.Jaa);
this.Vb.fAc($g.AppFrame.oaa);b?this.Vb.Dg($g.AppFrame.Jaa):this.Vb.Dg($g.AppFrame.oaa)}kca(b){this.Zo.ex($g.AppFrame.Jaa);this.Zo.ex(Fp.a.J0a);this.Zo.ex($g.AppFrame.oaa);this.Zo.ex(Fp.a.YDb);this.Zo.XG(xe.AFrame.So);(b||this.Vb.currentScope&&(this.Vb.currentScope.name===$g.AppFrame.Jaa||this.Vb.currentScope.name===Fp.a.J0a||this.Vb.currentScope.name===$g.AppFrame.oaa||this.Vb.currentScope.name===Fp.a.YDb))&&this.Vb.Dg(xe.AFrame.So)}dispose(){const b=this.Vb.le(Fp.a.YDb);b.Mr(this.dJg);b.Mr(this.JY);
this.Vb.le($g.AppFrame.Jaa).Mr(this.JY);this.Vb.le($g.AppFrame.oaa).Mr(this.JY);this.$e&&this.$e.p8d(this.p3d);this.control.dispose()}}Object(m.a)(Wu,"HeaderFooterControlOwner",null,[455,456]);var xu=c(1085);class yu{constructor(b,h,u,y,P,aa){this.Rl=b;this.Zc=h;this.NXj=u;this.Sl=y;this.QXj=P;this.wOj=aa}Jfm(b,h){const u=this.Zc.Bk();u.set(b);this.Rl.UHb(u,h);this.NXj(u);this.QXj(u.currentNode,this.Sl);this.wOj.Kfm(u,xu.a(h))}}Object(m.a)(yu,"HeaderFooterDefaultContentInserter",null,[453]);class Sp{constructor(b,
h,u,y,P,aa,ta,Pa){this.nS=b;this.l4j=h;this.uoe=u;this.Sl=y;this.PXj=P;this.F2j=aa;this.kOj=ta;Sp.Bh=Pa}Kfm(b,h){this.l4j(b,1,3,null,!1);this.nS.Y2c(Yt.a.E8c,1696,b.currentNode);this.uoe(b,0,this.Sl?3:1,h);this.uoe(b,1,2,h);this.uoe(b,2,this.Sl?1:3,h);this.PXj(b);this.F2j(b,!1,!0,null);this.kOj(b,h)}static get HM(){return null!=Sp.Jyg?Sp.Jyg:Sp.Jyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=Sp.Yug?Sp.Yug:Sp.Yug=Ja.a.instance.resolve("Box4.IParagraphEditor")}static MVn(b,
h,u){wf.moveToCellContent(b,0,h);og.OutlineElementNavigator.Ee(b);Sp.HM.$ae(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Sp.paragraphEditor.zD(b.currentNode,u);h||Sp.paragraphEditor.Vp.zxa(b,1,-115);2===h&&Sp.paragraphEditor.Vp.aMb(b.currentNode,1,-115);wf.returnToContainingTable(b)}static kYn(b,h){og.OutlineElementNavigator.Ee(b);Sp.HM.$ae(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);og.OutlineElementNavigator.$d(b)}static wvl(){return(b,
h,u)=>{Sp.MVn(b,h,u)}}static xEl(){return(b,h)=>{Sp.kYn(b,h)}}static XVl(b){return(h,u,y,P,aa)=>b.bCa(h,u,y,P,aa)}static ZTl(){return(b,h,u,y,P)=>Sp.Bh.pD(b,h,u,y,P)}}Sp.Bh=null;Object(m.a)(Sp,"HeaderFooterDefaultTableInserter",null,[454]);class Gx{constructor(b,h,u,y){this.Rl=b;this.Uld=h;this.Zc=u;this.Pk=y}S7i(b,h){b.Hn.properties.setValue(Lc.a.Cpf,2===h||4===h);b.Ab(8);b.I7c(8).properties.setValue(Lc.a.$Od,3===h||4===h)}wCn(b){this.Pk.oNa(b,h=>{const u=this.Zc.Bk();u.set(h);this.Rl.THb(u);this.S7i(u,
1);this.xCn(u);return!0})}xCn(b){for(;b.Vd();)b.Jg()}}Object(m.a)(Gx,"HeaderFooterEditor",null,[452]);var iC=c(1089);class pw extends Vt.a{constructor(b){super();this.WPe=b}get index(){return 0}run(){this.WPe()}z7l(b,h){h.property===Lc.a.Cpf&&this.BH()}Gcn(b,h){h.property===Lc.a.$Od&&this.BH()}BH(){this.OX()}}Object(m.a)(pw,"ControlUpdateNeededTracker",Vt.a,[]);class oA{constructor(b,h,u,y,P,aa){this.x8a=null;this.vOj=u;this.qfd=h;this.nTb=b;this.dYj=y;this.vKa=aa}start(){this.nTb.bind(Ra.App.xa.vC);
this.qfd.control=this.nTb.control;this.qfd.Wb();this.vOj.control=this.nTb.control;this.dYj.value.create(this.nTb.control,Object(v.a)(this.qfd,this.qfd.rKh,"ensureSectionHeaderFooterAttachedToControl")).Wb();this.Y8l()}Y8l(){this.x8a=new pw(()=>{this.nTb.control.update()});const b=Ra.App.kk.sl;b.Xe(35).Ap(Object(v.a)(this.x8a,this.x8a.z7l,"headerFooterContainerNodePropertyChanged"));b.Xe(8).Ap(Object(v.a)(this.x8a,this.x8a.Gcn,"pageContentNodePropertyChanged"));iC.a.F7d(Object(v.a)(this.x8a,this.x8a.BH,
"setUpdateNeeded"));Pi.GraphTransactionManager.instance.epa(this.x8a,3)}dispose(){this.nTb.dispose();this.vKa.aGh()}}Object(m.a)(oA,"HeaderFooterManager",null,[]);class Hx{constructor(b,h,u,y){this.Pk=b;this.Rl=h;this.FVj=u;this.hre=y}Jbl(b,h){let u=!1;const y=It.a.Okf(h);b.Lq(y)||(this.Sfm(b,h),this.hre.Jfm(b.currentNode,h),u=!0);return u}Sfm(b,h){const u=this.FVj.create(1074135123),y=b.currentNode.ia(Lc.a.Hha,0);u.properties.setValue(Lc.a.Hha,y);u.properties.setValue(Lc.a.E6b,h);h=It.a.Okf(h);b.Qf(u,
h)}}Object(m.a)(Hx,"HeaderFooterNodeLevelInserter",null,[450]);var qw=c(237),hB=c(429);class Ix extends qw.a{constructor(b,h,u){super(b,h,"","");this.xub=null;this.oai=Ix.lDh;this.NNc=[];this.uwe=u}get mA(){return!0}get cssClass(){return"cui-herodock"}sm(){this.Axn();super.sm()}UMa(){for(const b of this.NNc)b.ZEd();super.UMa()}Zdo(){let b,h,u;b=[];h=[];u=[];for(let y=0;y<this.NNc.length;y++){const P=this.NNc[y];P.visible?b.length<this.oai?b.push(P):Object(jb.a)(hB.FlyoutAnchor,P)?Array.addRange(h,
P.qyl()):h.push(P):u.push(P)}return{Lno:b,ecn:h,Jim:u}}IVk(b){if(!b||!b.length)return null;const h=new So.Menu(this.root,this.id+"OverflowMenu",null,null,null),u=new Rm.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const y of b)u.Qf(y.JP("Menu20"));h.Qf(u);return h}Axn(){this.Y7d();this.Nc=kg.a.oRa(this.Nc);this.VB();var b;({Lno:u,ecn:b,Jim:y}=this.Zdo());for(var h of u){var u=h.JP("Medium20");u.enabled=!0;this.RYb(u,this.children.count);
this.Nc.appendChild(u.Nc);u.Ula()}if(b=this.IVk(b))this.xub?this.xub.menu=b:(h=this.id+"OverflowMenuLauncher",u={},u.Image20by20=this.uwe.OverflowMenuImage20by20,u.Image20by20Class=this.uwe.OverflowMenuImage20by20Class,u.PopulateDynamically="false",u.HideDefaultArrow="true",u.Alt=this.uwe.OverflowMenuTooltip,u.Command="798637440",u.Id=h,this.xub=new hB.FlyoutAnchor(this.root,h,u,b)),b=this.xub.JP("Small20"),b.enabled=!0,this.RYb(b,this.children.count),this.Nc.appendChild(b.Nc),b.Ula();if(r.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const P of y){var y=
P.JP("Medium20");this.Qf(y);y.Ula()}}dispose(){this.xub&&(this.xub.dispose(),this.xub=null);for(const b of this.NNc)b.dispose();this.Y7d();super.dispose()}set mA(b){super.mA=b}}Ix.lDh=4;Object(m.a)(Ix,"HeroDock",qw.a,[]);var cx=c(618);class op extends cx.a{constructor(){super();this.gee=this.Lsm=this.Lfo=!1;this.XRm=r.AFrameworkApplication.Lwf?1:Ix.lDh}}Object(m.a)(op,"ToolbarBuildOptions",cx.a,[]);var Ji=c(53),pA=c(866),iB=c(720);class Mv extends qw.a{constructor(b,h,u){super(b,h,"","");this.Klc=
u.Alignment;this.nIg=u.ScalingDirection===Ji.a.Xwj}sm(){this.iua();this.pW(this.Nc);super.sm()}pW(b){for(let h of this.children){h.VB();switch(this.Klc){case Ji.a.bke:kg.a.Zf(h.Nc,"cui-toolbar-button-left");break;case Ji.a.o7a:kg.a.Zf(h.Nc,"cui-toolbar-button-center");break;case Ji.a.GPb:kg.a.Zf(h.Nc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Klc);}h.visible&&b.appendChild(h.Nc);h.Ula()}}ON(b){if(!Object(jb.a)(Cm.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.Klc){case Ji.a.bke:return"cui-toolbar-buttondock alignleft";case Ji.a.o7a:return"cui-toolbar-buttondock aligncenter";case Ji.a.GPb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Klc);}}get mA(){return!0}get alignment(){return this.Klc}i6b(){let b=0;if(this.alignment===Ji.a.o7a)for(let h of this.children){const u=h;u.visible&&(b+=u.Nc.offsetWidth)}else b=this.Nc.offsetWidth;return b}CMd(){let b=null;if(this.alignment===Ji.a.o7a)for(let h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.Nc);break}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.g0?b.x:b.x+b.width:0}MJd(){let b=null;if(this.alignment===Ji.a.o7a){if(0<this.children.count){const h=this.children.NJd(this.children.count-1);for(;h.g3a();){const u=h.get_current();if(u.visible){b=Sys.UI.DomElement.getBounds(u.Nc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.g0?b.x+b.width:b.x:0}Paf(){for(let b of this.children){const h=b;if(!Object(jb.a)(Cm.a,
h)||h.control.visible)h.visible=!0}}bQn(b){const h=this.children.toArray(),u=new iB.a;let y=this.nIg?0:h.length-1;const P=this.children.count,aa=this.root.uSa;for(;this.i6b()>=b&&!(y>=P||0>y);){const ta=h[y];aa&&Object(jb.a)(Cm.a,ta)&&ta.control.visible&&(u.add(ta),ta.xih());y+=this.nIg?1:-1}for(let ta of u)ta.YUi(),ta.visible=!1}set mA(b){super.mA=b}}Object(m.a)(Mv,"ButtonDock",qw.a,[]);class zy extends Uc.a{constructor(b,h,u,y,P,aa,ta=!1){super(b,h,aa);this.Nqa=this.vY=this.kka=null;this.cEe=!1;
this.f2a=y;this.gee=P;this.hsd=0;Oe.c(h.Size)||(h.Size===Ji.a.Yig||u.options.Lsm?this.hsd=0:h.Size===Ji.a.Uzj&&(this.hsd=1));this.x5j=ta}get uSa(){return!0}Qf(b){super.Qf(b);Object(jb.a)(Mv,b)&&!this.cEe&&(b.alignment===Ji.a.bke?(this.kka&&this.O2f(),this.kka=b):b.alignment===Ji.a.o7a?(this.vY&&this.O2f(),this.vY=b):b.alignment===Ji.a.GPb&&(this.Nqa&&this.O2f(),this.Nqa=b))}O2f(){this.cEe=!0;this.Nqa=this.vY=this.kka=null}Fmb(b,h){b=this.uKc(b);Oe.c(b)||b.visible===h||(b.visible=h,this.refresh())}sm(){super.sm();
this.MSi(!0)}MSi(b){const h=this.root.pzb;Oe.c(this.Nc)&&this.UXk();this.Nc=kg.a.oRa(this.Nc);this.ONc&&this.Nc.appendChild(this.ONc);for(let u of this.children)u.visible&&(u.VB(),this.Nc.appendChild(u.Nc),u.Ula());this.vY&&b&&this.ibl();h&&h.aY();this.dirty=!1}ibl(){if(this.vY.visible&&this.vY.children.count&&(this.Jih(0,0),this.B8k(this.kka,this.vY,this.Nqa))){let b=0,h=0;const u=this.kka?this.kka.i6b():0,y=this.Nqa?this.Nqa.i6b():0;if(0<y||0<u)y>u?(b=0,h=y-u):(b=u-y,h=0);this.Jih(b,h)}}B8k(b,h,
u){let y=!1;0===this.root.g0?(b&&(y=b.MJd()>h.CMd()),!y&&u&&(y=h.MJd()>u.CMd())):(b&&(y=b.MJd()<h.CMd()),!y&&u&&(y=h.MJd()<u.CMd()));return y}Jih(b,h){0===this.g0?(this.vY.Nc.style.marginLeft=b+"px",this.vY.Nc.style.marginRight=h+"px"):(this.vY.Nc.style.marginRight=b+"px",this.vY.Nc.style.marginLeft=h+"px")}UXk(){this.VB()}Yt(){this.LGh(()=>{Ot.a.prototype.Yt.call(this)})}pU(b){b=this.uKc(b);Oe.c(b)||this.LGh(Object(v.a)(b,b.Nl,"pollForStateAndUpdate"))}LGh(b){this.bbc=this.j3a=!1;b();if(this.j3a||
this.bbc)this.x5j||this.refresh(),this.scale()}ON(b){if(!Object(jb.a)(Ix,b)&&!Object(jb.a)(Mv,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(jb.a)(Mv,b)&&b.alignment===Ji.a.o7a)for(let h of this.children)if(h.alignment===Ji.a.o7a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.hsd?(b+="cui-toolbar-onerow ",r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.I7||
(b+="UITextTranformUpperCase ")):1===this.hsd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Yta(){return"div"}get y8(){return 26}get Wij(){return this.wN}set Wij(b){this.wN=b}CRk(b){b=b[Ji.a.lw];return new Mv(this.root,b.Id,b)}VB(){super.VB();this.Nc.setAttribute("role","toolbar");this.properties.Title&&this.Nc.setAttribute("title",this.properties.Title)}xHa(b){return this.root&&this.root.eec(b)?!0:!1}HXn(){this.URa()}scale(){super.scale();if(!kg.a.Fr(this.properties.Scale)||this.cEe)return!1;
Oe.c(this.kka)||(this.kka.visible=!0,this.kka.Paf());Oe.c(this.vY)||(this.vY.visible=!0,this.vY.Paf());Oe.c(this.Nqa)||(this.Nqa.visible=!0,this.Nqa.Paf());this.MSi(!1);const b=this.Nc.offsetWidth,h=Oe.c(this.kka)?0:this.kka.i6b(),u=Oe.c(this.vY)?0:this.vY.i6b(),y=Oe.c(this.Nqa)?0:this.Nqa.i6b();y+u+h>=b&&(y+h>=b?(this.tai(this.vY),y>=b?(this.tai(this.kka),this.$_f(this.Nqa,b)):this.$_f(this.kka,b-y)):this.$_f(this.vY,b-y-h));this.j3a=!1;this.sm();return!1}tai(b){b&&(b.visible=!1)}$_f(b,h){b&&b.bQn(h)}}
Object(m.a)(zy,"Toolbar",Uc.a,[842]);class dx extends zy{constructor(b,h,u,y,P=!1){super(b,h,u,!1,!1,y,P);this.sUg=!0}get y8(){return 7}get cssClass(){return dx.Mfo+" "+super.cssClass}static get Mfo(){let b="cui-statusbar";r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.I7||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(m.a)(dx,"StatusBar",zy,[]);var Rs=c(511);class pz extends Rs.a{constructor(){super();this.toolbar=null;this.UUd=!1}}Object(m.a)(pz,"ToolbarBuildContext",Rs.a,
[]);class Ay extends Zl.Builder{constructor(b,h,u,y){super(b,h,pf.Task.X6(u),y);if(Oe.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}R3f(b){this.root=b}get cag(){return this.options}Fwk(){const b=new pz,h=new pA.a;h.id="toolbar";h.XZc=1;h.handler=Object(v.a)(this,this.s8m,"onReturnToolbarData");h.data=b;this.Lta.N9d(h)}s8m(b){this.R3f(this.Hwk(b.qZc,b.AEc));this.toolbar.Wij=this;this.toolbar.sm();this.placeholder.appendChild(this.toolbar.Nc);
kg.a.Zf(this.placeholder,"loaded");this.Zsa.continueWith(()=>{this.Zsa.result.vIb(this.toolbar)},11)}Hwk(b,h){var u=Ji.a.zfa(b,Ji.a.DAj);Oe.c(u)&&(u=Ji.a.zfa(b,Ji.a.aAj),h.UUd=!0);if(Oe.c(u))throw Error.create("No toolbar element was present in the data");b=new Ji.a(u);u=r.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.UUd?this.R3f(new dx(b.attributes[Ji.a.id],b.attributes,this,this.g$,u)):this.R3f(new zy(b.attributes[Ji.a.id],b.attributes,this,this.cag.Lfo,this.cag.gee,
this.g$,u));this.toolbar.gta=this.options.gta;this.toolbar.aie=!0;this.toolbar.sm();b=Ji.a.Wv(Ji.a.zfa(b.node,Ji.a.Gwj));h=this.Qtk(b,h);for(const y of h)this.toolbar.Qf(y);return this.toolbar}Qtk(b,h){const u=[];for(let y=0;y<b.length;y++)this.fPa(b[y])||Array.add(u,this.suk(b[y],h));return u}suk(b,h){const u=Ji.a.FLc(b);let y=null;u===Ji.a.nvj?y=this.Ztk(b,h):u===Ji.a.lxj&&(y=this.Quk(b,h));return y}Quk(b,h){var u=new Ji.a(b);u=new Ix(this.root,u.attributes[Ji.a.id],b[Ji.a.lw]);u.oai=this.cag.XRm;
b=Ji.a.zfa(b,Ji.a.opb);b=Ji.a.Wv(b);const y=[];for(let aa=0;aa<b.length;aa++){var P=b[aa];this.fPa(P)||(P=this.xea(P,h),Array.add(y,P))}u.NNc=y;return u}Ztk(b,h){new Ji.a(b);const u=this.toolbar.CRk(b);b=Ji.a.zfa(b,Ji.a.opb);b=Ji.a.Wv(b);for(let y=0;y<b.length;y++){if(this.fPa(b[y]))continue;const P=this.Gwk(b[y],h);u.Qf(P)}return u}Gwk(b,h){var u=new Ji.a(b);const y=u.name;u=u.attributes[Ji.a.Nkc];let P;P=h.UUd?"Small14":"Small";switch(y){case Ji.a.button:return b=this.xea(b,h),b.JP(Oe.b(u)?P:u);
case Ji.a.PCa:return P=h.UUd?"Medium14":"Medium",b=this.xea(b,h),b.JP(Oe.b(u)?P:u);case Ji.a.label:return b=this.xea(b,h),b.JP(Oe.b(u)?P:u);case Ji.a.separator:return b=this.xea(b,h),b.JP("Small");case Ji.a.toggleButton:return b=this.xea(b,h),b.JP(Oe.b(u)?P:u);default:throw Error.create("Invalid control type.");}}}Object(m.a)(Ay,"ToolbarBuilder",Zl.Builder,[]);var qA=c(1433);class qz{constructor(b,h,u,y,P,aa){this.wkb=()=>{this.toolbar.Nl()};this.KH=b;b=new Ro.CuiHelper(Yl.a.lYa,WordEditorIntl.WordEditorStrings,
null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);y=new op;y.uG={};aa=3!==aa.mode;y.uG.HeaderToolbarControlsRight=aa;y.uG.HeaderToolbarButtonDockRight=aa;y.uG.HeaderToolbarButtonRemovePageNumbers=aa;P=new Ay(y,this.KH,this,P);P.Lta=new qA.a(qz.J7l,b);P.Fwk();this.uka=P.toolbar;u.execute(ta=>{this.toolbar.ME=ta});this.toolbar.refresh();this.toolbar.Nl();this.Eh=h;h.MXa(this.wkb)}get toolbar(){return this.uka}dispose(){this.Eh.wec(this.wkb);this.toolbar&&(this.toolbar.dispose(),this.uka=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.HXn()}Y5k(){this.toolbar.M2()}vIb(){}}
qz.J7l="WordEditorHeaderToolbarData";Object(m.a)(qz,"HeaderFooterToolbar",null,[152,474]);class rA{constructor(b,h,u,y,P){this.Eh=b;this.yqe=h;this.Wc=u;this.g$=y;this.ga=P}create(b){return new qz(b,this.Eh,this.yqe,this.Wc,this.g$,this.ga)}}Object(m.a)(rA,"Factory",null,[451]);class vn{constructor(b,h){this.Zc=b;this.Pk=h}TWk(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.SWk(b)+"</Controls></MenuSection></Menu>"}iEl(b){const h=
this.Zc.Bk();h.set(b);h.Ab(8);h.kd(8);return h}SWk(b){if(!b)return"";let h="";b=this.iEl(b);this.Pk.oNa(b,u=>{const y=this.Pk.w7h(u);u=u.getValue(Lc.a.Hha);h+=ke.m(u.toString(),u.toString(),Rc.a.t1f.toString(),Rc.a.qTf.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,y));return!0});return h}}Object(m.a)(vn,"HeaderFooterToolbarGenerator",null,[449]);var ij=c(120);class $t extends hz.a{constructor(b,h,u,y,P,aa,ta,Pa){super(b,h,u,y);this.Qs=()=>{this.$6c(this.yb)};
this.KH=b.container;this.Ev=document.createElement("div");this.rC(this.Ev);this.dAa=P;this.lJa=aa;this.Wn.execute(vb=>{vb.u8(this.Qs)});this.UJ=ta;if(this.WH=Pa)this.KH.style.backgroundColor=this.UJ.w5b()}dispose(){super.dispose();this.Wn.instance&&this.Wn.instance.Ylb(this.Qs)}get Wn(){return null!=this.Vpg?this.Vpg:this.Vpg=Ja.a.instance.Za("Common.IZoomManager")}qz(b){this.KH.classList.add("HeaderFooterViewElement");this.Ev.classList.add("HeaderFooterViewContent");this.$6c(b.currentNode)}e9(b){this.Ev.parentNode&&
this.Ev.parentNode===this.KH||(this.KH.appendChild(this.Ev),this.lJa.instance&&this.lJa.instance.V3f(this.Yb,this.KH));super.e9(b)}Mob(b){ij.a.Sd(()=>{ij.a.prototype.Mob.call(this,b);this.Wnj();this.lJa.instance&&this.lJa.instance.cnj(this.Yb,this.Ev.style.paddingLeft,this.Ev.style.paddingTop)},"HFVE:UFO")}$6c(b){this.Wn.instance&&this.Wn.instance.M8c(this.Ev);this.Wnj();b=this.dAa.N5b(b);this.Ev.style.paddingLeft=b.b1b+"px";this.Ev.style.width=b.zEc+"px";this.lJa.instance&&this.lJa.instance.cnj(this.Yb,
this.Ev.style.paddingLeft,this.Ev.style.paddingTop)}Wnj(){if(this.Wn.instance){this.Ev.style.paddingTop="";var b=Kk.a.WB(this.Ev);b.paddingTop&&(b=Hc.a.mM(b.paddingTop),this.Ev.style.paddingTop=Math.round(b/this.Wn.instance.jj)+"px")}}}Object(m.a)($t,"HeaderFooterViewElement",hz.a,[]);class Nv{constructor(b,h,u,y){this.dAa=b;this.lJa=h;this.UJ=u;this.WH=y}create(b,h,u,y){return new $t(b,h,u,y,this.dAa,this.lJa,this.UJ,this.WH)}}Object(m.a)(Nv,"Factory",null,[448]);var rz=c(371),Jx=c(194),sA=c(955),
OB=c(583);class rw extends rz.a{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce){super(h,aa,ta,Pa,vb,Jx.a.Rqf,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce);this.isHeader=this.isHeader=b;this.xWa=P;this.xWa.s5c=this;y(this);this.sbd=u;this.kza=document.createElement("div");this.kza.setAttribute("Unselectable","on");this.kza.setAttribute("hideselection","hideselection");this.kza.setAttribute("style","outline:none;");this.kza.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.kza.tabIndex=0;this.features.faj=!0;this.features.PZe=!0}get Svf(){return!0}cof(){const b=this.sbd.lff(this);return sA.ViewReference.sE(this,b)}X8e(b){Object(jb.a)(rw,b)||this.sbd.dismiss()}get dqf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}jMc(){return OB.a.zyi}onResize(){super.onResize();this.xWa.qKh()}MB(b,h=null){this.kza.parentNode&&this.kza.parentNode.removeChild(this.kza);super.MB(b,h);this.xWa.cKh(this.jd.Wi)}detach(){this.xWa.pKh();super.detach();this.kza.parentNode||
this.container.insertBefore(this.kza,this.container.firstChild)}T2c(){this.$r?super.T2c():this.kza.focus()}WHd(){this.onResize()}}Object(m.a)(rw,"HeaderFooterView",rz.a,[472,341,232,38,9,52,342,343,344]);class jB{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad){this.sbd=b;this.j7j=h;this.i7j=u;this.Ht=y;this.fd=P;this.wka=aa;this.ga=ta;this.fVa=Pa;this.hsa=vb;this.V5=Kb;this.R7j=Sb;this.At=Yb;this.xy=Ac;this.Pf=Sc;this.yh=nd;this.mbd=Ad}create(b,h){return new rw(b,h,this.sbd,this.j7j,this.i7j(),
this.Ht,this.fd,this.wka,this.ga,this.fVa,this.hsa,this.V5,this.R7j,this.At,this.xy,this.Pf,this.yh,this.mbd)}}Object(m.a)(jB,"Factory",null,[443]);class Kx{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce){this.u_g=!1;this.C6g="SourceControlId";this.cmo=1;this.dmo=1E3;this.a6d=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;this.Ved(Vf[this.C6g]);Vf[Bi.a.Text]=this.uGe.Vcn(this.nab.tEb);return 32};this.spn=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;Vf[ag.a.On]=this.nab.tEb;return 32};this.Nam=(Nd,
re,Xd,vg,Vf)=>{if(1===Xd)return 32;this.nab.lyo(Vf[ag.a.On]);return 32};this.vVi=(Nd,re,Xd)=>{if(1===Xd)return 32;if(this.C9){re=Kx.mh.Wt(re.view.jd);Xd=yd.GraphIterator.$a(re);const vg=this.Ud.gYa();try{const Vf=this.Ic.Qc(15);try{Vf.Eb(re),Vf.Kk=Nd,so.a.instance.oNa(Xd,kj=>{this.zVb.c0c(kj,this.ozl,this.VYn);return!0})}finally{Vf&&Vf.dispose()}}finally{vg&&vg.dispose()}}return 32};this.zYc=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;Vf.MenuItems=this.fYj.value;this.u_g?this.nab.kKn():this.u_g=!0;return 32};
this.Lgm=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;const kj=this.Ved(Vf[this.C6g]);if(this.C9){re=Kx.mh.Wt(re.view.jd);Xd=yd.GraphIterator.$a(re);vg=this.Ic.Qc(15);try{vg.Eb(re);vg.Kk=Nd;let zm=null;const rm=this.je.jg("UserAction","InsertPageNumber");so.a.instance.oNa(Xd,os=>{this.C9.gaa||this.QKj(os);zm=this.tGe.Jgm(os,kj,this.nab.tEb)||zm;return!0});rm.stop();if(!zm)return 8;this.s$n(zm,kj)}finally{vg&&vg.dispose()}this.Ud.Ds(12)}return 32};this.Ucn=()=>32;this.X$n=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;
2===Xd&&this.vKa.showCallout(Vf);return 32};this.W$n=(Nd,re,Xd,vg,Vf,kj)=>this.NLe.create(Nd,re,Xd,vg,Vf,kj);this.a6k=(Nd,re,Xd)=>{if(1===Xd)return 32;this.vKa.aGh();return 32};this.o9n=Nd=>{r.AFrameworkApplication.ya.Hoa(null,Rc.a.Hbj,Nd.customData,null)};this.ozl=Nd=>{const re=Hh.a.instance.hb.kb;let Xd=-1;for(const vg of re)if(vg.node===Nd){Xd=vg.cpBegin;break}return{returnValue:Xd,ETd:Se.SelectionEditor.om(re)}};this.VYn=(Nd,re)=>{Nd=Kf.SelectionFactory.we(Nd,re);Hh.a.instance.setSelection(Nd)};
this.ga=b;this.Ic=h;this.Gb=u;this.nab=y;this.C9=P;this.Rl=aa;this.uGe=ta;this.tGe=Pa;this.zVb=vb;this.vKa=Kb;this.ib=Sb;this.NLe=Yb;this.je=Ac;this.Ud=Sc;this.Ved=nd;this.QKj=ce;this.fYj=new Zf.a(()=>this.nab.qNl())}Wb(){this.ga.gb(Rc.a.zYc,oc.a.view,this.zYc,100);this.ga.gb(Rc.a.PJi,oc.a.view,this.Ucn,68);this.ga.gb(Rc.a.sei,oc.a.view,this.Lgm,4);this.ga.gb(Rc.a.tEb,oc.a.view,this.Nam,4);this.ga.gb(Rc.a.c0c,oc.a.view,this.vVi,4);this.ga.gb(Rc.a.pEn,oc.a.view,this.vVi,4);this.ga.gb(Rc.a.QTf,oc.a.application,
this.spn,97);this.ga.gb(Rc.a.a6d,oc.a.application,this.a6d,97);this.ga.gb(Rc.a.Gbj,oc.a.view,this.X$n,4);this.ga.tS(Rc.a.Hbj,oc.a.view,this.W$n,100);this.ga.gb(Rc.a.$5k,oc.a.view,this.a6k,4)}s$n(b,h){const u=b.Nb.paragraph;if(u){var y=this.Rl.d_d(u);y&&this.C9.efa(y)}y=this.C9.gaa;this.C9.show(4>h);u&&this.lYn(u)&&(this.q1n(b,u),this.adk(b,y))}lYn(b){let h;if(!({isHeader:h,$9f:b}=this.Rl.X5h(b)).returnValue)return!1;this.C9.uxa(b,h);return!0}q1n(b,h){b=Kf.SelectionFactory.we(h,b.Nb.cp);this.ib.setSelection(b)}adk(b,
h){h=new sc.a(2,1,h?this.cmo:this.dmo,this.o9n);h.customData=b;this.Gb.Xb(h)}static get mh(){return xl.PageNavigator.instance}}Object(m.a)(Kx,"PageNumbersActor",null,[473]);class kB{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac){this.ga=b;this.Gb=h;this.nab=u;this.uGe=y;this.tGe=P;this.zVb=aa;this.vKa=ta;this.NLe=Pa;this.Rl=vb;this.Ud=Kb;this.Ved=Sb;this.t6j=Yb;this.Zda=Ac}create(b,h){return new Kx(this.ga,new oi.a,this.Gb,this.nab,b,this.Rl,this.uGe,this.tGe,this.zVb,this.vKa,Hh.a.instance,this.NLe,
Ra.App.xa.tq,this.Ud,this.Ved,this.t6j,this.Zda,h)}}Object(m.a)(kB,"Factory",null,[445]);var lB=c(1883),By;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(By||(By={}));Object(m.b)("ModalCalloutSize",By);var rq;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(rq||
(rq={}));Object(m.b)("BeakLocation",rq);class tA{constructor(b,h,u){this.bmo=1;this.OIe=!1;this.QWb=null;this.czn=()=>{this.ib.DA(this.Ioa);this.OIe=!0;this.QWb=null};this.Ioa=(y,P)=>{if(y=P.Ll.kb)1<y.length||!y.length?y=!0:(y=y.Qa,y=y.cpEnd-y.cpBegin,y=1<y||!y),y&&this.OJj()};this.Gb=b;this.ib=h;this.OJj=u}jz(){this.$ck()}d9(){this.OIe?(this.ib.$ba(this.Ioa),this.OIe=!1):this.QWb&&(this.Gb.Se(this.QWb),this.QWb=null)}$ck(){this.QWb=new sc.a(2,1,this.bmo,this.czn);this.Gb.Xb(this.QWb)}}Object(m.a)(tA,
"CalloutDismissManager",null,[]);class dt{constructor(b,h,u,y){this.dismiss=()=>{this.Iw&&(this.Loc.d9(),this.jVc.dismiss())};this.jVc=b;this.Lp=y;this.Loc=new tA(h,u,this.dismiss)}get Iw(){return this.jVc.Iw}show(){if(!this.Iw){const b=document.createElement("div");b.classList.add(dt.Tcn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.jVc.content=b;this.jVc.show();this.Lp&&this.Lp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Loc.jz()}}dispose(){this.dismiss();
this.jVc.dispose()}static SUk(b,h){h=lB.a.iAh(Je.a.getElementBounds(b.targetElement),h,Ra.App.xa.vC,By.small);h.tea=dt.Hgf(b);h.Qt=!1;return h}static Hgf(b){let h=rq.bottomCenter;Object(jb.a)(472,b.view)&&b.view.isHeader&&(h=rq.topCenter);return h}}dt.Tcn="PageNumbersCalloutControl";Object(m.a)(dt,"PageNumbersCallOutControl",null,[471]);class mB{constructor(b,h,u){this.$R=null;this.QR=!1;this.dismiss=()=>{this.Iw&&this.$R&&Vj.UISurfaces.KI().then(y=>{this.Loc.d9();y.removeNotification(this.$R);this.QR=
!1;return null},y=>{w.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",y);return null})};this.Xl=b;this.Loc=new tA(h,u,this.dismiss)}get Iw(){return this.QR}show(){this.Iw||Vj.UISurfaces.KI().then(b=>{const h=b.callout(Object.assign(new Vh.a,{target:this.Xl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),u=Object.assign(new ho.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.QR=!0},expirationOptions:Object.assign(new ao.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.$R=b.addNotification(h,u);this.Loc.jz();return null},b=>{w.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(m.a)(mB,"ReactPageNumbersCallOutControl",null,[471]);class sz{constructor(b,h,u){this.ib=h;this.Gb=b;this.Lp=u}create(b,h){if(r.AFrameworkApplication.ta.Pb&&r.AFrameworkApplication.ta.Pb.kPa)return new mB(h.targetElement,this.Gb,this.ib);b=dt.SUk(h,b);return new dt(b,this.Gb,this.ib,this.Lp,r.AFrameworkApplication.ta.FO)}}
Object(m.a)(sz,"Factory",null,[444]);class nB{constructor(b,h){this.OD=null;this.eYj=b;this.Vi=h}get control(){return this.OD}showCallout(b){this.control&&this.control.Iw&&this.control.dismiss();this.OD=this.bkn(b);this.control.show()}aGh(){this.control&&(this.control.dismiss(),this.OD=null)}bkn(b){const h=this.Vi.oma();this.OD=this.eYj.value.create(h,b);return this.control}}Object(m.a)(nB,"PageNumbersCalloutControlManager",null,[446]);var tz=c(764);class uA extends Ii.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(m.a)(uA,"PageNumberGalleryButtonProps",Ii.a,[]);const sw=(b,h,u)=>{b=b.Bk();b.set(u);h.THb(b);return b};class au{constructor(b,h,u){this.Cxe=!1;this.Zda=h;this.Sl=u}get tEb(){return this.Cxe}qNl(){const b=Object.assign(new $f.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.Eak());b.MenuSectionList.push(this.tbk());b.MenuSectionList.push(this.Vbk());return b}lyo(b){this.Cxe=b;this.KSi()}kKn(){this.Cxe=!1;const b={};b[au.oci]="CheckboxModel";
this.Zda(b);this.KSi()}Eak(){const b=Object.assign(new xi.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:A.a.Cf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new tz.a,{Id:au.Oam,Command:Rc.a.tEb.toString(),QueryCommand:Rc.a.QTf.toString(),LabelText:A.a.Cf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:A.a.Cf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}tbk(){const b=Object.assign(new xi.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new vs.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Sl){for(var u=3;1<=u;u--)h.GalleryItems.push(this.cjf(u));for(u=6;4<=u;u--)h.GalleryItems.push(this.cjf(u))}else for(u=
1;6>=u;u++)h.GalleryItems.push(this.cjf(u));b.ControlList.push(h);return b}Vbk(){const b=Object.assign(new xi.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Qe.a,{Id:"btnRemovePageNumber",Command:Rc.a.c0c.toString(),LabelText:A.a.Cf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:A.a.Cf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:r.AFrameworkApplication.Cr,Image16by16Class:Gd.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}cjf(b){const h=au.OOf+b.toString();var u=Object,y=u.assign,P=new uA,aa=Rc.a.sei.toString(),ta=Rc.a.a6d.toString(),Pa=A.a,vb=Pa.Cf;let Kb="";switch(b){case 1:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Kb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return y.call(u,P,{Id:h,Command:aa,QueryCommand:ta,Alt:vb.call(Pa,Kb)})}KSi(){const b={};for(let h=1;6>=h;h++)b[au.OOf+h.toString()]="PageNumberGalleryButtonModel";b[au.oci]="CheckboxModel";this.Zda(b)}static rNl(b){return b?parseInt(b.substr(au.OOf.length)):1}}au.Oam="btnIncludePageCount";au.oci="IncludePageCount";au.OOf="btnPageNumbersPosition";
Object(m.a)(au,"PageNumbersControl",null,[447]);class Kq{constructor(b,h,u,y,P=null,aa=null,ta=null,Pa=null){this.KEl=(vb,Kb)=>{const Sb=new Ah.a;vb=4>vb;switch(Kb){case 1:case 2:Sb.add(vb?0:3);break;case 3:case 4:Sb.add(vb?0:3),Sb.add(vb?1:4)}return Sb};this.Uxl=(vb,Kb,Sb)=>{var Yb=sw(this.Zc,this.Rl,vb);this.Rl.UHb(Yb,Sb);let Ac=this.jIj(Yb,Kb);if(Ac)this.zVb.XVi(Ac);else{Yb=sw(this.Zc,this.Rl,vb);this.Rl.UHb(Yb,Sb);Yb.Vd();if(wg.OutlineElementReader.Oh(Yb)&&(og.OutlineElementNavigator.Ee(Yb),be.ParagraphReader.rh(Yb))){Yb=
Yb.currentNode;const Sc=this.b6h(Kb);be.ParagraphReader.Vv(Yb)===Sc&&this.zVb.XVi(Yb)&&(Ac=Yb)}Ac||(Yb=sw(this.Zc,this.Rl,vb),this.Rl.UHb(Yb,Sb),this.JK.Qhb(Yb,null,!0),Ac=og.OutlineElementNavigator.Ee(Yb),this.zD(Kb,Ac))}return Ac};this.Vxl=(vb,Kb)=>{let Sb=null;vb.Rb(1);if(wg.OutlineElementReader.Oh(vb)&&(vb.Rb(2),xh.TableReader.isTable(vb))){var Yb=vb.currentNode;if(3===xh.TableReader.Wg(Yb)){let Ac=0;Yb=xh.TableReader.qm(Yb);switch(Kb){case 1:case 4:Ac=Yb?2:0;break;case 2:case 5:Ac=1;break;case 3:case 6:Ac=
Yb?0:2}wf.moveToCellContent(vb,0,Ac);vb.currentNode&&wg.OutlineElementReader.Oh(vb)&&(vb=og.OutlineElementNavigator.Ee(vb),be.ParagraphReader.ic(vb)&&(Sb=vb))}}return Sb};this.Gpm=(vb,Kb)=>{const Sb=sw(this.Zc,this.Rl,vb);vb=Sb.currentNode.ia(Lc.a.Hha,0);this.Rl.UHb(Sb,Kb);Kb=Sb.currentNode.ia(Lc.a.Hha,0);return vb===Kb};this.Zc=b;this.gYj=h;this.zVb=u;this.Rl=y;this.Pqc=P||this.KEl;this.kIj=aa||this.Uxl;this.jIj=ta||this.Vxl;this.oRj=Pa||this.Gpm}get JK(){return null!=this.$tg?this.$tg:this.$tg=
Ja.a.instance.resolve("Box4.IOutlineEditor")}Jgm(b,h,u){var y=sw(this.Zc,this.Rl,b).Hn;y=this.Rl.Jfa(y);y=this.Pqc(h,y);let P=null;for(let ta=0;ta<y.length;ta++){var aa=y.ig(ta);this.oRj(b,aa)&&(aa=this.kIj(b,h,aa),P=this.gYj.sbk(aa,u)||P)}return P}zD(b,h){Kq.zca.$ae(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);Kq.paragraphEditor.zD(h,this.b6h(b))}b6h(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get paragraphEditor(){return null!=
Kq.Wug?Kq.Wug:Kq.Wug=Ja.a.instance.resolve("Box4.IParagraphEditor")}static get zca(){return null!=Kq.uwg?Kq.uwg:Kq.uwg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(m.a)(Kq,"PageNumbersInserter",null,[442]);var zu=c(876),ex=c(884);class qv{constructor(b,h,u=null,y=null,P=null){this.$Qk=(aa,ta)=>{aa=nf.a.Uc(aa,be.ParagraphReader.textLength(aa));const Pa=aa.node.Jc;return Pa?qv.characterPropertiesEditor.Qfa(aa,vb=>{vb=ex.a.getInstance(vb);this.tBd(vb,15,Pa,ta);this.tBd(vb,47,Pa,ta);this.tBd(vb,
16,Pa);this.tBd(vb,17,Pa);return vb}):null};this.khm=(aa,ta)=>{aa=nf.a.Uc(aa,be.ParagraphReader.textLength(aa));qv.characterPropertiesEditor.replaceTextRange(aa,ta)};this.Ic=b;this.Vld=u||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.sqe=y||this.$Qk;this.l8g=P||this.khm}sbk(b,h){const u=this.Ic.Qc(15);u.Eb(b);var y=be.ParagraphReader.text(b),P=!1;0<y.length&&" "!==y.charAt(y.length-1)&&(P=!0);if(h){h=String.format(this.Vld,"#","$");P&&(h=" "+h);P=h.indexOf("#");y=h.indexOf("$");
w.ULS.shipAssertTag(4256717,309,-1!==P,"{0}",{["PageNumberIndex"]:P});w.ULS.shipAssertTag(4256718,309,-1!==y,"{0}",{["PageCountIndex"]:y});w.ULS.shipAssertTag(4256719,309,P!==y,"{0}",{["PageNumberIndex"]:P,["PageCountIndex"]:y});let Pa;let vb;if(P<y){var aa=P;Pa=y;var ta=zu.a.OKc(0);vb=zu.a.OKc(1)}else aa=y,Pa=P,ta=zu.a.OKc(1),vb=zu.a.OKc(0);this.etf(b,h,0,aa);ta=this.sqe(b,ta);this.etf(b,h,aa+1,Pa);aa=this.sqe(b,vb);this.etf(b,h,Pa+1,h.length);b=P<y?ta:aa}else P&&this.l8g(b," "),b=this.sqe(b,zu.a.OKc(0));
u.dispose();return b}tBd(b,h,u,y=null){const P=new at.a;P.setValue(Ge.a.Y8,!0);P.setValue(Lc.a.rBb,1);P.setValue(Lc.a.Qq,h);switch(h){case 15:P.setValue(Lc.a.pPa,!0);P.setValue(Lc.a.fieldInstruction,y);break;case 47:P.setValue(Lc.a.fieldInstruction,y);break;case 17:P.setValue(Lc.a.cGb,!0)}h=u.av(P,T.a.create());this.rck(b,h)}rck(b,h){b.Dsa(h,T.a.nil,ro.AParagraphNode.UB,null)}etf(b,h,u,y){h=h.substring(u,y);0<h.length&&this.l8g(b,h)}static get characterPropertiesEditor(){return qv.Rd||(qv.Rd=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){qv.Rd=
b}}qv.Rd=null;Object(m.a)(qv,"PageNumbersNodeLevelInserter",null,[440]);class Xu{Vcn(b){return Xu.IPl(b)}static IPl(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Xu.yJi,Xu.yJi)}}Xu.yJi="1";Object(m.a)(Xu,"PageNumbersPositionPreviewGenerator",null,[439]);class Xh{constructor(){this.OEg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.HHj=this.OEg.length}Z6l(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===be.ParagraphReader.textLength(b)?{returnValue:!0,CYc:h}:{returnValue:!1,CYc:-1}}K5l(b){let h=b.characterData.lastIndexOf(this.OEg);return-1!==h&&h+this.HHj===be.ParagraphReader.textLength(b)?{returnValue:!0,CYc:h}:{returnValue:!1,CYc:-1}}C6l(b){return En.a(b,9)?!0:!1}}Object(m.a)(Xh,"PageNumbersReader",null,[437]);class vA{constructor(b,h,u,y,P,aa=null,ta=null){this.oEn=(Pa,vb,Kb,Sb)=>{Pa=sw(this.Zc,this.Rl,
Pa);this.Rl.UHb(Pa,vb);vb=tj.a.lq(Pa);for(Pa=!1;vb.moveNext();){const Yb=vb.currentNode;if(be.ParagraphReader.ic(vb.currentNode)&&En.a(vb.currentNode,9)){Pa=!0;let Ac;const Sc=({ETd:Ac}=Kb(Yb,Ac)).returnValue;let nd=Sc;nd=this.VCn(Yb,nd);nd=this.IEn(Yb,nd);-1<Sc&&(nd===Sc&&Ac||Sb(Yb,nd))}}Pa&&this.Ud.Ds(12)};this.Zc=b;this.Rl=h;this.vGe=u;this.Ud=y;this.Nwc=P;this.Pqc=aa||It.a.e8e;this.t_j=ta||this.oEn;this.Vld=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.oLg=String.format(this.Vld,
"#","$");this.HPj=this.oLg.indexOf("#");this.GPj=this.oLg.indexOf("$");this.Rue=String.format(this.Vld,"\ufffc","\ufffc");this.hLg=this.Rue.length}c0c(b,h,u){var y=sw(this.Zc,this.Rl,b).Hn;y=this.Rl.Jfa(y);y=this.Pqc(y);for(const P of y)this.t_j(b,P,h,u)}XVi(b){if(this.vGe.C6l(b)){let h=-1;if(({CYc:h}=this.vGe.K5l(b)).returnValue&&this.hrh(b,h)||({CYc:h}=this.vGe.Z6l(b)).returnValue&&this.BCk(b,h))return!0}return!1}IEn(b,h){var u=b.qa.length;for(let P=0;P<u;P++){var y=b.qa.J(P);y.blob&&9===y.blob.li&&
(y=y.cp,u=nf.a.createTextRange(b,y,y+1),this.Nwc(u,""),u=b.qa.length,P--,h=this.hgh(h,y,1))}return h}VCn(b,h){let u=b.characterData.indexOf(this.Rue);for(;-1!==u;)this.hrh(b,u)&&(h=this.hgh(h,u,this.hLg)),u=b.characterData.indexOf(this.Rue);return h}BCk(b,h){const u=b.qa.ei(h);return u&&u.blob&&9===u.blob.li?(b=nf.a.createTextRange(b,h,h+1),this.Nwc(b,""),!0):!1}hrh(b,h){const u=b.qa.ei(h+this.HPj),y=b.qa.ei(h+this.GPj);return u&&u.blob&&9===u.blob.li&&y&&y.blob&&9===y.blob.li?(b=nf.a.createTextRange(b,
h,h+this.hLg),this.Nwc(b,""),!0):!1}hgh(b,h,u){-1<b&&b>h&&(h=b-h,b=h>u?b-u:b-h);return b}}Object(m.a)(vA,"PageNumbersRemover",null,[438]);class uz{constructor(b,h){this.Npb=this.Mpb=null;this.kr=b;this.Gb=h}ojk(){this.kr.style.display="";this.Mpb||(this.Npb&&(this.Gb.Se(this.Npb),this.Npb=null),this.Mpb=new sc.a(0,1,10,()=>{this.kr.classList.add("Displayed");this.Mpb=null}),this.Gb.Xb(this.Mpb))}qjk(){this.kr.classList.remove("Displayed");this.Npb||(this.Mpb&&(this.Gb.Se(this.Mpb),this.Mpb=null),
this.Npb=new sc.a(0,1,200,()=>{this.kr.style.display="none";this.Npb=null}),this.Gb.Xb(this.Npb))}}Object(m.a)(uz,"PaneControlAnimationHelper",null,[470]);class tw{constructor(b){this.Gb=b}wNl(b){return new uz(b,this.Gb)}}Object(m.a)(tw,"PaneControlAnimationHelperFactory",null,[436]);class sq{constructor(b,h,u,y,P,aa,ta,Pa,vb=!1){this.Pzg=this.uka=this.rfd=null;this.C7l=()=>{this.nu.sendNotification(this.Pzg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.e5=h;this.e5.bind(this);this.Rye=u;this.Xja=P;this.POe=ta;this.Vb=Pa;this.Ogd=vb;this.lda=aa.value.create(u,y);this.e5.vrk(this.lda);this.JY=Rb.KeyInputManager.lc(fb.a.A0,0)}get nu(){return null!=this.Rlg?this.Rlg:this.Rlg=Ja.a.instance.resolve("Common.Utils.IAriaNotifier")}R_(b){this.e5.R_(b);this.uka&&!b&&this.uka.Y5k()}efa(b){this.rfd!==b&&(this.reb(),this.rfd=b)}W3i(b){if(this.rfd){var h=this.Xja.S_a(this.rfd,It.a.JEl(b,this.Rye));this.Ogd?(this.Pzg=this.MRh(b,this.Rye),this.lda.XLb(hf.a.gwd)):
this.Vuo(b);h&&this.EWe(h)}}lkh(b){this.Ogd&&this.Vb&&(b=this.Vb.le(b))&&b.z$(this.C7l)}MRh(b,h){let u="";switch(b){case 1:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:u=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return u}Vuo(b){this.lda.l5i(this.MRh(b,this.Rye),hf.a.gwd)}setInitialSelection(){this.lda.T2c()}EWe(b){this.reb();this.lda.MB(b,b.Wi)}reb(){this.lda.detach()}TXk(){this.uka=
this.POe.value.create(this.e5.Wic);this.i4n(this.uka)}i4n(b){if(this.Vb){const h=this.Vb.le(Fp.a.J0a);h.parent=xe.AFrame.Hp;h.hea(()=>{b.setFocus();this.y2n()});h.bindAction(this.JY,Rc.a.ZS)}}y2n(){if(this.Vb){var b=this.Vb.le(Fp.a.J0a);const h=new ng.DOMFocusListing(()=>this.e5.Wic);h.XFa=!0;h.Go(1);this.Vb.nxd(this.e5.Wic,b,h);b=this.Vb.getRegion(Fp.a.J0a);b.jRa();b.HX=!0;h.nfa&&h.vy(h.nfa)}}dispose(){void 0!==this.uka&&null!==this.uka&&(this.Vb.le(Fp.a.J0a).Mr(this.JY),this.uka.dispose())}Gxn(){void 0!==
this.uka&&null!==this.uka&&this.uka.refresh()}}Object(m.a)(sq,"PaneControl",null,[425]);class Ti{constructor(b,h,u,y){this.Rl=b;this.xOj=h;this.POe=u;this.Vb=y}create(b,h,u,y){return new sq(b,h,u,y,this.Rl,this.xOj,this.POe,this.Vb,r.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(m.a)(Ti,"Factory",null,[399]);var n=c(1082);class C extends iv.a{constructor(b,h,u,y,P,aa,ta,Pa,vb){super();this.init(b);this.il("ShowCalloutForPageNumberOperation");this.UCj=Pa;this.Lhb(this.UCj,
h,y,P,aa);this.Ez=0;this.mab=aa;this.vKa=ta;this.Eh=vb;1===this.behavior&&(this.nr=32,this.hpa())}run(){var b=this.Eh.jb.Jt;if(!this.Ez){var h=bA.a.a5b(this.mab,b);this.mab.BNc(b,h)&&this.mab.oDa(b,h).element&&(this.Ez=1)}1===this.Ez&&(h=bA.a.a5b(this.mab,b),h=this.mab.oDa(b,h),b=new n.a(h.element,b),this.vKa.showCallout(b),this.Ez=2);2===this.Ez&&(this.nr=32,this.hpa())}}Object(m.a)(C,"ShowCalloutForPageNumberOperation",iv.a,[]);class S{constructor(b,h,u){this.vKa=b;this.ga=h;this.YPb=u}create(b,
h,u,y,P,aa){return new C(b,h,u,y,P,aa,this.vKa,this.ga,this.YPb)}}Object(m.a)(S,"Factory",null,[398]);class ka{get JK(){return null!=this.Ytg?this.Ytg:this.Ytg=Ja.a.instance.resolve("Box4.IOutlineEditor")}xc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new oA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.af("WordEditor.HeaderFooter.IPageNumbersActorFactory"),
b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new jB(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),NB.a.g2e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Ra.App.xa.jb,ab.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),r.AFrameworkApplication.ya,b.resolve("Box4.IInteractiveEventNotifier"),
b.Za("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Za("Common.IZoomManager"),b.Pa("Box4.IContentControlViewElementManager"),b.Pa("Box4.CpConversionManagerImpl"),b.Pa("Box4.ContentControlConfigSettings"),b.Pa("Box4.IContentControlReader"),b.Pa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Nv(b.resolve("Box4.SectionAlignedViewPositionProvider"),
b.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Ra.App.instance&&Ra.App.instance.bC)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new rA(vk.App.Fn,b.Za("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),vk.App.Fn,r.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",
()=>new Ti(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.af("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.af("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),ub.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new Zt(()=>{Ra.App.xa.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),r.AFrameworkApplication.ya,
b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new kB(r.AFrameworkApplication.ya,lf.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),
b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,au.rNl,Object(v.a)(Ra.App.xa,Ra.App.xa.s7c,"updateRibbonControl"),Object(v.a)(Ra.App.xa,Ra.App.xa.xG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new mA).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",
()=>new tw(lf.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new Wu(ub.FocusManager.instance(),Ra.App.xa.Bv,b.af("WordEditor.HeaderFooter.IPaneControlFactory"),b.af("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.af("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),r.AFrameworkApplication.ya,new Zf.a(()=>Ra.App.xa.jb.wc),r.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();
b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new Gx(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),se.PageReader.instance,new Zo.a,so.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new vn(new Zo.a,so.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new xy(r.AFrameworkApplication.ya,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
so.a.instance,new Zo.a,new oi.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),xy.v7h,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Sp(lA.a.instance,Sp.XVl(b.resolve("Box4.ITableEditor")),Sp.wvl(),r.AFrameworkApplication.isRtl,og.OutlineElementNavigator.$d,Sp.ZTl(),Sp.xEl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",
()=>new yu(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Zo.a,h=>this.JK.Qhb(h),r.AFrameworkApplication.isRtl,Object(v.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").kMb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Hx(so.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new Ps(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Zo.a,new oi.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),r.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new pv(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),so.a.instance,new Zo.a,r.AFrameworkApplication.ya)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new au(Object(v.a)(Ra.App.xa,Ra.App.xa.s7c,"updateRibbonControl"),Object(v.a)(Ra.App.xa,Ra.App.xa.xG,"updateRibbonControls"),r.AFrameworkApplication.isRtl)).singleInstance();b.register(Xu,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new qv(new oi.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new Kq(new Zo.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new Xh).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new vA(new Zo.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(v.a)(ka.characterPropertiesEditor,ka.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new nB(b.af("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Ra.App.xa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new sz(lf.a.instance,Hh.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new S(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),r.AFrameworkApplication.ya,Ra.App.xa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new ns(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),r.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new wh(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=ka.smg?ka.smg:ka.smg=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(m.a)(ka,"HeaderFooterComponentConfiguration",null,[2]);class Ga{constructor(){this.tfd=
this.W=null}get name(){return"WordEditor.HeaderFooter"}xc(b){this.W=b;(new ka).xc(b)}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()})}$m(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(this.tfd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.tfd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.tfd&&this.tfd.dispose()}static main(){K.a.instance.Kc(new Ga)}}Object(m.a)(Ga,"PackageManager",null,[1,
2]);var db=c(387),Hb=c(519);class qc{constructor(b,h){this.Pf=b;this.zm=h}create(){return new Hb.a(this.Pf.instance,this.zm.instance)}}Object(m.a)(qc,"ContentControlNodeFactory",null,[204]);var Dc=c(1638),hd=c(1029);class ad{create(){return new hd.a}}Object(m.a)(ad,"ContentControlContainerNodeFactory",null,[204]);class zd{constructor(b,h,u,y,P){this.tta=b;this.Nwh=h;this.HAd=u;this.iJ=y;this.Dj=P;this.wNk=new ad;this.W0m=(aa,ta)=>{this.iJ.Sd(()=>{if(ta){ta.Ko.selectedContentControls||(ta.Ko.selectedContentControls=
{});var Pa=ta.Ko.selectedContentControls,vb=ta.ORa;if(vb&&vb.length){var Kb=vb[0];vb=vb[vb.length-1];Kb=this.tta.uhf(nf.a.Uc(Kb.node,Kb.xk),nf.a.Uc(vb.node,vb.$q),!1);for(const Sb of Kb)Pa[Sb.contentControlNode.id.toString()]=!0}}},"CC:OnBeforeCopy")};this.SWc=(aa,ta)=>{this.iJ.Sd(()=>{if(ta){var Pa=ta.clone,vb=ta.original;try{const Kb=ta.Ko.selectedContentControls,Sb=this.tta.Cgf(vb,0,vb.characterData.length,!0,!0,!1);for(const Yb of Sb){const Ac=Yb.oe.toString();Kb[Ac]?Yb.np&&!this.NPk(Yb.contentControlNode,
Pa,Kb)&&(w.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Ac)),this.YWf(Pa,Yb.oe)):this.YWf(Pa,Yb.oe)}}catch(Kb){w.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Kb.toString()),this.Nwh.tCn(Pa)}}},"CC:onParagraphCopy")};this.UWc=(aa,ta)=>{this.iJ.Sd(()=>{if(ta){var Pa=ta.clone,vb=ta.original;try{const Kb=this.tta.Cgf(Pa,0,vb.characterData.length);ta.Ko.ccObjectIdMapping||(ta.Ko.ccObjectIdMapping={});const Sb=
ta.Ko.ccObjectIdMapping;for(let Yb=0;Yb<Kb.count;Yb++){const Ac=Kb.J(Yb),Sc=Ac.oe.toString();if(this.Eum(Ac))if(Ac.Oc){const nd=vb.Hi().Bd.Db(Sc),Ad=this.KOl(Ac),he=this.fHk(nd,Ad.yKi,Ad.Qdi,Pa.Hi().Bd);Sb[Sc]=he.id;this.HAd.Vnj(Sb[Sc],Pa.id,T.a.nil);this.Dj.sac(he)}else this.HAd.Vnj(Sb[Sc],null,Pa.id);Sb[Sc]?(Ac.oe=Sb[Sc],Ac.Ou=null):this.YWf(Pa,Ac.oe)}}catch(Kb){w.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Kb.toString())}}},"CC:onParagraphPaste")}}init(){Kl.a.gek(this.W0m);
Kl.a.evd(this.SWc);Kl.a.FAc(this.UWc)}owl(b){if(!b.Ab(25)||!b.kd(25))return null;if(!b.Lq(25)){const h=this.wNk.create(1074135144);b.Qf(h,25)}return b.Rb(25)}NPk(b,h,u){var y=b.ia(Lc.a.x6,null);const P=yd.GraphIterator.$a(h);h=h.Hi().Bd;u=y&&u[y.toString()]?h.Db(y):this.owl(P);if(!u)return w.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;y=lq.a(b,h,!0);yd.GraphIterator.$a(u).d2(y,26,b.id);54!==u.type&&y.setValue(Lc.a.x6,
u.id);return y}YWf(b,h){this.Nwh.p1k(new ob.a([b]),h)}Eum(b){var h=b.Nb.paragraph.Jc;if(!h)return w.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.oe.toString())),!1;h=h.Db(b.Ou);if(!h)return w.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.oe.toString())),!1;b=h.getValue(Lc.a.Qq);return 38===b||39==b}Sul(b,h){var u,y=b.qa.J(b.qa.length-1);let P=
b.characterData.length;y=(null===(u=null===y||void 0===y?void 0:y.Jb)||void 0===u?void 0:u.length)||0;b.id.equals(h.Nb.paragraph.id)&&(P=h.Nb.cp,y=h.Nb.Jb.EI(h.oe,h.Oc));return this.tta.Dgf(b,0,P,0,y)}KOl(b){let h=null,u=b.Nb.paragraph;const y={};for(;u;){const P=this.Sul(u,b);for(let aa=P.count-1;0<=aa;aa--){const ta=P.J(aa);if(!ta.np)continue;const Pa=ta.oe.toString();if(ta.Oc){if(!y[Pa])return{yKi:ta.contentControlNode,Qdi:h}}else y[Pa]=!0,h||(h=ta.contentControlNode)}u=be.ParagraphReader.Tg(u,
!0,!0)}return{yKi:null,Qdi:h}}fHk(b,h,u,y){let P;h?P=this.HAd.Cua(h):(P=this.HAd.Dua(),h=P.currentNode);b=lq.a(b,y,!0);b.Zg(Lc.a.Ox,Gc.a.lG());54!==h.type&&b.setValue(Lc.a.x6,h.id);P.nH(b,u,26);return b}}Object(m.a)(zd,"ContentControlCCP",null,[]);var ye=c(195),gf=c(726);class ug{constructor(b,h,u,y){this.Rd=b;this.Pf=h;this.eb=u;this.Hd=y}get nX(){return!!this.Pf.instance&&this.Pf.instance.nX}get cFb(){return!!this.Pf.instance&&this.Pf.instance.cFb}Asa(b,h,u,y,P,aa=ye.a.lAb,ta=ye.a.X1b,Pa=null,vb=
ye.a.Y6e,Kb=-1){(b=this.sLd(b,u))?(b.Jb||(b.Jb=new db.a(b)),this.t$j(h,b.Jb,y,P,aa,ta,Pa,vb,Kb)):w.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}eEh(b,h,u){if(b){new ob.a;for(let P=0;P<b.count;P++){var y=this.phf(b.J(P),h,!1);for(const aa of y)this.XCn(aa,u)}}}o1k(b,h){this.eEh(b,h,!0)}p1k(b,h){this.eEh(b,h,!1)}replaceTextRange(b,h,u){this.Rd.replaceTextRange(b,h,u===Oa.a.P3c)}sLd(b,h){var u=nf.a.Uc(b,h);this.Rd.J5a(u);for(u=0;u<b.qa.length;u++){const y=
b.qa.J(u);if(y.cp>h)break;if(y.cp===h)return y}return null}t$j(b,h,u,y,P=ye.a.lAb,aa=ye.a.X1b,ta=null,Pa=ye.a.Y6e,vb=-1){const Kb=h.Nb.paragraph;b=new gf.a(h.Nb,!0,!0,!0,null,b,y,u,P,aa,ta,Pa,null,this.Hd);if(!this.nX||-1>=vb||vb>h.length)vb=h.length;h.insert(b,vb);Kb.Cn();b.Je?Kb.wordRunProperties.WZ(b.Je-1,512):Kb.wordRunProperties.lva(b.Je,512);Kb.wordRunProperties.Sq.Z(b.Je,ys.CharacterPropertiesEditor.IQ);Kb.wordRunProperties.rt.Z(b.Je,ys.CharacterPropertiesEditor.hU)}phf(b,h,u){const y=new ob.a;
for(let P=0;P<b.qa.length;P++){const aa=b.qa.J(P);if(aa.Jb)for(let ta=0;ta<aa.Jb.length;ta++)if(aa.Jb.J(ta).oe.equals(h)&&(y.add(aa.Jb.J(ta)),u))return y}return y}X6c(b,h,u){if(this.cFb&&b){var y=b.node,P=b.xk,aa=b.$q,ta=this.QUh(y,P,h,!0);h=this.QUh(y,aa,h,!1);u?-1!==ta&&ta++:-1!==h&&h++;P||-1===ta||(ta=Math.max(ta,this.eb.rv(y)));aa===this.eb.textLength(y)&&-1!==h&&(h=Math.min(h,this.eb.Pu(y)));b.Fb=ta;b.Tb=h}}QUh(b,h,u,y){return(b=(b=b.qa.ei(h))?b.Jb:null)&&b.length?b.EI(u,y):-1}XCn(b,h){b&&b.Nb.Jb&&
(h?b.Nb.Jb.remove(b):b.Nb.Jb.Soa(b),h=b.Nb.paragraph,0<=b.Je&&b.Je<h.wordRunProperties.length&&(b.Nb.cp||1!==h.wordRunProperties.length||(h.wordRunProperties.WZ(0,512),h.wordRunProperties.Sq.Z(1,ys.CharacterPropertiesEditor.IQ),h.wordRunProperties.rt.Z(1,ys.CharacterPropertiesEditor.hU)),h.wordRunProperties.removeAt(b.Je,512)),h.Cn())}tCn(b){const h=b.qa;if(h){var u=new ob.a;for(let y=0;y<h.length;y++){const P=h.J(y);if(P&&P.Jb){for(let aa=0;aa<P.Jb.length;aa++)u.add(P.Jb.J(aa).Je);P.Jb=null}}b.Roa(u)}}jto(b,
h,u){if(!(0>h||0>u))for(this.Rd.J5a(nf.a.Uc(b,h)),this.Rd.J5a(nf.a.Uc(b,u)),h=b.qa.xaa(h),u=b.qa.xaa(u),--u;u>h;u--)b.qa.removeAt(u)}}Object(m.a)(ug,"ContentControlChpManager",null,[381]);class Ug{constructor(b,h,u,y,P){this.eb=b;this.Np=h;this.yh=u;this.Wc=y;this.Hd=P}ogf(b){if(!b||!Se.SelectionEditor.pf(b))return null;if(!b.cpBegin){const h=this.VSh(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.eb.textLength(b.node)?this.VSh(b.node,b.Fb-1,!1):null}Xtl(b,h){b=this.Wzh(b,h);return this.ogf(b)}VSh(b,
h,u){return b.qa&&b.qa.length?(b=u?b.qa.first.Jb:b.qa.last.Jb)&&0<=h&&h<b.length&&b.J(h).Yf&&b.J(h).Oc===u&&this.suf(b.J(h))?b.J(h):null:null}Hjf(b){if(!b||!Se.SelectionEditor.Xu(b))return null;var h=this.Np.kJd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Yf&&this.suf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Yf&&this.suf(h)?null:b:null}suf(b){if(!b)return!1;var h=this.k1h(b);if(!h)return!1;if(b.Oc)var u=b;else u=h,h=b;var y=this.eb.textLength(b.Nb.paragraph);if(u.Nb.cp||h.Nb.cp!==y||!u.np||
u.Kva||!h.np||h.Kva)return!1;u=u.Nb.Jb;h=h.Nb.Jb;for(y=0;y<u.length&&!u.J(y).oe.equals(b.oe);y++)if(!u.J(y).Oc)return!1;for(u=h.length-1;0<=u&&!h.J(u).oe.equals(b.oe);u--)if(h.J(u).Oc)return!1;return!0}G6c(b){b=this.ogf(b);this.SAd(b,!1)}Xlj(b,h){b=this.Wzh(b,h);this.G6c(b)}mHa(b){b=this.Hjf(b);return this.SAd(b,!0)?b:null}Hkm(b,h){b=this.ogf(b);return!!b&&b.oe.equals(h)}b8b(b,h,u){b=this.Xtl(b,h);return!!b&&b.oe.equals(u)}cwf(b,h){b=this.Hjf(b);return!!b&&b.oe.equals(h)}SAd(b,h){if(!b)return!1;const u=
this.k1h(b);return this.pxh(b,h)&&(!u||this.pxh(u,h))}pxh(b,h){if(!b||b.Yf===h)return!1;var u=this.Np.Kge(b.Nb.paragraph,b.Oc);const y=b.Nb.Jb;-1!==u||b.Oc||(u=y.length);const P=h===b.Oc?1:-1;u+=h?P:0;b=y.EI(b.oe,b.Oc)+P;if(u===b||0<P!==b>u)return w.ULS.shipAssertTag(24933847,368,u!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",u,b,P),w.ULS.shipAssertTag(24933848,368,0<P===b>u,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",
u,b,P),!1;for(var aa=u;aa!==b;aa+=P){var ta=y.J(aa);y.Soa(ta);ta.Yf=h;y.qhm(ta,aa);this.pyo(y.J(aa))}if(this.z7)for(y.Nb.paragraph.Cn(),aa=u;aa!==b;aa+=P)ta=y.J(aa),ta.paragraph.wordRunProperties.Sq.Z(ta.Je,ys.CharacterPropertiesEditor.IQ),ta.paragraph.wordRunProperties.rt.Z(ta.Je,ys.CharacterPropertiesEditor.hU);h||this.PAo(y,u,b,P);w.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-u),h?"block":"inline");return!0}NLd(b){var h,u;return b.Oc&&(Fj.a.hk?this.Hd.Jq(b.contentControlNode.id,
!0):this.Hd.Gs.get(null===(h=b.contentControlNode.id)||void 0===h?void 0:h.toString())).equals(b.Nb.paragraph.id)?38:!b.Oc&&(Fj.a.hk?this.Hd.Jq(b.contentControlNode.id,!1):this.Hd.Ot.get(null===(u=b.contentControlNode.id)||void 0===u?void 0:u.toString())).equals(b.Nb.paragraph.id)?39:b.Yf&&b.Oc?40:b.Yf&&!b.Oc?41:!b.Yf&&b.Oc?38:39}pyo(b){const h=b.Nb.paragraph.Jc;if(h){var u=h.Db(b.Ou),y=b.contentControlNode;if(u){u=u.clone();u.setValue(Lc.a.Fyf,b.Yf);const P=this.NLd(b);u.setValue(Lc.a.Qq,P);h.av(u,
null);b.Ou=u.id}y&&y.setValue(Lc.a.w7,b.Yf)}}k1h(b){if(b.Nb.cp&&b.Nb.cp!==this.eb.textLength(b.Nb.paragraph)||!b.Nb.paragraph.qa||!b.Nb.paragraph.qa.length)return null;const h=b.Oc?b.Nb.paragraph.qa.last:b.Nb.paragraph.qa.first;if(!h.Jb)return null;b=h.Jb.EI(b.oe,!b.Oc);return-1===b?null:h.Jb.J(b)}PAo(b,h,u,y){var P,aa,ta,Pa,vb=b.J(h).contentControlNode;if(vb){var Kb=b.J(h).Oc,Sb=Kb?this.Hd.Gs:this.Hd.Ot;vb=Fj.a.hk?this.Hd.Jq(vb.id,Kb):null!==(aa=Sb.get(null===(P=vb.id)||void 0===P?void 0:P.toString()))&&
void 0!==aa?aa:T.a.nil;if(!vb.equals(T.a.nil))if(b.Nb&&b.Nb.paragraph&&b.Nb.paragraph.id.equals(vb)){for(h+=y;h!==u;h+=y){P=b.J(h).contentControlNode;if(!P)return;Fj.a.hk?this.Hd.yG(P.id,vb,Kb):Sb.set(null===(ta=P.id)||void 0===ta?void 0:ta.toString(),vb)}0<=u&&u<b.length&&b.J(u).Yf&&this.vyf(b.J(u))&&(b=b.J(u).contentControlNode)&&(Fj.a.hk?this.Hd.yG(b.id,vb,Kb):Sb.set(null===(Pa=b.id)||void 0===Pa?void 0:Pa.toString(),vb))}else w.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}vyf(b){return b.np&&
!b.Kva}Wzh(b,h){if(!b||!this.yh)return null;const u=h?nf.a.Uc(b,0):nf.a.Dw(b);b=this.yh.Kq(b,h);u.Tb=u.Fb=b;return u}get z7(){return this.Wc.isFeatureEnabled(27)}}Object(m.a)(Ug,"ContentControlConverter",null,[380]);var zh;(function(b){b[b.qLo=0]="BoundingBox";b[b.rOo=1]="Tags";b[b.xMo=2]="Hidden";b[b.mNo=3]="NumberOfContentControlAppearance"})(zh||(zh={}));Object(m.b)("ContentControlAppearance",zh);var cj;(function(b){b[b.Unknown=-1]="Unknown";b[b.ZNo=0]="RichText";b[b.CNo=1]="PlainText";b[b.ANo=
2]="Picture";b[b.ALo=3]="ComboBox";b[b.fMo=4]="DropDownList";b[b.rLo=5]="BuildingBlockGallery";b[b.Date=6]="Date";b[b.TNo=7]="RepeatSectionItem";b[b.xLo=8]="CheckBox";b[b.SNo=9]="RepeatSection";b[b.Bibliography=10]="Bibliography";b[b.qOo=11]="TableOfContents";b[b.nNo=12]="NumberOfContentControlKinds"})(cj||(cj={}));Object(m.b)("ContentControlKind",cj);class ln{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.m9a=this.lyc=this.wpc=this.pyc=this.Wkd=null;this.Ria=this.nl=this.Ivc=this._id=0;this.gSb=this.PVb=
this.wrd=this._title=this.Nya=null;this.Ihd=this.Hhd=this.qSg=this.Xnd=this.hsc=this.bsc=this.Icd=!1;this.ITg=null;this.Yf=!1;this.Spe=null;this.Ci=u;this.Ex=h;this.ah=y;this.Pr=P;this.zm=aa;this.U0=ta;this.ara=Pa;this.bea=vb;this.fxb=Kb;this.Hd=Sb;b?(this.Wkd=b.id,this.Spe=b,this.gT(!1)):this._id=Gc.a.lG()}get Ji(){return this.Ci.value}get id(){this.gT();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Ox,this._id),this.w0())}get parentId(){this.gT();return this.Ivc}set parentId(b){this.Ivc=
b}get title(){this.gT();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Hdb,this._title),this.w0(),this.Z6c(h=>{h.title=this._title?this._title:ye.a.lAb}))}get tag(){this.gT();return this.wrd}set tag(b){this.wrd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Kdb,this.wrd),this.w0())}get type(){this.gT();return this.nl}set type(b){this.nl=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.nzb,cj[this.nl]),this.w0())}get appearance(){this.gT();
return this.Ria}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Ria=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Idb,zh[this.Ria].toLowerCase()),this.w0(),this.Z6c(h=>{h.appearance=zh[this.Ria].toLowerCase()}))}get color(){this.gT();return this.Nya}set color(b){if(b&&16777215>=b)this.Nya=b,this.isValid()&&(this.contentControlNode.setValue(Lc.a.tEc,this.Nya),this.w0(),this.Z6c(h=>{h.color=this.Nya}));else throw Error.argumentOutOfRange("The color value is out of range.");
}get k4d(){this.gT();return this.PVb}set k4d(b){this.PVb=b}get aEd(){this.gT();return this.gSb}set aEd(b){this.gSb=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.X0b,this.gSb),this.w0())}get C9e(){this.gT();return this.Icd}set C9e(b){b&&(this.Icd=b,this.isValid()&&(this.contentControlNode.setValue(Lc.a.FAd,this.Icd),this.w0()))}get removeWhenEdited(){this.gT();return this.Xnd}set removeWhenEdited(b){if(b&&!this.Yfa)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");
this.Xnd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Pwh,this.Xnd),this.w0())}get Yfa(){this.gT();return this.bsc}set Yfa(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.bsc=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Z0b,this.bsc),this.Z6c(h=>{h.US=this.bsc}),this.w0())}get isEditable(){this.gT();return this.hsc}set isEditable(b){this.hsc=b;this.isValid()&&
(this.contentControlNode.setValue(Lc.a.mzb,this.hsc),this.Z6c(h=>{h.editable=this.hsc}),this.w0())}get isSupported(){this.gT();return this.qSg}get Jum(){return this.isSupported&&11!==this.type&&10!==this.type}get Pxm(){this.gT();return this.gSb&&"table of contents"===this.gSb.toLowerCase()?!0:!1}get bUd(){this.gT();return this.Hhd}set bUd(b){this.Hhd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Rwh,this.Hhd),this.w0())}get g9b(){this.gT();return this.Ihd}set g9b(b){this.Ihd=b;this.isValid()&&
(this.contentControlNode.setValue(Lc.a.Swh,this.Ihd),this.w0())}get kO(){return this.contentControlNode.ia(Lc.a.y6,!1)}set kO(b){this.isValid()&&this.contentControlNode.setValue(Lc.a.y6,b)}get Ws(){this.gT();return this.pyc}set Ws(b){this.pyc=b}get fx(){this.gT();return this.wpc}set fx(b){this.wpc=b}get objectId(){return this.Wkd}set objectId(b){this.Wkd=b;this.Spe=this.Ji.Db(this.Wkd)}get start(){this.rqj();return this.lyc}set start(b){this.lyc=b}get end(){this.rqj();return this.m9a}set end(b){this.m9a=
b}get contentControlNode(){return this.Spe}yen(b){for(let h=0;3>h;++h)if(zh[h].toLowerCase()===b)return h;return 0}zen(b){for(let h=0;12>h;++h)if(cj[h]===b)return h;return-1}w0(){const b=this.start.node;b&&b.setValue(Ge.a.bU,new Date)}o7c(){var b,h,u,y;this._id=this.contentControlNode.ia(Lc.a.Ox,0);this.Ria=this.yen(this.contentControlNode.ia(Lc.a.Idb,null));this.Nya=this.contentControlNode.ia(Lc.a.tEc,null);this._title=this.contentControlNode.ia(Lc.a.Hdb,null);this.wrd=this.contentControlNode.ia(Lc.a.Kdb,
null);this.Yf=this.contentControlNode.ia(Lc.a.w7,!1);this.bsc=this.contentControlNode.ia(Lc.a.Z0b,!1);this.hsc=this.contentControlNode.ia(Lc.a.mzb,!1);this.qSg=this.contentControlNode.ia(Lc.a.Iea,!1);this.gSb=this.contentControlNode.ia(Lc.a.X0b,null);this.Icd=this.contentControlNode.ia(Lc.a.FAd,!1);Fj.a.hk?(this.pyc=this.Hd.Jq(this.contentControlNode.id,!0),this.wpc=this.Hd.Jq(this.contentControlNode.id,!1)):(this.pyc=null!==(h=this.Hd.Gs.get(null===(b=this.contentControlNode.id)||void 0===b?void 0:
b.toString()))&&void 0!==h?h:T.a.nil,this.wpc=null!==(y=this.Hd.Ot.get(null===(u=this.contentControlNode.id)||void 0===u?void 0:u.toString()))&&void 0!==y?y:T.a.nil);this.Ihd=this.contentControlNode.ia(Lc.a.Swh,!1);this.Hhd=this.contentControlNode.ia(Lc.a.Rwh,!1);this.Xnd=this.contentControlNode.ia(Lc.a.Pwh,!1);this.nl=this.zen(this.contentControlNode.ia(Lc.a.nzb,"RichText"));b=null;try{const P=this.contentControlNode.ia(Lc.a.x6,T.a.nil);if(T.a.Qp(P,T.a.nil))this.Ivc=0;else if(b=this.Ji.Db(P))this.Ivc=
b.ia(Lc.a.Ox,0)}catch(P){this.Ivc=0}this.Pzo()}Pzo(){if(this.fxb){var b=this.contentControlNode.ia(Lc.a.K2e,"");if((b=this.ara.k7h(b))&&0<b.length){this.PVb=this.eSh(b.Qa,b.Tc);return}}this.PVb=(b=this.ah.Dua())&&b.currentNode?b.currentNode.ia(Lc.a.uEc,null):null}gT(b=!0){if(!b||this.isValid())b=this.contentControlNode.ia(Ge.a.lastModifiedTime,new Date(0)),this.ITg!==b?(w.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.o7c(),this.ITg=b):w.ULS.sendTraceTag(520734534,
368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}OAo(b,h){var u,y;this.pyc=b;this.wpc=h;Fj.a.hk?this.Hd.yG(this.contentControlNode.id,b,!0):this.Hd.Gs.set(null===(u=this.contentControlNode.id)||void 0===u?void 0:u.toString(),b);Fj.a.hk?this.Hd.yG(this.contentControlNode.id,h,!1):this.Hd.Ot.set(null===(y=this.contentControlNode.id)||void 0===y?void 0:y.toString(),h)}rqj(){if(this.contentControlNode){var b=this.Ws,h=this.fx;if(!b||!h||b.equals(T.a.nil)||
h.equals(T.a.nil))w.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.ah.jma(b,!0),h=this.ah.jma(h,!1),b&&h)if(b.isConnected&&h.isConnected||w.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Yf)b=nf.a.create(b),this.Pr.X6c(b,this.objectId,!0),this.start=b,b=nf.a.create(h),this.Pr.X6c(b,this.objectId,!0),this.end=b;else{let u=h=-1;if(b.qa){for(let y=0;y<b.qa.length&&(-1===
h||-1===u);y++){const P=b.qa.J(y);if(P.Jb)for(let aa=0;aa<P.Jb.length&&(-1===h||-1===u);aa++){const ta=P.Jb.J(aa);T.a.Qp(ta.oe,this.objectId)&&(ta.Oc?h=P.cp:u=P.cp)}}0<=h&&0<=u&&(b=nf.a.IL(h,u,!1,b),this.Pr.X6c(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const u=this.end;if(!h||!u)return b;this.Yf?b=this.eSh(h,u):(h=be.ParagraphReader.text(h.node).substring(h.cpBegin,u.cpEnd),b+=ro.AParagraphNode.uU(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}ebe(b){return this.bea?
this.zm.V7i(this,b)?0:2:2}clear(){return this.bea?this.zm.V7i(this,"")?0:2:2}ZTh(){const b=new ob.a;var h=this.contentControlNode.ia(Lc.a.contentControlNode,[]);for(const u of h)if(!T.a.Qp(u,T.a.nil)){h=this.Ci.value.Db(u);try{b.add(this.U0.Bzb(h,this.Ex,this.Ci,this.ah,this.Pr,this.zm,this.ara,this.bea,this.fxb))}catch(y){}}return b}Lff(){const b=new ob.a;this.XRh(this,b);return b}XRh(b,h){b=b.ZTh();if(b.count)for(const u of b)h.add(u),this.XRh(u,h)}rE(b=!1){const h=new ob.a;if(this.Yf){var u=this.zm.mT(this.start,
this.end);for(var y of u)u=nf.a.create(y),this.Pr.X6c(u,this.objectId,b),h.add(u)}else y=this.start.clone(),this.Pr.X6c(y,this.objectId,b),h.add(y);return h}Z6c(b){const h=this.zm.mT(this.start,this.end);for(let u=0;u<h.count;u++){const y=this.Pr.phf(h.J(u),this.objectId,!1);if(y){for(let P=0;P<y.count;P++)b(y.J(P));h.J(u).ik()}}}eSh(b,h){const u=new Sys.StringBuilder;h=this.zm.mT(b,h);for(const y of h)y.id.equals(b.node.id)||u.append("\r"),u.append(be.ParagraphReader.plainText(y));return u.toString()}}
Object(m.a)(ln,"ContentControl",null,[423]);class Ij{constructor(b){this.Hd=b}Bzb(b,h,u,y,P,aa,ta,Pa,vb){return new ln(b,h,u,y,P,aa,this,ta,Pa,vb,this.Hd)}}Object(m.a)(Ij,"ContentControlFactory",null,[379]);var fp=c(920);class jj{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.Ex=b;this.Ci=h;this.Zc=u;this.yVb=y;this.bIj=P;this.TJ=aa;this.Bh=ta;this.eb=Pa;this.gmd=vb;this.Jed=Kb;this.Hd=Sb}get Gs(){return this.Hd.Gs}get Ot(){return this.Hd.Ot}get fy(){return this.Ex.value}Dua(){const b=this.Zc.Bk();
b.set(this.fy);this.yVb.EQ(b);if(b.Rb(25))return b;this.Jed.instance&&this.Jed.instance.lna&&w.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");w.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}aLc(b,h,u=!1){this.g3b();const y=new ob.a;let P;if(b){P=b.Rb(26);if(!P)return y;for(;P&&(!h(P)||(y.add(P),!u));){y.addRange(this.aLc(b,h));if(u&&0<y.count)break;P=b.yf(26)}b.qc()}return y}oNl(){const b=this.Zc.Bk();b.set(this.Ex.value);
this.yVb.EQ(b);return b.currentNode}iPa(b,h,u){let y;y=b.equals(h);y||(y=(b=this.jma(b,u))?b.id.equals(h):!1);return y}uNa(b,h){var u,y,P,aa;b=this.Ru(b);if(!b)return null;let ta=null;for(;55===b.type;){let Pa;Pa=Fj.a.hk?this.Hd.Jq(b.id,h):h?null!==(y=this.Hd.Gs.get(null===(u=b.id)||void 0===u?void 0:u.toString()))&&void 0!==y?y:T.a.nil:null!==(aa=this.Hd.Ot.get(null===(P=b.id)||void 0===P?void 0:P.toString()))&&void 0!==aa?aa:T.a.nil;if(Pa.equals(ta)){b=null;break}else b=this.Ru(Pa);ta=Pa}return b}jma(b,
h){return(b=this.uNa(b,h))?be.ParagraphReader.ic(b)?b:h?this.eb.Il(b):this.eb.HI(b):null}cEh(b,h=!1){this.Avo(b);this.dEh(b,h)}Avo(b){var h,u,y,P,aa,ta,Pa,vb,Kb=this.Cua(b);Kb=this.Cua(Kb.parentNode);Kb=55===Kb.currentNode.type?Kb.currentNode.id:null;let Sb;Sb=this.Ru(Fj.a.hk?this.Hd.Jq(b.id,!0):null!==(u=this.Hd.Gs.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==u?u:T.a.nil);for(h=this.Ru(Fj.a.hk?this.Hd.Jq(b.id,!1):null!==(P=this.Hd.Ot.get(null===(y=b.id)||void 0===y?void 0:y.toString()))&&
void 0!==P?P:T.a.nil);Sb&&55===Sb.type;)Sb=this.Ru(Fj.a.hk?this.Hd.Jq(Sb.id,!0):null!==(ta=this.Hd.Gs.get(null===(aa=Sb.id)||void 0===aa?void 0:aa.toString()))&&void 0!==ta?ta:T.a.nil);for(;h&&55===h.type;)h=this.Ru(Fj.a.hk?this.Hd.Jq(h.id,!1):null!==(vb=this.Hd.Ot.get(null===(Pa=h.id)||void 0===Pa?void 0:Pa.toString()))&&void 0!==vb?vb:T.a.nil);Sb&&h&&this.Unj(Sb.id,h.id,Kb,Yb=>{Yb=Yb.ia(Lc.a.BW,T.a.nil);return!Yb||Yb.equals(T.a.nil)||b.id.equals(Yb)})}dEh(b,h=!1){var u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,
Ac,Sc;w.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const nd=this.Cua(b),Ad=this.Cua(nd.parentNode);let he=T.a.nil,ce=T.a.nil;var Nd=Ad.currentNode.ia(Lc.a.contentControlNode,[]);const re=new ob.a;for(let vg=0;vg<Nd.length;vg++)re.add(Nd[vg]);if(h){if(54!==Ad.currentNode.type){he=Fj.a.hk?this.Hd.Jq(Ad.currentNode.id,!0):this.Hd.Gs.get(null===(u=Ad.currentNode.id)||void 0===u?void 0:u.toString());ce=Fj.a.hk?this.Hd.Jq(Ad.currentNode.id,!1):this.Hd.Ot.get(null===(y=
Ad.currentNode.id)||void 0===y?void 0:y.toString());Nd=this.Ru(he);for(u=this.Ru(ce);Nd&&55===Nd.type;)he=Fj.a.hk?this.Hd.Jq(Nd.id,!0):this.Hd.Gs.get(null===(P=Nd.id)||void 0===P?void 0:P.toString()),Nd=this.Ru(he);for(;u&&55===u.type;)ce=Fj.a.hk?this.Hd.Jq(u.id,!1):this.Hd.Ot.get(null===(aa=u.id)||void 0===aa?void 0:aa.toString()),u=this.Ru(ce)}P=this.Cua(b);if(P.Rb(26)){aa=new ob.a;for(aa.add(P.currentNode);P.yf(26);)aa.add(P.currentNode);for(var Xd of aa)this.dEh(Xd,h)}}else if(he=Fj.a.hk?this.Hd.Jq(b.id,
!0):this.Hd.Gs.get(null===(ta=b.id)||void 0===ta?void 0:ta.toString()),ce=Fj.a.hk?this.Hd.Jq(b.id,!1):this.Hd.Ot.get(null===(Pa=b.id)||void 0===Pa?void 0:Pa.toString()),h=this.pGl(re,b.id),Xd=this.Cua(b),Xd.Rb(26))for(P=this.Cua(Xd.currentNode),aa=P.currentNode,Nd=b;aa;)u=Xd.currentNode,re.insert(h++,u.id),aa=P.yf(26),y=this.Cua(u),54!==Ad.currentNode.type?u.setValue(Lc.a.x6,Ad.currentNode.id):u.removeProperty(Lc.a.x6),lq.g(y,Ad,Nd,26),Nd=y.currentNode,aa&&(Xd.set(aa),Xd.r0(this.Dua().currentNode));
54!==Ad.currentNode.type&&(h=Fj.a.hk?this.Hd.Jq(Ad.currentNode.id,!0):null!==(Kb=this.Hd.Gs.get(null===(vb=Ad.currentNode.id)||void 0===vb?void 0:vb.toString()))&&void 0!==Kb?Kb:T.a.nil,vb=Fj.a.hk?this.Hd.Jq(Ad.currentNode.id,!1):null!==(Yb=this.Hd.Ot.get(null===(Sb=Ad.currentNode.id)||void 0===Sb?void 0:Sb.toString()))&&void 0!==Yb?Yb:T.a.nil,h.equals(b.id)&&(Fj.a.hk?this.Hd.yG(Ad.currentNode.id,he,!0):this.Hd.Gs.set(null===(Ac=Ad.currentNode.id)||void 0===Ac?void 0:Ac.toString(),he)),vb.equals(b.id)&&
(Fj.a.hk?this.Hd.yG(Ad.currentNode.id,ce,!1):this.Hd.Ot.set(null===(Sc=Ad.currentNode.id)||void 0===Sc?void 0:Sc.toString(),ce)));nd.Jg();w.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(re,b.id);Nd=Array(re.count);for(Sb=0;Sb<re.count;Sb++)Nd[Sb]=re.J(Sb);Ad.currentNode.setValue(Lc.a.contentControlNode,Nd);fp.a.LEa(b.id)}s$j(b,h,u,y,P,aa,ta=null){var Pa,vb,Kb,Sb,Yb,Ac,Sc,nd;let Ad,he;h?(Ad=this.Ru(h.objectId),he=this.Cua(Ad)):(he=this.Dua(),Ad=he.currentNode);const ce=
this.bIj.create(1074135145);ta&&ce.properties.Hs(ta.properties);54!==Ad.type&&ce.setValue(Lc.a.x6,Ad.id);ta?he.DEb(ce,u,26,ta.id):he.nH(ce,u,26);Fj.a.hk?this.Hd.yG(ce.id,P,!0):this.Hd.Gs.set(null===(Pa=ce.id)||void 0===Pa?void 0:Pa.toString(),P);Fj.a.hk?this.Hd.yG(ce.id,aa,!1):this.Hd.Ot.set(null===(vb=ce.id)||void 0===vb?void 0:vb.toString(),aa);b.Yf&&(h&&(u=Fj.a.hk?this.Hd.Jq(Ad.id,!0):null!==(Sb=this.Hd.Gs.get(null===(Kb=Ad.id)||void 0===Kb?void 0:Kb.toString()))&&void 0!==Sb?Sb:T.a.nil,Kb=Fj.a.hk?
this.Hd.Jq(Ad.id,!1):null!==(Ac=this.Hd.Ot.get(null===(Yb=Ad.id)||void 0===Yb?void 0:Yb.toString()))&&void 0!==Ac?Ac:T.a.nil,u.equals(P)&&(Fj.a.hk?this.Hd.yG(Ad.id,ce.id,!0):this.Hd.Gs.set(null===(Sc=Ad.id)||void 0===Sc?void 0:Sc.toString(),ce.id)),Kb.equals(aa)&&(Fj.a.hk?this.Hd.yG(Ad.id,ce.id,!1):this.Hd.Ot.set(null===(nd=Ad.id)||void 0===nd?void 0:nd.toString(),ce.id))),this.Unj(P,aa,ce.id,Nd=>{Nd=Nd.ia(Lc.a.BW,T.a.nil);const re=h?h.objectId:null;return!Nd||Nd.equals(T.a.nil)||Nd.equals(re)}));
P=this.Cua(ce);aa=Array(y.count);for(Yb=y.count-1;0<=Yb;Yb--)aa[Yb]=y.J(Yb).objectId,Ac=this.Ru(y.J(Yb).objectId),Ac=this.Cua(Ac),Ac.currentNode.setValue(Lc.a.x6,ce.id),lq.g(Ac,P,null,26);0<aa.length&&ce.setValue(Lc.a.contentControlNode,aa);jj.$b.isFeatureEnabled(36)&&(b.aEd&&ce.setValue(Lc.a.X0b,b.aEd),b.C9e&&ce.setValue(Lc.a.FAd,!0));return ce}JWn(b,h,u,y,P){b.setValue(Lc.a.w7,h);b.setValue(Lc.a.Z0b,!0);b.setValue(Lc.a.mzb,!0);b.setValue(Lc.a.Ox,u);b.setValue(Lc.a.Idb,zh[0]);b.setValue(Lc.a.Iea,
!0);b.setValue(Lc.a.nzb,cj[P]);y&&b.setValue(Lc.a.kob,y);b.setValue(Lc.a.$0b,0)}Vnj(b,h=null,u=null){h&&(Fj.a.hk?this.Hd.yG(b,h,!0):this.Hd.Gs.set(b.toString(),h));u&&(Fj.a.hk?this.Hd.yG(b,u,!1):this.Hd.Ot.set(b.toString(),u))}qEh(b){if(!b||!b.count||!b.J(0))return null;const h=this.Jlf(b);for(let u=0;u<b.count;u++)this.Bh.pRa(b.J(u));return h}Jlf(b){if(!b||!b.J(0))return null;const h=this.Zc.Bk();h.set(b.J(0));h.zd();h.qc();return h.MI()?h.currentNode:null}xOl(b){const h=this.Zc.Bk();h.set(b);h.zd();
h.qc();h.qc();return h}udh(b,h,u){const y=new ob.a;for(let P=0;P<u;P++){h=this.TJ.Qhb(b,h,!0,null);if(!h||!b.Vd())return null;const aa=b.currentNode;b.qc();b.qc();y.add(aa)}return y}c6b(b){const h=this.Zc.Bk();h.set(b);for(h.Ab(7);h.qc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}W0h(b){const h=this.Zc.Bk();h.set(b);h.zd();return(b=h.I4a())?b.id:null}Mjf(b){const h=this.Zc.Bk();h.set(b);return h.Ab(7)?h:null}Ru(b){return this.Ci.value.Db(b)}g3b(){if(!jj.RPg){var b=
this.Dua();b&&this.Dag(b);jj.RPg=!0}}lSa(b){return this.gmd.lSa(b)}Dhk(b,h){const u=this.Zc.Bk();u.set(b.node);const y=this.Zc.Bk();y.set(h.node);u.zd();y.zd();const P=this.Zc.Bk();P.set(u.currentNode);const aa=this.Zc.Bk();aa.set(y.currentNode);const ta=wf.returnToLowestCommonTableCell(u,y);return ta?(P.zd(),aa.zd(),{returnValue:({Tp:b}=this.Gyd(P,!0,ta,b)).returnValue&&({Tp:h}=this.Gyd(aa,!1,ta,h)).returnValue,gej:b,tJh:h}):{returnValue:({Tp:b}=this.Gyd(u,!0,null,b)).returnValue&&({Tp:h}=this.Gyd(y,
!1,null,h)).returnValue,gej:b,tJh:h}}Gyd(b,h,u,y){let P=null,aa=b.kd(16);for(;aa!==u;){if(h&&hi.TableCellReader.Bom(b)||!h&&hi.TableCellReader.Cki(b))P=b.kd(14);else return{returnValue:!1,Tp:y};aa=b.kd(16)}P&&(y=nf.a.create(P));return{returnValue:!0,Tp:y}}Dag(b){if(b.Rb(26)){for(this.Dag(b);b.yf(26);)this.Dag(b);b.qc()}}remove(b,h){for(let u=0;u<b.count;u++)if(b.J(u).toString()===h.toString()){b.removeAt(u);break}}Cua(b){const h=this.Zc.Bk();h.set(b);h.r0(this.Dua().currentNode);return h}pGl(b,h){for(let u=
0;u<b.count;u++)if(b.J(u).equals(h))return u;return-1}Unj(b,h,u,y){b=this.zxl(b,h);for(h=0;h<b.count;h++)y(b.J(h))&&(u?b.J(h).setValue(Lc.a.BW,u):b.J(h).removeProperty(Lc.a.BW),this.Jed.instance&&this.Jed.instance.yhi&&b.J(h).Ck(16,!0))}zxl(b,h){const u=new ob.a;var y=this.Ru(b);const P=this.Ru(h);if(!y||!P)return u;const aa=({DTc:ta}=this.wId(y,P)).returnValue;y=ta[aa];if(14===y.type)u.add(y);else if(15===y.type&&1<=aa){const Pa=ta[aa-1];1===xh.TableReader.$f(Pa)&&u.add(Pa)}var ta=yd.GraphIterator.$a(aa>=
ta.length-1?y:ta[aa+1]);ta.Ab(7);for(y=Le.a.Vr(ta,y);y.moveNext()&&y.currentNode!==P;)14===y.currentNode.type&&u.add(y.currentNode);if(!T.a.Qp(h,b)&&14===P.type)for(ta=yd.GraphIterator.$a(P),y=Le.a.Vr(ta,P);y.moveNext();)14===y.currentNode.type&&u.add(y.currentNode);return u}wId(b,h){b=this.Nfb(b);h=this.Nfb(h);let u=0;for(;u<b.length&&u<h.length&&b[u]===h[u];++u);return{returnValue:0<u?u-1:u,DTc:b,m_f:h}}Nfb(b){const h=[];h.push(b);b=yd.GraphIterator.$a(b);for(b.Ab(7);b.qc();)h.push(b.currentNode);
h.reverse();return h}static get $b(){return null!=jj.sog?jj.sog:jj.sog=Ja.a.instance.Pa("Box4.IFeatureHelper")}}jj.RPg=!1;Object(m.a)(jj,"ContentControlGraphManager",null,[378]);class mr{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.mqa=null;this.Ssm=(Kb,Sb)=>{if(this.nX)return this.Tsm(Kb,Sb);if(!Kb||!Kb.count)return w.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let Yb=!0;switch(Sb){case 0:Sb=this.WN(Kb.J(0),Kb.J(Kb.count-1),1);if((Kb=this.WN(Kb.J(0),Kb.J(Kb.count-1),
3))&&0<Kb.count){if(!Kb.J(0).isSupported||!Kb.J(0).isEditable){Yb=!1;break}for(Kb=Kb.J(0);Kb;)this.W_c(Sb,Kb.id),Kb=this.getById(Kb.parentId)}if(Sb)for(var Ac of Sb)if(!Ac.isSupported||!Ac.isEditable){Yb=!1;break}break;case 1:if(Kb.J(0).contextId!==oc.a.Vc){w.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");Yb=!1;break}(Sb=this.WN(Kb.J(0),Kb.J(0),1))&&0<Sb.count&&(Yb=!1);break;case 2:if(Kb.J(0).contextId!==oc.a.Vc){w.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Yb=!1;break}(Sb=this.WN(Kb.J(0),Kb.J(0),3))&&0<Sb.count&&(Yb=!1);break;case 3:case 4:Sb=this.FKd(Kb.J(0),!0);Ac=this.FKd(Kb.J(Kb.count-1),!1);if(!Sb||!Ac){w.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");Yb=!1;break}if((Sb=this.WN(Sb,Sb,3))&&0<Sb.count){Yb=!1;break}if((Sb=this.WN(Ac,Ac,3))&&0<Sb.count){Yb=!1;break}if(Sb=
this.zm.WN(Kb.J(0),Kb.J(Kb.count-1),1))for(const Sc of Sb)if(!Sc.Yfa){Yb=!1;break}break;default:Yb=!1}return Yb};mr.Ex=b;mr.Ci=h;this.ah=u;this.Pr=y;this.zm=P;this.U0=aa;this.ara=ta;this.Pf=Pa;this.Np=vb}get SOa(){return!!this.Pf.instance&&this.Pf.instance.SOa}get lna(){return!!this.Pf.instance&&this.Pf.instance.lna}get tSd(){return!!this.Pf.instance&&this.Pf.instance.tSd}get nX(){return!!this.Pf.instance&&this.Pf.instance.nX}get wSd(){return!!this.Pf.instance&&this.Pf.instance.wSd}cFb(){return!!this.Pf.instance&&
this.Pf.instance.cFb}Cka(b,h,u=null,y=null,P=!1){if(!this.SOa)return{returnValue:2,id:0};b=this.ah.jma(b,!0);h=this.ah.jma(h,!1);if(!b||!h)return{returnValue:2,id:0};b=nf.a.create(b);h=nf.a.create(h);return this.fch(b,h,u,y,P,!1)}y9j(b,h,u=!1){return this.SOa&&b&&h?this.fch(b,h,null,null,!1,u):{returnValue:2,id:0}}wxb(b,h=null,u=!1){let y=0;if(!this.SOa)return{returnValue:2,id:y};const P=this.U0.Bzb(h,mr.Ex,mr.Ci,this.ah,this.Pr,this.zm,this.ara,this.SOa,this.tSd);P.type=0;P.start=b;P.end=b;P.Ws=
b.node.id;P.fx=b.node.id;P.Yf=!1;return this.zm.idh(P,h,u)?(y=P.id,{returnValue:0,id:y}):{returnValue:2,id:y}}r$j(b,h=null){if(!this.SOa||!this.xpm(b))return{returnValue:2,id:0};var u=b.J(0).contextId===oc.a.endOfParagraph?b.J(1):b.J(0);const y=b.J(b.count-1);if(this.r2e(b,oc.a.paragraph)||this.r2e(b,oc.a.endOfParagraph)){b=u.node.id;let P=y.node.id;const aa=b.equals(P);u=this.zm.Hdj(u,!0);void 0!==u&&null!==u&&(b=u,P=aa?b:P);this.zm.Hdj(y,!1);h.setValue(Lc.a.w7,!0);return this.Cka(b,P,h)}return u!==
y||u.contextId!==oc.a.Fd&&u.contextId!==oc.a.Vc?{returnValue:2,id:0}:(h.setValue(Lc.a.w7,!1),this.wxb(u,h))}getById(b){if(!this.lna)return null;const h=this.ah.aLc(this.ah.Dua(),u=>u.getValue(Lc.a.Ox)===b,!0);return 0<h.count?this.zm.ZP(h.J(0)):null}getByTitle(b){if(!this.lna)return null;const h=this.ah.aLc(this.ah.Dua(),y=>y.ia(Lc.a.Hdb,null)===b,!1),u=new ob.a;for(const y of h)u.add(this.zm.ZP(y));return u}getByTag(b){if(!this.lna)return null;const h=this.ah.aLc(this.ah.Dua(),y=>y.ia(Lc.a.Kdb,null)===
b,!1),u=new ob.a;for(const y of h)u.add(this.zm.ZP(y));return u}WN(b,h,u,y=!1){return this.lna?this.nX?this.zm.saa(b,h,u):this.zm.WN(b,h,u,y):null}mT(b,h){return this.zm.mT(b,h)}Xrl(){if(!this.lna)return null;const b=this.ah.aLc(this.ah.Dua(),()=>!0,!1),h=new ob.a;for(const u of b)h.add(this.zm.ZP(u));return h}Tlb(b){if(!this.SOa)return w.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.zm.Xwa(b)?0:2}e1k(b){if(!this.SOa)return 2;
b=this.getById(b);return this.zm.deleteContentControl(b)?0:2}I$j(b){this.zm.wyn(b)}krk(b){this.mqa=b;this.mqa.sAn(this.Ssm)}Pxl(b){if(!this.cFb())return null;let h;var u=b.rE();h=this.FKd(u.J(u.count-1),!1);u=this.Pr.sLd(u.J(u.count-1).node,h.cpBegin).Jb;b=this.xWl(u,b);if(-1===b)return null;h.Fb=b;h.Tb=h.Fb;return h}Tsm(b,h){if(!b||!b.count)return w.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.Lnm(b);case 3:case 4:case 6:return this.Tum(b,
6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==oc.a.Vc?(w.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.gki(b.J(0),5===h,!1);default:return!1}}Lnm(b){const h=this.zm.saa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var u=h.J(0);if(!u.isSupported||!u.isEditable)return!1}b=this.zm.saa(b.J(0),b.J(b.count-1),1);for(u=0;h&&u<h.count;u++)this.W_c(b,h.J(u).id);if(b)for(const y of b)if(!y.isSupported||
!y.isEditable)return!1;return!0}Tum(b,h){var u=b.J(0),y=b.J(b.count-1),P=u.xk,aa=y.$q;if(-1===P||-1===aa)return!1;P=this.Np.b7(u.node,P,u.Fb);aa=this.Np.b7(y.node,aa,y.Tb);var ta=-1,Pa=Math.min(P.count,aa.count);for(--Pa;0<=Pa;Pa--){const vb=P.J(Pa).oe,Kb=aa.J(Pa).oe;if(vb.equals(Kb)){ta=Pa;break}}if(-1<ta&&(Pa=this.zm.ZP(P.J(ta).contentControlNode),!Pa.isEditable||!Pa.isSupported||Pa.kO&&!this.rnm(Pa,b)))return!1;u=this.zm.saa(u,y,1);for(y=0;y<=ta;y++)this.W_c(u,this.zm.ZP(P.J(y).contentControlNode).id);
for(y=ta+1;y<P.count;y++){Pa=this.zm.ZP(P.J(y).contentControlNode);if(!Pa.isEditable||!Pa.Yfa||!Pa.isSupported||Pa.kO)return!1;this.W_c(u,Pa.id)}for(P=ta+1;P<aa.count;P++){ta=this.zm.ZP(aa.J(P).contentControlNode);if(!ta.isEditable||!ta.Yfa||!ta.isSupported||ta.kO)return!1;this.W_c(u,ta.id)}if(u)for(const vb of u)if(!vb.isSupported||!vb.Yfa)return!1;return h&&(b=this.FKd(b.J(0),!0))?this.gki(b,!0,!0):!0}rnm(b,h){h=this.Np.tOl(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.oe)}gki(b,h,
u){return(b=this.zm.saa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.wSd&&h&&!b.Yf||!u&&b.kO)?!1:!0}FKd(b,h){if(!b)return null;let u=null;switch(b.contextId){case oc.a.paragraph:u=h?nf.a.Uc(b.node,0):nf.a.Dw(b.node);break;case oc.a.endOfParagraph:u=nf.a.Dw(b.node);break;case oc.a.Fd:u=h?nf.a.Uc(b.node,b.cpBegin):nf.a.Uc(b.node,b.cpEnd);break;case oc.a.Vc:u=b}u&&(u.Tb=u.Fb=h?b.Fb:b.Tb);return u}W_c(b,h){if(b)for(const u of b)if(u.id===h){b.remove(u);break}}xWl(b,h){if(!b)return-1;
let u=-1;for(let y=0;y<b.length;y++)if(b.J(y).oe.equals(h.objectId)&&!1===b.J(y).Oc){u=y;if(h.Yf&&0<y&&b.J(y-1).Yf&&!b.J(y-1).Oc)return-1;break}return u}xpm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const u=b.J(h).contextId;if(u!==oc.a.paragraph&&u!==oc.a.endOfParagraph&&u!==oc.a.Fd&&u!==oc.a.Vc||0<h&&h<b.count-1&&u===oc.a.Fd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===oc.a.endOfParagraph&&1===b.count||this.r2e(b,oc.a.Vc)&&
1<b.count?!1:!0}r2e(b,h){for(const u of b)if(u.contextId===h)return!0;return!1}fch(b,h,u=null,y=null,P=!1,aa=!1){let ta=0;var Pa=h.node;let vb=nf.a.create(b.node);Pa=nf.a.create(Pa);if(!({gej:vb,tJh:Pa}=this.ah.Dhk(vb,Pa)).returnValue)return{returnValue:2,id:ta};const Kb=this.U0.Bzb(u,mr.Ex,mr.Ci,this.ah,this.Pr,this.zm,this.ara,this.SOa,this.tSd);Kb.type=0;Kb.start=b;Kb.end=h;Kb.Ws=vb.node.id;Kb.fx=Pa.node.id;Kb.Yf=!0;Kb.aEd=y;Kb.C9e=P;return this.zm.idh(Kb,u,aa)?(ta=Kb.id,{returnValue:0,id:ta}):
{returnValue:2,id:ta}}}mr.Ex=null;mr.Ci=null;Object(m.a)(mr,"ContentControlManager",null,[377]);var bu=c(703),Au=c(166),Lq=c(197);class et extends Sys.EventArgs{constructor(b){super();this.g_k=b}}Object(m.a)(et,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class rv{constructor(){this.OAi=0;this.CKi=null}}Object(m.a)(rv,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);class Er{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce,Nd,re,Xd,vg,Vf,kj){this.Dj=kj;this.B1g=[];
this.qIe=[];this.Ex=b;this.Ci=h;this.ah=u;this.Pr=y;this.U0=P;this.ze=vb;this.Kz=Kb;this.ib=aa;this.YD=ta;this.Yza=Pa;this.ara=Sc;this.fxb=nd;this.bea=Sb;this.LH=Yb;this.ga=Ac;this.Np=Ad;this.Pf=he;this.yh=ce;this.eb=Nd;this.Ic=re;this.N$g=Xd;this.Wc=vg;this.Hd=Vf;this.LH&&(this.LH.addHandler(bu.a.LKb,Object(v.a)(this,this.hHi,"onShowingPlaceholder")),this.LH.addHandler(bu.a.l8d,Object(v.a)(this,this.rGi,"onRemoveWhenEdited")))}get fy(){return this.Ex.value}get Ji(){return this.Ci.value}get nX(){return!!this.Pf.instance&&
this.Pf.instance.nX}get z7(){return!!this.Wc&&this.Wc.isFeatureEnabled(27)}dispose(){this.LH&&(this.LH.removeHandler(bu.a.LKb,Object(v.a)(this,this.hHi,"onShowingPlaceholder")),this.LH.removeHandler(bu.a.l8d,Object(v.a)(this,this.rGi,"onRemoveWhenEdited")))}WN(b,h,u,y=!1){if(this.nX)return this.saa(b,h,u);if(!b||!h)return null;const P=this.ah.jma(b.node.id,!0);var aa=this.ah.jma(h.node.id,!1);if(!P||!aa)return null;b=b.contextId===oc.a.endOfParagraph?b:nf.a.Uc(P,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===
oc.a.endOfParagraph?h:nf.a.Uc(aa,-1===h.cpEnd?aa.characterData.length:h.cpEnd);aa=null;switch(u){case 0:aa=this.TBl(b,h);break;case 1:aa=this.EOl(b,h);break;case 3:aa=this.z1h(b,h,y);break;case 2:aa=this.yXl(b,h);break;case 4:aa=this.uhf(b,h,!1)}return aa}saa(b,h,u){if(!b||!h||b.contextId!==oc.a.endOfParagraph&&(b=this.qxh(b,!0),!b)||h.contextId!==oc.a.endOfParagraph&&(h=this.qxh(h,!1),!h))return null;let y=null;switch(u){case 0:y=this.UBl(b,h);break;case 1:y=this.FOl(b,h);break;case 3:y=this.A1h(b,
h);break;case 2:y=this.zXl(b,h);break;case 4:y=this.uhf(b,h,!0)}return y}qxh(b,h){var u=this.ah.jma(b.node.id,h);if(!u)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?u.characterData.length:b.cpEnd,b=b.Tb);u=nf.a.Uc(u,h);u.Fb=b;u.Tb=b;return u}TBl(b,h){const u=new ob.a;if(b.contextId===oc.a.endOfParagraph||h.contextId===oc.a.endOfParagraph||b.equals(h))return u;const y=new lg.a,P=this.YBb(b,b),aa=this.YBb(h,h);for(let ta=0;ta<P.count;ta++)if(P.J(ta).Oc)for(let Pa=0;Pa<aa.count;Pa++)aa.J(Pa).Oc||
P.J(ta).oe.equals(aa.J(Pa).oe)&&(!P.J(ta).Yf||this.ah.iPa(P.J(ta).oe,b.node.id,!0)&&this.ah.iPa(aa.J(Pa).oe,h.node.id,!1))&&this.qud(u,y,P.J(ta).oe);return u}UBl(b,h){const u=new ob.a;if(b.contextId===oc.a.endOfParagraph||h.contextId===oc.a.endOfParagraph||b.equals(h)&&b.Fb===b.Tb||-1===b.Fb||-1===h.Tb)return u;var y=b.node.qa.ei(b.cpBegin),P=h.node.qa.ei(h.cpEnd);y&&y.Jb&&0<y.Jb.length&&b.Fb<=y.Jb.length&&P&&P.Jb&&0<P.Jb.length&&h.Tb<=P.Jb.length&&(b=b.Fb,h=h.Tb,b===y.Jb.length&&b--,0<h&&h--,y=y.Jb.J(b),
P=P.Jb.J(h),y.Oc&&!P.Oc&&T.a.Qp(y.oe,P.oe)&&y.np&&P.np&&(P=y.contentControlNode)&&u.add(this.ZP(P)));return u}EOl(b,h){const u=new ob.a,y=new lg.a,P=this.YBb(b,h);for(let aa=0;aa<P.count;aa++)this.qud(u,y,P.J(aa).oe);b=this.z1h(b,h,!1,!1);for(const aa of b)y.contains(aa.objectId)||(u.add(aa),y.add(aa.objectId));return u}FOl(b,h){const u=new ob.a,y=new lg.a,P=this.Bgf(b,h);for(let aa=0;aa<P.count;aa++)this.hSe(u,y,P.J(aa));b=this.A1h(b,h);for(const aa of b)y.contains(aa.objectId)||(u.add(aa),y.add(aa.objectId));
return u}z1h(b,h,u,y=!0){const P=new ob.a;b.equals(h)&&(u=!1);const aa=new lg.a;let ta=!1;b=this.YBb(null,b,!0,u);h=this.YBb(h,null,u,!0);for(u=b.count-1;0<=u;u--){for(let Pa=0;Pa<h.count&&!(b.J(u).oe.equals(h.J(Pa).oe)&&(b.J(u),this.qud(P,aa,b.J(u).oe)&&(ta=!this.ah.Ru(b.J(u).oe).ia(Lc.a.x6,null),y||ta)));Pa++);if(0<P.count&&(y||ta))break}return P}A1h(b,h){const u=new ob.a,y=new lg.a,P=b.node;var aa=h.node;const ta=h.contextId===oc.a.endOfParagraph?aa.characterData.length:h.cpEnd;b=this.Np.b7(P,
b.contextId===oc.a.endOfParagraph?P.characterData.length:b.cpBegin,b.Fb);h=this.Np.b7(aa,ta,h.Tb);aa=b.count>h.count?h.count:b.count;for(--aa;0<=aa;aa--)b.J(aa).oe.equals(h.J(aa).oe)&&this.hSe(u,y,b.J(aa));return u}yXl(b,h){const u=new ob.a;let y=new lg.a;const P=this.YBb(b,h);let aa=0,ta=null;if(b.equals(h))return u;for(b=0;b<P.count;b++)!P.J(b).Oc||P.J(b).Yf&&!this.ah.iPa(P.J(b).oe,P.J(b).Nb.paragraph.id,!0)?P.J(b).Oc||P.J(b).Yf&&!this.ah.iPa(P.J(b).oe,P.J(b).Nb.paragraph.id,!1)||(aa--,0>aa?(aa=
0,y=new lg.a):!aa&&ta&&P.J(b).oe.equals(ta)&&this.qud(u,y,ta)):(aa||(ta=P.J(b).oe),aa++);return u}zXl(b,h){const u=new ob.a;if(b.equals(h)&&b.Fb===h.Tb)return u;let y=new lg.a;b=this.Bgf(b,h);h=0;let P=null;for(let aa=0;aa<b.count;aa++){const ta=b.J(aa);!ta.Oc||ta.Yf&&!this.ah.iPa(ta.oe,ta.Nb.paragraph.id,!0)?ta.Oc||ta.Yf&&!this.ah.iPa(ta.oe,ta.Nb.paragraph.id,!1)||(h--,0>h?(h=0,y=new lg.a):!h&&P&&ta.oe.equals(P.oe)&&this.hSe(u,y,P)):(h||(P=ta),h++)}return u}uhf(b,h,u){const y=new ob.a;b=u?this.Bgf(b,
h):this.YBb(b,h);h=0;for(u=0;u<b.count;u++){var P=b.J(u);P.np&&(P.Oc?h++:(h--,0>h?h=0:(P=this.ZP(P.contentControlNode))&&y.add(P)))}return y}YBb(b,h,u=!0,y=!0){const P=new ob.a,aa=this.mT(b,h);if(!aa.count)return P;let ta,Pa,vb,Kb;for(let Sb=0;Sb<aa.count;Sb++){ta=0;Pa=aa.J(Sb).characterData.length;vb=Kb=!0;if(b&&aa.J(Sb).id.equals(b.node.id)){if(b.contextId===oc.a.endOfParagraph)continue;0<=b.cpBegin&&(ta=b.cpBegin)}h&&aa.J(Sb).id.equals(h.node.id)&&0<=h.cpEnd&&(Pa=h.cpEnd);Sb||(vb=u);Sb!==aa.count-
1||h&&h.contextId===oc.a.endOfParagraph||(Kb=y);P.addRange(this.Cgf(aa.J(Sb),ta,Pa,vb,Kb))}return P}Bgf(b,h){const u=new ob.a,y=this.mT(b,h);let P,aa,ta;for(let vb=0;vb<y.count;vb++){const Kb=y.J(vb);if(Kb.qa.length){var Pa=Kb.qa.J(Kb.qa.length-1);P=0;aa=Kb.characterData.length;ta=0;Pa=Pa&&Pa.Jb?Pa.Jb.length:0;b&&Kb.id.equals(b.node.id)&&(P=b.xk,ta=b.Fb);h&&Kb.id.equals(h.node.id)&&(aa=h.$q,Pa=h.Tb);u.addRange(this.Dgf(Kb,P,aa,ta,Pa))}}return u}Cgf(b,h,u,y=!0,P=!0,aa=!0){const ta=new ob.a;b=b.qa;
for(let Pa=0;Pa<b.length;Pa++){if(b.J(Pa).cp<h)continue;if(b.J(Pa).cp>u)break;const vb=b.J(Pa);if(vb.Jb&&0<vb.Jb.length&&(vb.cp!==h||y)&&(vb.cp!==u||P))for(let Kb=0;Kb<vb.Jb.length;Kb++){const Sb=vb.Jb.J(Kb);(aa||Sb.Oc)&&ta.add(Sb)}}return ta}Dgf(b,h,u,y,P){const aa=new ob.a;b=b.qa;for(let ta=0;ta<b.length;ta++){if(b.J(ta).cp<h)continue;if(b.J(ta).cp>u)break;const Pa=b.J(ta);if(Pa.Jb&&0<Pa.Jb.length){let vb=0,Kb=Pa.Jb.length;Pa.cp===h&&-1!==y&&(vb=y);for(Pa.cp===u&&-1!==P&&(Kb=P);vb<Kb&&vb<Pa.Jb.length;vb++)aa.add(Pa.Jb.J(vb))}}return aa}qud(b,
h,u){let y=null;if(h.contains(u)||!(y=this.Ji.Db(u)))return!1;b.add(this.ZP(y));h.add(u);return!0}hSe(b,h,u){let y=null;!h.contains(u.oe)&&(y=u.contentControlNode)&&(b.add(this.ZP(y)),h.add(u.oe))}Vkj(b,h){let u,y=!1;u=({I3a:h,H3a:b,w3c:y}=this.Wkj(b,h,!1,y)).returnValue||y;y&&(u=u||({I3a:h,H3a:b,w3c:y}=this.Wkj(h,b,!0,y)).returnValue);return{returnValue:u,I3a:h,H3a:b}}Wkj(b,h,u,y){var P,aa,ta,Pa;let vb,Kb;if(u)return vb=Kb=null,{returnValue:!1,I3a:Kb,H3a:vb,w3c:!1};let Sb=!1;Kb=b;vb=h;const Yb=b.cpBegin,
Ac=h.cpEnd;y=!1;var Sc=u?this.aSh(h):this.jsl(b);let nd=!1,Ad=!1,he=0,ce=0;for(const Nd of Sc)for(Sc=0;Sc<Nd.qa.length;Sc++){const re=Nd.qa.J(Sc);!Ad&&Nd.id.equals(h.node.id)&&(Ad=!0);if(!nd&&(Nd.id.equals(h.node.id)&&-1!==Ac&&re.cp>Ac||Ad&&!Nd.id.equals(h.node.id)))if(nd=!0,he!==ce)Sb=!0;else return{returnValue:!1,I3a:Kb,H3a:vb,w3c:y};if((!Nd.id.equals(b.node.id)||re.cp>=Yb||-1===Yb)&&re.Jb)for(let Xd=0;Xd<re.Jb.length;Xd++){const vg=re.Jb.J(Xd),Vf=this.Ji.Db(vg.oe);if(!Vf.getValue(Lc.a.w7)||(!vg.Oc||
this.ah.iPa(Fj.a.hk?this.Hd.Jq(Vf.id,!0):null!==(aa=this.Hd.Gs.get(null===(P=Vf.id)||void 0===P?void 0:P.toString()))&&void 0!==aa?aa:T.a.nil,Nd.id,!0))&&(vg.Oc||this.ah.iPa(Fj.a.hk?this.Hd.Jq(Vf.id,!1):null!==(Pa=this.Hd.Ot.get(null===(ta=Vf.id)||void 0===ta?void 0:ta.toString()))&&void 0!==Pa?Pa:T.a.nil,Nd.id,!1))){vg.Oc?he++:he--;if(Sb&&he===ce)return{I3a:Kb,H3a:vb}=this.eSk(b.node,Nd,b.cpBegin,re.cp),{returnValue:!0,I3a:Kb,H3a:vb,w3c:y};!u&&he<ce&&(y=!0,ce--)}}}return{returnValue:Sb,I3a:Kb,H3a:vb,
w3c:y}}eSk(b,h,u,y){let P;h.id.equals(b.id)?b=0<u||y<be.ParagraphReader.textLength(h)?P=nf.a.createTextRange(h,u,y):P=nf.a.create(h):(P=0<u?nf.a.createTextRange(b,u,be.ParagraphReader.textLength(b)):nf.a.create(b),b=y<be.ParagraphReader.textLength(h)?nf.a.createTextRange(h,0,y):nf.a.create(h));return{I3a:P,H3a:b}}JKl(b){var h,u,y,P;const aa=b.cpBegin,ta=this.aSh(b);for(let vb=ta.count-1;0<=vb;vb--){const Kb=ta.J(vb);for(let Sb=Kb.qa.length-1;0<=Sb;Sb--){const Yb=Kb.qa.J(Sb);if((!Kb.id.equals(b.node.id)||
Yb.cp<=aa||-1===aa&&!Yb.cp)&&Yb.Jb){var Pa=Yb.Jb.length-1;for((Yb.cp===aa||-1===aa&&!Yb.cp)&&this.nX&&Kb.id.equals(b.node.id)&&(Pa=b.Fb-1);0<=Pa;Pa--){const Ac=Yb.Jb.J(Pa),Sc=this.Ji.Db(Ac.oe);if(Ac.Oc){if(Sc.getValue(Lc.a.w7)&&!this.ah.iPa(Fj.a.hk?this.Hd.Jq(Sc.id,!0):null!==(P=this.Hd.Gs.get(null===(y=Sc.id)||void 0===y?void 0:y.toString()))&&void 0!==P?P:T.a.nil,Kb.id,!0))continue;return null}if(!Sc.getValue(Lc.a.w7)||this.ah.iPa(Fj.a.hk?this.Hd.Jq(Sc.id,!1):null!==(u=this.Hd.Ot.get(null===(h=
Sc.id)||void 0===h?void 0:h.toString()))&&void 0!==u?u:T.a.nil,Kb.id,!1))return this.ZP(Sc)}}}}return null}ZP(b){if(!b)return null;this.ah.g3b();return this.U0.Bzb(b,this.Ex,this.Ci,this.ah,this.Pr,this,this.ara,this.bea,this.fxb)}mT(b,h){b=this.$Rh(b,h,Er.GCb(12));if(!b)return null;h=new ob.a;for(const u of b)h.add(u);return h}gsl(b,h){const u=Er.bHl();return this.$Rh(nf.a.create(b.node),nf.a.create(h.node),u)}$Rh(b,h,u){if(!u||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var y=
b.node;if(y&&u(y)){var P;return P=new ob.a,P.add(y),P}}y=Object.assign(new rv,{OAi:35,CKi:u});b=b?b.node:null;h=h?h.node:null;P=this.DSl(b,h);if(!P)return null;h=this.Ghk(h,u,Er.Tnh,y);return this.csl(b,h,P,u,Er.Tnh,y)}DSl(b,h){return(b=b?this.tZh(b):this.tZh(h))?b.kd(35):this.ah.oNl()}Ghk(b,h,u,y){if(!b)return null;h(b)||(h=this.dsl(b,h,u,y),h.count&&(b=h.J(h.count-1)));return b}csl(b,h,u,y,P,aa){b?(b=yd.GraphIterator.$a(b),b.Ab(7),u=Le.a.Vr(b,u)):u=Le.a.Dp(u);P&&u.ho(P,aa);for(P=new ob.a;u.moveNext()&&
(y(u.currentNode)&&P.add(u.currentNode),!h||!u.currentNode.id.equals(h.id)););return P}dsl(b,h,u,y){b=Le.a.Dp(b);u&&b.ho(u,y);for(u=new ob.a;b.moveNext();)h(b.currentNode)&&u.add(b.currentNode);return u}tZh(b){b=yd.GraphIterator.$a(b);return b.Ab(35)?b:null}v$h(b,h){b=this.mT(b,h);for(const u of b)if((b=this.ah.Mjf(u))&&b.j7(4))return!0;return!1}idh(b,h=null,u=!1){if(!b)return!1;let y=b.start;var P=b.end;if(!Se.SelectionEditor.Xu(y)&&y.contextId!==oc.a.paragraph||!Se.SelectionEditor.Xu(P)&&P.contextId!==
oc.a.paragraph||!this.nX&&({I3a:y,H3a:P}=this.Vkj(b.start,b.end)).returnValue||this.nX&&!({start:y,end:P}=this.nAk(y,P)).returnValue)return!1;b.start=y;b.end=P;const aa=this.Tnm(y,P);if(this.nX){var ta=this.saa(b.start,b.end,3);var Pa=this.saa(b.start,b.end,2)}else ta=this.WN(b.start,b.end,3),Pa=this.WN(b.start,b.end,2);const vb=ta&&0<ta.count?ta.J(0):null,Kb=Pa&&0<Pa.count?Pa.J(0):null;if(u)return this.lQc(b,0,ta)?!0:!1;if(this.lQc(b,0,ta)){u=(u=Object(na.a)(ln,this.JKl(b.start)))?this.ah.Ru(u.objectId):
null;Pa=this.ah.s$j(b,vb,u,Pa,b.Ws,b.fx,h);this.Dj.sac(Pa);if(b.Yf)for(P=this.mT(b.start,b.end),u=0;u<P.count;u++)if(this.nX){ta=vb?vb.objectId:null;const Sb=this.$Yh(ta,P.J(u),!0);this.Pr.Asa(P.J(u),Pa.id,0,!0,!0,void 0,void 0,void 0,void 0,Sb);ta=this.$Yh(ta,P.J(u),!1);this.Pr.Asa(P.J(u),Pa.id,P.J(u).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ta)}else this.Pr.Asa(P.J(u),Pa.id,0,!0,!0),this.Pr.Asa(P.J(u),Pa.id,P.J(u).characterData.length,!0,!1);else this.nX?(u=-1===y.Fb?0:y.Fb,this.Pr.Asa(b.start.node,
Pa.id,y.cpBegin,!1,!0,void 0,void 0,void 0,void 0,u),this.Pr.Asa(b.end.node,Pa.id,P.cpEnd,!1,!1,void 0,void 0,void 0,void 0,aa?u+1:P.Tb)):(this.Pr.Asa(b.start.node,Pa.id,b.start.cpBegin,!1,!0),this.Pr.Asa(b.start.node,Pa.id,b.start.cpEnd,!1,!1));h||this.ah.JWn(Pa,b.Yf,b.id,this.ah.c6b(this.ah.Ru(b.Ws)),b.type);1===b.type&&this.Pr.jto(b.start.node,y.xk,y.$q);b.objectId=Pa.id;h=this.ah.Dua().currentNode;h.hasProperty(Lc.a.uEc)||h.setValue(Lc.a.uEc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);
vb&&this.Jpj(vb.contentControlNode,b);Kb&&this.Jpj(Pa,Kb);aa&&this.ga.Ub(Oa.a.P3c,2,b.id);return!0}return!1}deleteContentControl(b){if(!this.lQc(b,3))return w.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Dj.D6c(b.contentControlNode))return!0;b.kO&&(b.kO=!1);const h=this.ib.hb.kb;b=b.rE();const u=new Bq.Selection(b.toArray(),!0);let y=!1;this.ib.yLb(()=>{this.ib.setSelection(u);if(32===this.ga.processAction(Oa.a.gH,2)){if(this.N$g.instance){const P=this.N$g.instance.F_h(h,
u,this.ib.hb.kb);this.ib.avo(new Au.SelectionCollection([P],0))}y=!0}});return y}Xwa(b,h=!1,u=!1){if(this.lQc(b,2)){if(b.kO)return w.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const y=Fj.a.er?b.contentControlNode:this.ah.Ru(b.objectId);let P=new ob.a;h&&(P=b.Lff());P.add(b);if(u||!this.Dj.D6c(b.contentControlNode)){y&&y.anchor&&this.ah.cEh(y,h);for(const aa of P)b=this.mT(aa.start,aa.end),this.Pr.o1k(b,aa.objectId);this.tQi(P)}w.ULS.sendTraceTag(528537616,
368,50,"Successfully released content control.");return!0}w.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}V7i(b,h){var u;if(this.lQc(b,1)){let Pa=!1;h||(Pa=!0,{R6n:y,returnValue:h}=this.ULc(b),y&&this.ah.Dua().currentNode.setValue(Lc.a.uEc,h));var y=b.ZTh().toArray();for(var P=0;P<y.length;P++)this.Xwa(y[P],!0);y=this.Vdo(h);if(b.Yf){P=this.mT(b.start,b.end);if(!P.count)return!1;if(1===P.count&&r.AFrameworkApplication.cD){y=y.join(" ");if(null===(u=r.AFrameworkApplication.K)||
void 0===u?0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.rtfSupportCA",!1))y=h;this.Pr.replaceTextRange(nf.a.createTextRange(P.J(0),0,P.J(0).characterData.length),y)}else{u=this.ah.xOl(P.J(0));h=P.J(0).r4b();P=this.ah.qEh(P);u=this.ah.udh(u,P,y.length);for(P=0;P<u.count;P++){this.Pr.replaceTextRange(nf.a.createTextRange(u.J(P),0,0),y[P]);for(var aa=0;aa<h.count;aa++)this.Pr.Asa(u.J(P),h.J(aa),0,!0,!0),this.Pr.Asa(u.J(P),h.J(h.count-aa-1),u.J(P).characterData.length,!0,!1)}b.OAo(u.J(0).id,
u.J(u.count-1).id);y=this.YD.we(u.J(0),0);this.ib.setSelection(y)}}else{P=0;1<y.length&&w.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;u=h.node;for(var ta=0;ta<u.qa.length&&h.contextId===oc.a.Fd;ta++)if(aa=u.qa.J(ta),aa.cp===h.cpBegin&&aa.blob){P++;for(ta+=1;ta<u.qa.length;ta++)if(aa=u.qa.J(ta),aa.cp>h.cpBegin&&aa.cp<=h.cpEnd)if(aa.blob)P++;else break;else if(aa.cp>h.cpEnd)break;break}if(0<P&&P+h.cpBegin<h.cpEnd)u=
nf.a.createTextRange(h.node,h.cpBegin,h.cpBegin+P),h=nf.a.createTextRange(h.node,h.cpBegin+P,h.cpEnd),this.Pr.replaceTextRange(h,y[0]),this.Pr.replaceTextRange(u,"");else if(0<P&&P+h.cpBegin===h.cpEnd)for(this.Pr.replaceTextRange(b.start,y[0]),y=0;y<u.qa.length;y++){if(P=u.qa.J(y),P.cp===h.cpBegin){P.blob=null;break}}else r.AFrameworkApplication.cD?(y=y.join(" "),this.Pr.replaceTextRange(b.start,y)):this.Pr.replaceTextRange(b.start,y[0])}this.cwd(b,Pa);let vb;this.nrn((vb=new ob.a,vb.add(b),vb));
return!0}return!1}cwd(b,h){const u=this.Pr.sLd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(!u)w.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control");else if(pe.a.instance.J(7)){const y=this.ah.Ru(b.objectId);if(h){h=this.Kz.jx(b.start.node);let P=h.fh(Er.hhn);P||(P=h.Qua(Er.ghn));P&&(this.ze.dla(u.formatting),this.ze.$mb(u.formatting,P));y&&(b.kO=!0)}else y&&b.kO&&(this.QLn(b,u),b.kO=!1)}}QLn(b,h){b=this.ah.Ru(b.objectId);let u=null;b&&(u=b.ia(Lc.a.vEc,
T.a.nil));this.ze.dla(h.formatting);u&&!u.equals(T.a.nil)&&(b=this.Ci.value.Db(u),h.formatting=b)}ULc(b){let h=!1;b=b.k4d;this.Ewm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,R6n:h}}bCn(b,h=!0){this.bea&&(h&&this.YBn(b),this.fCn(b))}cCn(b){if(this.bea&&(b=this.WN(b,b,4)))for(const h of b)this.Xwa(h,!1)}x2m(b,h){if(h&&!b.Oc&&(this.ah.g3b(),(b=b.Nb.paragraph.Jc.Db(b.oe))&&b.anchor)){this.ah.cEh(b);b=this.U0.Bzb(b,this.Ex,this.Ci,this.ah,this.Pr,this,
this.ara,this.bea,this.fxb);let u;this.tQi((u=new ob.a,u.add(b),u))}}rGi(b,h){this.ah.g3b();b=this.ah.Ru(h.oe);const u=this.ZP(b);if(u&&u.isValid()&&u.removeWhenEdited){const y=this.Ic.Qc(7);y.Eb(b);this.Xwa(u,!1);h.state=2;y.dispose()}}hHi(b,h){this.ah.g3b();b=this.ah.Ru(h.oe);this.amm(b)&&(b=b.ia(Lc.a.Ox,0),this.ga&&(this.ga.Ub(Oa.a.P3c,2,b),Er.Kd.BUe()))}amm(b){return b&&b.isConnected&&!b.ia(Lc.a.y6,!1)?Fj.a.er?this.vSd(b)&&!b.fv:this.vSd(b):!1}vSd(b){b=this.U0.Bzb(b,this.Ex,this.Ci,this.ah,this.Pr,
this,this.ara,this.bea,this.fxb);if(!b.isValid())return!1;if(b.Yf){if(b.Ws.toString()===b.fx.toString()){var h=this.ah.Ru(b.Ws);if(!h)return w.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.zhi(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return w.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.ah.Ru(b.Ws).qa.ei(h.cpBegin),
this.zhi(h,b.objectId)}return!1}zhi(b,h){b=b?b.Jb:null;if(!b)return!1;const u=b.EI(h,!0);return-1<u&&u+1<b.length&&b.J(u+1).oe.toString()===h.toString()}wyn(b){this.qIe.push(b)}Hdj(b,h){if(void 0===b||null===b||b.contextId!==oc.a.Fd)return null;b=nf.a.Uc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<be.ParagraphReader.textLength(b.node)?this.ah.lSa(b):null}select(b,h){if(b&&!b.equals(T.a.nil)){var u=this.ah.Ru(b);if(u&&55===u.type){u=this.ZP(u);if(u.Yf)u=this.Ytl(u);else{u=u.start;Fj.a.$l&&
(u.contextId=oc.a.Fd);if(!u)return;u=this.YD.Vn(u)}if(u&&u.length)return this.R4i(u.Qa,b,h,!0,!0),this.R4i(u.Tc,b,h,!1,!1),this.ib.setSelection(u),u}}}wRn(b,h){if(!Se.SelectionEditor.pf(b)||b.Fb!==b.Tb)return!1;const u=b.Fb;return-1===u?!1:(b=this.Np.H_a(b.node,b.cpBegin,u,!h))&&h===b.Oc?(h=this.ZP(b.contentControlNode),this.select(b.oe,!h.isEditable),!0):!1}Ytl(b){var h=this.ah.uNa(b.Ws,!0);b=this.ah.uNa(b.fx,!1);if(!h||!b)return null;h=this.gsl(nf.a.create(h),nf.a.create(b));if(!h||!h.count)return null;
b=new ob.a;for(let u=0;u<h.count;u++){let y;if(12===h.J(u).type)y=u===h.count-1?nf.a.createTextRange(h.J(u),0,be.ParagraphReader.textLength(h.J(u))):nf.a.create(h.J(u)),this.yh&&(y.Fb=this.yh.Kq(y.node,!0),y.Tb=this.yh.Kq(y.node,!1));else if(15===h.J(u).type)y=Lq.TableNodeContext.create(h.J(u));else continue;b.add(y)}return new Bq.Selection(b.toArray(),!0)}dWn(b){if(b&&!b.equals(T.a.nil)&&(this.ah.g3b(),(b=this.ah.Ru(b))&&55===b.type&&b.isConnected)){var h=b.ia(Lc.a.y6,!1);b.setValue(Lc.a.y6,!1);
h&&this.mxn(b)}}mxn(b){var h,u;const y=Fj.a.hk?this.Hd.Jq(b.id,!0):null!==(u=this.Hd.Gs.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==u?u:T.a.nil;y.equals(T.a.nil)||(h=this.ah.jma(y,!0))&&(b=this.Pr.phf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Nb,h.formatting=b.WP?b.WP.Xf(h):new eB.a(h,T.a.nil))}bUi(b){if(b=this.WUh(b))for(const h of b)this.Dj.k4f()&&(h.kO=!1),this.Xwa(h,!1)}Jxl(b){const h=new ob.a;if(b=this.WUh(b))for(const u of b)h.add(u.contentControlNode);return h}dCn(b){if(b&&
(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.eb.Il(b),u=this.eb.HI(b);if(this.yh&&h&&u){b=this.yh.Kq(h,!0);const y=this.yh.Kq(u,!1);h=nf.a.create(h);u=nf.a.create(u);h.Fb=b;u.Tb=y;if(b=this.saa(h,u,4))for(const P of b)this.Xwa(P,!1)}}}ksl(b){var h,u,y,P;const aa=Fj.a.hk?this.Hd.Jq(b.id,!0):null!==(u=this.Hd.Gs.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==u?u:T.a.nil;b=Fj.a.hk?this.Hd.Jq(b.id,!1):null!==(P=this.Hd.Ot.get(null===(y=b.id)||void 0===y?void 0:y.toString()))&&
void 0!==P?P:T.a.nil;if(aa.equals(T.a.nil)||b.equals(T.a.nil))return new ob.a;y=this.ah.jma(aa,!0);P=this.ah.jma(b,!1);return y&&P?this.mT(nf.a.create(y),nf.a.create(P))||new ob.a:new ob.a}uNa(b,h){return this.ah.uNa(b,h)}wjf(b,h){if(b&&55===b.type&&(b=this.ZP(b),b=h?b.start:b.end)){const u=nf.a.Uc(b.node,h?b.xk:b.$q);u.Fb=u.Tb=(h?b.Fb:b.Tb)+(h?-1:1);return u}return null}Mxl(b){return(b=this.ZP(b))?b.start:null}R4i(b,h,u,y,P){if((b.contextId===oc.a.Fd||b.contextId===oc.a.Vc||b.contextId===oc.a.paragraph)&&
(P=b.node.qa.ei(P?b.xk:b.$q))&&P.Jb)for(let aa=0;aa<P.Jb.length;aa++){const ta=P.Jb.J(aa);if(ta.oe.equals(h)&&ta.np)if(y&&ta.Oc){b.Fb=u?aa:aa+1;break}else if(!y&&!ta.Oc){b.Tb=u?aa+1:aa;break}}}nrn(b){for(let h=0;h<this.B1g.length;++h)(0,this.B1g[h])(this,new et(b))}tQi(b){for(let h=0;h<this.qIe.length;++h)(0,this.qIe[h])(this,new et(b))}fCn(b){b=nf.a.create(b);if(b=this.WN(b,b,4))for(const h of b)h.Yf||this.Xwa(h,!1)}YBn(b){if(b=b.r4b())for(let u=0;u<b.count;u++){var h=this.ah.Ru(b.J(0));h=this.U0.Bzb(h,
this.Ex,this.Ci,this.ah,this.Pr,this,this.ara,this.bea,this.fxb);this.Xwa(h)}}jsl(b){return this.mT(b,null)}lQc(b,h,u=null){let y=!0;try{if(!b)return w.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;w.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.Yfa));if(!Fj.a.er&&this.Yza&&pe.a.instance.J(3)&&this.Yza.BX(this.Ex.value))return w.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),
!1;if(this.Usm(h)&&this.Vsm(h)&&!this.bmm(b))return!1;if(!u){const ta=this.sOl(b);ta&&(u=new ob.a,u.add(ta))}var P=this.ah.W0h(b.start.node);const aa=this.ah.W0h(b.end.node);if(P&&aa&&!P.equals(aa)||!P&&aa||P&&!aa)return!1;P=!0;if(u&&0<u.count){if(!u.J(0).isSupported)return!1;P=u.J(0).isEditable}switch(h){case 0:y=this.zjm(b,P);break;case 1:y=(this.z7||!this.wTd(b))&&b.isSupported&&b.isEditable&&this.pjh(b)&&this.Dhi(b);r.AFrameworkApplication.cD||(y=y&&!this.v$h(b.start,b.end));break;case 2:const ta=
b.Pxm?!0:b.isSupported;y=(this.z7||!this.wTd(b))&&ta&&b.Yfa&&P;w.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:y=b.isSupported&&b.Yfa&&P&&this.pjh(b)&&this.Dhi(b)&&!this.v$h(b.start,b.end)}}catch(aa){w.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+aa),y=!1}return y}Vsm(b){return!(r.AFrameworkApplication.cD&&1===b)}Usm(b){return!(this.nX&&(!b||2===b||3===b))}zjm(b,h){if(Fj.a.ihn)return this.Ajm(b,h);let u=!0;if(!this.z7&&
this.wTd(b))u=!1;else if(this.nX)this.nX?b.Yf||Se.SelectionEditor.Xu(b.start)||b.start.contextId===oc.a.endOfParagraph?b.Yf&&(b.start.contextId!==oc.a.paragraph&&b.start.contextId!==oc.a.endOfParagraph||b.end.contextId!==oc.a.paragraph&&b.end.contextId!==oc.a.endOfParagraph)&&(u=!1):u=!1:u=h?this.Ogi(b):!1;else if(!(b.Yf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))u=!1;else if(b.Yf&&(b.start.contextId!==oc.a.paragraph||b.end.contextId!==oc.a.paragraph||b.start.equals(b.end)&&!be.ParagraphReader.textLength(b.start.node)))u=
!1;else if(b.start.contextId===oc.a.Vc||b.end.contextId===oc.a.Vc||b.start.contextId===oc.a.endOfParagraph||b.end.contextId===oc.a.endOfParagraph)u=!1;return u}Ajm(b,h){return!this.z7&&this.wTd(b)||!this.Cjm(b)||!b.Yf&&!Se.SelectionEditor.Xu(b.start)&&b.start.contextId!==oc.a.endOfParagraph||b.Yf&&(b.start.contextId!==oc.a.paragraph&&b.start.contextId!==oc.a.endOfParagraph||b.end.contextId!==oc.a.paragraph&&b.end.contextId!==oc.a.endOfParagraph)?!1:h&&this.Ogi(b)?!0:!1}WUh(b){if(!b||!b.length)return null;
const h=b[0];b=b[b.length-1];this.yh&&(this.eb.em(h)&&12===h.node.type&&(h.Fb=this.yh.Kq(h.node,!0)),this.eb.em(b)&&12===b.node.type&&(b.Tb=this.yh.Kq(b.node,!1)));return this.saa(h,b,4)}pjh(b){b=b.Lff();for(const h of b)if(!h.isSupported||!h.Yfa)return!1;return!0}bmm(b){if(this.Vkj(b.start,b.end).returnValue)return!1;const h=this.WN(b.start,b.end,2);if(!h)return!0;for(const u of h)if(!u.objectId.equals(b.objectId)&&(u.Yf&&(u.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||
u.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===be.ParagraphReader.textLength(u.end.node)))||!u.Yf&&(b.start.node.id.equals(u.start.node.id)&&(-1!==b.start.cpBegin?u.start.cpBegin===b.start.cpBegin:!u.start.cpBegin)||b.end.node.id.equals(u.end.node.id)&&(-1!==b.end.cpEnd?u.end.cpEnd===b.end.cpEnd:u.end.cpEnd===be.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Dhi(b){if(b.Yf){var h=this.ah.Ru(b.Ws),u=this.ah.Ru(b.fx);let y=null;if(12===h.type&&12===u.type){h=this.ah.c6b(h);
h=this.ah.Ru(h);u=this.ah.c6b(u);u=this.ah.Ru(u);if(!h||!u)return!1;16===h.type&&16===u.type&&h.id.equals(u.id)&&(y=h)}b=this.mT(b.start,b.end);if(!b.count)return!1;for(const P of b)if(b=this.ah.c6b(P),b=this.ah.Ru(b),!b||!(16!==b.type||y&&b.id.equals(y.id)))return!1}return!0}wTd(b){return b.Yf?!1:(b=b.start.node)?!b.ia(Lc.a.E8b,!0):!0}Cjm(b){return 1!==b.type?!0:b.Ws.equals(b.fx)&&be.ParagraphReader.ic(b.start.node)&&!this.M6l(b)?!0:!1}M6l(b){var h=b.start;const u=h.node,y=u.qa;if(b.Yf){if(u.Ms||
u.mOa||u.hasBookmark)return!0;for(const P of y)if(null!=P.blob||this.A$h(P))return!0;return!1}b=h.xk;h=h.$q;for(const P of y.Jzm(b,h))if(P.cp!==h&&(null!=P.blob||!(P.cp<=b)&&this.A$h(P)))return!0;return!1}A$h(b){if(null!=b.hyperlink&&b.ql)return!0;const h=u=>null==u||0===u.length;return h(b.Jb)&&h(b.zf)&&h(b.Ph)&&h(b.ff)?!1:!0}Ogi(b){if(!b.Yf)return!0;var h=this.ah.Ru(b.Ws);b=this.ah.Ru(b.fx);if(hi.TableCellReader.Lva(h)||hi.TableCellReader.Lva(b)||pm.a.Hna(h)||pm.a.Hna(b))return!1;h=this.ah.c6b(h);
h=this.ah.Ru(h);b=this.ah.c6b(b);b=this.ah.Ru(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}sOl(b){if(!b)return null;b=this.ah.Ru(b.objectId);if(!b)return null;b=b.ia(Lc.a.x6,T.a.nil);return b.equals(T.a.nil)?null:(b=this.ah.Ru(b))?this.ZP(b):null}aSh(b){return this.mT(null,b)}Vdo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}Ewm(b){return b&&""!==b?!1:!0}$Yh(b,h,u){h=h.qa.ei(u?0:h.characterData.length);if(!h)return w.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),
0;if(!h.Jb||!h.Jb.length)return 0;if(!b)return u?0:h.Jb.length;for(let y=0;y<h.Jb.length;y++){const P=h.Jb.J(y);if(T.a.Qp(P.oe,b)&&P.Oc===u)return u?y+1:y}return u?0:h.Jb.length}nAk(b,h){var u=b.node,y=h.node,P=b.contextId===oc.a.paragraph?0:b.cpBegin,aa=h.contextId===oc.a.paragraph?be.ParagraphReader.textLength(y):h.cpEnd;u=this.Np.b7(u,P,b.Fb);y=this.Np.b7(y,aa,h.Tb);aa=!u||!u.count;P=!y||!y.count;if(aa&&P)return{returnValue:!0,start:b,end:h};if(aa)return{returnValue:this.Jge(b,y.J(y.count-1).oe,
!0),start:b,end:h};if(P)return{returnValue:this.Jge(h,u.J(u.count-1).oe,!1),start:b,end:h};if(u.count===y.count)return u=u.J(u.count-1),y=y.J(y.count-1),{returnValue:u.oe.equals(y.oe),start:b,end:h};u=(aa=u.count<y.count)?y.J(y.count-1):u.J(u.count-1);return{returnValue:aa?this.Jge(b,u.oe,!0):this.Jge(h,u.oe,!1),start:b,end:h}}Jge(b,h,u){var y=b.node;let P;if(u){P=b.contextId===oc.a.paragraph?0:b.cpBegin;var aa=b.Fb}else P=b.contextId===oc.a.paragraph?be.ParagraphReader.textLength(y):b.cpEnd,aa=b.Tb;
y=y.qa.ei(P);if(-1===aa||!y||!y.Jb||!y.Jb.length)return!1;y=y.Jb;if(u)for(u=aa;u<y.length;u++){aa=y.J(u);if(!aa.Oc)break;if(aa.oe.equals(h))return b.Fb=u+1,!0}else for(u=aa-1;0<=u;u--){aa=y.J(u);if(aa.Oc)break;if(aa.oe.equals(h))return b.Tb=u,!0}return!1}Tnm(b,h){return this.Pnk(b,h)&&b.Fb===b.Tb&&(b.contextId===oc.a.Vc||b.contextId===oc.a.paragraph&&!b.node.characterData.length)}Pnk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Tb===h.Tb}Jpj(b,h){var u,y,P,aa,ta,Pa;if(b&&h.Yf){var vb=Fj.a.hk?this.Hd.Jq(b.id,
!0):null!==(y=this.Hd.Gs.get(null===(u=b.id)||void 0===u?void 0:u.toString()))&&void 0!==y?y:T.a.nil;u=this.ah.jma(h.Ws,!0);vb.equals(u?u.id:null)&&(Fj.a.hk?this.Hd.yG(b.id,h.objectId,!0):this.Hd.Gs.set(null===(P=b.id)||void 0===P?void 0:P.toString(),h.objectId));P=Fj.a.hk?this.Hd.Jq(b.id,!1):null!==(ta=this.Hd.Ot.get(null===(aa=b.id)||void 0===aa?void 0:aa.toString()))&&void 0!==ta?ta:T.a.nil;aa=this.ah.jma(h.fx,!1);P.equals(aa?aa.id:null)&&(Fj.a.hk?this.Hd.yG(b.id,h.objectId,!1):this.Hd.Ot.set(null===
(Pa=b.id)||void 0===Pa?void 0:Pa.toString(),h.objectId))}}static get Kd(){return null!=Er.Vxg?Er.Vxg:Er.Vxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static GCb(b){return h=>h.type===b}static bHl(){return b=>12===b.type||15===b.type}static Tnh(b,h){return b.ef===h.OAi||b.parentNode&&h.CKi(b.parentNode)?!1:!0}}Er.hhn="Placeholder Text";Er.ghn="Placeholder Text";Object(m.a)(Er,"ContentControlOperator",null,[375,9,376]);class Ov{constructor(b,h,u){this.Zc=b;this.Ex=
h;this.yVb=u}k7h(b){const h=this.fHl();return h&&b&&this.v0l(h,b)?this.RZl(h):null}v0l(b,h){if(!b)return!1;do{const u=b.currentNode;if(!u)break;if(u.ia(Lc.a.s0l,null)===h)return!0}while(b.yf(29));return!1}RZl(b){var h=b.Rb(1);b.qc();b=b.wE(1);if(!h||!b)return null;h=Kf.SelectionFactory.VWk(h,b);b=Se.SelectionEditor.Vj(h,!1,!1);return Kf.SelectionFactory.Vz(h,b.Tc)}fHl(){const b=this.Zc.Bk();b.set(this.Ex.value);this.yVb.EQ(b);return b.Rb(28)&&b.Rb(29)?b:null}}Object(m.a)(Ov,"GlossaryNavigator",null,
[373]);class Lx{constructor(b,h,u,y,P,aa){this.Pr=b;this.ah=h;this.zm=u;this.eb=y;this.vh=P;this.bea=aa}u2c(b,h,u){if(!this.bea)return 1;if(!({tableNode:P}=this.Hyf(b)).returnValue||!this.vh.noi(P,h)||this.ZTi(b,h))return 2;var y=this.vh.bSh(h);var P=y.J(0).r4b();P&&P.count||(P=new ob.a,P.add(b.objectId));b=this.ah.qEh(y);u=u.split("\n");h=Object(na.a)(yd.GraphIterator,this.ah.Mjf(h));h=this.ah.udh(h,b,u.length);for(b=0;b<h.count;++b){y=h.J(b);this.Pr.replaceTextRange(nf.a.createTextRange(y,0,0),
u[b]);for(let aa=0;aa<P.count;++aa)this.Pr.Asa(y,P.J(aa),0,!0,!0),this.Pr.Asa(y,P.J(P.count-aa-1),y.characterData.length,!0,!1)}return 0}ZTi(b,h){if(!this.bea)return 1;let u;if(!({tableNode:u}=this.Hyf(b)).returnValue||!this.vh.noi(u,h))return 2;h=this.vh.bSh(h);if(0<h.count&&(h=this.zm.WN(nf.a.create(h.J(0)),nf.a.create(h.J(h.count-1)),2)))for(const y of h)if(y.id!==b.id&&!this.zm.Xwa(y,!0))return 2;return 0}R9b(b){if(!this.bea||!({tableNode:u}=this.Hyf(b)).returnValue)return!1;b=b.Lff();for(var h of b)if(!h.Yfa||
!h.isSupported)return!1;if(this.vh.Rlm(u))return!1;var u=Object(na.a)(yd.GraphIterator,this.ah.Mjf(u));h=new ob.a;this.eb.Fgb(u,!0,!1,h);for(const y of h)if(0<y.ia(Lc.a.rBb,0)||this.eb.f0a(y).px)return!1;return!0}Hyf(b){let h=null;return b&&b.Ws.toString()===b.fx.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.ah.Ru(b.Ws))&&14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(m.a)(Lx,"TableContentControlEditor",null,[363]);class uw{Rlm(b){let h=
!1;const u=new yd.GraphIterator;u.set(b);wf.forEachCellInTable(u,y=>{if(!hi.TableCellReader.pg(y)){let P=mg.OutlineNavigator.Y7(y);for(;P;){if(wg.OutlineElementReader.lPd(y))return h=!0,!1;P=y.yi(1)}}return!0});return h}noi(b,h){const u=new yd.GraphIterator;u.set(h);return hi.TableCellReader.Lva(h)&&u.Ab(14)&&u.kd(14).id===b.id?!0:!1}bSh(b){const h=new ob.a,u=new yd.GraphIterator;u.set(b);b=new ob.a;be.ParagraphReader.Fgb(u,!0,!1,b);for(const y of b)h.add(y);return h}}Object(m.a)(uw,"TableReader",
null,[362]);class Cy{constructor(){this.zm=null}get name(){return"WordEditor.ContentControl"}init(){r.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(db.a.hRa(Object(v.a)(Ja.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Ja.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").x2m,"onContentControlRangeChanged")),this.zm=Ja.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator"),Ja.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init())}dispose(){this.zm&&
(this.zm.dispose(),this.zm=null)}xc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new Dc.a(Je.a.Ye)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new Ij(Ja.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();b.ha("WordEditor.ContentControlNodeFactory",()=>new qc(Ja.a.instance.Za("Box4.ContentControlConfigSettings"),Ja.a.instance.Za("Box4.ContentControl.IContentControlOperator"))).singleInstance();
b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new jj(new Zf.a(()=>Ra.App.xa.jb.Yc),new Zf.a(()=>Ra.App.xa.jb.Yc.Bd),new Zo.a,xl.PageNavigator.instance,Ja.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ja.a.instance.resolve("Box4.IOutlineEditor"),Ja.a.instance.resolve("Box4.IOutlineElementEditor"),Ja.a.instance.resolve("Box4.IParagraphReader"),Ja.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Ja.a.instance.Za("Box4.ContentControlConfigSettings"),Ja.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();
b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new Ov(new Zo.a,new Zf.a(()=>Ra.App.xa.jb.Yc),xl.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",()=>new Er(new Zf.a(()=>Ra.App.xa.jb.Yc),new Zf.a(()=>Ra.App.xa.jb.Yc.Bd),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ja.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),
Hh.a.instance,Ja.a.instance.resolve("Box4.ISelectionFactory"),se.PageReader.instance,Ja.a.instance.resolve("Box4.IFormattingEditor"),Ja.a.instance.resolve("Box4.Styles.IWACStyleReader"),r.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ja.a.instance.Pa("Box4.IContentControlDataChangedManager"),r.AFrameworkApplication.ya,Ja.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),r.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ja.a.instance.resolve("Box4.IContentControlChpHelper"),
Ja.a.instance.Za("Box4.ContentControlConfigSettings"),Ja.a.instance.Pa("Box4.IContentControlReader"),Ja.a.instance.resolve("Box4.IParagraphReader"),Ja.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ja.a.instance.Za("Box4.Actors.IVirtualSelectionMerger"),Ja.a.instance.resolve("Box4.IFeatureHelper"),Ja.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();
b.ha("WordEditor.ContentControl.ContentControlManager",()=>new mr(new Zf.a(()=>Ra.App.xa.jb.Yc),new Zf.a(()=>Ra.App.xa.jb.Yc.Bd),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ja.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ja.a.instance.Za("Box4.ContentControlConfigSettings"),Ja.a.instance.resolve("Box4.IContentControlChpHelper"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new ug(Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ja.a.instance.Za("Box4.ContentControlConfigSettings"),Ja.a.instance.resolve("Box4.IParagraphReader"),Ja.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();
b.ha("WordEditor.ContentControl.TableContentControlEditor",()=>new Lx(Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ja.a.instance.resolve("Box4.IParagraphReader"),new uw,r.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();
r.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&b.ha("Box4.ContentControlConverter",()=>new Ug(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new zd(b.resolve("WordEditor.ContentControl.ContentControlOperator"),
b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance()}static main(){K.a.instance.Kc(new Cy)}}Object(m.a)(Cy,"ContentControlPackage",null,[1,2]);var wA=c(1379),xA=c(1702);class yA extends Sys.EventArgs{constructor(b,h,u){super();this.definition=b;this.source=h;this.TKk=u}}Object(m.a)(yA,"MenuDidCloseEventArgs",
Sys.EventArgs,[]);class zA extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=h}}Object(m.a)(zA,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class vz{constructor(b,h,u,y,P,aa,ta=!1,Pa=null,vb=null,Kb=null,Sb=!1,Yb=null,Ac=!1,Sc=!0,nd=null,Ad=!1,he=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.HWc=this.rWc=this.QLh=this.onScroll=this.onResize=this.x_=this.owa=this.qFa=this.documentElement=this.AU=this.editingElement=null;this.isFocused=!1;this.MDd=null;
this.$Pf=this.mvf=!1;this.Rhe=null;this.L4d=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=u;this.definition=y;this.L8j=P;this.CEa=aa;this.wCa=ta;this.Eaj=Pa;this.Gla=vb;this.hostServices=Kb;this.K9n=Sb;this.kJi=Yb;this.Qaj=Ac;this.X5k=Sc;this.QLh=nd;this.showDictationCommandUx=Ad;this.source=he}}Object(m.a)(vz,"UxManagerState",null,[]);var Bs=c(1570);class fx{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(m.a)(fx,"UxManagerMenuActionTelemetryData",
null,[]);var f=c(1040);class x{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.Vb=b;this.ib=h;this.xz=u;this.fd=y;this.ie=P;this.Gb=aa;this.Vi=ta;this.Qj=Pa;this.mS=vb;this.LQb=Kb;this.PLe=!1;this._state=this.rRg=null;this.shouldIgnoreFocusEvent=Sb=>{var Yb;return this.fd.od.Zv&&!this.fd.od.sQ&&Sb===(null===(Yb=this.fd.editingView)||void 0===Yb?void 0:Yb.editingElement)};this.sa=new ie.a;this.hqd=new Tb.a;this.$ud((Sb,Yb)=>{x.XKm(u,Yb.definition,Yb.source)});this.Geh((Sb,Yb)=>{x.WKm(u,Yb.definition,Yb.source,
Yb.TKk)});this.Vb.le(x.EHd).BK=!0}$ud(b){this.sa.addHandler(x.DEf,b)}MXf(b){this.sa.removeHandler(x.DEf,b)}Jrn(b,h){this.sa.raiseEvent(x.DEf,new zA(b,h))}Geh(b){this.sa.addHandler(x.CEf,b)}qFn(b){this.sa.removeHandler(x.CEf,b)}Irn(b,h,u){this.sa.raiseEvent(x.CEf,new yA(b,h,u))}oBo(b){var h;if(!b.isDismissed&&b.AU){var u=Bs.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(u&&u.length){u=Bs.b(u);var y=Je.a.getElementBounds(b.AU);u.width||u.height?u.x+u.width<y.x||u.x>y.x+y.width||u.y+u.height<y.y||u.y>y.y+y.height?
this.dismiss():(y=b.target,y.style.left=u.x+"px",y.style.top=u.y+"px",y.style.width=u.width+"px",y.style.height=u.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||w.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):(w.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else w.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}nQi(b){b.isDismissed||b.Rhe||(b.Rhe=
new sc.a(2,1,1,()=>{b.Rhe=null;this.oBo(b)},147),this.Gb.Xb(b.Rhe))}qFa(b,h){!b.isDismissed&&b.X5k&&0<h.tM.length&&(this.dismiss(),w.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}Sik(b){return!!b&&b.id===x.P8j}owa(b,h){if(b.isDismissed||!h||!h.Ib)return!1;h=h.Ib;const u=h.keyCode,y=!b.isFocused&&!!b.menu,P=h.altKey||h.ctrlKey||h.shiftKey;let aa=!1;u===fb.a.A0?(this.dismiss(),w.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),aa=!0):u!==
fb.a.us&&u!==fb.a.xx||!y||P||!this.Sik(b.definition)?u!==fb.a.WOb&&u!==fb.a.Z7c||!y||P||(this.oTf(b),b.menu?(b.menu.focus(),aa=!0,w.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):w.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):(b.menu.executeDefaultAction(),w.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),aa=!0);aa&&(h.preventDefault(),h.stopPropagation());return aa}rWc(b,h){if(b.isDismissed||!b.menu)return w.ULS.sendTraceTag(512255776,
341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);w.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}HWc(b,h){if(b.isDismissed||!b.menu)return w.ULS.sendTraceTag(512255775,341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);w.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");
return!0}x_(b,h){if(b.isDismissed||!h||!h.Ib||!b.menu)return w.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===h?0:h.Ib),!b.menu),!1;const u=b.target;b=b.menu.getElementBounds();var y=h.Ib;h=y.clientX;y=y.clientY;u&&x.eMi(h,y,Je.a.getElementBounds(u),16)||b&&x.eMi(h,y,x.atk(b),4)||this.dismiss();return!1}T3n(b){var h=Bs.c(b.paragraphNode,b.cpBegin,
b.cpEnd);if(!h||!h.length)return!1;h=Bs.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=x.$Ec();b.target=h;b.editingElement=this.fd.editingView.editingElement;b.AU=this.fd.od.container;b.documentElement=document.documentElement;b.qFa=(u,y)=>{this.qFa(b,y)};b.owa=u=>this.owa(b,u);b.x_=u=>this.x_(b,u);b.onScroll=()=>{this.nQi(b)};b.onResize=()=>{this.nQi(b)};b.showDictationCommandUx&&(b.rWc=u=>this.rWc(b,u),b.HWc=u=>this.HWc(b,u),this.LQb&&this.LQb.execute(u=>{u.r_n(b.rWc);u.t_n(b.HWc)}));
document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.DA(b.qFa);this.Vi.jZ(b.onResize);this.ie.mb(bb.a.hI,b.editingElement,b.owa);b.wCa&&this.Qj.mb(bb.a.qba,b.documentElement,b.x_);rf.a.addHandler(b.AU,"scroll",b.onScroll);b.CEa||this.oTf(b);return!0}IDb(b,h){const u=!!b.menu;this.Irn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Vb.currentScope.name===x.EHd&&this.Vb.RQ(x.EHd);
b.qFa&&this.ib.$ba(b.qFa);b.owa&&b.editingElement&&this.ie.sc(bb.a.hI,b.editingElement,b.owa);this.LQb&&this.LQb.execute(y=>{b.showDictationCommandUx&&(y.vKn(),y.wKn());y.h6i(!1,b.showDictationCommandUx)});b.x_&&b.documentElement&&b.wCa&&this.Qj.sc(bb.a.qba,b.documentElement,b.x_);b.onScroll&&b.AU&&rf.a.removeHandler(b.AU,"scroll",b.onScroll);b.onResize&&this.Vi.Zba(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.AU=null;b.qFa=
null;b.owa=null;b.x_=null;b.onScroll=null;b.onResize=null;b.rWc=null;b.HWc=null;u&&b.Gla&&(b.mvf?b.$Pf=!0:b.Gla(b.MDd))}A0a(b,h){var u;if(!h)return!1;switch(h.actionType){case bp.b.Toggle:if(h.objectFulfillment===x.jno)return this.PLe=!this.PLe,this.Pcg(),this.DGc(b),!0;if(h.objectFulfillment===x.nno)return{value:u}=this.hqd.Gc(h.suggestionGroup.type,!1),this.hqd.Z(h.suggestionGroup.type,!u),this.DGc(b),!0;break;case bp.b.GiveFeedback:if(xA.a.enm(null===(u=h.suggestionGroup)||void 0===u?void 0:u.type)||
f.a.Lwm(h.objectName))break;this.focus();this.Pcg();this.DGc(b);return!0;case bp.b.RevealSuggestions:this.DGc(b)}b.mvf=!0;h=b.L8j.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.mvf=!1;h&&this.DGc(b);b.$Pf&&(b.$Pf=!1,b.Gla(b.MDd),b.MDd=null);return h}DGc(b){b.x_&&b.documentElement&&b.wCa&&(this.Qj.sc(bb.a.qba,b.documentElement,b.x_),b.wCa=!1)}E7n(b,h){return!(0<=b.positionInSet&&0<b.setSize)&&!h}Qlj(b){var h;if(this.T3n(b)){var u=1;r.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&
(u=3);var y=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(y=b.definition.suggestionGroups[0].type,y=this.hqd.ub(y)?this.hqd.J(y):b.K9n);h=!1;r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);const P=r.AFrameworkApplication.ya;u={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:aa=>this.A0a(b,aa),onDismiss:aa=>{this.IDb(b,aa)},openCustomDictionaryDialog:()=>
P.processAction(Rc.a.t6e,2),keepCurrentFocus:b.CEa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.PLe,showDescription:y,showEditorButton:b.Qaj,showEditorBranding:this.E7n(b.definition,b.Qaj),hostServices:b.hostServices,maxSuggestionGroupNumber:u,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.QLh,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};b.kJi&&b.kJi(u);this.xz.createContextualUi(u).then(aa=>
{this.Jrn(b.definition,b.source);b.menu=aa;w.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.Eaj&&b.Eaj();this.LQb&&9!==b.source&&this.LQb.execute(ta=>ta.h6i(!0,b.showDictationCommandUx))}).catch(aa=>{this.IDb(b,{XPo:wA.a.Unknown});w.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",aa)});0<b.L4d&&w.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.L4d)}else 5<++b.L4d?(w.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),
this.dismiss()):this.Gb.Xb(new sc.a(2,1,Math.pow(3,b.L4d),()=>{b.isDismissed||this.Qlj(b)},146))}get zK(){return!!this._state&&!this._state.isDismissed}set vae(b){this.rRg=b}get Qrm(){return this.rRg}icg(b,h){this.zK&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.zK?this._state.definition:null}set definition(b){this.zK&&(this._state.definition=b,this._state.menu&&this._state.menu.setDefinition(b))}focus(){this.zK&&this._state.menu&&(this._state.isFocused||this.oTf(this._state),
this._state.menu.focus())}Pcg(){this.zK&&this._state.menu&&this._state.menu.updatePosition()}oTf(b){this.Vb.LK(x.EHd,!1);b.isFocused=!0}Dxa(b,h,u,y,P,aa=null,ta=null,Pa=null,vb=!1,Kb=null,Sb=!1,Yb=!0,Ac=null,Sc=!1,nd=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Ad,he;if(!({paragraphNode:he,start:b,end:Ad}=x.kqo(b)).returnValue)return!1;this._state=new vz(he,b,Ad,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd);this.Qlj(this._state);return!0}bae(){this._state&&(this._state.MDd=!0)}dismiss(){var b;
this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static XKm(b,h,u){u=new fx(u);b.logAction({actionType:bp.b.SessionStart,engagement:bp.a.Try,objectName:x.mhj,objectId:h.id,data:u});if(h.suggestionGroups)for(const y of h.suggestionGroups)b.logAction({actionType:bp.b.Presented,engagement:bp.a.See,objectName:y.type,objectId:y.id,data:u})}static WKm(b,h,u,y){u=new fx(u);b.logAction({actionType:bp.b.SessionEnd,engagement:bp.a.None,objectName:x.mhj,objectId:h.id,
data:u},y)}static $Ec(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static atk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static eMi(b,h,u,y){const P=u.y-y,aa=u.x+u.width+y,ta=u.y+u.height+y;return u.x-y<=b&&b<=aa&&P<=h&&h<=ta}static kqo(b){let h,u;if(!b||!be.ParagraphReader.ic(b.node)||b.contextId!==oc.a.Vc&&b.contextId!==oc.a.Fd&&b.contextId!==oc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};u=b.node;b.contextId!==oc.a.paragraph?
(h=b.cpBegin,b=b.cpEnd):(h=0,b=u.characterData.length);return{returnValue:!0,paragraphNode:u,start:h,end:b}}jUc(){this.mS&&this.mS.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}x.P8j="ActionSet";x.mhj="IntentGroup";x.EHd="CanvasContextualUxReact";x.jno="Context";x.nno="Description";x.DEf="MenuDidOpen";x.CEf="MenuDidClose";Object(m.a)(x,"UxManager",null,[]);class E{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>
{this.$m()})}$m(){r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=r.AFrameworkApplication.K.$("EditorGoalsEnabled");(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(61)||r.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||r.AFrameworkApplication.K.$("RewriteIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(r.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").pA.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:r.AFrameworkApplication.uiCulture,dataCulture:r.AFrameworkApplication.dataCulture,isRightToLeft:r.AFrameworkApplication.isRtl,ulsLogger:new nm.a,dimeCallback:()=>Object(zs.__awaiter)(this,void 0,void 0,function*(){this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")}),
loadUpsellDependencies:()=>Object(zs.__awaiter)(this,void 0,void 0,function*(){this.W.Za("Common.IInProductMessagingUIManager").execute(h=>{h.vsi()})}),getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter")})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new x(ub.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),
ab.InteractiveViewManager.instance,Rb.KeyInputManager.instance,r.AFrameworkApplication.uc,r.AFrameworkApplication.ta,r.AFrameworkApplication.ta.k0,this.W.Za("Common.ISystemInitiatedFeedback"),this.W.Za("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:r.AFrameworkApplication.uiCulture,
ulsLogger:new nm.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new nm.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"))}).catch(h=>{w.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",h)})}dispose(){}static main(){K.a.instance.Kc(new E)}}Object(m.a)(E,
"PackageManager",null,[1,2]);class Z{constructor(b,h,u,y){this.cgm=(P,aa,ta)=>{P=null;aa.view.ue&&(P=aa.view);if(!P||!P.Bb)return 8;if(!this.VH.hwf())return 2;if(1===ta)return 32;this.MYj.uSk();return 32};this.Awi=(P,aa,ta)=>{let Pa=null;aa.view.ue&&(Pa=aa.view);if(!Pa||!Pa.Bb)return 8;if(!this.VH.hwf())return 2;if(1===ta)return 32;if(1!==this.VH.M5b(this.ib.hb,!0).count)return 2;aa=new dg.GraphTransaction(15);try{if(aa.Eb(Pa.jd),!this.VH.nro(P===Rc.a.YDf))return 8}finally{aa&&aa.dispose()}return 32};
this.ga=b;this.ib=h;this.VH=u;this.MYj=y}Wb(){this.ga.pa(Rc.a.RQd,oc.a.view,this.cgm);this.ga.pa(Rc.a.YDf,oc.a.view,this.Awi);this.ga.pa(Rc.a.Bwi,oc.a.view,this.Awi)}}Object(m.a)(Z,"IntelligentPlaceholderActor",null,[]);class oa{constructor(){this.lmc=new Tb.a;this.Uad=new Tb.a}C9j(b,h){let u;({value:u}=this.lmc.Gc(b,u)).returnValue||this.lmc.Z(b,u=new Ea.a);u.add(h)}h$j(b,h){this.Uad.ub(b)&&w.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.Uad.Z(b,h)}A9j(b,h,u){this.C9j(b,
h);this.h$j(h,u)}gul(b){let h;return({value:h}=this.lmc.Gc(b,h)).returnValue?h:null}Wwl(b){let h;return({value:h}=this.Uad.Gc(b,h)).returnValue?h:null}aFn(b){let h;if(({value:h}=this.lmc.Gc(b,h)).returnValue){for(const u of h)this.Uad.remove(u);this.lmc.remove(b)}else w.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(m.a)(oa,"IntelligentPlaceholderAtMentionManager",null,[484]);var Ka=c(1620);class eb extends Ka.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Cw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}gaj(b){return!b.ia(Lc.a.dG,
!1)}cgb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(m.a)(eb,"IntelligentPlaceholderDetailsProvider",Ka.a,[]);var wb=c(1758),Lb=c(1946),jc=c(1762);class Pc{constructor(){this.Qya=""}Sfa(b){this.Qya+=b}uei(b){this.Qya+=b}Isf(b){this.Qya+=b}insertImage(b){this.Qya+=b}fei(b){this.Qya+=b}}Object(m.a)(Pc,"PlainTextFormatCreator",null,[869]);var kd=c(1562),Rd=c(1945);c(386);var ze=c(1619),fe=c(1471);class df{constructor(){this.Foc=new Tb.a}contains(b){return this.Foc.ub(df.Ozf(b))}add(b){this.Foc.Z(df.Ozf(b),
b)}remove(b){this.Foc.remove(df.Ozf(b))}kto(b){for(const h of b.Foc)this.add(h.value)}LLh(){const b=new ob.a;for(const h of this.Foc)b.add(h.value.Wj);return b}static Ozf(b){return b.Wj.toString()}}Object(m.a)(df,"CommentRangeSet",null,[]);class Tf extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(m.a)(Tf,"OnFollowUpEventArgs",Sys.EventArgs,[]);class Zg extends Tf{constructor(b,h){super(b);this.fhn=h}}Object(m.a)(Zg,"OnCreateEventArgs",Tf,[]);class d extends Tf{constructor(b,
h){super(b);this.Lum=h}}Object(m.a)(d,"OnResolveEventArgs",Tf,[]);var t=c(224);class B{}B.gke="MentionExperienceDegraded";Object(m.a)(B,"AtMentionsConstants",null,[]);class U{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.YUc=b;this.Rok=h;this.D5c=u;this.Xxd=y;this.Bb=P;this.Nq=aa;this.kRd=ta;this.Yei=Pa;this.nu=vb;this.YZb=Kb;this.LQa=null;this.h8m=(Sb,Yb,Ac)=>{w.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Sb=this.kRd.k1a(Sb,Ac.displayName,Ac.email,Ac.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,
Yb),!0);Sb?w.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.YZb.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:B.gke,isInternal:!0})};this.c7m=(Sb,Yb)=>{w.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");Yb&&this.YZb.logUserAction(Rc.a.hBk);this.kRd.T3l(Sb.id,Yb)};this.j3m=()=>{this.Nq.od.Zv&&!this.Nq.od.sQ&&this.Nq.editingView.n$e?this.bqh=!0:(this.YUc.reset(),w.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};
this.r9m=()=>{w.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Abk()};this.b7m=(Sb,Yb,Ac,Sc=new Map)=>{Sc=Object.assign(new Ya.a,{extendedProperties:Sc});this.YZb.logKpiFailure("LPPWordEditorKPI",Sb,{isIntentional:Yb,isInternal:Ac,additionalValues:Sc},{name:B.gke,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:Yb,isInternal:Ac,additionalValues:Sc})};(b=Ja.a.instance.Pa("Box4.IEditStateEventManager"))&&b.addHandler(t.a.Hsa,this.TLn.bind(this))}txf(){return!!this.LQa}TLn(){this.txf()&&
this.bqh&&(this.LQa.updateInputText(this.eTc,!1),this.bqh=!1)}ariaNotify(b,h){this.nu.sendNotification(b,h)}Abk(){const b=this.Nq.editingView.editingElement;if(b){var h=b.getAttribute(hf.a.BBc);b.setAttribute(hf.a.BBc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else w.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}tEn(){const b=this.Nq.editingView.editingElement;if(b){var h=b.getAttribute(hf.a.BBc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),
h.length?b.setAttribute(hf.a.BBc,h.join(" ")):b.removeAttribute(hf.a.BBc)):w.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else w.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}VEk(){this.tEn();this.LQa&&this.LQa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.LQa=null;this.Yei.n5i(!0)}CTi(){this.YUc.KTi(()=>{this.VEk()});this.YUc.xTi((b,h)=>{this.eTc=b;if(this.LQa)1<this.eTc.length&&"@"===
this.eTc.trimEnd()?(this.YZb.logUserAction(Rc.a.gBk),this.YUc.reset()):this.LQa.updateInputText(this.eTc,!1);else if(this.YZb.logKpiUsage("LPPWordEditorKPI",0),this.YZb.logUserAction(Rc.a.Aan),(b=this.BFl(h))&&b.height){h=b.y;const u=b.height,y=document.createElement("div");y.id="PeoplePicker";y.style.position="absolute";y.style.top=h-5+"px";y.style.left=b.x+"px";y.style.height=u+10+"px";document.body.appendChild(y);this.Rok.createPeoplePicker({editingElementId:this.Nq.editingView.editingElement.id,
containerElement:y,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.h8m,onPermissionsReceivedCallback:this.c7m,onDismiss:this.j3m,onShow:this.r9m,onFailure:this.b7m}).then(P=>{P.updateInputText(this.eTc,!1);this.LQa=P;this.Yei.n5i(!1)})}});this.YUc.yTi(b=>{if(this.LQa)this.LQa.onKeyDown(b.Ib.rawEvent)})}BFl(b){var h=this.Bb.hb;if(!h)return null;h=h.kb;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(na.a)(37,h);if(!h)return null;h=Object(na.a)(199,h.gh(this.Nq.od.Sb));
if(!h)return null;h=Object(na.a)(132,h);if(!h)return null;let u=null;try{u=this.D5c.pZ(this.Xxd.u4b(2,b),h,!1,!1,!1,!1)}catch(y){w.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",y)}return u}}Object(m.a)(U,"WordEditorAtMentionsHandler",null,[400]);var ea=c(1462);class Ia{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd){this.ga=b;this.Zc=h;this.qab=u;this.ib=y;this.Pp=P;this.Rd=aa;this.GC=ta;this.Fgd=Pa;this.Ud=vb;this.Eo=Kb;this.DEj=Yb;
this.Ci=Ac;this.Ic=Sb;this.sa=new ie.a;this.lg=Sc;this.kBg=nd;fe.a.ETe((Ad,he)=>{this.dG(he.commentNode,!0)&&this.sa.raiseEvent(Ia.BWc)})}Xeh(b){this.sa.addHandler(Ia.qDi,b)}Jfk(b){this.sa.addHandler(Ia.zGi,b)}qfk(b){this.sa.addHandler(Ia.W5m,b)}ETe(b){this.sa.addHandler(Ia.BWc,b)}dG(b,h){let u=b.ia(Lc.a.dG,!1);h&&(u=u&&!b.ia(Lc.a.R$,!1));return u}Z8b(b){return this.Pp.Z8b(b)}ZLl(b){for(const h of b)for(const u of h)if(Ia.czf(u.contextId))return u.node.Jc;return null}XSl(b,h,u){const y=new df,P=b.Jc;
for(let aa=0;aa<b.qa.length;aa++){const ta=b.qa.J(aa);if(ta.cp>=h)break;if(ta.zf&&ta.zf.length)for(let Pa=0;Pa<ta.zf.length;Pa++){const vb=ta.zf.J(Pa);this.dG(P.Db(vb.Wj),u)&&(vb.Oc?y.add(vb):y.remove(vb))}}return y}YSl(b,h,u,y){const P=new df,aa=b.Jc;for(let ta=0;ta<b.qa.length;ta++){const Pa=b.qa.J(ta);if(Pa.cp>u)break;if(Pa.zf&&Pa.zf.length)for(let vb=0;vb<Pa.zf.length;vb++){const Kb=Pa.zf.J(vb);this.dG(aa.Db(Kb.Wj),y)&&(Kb.Oc?Pa.cp<u&&P.add(Kb):Pa.cp<=h&&P.remove(Kb))}}return P}U3h(b,h){let u;
const y=b.node;b.contextId!==oc.a.paragraph?(u=b.cpBegin,b=b.cpEnd):(u=0,b=y.characterData.length);return u===b?this.XSl(y,u,h):this.YSl(y,u,b,h)}lMc(b,h){return Ia.czf(b.contextId)?this.U3h(b,h).LLh():new ob.a}M5b(b,h){const u=new df;for(const y of b)for(const P of y)Ia.czf(P.contextId)&&u.kto(this.U3h(P,h));return u.LLh()}hwf(){var b=this.ib.hb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Qa.node;return be.ParagraphReader.ic(b)&&!be.ParagraphReader.rta(b)&&this.Pp.hib(this.ga,!0)?!0:
!1}hei(b,h){if(!this.hwf())return null;if(this.Pp.S5l())return w.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let u=!1;var y=this.ib.hb.J(0).Qa;y.contextId===oc.a.Vc?(b=b?Se.SelectionEditor.Q2(y,!1):null)&&b.Nx&&b.Qa.contextId===oc.a.Fd?this.ib.setSelection(b):(this.Rd.replaceTextRange(y,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ib.setSelection(Kf.SelectionFactory.JL(y.node,y.cpBegin,y.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):
u=!0;this.lg.oAb||wb.a.instance.bPc();b=this.Pp.Gzb(this.ib.hb.kb);if(!b)return null;this.Z8b(b)&&this.kBg.logUserAction(Wa.a.newComment,{succeeded:!0,sOb:29});var P=this.Zc.ng(b);const aa=P.Rb(1);if(!aa||393229!==aa.Rc)return null;P=P.Rb(2);if(!P||393230!==P.Rc)return null;this.ecg(b.Jc,b.id);this.sa.raiseEvent(Ia.qDi,new Zg(b,h));u&&(h=y.node,y=y.contextId!==oc.a.paragraph?y.cpEnd:h.characterData.length,this.ib.setSelection(Kf.SelectionFactory.JL(h,y,y)));return b}RQd(b){return!!this.hei(!0,b)}nPc(b,
h,u,y,P,aa){if(0>h)return!1;y="@"+y;const ta=y+" ",Pa=new dg.GraphTransaction(15);try{Pa.Eb(b);this.Rd.replaceTextRange(nf.a.createTextRange(b,h,u),ta);this.Ud.zg&&(this.Eo.z0e(b,h,h+y.length),this.Eo.lpa(b,h+y.length,h+ta.length,1));const vb=this.GC.eH(nf.a.createTextRange(b,h,h+y.length),"mailto:"+P,!1,!0,!1);if(!vb)return!1;const Kb=vb.Zw;if(!Kb)return w.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ib.setSelection(Kf.SelectionFactory.JL(b,h,
h+y.length));const Sb=this.hei(!1,2);if(!Sb)return!1;aa&&this.Fgd.A9j(aa,Kb,Sb.id);this.ib.setSelection(Kf.SelectionFactory.we(b,h+ta.length))}finally{Pa&&Pa.dispose()}return!0}k1a(b,h,u,y){const P=this.ib.Lg;return Se.SelectionEditor.pf(P)?this.nPc(P.node,P.cpBegin-b,P.cpBegin,h,u,y):!1}fPl(b){if(1===b.length&&b.J(0).Nx&&(b=b.J(0).Qa,b.contextId===oc.a.Vc&&be.ParagraphReader.ic(b.node))){const h=b.node;for(let u=0;u<h.qa.length;u++){const y=h.qa.J(u);if(y.cp===b.cpBegin){b=y.RLd(!0,!0);if(0<b.length)return b[0].Wj;
break}}}return null}wzb(b,h,u){return this.Pp.TEc(b,h,u).returnValue}yId(b,h,u,y,P){let aa=!1;const ta=b.characterData;if(h>=ta.length||u>ta.length||u<h)return{returnValue:!1,qNa:aa};let Pa=h,vb=null;for(let Sb=0;Sb<b.qa.length;Sb++){const Yb=b.qa.J(Sb),Ac=Yb.cp;if(!(Ac<h)){if(Yb.ql&&vb)try{const Sc=ta.substring(Pa,Ac),nd=new Lb.a;nd.fullName=Sc.startsWith("@")?Sc.substr(1):Sc;ze.a(vb,nd);const Ad=new jc.a;ze.b(vb,Ad);P&&(Ad.contentId=this.DEj.fff());y.Isf(Sc,nd,Ad);aa=!0;vb=null;Pa=Ac}catch(Sc){var Kb=
Object.assign(new Ya.a,{extendedProperties:new Map});Kb.extendedProperties.set("exception",Sc.message);this.kBg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Kb},{name:B.gke,isInternal:!0,additionalValues:Kb})}Ac<=u&&!vb&&(Kb=Math.min(Ac,u),Kb>Pa&&y.Sfa(ta.substring(Pa,Kb)),Pa=Ac);Yb.hyperlink&&Yb.hyperlink.cG&&(vb=Yb.hyperlink);if(Ac>=u)break}}return{returnValue:!0,qNa:aa}}mSh(b,h,u,y,P=-1){var aa=!1,ta=b.Db(h),Pa=b.Db(ea.k(ta));ta=b.Db(ea.h(ta));P=0<
P?P:Number.MAX_VALUE;b=this.wzb(Pa,h,!0);h=this.wzb(ta,h,!1);if(-1===b||-1===h)return{returnValue:!1,qNa:aa};if(Pa===ta)return this.yId(Pa,b,h,u,y);const vb=this.qab.$Ba(Pa,!1,!1);if(!vb)return{returnValue:!1,qNa:aa};Pa=new ob.a;let Kb=0;do Pa.add(vb.Qx),Kb+=vb.Qx.characterData.length;while(vb.Qx!==ta&&vb.Lfa()&&Kb<P);for(P=0;P<Pa.count;P++)if(aa=Pa.J(P),ta=aa.characterData,P)if(P===Pa.count-1){if(!({qNa:aa}=this.yId(aa,0,h,u,y)).returnValue)return{returnValue:!1,qNa:aa}}else{if(!({qNa:aa}=this.yId(aa,
0,ta.length,u,y)).returnValue)return{returnValue:!1,qNa:aa};u.Sfa("\n")}else{if(!({qNa:aa}=this.yId(aa,b,ta.length,u,y)).returnValue)return{returnValue:!1,qNa:aa};u.Sfa("\n")}return{returnValue:!0,qNa:aa}}xId(b,h){const u=new Pc;return this.mSh(b,h,u,!1,-1).returnValue?u.Qya:null}UFd(b,h){var u=b.Db(h);if(!u)return null;b=b.Db(ea.h(u));if(!b)return null;h=this.wzb(b,h,!1);if(-1===h)return null;u=b.characterData;if(h>=u.length||!A.a.eba(u.charAt(h))){u=this.Ic.Qc(15);try{u.Eb(b),this.Rd.replaceTextRange(nf.a.Uc(b,
h)," ")}finally{u&&u.dispose()}}return Kf.SelectionFactory.we(b,h+1)}ecg(b,h){const u=b.Db(h),y=new kd.a;this.mSh(b,h,y,!0).returnValue&&(y.Sfa("\n"),this.Pp.Mnj(u,y.y9),this.sa.raiseEvent(Ia.E$m))}jSn(b,h){for(const u of b){if(u.contains(h))return!0;for(const y of u)for(const P of h)if(y.node===P.node&&y.xk>=P.xk)return!0}return!1}bEh(b,h,u,y,P){const aa=this.ib.hb.clone(),ta=new az.a(Ra.App.xa.jb.wc);b=Kf.SelectionFactory.we(b,h);u=nf.a.Uc(u,y);b=Kf.SelectionFactory.Vz(b,u);this.ib.setSelection(b);
u=!this.jSn(aa,b);return 32===this.ga.Tf(ta,Oa.a.gH,2,!0,null,null)?(u?this.ib.cY(aa):P!==T.a.nil&&(P=this.UFd(this.Ci.value,P),this.ib.setSelection(P)),!0):!1}dDn(b,h){var u=b.Db(h);const y=b.Db(ea.k(u));b=b.Db(ea.h(u));if(y===b){u=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var P=y.characterData.indexOf(u);-1!==P&&this.bEh(y,P,b,P+u.length,h)}}jEh(b,h,u){var y=b.Db(h);if(!y)return!1;const P=b.Db(ea.k(y));b=b.Db(ea.h(y));y=this.wzb(P,h,!0);const aa=this.wzb(b,h,
!1);if(-1===y||-1===aa||!this.bEh(P,y,b,aa,T.a.nil))return!1;u&&this.sEh(h);return!0}sEh(b){this.Pp.rXf(b,!0)}nro(b){var h=this.ZLl(this.ib.hb);if(!h)return!1;const u=this.M5b(this.ib.hb,!0);if(1!==u.count)return!1;const y=h.Db(u.J(0));if(b)h=this.jEh(h,u.J(0),!1);else{const P=ea.k(y),aa=ea.h(y);T.a.Qp(P,aa)||w.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.iPk(u.J(0));h.Db(P).Ck(16,!0);h=!0}h&&(y.setValue(Lc.a.R$,!0),this.sa.raiseEvent(Ia.zGi,
new d(y,b)));return h}alh(b,h){b=this.M5b(this.ib.hb,!1);h.Ko[Ia.PFh]=!!b.count}HEi(b,h){if(h.Ko[Ia.PFh]&&be.ParagraphReader.ic(h.clone)&&(h=h.clone,b=h.Jc)&&(h=nf.a.createTextRange(h,0,h.characterData.length),h=this.lMc(h,!1),h.count))for(const u of h)(h=b.Db(u))&&h.setValue(Lc.a.dG,!1)}Jyl(b,h,u){let y;const P=({lDc:vb}=this.Pp.TEc(h,u,!0)).returnValue;u=({lDc:y}=this.Pp.TEc(h,u,!1)).returnValue;let aa=null,ta=-1,Pa=-1;for(;vb<y;vb++){const Kb=h.qa.J(vb);if(Kb.hyperlink&&Kb.hyperlink.cG&&Kb.hyperlink.Zw===
b){aa=Kb.hyperlink;ta=Kb.cp;break}}if(!aa||ta<P)return{returnValue:!1,tyh:ta,syh:Pa};for(b=vb;b<h.qa.length;b++){var vb=h.qa.J(b);if(vb.cp>u)break;if(vb.DT){Pa=vb.cp;break}}return{returnValue:-1!==Pa,tyh:ta,syh:Pa}}aEn(b){var h=this.Fgd.Wwl(b);if(h){var u=null;Ra.App.xa&&(u=Ra.App.xa.jb.Yc.Bd);if(u){var y=u.Db(h);h=u.Db(ea.k(y));var P=u.Db(ea.h(y));if(h!==P)w.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({tyh:b,syh:P}=this.Jyl(b,h,y.id)).returnValue){var aa=
new dg.GraphTransaction(7);try{aa.Eb(h);const ta=nf.a.createTextRange(h,b,P);this.Rd.replaceTextRange(ta,"");this.ecg(u,y.id)}finally{aa&&aa.dispose()}this.ib.hb&&0<this.ib.hb.length?(u=this.ib.hb.J(0).Qa,u.node===h?w.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",u.cpBegin,b):w.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):w.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.setSelection(Kf.SelectionFactory.we(h,
b))}else w.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else w.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else w.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}T3l(b,h){if(!h){h=this.Fgd.gul(b);if(!h){w.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const u of h)this.aEn(u)}this.Fgd.aFn(b)}Zrl(){wb.a.instance.bPc();const b=new ob.a;for(const u of this.Pp.GUe)if(u.dr!==
Rd.a.beingCreated){var h=T.a.Gf(u.objectId);h=this.Ci.value.Db(h);this.dG(h,!0)&&b.add(h)}return b}MRn(b){b=this.Pp.smf(b);this.ib.setSelection(b)}iPk(b){b?this.Ci.value.Db(b).setValue(Lc.a.dG,!1):w.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static czf(b){return b===oc.a.Fd||b===oc.a.Vc||b===oc.a.paragraph}}Ia.PFh="DisableNestedIntelligentPlaceholder";Ia.qDi="CreateIntelligentPlaceholder";Ia.zGi="ResolveIntelligentPlaceholder";Ia.E$m="UpdateIntelligentPlaceholder";
Ia.BWc="DeleteIntelligentPlaceholder";Ia.W5m="MentionAddedToFollowUpEventKey";Object(m.a)(Ia,"IntelligentPlaceholderEditor",null,[478,479,480]);class ib{constructor(b,h,u,y){this.sra=!1;this.Yq=!0;this.ie=null;this.Fcb=P=>{if(!this.Yq||!this.hAk(P,this.ib.hb))return!1;P.Ib.preventDefault();P.Ib.stopPropagation();this.fd.od&&this.fd.od.QHc(!1);P=this.UFd(this.ib.hb);if(!P)return!1;this.ib.setSelection(P);return!0};this.fd=b;this.Ci=h;this.ib=u;this.B5=y}SBc(b,h){this.sra||(b.pva?(this.Gcb(h),this.sra=
!0):b.kea(()=>{this.sra||(this.Gcb(h),this.sra=!0)}))}dispose(){this.ie&&this.ie.sc(bb.a.hI,this.fd.editingView.editingElement,this.Fcb)}Gcb(b){this.ie=b;this.fd.od.mi&&this.ie.mb(bb.a.hI,this.fd.editingView.editingElement,this.Fcb)}hAk(b,h){if(b.Ib.keyCode!==fb.a.xx&&b.Ib.keyCode!==fb.a.us||1!==h.length||!h.J(0).Nx)return!1;var u=this.B5.M5b(h,!0);if(1!==u.count)return!1;const y=h.J(0).Qa.node;if(!be.ParagraphReader.ic(y))return!1;b=this.B5.wzb(y,u.J(0),!0);u=this.B5.wzb(y,u.J(0),!1);return h.J(0).Qa.cpBegin<
b||h.J(0).Qa.cpEnd>u?!1:!0}UFd(b){b=this.B5.M5b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.B5.UFd(this.Ci.value,b)}n5i(b){this.Yq=b}}Object(m.a)(ib,"IntelligentPlaceholderKeyboardListener",null,[392,9]);class Jb{constructor(b,h){this.Hhm=u=>{1===u&&this.ga.processAction(Wa.a.newComment,2);2===u&&(this.X3g.instance?this.X3g.instance.vjc("https://go.microsoft.com/fwlink/?linkid=2154656")&&A.a.tX("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656",
"_blank"):w.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));u=[Object.assign(new ca.a,{name:"DialogResult",int64:u})];Ub.d(Rc.a.yPh,void 0,void 0,void 0,void 0,void 0,u)};this.ga=b;this.X3g=h}uSk(){const b=new Gh.StandardDialog;b.Ed=11;b.Ue(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Ue(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.xv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,
0,this.Hhm);Ub.a("FollowUpsPhaseOutDialogShown")}}Object(m.a)(Jb,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var mc=c(1443);class Bc{constructor(b,h,u,y,P,aa){this.Q5=this.oHe=null;this.S3=()=>{this.Q5||(this.Q5=new sc.a(3,1,0,()=>{this.Q5=null;this.SOd(this.ib.hb)},130),this.Gb.Xb(this.Q5))};this.Ic=b;this.VH=h;this.ib=u;this.Gb=y;this.GPe=P;this.Ci=aa;this.l1=new Nk.a;this.xs=new mc.a;this.M_g=new bm.a(this.l1);this.VH.Xeh((ta,Pa)=>{this.Gbk(Pa.commentNode)})}Gbk(b){b=b.id;const h=this.T1h(this.Ci.value,
b);h&&this.xs.Z(b,h)}T1h(b,h){const u=b.Db(h);return!u||this.VH.Z8b(u)?null:this.VH.xId(b,h)}$tk(b){const h=new mc.a;var u=this.VH.M5b(b,!0);if(!u)return h;b=this.Ci.value;for(const y of u)(u=this.T1h(b,y))&&h.Z(y,u);return h}rXf(b){if(this.oHe){const h=this.Ic.Qc(15);try{h.Eb(this.GPe()),this.VH.sEh(this.oHe)}finally{h&&h.dispose()}}this.oHe=b?this.VH.fPl(b):null}v4l(b){const h=this.Ci.value;if(b=b?this.$tk(b):new mc.a){var u=new bm.a(this.l1),y=new bm.a(this.l1);Bc.JBl(this.xs,b,u,y);for(var P of u)this.xs.Z(P,
b.J(P));for(const aa of y)if(u=this.xs.J(aa),y=this.VH.xId(h,aa),this.xs.remove(aa),y&&(b=P=!1,la.a.QMc().equals(y,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,u=!1):u=-1<y.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?P=!0:!la.a.QMc().equals(u,y),u||P||b)){y=this.Ic.Qc(15);try{y.Eb(this.GPe()),b?this.VH.jEh(h,aa,!0):(P&&this.VH.dDn(h,aa),u&&this.VH.ecg(h,aa))}finally{y&&y.dispose()}}}}iOl(b){const h=new bm.a(this.l1);for(const u of b)for(const y of u)b=
y.node,be.ParagraphReader.ic(b)&&h.add(b.id);return h}P2l(b){var h=this.Ci.value;const u=b?this.iOl(b):new bm.a(this.l1);if(u){b=new ob.a;for(const aa of this.M_g)if(!u.contains(aa)){var y=h.Db(aa);if(y){y=y.qa;for(let ta=0;ta<y.length;ta++){const Pa=y.J(ta).zf;if(Pa)for(let vb=0;vb<Pa.length;vb++){var P=Pa.J(vb);P.Oc&&(P=h.Db(P.Wj))&&P.ia(Lc.a.epi,!1)&&T.a.Qp(aa,ea.h(P))&&this.VH.Z8b(P)&&b.add(P)}}}}this.M_g=u;if(b.count){h=this.Ic.Qc(7);try{h.Eb(this.GPe());for(const aa of b)aa.Ng(Lc.a.epi)}finally{h&&
h.dispose()}}}}SOd(b){this.rXf(b);this.v4l(b);this.P2l(b)}Rph(){this.Q5&&(this.Gb.Se(this.Q5),this.Q5=null)}sWc(){if(this.Q5||this.Ci.Ypf)this.Rph(),this.SOd(null)}fB(){this.ib.DA(this.S3);r.AFrameworkApplication.rJ(()=>{this.sWc()})}dispose(){this.ib.$ba(this.S3);this.Rph()}static JBl(b,h,u,y){for(const P of h){const aa=P.key;b.ub(aa)||u.add(aa)}for(const P of b)b=P.key,h.ub(b)||y.add(b)}}Object(m.a)(Bc,"IntelligentPlaceholderSelectionCache",null,[9]);var Yc;(function(b){b[b.unknown=0]="unknown";
b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.w0o=3]="textGesture";b[b.paste=4]="paste";b[b.ZJo=5]="workItemIntent";b[b.dRo=6]="characterTrigger"})(Yc||(Yc={}));Object(m.b)("IntelligentPlaceholderCreation",Yc);class od{constructor(b,h,u,y){this.iza=b;this.Yl=h;this.IQb=u;this.Ex=y}Lbe(b){return b&&b.Jc&&b.Jc.id.equals(this.Ex.value.Bd.id)?!0:!1}x$i(b){return this.Lbe(b)&&b.ia(Lc.a.dG,!1)?!0:!1}$Lm(){this.IQb.execute(b=>{b.logAction({actionType:bp.b.SessionStart,engagement:bp.a.Offer,
objectName:od.vic})})}PXd(b,h){let u=!1;r.AFrameworkApplication.K.$("FixInCanvasMentionLogging")&&(u=2==h&&this.Lbe(b));if(this.x$i(b)||u){var y=b.getValue(Lc.a.nE);this.IQb.execute(P=>{P.logAction({actionType:bp.b.Created,engagement:bp.a.None,objectName:od.vic,objectId:y.toString(),objectFulfillment:Yc[h]})})}}LIm(b){if(this.x$i(b)){var h=b.getValue(Lc.a.nE);this.IQb.execute(u=>{u.logAction({actionType:bp.b.Deleted,engagement:bp.a.None,objectName:od.vic,objectId:h.toString()})})}}TMm(b,h){if(this.Lbe(b)){var u=
b.getValue(Lc.a.nE);this.IQb.execute(y=>{y.logAction({actionType:bp.b.Resolved,engagement:bp.a.None,objectName:od.vic,objectId:u.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}cOm(b){b===Rc.a.RQd&&this.IQb.execute(h=>{h.logAction({actionType:bp.b.Deleted,engagement:bp.a.None,objectName:od.vic,objectFulfillment:od.Jko})})}VKm(b){if(this.Lbe(b)){var h=b.getValue(Lc.a.nE);this.IQb.execute(u=>{u.logAction({actionType:bp.b.Modified,engagement:bp.a.None,objectName:od.vic,objectId:h.toString(),
objectFulfillment:"MentionInserted"})})}}Vqk(){this.$Lm();this.iza.Xeh((b,h)=>{this.PXd(h.commentNode,h.fhn)});this.iza.Jfk((b,h)=>{this.TMm(h.commentNode,h.Lum)});this.iza.qfk((b,h)=>{this.VKm(h.commentNode)});this.Yl.gvd((b,h)=>{this.cOm(h.actionId)});fe.a.ETe((b,h)=>{this.LIm(h.commentNode)})}}od.vic="IntelligentPlaceholder";od.Jko="Undo";Object(m.a)(od,"IntelligentPlaceholderTelemetry",null,[]);class wd{constructor(){this.B5=this.yid=this.ypd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}xc(b){this.W=
b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new Jb(r.AFrameworkApplication.ya,b.Za("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new oa).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Ia(r.AFrameworkApplication.ya,new Zo.a,b.resolve("Box4.IParagraphIteratorFactory"),
b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Zf.a(()=>
Ra.App.xa.jb.Yc.Bd),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new Z(r.AFrameworkApplication.ya,b.resolve("Box4.ISelectionManager"),
b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Bc(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),r.AFrameworkApplication.uc,()=>Ra.App.xa.jb.wc.jd,new Zf.a(()=>
Ra.App.xa.jb.Yc.Bd))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new ib(ab.InteractiveViewManager.instance,new Zf.a(()=>Ra.App.xa.jb.Yc.Bd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new od(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.IUndoManager"),b.Za("CanvasContextual.ICanvasContextualController"),new Zf.a(()=>Ra.App.xa.jb.Yc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()})}$m(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Za("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Wb();this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").Vqk();this.B5=
this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");Kl.a.iek(Object(v.a)(this.B5,this.B5.alh,"beforeIntelligentPlaceholderPaste"));Kl.a.FAc(Object(v.a)(this.B5,this.B5.HEi,"onIntelligentPlaceholderPaste"));this.ypd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(98)||this.ypd.fB();this.yid=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");this.yid.SBc(Ra.App.xa.jb,
Rb.KeyInputManager.instance);this.Pzn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.ypd&&this.ypd.dispose();this.yid&&this.yid.dispose();this.B5&&(Kl.a.iFn(Object(v.a)(this.B5,this.B5.alh,"beforeIntelligentPlaceholderPaste")),Kl.a.MFn(Object(v.a)(this.B5,this.B5.HEi,"onIntelligentPlaceholderPaste")))}Pzn(b,h,u){b&&b.execute(y=>{y.a4(new eb(h,u))})}static main(){K.a.instance.Kc(new wd)}}
Object(m.a)(wd,"PackageManager",null,[1,2]);var Fd=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},
{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},
{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},Zd=c(1984),Ve=c(1878),Qc=c(1952);class md{}md.Qdo="Search_16x16x32";md.Ido="ClosePaneGlyph_16x16x32";Object(m.a)(md,"SearchBoxIcons",null,[]);var bf=c(1955),
qh=c(1956),hh=c(1954);class nk{constructor(){this.pKg=null}get key(){return"FIND_HIT"}get Cw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.pKg=b.node.tma()}jHa(b){let h=null;for(const u of this.pKg)if(u.begin<=b&&b<u.end)return h=Object.assign(new Sn.a,{kG:this.key,contentObject:u}),{returnValue:!0,jF:h};return{returnValue:!1,jF:h}}}Object(m.a)(nk,"FindHitDetailsProvider",null,[245,246]);var gi=c(1593),ki=c(1535),Kp=c(1573);class Mm{constructor(b,h,u,y,P,aa,ta,Pa=null,
vb=null){this.Wl=null;this.find=(Kb,Sb,Yb,Ac,Sc)=>1===Yb?32:void 0===Sc||null===Sc?8:Sc.length?this.z7f(Sc):(this.VZe(Qc.a.initial),32);this.findInDocument=(Kb,Sb,Yb,Ac,Sc)=>this.Ibj(Rc.a.lnb,Kb,Sb,Yb,Ac,Sc);this.Zhl=(Kb,Sb,Yb,Ac,Sc)=>this.Ibj(Rc.a.nnb,Kb,Sb,Yb,Ac,Sc);this.VNh=(Kb,Sb,Yb)=>1===Yb?32:this.z7f(this.oo.ONa());this.rZc=(Kb,Sb,Yb,Ac,Sc)=>{Kb=!this.oo.DF;Sc[Eg.a.Image16by16Class]=Kb?Gd.getImageClass(md.Qdo):Gd.getImageClass(md.Ido);Sc[Eg.a.LabelText]=Kb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Sc[Eg.a.ApplyLabelTextToControlOnly]=!0;Sc[Eg.a.EnsureControlRoleIsButton]=!0;Sc[Eg.a.On]=!1;return 32};this.djl=(Kb,Sb,Yb)=>{if(1===Yb)return 32;this.j8h(!1);return 32};this.ojl=(Kb,Sb,Yb)=>{if(1===Yb)return 32;this.j8h(!0);return 32};this.YTf=(Kb,Sb,Yb,Ac,Sc)=>{Sc[Qm.a.Visible]=this.oo.Obj;return 32};this.hUf=(Kb,Sb,Yb,Ac,Sc)=>{Sc[Qm.a.Visible]=this.oo.Obj;return 32};this.sNd=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return 32;this.rA.f1c.o8h(Sc);
return 32};this.cancelSearch=(Kb,Sb,Yb)=>{if(1===Yb)return 32;this.VZe(Qc.a.initial);return 32};this.FDc=(Kb,Sb,Yb)=>{if(1===Yb)return 32;this.VZe(Qc.a.initial);this.oo.mB(!1);return 32};this.clearSearch=(Kb,Sb,Yb)=>{if(1===Yb)return this.olm(Kb===Wa.a.Rsh);this.oo.clearSearch();return 32};this.Ahe=(Kb,Sb,Yb)=>{if(1===Yb)return 32;switch(Kb){case Wa.a.Tcf:this.oo.matchCase=!this.oo.matchCase;break;case Wa.a.gdf:this.oo.matchWholeWord=!this.oo.matchWholeWord}return this.z7f(this.oo.ONa())};this.J5d=
(Kb,Sb,Yb,Ac,Sc)=>{Sc[ag.a.On]=this.oo.matchCase;return 32};this.L5d=(Kb,Sb,Yb,Ac,Sc)=>{Sc[ag.a.On]=this.oo.matchWholeWord;return 32};this.JTf=(Kb,Sb,Yb,Ac,Sc)=>{Kb=this.oo.matchCase;Sb=this.oo.matchWholeWord;Yb="";Kb&&Sb?Yb=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Kb?Yb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Sb&&(Yb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Sc[sk.a.Value]=Yb;Sc[sk.a.Visible]=Kb||Sb;return 32};this.Pdc=(Kb,Sb,Yb,Ac,Sc)=>{Kb=this.oo.w1;Sb="";switch(this.oo.DF){case Qc.a.startSearch:Sb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Qc.a.searching:Sb=Kb?this.Zlf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Qc.a.searchComplete:Sb=
this.Zlf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case Qc.a.tooManyResults:Sb=this.Zlf(this.oo.nEa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case Qc.a.noMatchesFound:Sb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case Qc.a.replaceAllInProgress:Sb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case Qc.a.replaceAllComplete:Sb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Sc[sk.a.Value]=
Sb;return 32};this.K5d=(Kb,Sb,Yb,Ac,Sc)=>{Sc&&(Sc.CommandValueId=this.oo.ONa());return 32};this.replace=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return this.Rxf()?32:8;if(!this.Rxf())return 8;Kb=this.oo.cDb();"string"===typeof Sc&&Sc&&(Kb=Sc);w.ULS.sendTraceTag(6033813,312,50,"Replace Called");Ub.a("NavigationPaneReplace");Sc=this.wvb.replace(Kb);this.oo.iVn(Sc);return 32};this.replaceAll=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return this.Rum()?32:8;Kb=this.oo.cDb();"string"===typeof Sc&&Sc&&(Kb=Sc);Ub.a("NavigationPaneReplace");
this.Wl=this.je.jg("UserAction","ReplaceAll");this.oo.r6(Qc.a.replaceAllInProgress);w.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");Kp.a.SHn(this.oo.ONa(),this.oo.cDb());this.wvb.replaceAll(Kb,this.f8m);return 32};this.f8m=(Kb,Sb)=>{this.Wl&&(this.Wl.stop(),this.Wl=null);w.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Kb,["TotalCount"]:Sb});Kp.a.PHn(Kb,Sb);this.oo.r6(Qc.a.replaceAllComplete)};this.DPi=(Kb,Sb,Yb,Ac,Sc)=>{Sb=!1;if(!Sc)return 8;
this.oo.hj.isVisible&&(Sb=Kb===Rc.a.MZc===this.oo.gMc());Kb!==Rc.a.MZc||this.WRg||(Sb=!1);Sc[ag.a.On]=Sb;return 32};this.KTf=(Kb,Sb,Yb,Ac,Sc)=>{if(!Sc||!this.oo.hj.isVisible)return 32;Sc[ag.a.On]=this.oo.nEa;return 32};this.MTf=(Kb,Sb,Yb,Ac,Sc)=>{if(!Sc)return 32;Sc.currentFindReplaceViewType=this.oo.DF;return 32};this.ypn=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return 32;Kb=Sc[ag.a.On];Sc&&(Sc[ag.a.On]=this.oo.hj.isVisible);Kb&&!Sc[ag.a.On]&&(Mm.nkj(),Ub.a("NavigationPaneCrossClick"));return 32};this.i6a=(Kb,
Sb,Yb,Ac,Sc)=>{const nd=this.oo.hj.isVisible;w.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",nd);return nd?this.FDc(Kb,Sb,Yb,Ac,Sc):this.chc(Kb,Sb,Yb,Ac,Sc)};this.chc=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return ui.SessionStatusManager.instance.XI?32:8;if(2===Yb){r.AFrameworkApplication.Bga("AutoDetectedHeadingsIsEnabled");Mm.nkj();this.c4();gi.FindReplaceUIManager.Nxk(Kb,Sc,this.oo.hj.isVisible);Sb=!0;Kb===Rc.a.hhc&&void 0!==Sc&&null!==Sc&&(Sb=Sc);this.oo.mB(!0,Sb);Sc=hh.a.initial;switch(Kb){case Rc.a.dhc:w.ULS.sendTraceTag(42501022,
367,50,"");Sc=hh.a.headings;break;case Rc.a.lnb:Sc=hh.a.find;break;case Rc.a.nnb:Sc=hh.a.replace;break;case Rc.a.hhc:Sc=hh.a.intelligentPlaceholder;break;case Rc.a.i6a:Sc=this.oo.geb,Sc||(w.ULS.sendTraceTag(42501023,367,50,""),Sc=hh.a.headings)}this.oo.b_n(Sc,Sb);return 32}return 8};this.ZEa=()=>{this.oo.DF&&!this.oo.nEa&&w.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.oo=h;this.rA=u;this.wvb=y;this.WRg=P;this.je=ta;vb&&vb(1,this.ZEa,null);this.kJa=Pa}c4(){}Wb(){this.ga.gb(Rc.a.yUf,
oc.a.view,this.ypn,96);this.ga.pa(Rc.a.i6a,oc.a.view,this.i6a);this.ga.pa(Rc.a.dhc,oc.a.view,this.chc);this.ga.pa(Rc.a.lnb,oc.a.view,this.chc);this.ga.pa(Oa.a.VGd,oc.a.view,this.find);this.ga.pa(Wa.a.findInDocument,oc.a.view,this.findInDocument);this.ga.pa(Oa.a.findOnPage,oc.a.view,this.VNh);this.ga.gb(Wa.a.apn,oc.a.view,this.rZc,97);this.ga.pa(Oa.a.s_d,oc.a.view,this.djl);this.ga.pa(Oa.a.c5d,oc.a.view,this.ojl);this.ga.gb(Oa.a.YTf,oc.a.view,this.YTf,97);this.ga.gb(Oa.a.hUf,oc.a.view,this.hUf,97);
this.ga.pa(Rc.a.sNd,oc.a.view,this.sNd);this.ga.pa(Oa.a.Iyb,oc.a.view,this.cancelSearch);this.ga.pa(Wa.a.clearSearch,oc.a.view,this.clearSearch);this.ga.pa(Wa.a.Rsh,oc.a.application,this.clearSearch);this.ga.pa(Rc.a.FDc,oc.a.view,this.FDc);this.ga.pa(Wa.a.Tcf,oc.a.view,this.Ahe);this.ga.pa(Wa.a.gdf,oc.a.view,this.Ahe);this.ga.gb(Wa.a.J5d,oc.a.view,this.J5d,97);this.ga.gb(Wa.a.L5d,oc.a.view,this.L5d,97);this.ga.gb(Rc.a.JTf,oc.a.view,this.JTf,97);this.ga.gb(Rc.a.Pdc,oc.a.view,this.Pdc,97);this.ga.gb(Rc.a.KTf,
oc.a.view,this.KTf,97);this.ga.gb(Rc.a.MTf,oc.a.view,this.MTf,97);this.ga.gb(Rc.a.LTf,oc.a.view,this.DPi,97);Object(ki.b)()&&this.ga.gb(Rc.a.K5d,oc.a.view,this.K5d,96);this.WRg&&(this.ga.gb(Rc.a.nnb,oc.a.view,this.chc,1028),this.ga.gb(Rc.a.MZc,oc.a.view,this.DPi,97),this.ga.gb(Rc.a.replace,oc.a.view,this.replace,1028),this.ga.gb(Rc.a.replaceAll,oc.a.view,this.replaceAll,1028),r.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.gb(Wa.a.adf,oc.a.view,this.Zhl,1028));this.ga.pa(Rc.a.hhc,oc.a.view,this.chc)}gWf(){this.kJa&&this.kJa.execute(b=>{b.a4(new nk)})}Ibj(b,h,u,y,P,aa){if(1===y)return ui.SessionStatusManager.instance.XI?32:8;if(void 0===aa||null===aa)return 8;this.chc(b,u,2,P,aa);b=this.oo;b.d2f(aa.CommandValueId);Object(ki.b)()&&("MatchCase"in aa&&(b.matchCase=aa.MatchCase),"MatchWholeWord"in aa&&(b.matchWholeWord=aa.MatchWholeWord));return this.VNh(h,u,y,P,aa)}z7f(b){if(void 0===b||null===b||!b.length)return 32;
b=bf.a.createQuery(b,this.epn);if(void 0===b||null===b)return w.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.rA.find(b);return 32}get epn(){let b=qh.a.none;this.oo.matchCase&&(b|=qh.a.matchCase);this.oo.matchWholeWord&&(b|=qh.a.wholeWordOnly);return b}j8h(b){this.oo.geb!==hh.a.headings&&this.oo.w1&&(b?this.rA.f1c.y0l():this.rA.f1c.l8h())}VZe(b){this.oo.DF&&(this.oo.nEa||w.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.rA.vYa(),this.oo.r6(b))}olm(b){return this.oo.DF===
Qc.a.replaceAllInProgress||b&&!this.oo.DF?8:32}Zlf(b){return String.format(b,this.oo.Sbd,this.oo.w1)}Rxf(){return this.oo.gMc()&&0<this.oo.w1}Rum(){return this.Rxf()&&this.oo.nEa}static nkj(){null!=r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Mm.oCa)}static ECl(b,h,u,y){return new Mm(r.AFrameworkApplication.ya,
b,h,u,y,ub.FocusManager.instance(),Ra.App.xa.tq,Ja.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Object(v.a)(r.AFrameworkApplication.ta.FO,r.AFrameworkApplication.ta.FO.mb,"registerHandler"))}static DCl(b,h,u,y){return Mm.ECl(b,h,u,y)}}Mm.oCa=5E3;Object(m.a)(Mm,"FindReplaceActor",null,[]);var $n=c(221),Ul=c(895),Dw=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.yB},set:function(h){this.yB=h},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.rVa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,u){this.removeItem(h);u={key:h,Sba:this.rVa,next:void 0,data:u};this.first||(this.first=u);this.rVa&&(this.rVa.next=u);this.rVa=u;this._map.set(h,u)};b.prototype.insertAfter=function(h,u,y){h=this._map.get(h);if(!h)return!1;y={key:u,Sba:h,next:h.next,data:y};
var P=h.next;P&&(P.Sba=y);h.next=y;this._map.set(u,y);return!0};b.prototype.insertBefore=function(h,u,y){h=this._map.get(h);if(!h)return!1;y={key:u,Sba:h.Sba,next:h,data:y};var P=h.Sba;P&&(P.next=y);h.Sba=y;this._map.set(u,y);return!0};b.prototype.removeItem=function(h){var u=this._map.get(h);u&&(this.first===u&&(this.first=u.next),this.rVa===u&&(this.rVa=u.Sba),u.Sba&&(u.Sba.next=u.next),u.next&&(u.next.Sba=u.Sba),this._map.delete(h))};return b}();class Gs{constructor(){this.type="heading"}}Object(m.a)(Gs,
"NavPaneHeadingItem",null,[]);class cs{constructor(){this.type="bookmark"}}Object(m.a)(cs,"NavPaneBookmarkItem",null,[]);class Hu{constructor(b,h,u,y,P,aa,ta){var Pa,vb;this.eb=b;this.ib=h;this.Vb=u;this.ul=y;this.Ci=P;this.BB=aa;this.yOj=ta;this.nWa=0;this.Pkd=new Map;this.gNg=!1;this.bEf={[1]:1,[0]:1,[2]:1};this.Cya=new Map;this.mAg=null===(Pa=r.AFrameworkApplication.K)||void 0===Pa?void 0:Pa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.UVj=null===(vb=
r.AFrameworkApplication.K)||void 0===vb?void 0:vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.gNg}set headingsReady(b){this.gNg=b}get YJb(){return this.nWa}get l8(){this.FVb&&0!=this.FVb.length()||(this.FVb=this.Vjn());return this.FVb}set l8(b){this.FVb=b}get Jfc(){return this.W0j}set Jfc(b){this.Jfc&&(this.Jfc.isSelected=!1);b.isSelected=!0;this.W0j=b}Akf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}Vjn(){var b;
const h=new Dw;var u=null===(b=this.Ci.value)||void 0===b?void 0:b.mKi;if(!u)return h;this.Pkd=new Map;b=u.kHd();let y;const P=[];for(;b;){const aa=this.Ci.value.Db(b.id);u=this.O_h(aa,P);null===u||void 0===u?void 0:u.forEach(ta=>{(y=this.C1h(ta,P))&&"heading"===y.type&&y.indentLevel<ta.indentLevel&&(1>=y.indentLevel?(y.isCollapsed=!1,ta.isHidden=!1):(y.isCollapsed=!0,ta.isHidden=!0));h.insert(this.Akf(ta,aa),ta)});b=b.next}return h}C1h(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:
0<h.length?h[h.length-1]:void 0}Rcg(b){var h;let u=be.ParagraphReader.Cma(b),y=!1;9===u&&this.Cya.has(b.id.toString())&&(u=this.Cya.get(b.id.toString()),y=!0);const P=null===(h=this.l8.get(b.id.toString()))||void 0===h?void 0:h.data;if(P){if(P.indentLevel===u){h=ro.AParagraphNode.uU(b.characterData.trim());b=this.ul.value.D3d(b,!1);if(h!==P.text||P.hasBookmark!==b)return P.text=h,P.hasBookmark=b,!0;!y&&P.isPurelyADH&&(P.isPurelyADH=!1,--this.nWa);return!1}this.EYc();return!0}if(9===u)return this.akm(b)?
(this.EYc(),!0):!1;this.EYc();return!0}akm(b){var h;const u=this.ul.value.tgf(b,!1);b=null!==(h=this.Pkd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==u.length)return!0;for(h=0;h<b;++h)if(!this.l8.get(u[h].yNa()))return!0;return!1}I1k(b){if(this.l8.get(b.id.toString())||this.ul.value.D3d(b,!1))return this.EYc(),!0;this.Cya.has(b.id.toString())&&(this.Cya.delete(b.id.toString()),--this.nWa);return!1}EYc(){var b,h=null===(b=this.Ci.value)||void 0===b?void 0:b.mKi;const u=new Dw;this.nWa=0;if(h){this.Pkd=
new Map;var y=[];b=h.kHd();for(var P,aa;b;){const ta=this.Ci.value.Db(b.id);h=this.O_h(ta,y);null===h||void 0===h?void 0:h.forEach(Pa=>{var vb=this.Akf(Pa,ta);aa=this.C1h(Pa,y);this.gMn(vb,Pa,aa);u.insert(vb,Pa);"heading"===(null===P||void 0===P?void 0:P.type)&&(vb=P,vb.indentLevel>=Pa.indentLevel&&(vb.isCollapsed=void 0));P=Pa});b=b.next}}this.l8=u}gMn(b,h,u){var y,P;if(b=null===(y=this.FVb.get(b))||void 0===y?void 0:y.data)b.isSelected&&(h.isSelected=!0,this.Jfc=h),h.isHidden=b.isHidden;if(u){if(y=
null===(P=this.FVb.get(this.Akf(u,u.paragraphNode)))||void 0===P?void 0:P.data)u.isCollapsed=y.isCollapsed;u.isCollapsed?h.isHidden=!0:u.isHidden?(u.isCollapsed=!0,h.isHidden=!0):(u.isCollapsed=!1,h.isHidden=!1)}}O_h(b,h){var u=be.ParagraphReader.Cma(b),y=!this.Tvf(b);const P=this.Jpm(u)&&y?!0:!1;y=this.Cya.has(b.id.toString())&&y;const aa=[];if(P)aa.push(this.Kzh(b,u,!1,h));else if(y)this.nWa+=1,this.iIc&&(u=this.Cya.get(b.id.toString()),aa.push(this.Kzh(b,u,!0,h)));else{let ta=0;this.ul.value.tgf(b,
!1).forEach(Pa=>{const vb=new cs;vb.text=Pa.yNa();vb.isSelected=!1;vb.bookmarkManager=this.ul;vb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ta+=1;aa.push(vb)});this.Pkd.set(b.id.toString(),ta)}return aa}Kzh(b,h,u,y){var P,aa;const ta=new Gs;ta.text=ro.AParagraphNode.uU(b.characterData.trim());ta.indentLevel=h;ta.paragraphNode=b;ta.isSelected=!1;ta.isPurelyADH=u;this.UVj&&(ta.listMarker=this.Tkf(b));ta.hasBookmark=this.ul.value.D3d(b,!1);for(b=null===(P=y[y.length-1])||void 0===P?void 0:
P.indentLevel;b&&b>=h;)y.pop(),b=null===(aa=y[y.length-1])||void 0===aa?void 0:aa.indentLevel;(!b||b<h)&&y.push(ta);return ta}Tvf(b){return this.eb.ic(b)&&0===this.eb.textLength(b,this.bEf[$n.a.rj]|4)}vel(b){(b=this.l8.get(b))&&(1==b.data.isCollapsed?this.Tbj(b):this.r8l(b))}onClickHeading(b){var h;this.Jfc=b=null===(h=this.l8.get(b))||void 0===h?void 0:h.data;h=Kf.SelectionFactory.we(b.paragraphNode,0);this.ib.setSelection(h);this.Vb.Dg(xe.AFrame.So)}onClickBookmark(b){var h;this.Jfc=b=null===(h=
this.l8.get(b))||void 0===h?void 0:h.data;this.ul.value.rof(b.text);this.Vb.Dg(xe.AFrame.So)}onShareHeadingClick(b){var h;r.AFrameworkApplication.Ce("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");Ub.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.l8.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Lc.a.Pc),this.yOj.value.Lzh(h)}acg(b,h){const u=b.id.toString(),y=this.Cya.has(u);if(!y||this.Cya.get(u)!==h){this.Cya.set(u,h);if(this.iIc)return this.Rcg(b);!this.mAg||
y||this.l8.get(u)||(this.nWa+=1)}return!1}c1k(b){const h=b.id.toString(),u=this.Cya.has(h);if(u){this.Cya.delete(h);if(this.iIc)return this.Rcg(b);this.mAg&&u&&!this.l8.get(h)&&--this.nWa}return!1}gno(b){this.iIc=b;this.EYc()}ycg(b){var h;const u=null===(h=this.l8.get(b.id.toString()))||void 0===h?void 0:h.data;if(!u)return!1;b=this.Tkf(b);if(u.listMarker===b)return!1;this.dvo();return!0}y7e(b){var h;b=null===(h=this.l8.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;
b.listMarker=void 0;return!0}Tbj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let u;for(;b&&b.data.indentLevel>h;)u=b,b=u.next,u.data.isHidden=!1,"heading"==u.data.type&&(b=u.data.isCollapsed?this.Ybo(u):this.Tbj(u));return b}r8l(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let u;for(;b&&b.data.indentLevel>h;)u=b,b=u.next,u.data.isHidden=!0}Ybo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}Jpm(b){return 0<=b&&8>=
b}dvo(){let b=this.l8.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.Tkf(h.paragraphNode)}b=b.next}}Tkf(b){var h;if(b.IS instanceof Ul.a)return this.pZl(null===(h=this.BB.Fjb(b.IS))||void 0===h?void 0:h.P7)}pZl(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(m.a)(Hu,"NavPaneHeadingsManager",null,[]);var Iz=c(1536);class lu{constructor(){this.wvb=this.rA=this.Zpc=this.aed=this.W=null}get name(){return"WordEditor.FindReplace"}xc(b){this.W=
b;const h=new Hu(Ja.a.instance.resolve("Box4.IParagraphReader"),Ja.a.instance.resolve("Box4.ISelectionManager"),ub.FocusManager.instance(),Ja.a.instance.af("WordEditor.Bookmark.IBookmarkManager"),new Zf.a(()=>Ra.App.xa.jb.Yc.Bd),b.resolve("Box4.IListMarkerUtility"),b.af("WordEditor.Actors.HeadingsActor"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){lu.$b.hp.continueWith(()=>{this.$m()})}$m(){if(Ra.App.nfg){const b=
Ra.App.$ie;this.Zpc=gi.FindReplaceUIManager.getInstance(b);this.rA=Ve.FindManager.createInstance(this.Zpc,Zd.a.instance,Iz.a.instance,!0);this.wvb=this.rA.UKb;this.aed=Mm.DCl(this.Zpc,this.rA,this.wvb,b);this.aed.Wb();this.aed.c4();this.aed.gWf();Ra.App.xa.updateCommandUI()}}dispose(){this.Zpc&&this.Zpc.dispose()}static get $b(){return null!=lu.nog?lu.nog:lu.nog=Ja.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(lu,"FindReplacePackageManager",null,[1,2]);class Lt{constructor(){}fff(){return"_@_"+
Ua.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}Qxo(b,h,u,y){h.kVn(b,y);h.Pl(b,Ge.a.Y8,!0);h.Pl(b,Lc.a.pPa,!0);h.Pl(b,Lc.a.fieldInstruction,Lt.QMh(u));h.Pl(b,Lc.a.Qq,15)}shk(b,h,u,y){const P=b.sBd(y);h.Pl(P,Ge.a.Y8,!0);h.Pl(P,Lc.a.Qq,47);h.Pl(P,Lc.a.fieldInstruction,Lt.QMh(u));b=b.sBd(y);h.Pl(b,Ge.a.Y8,!0);h.Pl(b,Lc.a.Qq,16);return[P.Hj,b.Hj]}Rpl(b,h,u){b=b.sBd(u);h.Pl(b,Ge.a.Y8,!0);h.Pl(b,Lc.a.cGb,!0);return b.Hj}static QMh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(m.a)(Lt,
"AtMentionHyperlinkConfigurator",null,[441]);class Ew{constructor(b,h,u){this.TUb=b;this.ib=h;this.O9h=this.Egi=this.bze=!1;this.MLf=this.MLf.bind(this);this.bMf=this.bMf.bind(this);this.bNf=this.bNf.bind(this);u&&u.execute(y=>{this.WTa=y});Fk.a.uwd.Phf.then(y=>{this.O9h=!0;this.Egi=y.isSuccess})}CTi(){this.TUb.xTi(this.MLf);this.TUb.yTi(this.bMf);this.TUb.KTi(this.bNf)}txf(){return!1}MLf(b,h,u){var y,P;h=Date.now();if(this.WTa)if(this.O9h&&!this.Egi)w.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");
else{var aa=null===(P=null===(y=this.ib.hb)||void 0===y?void 0:y.kb)||void 0===P?void 0:P.Tc;aa?(y=aa.node,be.ParagraphReader.ic(y)?(P=be.ParagraphReader.text(y),0>u||u>P.length?w.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):1<b.length&&"@"===b.trimEnd()?(Ub.c(Rc.a.hOk,!0,void 0,void 0,void 0,void 0),this.TUb.reset()):(this.bze?this.WTa.syo():(this.bze=!0,this.WTa.cbo(aa)),this.WTa.icg(u,u+b.length),
b=P.substring(0,u)+b,this.WTa.sff(y,b,u,h))):w.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):w.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else w.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}bMf(b){if(this.WTa)this.WTa.onKeyDown(b)}bNf(){this.bze=!1;this.WTa&&this.WTa.Bth()}}
Object(m.a)(Ew,"ContextIQUserInitHandler",null,[400]);var Fw=c(1710);class Jr{constructor(){this.xz=null}get name(){return"WordEditor.AtMentions"}xc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new Lt(b.resolve("Box4.IFeatureHelper"))).singleInstance();const h={crewAlias:Jr.yvj,featureName:Jr.Wwj,topLevelKpiName:Jr.EAj,vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Oi.a(Ta.Health.instance,new bj.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>
{this.$m()})}dispose(){}$m(){this.W.Za("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{r.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&r.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));h&&this.vEm()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}vEm(){(r.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").pA.loadScript("canvasAtMentions")).then(()=>
{r.AFrameworkApplication.K.lp(()=>{this.nyn()})})}nyn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:r.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.Dxm()};this.xz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(u=>{u&&Fw.a.c9c()?this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",
()=>new Ew(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Za("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance():this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new U(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.xz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),ab.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").CTi()})})}Dxm(){var b,h;const u=null!==(b=r.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=r.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";
return u===Jr.mvj&&b===Jr.lvj}}Jr.mvj="-4";Jr.lvj="DC2";Jr.yvj="webasynccollabeng";Jr.Wwj="AtMentions";Jr.EAj="AtMentionsFeatureUsage";Object(m.a)(Jr,"PackageManager",null,[1,2]);var Wp=c(1634),yn=c(1364);class PB{constructor(b,h,u,y){this.ga=b;this.wf=h;this._augLoopRuntimeManager=u;this.C7j=y;this.ksa=0;this.Itd=this.bXb=!1;this.dDg=this.F2g=this.ADe=this.G2g=0;this.Cqb=null;this.oKj=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",
!0],["ChangePicture",!0]]);this.ZIj=[{id:`${Nu.zdc}_${1}`},{id:`${Nu.zdc}_${2}`},{id:`${Nu.zdc}_${3}`},{id:yn.a.ECd},{id:yn.a.cBd},{id:yn.a.X3d},{id:yn.a.U3d}];this.vDj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.Rad=new Map;this.tQj=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",
!1);this.FUj=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.yGj=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.wf.mb(this,Wp.SearchSuggestionAnnotation.getTypeName());(r.AFrameworkApplication.K.$("IsO365CommercialHost")||r.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.Rad.set("InsertLink","InsertLinkFlyout");this.Rad.set("GraphicsEditor","");this.pnj();this.Wb(this.ga)}fmn(b,
h){const u=Date.now();this.ADe&&1250>u-this.ADe||this.wub||(this.ADe=u,this.Cqb=b,this.Bqd=this.AUl(h),this.VKn(),this.mJn())}mD(b,h){if(b.annotationType===Wp.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===Nt.a.getTypeName()&&(h=Date.now(),b=b.content,this.wub&&this.wub===b.correlationId)){window.clearTimeout(this.ksa);this.wub=void 0;var u=this.bXb,y=this.GJl(b),P=y&&0<y.length;P&&(this.czo(y),this.Itd&&(u=!1));u&&this.tXi();h={["description"]:"[Zero term context menu] augloop response latency",
["correlationId"]:b.correlationId,["requestPreparationTime"]:this.F2g,["canvasContextRetrievalTime"]:this.dDg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.G2g,["containsZTM"]:P,["shouldFallBack"]:this.bXb,["fallBack"]:u};w.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}GJl(b){const h=this.Umf(b.intentSuggestions,Wp.IntentIds.ZeroTermMenu,Wp.ObjectSemantic.GenericSuggestions,Wp.ObjectSchemaType.RankedSuggestion);return 1===
h.length?h[0]:b.menuSuggestions}Umf(b,h,u,y){return Array.isArray(b)?b.filter(P=>P.intent===h&&P.result.semantic===u&&P.result.type===y).map(P=>P.result.value):[]}Wb(b){b.gb(Wa.a.eti,oc.a.application,this.nJn.bind(this),96)}AUl(b){const h=[],u=new Map,y=Date.now();for(const P of b){if(!P)continue;b=[];const aa={itemsMetadata:new Tb.a};for(let ta=0;ta<P.ControlList.length;ta++){const Pa=P.ControlList[ta];if(Pa&&!Pa.ExternalId)continue;b.push(Pa.ExternalId);const vb={timeStamp:y,source:"FallbackZeroTermMenu",
confidenceScore:-1};aa.itemsMetadata[Pa.ExternalId]=vb;u.set(Pa.ExternalId,vb)}h.push(appChrome.api.menuSection(b,P.Title,P.Lang,P.Id,aa))}return{sections:h,commands:u}}Sjj(b){return this.Rad.has(b)?this.Rad.get(b):b}uHa(b){const h={};for(const u of b)b=this.Sjj(u.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Ra.App.xa.aId(h)}Elm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.oKj.has(b)?this.Bqd.commands.has(b):
!0}KBh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.Cqb})}Kfb(b=!1){b=b?no.a.instance.Wpc:no.a.instance.Kfb();const h=[],u=Date.now();for(const y of b)y.commandId&&h.push({Id:y.commandId,TimeElapsedSinceClick:(u-y.timeStamp)/1E3,ContentType:y.contentType,CommandSurface:y.commandSurface,InputMethod:y.ox});return h}mKc(){const b=no.a.instance.mKc(),h=[],u=Date.now();for(const y of b)y.controlId&&h.push({Id:y.controlId,TimeElapsedSinceClick:(u-
y.timeStamp)/1E3,ContentType:y.contentType,CommandSurface:y.commandSurface,InputMethod:y.ox});return h}Jgf(){const b={semantic:Wp.ObjectSemantic.CanvasContext,type:Wp.ObjectSchemaType.WordCanvasContext,value:{contentType:this.Cqb}};if(this.yGj){const h=Date.now(),u=this.C7j.Jgf(Hh.a.instance.hb.kb);u&&u.value.contentType&&(b.value=u.value);this.dDg=Date.now()-h}return b}aVh(){const b=this.mKc(),h=this.Kfb(),u=this.Kfb(!0),y=[];y.push({semantic:Wp.ObjectSemantic.ControlIdHistory,type:Wp.ObjectSchemaType.CommandExecutionSequence,
value:{SequenceType:Wp.SequenceType.ControlId,Sequence:b}});y.push({semantic:Wp.ObjectSemantic.CommandIdHistory,type:Wp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Wp.SequenceType.CommandId,Sequence:h}});y.push({semantic:Wp.ObjectSemantic.FilteredCommandIdHistory,type:Wp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Wp.SequenceType.CommandId,Sequence:u}});y.push(this.Jgf());return y}pnj(){this._augLoopRuntimeManager.getSession().then(b=>this.N$c=b).catch(()=>{this.N$c=
void 0})}mJn(){const b=Date.now(),h=this.aVh(),u=[Wp.IntentIds.ZeroTermMenu,Wp.IntentIds.Logging];this.F2g=Date.now()-b;this.Efj(u,h,"ContextualMenu")}nJn(b,h,u){2===u&&(b=this.aVh(),this.Efj([Wp.IntentIds.Logging],b,"Floatie"));return 32}Efj(b,h,u){if(0===b.length||0===h.length)w.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var y=new Wp.SearchSuggestionSignal({correlationId:this.zyl(),intents:b,contextObjects:h,entryPoint:u});this.bXb=0<=b.indexOf(Wp.IntentIds.ZeroTermMenu);
this.G2g=Date.now();this.wub=y.correlationId;this.ksa=window.setTimeout(()=>{this.k8m(y.correlationId)},750);h=new Nt.l({parentPath:["Signal",Wp.SearchSuggestionSignal.getTypeName()],items:[{id:Ua.a.create().toString(),body:y}]});this.N$c&&!this.N$c.isClosed?this.N$c.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.pnj());w.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:y.correlationId,
["shouldFallBack"]:this.bXb,["intents"]:b}))}}zyl(){const b=Ua.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",b);return b}k8m(b){this.wub&&this.wub===b&&(this.wub=void 0,this.bXb&&this.tXi(),w.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.bXb})))}tXi(){const b=this.KBh(this.Bqd.sections);appChrome.api.dispatch(b);this.pvh()}pvh(){this.Itd=!0}lDn(b){var h,u;const y=[],
P=new Map;if(!b||0===b.length)return y;for(const aa of b){if(!aa||!aa.controlIds||0===aa.controlIds.length)continue;b={controlIds:[],id:aa.id,title:aa.title,lang:aa.lang,data:{itemsMetadata:new Tb.a}};const ta="CommandsZTM"===aa.id;for(const Pa of aa.controlIds){if(P.has(Pa))continue;if(ta&&b.controlIds.length>=this.FUj)break;const vb=null===(u=null===(h=aa.data)||void 0===h?void 0:h.itemsMetadata)||void 0===u?void 0:u[Pa];P.set(Pa,vb);b.controlIds.push(Pa);vb&&(b.data.itemsMetadata[Pa]=vb)}0<b.controlIds.length&&
y.push(b)}return y}VKn(){this.Itd=!1;if(this.tQj){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}czo(b){this.Itd||(b=this.Mql(b),0<b.length&&appChrome.api.dispatch(b))}Mql(b){const h=[];let u=[];var y=this.GOl();y&&0<y.length&&u.push(...y);(y=this.Ipl())&&u.push(y);Array.isArray(b)&&0<b.length&&(b=this.Ata(b))&&(b.id="CommandsZTM",u.push(b));(b=this.zpl())&&u.push(b);u=
this.lDn(u);if(0===u.length)return[];h.push(this.KBh(u));this.pvh();return h}GOl(){var b,h;const u=null===(b=this.Bqd)||void 0===b?void 0:b.sections.filter(y=>{var P;return null===(P=y.id)||void 0===P?void 0:P.startsWith(Nu.kIh)});for(const y of u)if(null===(h=y.data)||void 0===h?0:h.itemsMetadata)for(const P in y.data.itemsMetadata)y.data.itemsMetadata[P].source="PassThroughZeroTermMenu";return u}Ipl(){const b=this.iRh(this.ZIj,"DefaultZeroTermMenu");return this.Ata(b)}zpl(){const b=this.iRh(this.vDj,
"AdvertizedZeroTermMenu");return this.Ata(b)}iRh(b,h){const u=[];for(const y of b)y&&this.I7n(y)&&this.Bqd.commands.has(y.id)&&u.push({suggestion:y.id,rankingScore:-1,suggestionSource:h});return u}I7n(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Ata(b){const h=[],u={itemsMetadata:new Tb.a},y=Date.now();this.uHa(b);for(const P of b)b=this.Sjj(P.suggestion),this.Elm(b)&&(h.push(b),u.itemsMetadata[b]={timeStamp:y,source:P.suggestionSource,
confidenceScore:P.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,u):null}}Object(m.a)(PB,"AugLoopSearchSuggestionManager",null,[220,361]);class oB{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}xc(b){this.W=b;this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new PB(r.AFrameworkApplication.ya,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>
{Fk.a.nm().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){K.a.instance.Kc(new oB)}}Object(m.a)(oB,"PackageManager",null,[1,2]);var pB=c(331),gp=c(940);class Mx extends gp.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(m.a)(Mx,"BootMessage",gp.a,[]);var vC=c(1026);class VC{constructor(){this.aK=null;this.b6m=b=>{if(b.target===this.aK)if(void 0===b.data||null===b.data)w.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=z.a(b.data);this.dee(h.api)?this.y$c.J(h.api).Kac(h.method,h):w.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){w.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.y$c=new La.a}rzf(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let u=!1;try{this.aK=new Worker(b);this.aK.onmessage=this.b6m;const y=Object.assign(new Mx,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(y);this.rzf()&&vC.a.gCj(this.aK);u=!0}catch(y){w.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",y)}return u}postMessage(b){try{const h=z.c(b);this.aK.postMessage(h)}catch(h){w.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}dee(b){return this.y$c.ub(b)}e9j(b,
h){this.dee(b)&&w.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.y$c.Z(b,h)}Vsl(b){return this.dee(b)?this.y$c.J(b):null}}Object(m.a)(VC,"WebWorker",null,[71]);class wz{constructor(){this.Jfg=[]}qYk(b,h){if(h){var u=r.AFrameworkApplication.Nw(b.H1i,7),y=[];for(let P=0;P<b.qNb.length;P++){let aa;switch(b.qNb[P].format){case 5:case 6:aa=pB.a.Mgb(b.qNb[P].name);break;default:aa=b.qNb[P].name}y.push(r.AFrameworkApplication.Nw(aa,
b.qNb[P].format))}try{const P=URL.createObjectURL(new Blob(["importScripts('"+u+"');"],{type:"application/javascript"})),aa=new VC;if(aa.create(P,y))for(this.Jfg.push(aa),u=0;u<b.cee.length;u++){const ta=h.iRk(aa,b.cee[u]);ta&&aa.e9j(b.cee[u],ta)}}catch(P){w.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",P.message)}}else w.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(m.a)(wz,"WebWorkerCollection",null,
[]);class xz{constructor(b,h){this.kRe=new wz;if(b){b=b.create();for(let u=0;u<b.length;u++)this.kRe.qYk(b[u],h)}else w.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...u){let y=!1;for(let aa=0;aa<this.kRe.Jfg.length;aa++){var P=this.kRe.Jfg[aa];P.dee(b)&&((P=P.Vsl(b))?y=P.wP(h,u)||y:w.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}y||w.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(m.a)(xz,"WebWorkerRouter",null,[19]);class Go{constructor(){this.D=this.ST=0}}Object(m.a)(Go,"LongTaskInfo",null,[]);class PD{constructor(b,h){this.cRe=null;this.XOm=u=>{if(u){var y=[];for(const P of u.getEntries())P.duration>=this.vHo&&(u=new Go,u.ST=P.startTime,u.D=Math.round(P.duration),y.push(u));if(0<y.length){let P;(P=this.qP).sendMessage.apply(P,[1,3].concat(y))}}};
b.b4(this.XOm);this.qP=h}get vHo(){null==this.cRe&&(this.cRe=r.AFrameworkApplication.K?r.AFrameworkApplication.K.pc("WordHangDetectionHangThresholdTime",2E3):2E3);return this.cRe}}Object(m.a)(PD,"HangDetector",null,[]);class QD{constructor(){this.i0g=null;this.Ohm=b=>{for(const h of this.eN)h(b)};this.eN=[];this.gVb=0}b4(b){this.gVb||this.q_m();1===this.gVb&&this.eN.push(b)}WOm(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==
Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}q_m(){if(!this.gVb)if(this.WOm())try{this.i0g=new PerformanceObserver(this.Ohm),this.i0g.observe({type:"longtask"}),this.gVb=1}catch(b){this.gVb=2,w.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",b.message)}else this.gVb=2}}Object(m.a)(QD,"LongTaskListeners",null,[490]);class WC extends gp.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=
this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(m.a)(WC,"SettingsMessage",gp.a,[]);class vw{constructor(b){this.aK=b}}Object(m.a)(vw,"WebWorkerApiMain",null,[]);class RD extends vw{constructor(b){super(b)}rzf(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}wP(b,h){if(!h)return w.ULS.sendTraceTag(591972375,
3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.xzk(h);w.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}Kac(b,h){switch(b){case 14:this.g3l(h);break;default:w.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}xzk(b){if(2!==b.length)return w.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",
b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return w.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new WC,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:r.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Bl.a.instance.zQ,LocalCobaltMachineId:Bl.a.instance.eHb,
LocalCobaltClusterId:Bl.a.instance.bac,LocalCobaltSessionHasBackup:Bl.a.instance.Uva,WaciiEnabledRequests:Bl.a.instance.$pa,SettingsRoutedToServer:Bl.a.instance.U3f,WacClusterId:r.AFrameworkApplication.Ve.M4});this.aK.postMessage(b);return!0}g3l(b){this.rzf()&&b&&b.result&&(w.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.gDo())}gDo(){Object(zs.__awaiter)(this,void 0,void 0,function*(){try{const b=yield new vC.a.hCj.WorkerUtilsTestClass(10);yield b.Ih(5);15==(yield b.counter)?
w.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):w.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){w.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}})}}Object(m.a)(RD,"InitializeWorkerApiMain",vw,[]);class SD extends gp.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(m.a)(SD,"CatchUpNetworkRequestWorkerRequestMessage",
gp.a,[]);class sv extends vw{constructor(b,h){super(b);this.SCc=h}wP(b,h){if(4===b)return b=Object.assign(new SD,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.aK.postMessage(b),!0;w.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}Kac(b,h){switch(b){case 5:w.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.SCc.GVn(h);
break;default:w.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(m.a)(sv,"CatchUpNetworkRequestWorkerExternalApi",vw,[]);class Ss extends gp.a{constructor(){super();this.taskInfo=null}}Object(m.a)(Ss,"HangDetectionMessage",gp.a,[]);class Yu extends gp.a{constructor(){super();this.taskInfo=null}}Object(m.a)(Yu,"ReportLongTasksMessage",gp.a,[]);class qB extends vw{constructor(b){super(b)}wP(b,h){if(!h)return w.ULS.sendTraceTag(591972370,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(b){case 2:return this.wzk(h);case 3:return this.VIn(h);default:return w.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}Kac(b){w.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}wzk(b){if(1!==b.length||"object"!==typeof b[0])return w.ULS.sendTraceTag(591972373,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=Object.assign(new Ss,{api:1,method:2,taskInfo:b[0]});this.aK.postMessage(b);return!0}VIn(b){if(!b.length||!Object(jb.a)(Go,b[0]))return w.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",b.length,0<b.length?Object(jb.a)(Go,
b[0]):!1),!1;b=Object.assign(new Yu,{api:1,method:3,taskInfo:b});this.aK.postMessage(b);return!0}}Object(m.a)(qB,"HangDetectionWorkerApiMain",vw,[]);class Jt extends gp.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(m.a)(Jt,"LocalInferenceMessage",gp.a,[]);class Gp{constructor(){this.prediction=this.context=null}}Object(m.a)(Gp,"LocalInferenceOutput",null,[]);class XC{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=
null}}Object(m.a)(XC,"TextPredictionConfig",null,[]);class YC{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(m.a)(YC,"TextPredictionSettings",null,[]);class NE{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(m.a)(NE,"TextPredictionDynamicPayload",null,[]);class TD extends vw{constructor(b,h){super(b);this.J7j=h}wP(b,h){if(!h)return w.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),
!1;switch(b){case 8:return this.Dzk(h);case 7:return this.yzk(h);case 9:return this.Czk(h);case 10:return this.zzk(h);case 13:return this.Azk(h);case 14:return this.Bzk(h);default:return w.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}Kac(b,h){switch(b){case 9:this.l4l(h);break;default:w.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}l4l(b){b&&b.prediction&&
(b=Object.assign(new Gp,{prediction:b.prediction,context:b.context}),this.J7j.wkh().pmn(b))}yzk(b){if(1>b.length)return w.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Jt,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.aK.postMessage(b);return!0}Dzk(b){if(1>b.length)return w.ULS.sendTraceTag(575959824,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Jt,{api:4,method:8,paragraphContent:b});this.aK.postMessage(b);return!0}Czk(b){if(2>b.length)return w.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===
typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Jt,{api:4,method:9,paragraphContent:b,context:h});this.aK.postMessage(h);return!0}zzk(b){if(1>b.length)return w.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Jt,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.aK.postMessage(b);return!0}Azk(b){if(1>b.length)return w.ULS.sendTraceTag(556827920,
3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Jt,{api:4,method:13,textPredictionConfig:this.jWh(b)});this.aK.postMessage(b);return!0}Bzk(b){if(1>b.length)return w.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(jb.a)(Object,
b[0])),!1;b=b[0];b=Object.assign(new Jt,{api:4,method:14,textPredictionConfig:this.jWh(b)});this.aK.postMessage(b);return!0}getConfig(b=null){return Object.assign(new XC,{scriptDirectory:r.AFrameworkApplication.u4+"/intelligence/",settings:Object.assign(new YC,{extendedRankLimit:0}),modelFilesUrl:b})}jWh(b=null){return Object.assign(new XC,{scriptDirectory:r.AFrameworkApplication.u4+"/intelligence/",settings:Object.assign(new YC,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}
Object(m.a)(TD,"LocalInferenceWorkerApiMain",vw,[]);class UD extends vw{constructor(b){super(b);r.AFrameworkApplication.rJ(()=>{this.sWc()})}wP(b){w.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}Kac(b){w.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}sWc(){const b=Object.assign(new gp.a,{api:3,method:6});this.aK.postMessage(b)}}Object(m.a)(UD,
"ShutdownWorkerApiMain",vw,[]);var OE=c(865),VD=c(607);class rB extends gp.a{constructor(){super();this.args=null;this.numLogs=0}}Object(m.a)(rB,"UlsWorkerMessage",gp.a,[]);var ft=c(857),WD=c(986),XD=c(1044);class YD extends WD.a{constructor(b,h,u,y,P){super(b,h,u,y,P);this.EDe=null;this.uLe=!1;if(this.CSg=this.Xyf())if(b=y.lb("ContentBaseUrl")?6:5,y=y.lb("AppScriptBaseName"))y=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",y+".{0}ulsworker.js"),
y=pB.a.Mgb(y),y=r.AFrameworkApplication.Nw(y,b),ft.createWorker({createMode:"Thread"},{local:ft.paramInsideDef(XD.ulsWorkerInsideInit),Vlo:ft.paramInsideDef(Object(XD.ulsWorkerInsideScript)(y))}).then(aa=>{aa.onClose=()=>{this.CPe=void 0};this.CPe=aa},aa=>{var ta=new Date;aa=`UlsWorkerDefererHost threw an error: ${this.rUm(aa)}`;console.error(aa);ta=new VD.a(ta.getTime(),3007,545653664,10,aa,0,!1,null,null);super.$W(ta);this.uLe=!0})}Xyf(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}get AUm(){this.EDe||(this.EDe=Ja.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));return this.EDe}gNa(b){this.uLe=b}$W(b){if(this.uLe)super.$W(b);else if(this.CSg)null!=this.CPe&&this.CPe.call.$W(b);else{let h;(h=this.AUm).sendMessage.apply(h,[5,11].concat([b]))}}rUm(b){if(null==b||"object"!==typeof b)return"unknown";const h=String(b.name),u=String(b.message);return null!=b.stack?(b=String(b.stack),0<=b.indexOf(u)&&0<=b.indexOf(h)?b:`${h}: ${u}\n${b}`):0<=u.indexOf(h)?u:`${h}: ${u}`}}Object(m.a)(YD,
"UlsWorkerDefererHost",WD.a,[]);class wC extends vw{constructor(b){super(b);this.TXg=0;b=Ja.a.instance.Pa("Common.IRefreshableAppSettings");this.hYb=new YD(OE.a.SCd,!0,r.AFrameworkApplication.Ve,null!==b&&void 0!==b?b:r.AFrameworkApplication.K,b);b=w.ULS.host;null!=b&&b.q6b(this.hYb);w.ULS.Zmb(this.hYb);this.lTg=Je.a.Ye();this.B3j=2*r.AFrameworkApplication.K.pc("UlsWorkerStayAliveIntervalMS",6E4);this.hYb.gNa(!0)}wP(b,h){if(11!==b||!h||1!==h.length||!Object(jb.a)(VD.a,h[0]))return!1;if(Je.a.Ye()-
this.lTg>this.B3j)return this.hYb.gNa(!0),this.hYb.$W(h[0]),w.ULS.sendTraceTag(570770058,3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;b=Object.assign(new rB,{api:5,method:b,args:h[0],numLogs:this.TXg});this.TXg++;this.aK.postMessage(b);return!0}Kac(b,h){void 0!==h&&null!==h&&12===b&&(this.lTg=Je.a.Ye(),this.hYb.gNa(!1))}}Object(m.a)(wC,"UlsWorkerApiMain",vw,[]);class ZC{constructor(b){this.container=b}iRk(b,h){var u=null;switch(h){case 0:u=new RD(b);break;case 1:u=new qB(b);
break;case 2:u=new sv(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:u=new UD(b);break;case 4:u=new TD(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:h=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);u=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);u=(h||u)&&r.AFrameworkApplication.ixd?new wC(b):
null;break;default:w.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return u}}Object(m.a)(ZC,"WordWebWorkerApiFactory",null,[488]);var ZD=c(259);class jC{constructor(b,h){this.name=b;this.format=h}}Object(m.a)(jC,"ImportedScript",null,[]);class $D{constructor(){this.cee=this.qNb=this.H1i=null}}Object(m.a)($D,"WebWorkerConfig",null,[]);var AA=c(1415);class yz{constructor(b){this.qNe=[];this.ARj=b;if(r.AFrameworkApplication.K){b=
r.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||r.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const h=r.AFrameworkApplication.K.lb("ContentBaseUrl")?6:5,u=r.AFrameworkApplication.K.lb("AppScriptBaseName"),y=b?"":".";if(u){const P=b?"":"{0}",aa=u+`${y}${P}worker.js`;this.qNe.push(new jC(`MicrosoftAjax${b?"":"DS"}.${P}js`,h),new jC(aa,h));this.Xyf()&&this.qNe.push(new jC(u+`${y}${P}ulsworker.js`,h))}else w.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else w.ULS.sendTraceTag(558465107,
3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=[],h=Object.assign(new $D,{H1i:"workerboot",qNb:this.qNe,cee:[0,1,2,3,4,5]});this.ARj&&this.Enm()&&h.qNb.push(new jC("intelligence/edge-inference-web.js",5));b.push(h);return b}Enm(){return(new ZD.a("arrowFunction",()=>{try{Object(AA.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}Xyf(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}}Object(m.a)(yz,"WordWebWorkerConfigFactory",null,[357]);class Nx{constructor(){this.Ma=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");b.sendMessage.apply(b,[0,1].concat([this.Ma.appSettings,r.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}xc(b){this.W=b;this.Ma=this.W.resolve("Common.IAppSettingsManager");const h=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",
()=>new xz(new yz(h),new ZC(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance();b.ha("WordEditor.Workers.LongTaskListeners",()=>new QD).as("WordEditor.Workers.ILongTaskListeners").singleInstance();b.ha("WordEditor.Workers.HangDetector",()=>new PD(b.resolve("WordEditor.Workers.ILongTaskListeners"),b.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){K.a.instance.Kc(new Nx)}}Object(m.a)(Nx,"WordEditorWorkersPackage",null,[1,2]);var QB=c(1155);class Sj{constructor(){this.tod=
[]}n3h(b,h){let u=-1,y=null;y=P=>{P?h(this.tod[u]):(++u,u<this.tod.length?this.tod[u].T_b(b,y):h(null))};y(!1)}T_b(b,h){this.n3h(b,u=>{h(!!u)})}Rec(b,h,u){this.n3h(b,y=>{if(!y)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");y.Rec(b,h,u)})}Gdh(b){this.tod.push(b)}}Object(m.a)(Sj,"CompositeExternalContentURLResolver",null,[492,493]);var aE=c(1409);class kC extends aE.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.IFrameHtml=null}}Object(m.a)(kC,"ExternalContentEmbedResponse",aE.a,[]);var bE=c(1424),cE=c(1787),dE=c(1786),eE=c(1335),fE=c(718),sB=c(698),BA=c(190),RB=c(859),Ox;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.ZSo=3]="externalContentFloatieConversion"})(Ox||(Ox={}));Object(m.b)("ExternalContentConversionContext",Ox);class ch{constructor(){this.IGb=this.HGb=null;this.Vbf=new eE.ExternalContentEmbedRetriever;
this.Sxc=!0;this.Jpc=this.ao=this.sbi=this.rbi=this.jm=this.xp=null;this.picturePasteRequestSucceeded=()=>{w.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.bdc=()=>{w.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=ch.$la&&ch.$la.cVh()}get yMb(){return this.Sxc}set yMb(b){this.Sxc=b}JZe(b,h){let u=!1;if(b){switch(b.contextId){case oc.a.Vc:u=!h;break;case oc.a.Fd:u=!0}u&&!RB.a(b.node)&&(u=!1)}return u}Uym(b){const h=
b.startsWith(yi.HyperlinkReader.Bdc),u=b.startsWith(yi.HyperlinkReader.hZc),y=b.startsWith(yi.HyperlinkReader.z5d);return(h||u||y)&&yi.HyperlinkReader.uPa(b)}jRi(){this.ao=T.a.create();ch.xf.Hzb(this.ao,4);ch.xf.Z3(this.ao,0,ch.xf.qn());this.GEb(this.HGb,3,this.IGb,!0)}EOa(b,h,u){this.ao=T.a.create();ch.xf.Hzb(this.ao,u?0:2);ch.xf.Z3(this.ao,0,ch.xf.qn());this.Jpc();this.GEb(b,u?0:2,h)}W3d(b,h){this.ao=T.a.create();ch.xf.Hzb(this.ao,1);ch.xf.Z3(this.ao,0,ch.xf.qn());this.GEb(b,1,h)}QQd(b,h,u){if(!b||
!b.isConnected||!Jd.ImageReader.Wu(b))return null;const y=new fE.a;y.setValue(vi.a.Z6b,u);y.setValue(vi.a.P0a,h);y.VYa=this.rbi;y.Cw=this.sbi;y.l2a=1===u;yd.GraphIterator.$a(b).Qf(y,2);this.HUc(y);return y}ZSi(b){this.Jpc=b}Oke(b,h){const u=ch.Y_.l2b(h)||0;h=ch.Y_.CZa(h)||0;const y=b.Width/b.Height;1<=y?(b.Width=u,b.Height=u/y):(b.Height=h,b.Width=h/y)}Dhg(b,h,u){if(null!=b&&null!=h&&!A.a.kf(u)){var y=ch.dWc.v5b(u);y.zGa=!0;y.hideFloatie=!0;this.Oke(b,h.node);this.y7b(b,h,!1,!1,y,u)}}Lgb(b){return b?
b.jf:0}heg(b,h,u){let y=null;const P=b.node;if(!be.ParagraphReader.ic(P)||!P.isConnected)return{returnValue:!1,Vpa:y};if(u)return{returnValue:!0,Vpa:b};u=b.cpBegin;const aa=b.cpEnd,ta=be.ParagraphReader.text(P);if(0<=u&&aa<=ta.length&&ta.substring(u,aa)===h)return{returnValue:!0,Vpa:b};const Pa=ta.indexOf(h);return 0<=Pa?(y=nf.a.createTextRange(P,Pa,Pa+h.length),{returnValue:!0,Vpa:y}):0<=u&&aa<=ta.length&&this.B6b(b)?{returnValue:!0,Vpa:b}:{returnValue:!1,Vpa:y}}B6b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;
var h=nf.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=yi.HyperlinkReader.iD(h,!1);if(1===h.length){h=h[0];const u=be.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==u)return!0}return!1}gzf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}s6a(b,h){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const u=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");u&&
u.execute(y=>{y.logActivity(b,h)})},ch.oCa)}zif(b,h){const u=!A.a.t2(h);switch(b){case 1:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}GEb(b,
h,u,y=!1){if(this.Uym(u)){var P=ch.dWc.v5b(u);if(P)if(this.gzf(P)){w.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(na.a)(nf.a,b);var aa=!h;this.JZe(b,aa)?this.EQc(u)?(h=1===h,y=this.pDl(b),P.hideFloatie=!0,this.y7b(y,b,aa,h,P,u)):this.ARf(b,h,P,u,y):ch.xf.UP(this.ao,2,"URL inserted in Non-Embedable context",ch.xf.qn())}else w.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),ch.xf.UP(this.ao,2,"Size provided is not valid for OEmbed",
ch.xf.qn())}else w.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),ch.xf.UP(this.ao,2,"URL inserted is not valid for ExternalContent",ch.xf.qn())}pDl(b){const h=new kC;h.Width=ch.Y_.l2b(b.node)||0;h.Height=ch.Y_.CZa(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}EQc(b){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=ch.Ega&&ch.Ega.foi(b)}ARf(b,h,u,y,
P){const aa=!h,ta=1===h,Pa=ch.Y_.l2b(b.node)||0,vb=ch.Y_.CZa(b.node)||0,Kb=bE.a.n2e(u.Adg,!0,Pa,vb);this.nUc(b,y,h,!0);this.Vbf.grh(Kb,Sb=>{ch.xf.Z3(this.ao,4,ch.xf.qn());ch.xf.B2c(this.ao,this.Lgb(Sb.data));if(Sb=this.GRf(Sb)){w.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Yb=BA.r(Sb.MediaType);ch.xf.r7d(this.ao,7,Yb);Yb=b;({Vpa:Yb}=this.heg(b,y,ta)).returnValue?(this.nUc(Yb,y,h,!1),null==u.width?0<Pa&&Sb.Width>
Pa&&(w.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Sb.Width=Pa):(w.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Sb.Width=this.$7c(u.width,Sb.Width,Pa)),null==u.height?0<vb&&Sb.Height>vb&&(w.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Sb.Height=vb):(w.ULS.sendTraceTag(572618199,
324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Sb.Height=this.$7c(u.height,Sb.Height,vb)),ch.$la.y8a||P?this.y7b(Sb,Yb,aa,ta,u,y):(this.HGb=b,this.IGb=y,this.dFc(y))):(w.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),ch.xf.UP(this.ao,2,"No conversion as the context is no longer valid for the external content conversion",ch.xf.qn()));ta&&this.GYa(Yb.node)}else ta&&
this.GYa(b.node),ch.xf.UP(this.ao,1,"URL not oEmbedable",ch.xf.qn())},Sb=>{ch.xf.Z3(this.ao,4,ch.xf.qn());ch.xf.B2c(this.ao,this.Lgb(Sb.data));ta&&this.GYa(b.node);w.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Sb.data.Ae);ch.xf.UP(this.ao,2,"ExternalContentEmbedRequest failed",ch.xf.qn())},Sb=>{ta&&this.GYa(b.node);w.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Sb)},this.ao)}$7c(b,h,u){!b&&0<u&&h>u||b>u?(w.ULS.sendTraceTag(577521885,
324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=u):b>u?h=u:b&&b<u&&(h=b);return h}y7b(b,h,u,y,P,aa){this.jm=Ua.a.create();b.Width=b.Width/b.Height*(b.Height-(sB.a.tPd+sB.a.J$))+2*sB.a.J$;const ta=new dg.GraphTransaction(15);ta.Eb(h.node);ta.Kk=Rc.a.EOa;const Pa=this.B6b(h);null!=P.zGa&&!P.zGa||y||Pa||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.ftf(h,ta,b.Title,aa,u));if(h){y&&(h=this.w7e(h));var vb=this.JBd(h,y);
if(vb){u=BA.r(b.MediaType);var Kb=this.$Ld(b,u);this.rbi=b.IFrameHtml;this.sbi=b.Title;if(vb=this.Psf(vb,Kb,ta,y,aa,u))ta.OEa(this.jm,1),ta.dispose(),this.HGb=h,this.IGb=aa,this.zOf(P,b,vb),this.mRf(aa,y||P.hideFloatie,Pa,u,b.Title)}else ta.dispose(),w.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),ch.xf.UP(this.ao,2,"Could not create IP context on splitting the paragraph",ch.xf.qn())}else ch.xf.UP(this.ao,2,"GraphNodeContext is null",
ch.xf.qn())}$Ld(b,h){const u=new uh.DictionaryPropertySet;ch.HT.S4d(u,b.Width,b.Height);b=this.yif(h,b.Title);u.setValue(Ge.a.imageAltText,b);u.setValue(Lc.a.GT,Gc.a.lG());u.setValue(Lc.a.imageType,0);return u}Psf(b,h,u,y,P,aa){if(!b)return null;b=ch.HT.WQd(b,h);if(!b)return u.dispose(),w.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),ch.xf.UP(this.ao,2,"The anchored image could not be inserted",ch.xf.qn()),null;u=b.node;P=this.QQd(u,
P,aa);ch.xf.Ecg(this.ao,P.id);y||this.U1f(u);return u}zOf(b,h,u){A.a.t2(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(ch.xf.Z3(this.ao,8,ch.xf.qn()),w.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.ZDd(u,h.Thumbnail))}mRf(b,h,u,y,P){h||this.dFc(b);this.s6a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.V2d("IsHyperlinkWithNonURLDisplayText",u);this.ariaNotify(y,P);ch.xf.Z3(this.ao,
5,ch.xf.qn())}V2d(b,h){w.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ca.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.yMb&&ch.nu&&(b=this.zif(b,h),ch.nu.sendNotification(b,!0))}ftf(b,h,u,y,P){if(P){if((P=yi.HyperlinkReader.iD(b,!1))&&1!==P.length)return h.dispose(),w.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),
null;ch.hyperlinkEditor.VQ(P[0].paragraph,P[0].hyperlink)}return this.AYf(b,u,y)}w7e(b){const h=b.node,u=be.ParagraphReader.text(h);return 0<u.length&&!u.trim().length?(b=nf.a.createTextRange(h,0,u.length),ch.characterPropertiesEditor.replaceTextRange(b,""),nf.a.Uc(h,0)):b}JBd(b,h){return h?b:this.vjf(b)}vjf(b){const h=be.ParagraphReader.text(b.node),u=yd.GraphIterator.$a(b.node);if(u.zd()){b=nf.a.Uc(b.node,b.cpEnd);og.OutlineElementNavigator.$d(u);const y=ch.ih.bna(u);ch.Bh.P8(u,y,b,!0,!0,!0,!0);
""!=h&&ch.Bh.pD(u,!1,!0);u.Vd();return nf.a.Uc(u.currentNode,0)}return null}GRf(b){if(!({group:b}=je.a.q0(b.data.Ae)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}AYf(b,h,u){const y=b.cpBegin+h.length;ch.characterPropertiesEditor.replaceTextRange(b,h);b=nf.a.createTextRange(b.node,b.cpBegin,y);ch.hyperlinkEditor.eH(b,u,!1);return b}yif(b,h){const u=!A.a.t2(h);switch(b){case 1:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}ZDd(b,h){b.Hi().contentReplicator.forceOutbound(()=>{this.ERf(h,b)},()=>{w.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}HUc(b){b=yd.GraphIterator.$a(b);b.Ab(12);
b.kd(12);b.Hn.GP=!0}GYa(b){b.Xcc=null}U1f(b){b=yd.GraphIterator.$a(b);b.Ab(11)&&(b.kd(11),b.zd()&&b.Rj()&&b.Vd()&&be.ParagraphReader.ic(b.currentNode)&&(b=Kf.SelectionFactory.we(b.currentNode,0),Hh.a.instance.setSelection(b)))}nUc(b,h,u,y){const P=b.cpBegin,aa=b.cpEnd;b=be.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?aa===b.length?w.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ox[u],y):0<P&&aa<b.length&&w.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ox[u],y):w.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ox[u],y):w.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ox[u],y)}dFc(b){this.r2b();const h=new Ff.a(1,r.AFrameworkApplication.isRtl);h.iYc=b;ch.dfb.i_c(h)}r2b(){const b=new Ev.a(!0);ch.m8.PFa(b)}ERf(b,h){if(b=this.xlf(b,h))h=Array(1),h[0]=b,b=cE.a.construct(h,!1,r.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.xp.Js:null),h=this.y5e(),this.Cmb(h,b)}xlf(b,h){if(!h)return w.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.xp=h.Hi();(new yd.GraphIterator).set(h);
if(!h.anchor||!h.anchor.gr||!h.anchor.gr.Kr)return w.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var u=h.anchor.gr.Kr.node;if(!u)return w.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;u=u.ia(zi.a.CK,Pg.a.ot);const y=h.getValue(Ge.a.FL),P=Bf.a.lf(Jd.ImageReader.jD(h.properties),0),aa=Bf.a.lf(Jd.ImageReader.DI(h.properties),1);return dE.a.construct(h.id.toString(),
b,h.ia(Ge.a.imageAltText,""),P,aa,h.ia(Lc.a.gX,""),u,h.ia(Lc.a.GT,0),h.ia(Lc.a.ega,!1),h.ia(zi.a.$ea,-1),h.ia(Lc.a.Gjb,Box4Intl.Box4Strings.l_Picture),h.ia(Ge.a.gga,!1),y,h.ia(Lc.a.runId,1),h.ia(Lc.a.Pc,0))}Cmb(b,h){r.AFrameworkApplication.Ve.qj(b,2,z.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.bdc,null,void 0,void 0,void 0,void 0,"26");w.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}y5e(){let b=Fa.a.CJc("PicturePaste.ashx");r.AFrameworkApplication.K&&!r.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&
(b=Fa.a.Tn(b,Sd.a.fileId,this.xp.Js));b=Fa.a.Tn(b,Sd.a.cellId,this.xp.gm.toString());this.jm||(this.jm=Ua.a.create(),w.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Fa.a.Tn(b,Sd.a.WS,this.jm.toString());b=Fa.a.Tn(b,Sd.a.classId,(393233).toString());this.xp.tI&&(b=Fa.a.Tn(b,Sd.a.tI,this.xp.tI));b=Fa.a.Tn(b,Sd.a.cpb,"1");b=Fa.a.Tn(b,nh.a.imageType,"0");b=Bl.a.instance.nTe(b);this.xp.contentReplicator&&this.xp.contentReplicator.mGb&&(b=Fa.a.Tn(b,
Sd.a.FXe,"1"));b=Fa.a.Tn(b,Sd.a.Wsa,this.xp.contentReplicator.zu.toString());b=Fa.a.Tn(b,Sd.a.Vcc,"0");return b=Fa.a.Tn(b,Sd.a.TOb,"1")}static get dfb(){return null!=ch.Wng?ch.Wng:ch.Wng=Ja.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get $la(){ch.mza||(ch.mza=Ja.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return ch.mza}static get m8(){return null!=ch.jvg?ch.jvg:ch.jvg=Ja.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get nu(){return null!=
ch.Tlg?ch.Tlg:ch.Tlg=Ja.a.instance.resolve("Common.Utils.IAriaNotifier")}static get Y_(){return null!=ch.iwg?ch.iwg:ch.iwg=Ja.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get HT(){return null!=ch.Dqg?ch.Dqg:ch.Dqg=Ja.a.instance.resolve("WordEditor.IImageEditor")}static get ih(){return ch.Bh||(ch.Bh=Ja.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=ch.tqg?ch.tqg:ch.tqg=Ja.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=
ch.ymg?ch.ymg:ch.ymg=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get xf(){return null!=ch.eog?ch.eog:ch.eog=Ja.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get dWc(){return null!=ch.Vtg?ch.Vtg:ch.Vtg=Ja.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get Ega(){return null!=ch.Ntg?ch.Ntg:ch.Ntg=Ja.a.instance.resolve("Fluid.Host.LoopComponentManager")}}ch.Bh=null;ch.oCa=5E3;ch.mza=null;Object(m.a)(ch,"ExternalContentEditor",
null,[191]);var SB=c(265),$C=c(1198);class gE{constructor(b,h){this.y8a=!0;this.z3a=u=>{if(null!=u.result)return u.result.Value;w.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.y8a};this.eFa=u=>{u.yo||u.Di?w.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.doh(u.result),w.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));
return this.y8a};this.nv=b;this.YJ=h}cVh(){const b=new Jk.a;this.ini()&&this.YJ?this.YJ.u4a(SB.a.FEc).CWRCo(this.z3a,0).CWRCo(this.eFa,8):b.Cg(this.y8a)}y0(b){this.YJ&&this.YJ.y0(SB.a.FEc,new $C.a(SB.a.FEc,b))}sPn(b){this.ini()&&(this.nv.Vha("saveConvertExternalContentIsEnabled",b.toString()),w.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.doh(b),this.y0(b))}ini(){const b=r.AFrameworkApplication.K.$("IsAnonymousUser");if(r.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)w.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}doh(b){this.y8a=b}}Object(m.a)(gE,"ExternalContentSettingInfo",null,[502]);var CA=c(1128);class qk{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(m.a)(qk,"FluidComponentProperties",null,[]);class PE{constructor(){this.loopType=this.Cw=this.VYa=this.url=null;this.mediaType=0;this.Zui=null}}Object(m.a)(PE,"IFrameProps",null,[]);class Vl{static get Y_(){return null!=
Vl.gwg?Vl.gwg:Vl.gwg=Ja.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get HT(){return Vl.Gj||(Vl.Gj=Ja.a.instance.resolve("WordEditor.IImageEditor"))}static get nu(){return null!=Vl.Slg?Vl.Slg:Vl.Slg=Ja.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=Vl.oqg?Vl.oqg:Vl.oqg=Ja.a.instance.resolve("Box4.IHyperlinkEditor")}static get ih(){return null!=Vl.pug?Vl.pug:Vl.pug=Ja.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=
Vl.xmg?Vl.xmg:Vl.xmg=Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static uPa(b){const h=b.startsWith(yi.HyperlinkReader.Bdc),u=b.startsWith(yi.HyperlinkReader.hZc),y=b.startsWith(yi.HyperlinkReader.z5d);return(h||u||y)&&yi.HyperlinkReader.uPa(b)}static JZe(b,h){let u=!1;if(b){switch(b.contextId){case oc.a.Vc:u=!h;break;case oc.a.Fd:u=!0}u&&!RB.a(b.node)&&(u=!1)}return u}static B6b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=nf.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=yi.HyperlinkReader.iD(h,
!1);if(1===h.length){h=h[0];const u=be.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==u)return!0}return!1}static yif(b,h){const u=!A.a.t2(h);switch(b){case 1:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static HUc(b){b=yd.GraphIterator.$a(b);b.Ab(12);b.kd(12);b.Hn.GP=!0}static $Ld(b,h,u,y){const P=new uh.DictionaryPropertySet;Vl.HT.S4d(P,h,b);b=Vl.yif(y,u);P.setValue(Ge.a.imageAltText,b);P.setValue(Lc.a.GT,Gc.a.lG());P.setValue(Lc.a.imageType,0);return P}static QQd(b,h){if(!b||!b.isConnected||!Jd.ImageReader.Wu(b))return null;const u=new fE.a;u.setValue(vi.a.Z6b,h.mediaType);u.setValue(vi.a.P0a,h.url);u.setValue(ld.a.loopComponentType,
h.loopType);u.VYa=h.VYa;u.Cw=h.Cw;u.l2a=1===h.mediaType;u.createMode=h.Zui;yd.GraphIterator.$a(b).Qf(u,2);Vl.HUc(u);return u}static JBd(b,h){return h?b:Vl.vjf(b)}static vjf(b){const h=be.ParagraphReader.text(b.node),u=yd.GraphIterator.$a(b.node);if(u.zd()){b=nf.a.Uc(b.node,b.cpEnd);og.OutlineElementNavigator.$d(u);const y=Vl.ih.bna(u);Vl.ih.P8(u,y,b,!0,!0,!0,!0);""!=h&&Vl.ih.pD(u,!1,!0);u.Vd();return nf.a.Uc(u.currentNode,0)}return null}static U1f(b){b=yd.GraphIterator.$a(b);b.Ab(11)&&(b.kd(11),b.zd()&&
b.Rj()&&b.Vd()&&be.ParagraphReader.ic(b.currentNode)&&(b=Kf.SelectionFactory.we(b.currentNode,0),Hh.a.instance.setSelection(b)))}static zif(b,h){const u=!A.a.t2(h);switch(b){case 1:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=u?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Vl.nu&&(b=Vl.zif(b,h),Vl.nu.sendNotification(b,!0))}static V2d(b,h,u){w.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:u,dataFields:[Object.assign(new ca.a,{name:b,bool:h})]}))}}Object(m.a)(Vl,"ExternalContentHelper",null,[]);var TB=c(737);class aD{constructor(){this.jm=this.xp=
null}ZDd(b,h,u){b.Hi().contentReplicator.forceOutbound(()=>{this.ERf(h,b,u)},()=>{w.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}ERf(b,h,u){if(b=this.xlf(b,h))h=Array(1),h[0]=b,u=cE.a.construct(h,u,r.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.xp.Js:null),b=this.y5e(),this.Cmb(b,u)}xlf(b,h){if(!h)return w.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),
null;this.xp=h.Hi();(new yd.GraphIterator).set(h);if(!h.anchor||!h.anchor.gr||!h.anchor.gr.Kr)return w.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var u=h.anchor.gr.Kr.node;if(!u)return w.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;u=u.ia(zi.a.CK,Pg.a.ot);const y=h.getValue(Ge.a.FL),P=Bf.a.lf(Jd.ImageReader.jD(h.properties),0),aa=Bf.a.lf(Jd.ImageReader.DI(h.properties),
1);return dE.a.construct(h.id.toString(),b,h.ia(Ge.a.imageAltText,""),P,aa,h.ia(Lc.a.gX,""),u,h.ia(Lc.a.GT,0),h.ia(Lc.a.ega,!1),h.ia(zi.a.$ea,-1),h.ia(Lc.a.Gjb,Box4Intl.Box4Strings.l_Picture),h.ia(Ge.a.gga,!1),y,h.ia(Lc.a.runId,1),h.ia(Lc.a.Pc,0))}Cmb(b,h){r.AFrameworkApplication.Ve.qj(b,2,z.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.bdc.bind(this),null,void 0,void 0,void 0,void 0,"26");w.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){w.ULS.sendTraceTag(592996169,
324,100,"Picture paste request for External Content succeeded")}bdc(){w.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}y5e(){let b=Fa.a.CJc("PicturePaste.ashx");r.AFrameworkApplication.K&&!r.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Fa.a.Tn(b,Sd.a.fileId,this.xp.Js));b=Fa.a.Tn(b,Sd.a.cellId,this.xp.gm.toString());this.jm||(this.jm=Ua.a.create(),w.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));
b=Fa.a.Tn(b,Sd.a.WS,this.jm.toString());b=Fa.a.Tn(b,Sd.a.classId,(393233).toString());this.xp.tI&&(b=Fa.a.Tn(b,Sd.a.tI,this.xp.tI));b=Fa.a.Tn(b,Sd.a.cpb,"1");b=Fa.a.Tn(b,nh.a.imageType,"0");b=Bl.a.instance.nTe(b);this.xp.contentReplicator&&this.xp.contentReplicator.mGb&&(b=Fa.a.Tn(b,Sd.a.FXe,"1"));b=Fa.a.Tn(b,Sd.a.Wsa,this.xp.contentReplicator.zu.toString());b=Fa.a.Tn(b,Sd.a.Vcc,"0");return b=Fa.a.Tn(b,Sd.a.TOb,"1")}}Object(m.a)(aD,"ExternalContentThumbnailHelper",null,[]);class gx extends aD{constructor(){super(...arguments);
this.ao=null}static get xf(){return null!=gx.dog?gx.dog:gx.dog=Ja.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}qsj(b,h,u){return Vl.uPa(h)?Vl.JZe(b,u)?!0:(gx.xf.UP(this.ao,2,"URL inserted in Non-Embedable context",gx.xf.qn()),!1):(w.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),gx.xf.UP(this.ao,2,"URL inserted is not valid for ExternalContent",gx.xf.qn()),!1)}}Object(m.a)(gx,"AbstractExternalContentEditor",aD,[191]);
var hE=c(900),QE=c(1156);class cu extends gx{constructor(b){super();cu.EVa=b;this.SBf()}SBf(){this.Qdg&&QE.a.SBf(cu.EVa.JVh())}static get paragraphEditor(){return null!=cu.Nug?cu.Nug:cu.Nug=Ja.a.instance.resolve("Box4.IParagraphEditor")}dTk(b,h){h=this.q_h(b,h);this.dei(h,b,5)}EOa(b,h,u){if(this.qsj(b,h,u)){var y=this.q_h(b,null);y.url=h;this.dei(y,b,u?0:2)}}W3d(b,h){this.EOa(b,h,!1)}dei(b,h,u){this.jm=Ua.a.create();const y=new dg.GraphTransaction(15);y.Eb(h.node);y.Kk=Rc.a.Qfm;const P=Vl.B6b(h),
aa=BA.r(b.mediaType),ta=Vl.$Ld(b.height,b.width,b.title,aa);h=this.Hxo(h,1==u);(h=Vl.Gj.WQd(h,ta))?(h=h.node,Vl.QQd(h,{url:b.url,mediaType:aa,Cw:b.title,loopType:b.type,Zui:u})||w.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),y.OEa(this.jm,1),y.dispose(),this.ZDd(h,b.thumbnail,!1),this.Yin(P,aa,b.type)):w.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}Hxo(b,h){Vl.characterPropertiesEditor.replaceTextRange(b,"");return Vl.JBd(b,
h)}Yin(b,h,u){Vl.V2d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Vl.ariaNotify(h,this.ktl(u))}ktl(b){switch(b){case TB.a.CheckList:return"Checklist Component";case TB.a.TaskAssignment:return"Task List Component";case TB.a.Poll:return"Poll Component";default:return"Fluid Component"}}q_h(b,h){const u=new qk;u.width=Vl.Y_.l2b(b.node)||0;BA.j()?u.height=null!=cu.EVa&&cu.EVa.HVh(h)||Vl.Y_.CZa(b.node)||0:u.height=null!=cu.EVa&&cu.EVa.HVh(h)+2*sB.a.J$||Vl.Y_.CZa(b.node)||
0;u.title="Fluid Component";u.mediaType="fluid";u.type=h;u.thumbnail=this.qDl();u.url=null!=cu.EVa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return u}qDl(){return cu.EVa.JVh()}get Qdg(){return null!=this.Byg?this.Byg:this.Byg=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static EQc(b){r.AFrameworkApplication.Ce("2cejb611;b0jjh576");return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=cu.EVa&&cu.EVa.foi(b)&&hE.a.pji()}}Object(m.a)(cu,"FluidComponentEditor",gx,[]);class iE{get Yel(){return null!=this.Vng?this.Vng:this.Vng=Ja.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get yHd(){return null!=this.kpg?this.kpg:this.kpg=Ja.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}Sin(b,h){b&&(cu.EQc(h)?this.yHd.EOa(b,h,!0):this.Yel.EOa(b,h,!0))}}Object(m.a)(iE,"PostHyperlinkAutoCorrectStrategy",null,[500]);class UB{T_b(b,h){h(UB.bjn.test(b))}Rec(b,
h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new kC,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:UB.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}UB.bjn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$",
"i");UB.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(m.a)(UB,"PowerBIURLResolver",null,[492,493]);class DA{constructor(b){this.e$g=b}T_b(b,h){let u=!1;try{if(DA.Vwm(b)){const y=this.e$g.v5b(b);u=null!=y.width&&null!=y.height&&!!y.thumbnailUrl&&!!y.title&&null!=y.zGa}}catch(y){}h(u)}Rec(b,h){var u=this.e$g.v5b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
u.width,u.height,b);u=Object.assign(new kC,{Height:u.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:u.thumbnailUrl,Title:u.title,Width:u.width});h(u)}static Vwm(b){for(const h of DA.Kho)if(b.startsWith(h))return!0;return!1}static Nea(){return new DA(Ja.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}DA.Kho=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(m.a)(DA,"WedgeComponentExperimentsURLResolver",null,[492,
493]);var bD=c(714);class Zu{static ybj(b){Zu.Nki||Zu.addEventListener();const h=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");h&&h.execute(u=>{u.logActivity(b,null)})}static addEventListener(){window.addEventListener(Zu.pio,Zu.oio,!0);Zu.Nki=!0}static MGk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click()}}Zu.vko="LoopsTeachingCalloutOnInsertTabActivity";Zu.cPm="LoopHomeTabFlightActivity";Zu.pio="switchToInsertTabAndClickLoopButtonEvent";Zu.Nki=
!1;Zu.oio=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const u=null===(b=r.AFrameworkApplication.K)||void 0===b?void 0:b.pc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new sc.a(0,1,u,()=>{Zu.MGk()});null===(h=r.AFrameworkApplication.uc)||void 0===h?void 0:h.Xb(b)};Object(m.a)(Zu,"FluidComponentsTUIHelper",null,[]);class cD{constructor(b,h,u){this.ga=b;this.lMj=h;this.Tk=u}Wb(){this.ga.gb(Rc.a.jei,oc.a.Vc,this.jgm.bind(this),1028);this.ga.gb(Rc.a.tPc,oc.a.Vc,this.Ssf.bind(this),
1028);this.ga.gb(Rc.a.hPc,oc.a.Vc,this.Ssf.bind(this),1028);this.ga.gb(Rc.a.atf,oc.a.Vc,this.Ssf.bind(this),1028);this.ga.gb(Rc.a.yri,oc.a.Vc,this.Xxj.bind(this),1028)}jgm(){return 32}Ssf(b,h,u){var y,P,aa;if(1===u){if(!this.$Sd(b)||!bD.a.Bvf())return 2;(null===(y=r.AFrameworkApplication.K)||void 0===y?0:y.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&Zu.ybj(Zu.vko);if(!h.gl||!Se.SelectionEditor.pf(h)||Fj.a.IAd&&(null===(P=this.Tk)||void 0===P?0:P.xZ(h))||(null===(aa=
this.Tk)||void 0===aa?0:aa.uva(h)))return 2;if(h&&h.node&&RB.a(h.node))return 32}else if(2===u)return this.lMj.dTk(h,cD.oDl(b)),32;return 2}$Sd(b){return b===Rc.a.hPc||b===Rc.a.tPc?hE.a.$Sd():!0}Xxj(b,h,u){2===u&&A.a.tX("https://go.microsoft.com/fwlink/?linkid=2194838")&&Ra.App.J_f.vjc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static oDl(b){switch(b){case Rc.a.tPc:return TB.a.TaskAssignment;case Rc.a.hPc:return TB.a.CheckList;case Rc.a.atf:return TB.a.Poll;default:return null}}}
Object(m.a)(cD,"FluidComponentsActor",null,[]);class yj extends gx{constructor(){super();this.IGb=this.HGb=null;this.Vbf=new eE.ExternalContentEmbedRetriever;this.Jpc=null;null!=yj.$la&&yj.$la.cVh()}jRi(){this.ao=T.a.create();yj.xf.Hzb(this.ao,4);yj.xf.Z3(this.ao,0,yj.xf.qn());this.GEb(this.HGb,3,this.IGb,!0)}EOa(b,h,u){this.ao=T.a.create();yj.xf.Hzb(this.ao,u?0:2);yj.xf.Z3(this.ao,0,yj.xf.qn());this.Jpc();this.GEb(b,u?0:2,h)}W3d(b,h){this.ao=T.a.create();yj.xf.Hzb(this.ao,1);yj.xf.Z3(this.ao,0,yj.xf.qn());
this.GEb(b,1,h)}ZSi(b){this.Jpc=b}Oke(b,h){const u=yj.Y_.l2b(h)||0;h=yj.Y_.CZa(h)||0;const y=b.Width/b.Height;1<=y?(b.Width=u,b.Height=u/y):(b.Height=h,b.Width=h/y)}Dhg(b,h,u){if(null!=b&&null!=h&&!A.a.kf(u)){var y=yj.dWc.v5b(u);y.zGa=!0;y.hideFloatie=!0;this.Oke(b,h.node);this.y7b(b,h,!1,!1,y,u)}}Lgb(b){return b?b.jf:0}heg(b,h,u){let y=null;const P=b.node;if(!be.ParagraphReader.ic(P)||!P.isConnected)return{returnValue:!1,Vpa:y};if(u)return{returnValue:!0,Vpa:b};u=b.cpBegin;const aa=b.cpEnd,ta=be.ParagraphReader.text(P);
if(0<=u&&aa<=ta.length&&ta.substring(u,aa)===h)return{returnValue:!0,Vpa:b};const Pa=ta.indexOf(h);return 0<=Pa?(y=nf.a.createTextRange(P,Pa,Pa+h.length),{returnValue:!0,Vpa:y}):0<=u&&aa<=ta.length&&Vl.B6b(b)?{returnValue:!0,Vpa:b}:{returnValue:!1,Vpa:y}}gzf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}s6a(b,h){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const u=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");
u&&u.execute(y=>{y.logActivity(b,h)})},yj.oCa)}GEb(b,h,u,y=!1){if(this.qsj(b,u,!h)){var P=yj.dWc.v5b(u);P&&(this.gzf(P)?(w.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.ARf(b,h,P,u,y)):(w.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),yj.xf.UP(this.ao,2,"Size provided is not valid for OEmbed",yj.xf.qn())))}}ARf(b,h,u,y,P){const aa=!h,ta=1===h,Pa=yj.Y_.l2b(b.node)||0,vb=yj.Y_.CZa(b.node)||0,Kb=bE.a.n2e(u.Adg,
!0,Pa,vb);this.nUc(b,y,h,!0);this.Vbf.grh(Kb,Sb=>{yj.xf.Z3(this.ao,4,yj.xf.qn());yj.xf.B2c(this.ao,this.Lgb(Sb.data));if(Sb=this.GRf(Sb)){w.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Yb=BA.r(Sb.MediaType);yj.xf.r7d(this.ao,7,Yb);Yb=b;({Vpa:Yb}=this.heg(b,y,ta)).returnValue?(this.nUc(Yb,y,h,!1),null==u.width?0<Pa&&Sb.Width>Pa&&(w.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),
Sb.Width=Pa):(w.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Sb.Width=this.$7c(u.width,Sb.Width,Pa)),null==u.height?0<vb&&Sb.Height>vb&&(w.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Sb.Height=vb):(w.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Sb.Height=this.$7c(u.height,Sb.Height,
vb)),yj.$la.y8a||P?this.y7b(Sb,Yb,aa,ta,u,y):(this.HGb=b,this.IGb=y,this.dFc(y))):(w.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),yj.xf.UP(this.ao,2,"No conversion as the context is no longer valid for the external content conversion",yj.xf.qn()));ta&&this.GYa(Yb.node)}else ta&&this.GYa(b.node),yj.xf.UP(this.ao,1,"URL not oEmbedable",yj.xf.qn())},Sb=>{yj.xf.Z3(this.ao,4,yj.xf.qn());yj.xf.B2c(this.ao,
this.Lgb(Sb.data));ta&&this.GYa(b.node);w.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Sb.data.Ae);yj.xf.UP(this.ao,2,"ExternalContentEmbedRequest failed",yj.xf.qn())},Sb=>{ta&&this.GYa(b.node);w.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Sb)},this.ao)}$7c(b,h,u){!b&&0<u&&h>u||b>u?(w.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=u):b>u?
h=u:b&&b<u&&(h=b);return h}y7b(b,h,u,y,P,aa){this.jm=Ua.a.create();b.Width=b.Width/b.Height*(b.Height-(sB.a.tPd+sB.a.J$))+2*sB.a.J$;const ta=new dg.GraphTransaction(15);ta.Eb(h.node);ta.Kk=Rc.a.EOa;const Pa=Vl.B6b(h);null!=P.zGa&&!P.zGa||y||Pa||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.ftf(h,ta,b.Title,aa,u));if(h){y&&(h=this.w7e(h));var vb=Vl.JBd(h,y);if(vb){u=BA.r(b.MediaType);var Kb=Vl.$Ld(b.Height,b.Width,b.Title,u);(vb=this.Psf(vb,Kb,y,{url:aa,VYa:b.IFrameHtml,
Cw:b.Title,mediaType:u}))?(ta.OEa(this.jm,1),ta.dispose(),this.HGb=h,this.IGb=aa,this.zOf(P,b,vb),this.mRf(aa,y||P.hideFloatie,Pa,u,b.Title)):ta.dispose()}else ta.dispose(),w.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),yj.xf.UP(this.ao,2,"Could not create IP context on splitting the paragraph",yj.xf.qn())}else yj.xf.UP(this.ao,2,"GraphNodeContext is null",yj.xf.qn())}Psf(b,h,u,y){if(!b)return null;b=yj.HT.WQd(b,h);
if(!b)return w.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),yj.xf.UP(this.ao,2,"The anchored image could not be inserted",yj.xf.qn()),null;b=b.node;y=Vl.QQd(b,y);yj.xf.Ecg(this.ao,y.id);u||Vl.U1f(b);return b}zOf(b,h,u){A.a.t2(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(yj.xf.Z3(this.ao,8,yj.xf.qn()),w.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.ZDd(u,h.Thumbnail,!1))}mRf(b,h,u,y,P){h||this.dFc(b);this.s6a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Vl.V2d("IsHyperlinkWithNonURLDisplayText",u,"Office.Word.Online.ExternalContent.OEmbedInsertions");Vl.ariaNotify(y,P);yj.xf.Z3(this.ao,5,yj.xf.qn())}ftf(b,h,u,y,P){if(P){if((P=yi.HyperlinkReader.iD(b,!1))&&1!==P.length)return h.dispose(),w.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;
Vl.hyperlinkEditor.VQ(P[0].paragraph,P[0].hyperlink)}return this.AYf(b,u,y)}w7e(b){const h=b.node,u=be.ParagraphReader.text(h);return 0<u.length&&!u.trim().length?(b=nf.a.createTextRange(h,0,u.length),Vl.characterPropertiesEditor.replaceTextRange(b,""),nf.a.Uc(h,0)):b}GRf(b){if(!({group:b}=je.a.q0(b.data.Ae)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}AYf(b,h,u){const y=b.cpBegin+h.length;Vl.characterPropertiesEditor.replaceTextRange(b,h);b=nf.a.createTextRange(b.node,b.cpBegin,
y);Vl.hyperlinkEditor.eH(b,u,!1);return b}GYa(b){b.Xcc=null}nUc(b,h,u,y){const P=b.cpBegin,aa=b.cpEnd;b=be.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?aa===b.length?w.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ox[u],y):0<P&&aa<b.length&&w.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Ox[u],y):w.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ox[u],y):w.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Ox[u],y)}dFc(b){this.r2b();const h=new Ff.a(1,r.AFrameworkApplication.isRtl);h.iYc=b;yj.dfb.i_c(h)}r2b(){const b=
new Ev.a(!0);yj.m8.PFa(b)}static get dfb(){return null!=yj.Xng?yj.Xng:yj.Xng=Ja.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get $la(){yj.mza||(yj.mza=Ja.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return yj.mza}static get m8(){return null!=yj.kvg?yj.kvg:yj.kvg=Ja.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Y_(){return null!=yj.hwg?yj.hwg:yj.hwg=Ja.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get HT(){return null!=
yj.Cqg?yj.Cqg:yj.Cqg=Ja.a.instance.resolve("WordEditor.IImageEditor")}static get dWc(){return null!=yj.Utg?yj.Utg:yj.Utg=Ja.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}yj.oCa=5E3;yj.mza=null;Object(m.a)(yj,"ExternalContentEditorV2",gx,[]);class dD{constructor(){this.Wc=this.W=null}get name(){return"WordEditor.ExternalContent"}get $b(){return this.Wc?this.Wc:this.Wc=this.W.resolve("Box4.IFeatureHelper")}xc(b){var h;this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",
()=>new QB.a(so.a.instance,to.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new iE).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new gE(b.resolve("Box4.IRoamingServiceRequestManager"),b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new yj).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new cu(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new cD(r.AFrameworkApplication.ya,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),
sd.a.instance)).singleInstance(),(null===(h=r.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Zu.ybj(Zu.cPm)):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new ch).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.$b.hp.continueWith(()=>{this.$m()});r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Wb()}dispose(){}WSk(){const b=
new Sj;this.dJh()&&b.Gdh(DA.Nea());b.Gdh(new UB);return b}$m(){null==r.AFrameworkApplication.K||r.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new CA.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();this.dJh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.WSk()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),
this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}dJh(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){K.a.instance.Kc(new dD)}}Object(m.a)(dD,"ExternalContentPackage",null,[1,2]);var ww;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";
b[b.vQo=7]="bar";b[b.XEa=8]="num"})(ww||(ww={}));Object(m.b)("TabStopValues",ww);class Ho{}Ho.yDh=8;Ho.t0k=1;Ho.S6="wwaengidc";Ho.kpiName="WordRuler";Ho.precision=.0625;Ho.sjo=1;Ho.yDo="ShowHideRuler";Object(m.a)(Ho,"Constants",null,[]);var Px=c(763);class Fr{static J5b(b,h){if(!Fr.WRc)return null;switch(b){case "Left":return u=>{const y=u.rulerCanvasProps;u=u.indents;return{RGb:0,sLb:y.scale-(y.margins[1].value+u[2].value+Math.max(u[0].value,u[1].value)+8*y.precision)}};case "Right":return u=>{const y=
u.rulerCanvasProps;u=u.indents;return{RGb:0,sLb:y.scale-(u[2].value+(y.margins[0].value+Math.max(u[0].value,u[1].value))+8*y.precision)}};case "MoveTableColumn":return()=>{let u=0,y=0;if(0===h){var P={};32===Fr.Bc.Ub(Oa.a.Rdc,2,P)&&(u=Xf.a.pz(P.MinIndent),y=Xf.a.pz(P.MaxIndent))}else P={xo:h-1},32===Fr.Bc.Ub(Oa.a.Qdc,2,P)&&(u=Xf.a.pz(P.MinResize),y=Xf.a.pz(P.MaxResize));return{RGb:u,sLb:y}};case "Top":return u=>{u=u.rulerCanvasProps;return{RGb:0,sLb:u.scale-(u.margins[1].value+8*u.precision)}};case "Bottom":return u=>
{u=u.rulerCanvasProps;return{RGb:0,sLb:u.scale-(u.margins[0].value+8*u.precision)}}}return null}static oMd(b){if(!Fr.WRc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var u=h.rulerCanvasProps,y=h.indents,P=h.ipContextIndex;h=u.margins;var aa=u.scale;u=u.precision;if("MoveTableColumn"!==h[0].type){P=h[0].value;h=h[1].value+y[2].value;var ta=P;"LeftIndent"===b&&(ta+=Math.max(y[0].value,y[1].value));y=-1*P;u=aa-(ta+h+8*u)}else{aa=0;for(ta=0;ta<=P;ta++)aa+=
h[ta].value;ta=0;if("LeftIndent"===b){ta=y[0].value;const Pa=y[1].value;aa+=Math.max(ta,Pa);ta=Math.max(ta,Pa)}h=h[P+1].value;ta+=y[2].value;y=-1*aa;u=h-ta-u}return{RGb:y,sLb:u}};case "RightIndent":return h=>{var u=h.rulerCanvasProps,y=h.indents,P=h.ipContextIndex,aa=u.margins;h=u.scale;u=u.precision;if("MoveTableColumn"!==aa[0].type){var ta=aa[0].value;aa=aa[1].value;P=y[0].value;var Pa=y[1].value;y=-1*aa;h-=ta+aa+Math.max(P,Pa)+8*u}else{ta=0;for(Pa=0;Pa<=P;Pa++)ta+=aa[Pa].value;aa=aa[P+1].value;
P=y[0].value;Pa=y[1].value;y=-1*(h-ta-aa);h=aa-Math.max(P,Pa)-u}return{RGb:y,sLb:h}}}return null}static uSl(){return b=>{var h=b.rulerCanvasProps,u=b.indents,y=b.ipContextIndex,P=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==P[0].type?(y=P[0].value,P=P[1].value+u[2].value,u=Math.min(u[0].value,u[1].value)+b,b=h-(y+P+b)):(h=u[2].value,P=P[y+1].value,u=Math.min(u[0].value,u[1].value)+b,b=P-(h+b));return{RGb:u,sLb:b}}}static get Bc(){return null!=Fr.Jlg?Fr.Jlg:Fr.Jlg=r.AFrameworkApplication.ya}static get WRc(){null==
this.r$a&&(r.AFrameworkApplication.Aga("WoRul910;WoRul910cf"),this.r$a=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.r$a}}Fr.r$a=null;Object(m.a)(Fr,"RulerPropertyBoundaryHelper",null,[]);var VB=c(915),Qx;(function(b){b[b.appChromeReady=0]="appChromeReady";b[b.appChromeLazyReady=1]="appChromeLazyReady"})(Qx||(Qx={}));Object(m.b)("WoncaAppChromeState",Qx);const jE=b=>{fh.c()?b():w.ULS.sendTraceTag(51393038,
340,10,"appChrome is not defined.")},xk=(b,h)=>{const u=Ja.a.instance.Pa("Wonca.IWoncaAppChromeStateManager");u?u.al(b,()=>{jE(h)}):jE(h)};var kE=c(1219),lE=c(1220);class zz{constructor(b,h,u,y,P,aa){this.Obn="OutlineContainer";this.n6j="UpdateCustomTabFailed";this.ovb="ReadRulerPropertiesFailed";this.r6j="UpdateIndentFailed";this.V9g="UpdateMarginFailed";this.Q1d=ta=>{ta.button===Sys.UI.MouseButton.rightButton&&this.eKe.show(new Sys.UI.Point(ta.clientX,ta.clientY),2)};this.fqj=()=>{this.$Sa()};this.Sm=
b;this.cVb=h;this.ga=u;this.eKe=y;this.Ww=P;this.YR=aa;this.sSb=null;this.ww=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.vX;this.zFi=this.A1d.bind(this);this.eIi=this.Qs.bind(this);this.eqj=this.$Sa.bind(this)}fB(){this.cTe();this.Kdh();this.cVb.sl.Xe(10).Ap(this.zFi);rf.a.addHandler(this.JQe,bb.a.scroll,this.fqj);this.Sm.execute(h=>{h.u8(this.eIi)});const b=[this.jlf(),document.getElementById($g.AppFrame.k8c),document.getElementById("PageContentContainer")];this.sSb?this.sSb.register(b,
this.eqj):xk(Qx.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.sSb=h.createResizeObserver();this.sSb.register(b,this.eqj);return null})});Ra.App.xa.eI.registerBoundingWindowRectsChanged("documentPanel",(h,u)=>{"undefined"!==u&&this.I6a([1,0])})}jlf(){return 1===this.YR.Tv?this.mYj:this.JXj}get JQe(){return document.getElementById($g.AppFrame.jTa)}get JXj(){const b=document.getElementsByClassName(this.Obn);return b&&0<b.length?b[0]:null}get mYj(){var b=this.Ww.M3b;if(!b)return null;
b=this.hRn(be.ParagraphReader.eQ(b));return VB.a.h1h(b)}hRn(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get VM(){return this.Sm&&this.Sm.instance?this.Sm.instance.jj:Ho.t0k}g5b(){const b={};return 32!==this.ga.Ub(Oa.a.KFa,2,b)?(w.ULS.sendTraceTag(529065947,kE.a.msoulscat_Wac_WordRuler,lE.a.warning,"Unable to read page properties for Ruler"),qm.recordQosError(this.ovb,[qm.Pda],"Unable to read page properties for Ruler"),null):b}dispose(){this.rai();this.cVb.sl.Xe(10).YX(this.zFi);
rf.a.removeHandler(this.JQe,bb.a.scroll,this.fqj);this.Sm.execute(b=>{b.Ylb(this.eIi)});this.sSb&&this.sSb.dispose();Ra.App.xa.eI.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.I6a([1,0])})}get kli(){null==zz.qze&&(zz.qze=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&r.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);
return zz.qze}}zz.qze=null;Object(m.a)(zz,"ARuler",null,[496]);var RE=c(312);class du extends zz{constructor(b,h,u,y,P,aa,ta){super(b,h,u,P,aa,ta);this.lO="HorizontalRuler";this.cwj="CustomTabModificationFromRuler";this.Cxj="IndentModificationFromRuler";this.fke="MarginModificationFromRuler";this.CNg=this.BNg=this._tabStops=null;this.M2m=(Pa,vb,Kb)=>{if(!(Pa>=this._tabStops.length)){Pa=this._tabStops[Pa];var Sb="Modify"===Kb?this.ga.Ub(Rc.a.Rac,2,{["tabStop"]:Pa,["value"]:Xf.a.Xy(vb)}):this.ga.Ub(Rc.a.x4a,
2,Pa);if(32===Sb){vb=1;var Yb=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Kb,ww[Pa.Bca]);w.ULS.sendTraceTag(591213271,3014,50,Yb)}else vb=0,Yb=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Kb,ww[Pa.Bca]),w.ULS.sendTraceTag(591213272,3014,15,Yb),qm.recordQosError(this.n6j,[qm.Pda],"Unable to modify custom tab using ruler");Ub.a(this.cwj,32===Sb,void 0,[Object.assign(new ca.a,{name:"Operation",string:Kb}),Object.assign(new ca.a,
{name:"TabType",int64:ww[Pa.Bca]})]);Kb=new Map;Kb.set("Command","OnCustomTabChange");Kb.set("Source",this.lO);Kb.set("Response",Yb);Ta.Health.instance.recordKpiUsage(Ho.kpiName,vb,Ho.S6,Kb)}};this.$4m=(Pa,vb)=>{var Kb=new Px.a;Kb.unit=1;Kb.value=Xf.a.Xy(vb);vb=8;switch(Pa){case "FirstLineIndent":vb=this.ga.Ub(Oa.a.V2c,2,Kb);break;case "HangingIndent":vb=this.ga.Ub(Oa.a.W2c,2,Kb);break;case "LeftIndent":vb=this.ga.Ub(Oa.a.Z0a,2,Kb);break;case "RightIndent":vb=this.ga.Ub(Oa.a.Y0a,2,Kb)}let Sb;32===
vb?(Kb=1,Sb=String.format("Indents set using Ruler. Indent: {0}",Pa),w.ULS.sendTraceTag(592517017,3014,50,Sb)):(Kb=0,Sb=String.format("Unable to set indent using Ruler. Indent: {0}",Pa),w.ULS.sendTraceTag(592496523,3014,15,Sb,Pa),qm.recordQosError(this.r6j,[qm.Pda],"Unable to set indent using Ruler."));Ub.a(this.Cxj,32===vb,void 0,[Object.assign(new ca.a,{name:"Type",string:Pa})]);Pa=new Map;Pa.set("Command","OnIndentChange");Pa.set("Source",this.lO);Pa.set("Response",Sb);Ta.Health.instance.recordKpiUsage(Ho.kpiName,
Kb,Ho.S6,Pa)};this.kMf=(Pa,vb,Kb)=>{let Sb;Sb="Left"===Pa?this.ga.Ub(Oa.a.Pha,2,Xf.a.Xy(vb)):"Right"===Pa?this.ga.Ub(Oa.a.l5a,2,Xf.a.Xy(vb)):Kb?this.ga.Ub(Oa.a.Iee,2,{["columnIndex"]:Kb-1,["width"]:Xf.a.Xy(vb)}):this.ga.Ub(Oa.a.zgc,2,Xf.a.Xy(vb));32===Sb?(vb=1,Kb=String.format("Margins set using Ruler. Margin: {0}",Pa),w.ULS.sendTraceTag(592517018,3014,50,Kb)):(vb=0,Kb=String.format("Unable to set margins using Ruler. Margin: {0}",Pa),w.ULS.sendTraceTag(592496524,3014,15,Kb),qm.recordQosError(this.V9g,
[qm.Pda],"Unable to set margins using Ruler."));Ub.a(this.fke,32===Sb,void 0,[Object.assign(new ca.a,{name:"Type",string:Pa})]);Pa=new Map;Pa.set("Command","OnMarginChange");Pa.set("Source",this.lO);Pa.set("Response",Kb);Ta.Health.instance.recordKpiUsage(Ho.kpiName,vb,Ho.S6,Pa)};this.RKa=y;this.Gv={}}get BT(){return this.BNg}get ADa(){return this.CNg}renderRuler(){this.BT.classList.remove("HideWACHorizontalRulerContainer");this.BT.classList.add("ShowWACHorizontalRulerContainer");var b=this.g5b();
if(b){var h=this.kMf,u=this.$4m,y=this.M2m,P=this.y6c(),aa=this.Nkj(),ta=this.Mkj();P&&aa&&ta||(this.Gv.disabled=!0);this.Gv.onIndentChange=u;this.Gv.onMarginChange=h;this.Gv.onTabChange=y;this.$Sa();b=Bf.a.Mi(b.Ao,0);this.ADa.style.width=(b*this.VM).toString()+"px";return this.RKa().then(Pa=>{Pa.renderRuler(this.ADa,this.Gv)})}}Mkj(){const b=[];var h={};if(32!==this.ga.Ub(Rc.a.aKb,2,h))return w.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),qm.recordQosError(this.ovb,
[qm.Pda],"Unable to read paragraph tabs for Ruler"),!1;var u=h.customTabs;if(!u||0>=u.length)return this.Gv.tabs=b,!0;this._tabStops=u;h="";for(const y of u){switch(y.Bca){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}u=Bf.a.U3a(y.NGa,0);b.push({["type"]:h,["value"]:u,["getRulerPropertyBoundary"]:Fr.uSl()})}this.Gv.tabs=b;return!0}I6a(b){var h;if(this.BT){this.BT.classList.add("ShowWACHorizontalRulerContainer");"disabled"in
this.Gv&&delete this.Gv.disabled;for(const u of b)switch(u){case 0:b=this.Nkj();const y=this.Mkj();b&&y||(this.Gv.disabled=!0);break;case 1:this.y6c()||(this.Gv.disabled=!0)}if(null===(h=this.Ww.kb)||void 0===h?0:h.DQc)this.Gv.disabled=!0;this.RKa().then(u=>{u.renderRuler(this.ADa,this.Gv);return null})}}y6c(){const b={};var h=this.g5b();if(!h)return!1;b.scale=Xf.a.pz(h.Ao);b.precision=Ho.precision;b.rulerType="Horizontal";if(!this.qan())return this.Gv.ipContextIndex=0,this.Gv.permittedUnits=Ho.yDh,
h=[{["type"]:"Left",["value"]:Xf.a.pz(h.marginLeft),["getRulerPropertyBoundary"]:Fr.J5b("Left",0)},{["type"]:"Right",["value"]:Xf.a.pz(h.marginRight),["getRulerPropertyBoundary"]:Fr.J5b("Right",1)}],b.margins=h,this.Gv.rulerCanvasProps=b,!0;var u={};h={};var y=this.ga.Ub(Oa.a.SZc,2,u);const P=this.ga.Ub(Oa.a.oKb,2,h);if(32!==y||32!==P)return w.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),qm.recordQosError(this.ovb,[qm.Pda],"Unable to read table properties for Ruler"),
!1;u=u.ColumnWidths;y=h.TablePosition;if(!y||!u||0>=u.length)return w.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),qm.recordQosError(this.ovb,[qm.Pda],"Cannot show table properties on the ruler as they are null"),!1;h=Array(u.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Xf.a.pz(y.x/this.VM),["getRulerPropertyBoundary"]:Fr.J5b("MoveTableColumn",0)};for(y=0;y<u.length;y+=1)h[y+1]={["type"]:"MoveTableColumn",["value"]:Xf.a.pz(u[y]),["getRulerPropertyBoundary"]:Fr.J5b("MoveTableColumn",
y+1)};this.Gv.ipContextIndex=this.UVl();this.Gv.permittedUnits=Ho.sjo;b.margins=h;this.Gv.rulerCanvasProps=b;return!0}Nkj(){var b={};if(32!==this.ga.Ub(Oa.a.j4a,2,b))return w.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),qm.recordQosError(this.ovb,[qm.Pda],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Fr.oMd("FirstLineIndent");const u={type:"HangingIndent"};u.getRulerPropertyBoundary=Fr.oMd("HangingIndent");
const y={type:"RightIndent"};y.getRulerPropertyBoundary=Fr.oMd("RightIndent");const P={type:"LeftIndent"};P.getRulerPropertyBoundary=Fr.oMd("LeftIndent");this.Gv.rtl=b.isRtl;b=b.it;h.value=1===b.specialIndentType?Xf.a.pz(b.wca+b.UA):2===b.specialIndentType?Xf.a.pz(b.UA-b.wca):Xf.a.pz(b.UA);u.value=Xf.a.pz(b.UA);P.value=Xf.a.pz(b.UA);y.value=Xf.a.pz(b.Zma);this.Gv.indents=[h,u,y,P];return!0}Kdh(){rf.a.addHandler(this.BT,bb.a.qx,this.Q1d)}rai(){this.BT&&(this.BT.classList.remove("ShowWACHorizontalRulerContainer"),
this.BT.classList.add("HideWACHorizontalRulerContainer"),rf.a.removeHandler(this.BT,bb.a.qx,this.Q1d));this.RKa().then(b=>{b.dispose(this.ADa);return null})}Qs(){this.hqj();this.$Sa();this.I6a([1,0])}A1d(b,h){b=h.property;if(b===Lc.a.Ao||b===Lc.a.marginLeft||b===Lc.a.marginRight)this.hqj(),this.$Sa(),this.I6a([1])}hqj(){var b=this.g5b();b&&(b=Bf.a.Mi(b.Ao,0),this.ADa.style.width=Math.round(b*this.VM).toString()+"px")}$Sa(){window.requestAnimationFrame(()=>{var b=this.jlf();b&&(b=Je.a.getElementBounds(b),
r.AFrameworkApplication.isRtl?this.ADa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.ADa.style.marginLeft=b.x.toString()+"px")})}UVl(){const b=yd.GraphIterator.$a(this.Ww.M3b);if(b.Ab(14))return b.kd(16),dm.a(b,!0);w.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");qm.recordQosError(this.ovb,[qm.Pda],"Unable to read table column index for Ruler");return 0}qan(){let b=!0;const h=this.Ww.kb.HN();if(null===h)return w.ULS.sendTraceTag(557065614,
3014,15,"Unable to get Context Iterator for the Ruler"),qm.recordQosError(this.ovb,[qm.Pda],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const u=yd.GraphIterator.$a(h.current.node);u.zd();b=b&&xh.TableReader.Jw(u)}return b}cTe(){if(!this.ADa&&!this.BT){this.BNg=document.createElement("div");this.BT.id=du.KOj;this.BT.className=du.JOj;this.BT.setAttribute(hf.a.pea,WordEditorIntl.WordEditorStrings.L_Ruler);this.BT.setAttribute(hf.a.wh,hf.a.Qjh);this.BT.classList.add("HideWACHorizontalRulerContainer");
if(this.kli){var b=r.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");const h=r.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Xa.a.rfa(b,!h)&&this.BT.classList.add(du.ZUj)}this.CNg=document.createElement("div");this.ADa.className=du.IOj;this.ADa.id=du.LOj;this.BT.appendChild(this.ADa);b=null;this.ww&&((b=Object(RE.a)("EditorBars"))&&b.appendChild(this.BT),this.BT.classList.add("regionComposer"));b||(b=document.getElementById($g.AppFrame.k8c),b.insertBefore(this.BT,
b.firstChild))}}static kE(){return new du(Ja.a.instance.Za("Common.IZoomManager"),Ra.App.kk,r.AFrameworkApplication.ya,Vj.UISurfaces.J3h,Ja.a.instance.resolve("WordEditor.IRulerContextMenu"),Zq.a.instance,Ja.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=du.Zrg?du.Zrg:du.Zrg=du.kE()}}du.KOj="WACHorizontalRulerContainer";du.JOj="WACHorizontalRulerContainer";du.LOj="WACHorizontalRuler";du.IOj="WACHorizontalRuler";du.ZUj="ModernUxWACHorizontalRulerContainer";
Object(m.a)(du,"HorizontalRuler",zz,[]);var eD=c(941);class eu extends zz{constructor(b,h,u,y,P,aa,ta){super(b,h,u,P,aa,ta);this.lO="VerticalRuler";this.fke="MarginModificationFromRuler";this.J$g=this.I$g=null;this.kMf=(Pa,vb)=>{let Kb=8;"Top"===Pa?Kb=this.ga.Ub(Oa.a.m5a,2,Xf.a.Xy(vb)):"Bottom"===Pa&&(Kb=this.ga.Ub(Oa.a.k5a,2,Xf.a.Xy(vb)));let Sb;32===Kb?(vb=1,Sb=String.format("Margins set using Ruler. Margin: {0}",Pa),w.ULS.sendTraceTag(529065945,3014,50,Sb)):(vb=0,Sb=String.format("Unable to set margins using Ruler. Margin: {0}",
Pa),w.ULS.sendTraceTag(529065946,3014,15,Sb),qm.recordQosError(this.V9g,[qm.Pda],"Unable to set margins using Ruler."));Ub.a(this.fke,32===Kb,void 0,[Object.assign(new ca.a,{name:"Type",string:Pa})]);Pa=new Map;Pa.set("Command","OnMarginChange");Pa.set("Source",this.lO);Pa.set("Response",Sb);Ta.Health.instance.recordKpiUsage(Ho.kpiName,vb,Ho.S6,Pa)};this.RKa=y;this.Gv={}}get E0(){return this.I$g}get HHa(){return this.J$g}renderRuler(){this.E0.classList.remove("HideWACVerticalRulerContainer");this.E0.classList.add("ShowWACVerticalRulerContainer");
var b=this.g5b();if(b){var h=this.kMf;this.y6c()||(this.Gv.disabled=!0);this.Gv.onMarginChange=h;this.$Sa();b=Bf.a.Mi(b.ew,1);this.HHa.style.height=(b*this.VM).toString()+"px";this.RKa().then(u=>{u.renderRuler(this.HHa,this.Gv);return null})}}I6a(b){var h;if(this.E0){this.E0.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.Gv&&delete this.Gv.disabled;for(const u of b)switch(u){case 1:this.y6c()?this.$Sa():this.Gv.disabled=!0}if(null===(h=this.Ww.kb)||void 0===h?0:h.DQc)this.Gv.disabled=
!0;this.RKa().then(u=>{u.renderRuler(this.HHa,this.Gv);return null})}}y6c(){const b={},h=this.g5b();if(!h)return!1;b.scale=Xf.a.pz(h.ew);b.precision=Ho.precision;b.rulerType="Vertical";this.Gv.ipContextIndex=0;this.Gv.permittedUnits=Ho.yDh;b.margins=[{["type"]:"Top",["value"]:Xf.a.pz(h.marginTop),["getRulerPropertyBoundary"]:Fr.J5b("Top",0)},{["type"]:"Bottom",["value"]:Xf.a.pz(h.marginBottom),["getRulerPropertyBoundary"]:Fr.J5b("Bottom",1)}];this.Gv.rulerCanvasProps=b;return!0}Kdh(){this.cTe();rf.a.addHandler(this.E0,
bb.a.qx,this.Q1d)}rai(){this.E0&&(this.E0.classList.remove("ShowWACVerticalRulerContainer"),this.E0.classList.add("HideWACVerticalRulerContainer"),rf.a.removeHandler(this.E0,bb.a.qx,this.Q1d));this.RKa().then(b=>{b.dispose(this.HHa);return null})}Qs(){this.dqj();this.$Sa();this.I6a([1])}A1d(b,h){b=h.property;if(b===Lc.a.ew||b===Lc.a.marginTop||b===Lc.a.marginBottom)this.dqj(),this.$Sa(),this.I6a([1])}dqj(){var b=this.g5b();b&&(b=Bf.a.Mi(b.ew,1),this.HHa.style.height=Math.round(b*this.VM).toString()+
"px")}$Sa(){window.requestAnimationFrame(()=>{var b=this.jlf();if(b){const h=Je.a.getElementBounds(b);this.HHa.style.height=h.height.toString()+"px";b=this.CXl(b);this.HHa.style.marginTop=b+"px"}})}CXl(b){b=b.getBoundingClientRect().y;const h=this.JQe.getBoundingClientRect().y;return b-h}cTe(){if(!this.HHa&&!this.E0){this.I$g=document.createElement("div");this.E0.id=eu.d7j;this.E0.className=eu.c7j;this.E0.setAttribute(hf.a.pea,WordEditorIntl.WordEditorStrings.L_Ruler);this.E0.setAttribute(hf.a.wh,
hf.a.Qjh);this.E0.classList.add("HideWACVerticalRulerContainer");if(this.kli){var b=r.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");const h=r.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Xa.a.rfa(b,!h)&&Sys.UI.DomElement.addCssClass(this.E0,eu.$Uj)}this.J$g=document.createElement("div");this.HHa.className=eu.b7j;this.HHa.id=eu.e7j;this.E0.appendChild(this.HHa);b=document.getElementById($g.AppFrame.k8c);b.insertBefore(this.E0,b.firstChild)}}static kE(){return new eu(Ja.a.instance.Za("Common.IZoomManager"),
Ra.App.kk,r.AFrameworkApplication.ya,Vj.UISurfaces.J3h,Ja.a.instance.resolve("WordEditor.IRulerContextMenu"),Zq.a.instance,Ja.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=eu.Yrg?eu.Yrg:eu.Yrg=eu.kE()}}eu.d7j="WACVerticalRulerContainer";eu.c7j="WACVerticalRulerContainer";eu.e7j="WACVerticalRuler";eu.b7j="WACVerticalRuler";eu.$Uj="ModernUxWACVerticalRulerContainer";Object(m.a)(eu,"VerticalRuler",zz,[]);class qm{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.ywe=
this.Tye=!1;this.lO="RulerActor";this.O3g=null;this.yna=!1;this.PGj="ClearAllTabStopsFailed";this.c6g="ShowHideRulerFailed";this.EAe=null;this.Ryd=(Kb,Sb,Yb)=>{if(1===Yb)return 32;Kb=this.ga.processAction(Rc.a.NKb,2,null);32===Kb?(Yb=1,Sb=String.format("Clear all tab stops from ruler"),w.ULS.sendTraceTag(591213266,3014,50,Sb)):(Yb=0,Sb=String.format("Unable to clear all tab stop from ruler"),w.ULS.sendTraceTag(591213267,3014,15,Sb),qm.recordQosError(this.PGj,[qm.Pda],Sb));const Ac=new Map;Ac.set("Command",
"ClearAllTabStops");Ac.set("Source",this.lO);Ac.set("Response",Sb);Ta.Health.instance.recordKpiUsage(Ho.kpiName,Yb,Ho.S6,Ac);return Kb};this.kPc=(Kb,Sb,Yb)=>{if(1===Yb)switch(Kb){case Rc.a.cXe:case Rc.a.R6e:return 2;default:return 32}Sb=this.eKe.cRl();switch(Kb){case Rc.a.oBf:var Ac=1;break;case Rc.a.n_f:Ac=4;break;case Rc.a.o_e:Ac=3;break;default:return w.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Kb=new Nn.a(Sb,Ac,0,1);Kb=this.ga.Ub(Rc.a.t2c,2,Kb);32===Kb?(Yb=
1,Sb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",ww[Ac],Sb.toString()),w.ULS.sendTraceTag(591213269,3014,50,Sb)):(Yb=0,Sb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",ww[Ac],Sb.toString()),w.ULS.sendTraceTag(591213270,3014,15,Sb));Ac=new Map;Ac.set("Command","InsertCustomTabStopRuler");Ac.set("Source",this.lO);Ac.set("Response",Sb);Ta.Health.instance.recordKpiUsage(Ho.kpiName,Yb,Ho.S6,Ac);return Kb};this.XMb=(Kb,Sb,Yb,Ac,Sc)=>this.Tye||
1===Yb&&Ye.a.dga(Sb.Yj)?8:this.yna?this.QNc(Kb,Sb,Yb,Ac,Sc):this.wao(Sb,Yb);this.jOn=()=>{this.yna?w.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Oa.a.XMb,2)?(w.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),qm.recordQosError(this.c6g,[qm.Pda],"Ruler could not be enabled")):w.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.QNc=(Kb,Sb,
Yb)=>{if(1===Yb||!this.yna)return 32;this.yna=!1;this.fKe.Y0i(!1);this.U9a.dispose();this.xVd()&&this.p9e();this.gqj();w.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Kb=new Map;Kb.set("Command","HideRuler");Kb.set("Source",this.lO);Kb.set("Response","");Ta.Health.instance.recordKpiUsage(Ho.kpiName,1,Ho.S6,Kb);return 32};this.p6d=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return 32;Sc&&(Sc[ag.a.On]=this.yna);return 32};this.jcm=Kb=>{this.yna=Kb.result};this.XDb=()=>{this.Tye=!1};this.fai=()=>{this.Tye=
!0};this.ga=b;this.U9a=h;this.xQe=u;this.YPb=y;this.eKe=P;this.fKe=aa;qm.Pk=Pa;this.vJa=ta;this.YR=vb;this.vJa.rfh(this.fai);this.vJa.dvd(this.XDb)}initialize(){this.Wb();this.O3g=this.jOn;window.addEventListener("TurnRulerOnAction",this.O3g,!0);return this.fKe.tSl().continueWith(this.jcm,8)}Wb(){this.ga.pa(Oa.a.XMb,oc.a.view,this.XMb);this.ga.gb(Oa.a.p6d,oc.a.view,this.p6d,96);this.ga.pa(Rc.a.cXe,oc.a.view,this.kPc);this.ga.pa(Rc.a.o_e,oc.a.view,this.kPc);this.ga.pa(Rc.a.Ryd,oc.a.view,this.Ryd);
this.ga.pa(Rc.a.R6e,oc.a.view,this.kPc);this.ga.pa(Rc.a.QNc,oc.a.view,this.QNc);this.ga.pa(Rc.a.oBf,oc.a.view,this.kPc);this.ga.pa(Rc.a.n_f,oc.a.view,this.kPc);eD.a.Ld.addHandler(eD.a.s1d,this.mXc.bind(this));this.YR.Jxb(this.TNf)}vdi(){this.yna&&(this.U9a.fB(),this.U9a.renderRuler(),this.xVd()&&this.rXi())}rXi(){this.xQe.fB();this.xQe.renderRuler()}p9e(){this.xQe.dispose()}xVd(){return this.Epi()&&this.isPaginatedView()}Epi(){null==this.EAe&&null!=r.AFrameworkApplication.K&&(this.EAe=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",
!1));return this.EAe}RSa(){this.yna||Ja.a.instance.Za("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}zS(){this.vJa.QFn(this.fai);this.vJa.vWi(this.XDb);this.yna&&(this.U9a.dispose(),this.xVd()&&this.p9e())}gqj(){if(this.YPb){const b={};b[Ho.yDo]="ToggleButtonModel";this.YPb.xG(b)}}wao(b,h){if(!qm.Pk.i7(b.Yj))return w.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),qm.recordQosError(this.c6g,[qm.Pda],"Cannot show ruler. Word Section Node not found."),
8;if(1===h)return 32;this.yna=!0;this.fKe.Y0i(!0);this.vdi();this.gqj();w.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.lO);b.set("Response","");Ta.Health.instance.recordKpiUsage(Ho.kpiName,1,Ho.S6,b);return 32}isPaginatedView(){return 1===this.YR.Tv}mXc(b,h){switch(h.documentMode){case "View":this.yna&&(this.ga.processAction(Oa.a.XMb,2),this.ywe=!0);break;case "Edit":this.ywe&&(this.ga.processAction(Oa.a.XMb,2),this.ywe=!1)}}TNf(b,
h){if(qm.instance.yna&&qm.instance.Epi())switch(h.hbc){case 1:qm.instance.rXi();break;case 0:qm.instance.p9e()}}static recordQosError(b,h,u){const y=Object.assign(new Ya.a,{extendedProperties:new Map});u&&y.extendedProperties.set("exception",u);Ta.Health.instance.recordQosError(b,h,!1,!0,!1,!1,y)}static kE(){return new qm(r.AFrameworkApplication.ya,du.instance,eu.instance,Ra.App.xa,Ja.a.instance.resolve("WordEditor.IRulerContextMenu"),Ja.a.instance.Pa("WordEditor.Ruler.IRulerSettingInfo"),Ja.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
so.a.instance,Ja.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=qm.Zqg?qm.Zqg:qm.Zqg=qm.kE()}}qm.Pk=null;qm.Pda="RulerInteractionFailed";Object(m.a)(qm,"RulerActor",null,[]);class xC{constructor(b,h){this.hxc=null;this.z3a=u=>u.result?u.result.Value.toString():"";this.eFa=u=>{u.yo||u.Di?(w.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.hxc=!1):(u=u.result,""===u&&r.AFrameworkApplication.K&&
(u=r.AFrameworkApplication.K.lb("RulerDefaultOn")),this.hxc="true"===u.toLowerCase(),w.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.hxc};this.nv=b;this.YJ=h}tSl(){const b=new Jk.a;if(null==this.hxc){if(this.mni())return this.YJ.u4a(SB.a.A1c).CWRCo(this.z3a,0).CWRCo(this.eFa,8);b.Cg(!1)}else b.Cg(this.hxc);return b.task}y0(b){this.YJ.y0(SB.a.A1c,new $C.a(SB.a.A1c,b))}Y0i(b){this.mni()&&(this.nv.Vha("saveRulerIsEnabled",
b.toString()),w.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.y0(b)}mni(){const b=r.AFrameworkApplication.K.$("IsAnonymousUser");if(r.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)w.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(m.a)(xC,"RulerSettingInfo",null,[394]);class mE{constructor(){this.OOg=this.W=null}get name(){return"WordEditor.Ruler"}xc(b){this.W=b;w.ULS.sendTraceTag(578110851,3014,
50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",()=>new xC(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()});this.OOg=qm.instance.initialize();w.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}$m(){this.OOg.continueWith(()=>{qm.instance.vdi();
qm.instance.RSa()});w.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){qm.instance.zS();w.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(m.a)(mE,"PackageManager",null,[1,2]);class fD{constructor(){this.m7b=this.yZb=null}}Object(m.a)(fD,"CreatePickerCustomizationDictionaryOptions",null,[910]);class gD{}gD.Hg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(m.a)(gD,"InsertMediaM365DialogHtml",null,[]);class Dy{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he){var ce;this.K2=he;this.B8a=null;this.Whi=this.qvf=this.iid=!1;this.Ebj=Nd=>{if(Nd.rawEvent&&(Nd=Nd.rawEvent.data))try{const re=Sys.Serialization.JavaScriptSerializer.deserialize(Nd,!0),Xd=re.MessageId?re.MessageId.toString():null;re&&Xd&&(Xd===H.a.insertImage||Xd===H.a.Lsf)&&this.fvc.start(Xd===H.a.insertImage?this.h$a:this.ZOg)}catch(re){}};this.bxo=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;
this.ERg?Nd=CommonUIStrings.l_OneDriveName:""!==this.Dfd?Nd=this.Dfd:(Nd=CommonUIStrings.l_HostGeneric,w.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Vf[Qm.a.LabelText]=Nd;return 32};this.exo=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;if(!r.AFrameworkApplication.fwf())return Vf[Qm.a.Visible]=!1,32;this.ERg?Nd=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Dfd?Nd=String.format(CommonUIStrings.l_ChangePictureFromHost,
this.Dfd):(Nd=CommonUIStrings.l_ChangePictureFromHostGeneric,w.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Vf[Qm.a.LabelText]=Nd;return 32};this.cxo=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;r.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Vf[Qm.a.Visible]=!1);return 32};this.dxo=(Nd,re,Xd,vg,Vf)=>{if(1===Xd)return 32;r.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||
(Vf[Qm.a.Visible]=!1);return 32};this.sce=(Nd,re,Xd)=>{re=this.Arc.value.zea(re);if(1===Xd)return re&&this.g$a.Eqm?32:8;if(2!==Xd||!re)return 8;this.B8a=Ua.a.create();w.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Nd=this.LGl(Nd,this.B8a);Nd=this.mSe(Nd);Nd=this.Agd.mLc(Nd);Nd.correlationId=this.B8a;Nd.B7b=this.$Og;Nd.Kga=1;return this.qce(Nd,CommonUIStrings.L_PictureInsertTitle,this.h$a)};this.D$n=(Nd,re,Xd)=>{Nd=32===this.ga.Tf(re,Oa.a.insertHyperlink,
1,!1,null,null);if(1===Xd)return Nd&&this.g$a.fki?32:8;if(2!==Xd||!Nd)return 8;w.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.qce(this.YOg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.ZOg)};this.pbj=(Nd,re,Xd)=>{Nd=this.Arc.value.zea(re);if(1===Xd)return Nd&&this.g$a.ewf?32:8;if(2!==Xd||!Nd)return 8;w.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");
return this.qce(this.YOg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.h$a)};this.oce=(Nd,re,Xd)=>{re=this.Arc.value.zea(re);if(1===Xd)return re&&this.g$a.Gqm?32:8;if(2!==Xd||!re)return 8;w.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.B8a=Ua.a.create();Xd=r.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.rR.isFreemiumUpsellEnabled();Xd=this.iid?1:Xd?0:-1;Nd=this.pJl(Nd,this.B8a,Xd);Nd=this.Agd.mLc(Nd);
Nd.Hg=gD.Hg;Nd.correlationId=this.B8a;Nd.Kga=2;Nd.B7b=this.$Og;Nd.Osa=this.rR;Nd.Drj=Xd;return this.qce(Nd,CommonUIStrings.L_PictureInsertTitle,this.h$a)};this.tce=(Nd,re,Xd)=>{re=this.Arc.value.zea(re);Nd=Ja.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===Xd)return re&&!this.g$a.ewf&&Nd&&Nd.lyf()?32:8;if(2!==Xd||!re||!Nd)return 8;w.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.B8a=Ua.a.create();Xd=Dy.E$g;re=!1;r.AFrameworkApplication.gwf()&&
(re=this.Zql());const vg=new fD;vg.yZb=re;vg.m7b=!0;Xd=Nd.r4e(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,Xd,"Insert Media",1,vg);Nd.Iif(Xd).then(Vf=>{if(null!=Vf&&0<Vf.length){const kj=[];for(let zm=0;zm<Vf.length;zm++){const rm=Vf[zm][G.a.WLi],os=Vf[zm][G.a.VLi],Us={};Us.Extension=rm;Us.OriginalUrl=os;Us.caption=rm;kj.push(Us)}this.h$a.GOa=Oa.a.r2;this.h$a.j1a(kj)}});return 32};this.rce=(Nd,re,Xd)=>{var vg=this.Arc.value.zea(re);re=Ja.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===Xd)return vg&&re&&re.lyf()?32:8;if(2!==Xd||!vg||!re)return 8;Xd=Ja.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");null!=Xd&&Xd.Jgl(r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));w.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.B8a=Ua.a.create();Xd=Dy.E$g;vg=new fD;vg.yZb=!0;vg.m7b=!0;Xd=re.r4e(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,
!0,!1,!0,Xd,"InsertPictureFromMobile",3,vg);re.Iif(Xd).then(Vf=>{if(null!=Vf&&0<Vf.length){var kj=[];const zm=Nd===Oa.a.XQd;let rm=!1;const os=r.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");for(let Us=0;Us<Vf.length;Us++){const Bu=Vf[Us][G.a.WLi],DC=Vf[Us][G.a.VLi],Hy={};Hy.Extension=Bu;Hy.OriginalUrl=DC;Hy.caption=Bu;kj.push(Hy);rm||(rm=-1!==Hy.OriginalUrl.indexOf(os))}this.h$a.GOa=Oa.a.r2;this.h$a.j1a(kj);kj={};kj.InsertImageCount=Vf.length;rm&&Ub.c(zm?Oa.a.kgm:Oa.a.eCk,void 0,void 0,
void 0,void 0,void 0,kj)}});return 32};this.fvc=y;this.Bld=P;this.Agd=ta;this.YOg=Pa;this.A1=vb;this.ga=b;this.Arc=aa;this.ERg=Ac;this.Dfd=nd;this.g$a=u;this.h$a=Kb;this.ZOg=Sb;this.$Og=Ad;this.rR=Yb;this.Whi=null!==(ce=null===h||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DarkModeForHubble",!1))&&void 0!==ce?ce:!1;this.rR&&this.rR.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Nd=>w.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
Nd)).then(Nd=>{(this.iid=Nd)||this.rR.Wwa("MsoPremiumStockImages",()=>{this.iid=!0;w.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Wb(){(this.g$a.ewf||this.g$a.fki)&&this.g$a.Fqm&&this.Zjn();this.Ozn();this.Nzn();this.ga.gb(Oa.a.Pqh,oc.a.view,this.pbj,1284);this.ga.gb(Oa.a.xPi,oc.a.view,this.exo,1124);this.ga.gb(Oa.a.Vsf,oc.a.view,this.pbj,1284);this.ga.gb(Oa.a.TTf,oc.a.view,this.bxo,1124);this.ga.gb(Oa.a.sgm,oc.a.view,this.D$n,
1284)}Ozn(){this.ga.gb(Oa.a.insertOnlinePicture,oc.a.view,this.sce,1284);this.ga.gb(Oa.a.UQd,oc.a.view,this.oce,1284);this.ga.Xba("word_insertOnlinePictures",Oa.a.insertOnlinePicture,oc.a.view,this.sce,b=>{Ra.App.xa.IOb(b,Object(v.a)(new yn.a,(new yn.a).$fb,"getCommandById"))});this.ga.Xba("word_insertOnlinePictures",Oa.a.UQd,oc.a.view,this.oce,b=>{Ra.App.xa.IOb(b,Object(v.a)(new yn.a,(new yn.a).$fb,"getCommandById"))});this.ga.gb(Oa.a.x_e,oc.a.view,this.sce,1284);this.ga.gb(Oa.a.z_e,oc.a.view,this.tce,
1284);this.ga.Xba("word_insertOnlinePictures",Oa.a.z_e,oc.a.view,this.tce);this.ga.gb(Oa.a.A_e,oc.a.view,this.oce,1284);this.ga.gb(Oa.a.vPi,oc.a.view,this.cxo,1284);this.ga.gb(Oa.a.wPi,oc.a.view,this.dxo,1284);this.ga.Xba("word_insertOnlinePictures",Oa.a.x_e,oc.a.view,this.sce);this.ga.Xba("word_insertOnlinePictures",Oa.a.A_e,oc.a.view,this.oce);this.ga.gb(Oa.a.Xsf,oc.a.view,this.tce,1284);this.ga.Xba("word_insertOnlinePictures",Oa.a.Xsf,oc.a.view,this.tce,b=>{Ra.App.xa.IOb(b,Object(v.a)(new yn.a,
(new yn.a).$fb,"getCommandById"))})}Nzn(){r.AFrameworkApplication.gwf()&&(this.ga.gb(Oa.a.XQd,oc.a.view,this.rce,1284),this.ga.gb(Oa.a.y_e,oc.a.view,this.rce,1284),this.ga.Xba("mso_insertMobileDevicePictures",Oa.a.XQd,oc.a.view,this.rce,b=>{Ra.App.xa.IOb(b,Object(v.a)(new yn.a,(new yn.a).$fb,"getCommandById"))}),this.ga.Xba("mso_insertMobileDevicePictures",Oa.a.y_e,oc.a.view,this.rce,b=>{Ra.App.xa.IOb(b,Object(v.a)(new yn.a,(new yn.a).$fb,"getCommandById"))}))}Zjn(){r.AFrameworkApplication.ta.get_element().appendChild(this.Bld.e_a);
rf.a.addHandler(this.Bld.e_a.contentWindow,"message",this.Ebj);this.qvf=!0}LGl(b,h){let u=0;r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb&&5===r.AFrameworkApplication.ta.Pb.$n&&(u=12);const y=zl.a.sg(r.AFrameworkApplication.lcid);return String.format(r.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Oa.a.insertOnlinePicture?1:0,r.AFrameworkApplication.lcid,y?y.name:"en-us",r.AFrameworkApplication.buildVersion,h,u,r.AFrameworkApplication.K.lb("UserId"))}qce(b,h,
u){try{return b.pce(h,u),w.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(y){return w.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",y.toString()),this.Kp(Xm.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}pJl(b,h,u){if(Oa.a.UQd===b)return b=this.A1.cnh(r.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),
h.toString(),1,u),this.mSe(b);b=this.A1.cnh(r.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),h.toString(),0,u);return this.mSe(b)}Kp(b,h,u){const y=new Gh.StandardDialog(!0);y.Qt=r.AFrameworkApplication.Qaa;y.Ed=0;y.Ue(1,CommonUIStrings.l_DialogClose);y.py(b,h,u,()=>{})}Zql(){const b=Ja.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.Wul():!1}dispose(){this.qvf&&this.Bld.e_a.contentWindow&&(rf.a.removeHandler(this.Bld.e_a.contentWindow,"message",this.Ebj),this.qvf=
!1)}mSe(b){return this.Whi&&this.K2&&this.K2.jK?(b=new fa.QueryStringBuilder(b),b.Pe("theme","4"),b.toString()):b}}Dy.E$g=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(Dy,"InsertMediaActor",null,[9]);var Qo=c(943);class hD extends Qo.a{constructor(b,h){super(b,Fa.a.getOrigin(h))}qq(b,h){this.isEnabled()&&this.GXa(this.c6a)&&(this.Jv(b),this.oC(b,h))}}Object(m.a)(hD,"InsertMediaCrossDocumentMessenger",Qo.a,[495,66,9]);class nE{getInstance(b,h){return new hD(b,h)}}Object(m.a)(nE,"InsertMediaCrossDocumentMessengerFactory",
null,[476]);var SE=c(769);class yC{}yC.Hg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(yC,"InsertMediaDialogHtml",null,[]);var Rx;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(Rx||(Rx={}));Object(m.b)("HubbleAction",Rx);var Tp;(function(b){b[b.unknown=0]="unknown";b[b.bing=
1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(Tp||(Tp={}));Object(m.b)("InsertMediaProviders",Tp);class lC extends ff.a{constructor(b,h,u,y=null,P=!1){super(!1,!1,P);this.NG=null;this.Lpc=!1;this.zUc=this.p_=null;this.lZe="KeepFocusDiv";this.yxd="KeepFocusStartDiv";this.correlationId=null;this.Kga=0;this.Osa=this.B7b=null;this.Drj=0;this.kCe=null;this.j5m=()=>{this.p_&&(this.p_.style.visibility="visible",window.setTimeout(()=>{if(this.Gk){const aa=
this.Gk.getElementById(this.yxd);aa&&aa.focus()}},0))};this.gba=aa=>{aa.keyCode===Sys.UI.Key.tab&&(aa.target.id!==this.lZe||aa.shiftKey?aa.target.id===this.yxd&&aa.shiftKey&&(aa.preventDefault(),this.Gk.getElementById(this.lZe).focus()):(aa.preventDefault(),this.Gk.getElementById(this.yxd).focus()))};this.XCi=()=>{w.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.cBb(this.nYa);this.Dmb(1)};this.jEi=()=>{this.NG&&(w.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),
this.NG.sendMessage(H.a.yWn,{["CustomHeaders"]:""}))};this.mEi=()=>{this.NG&&(w.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.NG.sendMessage(H.a.z1n,{["SessionId"]:r.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.iEi=()=>{this.NG&&(w.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.NG.sendMessage(H.a.FVn,{["CID"]:""}))};this.E5m=()=>{this.Osa&&(w.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.Osa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Bgd=b;this.XRb="";this.A1=u;this.Qda=[];this.Pmd=h;this.Hg=y||yC.Hg;this.mg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}pce(b,h){this.XRb=b;this.Lpc=!1;this.showDialog(this.XRb,null);this.p_=this.M4b(this.mj("insertmediaframe"));if(!this.p_)throw this.cBb(this.nYa),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.yxd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.p_.parentNode.insertBefore(b,this.p_.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.lZe);b.setAttribute("tabindex","0");this.p_.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.f8e,
"keydown",this.gba);this.p_.src=this.Bgd;this.p_.style.width="100%";this.p_.style.height="100%";this.p_.frameBorder="0";r.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&ba.a.kj?(this.p_.style.visibility="hidden",this.zUc=this.j5m,rf.a.addHandler(this.p_,"load",this.zUc)):this.p_.style.visibility="visible";this.M4b(this.mj("WACDialogButtonPanel")).style.display="none";this.M4b(this.mj("WACDialogTitleText")).style.display="none";2===this.Kga&&(this.M4b(this.mj("WACDialogTitlePanel")).style.display=
"none",this.M4b(this.mj("WACDialogBodyPanel")).style.padding="0");ub.FocusManager.instance().Ks().scope.BK=!0;this.NG=this.Pmd.getInstance(this.p_.contentWindow,this.Bgd);this.NG.qq(H.a.Ych,u=>{this.mCi(u,Object(v.a)(h,h.j1a,"insertMediaCallback"))});this.NG.qq(H.a.insert,u=>{this.d1d(u,Object(v.a)(h,h.j1a,"insertMediaCallback"))});this.NG.qq(H.a.pbk,u=>{this.D6m(u)});this.NG.qq(H.a.AVh,this.jEi);this.NG.qq(H.a.getSessionId,this.mEi);this.NG.qq(H.a.oTh,this.iEi);this.NG.qq(H.a.Qxd,this.XCi);2!==this.Kga||
this.Drj||(this.NG.qq(H.a.fCm,this.E5m),this.kCe=this.Osa.Wwa("MsoPremiumStockImages",u=>{w.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.NG.sendMessage(H.a.dCo,{["LicenseTier"]:u.toString()})}));this.Dmb(3)}dispose(){this.Osa&&this.kCe&&this.Osa.oec("MsoPremiumStockImages",this.kCe);this.NG&&(this.NG.dispose(),this.NG=null);this.zUc&&(rf.a.removeHandler(this.p_,"load",this.zUc),this.zUc=null);super.dispose()}mCi(b,h){w.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.A1.Pen(b))this.Qda.push(b),this.Lpc&&(h(this.Qda),this.Lpc=!1)}Kp(){const b=new Gh.StandardDialog(!0);b.Qt=r.AFrameworkApplication.Qaa;b.Ed=0;b.Ue(1,CommonUIStrings.l_DialogOk);b.xv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Dmb(b){var h=RegExp("hubble","gi");if(this.B7b&&0<this.B7b.search(h)&&this.correlationId){h=r.AFrameworkApplication.sessionStartInfoSettings;var u={};u.InsertedFiles=this.Qda.length;
u.MediaDetails=this.Qda;u.DialogResult=Rx[b];u.DialogMode=this.okf();u.CorrelationId="{"+this.correlationId.toString()+"}";u.Platform="Wac";u.Provider=Tp[this.Kga]||"Unknown";u.AudienceGroup=h&&"AudienceGroup"in h?h.AudienceGroup.toString():"Unknown";u.Ring=h&&"Ring"in h?h.Ring.toString():"Unknown";u.AppId=2;u.Build=r.AFrameworkApplication.buildVersion;u.Locale=zl.a.sg(r.AFrameworkApplication.lcid).name;this.dkn().send(JSON.stringify(u))}2===this.Kga&&(u=r.AFrameworkApplication.K.lb("InsertMediaDialogAriaTenantNameSpace"))&&
""!==u&&(h=[],h.push(Object.assign(new ca.a,{name:"InsertedFiles",int64:this.Qda.length})),h.push(Object.assign(new ca.a,{name:"MediaDetails",string:JSON.stringify(this.Qda)})),h.push(Object.assign(new ca.a,{name:"DialogResult",string:Rx[b]})),h.push(Object.assign(new ca.a,{name:"DialogMode",string:this.okf()})),h.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()})),h.push(Object.assign(new ca.a,{name:"Provider",string:Tp[this.Kga]||"Unknown"})),ha.a.sendTelemetryEvent(Object.assign(new ia.a,
{name:String.format("{0}.{1}",u,this.telemetryEventName),dataFields:h})))}okf(){return 3===this.Kga?"Icons":5===this.Kga?"ExternalContent":"Images"}M4b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}dkn(){const b=new XMLHttpRequest;b.open("POST",this.B7b,!0);b.setRequestHeader("Content-Type","");return b}d1d(b,h){w.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.cBb(this.nYa);h?this.Qda&&50<this.Qda.length?(this.Kp(),
this.Dmb(0),w.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Qda.length,Tp[this.Kga])):this.Qda&&0<this.Qda.length?(h(this.Qda),this.Dmb(0),w.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Qda.length,Tp[this.Kga])):(w.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Lpc=!0,h(this.Qda),this.Dmb(2)):this.Dmb(2)}D6m(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,
w.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ha.a.sendOtelEvent(Object.assign(new SE.a,{otelEvent:b})))}}Object(m.a)(lC,"InsertMediaDialog",ff.a,[477,9]);class iD{constructor(b,h){this.Qxe=b;this.A1=h}mLc(b,h=!1){return new lC(b,this.Qxe,this.A1,yC.Hg,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(iD,"InsertMediaDialogFactory",null,[469]);class oE{constructor(b,h,u){this.Ygi=!1;this.correlationId=null;this.Kga=0;this.B7b=null;this.POj=b;this.qzc=[];this.Efd=
h;this.x7g=u.split(";")}pce(b,h){Array.clear(this.qzc);b=this.POj.value;b.GXa(this.Efd);b.Jv(h.ZNc);this.Ygi||(b.oC(h.ZNc,u=>{this.d1d(u,h)}),this.Ygi=!0);w.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.QBh,{["FileExtensionFilterList"]:this.x7g})}zdk(b){Array.contains(this.qzc,b)||this.qzc.push(b)}d1d(b,h){w.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.IKi(b);const u=[];
for(let y=0;y<b.length;y++){const P=b[y];h.SSd(P,this.x7g)?u.push(P):this.zdk(h.o3h(P))}u&&u.length?h.j1a(u):w.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.qzc.length&&(h=this.qzc.join(", "),w.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.abo(h))}abo(b){const h=new Gh.StandardDialog;h.Ed=0;h.GU(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
b),null)}dispose(){}}Object(m.a)(oE,"InsertMediaFromHostManager",null,[477,9]);class pE{constructor(b){this.TPj=b}mLc(){throw Error.notImplemented();}getInstance(){return this.TPj}}Object(m.a)(pE,"InsertMediaFromHostManagerFactory",null,[468,469]);class tB{constructor(){this.e_a=document.createElement("iframe");this.e_a.src="about:blank";this.e_a.style.visibility="hidden";this.e_a.style.position="absolute";this.e_a.style.zIndex="-100"}}Object(m.a)(tB,"InsertMediaFromHostOneDriveHostFrame",null,[466]);
class WB extends Qo.a{constructor(b,h){super(b,"*"===h?h:Fa.a.getOrigin(h));this.Zbh(H.a.insertImage);this.Zbh(H.a.Lsf)}K8d(){}}Object(m.a)(WB,"InsertMediaFromOneDriveCrossDocumentMessenger",Qo.a,[465,66,9]);class Pv{}Object(m.a)(Pv,"OnlineMediaSearchResult",null,[]);class Ts{cnh(b,h,u,y){const P=zl.a.sg(r.AFrameworkApplication.lcid).name,aa=r.AFrameworkApplication.buildVersion,ta=A.a.uW(r.AFrameworkApplication.K.lb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Pa=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;r.AFrameworkApplication.Ce("ShIns226;ShIns226cf");return String.format(b,r.AFrameworkApplication.lcid,P,aa,h,Ts.Zke,ta,y,u,Pa)}return String.format(b,r.AFrameworkApplication.lcid,P,aa,h,Ts.Zke,ta,y,u)}Pen(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new Pv,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",
ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||""})}Qen(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let y=0;y<b.length;y++){var u=b[y];u&&(u=Object.assign(new Pv,{Type:u.Extension||"",OriginalUrl:u.SourceUrl||"",Caption:u.caption,Height:u.Height||0,Width:u.Width||0}),h.push(u))}return h}FPf(b){const h=[];for(let y=
0;y<b.data.files.length;y++){var u=b.data.files[y];u&&(u=Object.assign(new Pv,{ContentType:u.itemType||"",Type:u.extension||"",OriginalUrl:u.urls&&u.urls.open?u.urls.open:"",Height:u.photo?u.photo.height:0,Width:u.photo?u.photo.width:0}),h.push(u))}return h}SSd(b,h){if(!b)return!1;for(let u=0;u<h.length;u++)if(0<=b.toLowerCase().indexOf(h[u]))return!0;return!1}Ujn(b){let h="";if(b)for(let u=0;u<b.length;u++){const y=b[u];y&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',y.OriginalUrl,
y.Width,y.Height))}return h}}Ts.Zke=0;Object(m.a)(Ts,"InsertMediaHelper",null,[464]);class jD{constructor(b,h,u,y,P){this.Eqm=b;this.ewf=h;this.fki=u;this.Fqm=y;this.Gqm=P}}Object(m.a)(jD,"InsertMediaSettingsManager",null,[]);class Cs{constructor(b){this.Lrc=Oa.a.insertHyperlink;this.ga=b}get GOa(){return this.Lrc}set GOa(b){this.Lrc=b}j1a(b){try{w.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Ub(this.GOa,
2,b[h]);w.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){w.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(m.a)(Cs,"InsertOneDriveFileHandler",null,[463]);class uB extends Cs{constructor(b){super(b)}get QBh(){return H.a.Lsf}get ZNc(){return H.a.Ofm}IKi(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}o3h(){Ab.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}SSd(){return!0}HOi(b,h,u){b=u(b);b.length&&(u={},u.Items=b,h.sendMessage(this.ZNc,u))}KKi(b){const h=[];for(let u=0;u<b.data.files.length;u++){const y=b.data.files[u];if(y){const P={};P.DisplayText=String.format("{0}{1}",y.name,y.extension);P.Url=this.Ekl([y.urls.viewInBrowser,y.urls.open,y.urls.download]);h.push(P)}}return h}Ekl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];w.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(m.a)(uB,
"InsertOneDriveFileHelper",Cs,[462,463]);class XB{constructor(b,h,u){this.Lrc=Oa.a.r2;this.Lp=null;this.ga=b;this.A1=h;this.Wda=u}get Bc(){return this.ga}get nu(){return this.Lp||(this.Lp=Ja.a.instance.resolve("Common.Utils.IAriaNotifier"))}get GOa(){return this.Lrc}set GOa(b){this.Lrc=b}j1a(b){try{w.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.A1.Ujn(b);let u=2;if(h&&0<h.length){const y=new uh.DictionaryPropertySet;
y.setValue(ld.a.PQ,h);y.setValue(ld.a.B7,!0);if(this.Wda){const P=this.Wda.F4c();P.MZb("insertOnlineImage");y.setValue(ld.a.hta,P)}u=this.ga.Ub(this.GOa,2,y)}w.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===u,""===h)}catch(h){w.ULS.oJ(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(m.a)(XB,"InsertOnlineImageHandler",null,[463]);class EA extends XB{constructor(b,
h,u=null){super(b,h,u)}get QBh(){return H.a.insertImage}get ZNc(){return H.a.$fm}IKi(b){return this.A1.Qen(b)}o3h(b){return b.Type}SSd(b,h){return this.A1.SSd(b.Type,h)}KKi(b){return this.A1.FPf(b)}HOi(b,h,u){u=u(b);if(u.length){b=[];for(let y=0;y<u.length;y++){const P=u[y],aa={};aa.Extension=P.Type;aa.SourceUrl=P.OriginalUrl;aa.caption=P.Type;aa.SourceUrl=P.OriginalUrl;aa.Width=P.Width;aa.Height=P.Height;b.push(aa)}u={};u.Items=b;h.sendMessage(this.ZNc,u)}}}Object(m.a)(EA,"InsertOnlineImageHelper",
XB,[462,463]);class kD{constructor(b,h){this.Hrb=b;this.Pmd=h}start(b){this.Hrb.start({mode:"open",select:"multi",lightbox:"white"},(h,u)=>{this.processResponse(h,u,b)})}processResponse(b,h,u){w.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.Pmd.getInstance(window.frames[0].parent,window.document.URL),u.HOi(h,b,Object(v.a)(u,u.KKi,"parseOneDriveV5Response"))):
w.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(m.a)(kD,"OneDriveFilePickerHelperV5",null,[393]);class Az{constructor(){this.zgd=this.W=null}get name(){return"Box4.Media"}xc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new tB).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const h=new jD(Boolean.parse(r.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||
"false"),r.AFrameworkApplication.fwf(),!1,r.AFrameworkApplication.k5f(),r.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new kD(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new Dy(r.AFrameworkApplication.ya,r.AFrameworkApplication.K,
h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Zf.a(()=>Ja.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),r.AFrameworkApplication.K9b,
r.AFrameworkApplication.Qna,r.AFrameworkApplication.j9l,r.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new iD(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new pE(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new oE(new Zf.a(()=>{if(r.AFrameworkApplication.k5f()){var u=Ja.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").e_a;u=new WB(u.contentWindow,"*")}else u=r.AFrameworkApplication.eX;return u}),r.AFrameworkApplication.k5f()?Fa.a.getOrigin(window.document.URL):Fa.a.getOrigin(r.AFrameworkApplication.DJb),r.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(nE,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(Ts,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new EA(r.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new uB(r.AFrameworkApplication.ya)).singleInstance()}init(){this.zgd=this.W.resolve("Box4.Media.InsertMediaActor");this.zgd.Wb()}dispose(){this.zgd&&this.zgd.dispose()}}Object(m.a)(Az,"MediaPackage",null,
[1,2]);var lD=c(283);class Ds{constructor(){this.CNn="getAddinShortcutsPreference";this.DNn="saveAddinShortcutsPreference";this.ENn="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Brl=6E4;this.p_d=this.Bla=this.M8=null}u3h(b){return String.format(this.ENn,r.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,r.AFrameworkApplication.Gm)}executeRequest(b,h,u,y,P=null){return Ds.yP.eZb(b,h,P,null,u,y,!1,null,this.Brl)}saveSetting(b,h,u,y,P){return this.Z0i(b,h,u,null,y,
P)}startBatchUpdateScope(){this.p_d=[]}saveShortcutInfoArrayBatch(b,h,u){this.KPn(u,b,h)}KPn(b,h,u){const y={action:"",addinId:"",ownerType:0};y.timestamp=(new Date).toUTCString();const P=this.getShortcutInfoArray(h.toString(),u.toString());b?(y.shortcutInfoArray=b,this.lSe(h,u,b)):P&&(y.shortcutInfoArray=P);b={};b[h.toString()]=y;h=new lD.a(u.toString(),b);this.p_d.push(h)}commitBatchUpdateScope(){return this.K3c()?this.MPn().then(()=>{this.E_b();return Promise.resolve(!0)}):this.OPn().then(()=>
{this.E_b();return Promise.resolve(!0)})}MPn(){return this.getSetting().then(b=>{let h=null;if(b&&!({Uv:h}=z.d(b)).returnValue)return w.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const u of this.p_d){(b=h[u.key])||(b={});const y=u.value;for(const P of Ma.a.bO(y))b[P]=y[P];h[u.key]=b}this.M8=h;try{return localStorage.setItem("AddinShortcutPreferenceData",z.c(h)),Promise.resolve(!0)}catch(u){return w.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",u),Promise.resolve(!1)}})}OPn(){return this.tUn().then(b=>this.W9d(b))}tUn(){return this.ymf().then(b=>{let h=null;b&&(({Uv:h}=z.d(b)).returnValue||w.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const u of this.p_d){(b=h[u.key])||(b={});const y=u.value;for(const P of Ma.a.bO(y))b[P]=y[P];h[u.key]=b}this.M8=h;return z.c(h)})}saveShortcutInfoArray(b,h,u){return this.Z0i(0,
"","",u,b,h)}Z0i(b,h,u,y,P,aa){const ta=this.K3c(),Pa={};Pa.action=u;Pa.addinId=h;Pa.ownerType=b;Pa.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(P.toString(),aa.toString());0===b&&y?(Pa.shortcutInfoArray=y,this.lSe(P,aa,y)):h&&(Pa.shortcutInfoArray=h);b={};b[P.toString()]=Pa;P=new lD.a(aa.toString(),b);return ta?this.LPn(P):this.NPn(P)}LPn(b){return this.getSetting().then(h=>{let u=null;if(h&&!({Uv:u}=z.d(h)).returnValue)return w.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);u||(u={});u[b.key]=b.value;this.M8=u;try{return localStorage.setItem("AddinShortcutPreferenceData",z.c(u)),Promise.resolve(!0)}catch(y){return w.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",y),Promise.resolve(!1)}})}NPn(b){return this.sUn(b).then(h=>this.W9d(h))}sUn(b){return this.ymf().then(h=>{let u=null;h&&(({Uv:u}=z.d(h)).returnValue||w.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
u||(u={});u[b.key]=b.value;this.M8=u;return z.c(u)})}saveSettings(b){this.M8=z.a(b);this.E_b();return this.K3c()?this.b1i(b):this.W9d(b)}b1i(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return w.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}W9d(b){const h={};h.Wac=b;const u=z.c(h);return new Promise(y=>{try{if(void 0===u||null===u||!u.length||1E6<=u.length)y(!1);else{var P=this.executeRequest(this.u3h(this.DNn),
2,"SaveAddinShortcutsPreferenceRequest","38",u);P.continueWith(()=>{if(P.yo||P.Di)w.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),y(!1);else{var aa=P.result;void 0!==aa.args&&null!==aa.args&&void 0!==aa.args.data&&null!==aa.args.data&&aa.args.data.jf===qa.a.tB?y(!0):y(!1)}})}}catch(aa){w.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",aa.toString()),y(!1)}})}getSetting(){const b=this.K3c();return this.M8?Promise.resolve(z.c(this.M8)):
b?this.MTl():this.ymf()}K3c(){const b=r.AFrameworkApplication.K.$("IsAnonymousUser"),h=r.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}MTl(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return w.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}ymf(){return new Promise((b,h)=>{try{const u=this.executeRequest(this.u3h(this.CNn),1,"GetSettingRequest","37");u.continueWith(()=>{if(u.yo||
u.Di)w.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let P="";var y=u.result;y&&y.args&&y.args.data?y.args.data.jf!==qa.a.tB?w.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",y.args.data.jf):y.args.data.Ae?(y=z.a(y.args.data.Ae),y.Wac&&(P=y.Wac)):w.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):w.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(P)}})}catch(u){w.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",u.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.K3c(),u=this;return this.getSetting().then(y=>{let P=null;y&&(P=z.a(y));if(!P)return w.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const aa of Ma.a.bO(P)){y=P[aa.toString()];for(const ta of Ma.a.bO(y)){const Pa=y[ta];if(Pa.addinId===b)delete y[ta.toString()];else if(0===Pa.ownerType&&
Pa.shortcutInfoArray){const vb=Pa.shortcutInfoArray,Kb=new ob.a;for(let Sb=0;Sb<vb.length;++Sb)vb[Sb].addinId!==b&&Kb.add(vb[Sb]);Pa.shortcutInfoArray=Kb.toArray()}}Ma.a.count(y)||delete y[aa]}u.M8=P;u.aDn(b);return h?u.b1i(z.c(P)):u.W9d(z.c(P))})}E_b(){if(this.M8){this.Bla=null;const u=this.M8;for(let y in u){var b=y;const P=u[y];for(let aa in P){var h=aa;const ta=P[aa];ta.shortcutInfoArray&&this.lSe(parseInt(h),parseInt(b),ta.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let h=null;if(b&&!({Uv:h}=z.d(b)).returnValue)return w.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.M8=h;this.E_b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,u){return this.M8&&(u=this.M8[u])&&(h=u[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.M8&&(h=this.M8[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
h,u){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),u)}setShortcutInfoArray(b,h,u){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),u).then(()=>{this.E_b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Bla)return Promise.resolve(!0);var u=this.Bla[b];if(!u)return Promise.resolve(!0);var y=u[h];u=y.modifiers;y=y.keyCode;const P=this.getShortcutInfoArray(u.toString(),y.toString());if(!P||!P.length)return Promise.resolve(!0);let aa=0;for(const ta of P){if(ta.addinId===
b&&ta.action===h)break;++aa}if(aa>=P.length)return Promise.resolve(!0);P.splice(aa,1);return this.saveShortcutInfoArray(u,y,P).then(()=>{this.E_b();return Promise.resolve(!0)})}lSe(b,h,u){this.Bla||(this.Bla={});for(const y of u){u=y.addinId;const P=y.action;let aa=this.Bla[u];aa||(aa={});const ta={};ta.modifiers=b;ta.keyCode=h;aa[P]=ta;this.Bla[u]=aa}}aDn(b){b in this.Bla&&delete this.Bla[b]}isActionCustomized(b,h){return this.Bla&&(b=this.Bla[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,
h){return this.Bla&&(b=this.Bla[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.M8}static instance(){Ds.gUe||(w.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Ds.gUe=new Ds,Ds.yP=r.AFrameworkApplication.Ve);return Ds.gUe}}Ds.gUe=null;Ds.yP=null;Object(m.a)(Ds,"AddinShortcutsPreferenceSettingHelper",null,[]);class YB{constructor(b,h){this.Ibd=null;new ob.a;this.PQg=!0;this.Yed=b;this.lMg=h}wTe(b){this.lMg.addHandler("GoalChangedEvent",b)}qZm(){this.lMg.raiseEvent("GoalChangedEvent")}Duf(b,
h){return this.Ibd&&this.PQg?b in this.Ibd?this.Ibd[b]:"Formality"===h&&this.Yed.omf().formality?!1:!0:!0}mWn(b,h){h===this.Yed.omf().formality&&(this.Ibd=b,this.qZm())}Fxo(b){this.PQg=b}}Object(m.a)(YB,"GoalChangeSource",null,[388,389,390]);var $u=c(966),Ey=c(912),mD=c(704);class as{constructor(b,h,u,y,P,aa){this.pJa=h;this.sza=u;this.wf=b;this.TG=y;this.hg=P;this.aOj=aa;this.sza.lFb()&&this.initialize()}initialize(){return this.TG.nm().then(()=>{this.wf.mb(this,$u.a.getTypeName());this.wf.addHandler(this,
Ey.a.getTypeName())}).catch(b=>{this.hg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}mD(b,h){if(h===pk.a.getTypeName()||h===mD.a.getTypeName())if(!b||!b.content)this.hg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(Ap.a.getTypeNameFor(b.content)===$u.a.getTypeName()||Ap.a.getTypeNameFor(b.content)===Ey.a.getTypeName())if(Ap.a.getTypeNameFor(b.content)===$u.a.getTypeName()){var u=b.content;this.hg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",u.critiqueConfiguration.formalityGoal);this.pJa.mWn(u.critiqueConfiguration.mapping,u.critiqueConfiguration.formalityGoal)}else if(Ap.a.getTypeNameFor(b.content)===Ey.a.getTypeName())if(b=b.content,b.features){for(u of b.features)if("Goals"===u.featureName){this.aOj.Fxo(!!u.supportType);return}this.hg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.hg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(m.a)(as,"GoalsAnnotationHandler",null,[220]);class zC{constructor(b){this.Ma=b}lFb(){return this.Ma.$("EditorGoalsEnabled")}}Object(m.a)(zC,"GoalsGate",null,[387]);var qE=c(1159),ZB=c(1160),$B=c(869);class yf{}yf.PCd=0;yf.UCd="1.0";yf.settingType="Goals";Object(m.a)(yf,"GoalsConstants",null,[]);var mC=c(1038);class vB{constructor(b,h,u,y,P){this.NVb=null;this.Gji=!1;this.n0g=b;this.$ed=h;this.hg=u;this.sza=y;this.Dve=P;this.sza.lFb()?this.wtn():this.sza.lFb()&&this.b1f(yf.PCd,yf.UCd)}wtn(){new Promise(b=>
{this.n0g.I1h(yf.settingType,h=>{this.xtn(h)?(this.b1f(this.NVb.formality,this.NVb.version),b(this.NVb)):(this.b1f(yf.PCd,yf.UCd),b(null))})})}xtn(b){this.Gji=!0;if(!b||!b.cnb)return this.hg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.cnb.properties;var h=b.getValue(Lc.a.Kei);h=parseInt(h);b=b.getValue(Lc.a.gRd);if(!this.$ed.qeg(b))return this.hg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.NVb=
b=Object.assign(new mC.a,{formality:h,version:b});this.hg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}b1f(b,h){b=Object.assign(new $B.a,{formality:b,version:h});this.Dve.z3i(b)}oKo(b){if(this.$ed.qeg(b.version)){var h=qE.a.yTk(b.version,b.formality.toString());this.n0g.wdh(Object.assign(new ZB.a,{cnb:h,settingType:yf.settingType}))?this.NVb=b:this.hg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.hg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}FZh(){this.Gji||this.hg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.NVb}}Object(m.a)(vB,"GoalsPersistenceHandler",null,[386]);class nD{constructor(b,h,u,y){this.hg=b;this.Eve=h;this.$ed=u;this.sza=y;this.Zed=Object.assign(new mC.a,{formality:yf.PCd,version:yf.UCd});this.BLe=this.sza.lFb()}omf(){this.BLe&&(this.BLe=!1,this.Eve.FZh()&&(this.Zed=this.Eve.FZh()));
return this.Zed}h1n(b){this.BLe=!1;this.$ed.qeg(b.version)?(this.sza.lFb()&&this.Eve.oKo(b),this.Zed=b):(this.hg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.Zed=Object.assign(new mC.a,{formality:yf.PCd,version:yf.UCd}))}}Object(m.a)(nD,"GoalsProvider",null,[384,385]);class aC{constructor(b,h,u,y){this.wf=b;this.TG=h;this.Q4=u;this.hg=y}z3i(b){b=Object.assign(new pk.a,{parentPath:["Signal",$B.a.getTypeName()],items:[Object.assign(new us.a,{body:b})]});
this.XEd(b)}XEd(b){this.TG.nm().then(()=>{this.KRe(b)}).catch(h=>{this.hg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}KRe(b){return this.wf.activateAnnotation($u.a.getTypeName(),aC.BZb).then(()=>{this.Q4.getAugLoopRuntimeManager().submitOperation(Object.assign(new Lr.a,{operation:b}))}).catch(h=>{this.hg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}aC.BZb="GoalSelected";Object(m.a)(aC,"GoalsSignalSender",null,[383]);class Qv{constructor(){Qv.wQe=
new RegExp(Qv.Z6j)}qeg(b){return!!b.match(Qv.wQe)&&1===b.match(Qv.wQe).length}}Qv.Z6j="[0-9]+[.]?[0-9]*";Qv.wQe=null;Object(m.a)(Qv,"GoalsValidator",null,[382]);class oD{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}xc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new Qv).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new zC(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new nD(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new YB(this.W.resolve("WordEditor.Goals.IGoalReader"),new ie.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new vB(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new as(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new aC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){K.a.instance.Kc(new oD)}}
Object(m.a)(oD,"WordEditorGoalsPackage",null,[1,2]);var AC=c(750),pD=c(430);class qD{constructor(){this.annotation=null;this.languages=new bm.a(la.a.Ri())}}Object(m.a)(qD,"CritiqueCountWrapper",null,[]);class Fy{constructor(){this.Aqa=new Tb.a}qJd(){return this.Aqa}sci(b,h,u,y){if(this.Aqa.ub(u)){this.Aqa.J(u).annotation.count+=h;u=this.Aqa.J(u).languages;for(var P of y)u.add(P)}else P=T.a.create().toString(),b=Object.assign(new pD.a,{id:P,categoryName:b,count:h}),this.Aqa.add(u,Object.assign(new qD,
{annotation:b,languages:y}))}}Fy.Gi=389;Object(m.a)(Fy,"BaseCritiquesByTypeCounter",null,[360]);class rE extends Fy{constructor(b){super();this.tvb=new Ea.a;this.oqe=new Ea.a;this.std=b}M1l(b){const h=b.annotation;if(h&&AC.a(Ap.a.getTypeNameFor(h.content))){const u=h.content;if(b.opType===pk.a.getTypeName()){this.std.cFn(h.parentPath,u);b=u.M_.state;if(60!==b&&70!==b)return this.tvb.contains(h.id)&&this.tvb.remove(h.id),this.Zam(h.id,u),!0;this.tvb.add(h.id)}else if(b.opType===Eq.a.getTypeName())if(this.tvb.contains(h.id))this.tvb.remove(h.id);
else return this.QCh(u.typeId,h.id)}return!1}L1l(b){if((b=b.annotation)&&AC.a(Ap.a.getTypeNameFor(b.content))){const h=b.content,u=h.M_.state;if((60===u||70===u)&&!this.tvb.contains(b.id))return this.tvb.add(b.id),this.QCh(h.typeId,b.id)}return!1}Zam(b,h){this.oqe.add(b);b=new bm.a(la.a.Ri());h.language&&b.add(h.language);this.sci(h.categoryName,1,h.typeId,b)}QCh(b,h){if(!this.oqe.contains(h))return!1;if(!this.Aqa.ub(b))return w.ULS.sendTraceTag(589866503,Fy.Gi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Aqa.J(b).annotation.count)return w.ULS.sendTraceTag(589866504,Fy.Gi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.oqe.remove(h);this.Aqa.J(b).annotation.count--;return!0}}Object(m.a)(rE,"AlCritiquesByTypeCounter",Fy,[489,360]);var TE=c(982);class sE extends Vt.a{constructor(b,h,u,y,P,aa,ta,Pa,vb){var Kb;super();this.wf=b;this.std=h;this.ime=
u;this.wHg=y;this.pJa=P;this.Kra=aa;this.Lh=ta;this.L9=this.PFg=!1;this.VEe=new Tb.a;this.F3m=(Sb,Yb)=>{this.std.K2l(Yb)&&(this.L9=!0,this.OX())};this.G0m=(Sb,Yb)=>{this.ime.M1l(Yb)&&this.LLb()};this.CDi=()=>{this.LLb()};this.cKf=(Sb,Yb)=>{this.ime.L1l(Yb)&&this.LLb()};this.Bkb=()=>{this.LLb()};this.LLb=()=>{let Sb=!1;this.Lh.Sd(()=>{var Yb=this.Oyl();const Ac=new ob.a;for(const Sc of Yb)Yb=Object.assign(new TE.a,{id:Sc.id,parentPath:Fk.a.BAb,content:Sc,annotationType:Ap.a.getTypeNameFor(Sc)}),Ac.add(Yb),
Sb||(Sb=0<Sc.count);this.wf.lWn(Ac)},"CC:SATH");!this.PFg&&Sb&&(ha.a.sendTelemetryEvent(Object.assign(Object.assign({},new ia.a),{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.PFg=!0)};this.wmm=(Sb,Yb,Ac)=>{const Sc=!this.pJa||this.pJa.Duf(Sb,Ac);Sb=this.Kra&&this.Kra.instance?this.Kra.instance.DSd(Sb,Ac,Yb.substr(1,Yb.length-2)):!0;return Sc&&Sb};null===Pa||void 0===Pa?void 0:Pa.wTe(this.Bkb);vb.epa(this,7);null===(Kb=this.Kra)||void 0===Kb?void 0:Kb.execute(Sb=>{Sb.RTe(this.LLb)})}get index(){return 3}run(){this.L9&&
(this.LLb(),this.L9=!1)}cGi(){this.LLb()}yQk(b){let h=0;if(({value:h}=this.VEe.Gc(b.categoryName,0)).returnValue)if(h!==b.count)this.VEe.Z(b.categoryName,b.count);else return!1;else this.VEe.add(b.categoryName,b.count);return!0}Oyl(){const b=new Tb.a;var h=this.std.qJd();const u=this.ime.qJd();this.jcg(b,h);this.jcg(b,u);this.wHg&&(h=this.wHg.qJd(),this.jcg(b,h));h=new ob.a;for(const y of b.values)this.yQk(y)&&h.add(y);return h}jcg(b,h){for(const P of h){h=P.value.annotation;const aa=P.key;var u=
this.rUn(P.value.languages);if(!b.ub(h.categoryName)){var y=T.a.create().toString();y=Object.assign(new pD.a,{id:y,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,y)}this.wmm(aa,u,h.categoryName)&&(u=b.J(h.categoryName),u.count+=h.count,u.countsByTypeId[aa]=(u.countsByTypeId[aa]?u.countsByTypeId[aa]:0)+h.count)}}rUn(b){const h=[];let u=0;for(const y of b)h[u++]=y;return z.c(h)}}Object(m.a)(sE,"CritiquesCounter",Vt.a,[486,487]);class rD{constructor(b){this.a1=b}qJd(){const b=
new Tb.a,h=new bm.a(la.a.Ri()),u=Object.assign(new pD.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.a1.Enc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new qD,{annotation:u,languages:h}));return b}}Object(m.a)(rD,"DictationCritiquesByTypeCounter",null,[485,360]);class BC extends Fy{constructor(b){super();this.h8a=new Tb.a;this.wf=b}K2l(b){const h=Fk.a.JLd(b.nodeId);if(!Fk.a.kf(h)){if(b.Xeb&&b.Xeb.length){let u=null;for(const y of b.Xeb)y.errorDetails.N1a()||
(b=this.nVh(y),Fk.a.kf(b)||(u||(u=new Tb.a),u.ub(b)||u.add(b,new ob.a),u.J(b).add(y)));this.RCh(h);u?this.g_n(h,u):this.h8a.remove(h)}else{if(!this.h8a.ub(h))return!1;this.RCh(h);this.h8a.remove(h)}return!0}return!1}cFn(b,h){var u;if(({value:u}=this.h8a.Gc(b,u)).returnValue)for(const P of u)if(b=P.value,0<b.count&&this.Fhf(b.J(0))===h.categoryName)for(u=b.count-1;0<=u;u--){var y=b.J(u).end-b.J(u).begin;b.J(u).begin===h.range.start&&y===h.range.length&&(y=this.nVh(b.J(u)),this.Aqa.ub(y)&&(y=this.Aqa.J(y).annotation,
y.count=Math.max(0,y.count-1)),b.removeAt(u))}}RCh(b){if(this.h8a.ub(b))for(const u of this.h8a.J(b)){var h=u.key;b=u.value;this.Aqa.ub(h)&&(h=this.Aqa.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}g_n(b,h){const u=new Tb.a,y=new Tb.a;for(const P of h){h=P.key;y.add(h,new bm.a(la.a.Ri()));for(const aa of P.value){const ta=aa.end-aa.begin,Pa=this.Fhf(aa);this.eDk(b,Pa,aa.begin,ta)?w.ULS.sendTraceTag(589866513,Fy.Gi,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,aa.begin,ta):(u.ub(h)||u.add(h,new ob.a),u.J(h).add(aa),y.J(h).add(this.Qyl(aa)))}}this.h8a.Z(b,u);for(const P of this.h8a.J(b))0<P.value.count&&(b=this.Fhf(P.value.J(0)),this.sci(b,P.value.count,P.key,y.J(P.key)))}nVh(b){let h=null;b&&(b=Object(na.a)(358,b.errorDetails))&&b.ft&&(h=b.ft.TypeId);return h}Fhf(b){let h=null;b&&(b=Object(na.a)(358,b.errorDetails))&&b.ft&&(h=b.ft.CategoryTitle);return h}Qyl(b){let h="";b&&b.errorDetails&&(h=zl.a.sg(b.errorDetails.lcid).name);return h}eDk(b,h,u,y){if((b=
this.wf.pSh(b))&&0<b.count)for(const P of b)if(b=Ap.a.getTypeNameFor(P.content),P&&AC.a(b)&&(b=P.content,b.categoryName===h&&b.range.start===u&&b.range.length===y))return!0;return!1}}Object(m.a)(BC,"WacCritiquesByTypeCounter",Fy,[359,360]);class wB{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}xc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new BC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new rE(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new rD(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new sE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Pa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Pa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Za("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),fq.a.instance,this.W.Pa("WordEditor.Goals.IGoalChangeSource"),
this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").dfh(b.F3m);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Jek(b.G0m);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Oeh(b.cKf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.weh(b.CDi),h.xeh(b.CDi))}}dispose(){}static main(){K.a.instance.Kc(new wB)}}Object(m.a)(wB,
"WordEditorCritiqueCountsPackage",null,[1,2]);class nC{get name(){return"WordEditor.GraphicsEditor"}xc(){}init(){}dispose(){}static main(){K.a.instance.Kc(new nC)}}Object(m.a)(nC,"PackageManager",null,[1,2]);var oC=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class tE{constructor(b){this.IKj={};this.Vb=b;this.Dvb=new Fh.a}aNa(b,h){const u=this.Vb.udc,y=parseInt(b);return b&&y!==De.ActionManager.V$e?this.Dvb.ub(u)?(b=this.Dvb.J(u).fNc(y,h,2),
32===b||1===b):!1:!1}tEa(b){const h=parseInt(b),u=this.Vb.udc;return b&&h!==De.ActionManager.V$e?this.Dvb.ub(u)?32===this.Dvb.J(u).fNc(h,this.IKj,1):!1:!0}MTi(b,h){this.Dvb.Z(b,h)}n$i(b){b=parseInt(b);const h=this.Vb.udc;return!!h&&!!this.Dvb.J(h)&&this.Dvb.J(h).Dlm(b)}}Object(m.a)(tE,"NonCanvasCuiUser",null,[875,355]);var Gy=c(1184),xB=c(60),bC;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";
b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(bC||(bC={}));Object(m.b)("GalleryType",bC);class gt{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(gt,"CommonGalleryButtonProps",null,[]);class CC extends gt{constructor(){super();this.tableStyles=this.tableCellStyles=
null;this.columns=0}}Object(m.a)(CC,"AdditionalTableStyleGalleryButtonProps",gt,[]);class sD extends CC{constructor(){super()}}Object(m.a)(sD,"AdditionalChangeColorsGalleryButtonProps",CC,[]);class uE extends gt{constructor(){super();this.character=null}}Object(m.a)(uE,"AdditionalCharacterCodeGalleryButtonProps",gt,[]);class tD extends gt{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(tD,"AdditionalFontStyleGalleryButtonProps",gt,[]);class hH{constructor(){this.selectedId=
this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(hH,"AdditionalGalleryProperties",null,[]);class iH extends gt{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(iH,"AdditionalIconButtonProperties",gt,[]);class jH extends gt{constructor(){super();this.styleDisplayName=null}}Object(m.a)(jH,"AdditionalInkThicknessGalleryButtonProps",
gt,[]);class kH extends gt{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(kH,"AdditionalListGallerButtonProps",gt,[]);class lH extends gt{constructor(){super();this.text=null}}Object(m.a)(lH,"AdditionalPageNumberGalleryButtonProps",gt,[]);var uD=c(1114);const OL=(b,h)=>{var u=appChrome.selectors.getActiveControlStates();if(u=Object(na.a)(Object,u[b])){if((b=Object(na.a)(String,u.value))&&b===h)return!1;b=Object(na.a)(String,u.selectedKey);if(!h&&!b)return!1;if(b){u=Array.isArray(u.options)?
u.options:null;let y=null;for(let P=0;P<u.length;P++){const aa=Object(na.a)(Object,u[P]);if(Object(na.a)(String,aa.key)===b){y=aa;break}}if(y&&Object(na.a)(String,y.text)===h)return!1}}return!0},nH=(b,h,u,y)=>{if(0<(y&2)){y=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":y.push(UE(b,u[ag.a.On]));break;case "CheckboxModel":y.push(appChrome.actions.toggleCheckbox(b,u[ag.a.On]));break;case "ComboBoxModel":if(r.AFrameworkApplication.K&&(r.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!OL(b,u[te.a.Value]))break;(h=u[te.a.Key])?y.push(appChrome.actions.updateComboBoxKey(b,h,u[te.a.Value])):y.push(appChrome.actions.updateComboBoxValue(b,u[te.a.Value]));break;case "FontPickerModel":y.push(appChrome.actions.updateFontPickerSelectedFont(b,u[uD.a.SelectedFont]));break;case "SplitButtonModel":y.push(UE(b,u[Eg.a.On]));break;case "SpinButtonModel":y.push(appChrome.actions.updateSpinButton(b,
u[Df.a.Number],Xf.a.$Ya(u[Df.a.UnitType]),u[Df.a.Text],u[Df.a.MaxValue],u[Df.a.Alt]));break;case "ColorPickerModel":y.push(appChrome.actions.updateColorPickerSelectedColor(b,u[Up.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":y.push(appChrome.actions.updatePageNumberGalleryButtonText(b,u[Bi.a.Text]));break;case "CompoundButtonModel":u[ag.a.Description]&&y.push(appChrome.actions.updateCompoundButtonDescription(b,u[ag.a.Description]));ag.a.On in u&&y.push(UE(b,u[ag.a.On]));break;case "SliderModel":u.snapToStep?
y.push(appChrome.actions.updateSliderSelectedValue(b,u[gg.Value])):y.push(appChrome.actions.updateSliderValue(b,u[gg.Value],u[gg.MinValue]||0,u[gg.MaxValue],u[gg.Text]));break;case "FlyoutAnchorModel":ei.a.ImageIsVisible in u&&y.push(appChrome.actions.hideFlyoutAnchorIcon(b,!u[ei.a.ImageIsVisible]));ag.a.On in u&&y.push(UE(b,u[ag.a.On]));break;case "InputBoxModel":y.push(appChrome.actions.updateInputBoxValue(b,u[Yk.a.Text]))}h=y;var P=Object(na.a)(String,u[pj.a.iconColor]);void 0!==P&&null!==P&&h.push(appChrome.actions.updateIconColor(b,
P));mH(b,u,y);h=y;(P=Object(na.a)(Object,u[pj.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,P));h=y;P=Object(na.a)(String,u[pj.a.customTooltip]);void 0!==P&&null!==P&&h.push(appChrome.actions.setControlCustomTooltip(b,P));b=y;(u=Array.isArray(u[pj.a.QVf])?u[pj.a.QVf]:null)&&b.push.apply(b,u);return y}return null},EC=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),UE=(b,h)=>appChrome.actions.toggleButton(b,h),mH=(b,h,u)=>{h=Object(na.a)(String,h[pj.a.Icon]);void 0!==h&&
null!==h&&u.push(appChrome.actions.setControlIcon(b,h))};class oH{constructor(b,h,u,y){this.lm=y;this.Sra=b;this.Gz=h;this.zWb=u;this.Nsc={}}bin(b,h,u,y,P=null){const aa=b.ExternalGalleryId||b.ExternalId;var ta=b.ExternalId;y.push(aa);if(appChrome.selectors.isControlDefined(aa))b.GalleryStyle&&fh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(aa,b.GalleryStyle));else{if(4!==b.Type)return;u.push(appChrome.api.createGalleryModel(aa,Object.assign(new hH,{columns:b.Width,sections:[appChrome.api.gallerySection([],
ta)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}u=0;y=!!r.AFrameworkApplication.K&&(r.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(fh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ta=[];const vb=[],Kb=[],Sb={};for(var Pa of b.GallerySections){ta.push(appChrome.api.gallerySection([],Pa.SectionId,Pa.Title));0===u&&Pa.GalleryButtons&&
0<Pa.GalleryButtons.length&&(u=Pa.GalleryButtons[0].Type);y&&this.Z1h(Pa.GalleryButtons,P,Sb);const Yb=this.ySe(vb,Pa.GalleryButtons,Sb);vb.push.apply(vb,this.Clf(Yb,aa,Pa.SectionId,!1,u,P,!0,Sb));Kb.push.apply(Kb,Yb)}h.push(appChrome.actions.setGallerySections(aa,ta));h.push.apply(h,vb);h.push.apply(h,this.djf(aa,bC[u],Kb,null,5===b.Type,!0,null,Sb))}else b.GalleryItems&&0<b.GalleryItems.length&&(u=b.GalleryItems[0].Type),Pa=y?this.Z1h(b.GalleryItems,P,null):null,h.push.apply(h,this.Clf(this.ySe(h,
b.GalleryItems,Pa),aa,ta,!1,u,P,!1,Pa))}HPl(b,h){const u=[];let y=null,P=!1;if(!b)return null;const aa=this.Sra.rYc(this.Gz,b.commandId,h);u.push(EC(b.externalUxCommand,!aa));if(b.previewControlIds){const vb=[];for(let Kb=0;Kb<b.previewControlIds.length;Kb++){var ta={},Pa=b.previewControlIds[Kb];ta.SourceControlId=Pa;const Sb=this.lm.getCommandByExternalUxId(Pa);this.SLd(Sb||b,ta);ta[Bi.a.On]&&(y=ta.SourceControlId,ta[Bi.a.HighlightOn]&&(P=!0));mH(Pa,ta,u);if(ta=Object(na.a)(Ii.a,ta[Bi.a.GalleryButtonProps]))vb.push(ta),
aa&&(Pa=this.Sra.rYc(this.Gz,ta.Command,h),ta.IsDisabled=!Pa)}0<vb.length&&u.push.apply(u,this.Clf(this.ySe(u,vb),b.externalUxCommand,b.externalUxCommand,!0,vb[0].Type));u.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,y));P&&(w.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",y),u.push(appChrome.actions.highlightSelectedFontStyle(y)))}return u}ySe(b,h,u=null){const y=[],P=[];for(let ta=0;ta<h.length;ta++){const Pa=h[ta],vb=Oe.b(Pa.ExternalId)?
Pa.Id:Pa.ExternalId;y.push(vb);const Kb=u&&u[vb]?u[vb].result:-1;switch(Pa.Type){case 1:var aa=Pa;P.push(appChrome.api.createCharacterCodeGalleryButtonModel(vb,Object.assign(new uE,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,character:aa.Character,style:aa.Style,title:aa.Alt})));break;case 2:aa=Pa;P.push(appChrome.api.createFontStylesGalleryButtonModel(vb,Object.assign(new tD,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt,previewStyleLabel:aa.PreviewStyleLabel})));
break;case 3:aa=Pa;P.push(appChrome.api.createInkThicknessGalleryButtonModel(vb,Object.assign(new jH,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt})));break;case 4:aa=Pa;P.push(appChrome.api.createIconGalleryButtonModel(vb,Object.assign(new iH,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,icon:[aa.Icon],fullIconStyle:aa.FullIconStyle,previewIconStyle:aa.PreviewIconStyle,largePreviewIconStyle:aa.LargePreviewIconStyle,label:aa.LabelText,title:aa.Alt})));
break;case 5:aa=Pa;P.push(appChrome.api.createListGalleryButtonModel(vb,Object.assign(new kH,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,infoAtLevel:aa.LevelInfo,ariaLabel:aa.Alt})));break;case 6:aa=Pa;P.push(appChrome.api.createTableStyleGalleryButtonModel(vb,Object.assign(new CC,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt,columns:aa.columns})));break;case 8:aa=Pa;P.push(appChrome.api.createChangeColorsGalleryButtonModel(vb,Object.assign(new sD,
{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt})));break;case 7:aa=Pa,P.push(appChrome.api.createPageNumberGalleryButtonModel(vb,Object.assign(new lH,{disabled:-1!==Kb?1>(Kb&1):aa.IsDisabled,text:aa.Text,title:aa.Alt})))}this.lm.addCommandToMaps(Object.assign(new xB.a(vb,Pa.Command),{queryCommandId:Pa.QueryCommand,menuItemId:Pa.MenuItemId}))}b.push(appChrome.actions.addControls(P));return y}Clf(b,h,u,y,P,aa=null,ta=!1,Pa=null){const vb=
[];y?vb.push(appChrome.actions.populateGalleryItems(h,b)):(this.Nsc[h]=!1,ta||(y=!0,appChrome.selectors.isControlDefined(h)&&(y=appChrome.selectors.getGalleryState(h),y=y.disableIndividualButtons?y.disableIndividualButtons:!0),vb.push.apply(vb,this.djf(h,bC[P],b,null,5===P,y,aa,Pa))),vb.push(appChrome.actions.updateGallerySectionItems(h,u,b)));return vb}cEl(b){return this.djf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}djf(b,
h,u,y,P,aa=!0,ta=null,Pa=null){const vb=[];if(b in this.Nsc){if(this.Nsc[b])return delete this.Nsc[b],vb;this.Nsc[b]=!0}let Kb=null,Sb=-1;if(u)({SQh:Sb,returnValue:Kb}=this.Pch(h,u,vb,aa,ta,Pa));else if(y)for(const Yb of y)(u=({SQh:Sb}=this.Pch(h,Yb.galleryButtons,vb,aa,null,Pa)).returnValue)&&(Kb=u);vb.push(appChrome.actions.updateGallerySelectedId(b,Kb));aa&&vb.push(EC(b,!1));P&&0<Sb&&vb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Sb));return vb}Y1h(b,h=null){const u={},y={};y.SourceControlId=
b;y.Location=h;b=this.lm.getCommandByExternalUxId(b);if(!b)return u.result=-1,u.props=y,u;b=this.SLd(b,y);u.result=b;u.props=y;return u}Z1h(b,h=null,u=null){u||(u={});for(const y of b)b=Oe.b(y.ExternalId)?y.Id:y.ExternalId,u[b]=this.Y1h(b,h);return u}Pch(b,h,u,y,P=null,aa=null){let ta,Pa=null;ta=-1;let vb=!1;for(const Sb of h){var Kb=this.$Dl(b);h=aa&&aa[Sb]&&-1!==aa[Sb].result?aa[Sb]:this.Y1h(Sb,P);const Yb=h.result;h=h.props;y&&u.push(EC(Sb,1>(Yb&1)));(Kb=nH(Sb,Kb,h,Yb))&&u.push.apply(u,Kb);h[Bi.a.On]&&
(Pa=Sb,h[Bi.a.HighlightOn]&&h[Bi.a.HighlightOn]&&(vb=!0));void 0!==h[pj.a.labelText]&&null!==h[pj.a.labelText]&&(Kb=this.lm.getCommandByExternalUxId(Sb),u.push(appChrome.actions.setControlLabel(Kb.externalUxCommand,h[pj.a.labelText])));h[Bi.a.IsRtl]&&0>ta&&(ta=h[Bi.a.IsRtl])}vb&&(w.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Pa),u.push(appChrome.actions.highlightSelectedFontStyle(Pa)));return{returnValue:Pa,SQh:ta}}$Dl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}SLd(b,h){h.MenuItemId=b.menuItemId;return this.Sra.Coa(this.Gz,this.zWb,
b.commandId,b.queryCommandId,h)}}Object(m.a)(oH,"ReactGalleryPoller",null,[]);var PL=c(699),pH=c(664),QL=c(1643);class qH{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(qH,"PopulateFontPickerDataProps",null,[]);var rH=c(302),yB=c(1804);class FA{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=
!1}}Object(m.a)(FA,"CommonOptionalButtonProperties",null,[]);class VE extends FA{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(m.a)(VE,"OptionalButtonProperties",FA,[]);class sH extends FA{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(sH,"OptionalCompoundButtonProperties",FA,[]);class tH extends FA{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=
null}}Object(m.a)(tH,"OptionalErrorViewProperties",FA,[]);class uH extends FA{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(uH,"OptionalFlyoutAnchorProperties",FA,[]);class vH extends VE{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(vH,"OptionalPersonaButtonProperties",VE,[]);class WE extends FA{constructor(){super();
this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(WE,"OptionalToggleButtonProperties",FA,[]);var RL=c(1645),SL=c(1644),TL=c(503);class wH{constructor(){this.uuh=this.actions=null;this.$sj=!1}}Object(m.a)(wH,"PopulateActions",null,[]);class UF{O4h(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.vQl(b);case "InkButtonModel":return this.uQl(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);
case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}vQl(b){const h={};h[ag.a.On]=appChrome.selectors.getButtonToggleState(b);return h}uQl(b){const h={};h[ag.a.On]=fh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(m.a)(UF,"ReactStatePropsSelector",null,[]);class XE{constructor(b,h,u,y,P){this.Sra=b;this.Gz=h;this.zWb=
u;this.lm=y;this.hNe={};this.d_j=new UF;this.nvb=P}Icj(b){const h=b.populationProps.populateQueryCommandId;return b.populationProps.populateOnlyOnce&&h in this.hNe}SQl(b,h,u=null){const y=[],P={};if(!this.Icj(b)){const aa=b.populationProps.populateQueryCommandId,ta={};ta.MenuId=b.externalUxCommand;ta.IsShadowMenuOpen=this.isShadowMenuOpen(u);if(0<(this.Sra.Coa(this.Gz,this.zWb,aa,aa,ta,this.JGl(u))&1))if("FontPickerModel"===h)this.hNe[aa]=!0,y.push(XE.mPl(b,ta)),P[b.externalUxCommand]="FontPickerModel";
else if(ta.MenuItems)switch(this.hNe[aa]=!0,h){case "ComboBoxModel":y.push(XE.kPl(b,ta));P[b.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":y.push.apply(y,this.U6h(b.externalUxCommand,h,ta.MenuItems,P,u&&"location"in u?u.location:null))}}return Object.assign(new wH,{actions:y,uuh:P,$sj:this.isShadowMenuOpen(u)})}y_h(b,h,u,y,P,aa,ta,Pa,vb=null){let Kb=null;const Sb=[];Oe.c(b.Title)||
(Kb=b.Title);for(let Yb=0;Yb<b.ControlList.length;Yb++){const Ac=Object(na.a)(qn.a,b.ControlList[Yb]);if(!Ac||Ac.ExternalId)aa&&this.Nwl(Ac,aa),h.push.apply(h,this.lPl(Ac,ta,Sb,P,u,y,vb))}return Pa?appChrome.api.menuSection(Sb,Kb,b.Lang):null}U6h(b,h,u,y,P=null){const aa=[],ta=[],Pa=[],vb=[];for(var Kb=0;Kb<u.MenuSectionList.length;Kb++){var Sb=Object(na.a)(xi.a,u.MenuSectionList[Kb]);Sb&&(Sb=this.y_h(Sb,aa,b,h,vb,y,ta,u.UpdateDynamically,P),u.UpdateDynamically&&Pa.push(Sb))}Kb=null;u.MenuFooterSection&&
(Kb=this.y_h(u.MenuFooterSection,aa,b,h,vb,y,ta,u.UpdateDynamically,P));u.UpdateDynamically&&aa.push(appChrome.actions.updateMenu(b,Pa,u.Title,u.AriaLabel,u.ShouldAutoOpen,u.AriaRoleDescription,u.MenuTargetDescriptor,Kb));0<ta.length&&aa.splice(0,0,appChrome.actions.addControls(ta));0<vb.length&&fh.d("setStatefulSplitButtonMruBypassControls")&&aa.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,vb));return aa}Nwl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?
"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(na.a)(Dx.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}lPl(b,h,u,y,P,aa,ta=null){const Pa=[];switch(b.ControlType){case 1:case 3:y=Object(na.a)(Qe.a,b);this.Nhn(y,Pa,h,u);y.MenuItemsStatefulData&&fh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Pa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(P,
y.MenuItemsStatefulData));break;case 2:this.xin(Object(na.a)(TL.a,b),Pa,h,u);break;case 6:this.Ohn(Object(na.a)(tz.a,b),Pa,h,u);break;case 4:this.pin(Object(na.a)(Wm,b),Pa,h,u);break;case 7:this.Qhn(Object(na.a)(Dx.a,b),Pa,h,u);break;case 12:this.Xhn(Object(na.a)(QL.a,b),Pa,u);break;case 9:P=Object(na.a)(Hd.a,b);this.Zhn(P,Pa,h,u);"StatefulSplitButtonModel"===aa&&y.push(P.ExternalId);break;case 8:this.nvb.bin(Object(na.a)(vs.a,b),Pa,h,u,ta)}return Pa}Nhn(b,h,u,y){y.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.yvd()&&((u=this.SNa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new yB.a(u)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||
Object(jb.a)(oy,b)?u.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new sH,{iconSet:(new yB.a(this.SNa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):u.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new VE,{iconSet:(new yB.a(this.SNa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==
b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus}))),this.lm.addCommandToMaps(Object.assign(new xB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&fh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}Ohn(b,h,u,y){y.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,
b.LabelText)),this.yvd()&&((u=this.SNa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new yB.a(u)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(u.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new WE,{iconSet:(new yB.a(this.SNa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,
roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.lm.addCommandToMaps(Object.assign(new xB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}Xhn(b,h,u){u.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):appChrome.api.createErrorViewModel(b.ExternalId,
b.Label,b.IconName,Object.assign(new tH,{retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId}))}xin(b,h,u,y){y.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.yvd()&&((u=this.SNa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new yB.a(u)).iconSet)),r.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&
b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(r.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?u.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new WE,{iconSet:(new yB.a(this.SNa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):u.push(appChrome.api.createToggleButtonModel(b.ExternalId,
b.LabelText,Object.assign(new WE,{iconSet:(new yB.a(this.SNa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.lm.addCommandToMaps(Object.assign(new xB.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}pin(b,h,u,y){y.push(b.ExternalId);y=this.ROl(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,y,b.LabelText)):fh.a("createPersonaButtonModel")&&
u.push(appChrome.api.createPersonaButtonModel(b.ExternalId,y,b.LabelText,Object.assign(new vH,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}Zhn(b,h,u,y){y.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.yvd()&&((u=this.SNa(b))&&0<u.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new yB.a(u)).iconSet)),void 0!==
b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{y=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const P=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;u.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new uH,{iconSet:(new yB.a(this.SNa(b))).iconSet,keytip:b.KeyTip,
hideIcon:y,toggled:P,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.lm.addCommandToMaps(Object.assign(new xB.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new PL.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.U6h(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}Qhn(b,h,u,y){b.McuLayout&&y.push(b.McuExternalId);y.push(b.ExternalId);y=0;appChrome.selectors.isControlDefined(b.ExternalId)?
b.McuLayout&&(y=this.d_j.O4h(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(u.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.lm.addCommandToMaps(Object.assign(new xB.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),y=b.Width),u.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.lm.addCommandToMaps(Object.assign(new xB.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
u=[];const P=[];for(let aa=0;aa<b.Colors.length;aa++){const ta=b.Colors[aa];aa<y?u.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt)):P.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt))}0<u.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,u));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,P));b.SelectedColorId&&(0<u.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,
b.SelectedColorId)))}SNa(b){return b.Image32by32Class?this.lm.FWh(b.Image32by32Class):b.Image16by16Class?this.lm.FWh(b.Image16by16Class):b.ExternalImageId}ROl(b){return b?Object.assign(new SL.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new RL.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}JGl(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}yvd(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static mPl(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((u,y)=>{Ja.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(P=>{P.isFeatureEnabled(rH.a.TGb,!1).then(aa=>{let ta=h.fonts;aa||P.isFreemiumUpsellEnabled()||(ta=Jj.a.cfg(ta,Pa=>Pa.fontType!==rH.a.wRf));aa=Object.assign(new qH,{commandId:b.externalUxCommand,fonts:ta,isSubscriber:aa,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
u(aa)}).catch(y)})}))}static kPl(b,h){const u=[];for(let y=0;y<h.MenuItems.MenuSectionList.length;y++){const P=h.MenuItems.MenuSectionList[y];P.Title&&u.push(appChrome.api.comboBoxHeader("Header-"+y.toString(),P.Title));for(let aa=0;aa<P.ControlList.length;aa++){const ta=Object(na.a)(pH.a,P.ControlList[aa]);ta&&u.push(appChrome.api.comboBoxItem(ta.MenuItemId,ta.LabelText,ta.Styles,ta.CommandValueId,ta.AriaLabel,ta.Data,ta.Disabled))}y<h.MenuItems.MenuSectionList.length-1&&u.push(appChrome.api.comboBoxDivider("Divider-"+
y.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,u)}}Object(m.a)(XE,"ReactPopulateQueryCommandPoller",null,[]);class xH{constructor(b,h,u,y,P){this.lm=u;this.Sra=b;this.Gz=h;this.zWb=y;this.nvb=P}RQl(b,h,u){const y=[];if(this.Tlm(h))b=this.FUl(b,h,u),void 0!==b&&null!==b&&y.push.apply(y,b);else if(b){var P=this.SLd(b,u);pj.a.visible in u&&y.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!u[pj.a.visible]));y.push(EC(b.externalUxCommand,1>(P&1)));
void 0!==u[pj.a.labelText]&&null!==u[pj.a.labelText]&&y.push(appChrome.actions.setControlLabel(b.externalUxCommand,u[pj.a.labelText]));void 0!==h&&null!==h&&(P=nH(b.externalUxCommand,h,u,P),void 0!==P&&null!==P&&y.push.apply(y,P),"PeopleWell"===h&&this.Bbk(b.externalUxCommand,u,y))}return y}BBl(b,h,u){const y=[];switch(h){case "FlyoutAnchorModel":var P=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var aa=appChrome.selectors.getSplitButtonState(b);if(aa=this.lm.getCommandByExternalUxId(aa.command))u=
this.Sra.rYc(this.Gz,aa.commandId,u),y.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!u)),y.push(EC(b,!1));return y;default:return null}h=!1;for(aa in P)if(P=this.lm.getCommandByExternalUxId(aa),Oe.c(P))h=!0;else if(u.SourceControlId=P.externalUxCommand,this.Sra.rYc(this.Gz,P.commandId,u))return y.push(EC(b,!1)),y;y.push(EC(b,!h));return y}FUl(b,h,u){switch(h){case "PreviewGalleryModel":return this.nvb.HPl(b,u);case "GalleryModel":return this.nvb.cEl(u)}return null}Tlm(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}SLd(b,h){h.MenuItemId=b.menuItemId;return this.Sra.Coa(this.Gz,this.zWb,b.commandId,b.queryCommandId,h)}Bbk(b,h,u){const y=h[ei.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[ei.a.LabelText];y&&0<y.length&&(h=String.format.apply(null,[h].concat(y)));u.push(this.LYl(b,h))}LYl(b,h){return appChrome.actions.updatePeopleWell(this.vwl(b),h)}vwl(b){const h=[];var u={};b=this.lm.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Sra.Coa(this.Gz,this.zWb,
"1285265560",b,u);u=u.MenuItems;if(!u)return h;u=u.MenuSectionList[0];for(b=0;b<u.ControlList.length;b++){const y=u.ControlList[b],P={};P.name=y.Alt;P.id=y.MenuItemId;P.description=y.Description;P.color=y.ImageBackColor;P.joinTime=y.JoinTimeInMS;P.imageUrl=y.ImageUrl;P.activeStatus=y.ActiveStatus;P.isAnonymous=y.IsAnonymous;P.canJump=y.CanJump;P.upn=y.Upn;h.push(P)}return h}}Object(m.a)(xH,"ReactQueryCommandPoller",null,[]);var UL=c(1101);class yH{constructor(b,h,u){this.lm=b;this.Gz=h;b=new UL.a;
this.v3j=new UF;this.nvb=new oH(b,this.Gz,u,this.lm);this.J1g=new XE(b,this.Gz,u,this.lm,this.nvb);this.y1g=new xH(b,this.Gz,this.lm,u,this.nvb)}nDa(){const b=[];if(!fh.c())return b;b.push.apply(b,this.JYl());var h=this.EAl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const u=this.FAl();for(const y of u)b.push(appChrome.actions.updateControlEnabledDisabledState(y,!0)),delete h[y];b.push.apply(b,this.hNd(h))}return b}sYc(b,h){fh.c()&&
(b=this.hNd(b,h),appChrome.api.dispatch(b))}SQf(b,h,u=null){if(!Oe.c(b)&&b.populationProps&&!this.J1g.Icj(b)){b=this.J1g.SQl(b,h,u);if(!b.$sj){let y;(y=b.actions).push.apply(y,this.hNd(b.uuh,fh.g(u)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}hNd(b,h=0){const u=[],y={};if(fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var P of appChrome.selectors.getActiveGroupIds())for(var aa of appChrome.selectors.getVisibleControlsInGroup(P))y[aa]=
!0;for(let ta in b)P=ta,aa=b[ta],0===h&&y[P]&&(h=2),u.push.apply(u,this.IYl(P,aa,h));return u}IYl(b,h,u=0){const y=[],P=this.lm.getCommandByExternalUxId(b);let aa={};appChrome.selectors.isControlDefined(b)&&(aa=this.v3j.O4h(b,h));aa[Gy.a.sOb]=u;Oe.c(P)?(aa.ExternalUxId=b,(b=this.y1g.BBl(b,h,aa))&&0<b.length&&y.push.apply(y,b)):(aa.MenuItemId=P.menuItemId,aa.SourceControlId=b);y.push.apply(y,this.y1g.RQl(P,h,aa));return y}JYl(){const b=[],h=!!r.AFrameworkApplication.K&&(r.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),u=appChrome.selectors.getContextualTabIds();let y=[];h&&(y=appChrome.selectors.getActiveContextualTabIds());for(let aa=0;aa<u.length;aa++){var P=this.lm.$mf(u[aa]);if(P){P=this.Gz.tEa(P);let ta=!0;h&&(ta=0<=Array.indexOf(y,u[aa]));h&&ta===P||b.push(appChrome.actions.activateDeactivateContextualTab(u[aa],P))}}return b}EAl(){var b=appChrome.selectors.getSelectedTabId();const h=[],u=this.lm.$mf(b);
u&&(this.Gz.tEa(u)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}FAl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const u of b)if(b=this.lm.uEl(u))for(const y of b)this.Gz.tEa(y.commandId)||((b=y.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(y.externalUxGroupId)),h.push.apply(h,b));return h}}Object(m.a)(yH,"ReactRibbonRootPoller",null,[863]);class YE{constructor(b,h,u=null){this.Gz=this.Iza=this.Mab=null;this.eWb=
h;b.FLa(this);this.ME=u}get Nna(){this.Iza||(this.Iza=new Date,this.Iza.setTime(0));return this.Iza}set Nna(b){this.Iza=b}get y8(){return 2}get ME(){return this.Gz}set ME(b){this.Gz=b}get $dc(){this.Mab||(this.Mab=new yH(this.eWb,this.ME,this.y8));return this.Mab}ydb(){const b=document.activeElement;Hc.a.isEditable(b)&&b.blur()}executeCommand(b,h,u,y,P,aa,ta,Pa=2){Oe.c(this.ME)||(P=new yg.a,P.CommandLocation=Pa,P.InvocationMethod=y,P.CommandTabName=u,h[Gy.a.sOb]=Pa,this.ME.aNa(b,h,P,aa,ta),this.rIm(b,
h))}nDa(){return Oe.c(this.ME)?[]:this.$dc.nDa()}Nl(){const b=this.nDa();0<b.length&&(this.Nna=new Date,appChrome.api.dispatch(b))}m7c(){fh.c()&&this.$dc.sYc({PeopleWell:"PeopleWell"},18)}a7c(){}rIm(b,h){try{const u=Ja.a.instance.Pa("Common.ISystemInitiatedFeedback");if(u&&h){const y=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let P=(y?"_"+y:"")+(h.SqmControlId?"_"+h.SqmControlId:"");P=P.length?P:"_"+b;u.fCf("Ribbon"+P)}}catch(u){w.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(u?u.toString():""))}}}Object(m.a)(YE,"ReactRibbonRoot",null,[601,864]);var ZE=c(1574);class zH{constructor(b){this.KQe=this.cwe=!1;this.w8a=null;this.YCg=!1;this.PO=null;this.rra=!1;this.wIe=b;Re.a.instance.mb(bb.a.qx,this.tKc(),Object(v.a)(this,this.B2m,"onContextualUIMouseDown"));(b=Ja.a.instance.Za("Common.IActionContextProvider"))&&b.execute(h=>{this.PO=h});r.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&r.AFrameworkApplication.ta.Pb.ZI?Zh.a.get_instance().al(16,
()=>{this.isReady?this.initializeContextualUI(this.tKc()):Zh.a.get_instance().al(7,()=>{this.initializeContextualUI(this.tKc())})}):Zh.a.get_instance().al(7,()=>{this.initializeContextualUI(this.tKc())})}get c_(){return this.rra}get isReady(){return r.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&r.AFrameworkApplication.ta.Pb.ZI?Zh.a.get_instance().isCompleted(16)&&Zh.a.get_instance().isCompleted(7):Zh.a.get_instance().isCompleted(7)}lAk(){if(this.YCg)return!0;
try{return Promise.resolve(null),this.YCg=!0}catch(b){return!1}}zbg(b){if(!this.isReady||this.KQe)return this.VCf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.lAk())return this.VCf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(r.AFrameworkApplication.cD)return this.VCf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.KQe=!0;let h=Wa.a.Ag;switch(b){case 1:h=Wa.a.showContextMenu;break;case 0:h=
Wa.a.showFloatie;break;case 2:h=Wa.a.Zgc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.KQe=!1;Ub.c(h)},0)});return!1}l7h(b){return Vj.UISurfaces.I_a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const u=[];for(const y of b)Array.contains(h,y)||u.push(y);return u}return b})}showFloatie(b,h,u,y=null){this.zbg(0)||this.l7h(h).then(P=>{if(0>=P.length)return null;this.X3f(P).then(()=>{const aa={};aa.target=
b;Vj.UISurfaces.I_a().then(ta=>{appChrome.api.dispatch(ta.showFloatie(aa,u,void 0,this.pkf(),y));this.rra=!0;r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&r.AFrameworkApplication.ya&&r.AFrameworkApplication.ya.processAction(Wa.a.eti,2);return null})});return null})}showContextMenu(b,h,u=null,y=null){this.zbg(1)||this.Naj(b,h,u,y)}Naj(b,h,u=null,y=null){this.X3f(null).then(()=>{const P={};P.target=b;y&&(P.directionalHint=y);Vj.UISurfaces.I_a().then(aa=>
{appChrome.api.dispatch(aa.showContextMenu(P,h,u,void 0,this.pkf()));return null})})}Ygc(b,h,u,y=null){this.zbg(2)||this.l7h(h).then(P=>{0>=P.length?this.Naj(b,u,y):this.X3f(P).then(()=>{const aa={};aa.target=b;const ta={};ta.target=b;Vj.UISurfaces.I_a().then(Pa=>{appChrome.api.dispatch(Pa.showContextualUI(aa,ta,u,void 0,y,this.pkf()));this.rra=!0;return null})});return null})}VCf(b){w.ULS.sendTraceTag(561394519,340,15,b)}T8e(){this.isReady&&Vj.UISurfaces.isLoaded()&&Vj.UISurfaces.I_a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());
return null})}Ew(){this.isReady&&Vj.UISurfaces.isLoaded()&&Vj.UISurfaces.I_a().then(b=>{this.rra=!1;appChrome.api.dispatch(b.hideFloatie());return null})}HGc(){this.isReady&&Vj.UISurfaces.isLoaded()&&Vj.UISurfaces.I_a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.rra=!1;return null})}initializeContextualUI(b){return Vj.UISurfaces.I_a().then(h=>{this.cwe||(h.initializeContextualUI(b),this.cwe=!0);return null})}X3f(b){if(!this.cwe)return this.initializeContextualUI(this.tKc()).then(()=>
{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var u=[];Vj.UISurfaces.I_a().then(y=>{u.push.apply(u,this.wIe.$dc.hNd(y.selectors.getFloatieOnlyControlsMap(),9));0<u.length&&appChrome.api.dispatch(u);return null})}}tKc(){if(this.w8a)return this.w8a;this.w8a=ZE.a("div");this.w8a.id="ReactContextualUIDiv";this.w8a.style.position=
"absolute";this.w8a.style.zIndex="1001";document.body.insertBefore(this.w8a,document.body.firstChild);return this.w8a}B2m(b){b.Ib&&b.Ib.target&&"input"===b.Ib.target.tagName.toLowerCase()&&ub.FocusManager.instance().qC("ribbon");return!1}pkf(){return this.PO?this.PO.contentType:"Unknown"}}Object(m.a)(zH,"ReactContextualUILauncher",null,[865]);class AH extends cx.a{constructor(){super()}}Object(m.a)(AH,"FloatieBuildOptions",cx.a,[]);class BH extends Rs.a{constructor(){super()}}Object(m.a)(BH,"FloatieBuildContext",
Rs.a,[]);var VL=c(659);class CH extends Zl.Builder{constructor(b,h,u){super(b,h,u,null);if(Oe.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}p3n(b){this.root=b}zuk(){const b=new BH,h=new pA.a;h.XZc=1;h.handler=Object(v.a)(this,this.p8m,"onReturnFloatieData");h.data=b;this.Lta.N9d(h)}p8m(b){this.Auk(b.qZc,b.AEc);this.floatie.TOh=this;this.floatie.sm();this.floatie.Nc.style.display="none";this.placeholder.appendChild(this.floatie.Nc);
this.Zsa.continueWith(()=>{this.Zsa.result.vIb(this.floatie)},11);Ai.a.instance.mb(bb.a.pointerDown,this.floatie.Nc,Object(v.a)(this.floatie,this.floatie.fC,"onPointerDown"))}Auk(b,h){b=Ji.a.zfa(b,Ji.a.Ywj);if(Oe.c(b))throw Error.create("No floatie element was present in the data");b=new Ji.a(b);this.p3n(new Pk(b.attributes[Ji.a.id],b.attributes));b=Ji.a.zfa(b.node,Ji.a.Sje);this.JYe(b,h)}JYe(b,h){b=Ji.a.Wv(b);for(let u=0;u<b.length;u++){if(this.fPa(b[u]))continue;const y=this.OYe(b[u],h);this.floatie.Qf(y)}}OYe(b,
h){var u=new Ji.a(b);b=new VL.Group(this.floatie,u.attributes[Ji.a.id],u.attributes[Ji.a.wTa],u.attributes[Ji.a.Mkc],u.attributes[Ji.a.rTa],!1,u.name===Ji.a.FAj,!1,u.attributes);u=Ji.a.Wv(u.node);for(let y=0;y<u.length;y++)b.Qf(this.pxd(u[y],h));return b}pxd(b,h){b=new Ji.a(b);var u=b.attributes[Ji.a.id];b=Ji.a.Wv(b.node);var y=2;2===b.length&&(y=3);u=new nc.a(this.floatie,u,y,2,1);for(y=0;y<b.length;y++){const aa=new Ji.a(b[y]);var P=Ji.a.zfa(aa.node,Ji.a.opb);P=Ji.a.Wv(P);this.SYe(u.lMd(y+1),P,
aa.attributes[Ji.a.id],h)}return u}SYe(b,h,u,y){for(u=0;u<h.length;u++){if(this.fPa(h[u]))continue;const P=new Ji.a(h[u]),aa=this.xea(h[u],y);aa&&b.Qf(aa.JP(P.attributes[Ji.a.Nkc]))}}}Object(m.a)(CH,"FloatieBuilder",Zl.Builder,[]);class vE{constructor(b,h){this.kv=null;this.xJk=b;this.yqe=h;this.V3m=this.N0d.bind(this)}get floatie(){return this.kv}Bdb(b,h,u){h=new Ro.CuiHelper(Yl.a.lYa,Box4Intl.Box4Strings,null,null,h);const y=new AH;y.uG=u||{};y.uG.floatieshadingColor=!1;const P=new CH(y,document.body,
this.xJk.M_i);P.Lta=new qA.a(b,h);P.zuk();this.yqe.execute(aa=>{P.floatie.ME=aa});P.floatie.mAn(this.V3m);P.floatie.Bzn(()=>[]);this.kv=P.floatie;return this.floatie}}Object(m.a)(vE,"AFloatieInitializer",null,[]);class DH extends vE{constructor(b,h,u,y){super(h,u);this.LQf=()=>{this.floatie.Nl()};this.Eh=b;this.TH=y}Bdb(b,h,u){if(b=super.Bdb(b,h,u))b.sdc=!0,b.X4d=!0,b.preventDismissOnScroll=!0;this.Eh.MXa(this.LQf);return b}XOc(b,h,u=null){this.TH.hlh(()=>this.Bdb(b,h,u))}N0d(){this.floatie.sdc=!0}}
Object(m.a)(DH,"PasteFloatieInitializer",vE,[]);var EH=c(801);class Bz{Cxa(b,h){this.KAk&&this.C9n(b,h,Bz.GEf,Bz.kb)}C9n(b,h,u,y){switch(u){case 1:case 6:case 2:case 3:case 4:Bz.u$e.show(y,b,h)}}Axi(){switch(Bz.GEf){case 5:case 1:return!0;default:return!1}}sZk(){return Bz.GEf}get KAk(){return 1!==Ra.App.xa.state}static get u$e(){return null!=Bz.Nng?Bz.Nng:Bz.Nng=Ja.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static HJl(b){if(!b)return 0;if(2===Ra.App.xa.mode){const h=b.Qa.node,u=yd.GraphIterator.$a(h);
u.jo();return Kg.e(u.currentNode)?2:r.AFrameworkApplication.akc||!Xr.isEmbeddedFileNode(h)||Xr.isInvalid(h)?Ye.a.Ypm(b.Qa)||Ye.a.yvf(b.Qa)?6:1:3}return 4}static get kb(){return Hh.a.instance.hb.kb}static get GEf(){return Bz.HJl(Bz.kb)}}Object(m.a)(Bz,"SelectionContextMenuProvider",null,[1172]);var $E=c(1783);class aF{constructor(b,h){this.X4d=this.sdc=!1;this.FNc=!0;this.cL=b;this.lm=h}get isVisible(){return this.cL.c_}get controls(){return null}Ew(){this.cL.Ew();return!0}Daf(){}B5a(b,h,u,y,P=null){this.cL.showFloatie(Object.assign(new $E.a,
{x:b.x,y:b.y}),this.Fff(u),u,P)}rCb(){return new Sys.UI.Bounds(0,0,0,0)}M2(){return this.Ew()}Fff(){return[]}}Object(m.a)(aF,"ReactFloatie",null,[396,397]);class FH{constructor(b){this.Rbd=null;this.cL=b}dispose(){}M2(){this.cL.HGc();return!0}showContextMenu(b,h){this.TMb(b,h.clientPoint,h.og)}TMb(b,h,u){this.y5a(b,new Sys.UI.Bounds(h.x,h.y,0,0),u);w.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}y5a(b,h,u,y=null){this.Rbd?this.cL.Ygc(Object.assign(new $E.a,{x:h.x,y:h.y}),
this.Rbd.Fff(u),u,b):this.cL.showContextMenu(Object.assign(new $E.a,{x:h.x,y:h.y}),u,b,y);this.Rbd=null}Zgc(b,h,u,y){this.Rbd=Object(na.a)(aF,u);y.Cxa(b,h);return!0}j1b(){}}Object(m.a)(FH,"ReactContextMenuController",null,[594,9]);var XL=c(353);class GH{constructor(){this.Fha=this.text=this.gna=null}}Object(m.a)(GH,"BusinessBarButtonData",null,[]);class VF{constructor(){this.text=this.gna=null}}Object(m.a)(VF,"BusinessBarLinkData",null,[]);var HH=c(183);class WF{constructor(b,h,u,y){this.aKg=this.xHg=
this.Z8a=this.yFg=null;this.Xs=b;this.Gya=h;this.ga=u;this.Ma=y}oQf(){this.bDc();this.zyd();this.cDc()}zyd(){}bDc(){const b=Ra.App.xa.jb.Yc;b&&(this.yFg=this.K6a(this.yFg,1,2===Ra.App.xa.mode&&b.yuf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}Xym(){return r.AFrameworkApplication.ta&&1===r.AFrameworkApplication.ta.mode}cDc(){let b=null;const h=Ra.App.xa.jb.activeSection;if(h){const u=h.xXc;HH.a.aSd(u)?22===u?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===u||20===u?b=ba.a.zi?
Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===u?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===u?b=ba.a.zi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===u&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):HH.a.T$h(h.AXa)||Ra.App.Lm||this.Xym()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.aKg=this.K6a(this.aKg,5,!!b,b)}cbj(b,h,u,y){b=this.Gya.create(null,
b,null);b.closeable=!0;b.id=23;b.image=3;b.Eud(h,()=>{Je.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+u)});y&&(b.fla=y);this.Xs.BA(b,!0)}o$n(b,h,u){this.cbj(b,h,u,null)}z$n(b){b=this.Gya.create(null,b,null);b.closeable=!0;b.id=20;this.Xs.BA(b)}M9n(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.Z8a||(this.Z8a=this.Gya.create(b,h,null),this.Z8a.closeable=!0,this.Z8a.id=27,this.Xs.BA(this.Z8a))}a8l(){this.Z8a&&
(this.Z8a=this.K6a(this.Z8a,27,!1,""))}A5f(b){this.xHg=this.K6a(this.xHg,30,!0,b)}K6a(b,h,u,y,P=!1,aa="",ta=null,Pa=null,vb=null){u?b?b.message=y:(b=this.Gya.create(aa,y,null),b.id=h,b.closeable=P,ta&&b.addButton(ta.text,ta.gna,ta.Fha),Pa&&b.Eud(Pa.text,Pa.gna),vb&&(b.fla=vb),this.Xs.BA(b,!1)):b&&(this.Xs.removeEntry(b),b=null);return b}dSe(b){this.Xs.BA(b,void 0)}}Object(m.a)(WF,"BusinessBarController",null,[509]);class FC extends WF{constructor(b,h,u,y){super(b,h,u,y);this.Gza=null}xZh(b,h,u=null,
y=null,P=null,aa=2){this.Gza||(this.Gza=this.Gya.create(h,u||"",null),this.Gza.id=6,this.Gza.image=aa,this.Gza.YTd=!1,b&&(this.Gza.errorCode=b),this.Gza.closeable=!1,h=r.AFrameworkApplication.RE&&this.Ma.$("ShowFeedbackButtonOnKickoutBusinessBar"),y?(this.Gza.addButton(y,P,""),h&&this.Gza.Odh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.X7h(b)})):h&&this.Gza.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.X7h(b)},""),this.Xs.BA(this.Gza,void 0,null,null,null))}X7h(b){w.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Ub(Wa.a.giveFeedback,2,{["ErrorCode"]:b})}static get Te(){return se.PageReader.instance}}Object(m.a)(FC,"BusinessBarController",WF,[508,509]);class XF{static get IBi(){const b=A.a.Pj(zl.a.sg(r.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(m.a)(XF,"OdtUtils",null,[]);class IH extends FC{constructor(b,h,u,y){super(b,h,u,y);this.kqb=this.Gqc=
this.JVg=this.vLa=this.PVg=this.n6g=null;this.FTj="https://go.microsoft.com/fwlink/?linkid=2134357"}oQf(){super.oQf();this.UDk()}zyd(){const b=Ra.App.xa.jb.Yc;if(b){var h=Ra.App.f_;if(Ra.App.Fs||Ra.App.Lm||h&&r.AFrameworkApplication.Yu)this.n6g=this.K6a(this.n6g,4,FC.Te.fSc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.PVg=this.K6a(this.PVg,3,FC.Te.$8b(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.JVg=this.K6a(this.JVg,8,FC.Te.lNk(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),FC.Te.RSc(b)?this.vLa||(this.vLa=this.Gya.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.vLa.id=14,this.vLa.closeable=!0,this.vLa.image=3,this.vLa.addButton(Box4Intl.Box4Strings.L_LearnMore,$g.AppFrame.LCm,""),this.Xs.BA(this.vLa,!1)):this.vLa&&(this.Xs.removeEntry(this.vLa),this.vLa=null)}}UDk(){if(vk.App.sRc){const b=XF.IBi,h=this.Gya.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.Jak(b);this.Xs.BA(h,!0)}}p$n(b,h){if(Ra.App.xa.jb.Yc){const u=new GH;u.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;u.gna=()=>{b()};const y=new VF;y.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;y.gna=()=>{Je.a.openWindow(4,r.AFrameworkApplication.privacyUrl)};this.Gqc=this.K6a(this.Gqc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
u,y,()=>{h()})}}i8l(){this.Gqc&&(this.Gqc=this.K6a(this.Gqc,25,!1,""))}v9n(){if(Ra.App.xa.jb.Yc){const b=new VF;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.gna=()=>{Je.a.openWindow(4,this.FTj)};this.kqb||(this.kqb=this.Gya.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.kqb.id=32,this.kqb.closeable=!0,this.kqb.image=3,this.kqb.Eud(b.text,b.gna),this.Xs.BA(this.kqb,!1))}}o3(b){return this.Xs.o3(b)}BA(b,
h){this.Xs.BA(b,h)}}Object(m.a)(IH,"BusinessBarController",FC,[507,508,509]);class JH{constructor(){this.menuTargetType=null}}Object(m.a)(JH,"MenuTargetDescriptor",null,[]);class Cu{static get D2(){return null!=Cu.dng?Cu.dng:Cu.dng=Ja.a.instance.resolve("Box4.IContextMenuController")}static bSk(b){Cu.D2.j1b(b,"mnuNavPaneWordEditor","","","Menu16")}static showContextMenu(b,h){Cu.D2.showContextMenu(b,h)}static TMb(b,h,u){Cu.D2.TMb(b,h,u)}static y5a(b,h,u,y=null){Cu.D2.y5a(b,h,u,y)}static aRh(b,h,u,
y){return ke.a(b,h.toString(),y,u)}}Object(m.a)(Cu,"BaseContextMenu",null,[]);class jk extends Cu{constructor(b,h,u,y=!1,P,aa=null,ta){super();this.y4d=(Pa,vb,Kb,Sb,Yb)=>{if(1===Kb)return 32;Pa=Yb.ox;Yb=Yb.vd;vb=Object.assign(new $f.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.NUk(vb,Pa,Yb.IsShadowMenuOpen);Yb.MenuItems=vb;return 32};this.Lnn=h;this.kn=u;this.lbb=aa;this.zze=y;this.Wb(b);this.T7a=ta;jk.NWa[1]=Oa.a.jde;jk.NWa[2]=Oa.a.zNd;jk.NWa[3]=Oa.a.Sde}get L9k(){return yn.a.ECd}get K9k(){return yn.a.cBd}get M9k(){return yn.a.X3d}get s$e(){return yn.a.RKi}Wb(b){b.gb(Oa.a.VQf,
oc.a.application,this.y4d,96);b.gb(Oa.a.tMi,oc.a.application,this.y4d,96)}show(b,h,u){let y=null,P=new Sys.UI.Bounds(0,0,0,0);const aa=this.iQl(b);if(aa&&(b=b.Qa.node)&&(b=b.xe(ab.InteractiveViewManager.instance.od.Sb))){P=nq.a.Cq(b,aa.end);if(r.AFrameworkApplication.isRtl&&P.x>h.x||!r.AFrameworkApplication.isRtl&&P.x+P.width<h.x||P.y+P.height<h.y)P=nq.a.Cq(b,aa.end-1);h.x=P.x+(r.AFrameworkApplication.isRtl?0:P.width);h.y=P.y+P.height;y=6}Cu.y5a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,P.width,P.height),
u,y)}SZ(b,h){return this.b4c(b)||jk.$Cc(Oa.a.mergeCells)||jk.$Cc(Oa.a.GGa)||this.k6f(b)||this.Iaj(b,h)||jk.ubj()||jk.ibj(b).returnValue}b4c(b){return 2===Ra.App.xa.mode&&this.lRc(b)}vFc(b,h,u=null){if(Oo.XA()&&2===Ra.App.xa.mode){h=this.T7a.vxh(b.Qa);if(!h||!this.cvm()&&!this.wwm(h.errorDetails))return;h=h.errorDetails}else{if(!this.b4c(b))return;h=this.z2h(b)}var y=zl.a.sg(h.lcid);const P=y?y.name:"UNKNOWN";y=Object(jb.a)(Gf.a,h)?h.typeId:"";w.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",
h.errorType,h.proofingType,y,P);if(b=this.Lnn.x1b(b,h))u.push.apply(u,b),this.JNm(h,y)}wwm(b){return b&&(1===b.proofingType||2===b.proofingType)}cvm(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",!1)}JNm(b,h){const u=jk.NWa[b.proofingType];u&&(r.AFrameworkApplication.ya.processAction(u,2),w.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",
u,h,b.proofingType,Oo.XA()))}z2h(b){return this.kn.qma(b.Qa).errorDetails}lRc(b){return this.kn.q$d(b)}N4b(){return null}ABd(){}iQl(b){return this.lRc(b)?this.kn.qma(b.Qa):(b=this.N4b(b))?new Xb.a(b.Bp,b.cpEnd):null}k6f(b){if(2!==Ra.App.xa.mode||!b)return!1;b=MB.a.aCa(b.toArray());return!!jk.Yg.yS(b,14)}Vbj(b,h){return 2===h||3===h&&!this.lRc(b)}Iaj(b,h){return 3!==h||this.lRc(b)}FRk(){const b=[];b.push(Object.assign(new Qe.a,{ExternalId:this.L9k}));b.push(Object.assign(new Qe.a,{ExternalId:this.K9k}));
b.push(Object.assign(new Qe.a,{ExternalId:this.M9k}));return b}TVk(){const b=[];this.zze&&b.push(Object.assign(new Qe.a,{ExternalId:this.s$e}));return b}static get hd(){return null!=jk.ytg?jk.ytg:jk.ytg=Ja.a.instance.resolve("Box4.List.IListReader")}static get Yg(){return im.ContextSetEditor.instance}static get Xpm(){null==jk.Vye&&(jk.Vye=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return jk.Vye}static get tVc(){null==jk.vpb&&(jk.vpb=r.AFrameworkApplication.K?
r.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return jk.vpb}static get f2(){null==jk.WU&&(jk.WU=r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return jk.WU}static $Cc(b){return 32===r.AFrameworkApplication.ya.processAction(b,1)}static ubj(){return 2===Ra.App.xa.mode&&!!Ra.App.Bw.kI&&Ra.App.Bw.kI.VRc(Oa.a.D2d.toString())}static wbj(b){if(1!==b.length||!b.Qa.gl)return!1;b=yd.GraphIterator.$a(b.Qa.node);b.Ab(11);b.qc();
return b.Lq(4)&&!jk.hd.Qu(b).listType?!0:!1}static ibj(b){let h=!1,u=!1;if(!b)return{returnValue:!1,ghb:h,jOc:u};if(jk.tVc)return jk.y$n(b,u);if(!(b.Nx||jk.Xpm&&2===b.length&&b.Tc.contextId===oc.a.endOfParagraph))return{returnValue:!1,ghb:h,jOc:u};b=b.Qa.clone();h=32===r.AFrameworkApplication.ya.Tf(b,Oa.a.B3a,1,!0,null,null);u=32===r.AFrameworkApplication.ya.Tf(b,Oa.a.insertHyperlink,1,!0,null,null);return{returnValue:h||u,ghb:h,jOc:u}}static y$n(b,h){let u;h=b.Qa.clone();u=jk.f2&&En.l(h);let y=!u&&
32===r.AFrameworkApplication.ya.Tf(h,Oa.a.B3a,1,!0,null,null);if(b.Nx||2===b.length&&b.Tc.contextId===oc.a.endOfParagraph)h=!u&&32===r.AFrameworkApplication.ya.Tf(h,Oa.a.insertHyperlink,1,!0,null,null);else{h=!0;const P=b.length;for(let aa=0;aa<P;aa++){const ta=b.J(aa).clone();if(ta.contextId===oc.a.paragraph||ta.contextId===oc.a.Fd)(u=jk.f2&&En.l(ta))||(h=32===r.AFrameworkApplication.ya.Tf(ta,Oa.a.insertHyperlink,1,!0,null,null)&&h);else if(ta.contextId!==oc.a.endOfParagraph)return h=y=!1,{returnValue:!1,
ghb:y,jOc:h}}}return{returnValue:y||h,ghb:y,jOc:h}}static z_h(b){const h=Object.assign(new xi.a,{ControlList:[]});for(const u of b)h.ControlList.push(Object.assign(new Qe.a,{ExternalId:u}));return h}static MF(b){const h=[];for(const u of b)h.push(Object.assign(new Qe.a,{ExternalId:u}));return h}}jk.Vye=null;jk.vpb=null;jk.WU=null;jk.NWa=[];Object(m.a)(jk,"AEditSurfaceContextMenu",Cu,[]);var YL=c(600),ZL=c(856),$L=c(1711);class bF{static uPl(b,h,u){h=[];u.pkn.x1b(u.lsl(b),h);return h}static yAl(b,
h,u){const y=[];if(u.b4c(b))return y;u.K.$("WordEditorIdeasCardsIsEnabled")&&!ba.a.kt||u.j8e.ABd(b,null,h,y);return y}static pUl(b,h,u){const y=[];u.vFc(b,h,y);return y}}Object(m.a)(bF,"ContextMenuSectionHelper",null,[]);class nr{static lAl(b,h,u){h=[];u.G3k(b)&&h.push(Object.assign(new Qe.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:u.CRl(b)}));return h}static QJl(){return jk.$Cc(Oa.a.mergeCells)?jk.MF(["MergeCells"]):jk.$Cc(Oa.a.sde)?jk.MF(["SplitCells"]):[]}static NXl(b,h,u){h=[];if(!u.Dh.owh(b))return h;
b=u.Dh.F6h(b);h.push(Object.assign(new Qe.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new Qe.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static jvl(b,h,u){return r.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&
b&&b.Qa&&b.Qa.node&&u.Mc&&u.Mc.LAi(b.Qa.node)?jk.MF(["ShowCatchUpActivitiesForParagraph"]):[]}static dBl(b){return pp.Q9n(b)?jk.MF(["Draw"]):pp.mbj(b)?jk.MF(["EditIllustration"]):[]}static B_l(b,h,u){return u.K.$("WordEditorWrapTextIsEnabled")&&pp.hbo(b)?[Object.assign(new Hd.a,{ExternalId:"WrapTextMenu"})]:[]}static aMd(b,h,u){return u.W3k(b)?jk.MF(["CreatePullQuote"]):[]}static thf(b,h,u){return u.F3k()?jk.MF(["RemoveContentControl"]):[]}static Twl(){return jk.MF(["NewComment"])}static Fvl(b){const h=
[];!pp.j6f(b)&&pp.N5f(b)&&ui.SessionStatusManager.instance.XI&&b.yK&&h.push(Object.assign(new Hd.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static PGl(b,h,u){h=[];!pp.j6f(b)&&pp.N5f(b)&&ui.SessionStatusManager.instance.XI&&(w.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.yK&&!r.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?h.push(...jk.MF(["ChangePicture"])):h.push(...u.YTk().ControlList),(b=pp.bZh())&&0<b.length&&
(u=u.vXk(b),null!=u&&h.push(...u.ControlList)));return h}static fQl(){return jk.ubj()?jk.MF(["SetProofingLanguage"]):[]}static NRl(b,h,u){return u.bvm&&u.uao(b)?jk.MF(["Rewrite"]):[]}static tIl(b){return jk.wbj(b)?jk.MF(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static aOl(){return pp.Jbj()?jk.MF(["ParagraphOptions"]):[]}static IFl(b){return pp.mbj(b)?jk.MF(["EditIllustration"]):[]}static iUl(b){return pp.j6f(b)?jk.MF(["ShowSmartLookupPane"]):[]}static YXl(b){return pp.Abj(b)?jk.MF(["ModernTranslatorSplitButton"]):
[]}static UEl(b,h,u){h=[];if(b.Nx){const y=b.Qa;if(y.contextId===oc.a.paragraph||y.contextId===oc.a.Vc||y.contextId===oc.a.Fd){b=b.Qa.node;if(!u.xl.ic(b)||b.es||""===b.characterData)return h;u.z2b.nKd(b)&&h.push(...jk.MF(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,u){h=[];if(r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Nx){const y=b.Qa;(Se.SelectionEditor.pf(y)||Se.SelectionEditor.u1a(y))&&u.ssk.JKc(b.Qa.node,b.Qa.cpBegin)&&(h.push(...jk.MF(["DeleteBookmarkContextMenu"])),
r.AFrameworkApplication.Ce("bookmarks-edit-ex;bookmarks-edit-ex-cf"),r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&h.push(...jk.MF(["EditBookmarkNameContextMenu"])))}return h}static waa(b){let h=!1,u=!1;const y=[];({ghb:h,jOc:u}=jk.ibj(b)).returnValue&&(h?u?y.push(...jk.MF(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):y.push(...jk.MF(["OpenHyperlink"])):u&&(r.AFrameworkApplication.K.$("IsO365CommercialHost")||
r.AFrameworkApplication.K.$("IsO365ConsumerHost")?y.push(...jk.MF(["InsertLinkFlyout"])):y.push(...jk.MF(["InsertLink"]))));return y}static pwl(b,h,u){const y=[];if(!u.Iaj(b,h))return y;2===Ra.App.xa.mode?(y.push(...u.FRk()),y.push(...u.TVk()),3===h&&u.lRc(b)&&y.push(Object.assign(new Qe.a,{ExternalId:"Delete"}))):(!r.AFrameworkApplication.protectFile&&!r.AFrameworkApplication.pM||r.AFrameworkApplication.TAb)&&y.push(Object.assign(new Qe.a,{ExternalId:"Copy"}));return y}static Sff(b,h,u){return u.k6f(b)&&
u.Vbj(b,h)?jk.MF(["EditTableAltText"]):[]}static fZh(b,h,u){return u.Q3k(b)?jk.MF(["ShowIntentSuggestion"]):[]}static ZVl(b,h,u){const y=[];u.k6f(b)&&!u.Vbj(b,h)&&(y.push(Object.assign(new Hd.a,{ExternalId:"InsertTableMenu"})),y.push(Object.assign(new Hd.a,{ExternalId:"DeleteTableMenu"})),y.push(Object.assign(new Hd.a,{ExternalId:"SelectTableMenu"})));return y}static dWl(b,h,u){return pp.$b.isFeatureEnabled(110)&&u.Mao(b)?jk.MF(["UpdateTableOfContents"]):[]}static NBl(b){return pp.W9n(b)?jk.MF(["ShowHideEquationToolsPane"]):
[]}}Object(m.a)(nr,"ContextMenuSectionItemHelper",null,[]);class pp extends jk{get xl(){return this.eb}get z2b(){return this.xUa}constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad,he,ce,Nd=!1,re=null,Xd=null,vg,Vf,kj,zm){super(b,h,u,Nd,void 0,re,vg);this.tDd=zm;this.CHe=this.PO=null;this.bNg=!1;this.e$d=new Map;this.yD={};this.Qjb={};this.ga=b;this.K=y;this.Dh=P;this.PV=Pa;this.XH=vb;this.vp=Kb;this.G6j=!!re;this.j8e=Sb;this.pkn=Yb;this.gHg=Ad;this.$0=he;this.ssk=ce;this.xUa=kj;this.eb=Vf;nd&&
nd.execute(rm=>{this.i4g=rm});Ac&&Ac.execute(rm=>{this.CHe=rm});this.Mc=ta;this.vz=Sc;Xd&&Xd.execute(rm=>{this.PO=rm});this.Zbm();this.uin();this.Mgl();this.tin()}get s$e(){return this.G6j?yn.a.U3d:super.s$e}U7n(){const b=vk.App.Fn.jb.wc.Bb.hb.kb;return this.b4c(b)&&2!==this.z2h(b).errorType}SZ(b,h){return super.SZ(b,h)||pp.Jbj()||jk.wbj(b)||pp.N5f(b)||pp.Abj(b)}NUk(b,h,u){const y=[];let P=null;try{P=vk.App.Fn.jb.wc.Bb.hb.kb}catch(aa){w.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");
return}this.gin(P,h,y,this.gyl(P));b.MenuSectionList.push(...y);this.SZn(b);!u&&this.i4g&&this.i4g.fmn(b.MenuTargetDescriptor.menuTargetType,y)}gyl(b){return jk.$Cc(Oa.a.mergeCells)?xw.rkg:b.DQc?xw.$gg:b.yK?xw.gjg:b.F9b()?xw.Ngg:pp.Yuf&&b.A1a?xw.Hgg:xw.hhg}ZTk(b){b=pp.kUk(b);return Object.assign(new Qe.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}wXk(b){return(b=pp.$vj(b))?Object.assign(new Qe.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}YTk(){const b=Object.assign(new xi.a,{ControlList:[]}),
h=pp.bZh();b.ControlList.push(this.ZTk(h));return b}vXk(b){const h=Object.assign(new xi.a,{ControlList:[]});if(b&&0<b.length){b=this.wXk(b);if(null==b)return null;h.ControlList.push(b)}return h}a$b(b){return b.yK||2<b.length||!b.length||2===b.length&&!Se.SelectionEditor.Dk(b.Tc)||1===b.length&&Se.SelectionEditor.Dk(b.Tc)?!1:this.fzf(b.Qa)}fzf(b){return be.ParagraphReader.ic(b.node)?""!==be.ParagraphReader.text(b.node).trim():!1}Mao(b){var h=yd.GraphIterator.$a(b.Qa.node);h=Object(na.a)(YL.a,h.currentNode);
return pe.a.instance.J(4)&&b.yK?!1:!!h&&h.es}Mgl(){r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.vz.execute(b=>{b.isFeatureEnabled(ZL.a.Wzi,!1).then(h=>{h||w.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.bNg=h;return null})}):w.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get bvm(){r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");
return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.bNg:!1}uao(b){if(!this.a$b(b)||b.A1a||b.F9b())return!1;b=b.Qa;if(be.ParagraphReader.em(b)||Se.SelectionEditor.pf(b)||Se.SelectionEditor.Ek(b)){b=this.XH.UNa(b);b||(b=r.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Q3k(b){if(1!==
b.length||ba.a.kt)return!1;const h=r.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(h&&this.U7n()||Oo.XA()&&this.T7a.vxh(b.Qa))return!1;const u=pp.$b.isFeatureEnabled(61);return b.J(0).contextId===oc.a.Vc&&(h||u)&&0<this.vp.nLc(b.J(0),0).count||h&&this.N4b(b)?!0:!1}G3k(b){return 1===b.length&&this.gHg.RA(b.Qa.node).qna}CRl(b){var h,u;const y=null===(h=this.tDd)||void 0===h?void 0:h.uT(null===(u=null===b||void 0===b?void 0:b.Qa)||void 0===u?void 0:u.node);return $L.a.A6h(y)}get Rx(){return null!=
this.Ang?this.Ang:this.Ang=Ja.a.instance.Pa("WordEditor.Designer.IDesignerTaskPane")}W3k(b){if(!this.$0.eii()||!this.Rx||this.Rx.isVisible||!(1===b.length||2===b.length&&Se.SelectionEditor.Dk(b.Tc))||b.bjb||!Se.SelectionEditor.Ek(b.Qa)&&b.Qa.contextId!==oc.a.paragraph||b.xni()||this.gHg.RA(b.Qa.node).qna)return!1;const h=be.ParagraphReader.text(b.Qa.node),u=b.Qa.contextId===oc.a.paragraph?0:b.Qa.cpBegin,y=b.Qa.contextId===oc.a.paragraph?h.length:b.Qa.cpEnd-u;return 1>y||1500<y||A.a.kf(A.a.$wa(h.substr(u,
y)))||1!=kr.a.agb(b.Qa.node)?!1:!0}F3k(){return Fj.a.Ahi?32==this.ga.processAction(Oa.a.V_c,1):!1}N4b(b){return this.j8e.N4b(b)}ABd(b,h,u,y=null){this.b4c(b)||this.j8e.ABd(b,h,u,y)}lsl(b){return this.CHe?this.CHe.msl(b):[]}SZn(b){const h=this.PO?this.PO.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new JH,{menuTargetType:h})}static get $b(){return null!=pp.Log?pp.Log:pp.Log=Ja.a.instance.resolve("Box4.IFeatureHelper")}static get Yuf(){if(null!=pp.Csg)var b=pp.Csg;else{var h;b=null===
(h=r.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=pp.Csg=b}return b}static N5f(b){return r.AFrameworkApplication.XZ&&!b.A1a&&Ja.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").Cym()}static bMd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=A.a.az(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static kUk(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;
(b=pp.bMd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static $vj(b){b=pp.bMd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static bZh(){const b=(new zq.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static mbj(b){const h=pp.$b.isFeatureEnabled(47);return!b.sEc&&h&&!ba.a.kt&&(b.A1a||h&&!pp.Yuf&&b.yK)}static Q9n(b){const h=pp.$b.isFeatureEnabled(47);
return!b.sEc&&h&&!ba.a.kt&&pp.Yuf&&b.yK}static j6f(b){return r.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.F9b()}static Abj(b){return r.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.A1a&&!b.F9b()}static W9n(b){return b.yni()&&r.AFrameworkApplication.ta.Pb.PRc}static Jbj(){return 2===vk.App.Fn.mode}static hbo(b){return b.yK}gin(b,h,u,y){this.Qjb[y].forEach(P=>{const aa=Object.assign(new xi.a,{ControlList:[]}),ta=aa.ControlList;P.forEach(Pa=>{Pa instanceof Du?u.push(...this.e$d.get(Pa)(b,
h,this)):ta.push(...this.yD[Pa](b,h,this))});(null===ta||void 0===ta?0:ta.length)&&u.push(aa)})}tin(){this.e$d.set(Du.CPb,bF.uPl);this.e$d.set(Du.Mje,bF.yAl);this.e$d.set(Du.yke,bF.pUl)}uin(){this.yD[Ih.ppb]=nr.pwl;this.yD[Ih.Bke]=nr.ZVl;this.yD[Ih.Cke]=nr.dWl;this.yD[Ih.Lje]=nr.lAl;this.yD[Ih.eke]=nr.QJl;this.yD[Ih.yje]=nr.Sff;this.yD[Ih.Yje]=nr.PGl;this.yD[Ih.l9c]=nr.fZh;this.yD[Ih.Xje]=nr.IFl;this.yD[Ih.xke]=nr.iUl;this.yD[Ih.Eke]=nr.YXl;this.yD[Ih.lke]=nr.fQl;this.yD[Ih.oke]=nr.NRl;this.yD[Ih.n9c]=
nr.tIl;this.yD[Ih.q9c]=nr.aOl;this.yD[Ih.mke]=nr.aMd;this.yD[Ih.Z8c]=nr.thf;this.yD[Ih.Yke]=nr.B_l;this.yD[Ih.Nje]=nr.dBl;this.yD[Ih.Fje]=nr.Fvl;this.yD[Ih.Dke]=nr.NXl;this.yD[Ih.Eje]=nr.jvl;this.yD[Ih.X8c]=nr.getBookmark;this.yD[Ih.Tje]=nr.UEl;this.yD[Ih.Vje]=nr.waa;this.yD[Ih.npb]=nr.Twl;this.yD[Ih.l9c]=nr.fZh;this.yD[Ih.Oje]=nr.NBl}Zbm(){const b=[Ih.eke,Ih.yje,Ih.Bke];this.Qjb[xw.rkg]=[[Ih.ppb],b,[Ih.npb],[Du.CPb],[Ih.Z8c]];this.Qjb[xw.gjg]=[[Ih.ppb],[Ih.Fje,Ih.Nje,Ih.Yke],b,[Ih.npb],[Du.CPb]];
this.Qjb[xw.Ngg]=[[Ih.Oje],[Ih.n9c,Ih.q9c],[Ih.X8c,Ih.npb],[Du.CPb]];this.Qjb[xw.hhg]=[[Ih.l9c],[Ih.Lje],[Du.yke],[Du.Mje],[Ih.ppb],[Ih.Yje,Ih.Xje,Ih.xke,Ih.Eke],[Ih.lke,Ih.oke,Ih.q9c],[Ih.n9c],b,[Ih.Z8c],[Ih.Vje,Ih.X8c,Ih.Tje,Ih.npb],[Ih.mke],[Ih.Dke],[Ih.Eje],[Ih.Cke],[Du.CPb]];this.Qjb[xw.$gg]=[[Ih.ppb],[Ih.npb]];this.Qjb[xw.Hgg]=[[Ih.ppb],[Ih.Xje]];this.Qjb[xw.Vxj]=[[Ih.l9c],[Ih.Lje],[Du.yke],[Du.Mje],[Ih.ppb],[Ih.Fje],[Ih.Nje],[Ih.Yke],[Ih.Yje],[Ih.xke],[Ih.Eke],[Ih.lke],[Ih.oke],[Ih.Oje],[Ih.n9c],
[Ih.q9c],[Ih.Vje],[Ih.eke],[Ih.yje],[Ih.Bke],[Ih.X8c],[Ih.Tje],[Ih.npb],[Ih.mke],[Ih.Z8c],[Ih.Dke],[Ih.Eje],[Ih.Cke],[Du.CPb]]}}Object(m.a)(pp,"EditSurfaceContextMenu",jk,[]);var xw;(function(b){b[b.rkg=1]="TABLE_MULTI_CELL";b[b.hhg=2]="GENERIC";b[b.gjg=3]="PICTURE";b[b.Ngg=4]="EQUATION";b[b.Vxj=5]="LEGACY";b[b.$gg=6]="FLUID";b[b.Hgg=7]="DRAWING"})(xw||(xw={}));Object(m.b)("Scenarios",xw);class Du{}Du.CPb=new Du;Du.Mje=new Du;Du.yke=new Du;Object(m.a)(Du,"Sections",null,[]);var Ih;(function(b){b[b.l9c=
1]="INTENT_SUGGESTION";b[b.ppb=2]="ESSENTIALS";b[b.Yje=3]="INSIGHT";b[b.Xje=4]="ILLUSTRATION";b[b.xke=5]="SMART_LOOKUP";b[b.Eke=6]="TRANSLATE";b[b.lke=7]="PROOFING";b[b.oke=8]="REWRITE_SUGGESTIONS";b[b.n9c=9]="LISTS";b[b.q9c=10]="PARAGRAPH_OPTIONS";b[b.eke=11]="MERGE_SPLIT_CELLS";b[b.yje=12]="ALT_TEXT";b[b.Vje=13]="HYPERLINK";b[b.X8c=14]="BOOKMARK";b[b.Tje=15]="HEADING_LINK";b[b.npb=16]="COMMENT";b[b.mke=17]="PULL_QUOTE";b[b.Yke=18]="WRAP_TEXT";b[b.Nje=19]="DRAW";b[b.Dke=20]="TRACK_CHANGE";b[b.Eje=
21]="CATCHUP_ACTIVITIES";b[b.Cke=22]="TABLE_OF_CONTENTS";b[b.Lje=23]="DESIGNER_REVIEW";b[b.Bke=24]="TABLE_ITEMS";b[b.Fje=25]="CHANGE_PICTURE";b[b.Oje=26]="EQUATION_TOOLS";b[b.Z8c=27]="CONTENT_CONTROL"})(Ih||(Ih={}));Object(m.b)("SectionItem",Ih);class cC extends Cu{constructor(b,h,u){super();this.Xl=null;this.F4d=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;y=[];P=[];this.V7n()&&P.push("InsertTabStopMenuSplitButton");this.G7n()&&P.push("ClearAllTabStops");P.push("HideRuler");y.push(cC.z_h(P));P=Object.assign(new $f.a,
{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});P.MenuSectionList.push(...y);Pa.MenuItems=P;return 32};this.ga=b;this.Sm=h;this.Ww=u;this.Wb()}get U9a(){return document.getElementById("WACHorizontalRuler")}get VM(){return this.Sm&&this.Sm.instance?this.Sm.instance.jj:1}get target(){return this.Xl}show(b,h){this.Xl=b;Cu.TMb("RulerContextMenu",b,h);w.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",cC.lO);b.set("Response",
"Ruler Context menu invoked.");Ta.Health.instance.recordKpiUsage(cC.kpiName,1,cC.S6,b)}cRl(){var b=0,h=(this.target.x-Je.a.xgf(this.U9a))/this.VM;h=Bf.a.jy(h,0);var u={},y=this.Ww.M3b,P=yd.GraphIterator.$a(y);P.zd();if(!xh.TableReader.Jw(P))return 32===this.ga.Ub(Oa.a.KFa,2,u)&&(b=u.marginLeft),h-b;b={};P={};u=this.ga.Ub(Oa.a.SZc,2,b);var aa=this.ga.Ub(Oa.a.oKb,2,P);if(32!==u||32!==aa)return w.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;
aa=P.TablePosition;if(!aa||!b||0>=b.length)return w.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;u=0;P=yd.GraphIterator.$a(y);P.Ab(14)&&(P.kd(16),u=dm.a(P,!0));y=aa.x/this.VM;for(P=0;P<u;P++)y+=b[P];return h-y}Wb(){this.ga.gb(Rc.a.F4d,oc.a.application,this.F4d,96)}V7n(){var b={},h={},u=this.ga.Ub(Oa.a.KFa,2,b),y=this.ga.Ub(Oa.a.j4a,2,h);if(32===u&&32===y){y=h.it;u=Bf.a.Mi(y.Zma,0);y=1===y.specialIndentType?Bf.a.Mi(y.UA,0):Bf.a.Mi(y.UA-y.wca,0);const P=
Bf.a.Mi(b.marginLeft,0);b=Bf.a.Mi(b.marginRight,0);const aa=Je.a.xgf(this.U9a),ta=Je.a.dTh(this.U9a);h.isRtl?(h=aa+this.VM*Math.max(b,b+u),u=ta-this.VM*Math.max(P,P+y)):(h=aa+this.VM*Math.max(P,P+y),u=ta-this.VM*Math.max(b,b+u));if(this.target.x>=h&&this.target.x<=u)return!0}return!1}G7n(){var b={};if(32!==this.ga.Ub(Rc.a.aKb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static z_h(b){const h=Object.assign(new xi.a,{ControlList:[]});for(const u of b)h.ControlList.push(Object.assign(new Qe.a,
{ExternalId:u}));return h}}cC.S6="wwaengidc";cC.kpiName="WordRuler";cC.lO="RulerContextMenu";Object(m.a)(cC,"RulerContextMenu",Cu,[510]);let GA;class ar{static get nc(){return null!=ar.Syg?ar.Syg:ar.Syg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get HM(){return null!=ar.Kyg?ar.Kyg:ar.Kyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get uj(){return null!=ar.Kqg?ar.Kqg:ar.Kqg=Ja.a.instance.resolve("Box4.IInsertionPointFormatting")}static $Oi(b,h,u){if(1===h)return(b?
ar.CAk(u):ar.cAk(u))?32:8;(b=ar.fVl(b,u))&&ar.mmk(b,u);return 32}static mmk(b,h){const u=new dg.GraphTransaction(15);u.Eb(h);ar.uj.E4a();ar.HM.QK(b,h,!1);u.dispose()}static CAk(b){b=ar.nc.Xn(b);return!!b&&ar.nc.qf(b)!==hl.StyleReader.wordStyleIdHeading1}static cAk(b){b=ar.nc.Xn(b);return!!b&&ar.nc.qf(b)!==hl.StyleReader.e7a}static fVl(b,h){const u=ar.nc.Xn(h);return u?ar.nc.jx(h).fh(ar.dVl(b,ar.nc.qf(u))):null}static dVl(b,h){h=ar.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<ar.headingsList.count?
ar.headingsList.J(b):null}}ar.headingsList=(GA=new ob.a,GA.add(hl.StyleReader.wordStyleIdHeading1),GA.add(hl.StyleReader.wordStyleIdHeading2),GA.add(hl.StyleReader.wordStyleIdHeading3),GA.add(hl.StyleReader.b7a),GA.add(hl.StyleReader.c7a),GA.add(hl.StyleReader.d7a),GA.add(hl.StyleReader.dpb),GA.add(hl.StyleReader.epb),GA.add(hl.StyleReader.e7a),GA);Object(m.a)(ar,"NavigationPaneEditor",null,[]);class wE extends Cu{constructor(){super();this.G2=null;this.y4d=(b,h,u,y,P)=>{if(1===u)return 32;b=new Sys.StringBuilder;
b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Cu.aRh("promoteHeading",Rc.a.q5d,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Cu.aRh("demoteHeading",Rc.a.rDd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");P.PopulationXML=b.toString();return 32};this.q5d=(b,h,u)=>ar.$Oi(!0,u,
this.G2.yb);this.rDd=(b,h,u)=>ar.$Oi(!1,u,this.G2.yb)}show(b){wE.Ah||(this.j1b(),wE.Ah=!0);Cu.showContextMenu("mnuNavPaneWordEditor",b)}j1b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Rc.a.BMi;b.Command=""+Wa.a.Jka;Cu.bSk(b);r.AFrameworkApplication.ya.pa(Rc.a.BMi,oc.a.application,this.y4d);r.AFrameworkApplication.ya.pa(Rc.a.q5d,oc.a.view,this.q5d);r.AFrameworkApplication.ya.pa(Rc.a.rDd,oc.a.view,this.rDd)}}wE.Ah=!1;Object(m.a)(wE,"WordEditorNavigationPaneContextMenu",
Cu,[506]);var hx=c(296),zB=c(1435),aM=c(485),bM=c(748),cF=c(1171),YF=c(1642),ZF=c(978);class dF{constructor(){this.v7=this.Zji=!1;this.SNb=2;this.mt=0;this.j7a=1}}Object(m.a)(dF,"WrapTextPropertiesData",null,[]);class fm extends cF.a{constructor(b=null){super(b);this.o4g=new YF.a;this.Eah=new dF;this.M7g=new ZF.a;this.$ve=!1;this.Gbi=h=>{const u=new hx.a;u.KCa=!0;u.vL=h;return u};this.Q_=()=>{const h=new hx.a;h.VDb=!1;h.vL=Oa.a.KFa;h.vd=this.o4g;h.r9b=!0;h.kga=!0;return h};this.ZPi=()=>{const h=new hx.a;
h.VDb=this.$ve;this.$ve=!0;h.vL=Oa.a.k4a;h.vd=this.M7g;h.r9b=!0;h.kga=!0;return h};this.G8c=()=>{const h=new hx.a;h.VDb=!1;h.vL=Rc.a.Vdc;h.vd=this.Eah;h.r9b=!0;h.kga=!0;return h};this.ZPd=(h,u)=>{const y=new hx.a;y.vd=new uh.DictionaryPropertySet;switch(h){case Rc.a.wOc:y.vd.setValue(ld.a.Chb,u[Df.a.Number]);break;case Rc.a.tOc:y.vd.setValue(ld.a.zhb,u[Df.a.Number]);break;case Rc.a.uOc:y.vd.setValue(ld.a.Ahb,u[Df.a.Number]);break;case Rc.a.vOc:y.vd.setValue(ld.a.Bhb,u[Df.a.Number])}return y};this.ppn=
()=>{const h=new hx.a;h.vd=new uh.DictionaryPropertySet;h.kga=!0;return h}}initialize(){super.initialize();this.ld.Z(Rc.a.HAf,zB.a.Nhb);this.ld.Z(Rc.a.MAf,zB.a.Nhb);this.ld.Z(Rc.a.OAf,zB.a.Nhb);this.ld.Z(Rc.a.STf,fm.VQa);this.ld.Z(Rc.a.MZc,fm.VQa);this.ld.Z(Rc.a.LTf,fm.VQa);this.ld.Z(Wa.a.rKb,fm.VQa);this.ld.Z(Oa.a.Y5d,this.Q_);this.ld.Z(Oa.a.X5d,this.Q_);this.ld.Z(Oa.a.W5d,this.Q_);this.ld.Z(Oa.a.$5d,this.Q_);this.ld.Z(Oa.a.Z5d,this.Q_);this.ld.Z(Oa.a.V5d,this.Q_);this.ld.Z(Oa.a.g6d,this.Q_);this.ld.Z(Oa.a.f6d,
this.Q_);this.ld.Z(Oa.a.e6d,this.Q_);this.ld.Z(Oa.a.b6d,this.Q_);this.ld.Z(Oa.a.c6d,this.Q_);this.ld.Z(Oa.a.d6d,this.Q_);this.ld.Z(Oa.a.eUf,this.Q_);this.ld.Z(Oa.a.dUf,this.Q_);this.ld.Z(Oa.a.wTf,this.Q_);this.ld.Z(Oa.a.yTf,this.Q_);this.ld.Z(Oa.a.xTf,this.Q_);this.ld.Z(Oa.a.vTf,this.Q_);this.ld.Z(Oa.a.n5a,fm.LQm);this.ld.Z(Oa.a.WRa,fm.adn);this.ld.Z(Oa.a.Emb,fm.eJk);this.ld.Z(Oa.a.Oka,fm.VQa);this.ld.Z(Oa.a.yJb,fm.VQa);this.ld.Z(Oa.a.YQa,fm.VQa);this.ld.Z(Oa.a.Qsa,fm.VQa);this.ld.Z(Oa.a.Qwa,fm.VQa);
this.ld.Z(Rc.a.zYc,fm.VQa);this.ld.Z(Rc.a.MHd,zB.a.Ydf);this.ld.Z(Rc.a.NHd,this.FRh);this.Tm.Z(Rc.a.xYc,zB.a.HZa);this.Tm.Z(Rc.a.yYc,zB.a.HZa);this.ld.Z(Oa.a.nMb,zB.a.d_a);this.ld.Z(Oa.a.mMb,zB.a.d_a);this.ld.Z(Oa.a.Smb,zB.a.d_a);this.ld.Z(Oa.a.qUf,this.JE);this.ld.Z(Oa.a.oUf,this.JE);this.ld.Z(Oa.a.pUf,this.JE);this.ld.Z(Oa.a.wM,fm.Cnn);this.Tm.Z(Rc.a.J6d,fm.R_c);this.Tm.Z(Rc.a.K6d,fm.R_c);this.Tm.Z(Rc.a.L6d,fm.R_c);this.Tm.Z(Rc.a.H6d,fm.R_c);this.Tm.Z(Rc.a.I6d,fm.R_c);this.ld.Z(Rc.a.J6d,this.G8c);
this.ld.Z(Rc.a.K6d,this.G8c);this.ld.Z(Rc.a.L6d,this.G8c);this.ld.Z(Rc.a.H6d,this.G8c);this.ld.Z(Rc.a.I6d,this.G8c);this.ld.Z(Rc.a.mje,fm.Dkc);this.ld.Z(Rc.a.nje,fm.Dkc);this.ld.Z(Rc.a.oje,fm.Dkc);this.ld.Z(Rc.a.pje,fm.Dkc);this.ld.Z(Rc.a.qje,fm.Dkc);this.ld.Z(Rc.a.rje,fm.Dkc);this.ld.Z(Rc.a.opa,fm.a4b);this.ld.Z(Rc.a.F5f,fm.a4b);this.ld.Z(Rc.a.G5f,fm.a4b);this.ld.Z(Rc.a.lce,fm.a4b);this.ld.Z(Rc.a.mce,fm.a4b);this.ld.Z(Rc.a.R3c,fm.a4b);this.ld.Z(Rc.a.Jlb,this.ppn);this.ld.Z(Rc.a.vZc,fm.qId);this.ld.Z(Rc.a.N5d,
fm.qId);this.ld.Z(Rc.a.O5d,fm.qId);this.ld.Z(Rc.a.P5d,fm.qId);this.ld.Z(Rc.a.wOc,this.ZPd);this.ld.Z(Rc.a.tOc,this.ZPd);this.ld.Z(Rc.a.uOc,this.ZPd);this.ld.Z(Rc.a.vOc,this.ZPd);this.ld.Z(Oa.a.Vma,this.Gbi);this.ld.Z(Oa.a.zAb,this.Gbi);this.ld.Z(Rc.a.Hlb,fm.Hlb);this.ld.Z(Rc.a.uce,zB.a.d_a);this.ld.Z(Oa.a.vUf,this.ZPi);this.ld.Z(Oa.a.wUf,this.ZPi)}clearCache(){super.clearCache();this.$ve=!1;this.o4g=new YF.a;this.Eah=new dF;this.M7g=new ZF.a}Mhf(){const b=super.Mhf();b.cBa=fm.cBa;b.$Xa=fm.$Xa;return b}static get Bcn(){return null!=
fm.yug?fm.yug:fm.yug=Ja.a.instance.Pa("WordEditor.IPageCommandStringBuilder")}static get nz(){fm.esa||(fm.esa=Ja.a.instance.Pa("WordEditor.ITableBorderManager"));return fm.esa}static VQa(b,h){b=new hx.a;b.vd=h;return b}static H2c(b,h,u){h[ag.a.Description]=b?b.IQm(u):null}static cBa(b,h){const u=Object(na.a)(YF.a,b.vd),y=Object(na.a)(aM.a,b.vd),P=Object(na.a)(dF,b.vd),aa=Object(na.a)(ZF.a,b.vd);let ta=!0;const Pa=fm.Bcn;switch(b.Zkb){default:ta=cF.a.cBa(b,h);break;case Oa.a.Y5d:h[pj.a.Icon]=u.xva?
"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[ag.a.On]=!u.BHb;fm.H2c(Pa,h,0);break;case Oa.a.X5d:h[pj.a.Icon]=u.xva?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[ag.a.On]=1===u.BHb;fm.H2c(Pa,h,1);break;case Oa.a.W5d:h[pj.a.Icon]=u.xva?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[ag.a.On]=2===u.BHb;fm.H2c(Pa,h,2);break;case Oa.a.$5d:h[pj.a.Icon]=u.xva?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[ag.a.On]=3===u.BHb;fm.H2c(Pa,
h,3);break;case Oa.a.Z5d:h[pj.a.Icon]=u.xva?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[ag.a.On]=4===u.BHb;fm.H2c(Pa,h,4);break;case Oa.a.V5d:h[pj.a.Icon]=u.xva?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[ag.a.On]=5===u.BHb;break;case Oa.a.g6d:h[ag.a.On]=!u.ZIb;h[ag.a.Description]=Pa?Pa.KXc(0):null;break;case Oa.a.f6d:h[ag.a.On]=1===u.ZIb;h[ag.a.Description]=Pa?Pa.KXc(1):null;break;case Oa.a.e6d:h[ag.a.On]=2===u.ZIb;h[ag.a.Description]=Pa?Pa.KXc(2):
null;break;case Oa.a.b6d:h[ag.a.On]=3===u.ZIb;h[ag.a.Description]=Pa?Pa.KXc(3):null;break;case Oa.a.c6d:h[ag.a.On]=4===u.ZIb;h[ag.a.Description]=Pa?Pa.KXc(4):null;break;case Oa.a.d6d:h[ag.a.On]=5===u.ZIb;break;case Oa.a.eUf:h[ag.a.On]=!u.xva;break;case Oa.a.dUf:h[ag.a.On]=u.xva;break;case Oa.a.wTf:h[ag.a.On]=1===u.MDc;break;case Oa.a.yTf:h[ag.a.On]=2===u.MDc;break;case Oa.a.xTf:h[ag.a.On]=3===u.MDc;break;case Oa.a.vTf:h[ag.a.On]=0===u.MDc;break;case Oa.a.qUf:h[ag.a.On]=y.it?!y.it.specialIndentType:
!1;break;case Oa.a.oUf:h[ag.a.On]=y.it?1===y.it.specialIndentType:!1;h[Qm.a.Image16by16Class]=y.isRtl?Gd.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Gd.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Oa.a.pUf:h[ag.a.On]=y.it?2===y.it.specialIndentType:!1;h[Qm.a.Image16by16Class]=y.isRtl?Gd.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Gd.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Rc.a.J6d:h[ag.a.On]=1===P.j7a;break;case Rc.a.K6d:h[ag.a.On]=
8===P.j7a;break;case Rc.a.L6d:h[ag.a.On]=9===P.j7a;break;case Rc.a.H6d:h[ag.a.On]=3===P.j7a;break;case Rc.a.I6d:h[ag.a.On]=4===P.j7a;break;case Rc.a.Jlb:h[ag.a.On]=b.vd.ia(ld.a.tva,!1);break;case Rc.a.Hlb:h[te.a.IsFreeForm]=!0;h[te.a.Value]=b.vd[sk.a.Value];break;case Oa.a.vUf:h[Bi.a.On]=fm.nz.bTh(h.MenuItemId)===aa.lineStyle;break;case Oa.a.wUf:h[Bi.a.On]=fm.nz.cTh(h.MenuItemId)===aa.PTc}return ta}static LQm(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=
1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new hx.a;h.vd=b;return h}static adn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new hx.a;h.vd=b;return h}static eJk(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=
3}h=new hx.a;h.vd=b;return h}static Hlb(){const b=new hx.a;b.vL=Rc.a.Hlb;b.vd={};b.kga=!0;b.r9b=!0;return b}static Dkc(b,h){const u=new hx.a;u.vd=new uh.DictionaryPropertySet;let y=1;switch(b){case Rc.a.pje:y=1;break;case Rc.a.qje:y=8;break;case Rc.a.rje:y=9;break;case Rc.a.nje:y=3;break;case Rc.a.oje:y=4}u.vd.setValue(ld.a.j7a,y);u.vd.setValue(ld.a.EGa,h[ag.a.SourceControlId]);return u}static a4b(b,h,u){b=new hx.a;b.vd=u.InvocationMethod;return b}static Cnn(b,h){b=new hx.a;b.vd=h;return b}static R_c(){const b=
new bM.a;b.vL=Rc.a.Vdc;return b}static qId(){const b=new hx.a;b.vd=new uh.DictionaryPropertySet;b.NRc=!0;return b}static $Xa(b,h){let u=!0;switch(b.Zkb){case Rc.a.vZc:b=b.vd.ia(ld.a.Chb,0);h[Df.a.Number]=b;h[Df.a.UnitType]=7;break;case Rc.a.N5d:b=b.vd.ia(ld.a.zhb,0);h[Df.a.Number]=b;h[Df.a.UnitType]=7;break;case Rc.a.O5d:b=b.vd.ia(ld.a.Ahb,0);h[Df.a.Number]=b;h[Df.a.UnitType]=7;break;case Rc.a.P5d:b=b.vd.ia(ld.a.Bhb,0);h[Df.a.Number]=b;h[Df.a.UnitType]=7;break;default:u=cF.a.$Xa(b,h)}return u}}fm.esa=
null;Object(m.a)(fm,"CuiActionBridge",cF.a,[]);class $F extends ff.a{constructor(b){super();this.AJk=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.P4n=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.xDd=this.Mvb=this.j5=this.JVa=this.rLe=null;this.Vb=b;this.Hg="<div id='AccessibilityHelpDialogBody'></div>";this.mg="AAccessibilityHelpDialog";this.Ed=6;this.Ue(0,CommonUIStrings.l_DialogClose)}get i8e(){return null}get ybe(){this.rLe||(this.rLe=this.mdm());return this.rLe}get ijo(){return 300}get Jyi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get Iyi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get pZa(){return this.Vb.Ks()}TRa(b){super.TRa(b);
this.Uhn()}gSa(){this.showDialog(this.dialogTitle,Object(v.a)(this,this.h8j,"accHelpDialogResultHandler"));this.RFa();this.setFocus()}setFocus(){this.j5?(this.Mvb=this.j5.tBodies[0].firstChild,this.EU(this.Mvb)):this.AG&&"none"!==this.AG.style.display?this.EU(this.AG):this.EU(this.wz)}Qka(){this.ie.mb(bb.a.hi,this.xDd,Object(v.a)(this,this.Vah,"accHelpDialogKeydownHandler"));if(this.j5){this.ie.mb(bb.a.sh,this.j5,Object(v.a)(this,this.Ogj,"tableOnKeyUpHandler"));const b=this.j5.tBodies[0].children;
for(let h=0;h<b.length;h++)if(rf.a.addHandler(b[h],bb.a.focus,Object(v.a)(this,this.Z_i,"rowOnFocusHandler")),rf.a.addHandler(b[h],bb.a.blur,Object(v.a)(this,this.Y_i,"rowOnBlurHandler")),ba.a.kt){const u=b[h].children;for(let y=0;y<u.length;y++)rf.a.addHandler(u[y],bb.a.focus,Object(v.a)(this,this.Cqh,"cellOnFocusHandler"))}}super.Qka()}qeb(){this.ie&&(this.ie.sc(bb.a.hi,this.xDd,Object(v.a)(this,this.Vah,"accHelpDialogKeydownHandler")),this.j5&&this.ie.sc(bb.a.sh,this.j5,Object(v.a)(this,this.Ogj,
"tableOnKeyUpHandler")));if(this.j5){const b=this.j5.tBodies[0].children;for(let h=0;h<b.length;h++)if(rf.a.removeHandler(b[h],bb.a.focus,Object(v.a)(this,this.Z_i,"rowOnFocusHandler")),rf.a.removeHandler(b[h],bb.a.blur,Object(v.a)(this,this.Y_i,"rowOnBlurHandler")),ba.a.kt){const u=b[h].children;for(let y=0;y<u.length;y++)rf.a.removeHandler(u[y],bb.a.focus,Object(v.a)(this,this.Cqh,"cellOnFocusHandler"))}}super.qeb()}RFa(){this.pZa.scope.Mr(this.Vb.XV);this.pZa.scope.Mr(this.Vb.YV);this.pZa.scope.bindAction(this.Vb.XV,
Wa.a.bAc);this.pZa.scope.bindAction(this.Vb.YV,Wa.a.aAc)}K4l(b){if(!this.pZa.Xj||!this.pZa.Xj.G2)return 2;var h=this.pZa.Xj.G2;if(this.j5&&(h===this.wz&&b===Wa.a.bAc||h===this.JVa&&b===Wa.a.aAc))this.EU(this.Mvb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Wa.a.bAc?h=this.JVa:b===Wa.a.aAc&&(h=this.wz),h&&this.EU(h);else if(b===Wa.a.bAc)this.pZa.Uac();else if(b===Wa.a.aAc)this.pZa.Sac();else return 2;return 32}Z_i(b){b.target.setAttribute(hf.a.xcb,hf.a.ep);Sys.UI.DomElement.removeCssClass(this.Mvb,
"inactiveRowSelection");this.Mvb=b.target}Y_i(b){b.target.removeAttribute(hf.a.xcb);Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}Cqh(b){(b=b.target.parentNode)&&b!==this.Mvb&&this.EU(b)}Ogj(b){return b.Ib.keyCode===fb.a.us?(b.Ib.stopPropagation(),!0):!1}Vah(b){if(!b.Ib)return!1;const h=b.Ib.keyCode;if(b.eventName===bb.a.hi){b=this.sGl(this.Mvb);let u=-1;const y=Ma.a.count(this.ybe)-1;h===Sys.UI.Key.down?u=b<y?b+1:0:h===Sys.UI.Key.up?u=0<b?b-1:y:h===Sys.UI.Key.home?u=0:h===Sys.UI.Key.end&&
(u=y);-1!==u&&this.EU(this.j5.tBodies[0].children[u])}return!0}h8j(){}Uhn(){this.xDd=document.getElementById("AccessibilityHelpDialogBody")||this.Mp;this.sXk();this.aXk();this.UUk()}sXk(){if(this.i8e){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.i8e;b.appendChild(h);this.jja.appendChild(b)}}aXk(){if(this.ybe&&!Ma.a.isEmpty(this.ybe)){this.j5=document.createElement("table");this.j5.className="SelectableDialogTable";var b=
document.createElement("thead"),h=document.createElement("tr");h.setAttribute(hf.a.wh,hf.a.GBc);b.appendChild(h);var u=Hc.a.bFc(14,this.AJk);h.appendChild(u);u=Hc.a.bFc(14,this.P4n);h.appendChild(u);this.j5.appendChild(b);b=document.createElement("tbody");h=0;u=this.ybe;for(let aa in u){var y=aa,P=u[aa];const ta=document.createElement("tr");ta.tabIndex=0;ta.setAttribute(hf.a.wh,hf.a.GBc);ta.id="SelectableTableRow"+h++;y=Hc.a.bFc(15,y);ta.appendChild(y);P=Hc.a.bFc(15,P);ta.appendChild(P);b.appendChild(ta)}b.style.maxHeight=
this.ijo+"px";this.j5.appendChild(b);this.xDd.appendChild(this.j5)}}UUk(){if(this.Iyi&&this.Jyi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.JVa=document.createElement("a");this.JVa.innerText=this.Iyi;this.JVa.href=this.Jyi;this.JVa.target="_blank";this.JVa.id=this.mj("AccessibilityHelpDialogLink");this.JVa.className=xe.AFrame.IUe;b.appendChild(this.JVa);this.Lc.insertBefore(b,this.Lc.lastChild)}}sGl(b){return Number.parseInvariant(b.id.substr(18))}iZ(b,
h,u,y=null){b&&h&&u&&(u=y?String.format(u,y):u,b[h]=u)}F4h(b,h){return ba.a.Kl?h:b}}Object(m.a)($F,"AAccessibilityHelpDialog",ff.a,[950]);class GC extends $F{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get i8e(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}mdm(){var b;const h=this.F4h(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),u=this.F4h(CommonUIStrings.l_AccHelpDialogWindowsKey,
CommonUIStrings.l_AccHelpDialogCtrlKey),y={};this.iZ(y,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.iZ(y,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,h);this.iZ(y,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.iZ(y,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,u);this.iZ(y,CommonUIStrings.l_AccHelpDialogTooltipToggle,
CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);
vk.App.Tie&&this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,h);this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,h);(null===(b=vk.App.instance)||void 0===b?0:b.tib)&&this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,h);r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.iZ(y,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);r.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.iZ(y,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);
(GC.$b&&GC.$b.isFeatureEnabled(61)||r.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.iZ(y,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return y}static get $b(){return null!=GC.Fog?GC.Fog:GC.Fog=Ja.a.instance.Pa("Box4.IFeatureHelper")}}Object(m.a)(GC,"AccessibilityHelpDialog",$F,[]);var KH=c(310);class eF{static get Hg(){return ff.a.Sy(eF.am,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}
eF.am="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";Object(m.a)(eF,"ApplyStylesDialogHtml",null,[]);class vD extends ff.a{constructor(b,
h){super();this.QG=null;this.zyc=!1;this.Xwb=this.U7a=this.avc=this.dvc=this.Nyc=null;this.Smk=(u,y)=>{if(this.gg.$r){if(u){u=y.styleList;y=y.styleText;if(-1===u||A.a.jh(y)!==A.a.jh(this.QG[u]))u=this.Y4h(y);y=this.QG[u];u=this.nc.Yn();y=this.nc.qf(u.Qua(y));r.AFrameworkApplication.ya.Tf(this._context,Oa.a.applyStyle,2,!1,new KH.a,y)}this.gg.b0()}};this.X9m=u=>{this.zyc?(this.zyc=!1,this.validate()):"value"===u.rawEvent.propertyName&&(this.zyc=!0,this.jN.value!==this.Nyc&&(this.Nyc=this.jN.value,
this.Hkh()))};this.K5m=()=>{-1!==this.nka.selectedIndex&&(ba.a.v3&&(this.zyc=!0),this.Nyc=this.QG[this.nka.selectedIndex],this.jN.value=this.QG[this.nka.selectedIndex],this.validate())};this.onKeyDown=u=>{ba.a.sJ?u.keyCode!==fb.a.sB&&u.keyCode!==fb.a.z0||this.U7a||this.Xwb||(this.Xwb=new sc.a(0,1,1,this.qEo),r.AFrameworkApplication.uc.Xb(this.Xwb)):ba.a.v3&&u.keyCode===fb.a.sB&&(this.zyc=!0)};this.gG=()=>{this.U7a||(this.U7a=new sc.a(0,1,1,this.wpk),r.AFrameworkApplication.uc.Xb(this.U7a));this.Xwb&&
(r.AFrameworkApplication.uc.Se(this.Xwb),this.Xwb=null)};this.wpk=()=>{this.U7a=null;this.Hkh()};this.qEo=()=>{this.Xwb=null;this.validate()};this._context=b;this.Wc=h;this.mg="ApplyStylesDialog";this.gg=this._context.view;this.Nmf();b=this.Xgo();h="";this.QG.length>b&&(h=this.QG[b]);h={["styleText"]:h,["styleList"]:b};this.Hg=eF.Hg;this.Wh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.Smk,h);this.nka=document.getElementById("styleList");this.gRf();this.nka.selectedIndex=b;this.jN=document.getElementById("styleText");
this.jN.focus();this.jN.select();this.pld=this.K5m;rf.a.addHandler(this.nka,"change",this.pld);this.old=this.onKeyDown;rf.a.addHandler(this.jN,"keydown",this.old);ba.a.v3?(this.dvc=this.X9m,rf.a.addHandler(this.jN,"propertychange",this.dvc),this.Nyc=this.QG[b]):(this.avc=this.gG,rf.a.addHandler(this.jN,"keypress",this.avc))}get nc(){return null!=this.Uyg?this.Uyg:this.Uyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}Xgo(){var b=this.gg.Bb;if(!b||!b.hb)return Ab.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),
0;b=b.hb.kb;if(!b)return Ab.b(579216409,3018,15,"CurrentSelection is null"),0;be.ParagraphReader.em(b.Qa)&&(b=Se.SelectionEditor.Vj(b,!0,!1));b=b.Qa;if(!b||!Se.SelectionEditor.Xu(b))return Ab.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Wi.FormattingReader.zr(b);(h=Wi.FormattingReader.Kma(h))||(h=this.nc.Xn(b.node));if(!h)return 0;b=this.nc.WF(h);b=Array.indexOf(this.QG,b);0>b&&(b=0);return b}gRf(){const b=this.QG.length;for(let h=0;h<b;h++){const u=document.createElement("OPTION");
u.value=h.toString();u.text=this.QG[h];this.nka.add(u,null)}}Nmf(){var b=uk.a.Xv();if(b){b=(new uo.WACStyleSet).VL(b);var h=b.GL,u=this.Wc.isFeatureEnabled(112)&&!!this.nc.Mg;this.QG=[];for(let y=0;y<h;y++){const P=b.Hfa(y);if(this.nc.isHidden(P))continue;const aa=this.nc.lx(P);if(!u){if(3===aa)continue}else if(3===aa&&this.nc.qf(P)===Yt.a.E8c)continue;Array.add(this.QG,this.nc.WF(P))}this.QG.sort(vD.hLk)}else Ab.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.dvc&&rf.a.removeHandler(this.jN,
"propertychange",this.dvc);this.old&&rf.a.removeHandler(this.jN,"keydown",this.old);this.pld&&rf.a.removeHandler(this.nka,"change",this.pld);this.avc&&rf.a.removeHandler(this.jN,"keypress",this.avc);this.U7a&&r.AFrameworkApplication.uc.Se(this.U7a);this.U7a=this.avc=this.nka=this.jN=this.old=this.dvc=this.pld=null;super.dispose()}Hkh(){var b=this.jN.value,h=this.hbm(b);const u=-1===h?b:this.QG[h];b=b.length;const y=u.length;this.Nyc=u;this.jN.value=u;this.nka.selectedIndex=h;y>b&&(ba.a.sJ?this.jN.setSelectionRange(b,
y):ba.a.v3&&(h=this.jN.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",y-b),h.select()));this.validate();this.jN.focus()}hbm(b){let h=0,u=this.QG.length,y=-1;for(b=A.a.jh(b);h<u;){const P=Math.floor((h+u)/2),aa=vD.N1e(b,this.QG[P]);if(!aa){y=P;break}0<aa?h=P+1:u=P}if(y>h)for(;!vD.N1e(b,this.QG[y-1])&&(y--,y!==h););return y}validate(){const b=-1===this.Y4h(this.jN.value),h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):
(h.style.display="none",h.innerText="");return!b}Y4h(b){b=A.a.jh(b);const h=this.QG.length;for(let u=0;u<h;u++)if(b===A.a.jh(this.QG[u]))return u;return-1}static N1e(b,h){const u=Math.min(b.length,h.length);b=A.a.jh(b);h=A.a.jh(h);for(let y=0;y<u;y++){const P=A.a.charCodeAt(b,y),aa=A.a.charCodeAt(h,y);if(P!==aa)return P-aa}return b.length<=h.length?0:1}static hLk(b,h){return vD.N1e(b,h)}}Object(m.a)(vD,"ApplyStylesDialog",ff.a,[]);class fF{static get Hg(){return ff.a.Sy(fF.am,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,
WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists)}}fF.am="<div class='normal' id='text'> <label id='NameLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <br/> <div class='normal' id='text'> <label id='ParagraphLabel' class='WACDialogLabel' >{1}</label> <div id='previewContainer' class='previewContainer' style='height: 40px; border: solid 1px #c3cbd0; position: relative; overflow: hidden;'></div> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleNameError' role='alert'>{2}</div> </div>";
Object(m.a)(fF,"CreateNewStyleDialogHtml",null,[]);class fu extends ff.a{constructor(b,h,u=!1){super(!1,!1,u);this.cF=null;this._context=b;this.ga=h;u=h=null;this.mg=fu.id;if(this.gg=b.view)u=this.gg.Bb;u&&u.hb&&u.hb.kb&&(h=u.hb.kb.Qa);h?(b=h.node)?(this.Fz=fu.mh.Wt(b))?(this.RC=(new uo.WACStyleSet).VL(this.Fz),(this.ZR=this.W6.xGd(h))?(b=this.ZR.ia(Ge.a.fontSize,22),16>b?Ab.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=b?Ab.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):
90>=b?Ab.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Ab.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.GXf(this.ZR)):Ab.b(592737758,3018,10,"_newStyleProperties is null.")):Ab.b(592737757,3018,10,"_pageContenNode is null."):Ab.b(592725466,3018,10,"node is null."):Ab.b(556917206,3018,10,"nodeContext is null.")}GXf(b){b.Ng(vi.a.paragraphStyle,vi.a.Rv,...$k.a.XF())}get W6(){return this.cF||(this.cF=Ja.a.instance.resolve("Box4.IFormattingReader"))}get nc(){return null!=
this.$yg?this.$yg:this.$yg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}Hkf(b){if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,u=b.GL;let y;for(y=1;y<=u;y++){const P=h+y;let aa=b.fh(P)||b.S5b(P);aa||(aa=b.fh(P+"Char")||b.S5b(P+"Char"));if(!aa)break}return h+y}xAc(b,h){const u=new dg.GraphTransaction(15);u.Eb(this.Fz);u.Kk=Oa.a.createNewStyle;if(h=uk.a.xAc(b,uk.a.D2h(h),null,this.Fz))Ab.b(593078046,3018,50,"User created linked style"),this.RC=(new uo.WACStyleSet).VL(this.Fz),
b=A.a.$wa(A.a.UZ(b)),b=this.RC.S5b(b),this.ga.Tf(this._context,Oa.a.applyStyle,2,!1,new KH.a,this.nc.qf(b));u.dispose();return h}nsj(b){var h=A.a.$wa(b);const u=""===A.a.$wa(b),y=b.length>fu.RRm,P=RegExp("[{|}|;|\\\\]").test(b);b=!!this.RC.Qua(b)||!!this.RC.S5b(h);h=null;if(u||y||P||b)h=u?WordEditorIntl.WordEditorStrings.l_StyleNameEmpty:y?WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength:P?WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters:WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;
return h}static get mh(){return xl.PageNavigator.instance}}fu.id="CreateNewStyleDialog";fu.XYd=26;fu.RRm=253;fu.ufj=5;fu.tfj=40;Object(m.a)(fu,"ACreateNewStyleDialog",ff.a,[]);class LH extends fu{constructor(b,h){super(b,h);this.fVk=u=>{this.gg.$r&&(u&&(u=new Map,u.set("Source","CreateNewStyleDialog"),u.set("Action","CreateStyle"),Ta.Health.instance.recordKpiUsage($k.a.Kia,0,$k.a.eD,u),this.xAc(this.jN.value,this.ZR)||(u=new Map,u.set("Source","CreateNewStyleDialog"),u.set("Action","CreateStyle"),
u=Object.assign(new Ya.a,{extendedProperties:u}),Ta.Health.instance.recordKpiFailure($k.a.Kia,"CreateStyleFailed",!1,!0,u))),this.gg.b0())};this.Fz&&this.ZR&&(b=this.Hkf(this.RC),h={["styleText"]:b},this.Hg=fF.Hg,this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.fVk,h),this.jN=document.getElementById("styleText"),this.EU(this.jN),h=document.getElementById("previewContainer"),this.U1n(this.ZR,b,h),this.Bdd=document.getElementById("badStyleNameError"))}Wyl(b){const h=b.ia(Ge.a.fontSize,
Fg.a.qI)>=2*fu.XYd;b=jv.a.tVh(b,"97%",fu.XYd,!1,!0,h)+" padding-left: "+fu.ufj+"px;";h||(b=b+" line-height: "+fu.tfj+"px;");return b}U1n(b,h,u){const y=document.createElement("div");y.innerText=h;b=this.Wyl(b);y.setAttribute("style",b);u.appendChild(y)}validate(){const b=this.nsj(this.jN.value),h=!!b;h?(this.Bdd.style.display="inline-block",this.Bdd.innerText=b):(this.Bdd.style.display="none",this.Bdd.innerText="");return!h}}Object(m.a)(LH,"CreateNewStyleDialog",fu,[]);var wD=c(341);class MH extends Gh.StandardDialog{constructor(b){super();
this.nv=b;this.I9n()}I9n(){this.Ed=1;this.DU(1);this.Ue(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.xv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.H7e.bind(this))}H7e(b){1===b&&this.nv.Vha("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Di?Ab.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.TKn(),Ab.b(524834399,3018,50,"User deleted saved styles via UI."))},
8)}TKn(){wD.a.Sob="{}"}}Object(m.a)(MH,"DeleteSavedStylesConfirmationDialog",Gh.StandardDialog,[]);class NH extends Gh.StandardDialog{constructor(b,h){super();this.H7e=P=>{if(1===P){P=new Map;P.set("Source","DeleteStyleConfirmationDialog");P.set("Action","DeleteStyle");Ta.Health.instance.recordKpiUsage($k.a.Kia,0,$k.a.eD,P);var aa=uk.a.Xv();P=new dg.GraphTransaction(15);P.Eb(aa);P.Kk=Oa.a.pAb;this.HM.s1k(this.j7g)?Ab.b(578359694,3018,50,"User deleted a style via UI."):(aa=new Map,aa.set("Source",
"DeleteStyleConfirmationDialog"),aa.set("Action","DeleteStyle"),aa=Object.assign(new Ya.a,{extendedProperties:aa}),Ta.Health.instance.recordKpiFailure($k.a.Kia,"DeleteStyleFailed",!1,!0,aa),Ab.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));P.dispose()}};h||Ab.b(590128417,3018,10,"styleId is null");let u=null,y=null;if(this.gg=b.view)y=this.gg.Bb;y&&(u=y.hb.kb.Qa);u?(b=u.node)?(this.Fz=this.mh.Wt(b))?(this.j7g=new ob.a,this.j7g.add(h),this.J9n(h)):Ab.b(590128448,
3018,10,"_pageContenNode is null."):Ab.b(590128419,3018,10,"node is null."):Ab.b(590128418,3018,10,"nodeContext is null.")}get HM(){return null!=this.Iyg?this.Iyg:this.Iyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get nc(){return null!=this.bzg?this.bzg:this.bzg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get mh(){return null!=this.Mug?this.Mug:this.Mug=xl.PageNavigator.instance}J9n(b){const h=(new uo.WACStyleSet).VL(this.Fz);h?((b=h.fh(b))||Ab.b(590128450,3018,10,"Style set doesn't contain style with given ID"),
b=this.nc.WF(b),this.Ed=4,this.DU(2),this.xv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.H7e)):Ab.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(m.a)(NH,"DeleteStyleConfirmationDialog",Gh.StandardDialog,[]);class gF{static get Hg(){return ff.a.Sy(gF.am)}}gF.am="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(m.a)(gF,
"DeleteStyleDialogHtml",null,[]);class OH extends ff.a{constructor(b){super();this.Fz=this.QG=null;this.$1k=(h,u)=>{this.gg.$r&&(h?(h=u.styleList,-1!==h&&(h=this.QG[h],u=this.nc.Yn(),h=this.nc.qf(u.Qua(h)),this.uGc.Z1k(this._context,h),this.gg.b0())):this.gg.b0())};this._context=b;this.mg="DeleteStyleDialog";this.Ed=1;this.Ue(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.gg=this._context.view;this.Nmf();this.Hg=gF.Hg;this.Wh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.$1k,
{["styleList"]:0});this.nka=document.getElementById("styleList");this.gRf();this.nka.selectedIndex=0;this.nka.focus()}get nc(){return null!=this.Wyg?this.Wyg:this.Wyg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get uGc(){return null!=this.Bng?this.Bng:this.Bng=Ja.a.instance.resolve("WordEditor.UI.IDialogFactory")}gRf(){const b=this.QG.length;for(let h=0;h<b;h++){const u=document.createElement("OPTION");u.value=h.toString();u.text=this.QG[h];this.nka.add(u,null)}}Nmf(){if(this.Fz=uk.a.Xv()){var b=
(new uo.WACStyleSet).VL(this.Fz),h=b.GL;this.QG=[];for(let y=0;y<h;y++){const P=b.Hfa(y);if(!this.nc.isHidden(P)&&this.nc.ee(P,b)){var u=this.nc.lx(P);if(2===u||1===u)P.hasProperty(Lc.a.Ac)&&2!==u||(u=P.ia(Lc.a.yF,null))&&0<u.length||this.QG.push(this.nc.WF(P))}}this.QG.sort()}else Ab.b(578650370,3018,15,"PageContentNode is null")}}Object(m.a)(OH,"DeleteStyleDialog",ff.a,[]);var cM=c(771);class PH{constructor(b){this.customData=null;this.RN=b}}Object(m.a)(PH,"PropertySetChangedState",null,[]);class QH{static Tln(b,
h,u){if(b&&h){var y=new PH(h),P=(aa,ta,Pa)=>{u.Sln(aa,ta,Pa,y)};b=new cM.a(h,b);b.jvd=P;b.ryd=P;b.r8d=P;b.vdc()}}}Object(m.a)(QH,"PropertySetChangedManager",null,[]);class RH{constructor(b){this.c$=b}Sln(b,h,u,y){const P=this.c$[b.id.toString()];P&&P(b,h,u,y)}}Object(m.a)(RH,"PropertyChangedProcessor",null,[]);const xD=(b,h,u)=>{const y=Zq.a.instance.M3b;if(y){const P=new dg.GraphTransaction(15);P.Eb(y);QH.Tln(b,h,new RH(u));P.dispose()}};class hF{static get Hg(){return ff.a.Sy(hF.am,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}hF.am="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(m.a)(hF,"MarginsDialogHtml",null,[]);class Gr{static get V3(){return null!=Gr.zug?Gr.zug:Gr.zug=Ja.a.instance.Pa("WordEditor.IPageCommands")}static HQm(b,h,u){Gr.V3&&null!==u&&Gr.V3.Hae(0,u)}static DQm(b,h,u){Gr.V3&&null!==u&&Gr.V3.Hae(3,u)}static FQm(b,h,u){Gr.V3&&null!==u&&Gr.V3.Hae(1,u)}static GQm(b,h,u){Gr.V3&&null!==u&&Gr.V3.Hae(2,u)}static kdn(b,h,u){Gr.V3&&null!==u&&Gr.V3.WRa(0,u)}static Mcn(b,h,u){Gr.V3&&null!==u&&Gr.V3.WRa(1,u)}static gJk(b,h,u){Gr.V3&&null!==u&&(b==Yi.a.fE?Gr.V3.R$d(0,
u):b==Yi.a.zF?Gr.V3.R$d(1,u):b==Yi.a.hla?Gr.V3.R$d(2,u):b==Yi.a.separator&&Gr.V3.R$d(3,u))}}Object(m.a)(Gr,"PageLevelPropertyChangedHandlers",null,[]);const SH=[Rc.a.pXc,Rc.a.oXc,Rc.a.F2d,Rc.a.G2d,Rc.a.U5d,Rc.a.R5d,Rc.a.S5d,Rc.a.T5d];class Cz extends ff.a{constructor(b,h,u,y,P,aa){super();this.Pva=aa;this.vNa=(ta,Pa)=>{var vb=Cz.eZc(ta);ta=Ra.App.T7;this.Ff.hasProperty(vb)?(vb=this.Ff.getValue(vb),Pa[Df.a.Number]=Xf.a.GHa(vb,ta)):Pa[Df.a.Number]=0;Pa[Df.a.UnitType]=ta};this.QRa=(ta,Pa)=>{this.Ff.setValue(Cz.eZc(ta),
Xf.a.Kpa(Pa[Df.a.Number],Pa[Df.a.UnitType]));this.ku.Nl()};this.JQm=ta=>{let Pa=!1;1===ta&&(Math.abs(this.Ff.getValue(Lc.a.marginTop))+Math.abs(this.Ff.getValue(Lc.a.marginBottom))+Ra.App.oya<=this.u$.getValue(Lc.a.ew)&&this.Ff.getValue(Lc.a.marginLeft)+this.Ff.getValue(Lc.a.marginRight)+Ra.App.oya<=this.u$.getValue(Lc.a.Ao)?xD(this.xV,this.Ff,Cz.h0a()):Pa=!0);this.dispose();Pa&&this.wxa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.EQm)};this.EQm=()=>{Ja.a.instance.resolve("WordEditor.UI.IDialogFactory").eAh(this.xV,
this.u$,this.zV)};this.mg="MarginsDialog";this.u$=h.clone();this.xV=b.clone();this.Ff=b.clone();this.zV=u;this.pV=!1;this.ku=P;this.Hg=hF.Hg;u&&(this.KRb=ir.a.nob);this.Wh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.JQm,null);this.aPc();this.Pva&&(this.LMe=document.getElementById("DialogMarginTopSpinner"),this.EU(this.LMe))}QX(){this.mxd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Rc.a.pXc,Rc.a.U5d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.mxd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Rc.a.oXc,Rc.a.R5d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.mxd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Rc.a.F2d,Rc.a.S5d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.mxd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Rc.a.G2d,Rc.a.T5d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}aPc(){for(const b of SH)Object(ek.a)(b,this.QRa,this.vNa);this.ku.pU("DialogMarginTopSpinner");
this.ku.pU("DialogMarginBottomSpinner");this.ku.pU("DialogMarginLeftSpinner");this.ku.pU("DialogMarginRightSpinner")}dispose(){for(const b of SH)Object(ek.b)(b);this.ku.LE("DialogMarginTopSpinner");this.ku.LE("DialogMarginBottomSpinner");this.ku.LE("DialogMarginLeftSpinner");this.ku.LE("DialogMarginRightSpinner");super.dispose()}mxd(b,h,u,y,P){u=Cz.jvk(h,u,y,P);this.cyb(u,b,h)}cyb(b,h,u){h=document.getElementById(h);this.ku.BLa(u,b);b=this.ku.fgb(u,"Medium");h.appendChild(b)}static h0a(){return Cz.c$||
(Cz.c$=Cz.Wdb())}static Wdb(){const b={};b[Lc.a.marginTop.id.toString()]=Gr.HQm;b[Lc.a.marginBottom.id.toString()]=Gr.DQm;b[Lc.a.marginLeft.id.toString()]=Gr.FQm;b[Lc.a.marginRight.id.toString()]=Gr.GQm;return b}static jvk(b,h,u,y){let P=!0;if(h===Rc.a.pXc||h===Rc.a.oXc)P=!1;return ke.l(b,h,u,y,[Cz.lvk(P),Cz.kvk(P)])}static lvk(b){return ke.n("inch",b?"0":"-22","22",".1")}static kvk(b){return ke.n("centimeter",b?"0":"-55.8","55.8","1")}static eZc(b){let h=null;switch(b){case Rc.a.pXc:case Rc.a.U5d:h=
Lc.a.marginTop;break;case Rc.a.oXc:case Rc.a.R5d:h=Lc.a.marginBottom;break;case Rc.a.F2d:case Rc.a.S5d:h=Lc.a.marginLeft;break;case Rc.a.G2d:case Rc.a.T5d:h=Lc.a.marginRight}return h}}Cz.c$=null;Object(m.a)(Cz,"MarginsDialog",ff.a,[]);class iF{static get Hg(){return ff.a.Sy(iF.am,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}iF.am="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(iF,"PaperSizeDialogHtml",null,[]);const TH=[Rc.a.J2d,Rc.a.I2d,Rc.a.i6d,Rc.a.h6d];class gu extends ff.a{constructor(b,h,u,y,P,aa){super();this.Pva=aa;this.vNa=(ta,Pa)=>{var vb=this.eZc(ta);ta=Ra.App.T7;this.Ff.hasProperty(vb)?(vb=this.Ff.getValue(vb),Pa[Df.a.Number]=Xf.a.GHa(vb,ta)):Pa[Df.a.Number]=0;Pa[Df.a.UnitType]=ta};this.QRa=(ta,Pa)=>{this.Ff.setValue(this.eZc(ta),Xf.a.Kpa(Pa[Df.a.Number],Pa[Df.a.UnitType]));this.ku.Nl()};this.wdn=ta=>{let Pa=!1;1===ta&&(this.Ff.getValue(Lc.a.ew)>=
Ra.App.oya+this.u$.getValue(Lc.a.marginTop)+this.u$.getValue(Lc.a.marginBottom)&&this.Ff.getValue(Lc.a.Ao)>=Ra.App.oya+this.u$.getValue(Lc.a.marginLeft)+this.u$.getValue(Lc.a.marginRight)?xD(this.xV,this.Ff,gu.h0a()):Pa=!0);this.dispose();Pa&&this.wxa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.vdn)};this.vdn=()=>{Ja.a.instance.resolve("WordEditor.UI.IDialogFactory").HAh(this.xV,this.u$,this.zV)};this.mg="PaperSizeDialog";this.u$=h.clone();this.xV=b.clone();this.Ff=b.clone();this.zV=u;
this.pV=!1;this.ku=P;this.Hg=iF.Hg;u&&(this.KRb=ir.a.nob);this.Wh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.wdn,null);this.aPc();this.Pva&&(this.LMe=document.getElementById("DialogWidthSpinner"),this.EU(this.LMe))}QX(){this.jnh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Rc.a.J2d,Rc.a.i6d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.jnh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Rc.a.I2d,Rc.a.h6d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}aPc(){for(const b of TH)Object(ek.a)(b,
this.QRa,this.vNa);this.ku.pU("DialogWidthSpinner");this.ku.pU("DialogHeightSpinner")}dispose(){for(const b of TH)Object(ek.b)(b);this.ku.LE("DialogWidthSpinner");this.ku.LE("DialogHeightSpinner");super.dispose()}jnh(b,h,u,y,P){u=gu.Avk(h,u,y,P);this.cyb(u,b,h)}cyb(b,h,u){h=document.getElementById(h);this.ku.BLa(u,b);b=this.ku.fgb(u,"Medium");h.appendChild(b)}eZc(b){let h=null;switch(b){case Rc.a.I2d:case Rc.a.h6d:h=Lc.a.ew;break;case Rc.a.J2d:case Rc.a.i6d:h=Lc.a.Ao}return h}static h0a(){return gu.c$||
(gu.c$=gu.Wdb())}static Wdb(){const b={};b[Lc.a.Ao.id.toString()]=Gr.kdn;b[Lc.a.ew.id.toString()]=Gr.Mcn;return b}static Avk(b,h,u,y){return ke.l(b,h,u,y,[gu.Cvk(),gu.Bvk()])}static Cvk(){return ke.n("inch",gu.Rcj,gu.jBm,gu.rco)}static Bvk(){return ke.n("centimeter",gu.Rcj,gu.iBm,gu.qco)}}gu.Rcj="0";gu.jBm="22";gu.rco=".1";gu.qco="1";gu.iBm="55.8";gu.c$=null;Object(m.a)(gu,"PaperSizeDialog",ff.a,[]);class UH{constructor(){this.kdj=this.gKi=this.fKi=this.Bdn=this.fPf=!1}}Object(m.a)(UH,"Box4PropertySetChangedState",
null,[]);class al{static get q7b(){return null!=al.Fqg?al.Fqg:al.Fqg=Ja.a.instance.Pa("Box4.IIndentationCommands")}static get bqi(){return null!=al.Wsg?al.Wsg:al.Wsg=Ja.a.instance.Pa("Box4.IJustificationCommands")}static get fY(){return null!=al.nwg?al.nwg:al.nwg=Ja.a.instance.Pa("Box4.ISpacingCommands")}static aqi(b,h,u){al.bqi&&u&&(null===h||11!==u||10!==h&&9!==h)&&al.bqi.zD(u)}static Qri(b,h,u){al.fY&&u&&al.fY.sC(u)}static nOk(b,h,u){h!=u&&al.fY.fgc(u)}static vAm(b,h,u){h!=u&&al.fY.G2c(u)}static yGo(b,
h,u){h!=u&&al.fY.f3c(u)}static tAm(b,h,u){h!=u&&al.fY.F2c(u)}static A3d(b,h,u,y){al.fY&&void 0!==u&&null!==u&&(b=al.bKc(y),!b.fPf&&y.RN.hasProperty(ld.a.zFa)&&y.RN.hasProperty(ld.a.AFa)&&(h=y.RN.getValue(ld.a.AFa),y=y.RN.getValue(ld.a.zFa),b.fPf=!0,al.fY.Qha(1,h,y)))}static z3d(b,h,u,y){al.fY&&void 0!==u&&null!==u&&(b=al.bKc(y),!b.Bdn&&y.RN.hasProperty(ld.a.xFa)&&y.RN.hasProperty(ld.a.yFa)&&(h=y.RN.getValue(ld.a.yFa),y=y.RN.getValue(ld.a.xFa),b.fPf=!0,al.fY.Qha(0,h,y)))}static w3d(b,h,u,y){al.q7b&&
void 0!==u&&null!==u&&(b=al.bKc(y),!b.fKi&&y.RN.hasProperty(ld.a.Jba)&&y.RN.hasProperty(ld.a.Kba)&&(h=y.RN.getValue(ld.a.Kba),y=y.RN.getValue(ld.a.Jba),b.fKi=!0,al.q7b.T6i(1,h,y)))}static x3d(b,h,u,y){al.q7b&&void 0!==u&&null!==u&&(b=al.bKc(y),!b.gKi&&y.RN.hasProperty(ld.a.Cwa)&&y.RN.hasProperty(ld.a.Dwa)&&(h=y.RN.getValue(ld.a.Dwa),y=y.RN.getValue(ld.a.Cwa),b.gKi=!0,al.q7b.T6i(0,h,y)))}static Chc(b,h,u,y){al.q7b&&void 0!==u&&null!==u&&(b=al.bKc(y),!b.kdj&&y.RN.hasProperty(ld.a.vca)&&y.RN.hasProperty(ld.a.Z_)&&
(h=0,y.RN.hasProperty(ld.a.pJ)&&(h=y.RN.getValue(ld.a.pJ)),u=y.RN.getValue(ld.a.Z_),y=y.RN.getValue(ld.a.vca),b.kdj=!0,al.q7b.Xae(h,u,y)))}static bKc(b){b.customData||(b.customData=new UH);return b.customData}}Object(m.a)(al,"ParagraphLevelPropertyChangedHandlers",null,[]);const VH=[Oa.a.ucc,Oa.a.K2d,Oa.a.E2d,Oa.a.Mdc,Oa.a.t6d,Oa.a.Q5d,Oa.a.nde,Oa.a.v4c,Oa.a.I5a];class oj extends ff.a{constructor(b,h,u,y,P,aa){super();this.eL=this.yed=!1;this.mg="ParagraphDialog";oj.fY=u;this.zw=aa;this.xV=b.clone();
this.Ff=b.clone();if(this.zV=h)this.KRb=ir.a.nob}QX(){oj.knh(oj.Cdo,oj.sdj,Oa.a.ucc,Oa.a.Mdc,Oa.a.I5a,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this.zw);oj.knh(oj.Ado,oj.rdj,Oa.a.K2d,Oa.a.t6d,Oa.a.v4c,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this.zw);oj.dvk(oj.zdo,oj.f7f,this.zw);oj.gvk(oj.pDm,oj.rWd,this.zw)}isf(){var b=this.QRa.bind(this),h=this.vNa.bind(this);for(const u of VH)Object(ek.a)(u,b,h);b=this.cae.bind(this);h=this.A5d.bind(this);Object(ek.a)(Oa.a.C3a,b,h);Object(ek.a)(Oa.a.IZc,
b,h);this.zw.Nl()}dispose(){if(!this.eL){for(const b of VH)Object(ek.b)(b);Object(ek.b)(Oa.a.C3a);Object(ek.b)(Oa.a.IZc);this.zw.LE(oj.sdj);this.zw.LE(oj.rdj);this.zw.LE(oj.f7f);this.zw.LE(oj.rWd);super.dispose();this.eL=!0}}vNa(b,h){switch(b){case Oa.a.Mdc:case Oa.a.t6d:var u=b===Oa.a.Mdc?ld.a.AFa:ld.a.yFa;b=b===Oa.a.Mdc?ld.a.zFa:ld.a.xFa;this.Ff.hasProperty(u)&&this.Ff.hasProperty(b)?(b=this.Ff.getValue(b),1===b?(h[Df.a.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,h[Df.a.Number]=Number.NaN,h[Df.a.UnitType]=
5):(u=this.Ff.getValue(u),b=2===b?4:5,h[Df.a.Number]=u,h[Df.a.UnitType]=b)):(h[Df.a.Text]="",h[Df.a.Number]=Number.NaN,h[Df.a.UnitType]=Ra.App.A7?4:5);break;case Oa.a.Q5d:u=!1,this.Ff.hasProperty(ld.a.ua)&&this.Ff.hasProperty(ld.a.j_)&&2===this.Ff.getValue(ld.a.j_)&&(this.Hki()||this.yed)&&(b=oj.i_.VNa(this.Ff),b>=oj.dFf&&(h[Df.a.Number]=b,u=!0)),u||(h[Df.a.Text]="",h[Df.a.Number]=Number.NaN),h[Df.a.UnitType]=0}}QRa(b,h){var u=h[Df.a.Text],y=h[Df.a.Number],P=h[Df.a.UnitType];switch(b){case Oa.a.ucc:case Oa.a.K2d:u===
Box4Intl.Box4Strings.L_SpinnerAuto?(u=0,y=1):(u=y,y=4===P?2:4);h=b===Oa.a.ucc?ld.a.zFa:ld.a.xFa;this.Ff.setValue(b===Oa.a.ucc?ld.a.AFa:ld.a.yFa,u);this.Ff.setValue(h,y);break;case Oa.a.I5a:case Oa.a.v4c:P=b===Oa.a.I5a?ld.a.AFa:ld.a.yFa;b=b===Oa.a.I5a?ld.a.zFa:ld.a.xFa;h=h.Increment;""===u||h&&u===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ff.setValue(P,0),this.Ff.setValue(b,4)):y||h||(this.Ff.setValue(P,0),this.Ff.setValue(b,1));break;case Oa.a.E2d:this.s6i(y);break;case Oa.a.nde:""===u&&this.s6i(oj.dFf)}this.zw.Nl()}s6i(b){this.Ff.setValue(ld.a.j_,
2);this.Ff.setValue(ld.a.ua,oj.i_.Wjf(b));this.yed=!0;this.zw.pU(oj.rWd)}A5d(b,h){switch(b){case Oa.a.IZc:this.Aon(h)}}Aon(b){let h=0;var u=!1;this.Ff.hasProperty(ld.a.ua)&&this.Ff.hasProperty(ld.a.j_)||(u=!0);u||(2!==this.Ff.getValue(ld.a.j_)&&(u=!0),h=oj.i_.VNa(this.Ff),h<oj.dFf&&(u=!0));u||(u=oj.xBf,this.yed||this.Hki()||(Gc.a.b_(h,1)?u="1.00":Gc.a.b_(h,1.5)?u="1.50":Gc.a.b_(h,2)&&(u="2.00")),b[ge.a.SelectedItemId]=u)}cae(b,h){switch(b){case Oa.a.C3a:this.MWn(h)}}MWn(b){b=b.MenuItemId;b===oj.xBf?
(this.Ff.setValue(ld.a.j_,2),this.Ff.setValue(ld.a.ua,oj.i_.Wjf(3))):(b=parseFloat(b),this.Ff.setValue(ld.a.j_,2),this.Ff.setValue(ld.a.ua,oj.i_.Wjf(b)));this.yed=!1;this.zw.pU(oj.rWd);this.zw.pU(oj.f7f)}F3d(b){1===b&&xD(this.xV,this.Ff,oj.h0a());this.dispose()}E3d(){const b=Ja.a.instance.resolve("Box4.UI.IBox4DialogFactory"),h=Ja.a.instance.resolve("WordEditor.ClientPagination.IClientPaginationSettings");b.v1b(this.xV,null,this.zV,h)}Hki(){if(!this.Ff.hasProperty(ld.a.ua)||!this.Ff.hasProperty(ld.a.j_)||
2!==this.Ff.getValue(ld.a.j_))return!1;const b=oj.i_.VNa(this.Ff);return!Gc.a.b_(b,1)&&!Gc.a.b_(b,1.5)&&!Gc.a.b_(b,2)}static get i_(){return null!=oj.etg?oj.etg:oj.etg=Ja.a.instance.resolve("Box4.ILineSpacingHelper")}static h0a(){return oj.c$||(oj.c$=oj.Wdb())}static Wdb(){const b={};b[ld.a.ua.id.toString()]=al.Qri;b[ld.a.yFa.id.toString()]=al.z3d;b[ld.a.xFa.id.toString()]=al.z3d;b[ld.a.AFa.id.toString()]=al.A3d;b[ld.a.zFa.id.toString()]=al.A3d;return b}static knh(b,h,u,y,P,aa,ta){u=oj.Evk(h,u,y,
P,aa);oj.byb(u,b,h,ta)}static dvk(b,h,u){const y=oj.evk(h);oj.byb(y,b,h,u)}static gvk(b,h,u){const y=oj.hvk(h);oj.byb(y,b,h,u)}static byb(b,h,u,y){h=document.getElementById(h);y.BLa(u,b);b=y.fgb(u,"Medium");h.appendChild(b)}static Evk(b,h,u,y,P){return ke.l(b,h,u,P,[oj.Yvk(),oj.Xvk()],[Box4Intl.Box4Strings.L_SpinnerAuto],y,oj.rde)}static evk(b){return ke.l(b,Oa.a.E2d,Oa.a.Q5d,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,[oj.fvk()],null,Oa.a.nde,oj.rde)}static fvk(){return ke.n("none","1",
"132",".5")}static Yvk(){return ke.n("point","0","1584","1")}static Xvk(){return ke.n("line","0","327","1")}static hvk(b){const h=ke.e("DdlLineSpacing_Single","1.00",Oa.a.C3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),u=ke.e("DdlLineSpacing_1.5","1.50",Oa.a.C3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),y=ke.e("DdlLineSpacing_Double","2.00",Oa.a.C3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),P=ke.e("DdlLineSpacing_Multiple",
oj.xBf,Oa.a.C3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return ke.k(b,Oa.a.C3a,Oa.a.IZc,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,oj.qDm,[h,u,y,P])}}oj.qDm=150;oj.rde=70;oj.dFf=1;oj.sdj="DialogSpacingBeforeSpinner";oj.rdj="DialogSpacingAfterSpinner";oj.f7f="DialogLineSpacingAtSpinner";oj.Cdo="ParagraphDialogSpacingBeforeSpinnerContainer";oj.Ado="ParagraphDialogSpacingAfterSpinnerContainer";oj.zdo="ParagraphDialogLineSpacingAtSpinnerContainer";oj.pDm="ParagraphDialogLineSpacingContainer";
oj.rWd="ParagraphDialogLineSpacingSelect";oj.xBf="multiple";oj.fY=null;oj.c$=null;Object(m.a)(oj,"ParagraphDialog",ff.a,[]);class jF{static get Hg(){return ff.a.Sy(jF.am,Box4Intl.Box4Strings.l_ParagraphDialogGeneral,Box4Intl.Box4Strings.l_ParagraphDialogAlignment,Box4Intl.Box4Strings.l_ParagraphDialogIndentation,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,Box4Intl.Box4Strings.l_ParagraphDialogSpacing,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,
Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy)}}jF.am="<div class='WACDialogGroupBox ParagraphDialogLeftChunk' id='LeftChunk'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> <div class='ParagraphDialogContentArea' id='ParagraphDialogGeneralRow'> <div class='WACDialogGroupBox' id='GeneralLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='Alignment' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogAlignmentContainer' >{1}</label> </td> <td> <div id='ParagraphDialogAlignmentContainer' class='WacSpinnerBox' aria-labelledby='Alignment' role='presentation'></div> </td> </tr> </table> <div class='WACDialogRow' id='ParagraphDialogIndentationRow'> <div class='WACDialogSectionTitle UIFontBold'>{2}</div> </div> <div class='WACDialogGroupBox ParagraphDialogContentArea' id='InnerRowIndentationLabels'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='ParagraphDialogIndentationLeft' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentLeftSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogIndentLeftSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationLeft' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogIndentationRight' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentRightSpinnerContainer' >{4}</label> </td> <td> <div id='ParagraphDialogIndentRightSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationRight' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndent' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentContainer' >{10}</label> </td> <td> <div id='ParagraphDialogSpecialIndentContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndent' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndentBy' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentBySpinnerContainer' >{11}</label> </td> <td> <div id='ParagraphDialogSpecialIndentBySpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndentBy' role='presentation'></div> </td> </tr> </table> </div> </div> </div> </div> <div class='WACDialogGroupBox ParagraphDialogRightChunk' id='RightChunk'> <div class='WACDialogSectionTitle UIFontBold'>{5}</div> <div class='ParagraphDialogContentArea' id='InnerRowSpacing'> <div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{6}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{7}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{8}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{9}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div> </div> </div>";
Object(m.a)(jF,"ParagraphDialogHtml",null,[]);const aG=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,bG=(b,h,u,y)=>{let P=Ra.App.T7;b.hasProperty(h)&&b.hasProperty(u)&&!y?(h=b.getValue(h),b=b.getValue(u),h?2===b?P=2:h=Xf.a.GHa(h,P):Ra.App.A7&&(P=2)):(h=Number.NaN,Ra.App.A7&&(P=2));return{Bhc:h,x6a:P}},dM=b=>{let h="0";b.hasProperty(ld.a.pJ)&&(b=b.getValue(ld.a.pJ),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},kF=(b,h)=>{if(h.hasProperty(ld.a.pJ)&&2===h.getValue(ld.a.pJ)&&
h.hasProperty(ld.a.Z_)&&h.hasProperty(ld.a.vca)&&b.hasProperty(ld.a.Kba)&&b.hasProperty(ld.a.Jba)){var u=b.getValue(ld.a.Kba),y=b.getValue(ld.a.Jba);u=(new Dl.a(y,u)).yt;y=h.getValue(ld.a.Z_);h=h.getValue(ld.a.vca);h=(new Dl.a(h,y)).yt;b.setValue(ld.a.Kba,u+h);b.setValue(ld.a.Jba,1)}},ZH=(b,h)=>{var u;if(u=WH(b,h))u=h.hasProperty(ld.a.Z_)&&h.hasProperty(ld.a.vca);if(u){u=h.getValue(ld.a.Z_);const y=h.getValue(ld.a.vca);u=(new Dl.a(y,u)).yt;return XH(h)+YH(h)+b.getValue(Lc.a.marginRight)+b.getValue(Lc.a.marginLeft)+
u+Ra.App.oya<=b.getValue(Lc.a.Ao)}return WH(b,h)?XH(h)+YH(h)+b.getValue(Lc.a.marginRight)+b.getValue(Lc.a.marginLeft)+Ra.App.oya<=b.getValue(Lc.a.Ao):!0},XH=b=>{const h=b.getValue(ld.a.Kba);b=b.getValue(ld.a.Jba);return(new Dl.a(b,h)).yt},YH=b=>{const h=b.getValue(ld.a.Dwa);b=b.getValue(ld.a.Cwa);return(new Dl.a(b,h)).yt},WH=(b,h)=>h.hasProperty(ld.a.Kba)&&h.hasProperty(ld.a.Jba)&&h.hasProperty(ld.a.Dwa)&&h.hasProperty(ld.a.Cwa)&&b.hasProperty(Lc.a.marginLeft)&&b.hasProperty(Lc.a.marginRight)&&b.hasProperty(Lc.a.Ao),
eM=b=>b.hasProperty(ld.a.SXc)?b.getValue(ld.a.SXc):!1,fM=b=>b.hasProperty(Yi.a.fi)?b.getValue(Yi.a.fi):!1,gM=b=>b.hasProperty(Yi.a.IM)?b.getValue(Yi.a.IM):!1,hM=b=>b.hasProperty(Yi.a.keepTogether)?b.getValue(Yi.a.keepTogether):!1,$H=[Oa.a.p7b,Oa.a.sQd,Oa.a.D3a,Oa.a.L2d,Oa.a.ooa,Oa.a.jKb,Oa.a.wZc,Oa.a.Ndc,Oa.a.u6d,Oa.a.Kdc,Oa.a.Fhc,Oa.a.mde,Oa.a.qde];class Eu extends oj{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){super(b,u,aa,ta,Pa,Kb);this.rw=Sb;this.Hg=jF.Hg;this.u$=h.clone();this.Wh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,
this.F3d.bind(this),null);this.isf();b=document.getElementById("ParagraphDialogAlignmentControl-Medium");this.EU(b)}QX(){Eu.bnh("ParagraphDialogIndentLeftSpinnerContainer","DialogIndentLeftSpinner",Oa.a.p7b,Oa.a.jKb,Oa.a.Fhc,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,this.zw);Eu.bnh("ParagraphDialogIndentRightSpinnerContainer","DialogIndentRightSpinner",Oa.a.sQd,Oa.a.wZc,Oa.a.mde,Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,this.zw);Eu.bwk(this.zw);const b=this.Ff.getValue(ld.a.mt);
Eu.Otk(b,this.zw);Eu.dwk(this.zw);super.QX()}isf(){var b=this.QRa.bind(this),h=this.vNa.bind(this);for(const u of $H)Object(ek.a)(u,b,h);b=this.cae.bind(this);h=this.A5d.bind(this);Object(ek.a)(Oa.a.ooa,b,h);Object(ek.a)(Oa.a.Kdc,b,h);Object(ek.a)(Oa.a.D3a,b,h);Object(ek.a)(Oa.a.Ndc,b,h);super.isf()}dispose(){if(!this.El){for(const b of $H)Object(ek.b)(b);Object(ek.b)(Oa.a.ooa);Object(ek.b)(Oa.a.Kdc);Object(ek.b)(Oa.a.D3a);Object(ek.b)(Oa.a.Ndc);this.zw.LE("DialogIndentLeftSpinner");this.zw.LE("DialogIndentRightSpinner");
this.zw.LE("ParagraphDialogAlignmentControl");this.zw.LE("ParagraphDialogSpecialIndentSelect");this.zw.LE("ParagraphDialogSpecialIndentBySpinner");super.dispose()}}vNa(b,h){var u=!1;switch(b){case Oa.a.jKb:case Oa.a.wZc:var y=b===Oa.a.jKb?ld.a.Kba:ld.a.Dwa,P=b===Oa.a.jKb?ld.a.Jba:ld.a.Cwa;u=Ra.App.T7;this.Ff.hasProperty(y)&&this.Ff.hasProperty(P)?(y=this.Ff.getValue(y),P=this.Ff.getValue(P),y?2===P?u=2:y=Xf.a.GHa(y,u):Ra.App.A7&&(u=2),h[Df.a.Number]=y):(h[Df.a.Text]="",h[Df.a.Number]=Number.NaN,Ra.App.A7&&
(u=2));h[Df.a.UnitType]=u;u=!0;break;case Oa.a.u6d:y=ld.a.Z_;P=ld.a.vca;let aa=!1;u=Ra.App.T7;this.Ff.hasProperty(ld.a.pJ)&&(aa=!this.Ff.getValue(ld.a.pJ));this.Ff.hasProperty(y)&&this.Ff.hasProperty(P)&&!aa?(y=this.Ff.getValue(y),P=this.Ff.getValue(P),y?2===P?u=2:y=Xf.a.GHa(y,u):Ra.App.A7&&(u=2),h[Df.a.Number]=y):(h[Df.a.Text]="",h[Df.a.Number]=Number.NaN,Ra.App.A7&&(u=2));h[Df.a.UnitType]=u;u=!0}u||super.vNa(b,h)}QRa(b,h){var u=h[Df.a.Text],y=h[Df.a.Number],P=h[Df.a.UnitType],aa=!1;switch(b){case Oa.a.p7b:case Oa.a.sQd:u=
y;2===P?aa=2:(aa=1,u=Xf.a.Kpa(y,P));y=b===Oa.a.p7b?ld.a.Jba:ld.a.Cwa;this.Ff.setValue(b===Oa.a.p7b?ld.a.Kba:ld.a.Dwa,u);this.Ff.setValue(y,aa);aa=!0;break;case Oa.a.Fhc:case Oa.a.mde:""===u&&(y=2===P?2:1,u=b===Oa.a.Fhc?ld.a.Jba:ld.a.Cwa,this.Ff.setValue(b===Oa.a.Fhc?ld.a.Kba:ld.a.Dwa,0),this.Ff.setValue(u,y));aa=!0;break;case Oa.a.I5a:case Oa.a.v4c:P=b===Oa.a.I5a?ld.a.AFa:ld.a.yFa;aa=b===Oa.a.I5a?ld.a.zFa:ld.a.xFa;const ta=h.Increment;""===u||ta&&u===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ff.setValue(P,
0),this.Ff.setValue(aa,4)):y||ta||(this.Ff.setValue(P,0),this.Ff.setValue(aa,1));aa=!0;break;case Oa.a.L2d:""===u&&this.Ff.setValue(ld.a.pJ,1);this.C7i(y,P);aa=!0;break;case Oa.a.qde:""===u&&(this.Ff.setValue(ld.a.pJ,1),this.C7i(.1,P)),aa=!0}aa||super.QRa(b,h)}C7i(b,h){let u=b,y;2===h?y=2:(y=1,u=Xf.a.Kpa(b,h));this.Ff.setValue(ld.a.Z_,u);this.Ff.setValue(ld.a.vca,y);this.zw.pU("ParagraphDialogSpecialIndentBySpinner")}A5d(b,h){let u=!1;switch(b){case Oa.a.Kdc:this.zon(h);u=!0;break;case Oa.a.Ndc:this.Bon(h),
u=!0}u||super.A5d(b,h)}Bon(b){let h="0";if(this.Ff.hasProperty(ld.a.pJ)){const u=this.Ff.getValue(ld.a.pJ);(1===u||2===u||!u)&&(1===u?h="1":2===u?h="2":u||(h="0"))}b[ge.a.SelectedItemId]=h}zon(b){if(this.Ff.hasProperty(ld.a.mt)){let h=this.Ff.getValue(ld.a.mt);if(10===h||9===h)h=11;aG(h)&&(b[ge.a.SelectedItemId]=h.toString())}}cae(b,h){let u=!1;switch(b){case Oa.a.ooa:this.J_n(h);u=!0;break;case Oa.a.D3a:this.I1n(h),u=!0}u||super.cae(b,h)}I1n(b){b=parseInt(b.MenuItemId);this.Ff.setValue(ld.a.pJ,b);
this.zw.pU("ParagraphDialogSpecialIndentSelect");b?(this.Ff.setValue(ld.a.vca,1),this.Ff.hasProperty(ld.a.Z_)?this.Ff.getValue(ld.a.Z_)||this.Ff.setValue(ld.a.Z_,720):this.Ff.setValue(ld.a.Z_,720)):(this.Ff.setValue(ld.a.vca,1),this.Ff.setValue(ld.a.Z_,0));this.zw.pU("ParagraphDialogSpecialIndentBySpinner")}J_n(b){this.Ff.setValue(ld.a.mt,parseInt(b.MenuItemId));this.zw.pU("ParagraphDialogAlignmentControl")}F3d(b){let h="";1===b&&(kF(this.xV,this.xV),kF(this.Ff,this.xV),ZH(this.u$,this.Ff)?xD(this.xV,
this.Ff,Eu.jof()):h=""!==h?h:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage);this.dispose();""!==h&&this.wxa(h,this.E3d.bind(this))}E3d(){Ja.a.instance.resolve("Box4.UI.IBox4DialogFactory").v1b(this.xV,this.u$,this.zV,this.rw)}static jof(){return oj.c$||(oj.c$=Eu.AFc())}static AFc(){const b=oj.h0a();b[ld.a.mt.id.toString()]=al.aqi;b[ld.a.Jba.id.toString()]=al.w3d;b[ld.a.Kba.id.toString()]=al.w3d;b[ld.a.Cwa.id.toString()]=al.x3d;b[ld.a.Dwa.id.toString()]=al.x3d;b[ld.a.pJ.id.toString()]=al.Chc;b[ld.a.vca.id.toString()]=
al.Chc;b[ld.a.Z_.id.toString()]=al.Chc;return b}static bnh(b,h,u,y,P,aa,ta){u=Eu.Tuk(h,u,y,P,aa);oj.byb(u,b,h,ta)}static bwk(b){const h=Eu.cwk();oj.byb(h,"ParagraphDialogSpecialIndentBySpinnerContainer","ParagraphDialogSpecialIndentBySpinner",b)}static Otk(b,h){b=Eu.Ptk(b);oj.byb(b,"ParagraphDialogAlignmentContainer","ParagraphDialogAlignmentControl",h)}static dwk(b){const h=Eu.ewk();oj.byb(h,"ParagraphDialogSpecialIndentContainer","ParagraphDialogSpecialIndentSelect",b)}static Tuk(b,h,u,y,P){return ke.l(b,
h,u,P,[Eu.Wuk(),Eu.Vuk(),Eu.Uuk()],null,y,oj.rde)}static cwk(){return ke.l("ParagraphDialogSpecialIndentBySpinner",Oa.a.L2d,Oa.a.u6d,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,[Eu.awk(),Eu.$vk(),Eu.Zvk()],null,Oa.a.qde,oj.rde)}static awk(){return ke.n("inch","0","22",".1")}static $vk(){return ke.n("centimeter","0","55.88","1")}static Zvk(){return ke.n("character","0","316.8",".5")}static Wuk(){return ke.n("inch","-11","22",".1")}static Vuk(){return ke.n("centimeter","-27.94","55.88",
"1")}static Uuk(){return ke.n("character","-316.8","316.8",".5")}static Ptk(b){return ke.k("ParagraphDialogAlignmentControl",Oa.a.ooa,Oa.a.Kdc,Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,150,Eu.AVk(b))}static AVk(b){var h=ke.e("DdlAlignment_Left","1",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft),u=ke.e("DdlAlignment_Center","2",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter);const y=ke.e("DdlAlignment_Right","3",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignRight),
P=ke.e("DdlAlignment_Justified","6",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified),aa=ke.e("DdlAlignment_Kashida","11",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida),ta=ke.e("DdlAlignment_Distribued","7",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed),Pa=ke.e("DdlAlignment_ThaiDistribued","13",Oa.a.ooa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed);h=[h,u,y,P,ta];u=5;if(r.AFrameworkApplication.lcid===
zl.a.sg("AR-SA").LCID||11===b)h[u]=aa,u=6;if(r.AFrameworkApplication.lcid===zl.a.sg("TH-TH").LCID||13===b)h[u]=Pa;return h}static ewk(){const b=ke.e("DdlSpecialIndent_None","0",Oa.a.D3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent),h=ke.e("DdlSpecialIndent_FirstLine","1",Oa.a.D3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent),u=ke.e("DdlSpecialIndent_Hanging","2",Oa.a.D3a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent);return ke.k("ParagraphDialogSpecialIndentSelect",
Oa.a.D3a,Oa.a.Ndc,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,150,[b,h,u])}}Object(m.a)(Eu,"ParagraphDialog",oj,[]);class aI extends fu{constructor(b,h){super(b,h,!0);this.p9a=null;this.nRi=(u,y)=>{this.gg.$r&&(u?(u="string"===typeof y.styleText?y.styleText:null,(y=this.nsj(u))?(this.p9a=y,y=this.Hkf(this.RC),u=this.iCb(u,y),this.p9a=null,this.pV=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.nRi,u),this.pV=!0):(this.hide(),y=new Map,y.set("Source","ReactCreateNewStyleDialog"),
y.set("Action","CreateStyle"),Ta.Health.instance.recordKpiUsage($k.a.Kia,0,$k.a.eD,y),this.xAc(u,this.ZR)||(u=new Map,u.set("Source","ReactCreateNewStyleDialog"),u.set("Action","CreateStyle"),u=Object.assign(new Ya.a,{extendedProperties:u}),Ta.Health.instance.recordKpiFailure($k.a.Kia,"CreateStyleFailed",!1,!0,u)))):this.hide(),this.gg.b0())};this.Fz&&this.ZR&&(this.D9=!1,b=this.Hkf(this.RC),b=this.iCb(b,b),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.nRi,b))}iCb(b,h){var u=this.ZR.ia(Ge.a.fontSize,
Fg.a.qI)>=2*fu.XYd;const y=jv.a.Lhf(this.ZR,"97%",fu.XYd,!1,!0,u);y["padding-left"]=fu.ufj+"px";u||(y["line-height"]=fu.tfj+"px");u={};u.styleNameLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName;u.previewWindowLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview;u.styleName=b;u.previewContainerText=h;u.getPreviewStyle=()=>y;this.p9a&&(u.errorMessage=this.p9a);return{["id"]:this.mg,["bodyControls"]:u}}}Object(m.a)(aI,"ReactCreateNewStyleDialog",fu,[]);class pC extends ff.a{constructor(b,
h=!1,u){super(!1,!1,h);let y=h=this.cF=null;this.mg=pC.id;this.gg=b.view;this.ul=u;this.gg&&(y=this.gg.Bb);y&&y.hb&&y.hb.kb&&(h=y.hb.kb.Qa);h?(b=h.node)?(this.Fz=pC.mh.Wt(b))||w.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):w.ULS.sendTraceTag(539762889,3029,10,"node is null"):w.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}bEo(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),u=this.Srl();const y=""===A.a.$wa(b),P=b.length>pC.PRm;u=u.includes(b);h=
h.test(b);b=b.startsWith("_");let aa=null;if(y||P||u||b||!h)aa=y?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:P?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return aa}Kkm(b,h){return b?b===h:!1}static get mh(){return xl.PageNavigator.instance}Srl(){const b=this.ul.LJc(!1),h=[];
for(let u=0;u<b.count;u++){const y=b.J(u).ia(Lc.a.at,"");h.push(y)}return h}}pC.id="BookmarkEditDialog";pC.PRm=40;Object(m.a)(pC,"AEditBookmarkDialog",ff.a,[]);class bI extends pC{constructor(b,h,u){super(b,!0,u);this.p9a=null;this.MUa="wwaengidc";this.Rsc="ReactCreateEditBookmarkNameDialog";this.$Sg="EditBookmarkName";this.Aid="EditBookmarkNameDialog";this.Ane=h;this.ul=u;this.Fz&&(this.D9=!1,b=this.iCb(h.properties.ia(Lc.a.at,null)),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.pRi.bind(this),
b))}pRi(b,h){if(this.gg.$r){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var u;this.Ane.hasProperty(Lc.a.at)?u=this.Ane.getValue(Lc.a.at):w.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.bEo(b);this.Kkm(b,u)?(w.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.p9a=h,u=this.iCb(b),this.p9a=null,this.pV=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.pRi.bind(this),
u),this.pV=!0):(this.hide(),u=new Map,u.set("Source",this.Rsc),u.set("Action",this.$Sg),Ta.Health.instance.recordKpiUsage(this.Aid,0,this.MUa,u),this.WBk(b)||(u=new Map,u.set("Source",this.Rsc),u.set("Action",this.$Sg),u=Object.assign(new Ya.a,{extendedProperties:u}),Ta.Health.instance.recordKpiFailure(this.Aid,"Unable to edit bookmark",!1,!0,u)))}else this.hide();this.gg.b0()}}WBk(b){b=A.a.$wa(A.a.UZ(b));try{const h=this.ul.vnj(this.Ane,b);if(h)w.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");
else return w.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return w.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}iCb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.p9a;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.mg,["bodyControls"]:h}}}Object(m.a)(bI,"ReactEditBookmarkNameDialog",pC,[]);const lF=(b,h,u)=>{const y=[];
if(b.length!==h.length||u&&u.length!==h.length)return y;for(let P=0;P<b.length;P++){const aa={};aa.key=h[P];aa.text=b[P];aa.type="AppComboBoxItem";u&&(aa.ariaLabel=u[P]);y[P]=aa}return y},AB=(b,h,u,y,P)=>({["unitType"]:b,["unitPlaceholder"]:A.a.m4d(h),["minValue"]:u,["maxValue"]:y,["step"]:P}),cG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),cI=(b,h,u)=>{let y=!1;b.hasProperty(h)&&
b.hasProperty(u)?(u=b.getValue(u),1===u?(b=Number.NaN,h=5,y=!0):(b=b.getValue(h),h=2===u?4:5)):(b=Number.NaN,h=Ra.App.A7?4:5);return{Bhc:b,x6a:h,W7b:y}};class qC{constructor(){this.c$=null}LNl(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var u=AB("Point",5,0,1584,1),y=AB("Line",4,0,327,1),P=[u,y];y=cG();var aa=[Box4Intl.Box4Strings.L_SpinnerAuto];u=[""];({Bhc:Pa,x6a:ta,W7b:vb}=
cI(b,ld.a.AFa,ld.a.zFa));var ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Xf.a.$Ya(ta),["validUnits"]:P,["numberFormatInfo"]:y,["validReservedValues"]:aa};vb?ta.reservedValue=aa[0]:ta.value=isNaN(Pa)?"":Pa;h.beforeSpacingSpinButtonProps=ta;({Bhc:Pa,x6a:ta,W7b:vb}=cI(b,ld.a.yFa,ld.a.xFa));P={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Xf.a.$Ya(ta),["validUnits"]:P,["numberFormatInfo"]:y,["validReservedValues"]:aa};vb?P.reservedValue=aa[0]:P.value=isNaN(Pa)?"":Pa;h.afterSpacingSpinButtonProps=P;if(aa=P=b.hasProperty(ld.a.ua))aa=qC.i_.VNa(b),aa=b.hasProperty(ld.a.ua)&&b.hasProperty(ld.a.j_)&&2===b.getValue(ld.a.j_)?!Gc.a.b_(aa,1)&&!Gc.a.b_(aa,1.5)&&!Gc.a.b_(aa,2):!1;if(P){var Pa=qC.i_.VNa(b);
P=0;var vb=!1;b.hasProperty(ld.a.ua)&&b.hasProperty(ld.a.j_)||(vb=!0);vb||(2!==b.getValue(ld.a.j_)&&(vb=!0),P=Pa,1>P&&(vb=!0));vb?P="":(Pa="multiple",aa||(Gc.a.b_(P,1)?Pa="1.00":Gc.a.b_(P,1.5)?Pa="1.50":Gc.a.b_(P,2)&&(Pa="2.00")),P=Pa)}else P=null;Pa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:lF([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};P?Pa.selectedKey=P:Pa.defaultSelectedKey="";h.lineSpacingComboBoxProps=Pa;P=0;Pa=!1;b.hasProperty(ld.a.ua)&&b.hasProperty(ld.a.j_)&&2===b.getValue(ld.a.j_)&&aa&&(P=qC.i_.VNa(b),Pa=!0,1>P&&(P=Number.NaN));b=[AB("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:y,["validReservedValues"]:u};Pa?b.value=P:b.reservedValue=u[0];h.atSpinButtonProps=b;return h}h0a(){return this.c$||(this.c$=this.Wdb())}Wdb(){const b={};b[ld.a.ua.id.toString()]=al.Qri;b[ld.a.yFa.id.toString()]=al.z3d;b[ld.a.xFa.id.toString()]=al.z3d;b[ld.a.AFa.id.toString()]=al.A3d;b[ld.a.zFa.id.toString()]=
al.A3d;return b}static get i_(){return null!=qC.dtg?qC.dtg:qC.dtg=Ja.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(m.a)(qC,"ReactParagraphDialog",null,[]);class dI extends ff.a{constructor(b,h,u,y,P){super(!1,!1,!0);this.Dah=null;this.E3d=()=>{Ja.a.instance.resolve("Box4.UI.IBox4DialogFactory").v1b(this.xV,this.u$,this.zV,this.rw)};this.F3d=(vb,Kb)=>{var Sb,Yb,Ac;if(Kb&&(1===vb||2===vb)){if(Kb.alignmentComboBoxProps){var Sc=parseInt(Kb.alignmentComboBoxProps.selectedKey);isNaN(Sc)||aG(Sc)&&
this.Ff.setValue(ld.a.mt,Sc)}var nd=Kb.bySpinButtonProps;Sc=!!nd&&""!==nd.value;var Ad=Kb.didChangeSpecialIndentationComboBoxValue;if(Kb.specialIndentationComboBoxProps){var he=parseInt(Kb.specialIndentationComboBoxProps.selectedKey);1!==he&&2!==he&&he||!(he||Ad||Sc)||this.Ff.setValue(ld.a.pJ,he)}if(nd){he=nd.value;nd=Xf.a.tMa(nd.unitType.toLowerCase());let ce;0<=he||(he=0);2===nd?ce=2:(ce=1,he=Xf.a.Kpa(he,nd));if(Sc||Ad)this.Ff.setValue(ld.a.Z_,he),this.Ff.setValue(ld.a.vca,ce)}Kb.beforeTextSpinButtonProps&&
(Ad=Kb.beforeTextSpinButtonProps,Sc=Xf.a.tMa(Ad.unitType.toLowerCase()),Ad=""===Ad.value?Number.NaN:Ad.value,isNaN(Ad)||(he=Ad,2===Sc?nd=2:(nd=1,he=Xf.a.Kpa(Ad,Sc)),this.Ff.setValue(ld.a.Kba,he),this.Ff.setValue(ld.a.Jba,nd)));Kb.afterTextSpinButtonProps&&(Ad=Kb.afterTextSpinButtonProps,Sc=Xf.a.tMa(Ad.unitType.toLowerCase()),Ad=""===Ad.value?Number.NaN:Ad.value,isNaN(Ad)||(he=Ad,2===Sc?nd=2:(nd=1,he=Xf.a.Kpa(Ad,Sc)),this.Ff.setValue(ld.a.Dwa,he),this.Ff.setValue(ld.a.Cwa,nd)));Kb.beforeSpacingSpinButtonProps&&
(Sc=Kb.beforeSpacingSpinButtonProps,Ad=Xf.a.tMa(Sc.unitType.toLowerCase()),he=Sc.reservedValue,""!==Sc.value&&(he===Box4Intl.Box4Strings.L_SpinnerAuto?(Ad=1,Sc=0):(Ad=4===Ad?2:4,Sc=Sc.value),this.Ff.setValue(ld.a.AFa,Sc),this.Ff.setValue(ld.a.zFa,Ad)));Kb.afterSpacingSpinButtonProps&&(Sc=Kb.afterSpacingSpinButtonProps,Ad=Xf.a.tMa(Sc.unitType.toLowerCase()),he=Sc.reservedValue,""!==Sc.value&&(he===Box4Intl.Box4Strings.L_SpinnerAuto?(Ad=1,Sc=0):(Ad=4===Ad?2:4,Sc=Sc.value),this.Ff.setValue(ld.a.yFa,
Sc),this.Ff.setValue(ld.a.xFa,Ad)));if(Kb.atSpinButtonProps||Kb.lineSpacingComboBoxProps)if(Sc=Kb.atSpinButtonProps.value,1<Sc)this.Ff.setValue(ld.a.ua,Sc),this.Ff.setValue(ld.a.j_,2);else if(Sc=Kb.lineSpacingComboBoxProps.selectedKey)Sc="1.00"===Sc?1:"1.50"===Sc?1.5:"2.00"===Sc?2:0,Sc=1<=Sc?Sc:1,this.Ff.setValue(ld.a.ua,Sc),this.Ff.setValue(ld.a.j_,2);Kb.contextualSpacingCheckboxProps&&this.Ff.setValue(ld.a.SXc,Kb.contextualSpacingCheckboxProps.checked);(null===(Sb=this.rw)||void 0===Sb?0:Sb.DEa)&&
Kb.keepWithNextCheckboxProps&&this.Ff.setValue(Yi.a.fi,Kb.keepWithNextCheckboxProps.checked);(null===(Yb=this.rw)||void 0===Yb?0:Yb.NHa)&&Kb.widowOrphanCheckboxProps&&this.Ff.setValue(Yi.a.IM,Kb.widowOrphanCheckboxProps.checked);(null===(Ac=this.rw)||void 0===Ac?0:Ac.qga)&&Kb.keepTogetherCheckboxProps&&this.Ff.setValue(Yi.a.keepTogether,Kb.keepTogetherCheckboxProps.checked);kF(this.xV,this.xV);kF(this.Ff,this.xV);Kb="";ZH(this.u$,this.Ff)?xD(this.xV,this.Ff,this.jof(this.nLe?this.nLe.Wdb():{})):Kb=
""!==Kb?Kb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Kb?this.wxa(Kb,this.E3d):2===vb&&(Ub.c(Rc.a.$gc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Ub(Rc.a.$gc,2,null))}};this.xV=b.clone();this.Ff=b.clone();this.u$=h.clone();this.zV=u;this.ga=y;this.nLe=new qC;this.rw=P;b=this.nLe.LNl(this.Ff);h=AB("Inch",3,-11,22,.1);u=AB("Inch",3,0,22,.1);var aa=AB("Centimeter",1,-27.94,55.88,1);y=AB("Centimeter",1,0,55.88,1);var ta=AB("Character",2,-316.8,316.8,
.5);P=AB("Character",2,0,316.8,.5);h=[h,aa,ta];y=[u,y,P];u=cG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};aa=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ta=["1","2","3","6","7"];
let Pa=5;P=this.Ff.hasProperty(ld.a.mt)?this.Ff.getValue(ld.a.mt):0;if(10===P||9===P)P=11;if(r.AFrameworkApplication.lcid===zl.a.sg("AR-SA").LCID||11===P)b.isKashidaSupported=!0,aa[Pa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ta[Pa]="11",Pa=6;if(r.AFrameworkApplication.lcid===zl.a.sg("TH-TH").LCID||13===P)b.isThaiSupported=!0,aa[Pa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ta[Pa]="13";aa={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:lF(aa,ta),["allowFreeForm"]:!1};aG(P)?aa.selectedKey=P.toString():aa.defaultSelectedKey="";b.alignmentComboBoxProps=aa;if(this.rw.DEa||this.rw.NHa||this.rw.qga)b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};this.rw.DEa&&(P={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:fM(this.Ff)},b.keepWithNextCheckboxProps=P);this.rw.NHa&&(P={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:gM(this.Ff)},b.widowOrphanCheckboxProps=P);this.rw.qga&&(P={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:hM(this.Ff)},b.keepTogetherCheckboxProps=
P);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};aa=dM(this.Ff);P="0"===aa;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:lF([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,
Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:aa,["allowFreeForm"]:!1};ta=Ra.App.T7;aa=0;({Bhc:aa,x6a:ta}=bG(this.Ff,ld.a.Z_,ld.a.vca,P));y={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Xf.a.$Ya(ta),["validUnits"]:y,["numberFormatInfo"]:u};
y=this.tMb(aa,y);b.bySpinButtonProps=y;P=Ra.App.T7;y=0;({Bhc:y,x6a:P}=bG(this.Ff,ld.a.Kba,ld.a.Jba,!1));P={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Xf.a.$Ya(P),["validUnits"]:h,["numberFormatInfo"]:u};P=this.tMb(y,P);b.beforeTextSpinButtonProps=P;P=Ra.App.T7;y=0;({Bhc:y,x6a:P}=bG(this.Ff,ld.a.Dwa,ld.a.Cwa,!1));h={["type"]:"AppSpinButtonProps",
["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Xf.a.$Ya(P),["validUnits"]:h,["numberFormatInfo"]:u};h=this.tMb(y,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};u={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:eM(this.Ff)};b.contextualSpacingCheckboxProps=
u;h.dialogButtonsOption=9;h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Wh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.F3d,h)}jof(b){return this.Dah||(this.Dah=this.AFc(b))}AFc(b){var h,u,y;b[ld.a.mt.id.toString()]=al.aqi;b[ld.a.Jba.id.toString()]=al.w3d;b[ld.a.Kba.id.toString()]=al.w3d;b[ld.a.Cwa.id.toString()]=
al.x3d;b[ld.a.Dwa.id.toString()]=al.x3d;b[ld.a.pJ.id.toString()]=al.Chc;b[ld.a.vca.id.toString()]=al.Chc;b[ld.a.Z_.id.toString()]=al.Chc;b[ld.a.SXc.id.toString()]=al.nOk;if(null===(h=this.rw)||void 0===h?0:h.DEa)b[Yi.a.fi.id.toString()]=al.vAm;if(null===(u=this.rw)||void 0===u?0:u.NHa)b[Yi.a.IM.id.toString()]=al.yGo;if(null===(y=this.rw)||void 0===y?0:y.qga)b[Yi.a.keepTogether.id.toString()]=al.tAm;return b}tMb(b,h){h.value=isNaN(b)?"":b;return h}}Object(m.a)(dI,"WordReactParagraphDialog",ff.a,[]);
class yw extends ff.a{constructor(b,h,u,y){super(!1,!1,!0);this.cJk=()=>{this.uGc.Yyh(this.$ci,this.vie,this.xSc)};this.dJk=(P,aa)=>{aa&&1===P&&(aa.columnsCountSpinButtonProps&&this.FX.setValue(Yi.a.fE,aa.columnsCountSpinButtonProps.value),aa.columnsWidthSpinButtonProps&&(P=aa.columnsWidthSpinButtonProps,this.FX.setValue(Yi.a.zF,[Xf.a.Kpa(P.value,Xf.a.tMa(P.unitType.toLowerCase()))])),aa.columnsSpacingSpinButtonProps&&(P=aa.columnsSpacingSpinButtonProps,this.FX.setValue(Yi.a.hla,Xf.a.Kpa(P.value,
Xf.a.tMa(P.unitType.toLowerCase())))),aa.columnsLineBetweenCheckboxProps&&this.FX.setValue(Yi.a.separator,aa.columnsLineBetweenCheckboxProps.checked),this.hJk()&&(aa=yw.Owd,this.Tnk()?xD(this.$ci,this.FX,this.h0a):aa=aa!==yw.Owd?aa:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),aa!==yw.Owd&&this.wxa(aa,this.cJk)))};this.hJk=()=>this.FX.hasProperty(Yi.a.fE)&&this.FX.hasProperty(Yi.a.zF)&&this.FX.hasProperty(Yi.a.hla)&&this.FX.hasProperty(Yi.a.separator);this.IId=(P,aa,ta)=>Math.floor((P-
(aa-1)*ta)/aa);this.Ggf=(P,aa,ta)=>1==aa?0:Math.floor((P-aa*ta)/(aa-1));this.Xhk=(P,aa,ta,Pa)=>{const vb=P/aa;ta<yw.zhc?(ta=yw.zhc,Pa=this.Ggf(P,aa,ta)):ta>vb&&(ta=vb,Pa=this.Ggf(P,aa,ta));return[ta,Pa]};this.Uhk=(P,aa,ta,Pa)=>{const vb=(P-yw.zhc*aa)/(aa-1);0>Pa?(Pa=0,ta=this.IId(P,aa,Pa)):Pa>vb&&(Pa=vb,ta=this.IId(P,aa,Pa));return[ta,Pa]};this.Kpa=(P,aa)=>Xf.a.Kpa(P,Xf.a.tMa(aa));this.yFc=(P,aa,ta,Pa,vb)=>({["unitType"]:P,["unitPlaceholder"]:A.a.m4d(aa),["minValue"]:ta,["maxValue"]:Pa,["step"]:vb});
this.$ci=b.clone();this.FX=b.clone();this.vie=h.clone();this.flb=this.vie.getValue(Lc.a.Ao)-this.vie.getValue(Lc.a.marginLeft)-this.vie.getValue(Lc.a.marginRight);this.GHb=Math.floor(this.flb/yw.zhc);this.xSc=u;this.uGc=y;this.mg=yw.id;b={};b.getUnitValue=3==Ra.App.T7?Xf.a.pz:Xf.a.USa;b.getCalculatedWidthValue=this.IId;b.getCalculatedSpacingValue=this.Ggf;b.twipsFromValueAndUnits=this.Kpa;b.adjustWidthForLimits=this.Xhk;b.adjustSpacingForLimits=this.Uhk;b.pageContentWidth=this.flb;b.maxColumnCount=
this.GHb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.Ewl();b.columnsWidthSpinButtonProps=this.Iwl();b.columnsSpacingSpinButtonProps=this.Gwl();b.columnsLineBetweenCheckboxProps=this.Fwl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Wh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.dJk.bind(this),b)}Ewl(){var b=[this.yFc("None",0,1,this.GHb,1)];let h=this.Fmf(Yi.a.fE);
b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Xf.a.$Ya(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.tMb(h,b)}Iwl(){var b=[this.yFc("Inch",3,.5,Xf.a.pz(this.flb),.1),this.yFc("Centimeter",
1,1.27,Xf.a.USa(this.flb),1)];let h=Ra.App.T7,u=this.Fmf(Yi.a.zF);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Xf.a.$Ya(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.tMb(u,b)}Gwl(){var b=
[this.yFc("Inch",3,0,Xf.a.pz(this.flb-2*yw.zhc),.1),this.yFc("Centimeter",1,0,Xf.a.USa(this.flb-2*yw.zhc),1)];let h=Ra.App.T7,u=this.Fmf(Yi.a.hla);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Xf.a.$Ya(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.tMb(u,b)}Fwl(){let b=this.FX.getValue(Yi.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get h0a(){return null!=this.cqg?this.cqg:this.cqg=(()=>this.AFc())()}AFc(){const b={};b[Yi.a.fE.id.toString()]=b[Yi.a.zF.id.toString()]=b[Yi.a.hla.id.toString()]=
b[Yi.a.separator.id.toString()]=Gr.gJk;return b}Tnk(){const b=this.FX.getValue(Yi.a.zF),h=this.FX.getValue(Yi.a.fE),u=this.FX.getValue(Yi.a.hla);let y=0;for(let P=0;P<h;P++)y+=b[0];if(h<=this.GHb&&(h-1)*u+y<=this.flb)return!0;w.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],u);return!1}Fmf(b){if(this.FX.hasProperty(b)){if(b==Yi.a.fE)return this.FX.getValue(b);if(b==Yi.a.zF){var h=Ra.App.T7;b=
this.FX.getValue(Yi.a.hla);const u=this.FX.getValue(Yi.a.fE);return Xf.a.GHa(this.IId(this.flb,u,b),h)}if(b==Yi.a.hla){if(1==this.FX.getValue(Yi.a.fE))return 0;h=Ra.App.T7;b=this.FX.getValue(b);return Xf.a.GHa(b,h)}}return 0}tMb(b,h){h.value=isNaN(b)?yw.Owd:b;return h}}yw.id="ColumnsDialog";yw.Owd="";yw.zhc=720;Object(m.a)(yw,"WordReactColumnsDialog",ff.a,[]);class eI{nRk(b){new vD(b,Ja.a.instance.resolve("Box4.IFeatureHelper"))}eVk(b,h){r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA?
new aI(b,h):new LH(b,h)}F9k(b,h,u){new bI(b,h,u)}eAh(b,h,u){new Cz(b,h,u,Ja.a.instance.resolve("WordEditor.IPageCommands"),Ja.a.instance.resolve("Common.IStandaloneRootController").L8,!!Ra.App.instance&&Ra.App.instance.Pva)}HAh(b,h,u){new gu(b,h,u,Ja.a.instance.resolve("WordEditor.IPageCommands"),Ja.a.instance.resolve("Common.IStandaloneRootController").L8,!!Ra.App.instance&&Ra.App.instance.Pva)}Yyh(b,h,u){new yw(b,h,u,Ja.a.instance.resolve("WordEditor.UI.IDialogFactory"))}MQk(b){return new GC(b)}v1b(b,
h,u,y){r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA&&r.AFrameworkApplication.K.$("ReactParagraphDialogIsEnabled")?new dI(b,h,u,r.AFrameworkApplication.ya,y):new Eu(b,h,u,Ja.a.instance.resolve("Box4.IIndentationCommands"),Ja.a.instance.resolve("Box4.IJustificationCommands"),Ja.a.instance.resolve("Box4.ISpacingCommands"),Ja.a.instance.af("Box4.IFeatureHelper"),r.AFrameworkApplication.K,Ja.a.instance.resolve("Box4.IParagraphIndentationReader"),Ja.a.instance.resolve("Common.IStandaloneRootController").L8,
y)}W1k(){const b=Ja.a.instance.Pa("Box4.IRoamingServiceRequestManager");null==b?Ab.b(524834398,3018,10,"Roaming service not resolved."):new MH(b)}Z1k(b,h){new NH(b,h)}I7e(b){return new OH(b)}}Object(m.a)(eI,"DialogFactory",null,[504,505]);class xE extends ff.a{constructor(b,h){super(!1,!1,!0);this.GGh="DoNotCheckSpellingCheckbox";this.UGh="DocumentChoiceGroup";this.Tbd=0;this.pqi="LanguageList";this.documentContext="DocumentContext";this.Rq="RangeContext";this.$Yn=(u,y)=>{const P=ri.a.instance.Xo(Oa.a.m6i);
if(1!==u)P.properties.Z("canceled","true");else{u=y[this.pqi].replace(xE.Gjg,"");var aa=parseInt(u),ta=Boolean.parse(y[this.GGh]);y=y[this.UGh];y===this.documentContext?this.Did.SWn(aa,ta):this.Did.g1n(aa,ta);P.properties.Z("PreviousLCID",this.Tbd.toString());P.properties.Z("ChangedLCID",aa.toString());P.properties.Z("NoProof",ta.toString());this.dTg.ZYn(aa,this.Tbd);Ub.d(Oa.a.m6i,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"SelectedLcid",string:u}),Object.assign(new ca.a,{name:"NoProof",
string:ta.toString()}),Object.assign(new ca.a,{name:"Context",string:y})]);Ra.App.xa.updateCommandUI(!0)}P.end()};this.dTg=h;this.Did=b}P5f(){const b=Array(2);b[0]={["key"]:this.Rq,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.UGh,["defaultSelectedKey"]:this.Yzl(),
["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.Tbd=({Pnn:this.KIj}=this.Did.TSl()).returnValue;h.languageListPropsProvider=this.AHl();h.spellingCheckboxProps={["id"]:this.GGh,["checked"]:!this.KIj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Wh(Box4Intl.Box4Strings.l_Language,this.$Yn,{["id"]:"LanguageDialog",["bodyControls"]:h})}Yzl(){return this.Did.pf()?this.documentContext:this.Rq}AHl(){return()=>{let b,h;const u=({selectedIndex:b,
Idj:h}=this.dTg.zHl(this.Tbd)).returnValue;for(let y=0;y<u.length&&y<h;y++)u[y].value=xE.Gjg+u[y].value;return{["id"]:this.pqi,["items"]:u,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}xE.Gjg="recent-";Object(m.a)(xE,"ReactLanguageDialog",ff.a,[503]);class fI extends vE{constructor(b,h,u,y){super(h,u);this.LQf=()=>{this.floatie.Nl()};this.Eh=b;this.TH=y}Bdb(b,h,u){if(b=super.Bdb(b,h,u))b.sdc=!0,b.X4d=!0,b.preventDismissOnScroll=!0;this.Eh.MXa(this.LQf);return b}XOc(b,h,u=null){this.TH.hlh(()=>
this.Bdb(b,h,u))}N0d(){this.floatie.sdc=!0}}Object(m.a)(fI,"ExternalContentFloatieInitializer",vE,[]);class gI{tJb(){qm.instance.yna&&(du.instance.I6a([1,0]),qm.instance.xVd()&&eu.instance.I6a([1]))}}Object(m.a)(gI,"RulerUser",null,[501]);class hI{constructor(){this.whitelistedControlIds=null}}Object(m.a)(hI,"StatusBarProps",null,[]);class yE{constructor(b,h,u=!0){this.Dnd=!1;this.yIe=null;this.Zda=h.xG;this.OMe=h.Eej;u?Zh.a.get_instance().al(7,()=>{this.onh(b,h)}):this.onh(b,h)}onh(b,h){window.setTimeout(()=>
{fq.a.instance.Sd(()=>{Vj.UISurfaces.IUl().then(u=>{const y=Object.assign(new hI,{whitelistedControlIds:h.whitelistedControlIds});u.initializeNewStatusBar(b,y,this.OMe);this.yIe=u;this.Dnd=!0;window.setTimeout(()=>{fq.a.instance.Sd(()=>{const P=[];if(h.uG){const aa=h.uG;for(let ta in aa)P.push(appChrome.actions.updateControlHiddenState(ta,aa[ta]));appChrome.api.dispatch(P)}this.tJb()},"RSB:I2")},0);return null}).catch(()=>{w.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");
return null})},"RSB:I1");if(h.vpa&&b){yE.QMg||(r.AFrameworkApplication.ya.pa(Wa.a.Gej,le.a.frame,Object(v.a)(this,this.Hej,"statusBarTabAction")),r.AFrameworkApplication.ya.pa(Wa.a.Fej,le.a.frame,Object(v.a)(this,this.Hej,"statusBarTabAction")),yE.QMg=!0);const u=ir.a.jsf(h.vpa,h.x5i,b,!1);u.BK=!0;this.cec(u,Wa.a.Gej,Wa.a.Fej)}},0)}tJb(){this.Dnd&&this.Zda&&window.setTimeout(()=>{this.Zda(this.yIe.selectors.getStatusBarControlsMap(this.OMe),7)},0)}Fmb(b,h){this.Dnd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,
h))},0)}oU(b){this.Dnd&&this.Zda&&window.setTimeout(()=>{const h=this.yIe.selectors.getStatusBarControlsMap(this.OMe);if(h[b]){const u={};u[b]=h[b];this.Zda(u,7)}},0)}cec(b,h,u){const y=Rb.KeyInputManager.lc(fb.a.xx,0),P=Rb.KeyInputManager.lc(fb.a.xx,4);b.Mr(y);b.Mr(P);b.bindAction(y,h);b.bindAction(P,u)}Hej(){return 4}}yE.QMg=!1;Object(m.a)(yE,"ReactStatusBar",null,[]);class iI{constructor(){this.whitelistedControlIds=this.uG=this.xG=null;this.Wym=!1;this.x5i=this.vpa=this.Eej=null}}Object(m.a)(iI,
"ReactStatusBarInitOptions",null,[]);var HC=c(474);class jI{constructor(b,h,u,y,P){this.eWb=this.GKa=this.Ma=null;this.Tfo=()=>{const aa=Ra.App.xa.qp.getRegion($g.AppFrame.vpa);aa&&aa.wFf()};this.j5l=(aa,ta,Pa,vb,Kb)=>{if(!Kb)return w.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Pa)return 32;Kb&&2===Kb.length&&this.GKa&&this.GKa.Fmb(Kb[0],Kb[0]);return 32};this.x7c=aa=>{Ra.App.xa.xG(aa)};this.ga=y;fq.a.instance.Sd(()=>{this.Ma=P;this.eWb=
this.GKa=null;const aa={};r.AFrameworkApplication.Pbj||(aa[HC.a.bOn]=!0);aa.GiveFeedback=!r.AFrameworkApplication.RE;this.Ma.$("OfficeOnlineInGallatinTextVisible")||(aa.CenterStatusLabel=!0);aa[HC.a.xJi]=!0;this.Ma.$("WPMPackageIsEnabled")&&this.Ma.$("WPMStatusBarLabelIsEnabled")||(aa[HC.a.Mfg]=!0);this.Ma.$("AddInCommandsIsEnabled")||(aa[HC.a.Bak]=!0);this.Ma.$("WordEditorShowOcsConnectionStatus")||(aa[HC.a.DJf]=!0);aa[HC.a.bHo]=!0;this.Ma.$("ReadingTimeIsEnabled")||(aa[HC.a.ARi]=!0);window.setTimeout(()=>
{this.pem(b,aa)},0)},"SBU:I")}Wb(){this.ga.gb(Oa.a.Jde,oc.a.application,this.j5l,96)}pem(b,h){this.eWb=Ja.a.instance.Pa("WordEditor.WordEditorReactCommandDefinitionMapping");const u={};for(const P in h){var y=h[P];u[this.Nlf(P)]=y}this.GKa=new yE(b,Object.assign(new iI,{uG:u,xG:this.x7c,Wym:!1,Eej:"WordEditorStatusBar",vpa:$g.AppFrame.vpa,x5i:this.Tfo}))}Nlf(b){let h="";if(this.eWb){const u=this.eWb.Aif(b);u&&0<u.count&&(h=u.J(0))}return h&&""!==h?h:b}tJb(){this.GKa&&this.GKa.tJb()}Fmb(b,h){this.GKa&&
this.GKa.Fmb(this.Nlf(b),h)}oU(b){this.GKa&&this.GKa.oU(this.Nlf(b))}dispose(){}}Object(m.a)(jI,"StatusBarUser",null,[356,9]);var kI=c(1034);class dG{constructor(b){this.ga=b;this.ga.pa(Wa.a.J0c,le.a.frame,Object(v.a)(this,this.J0c,"reportFileMenuPageSwitch"));this.ga.pa(Wa.a.UXi,le.a.frame,De.ActionManager.Mf)}J0c(b,h,u,y,P){this.ga.processAction(this.vCl(P[kI.a.l3d]),2);return 32}}Object(m.a)(dG,"FileMenuSQMInformation",null,[901]);class lI extends dG{constructor(b){super(b);this.Oyn()}Oyn(){this.ga.pa(Wa.a.MYf,
le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.OXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.NYf,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.PXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.QXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.OYf,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.RXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.SXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.TXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.vYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.wYi,
le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.YXi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.ZXi,le.a.frame,De.ActionManager.Mf)}vCl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Wa.a.MYf;case "tabHome":case "FileHomePage":return Wa.a.OXi;case "menuJewelInfo":case "FileInfoPage":return Wa.a.NYf;case "menuJewelNew":case "FileNewPage":return Wa.a.PXi;case "menuJewelOpen":case "FileOpenPage":return Wa.a.QXi;case "menuJewelPrint":case "FilePrintPage":return Wa.a.OYf;case "menuJewelSaveAs":case "FileSaveAsPage":return Wa.a.RXi;
case "menuJewelShare":case "FileSharePage":return Wa.a.SXi;case "menuJewelTransform":case "FileTransformPage":return Wa.a.TXi}return Wa.a.UXi}}Object(m.a)(lI,"WordEditorFileMenuSQMInformation",dG,[]);var mI=c(1032);class eG{constructor(b){this.ga=b;this.ga.pa(Wa.a.K0c,le.a.frame,Object(v.a)(this,this.K0c,"reportTabSwitch"));this.ga.pa(Wa.a.qYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.sYi,le.a.frame,De.ActionManager.Mf)}K0c(b,h,u,y,P){this.ga.processAction(this.QRl(P[mI.a.V8f]),2);return 32}}
Object(m.a)(eG,"RibbonSQMInformation",null,[858]);class nI extends eG{constructor(b){super(b);this.cBn()}cBn(){this.ga.pa(Wa.a.iYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.jYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.QYf,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.kYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.lYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.mYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.nYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.oYi,le.a.frame,
De.ActionManager.Mf);this.ga.pa(Rc.a.pYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.RYf,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.rYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Wa.a.tYi,le.a.frame,De.ActionManager.Mf);this.ga.pa(Rc.a.uYi,le.a.frame,De.ActionManager.Mf)}QRl(b){switch(b){case "tabAddins":case "Addins":return Wa.a.iYi;case "tabHome":case "Home":return Wa.a.kYi;case "tabInsert":case "Insert":return Wa.a.lYi;case "tabDeveloper":case "Developer":return Wa.a.jYi;case "tabPageLayout":case "Layout":return Rc.a.mYi;
case "tabReferences":case "References":return Rc.a.pYi;case "tabReview":case "Review":return Rc.a.RYf;case "tabView":case "View":return Wa.a.tYi;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Rc.a.rYi;case "tabMailings":case "Mailings":return Rc.a.nYi;case "tabWordDesign":case "Design":return Rc.a.uYi;case "tabHelp":case "Help":return Rc.a.QYf;case "ctabPictureTools":case "Picture":return Rc.a.oYi}return Wa.a.sYi}}Object(m.a)(nI,"WordEditorRibbonSQMInformation",
eG,[]);class oI{constructor(b=null,h=null,u=null){this.uG=b||{};this.Dkj=h||[];this.Hkj=u||{}}}Object(m.a)(oI,"RibbonTrimmingProperties",null,[]);class pI{constructor(b,h,u){this.Lta=b;this.uG=h;this.wzf=u}}Object(m.a)(pI,"ReactRibbonJewelProperties",null,[]);class qI{constructor(){r.AFrameworkApplication.ya.pa(Wa.a.FPa,le.a.frame,Object(v.a)(this,this.Ysn,"reactFileMenuOpenFromTellMe"))}Ysn(b,h,u,y,P){if(1===u||!P)return 32;b=P.SourceControlId;17!==P.UILocation||"New"!==b&&"Open"!==b||(P=[],fh.d("setFileMenuSelectedPage")&&
("New"===b&&r.AFrameworkApplication.ta?2===r.AFrameworkApplication.ta.Pb.$n?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):P.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&r.AFrameworkApplication.ta&&(2===r.AFrameworkApplication.ta.Pb.$n?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):P.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),P.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(P));
return 32}eri(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}fRa(){return!1}lMi(){}rGh(){}}Object(m.a)(qI,"ReactFileMenu",null,[424]);class rI{l4e(){const b=new qI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(m.a)(rI,"ReactFileMenuFactory",null,[395]);class yD{constructor(b,h,u,y=!1){this.Fic=b;this.MQg=this.Fic.I1a;this.U_d=Ja.a.instance.Pa("Common.IOfficeTrialExperience");
this.yHb=Ja.a.instance.Pa("Common.IMacOfficeOffer");yD.goe=!1;this.xtm=y;this.ga=h;this.Vb=u}get Bc(){return this.ga}get Hh(){return this.Vb}dWe(){return this.MQg&&!!this.U_d&&!!this.yHb}kTa(b,h){this.Fic.lp(()=>{w.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.MQg=!0;this.Bbf(b,h)});Ja.a.instance.Za("Common.IOfficeTrialExperience").execute(u=>{w.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.U_d=u;this.Bbf(b,h)});Ja.a.instance.Za("Common.IMacOfficeOffer").execute(u=>
{w.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.yHb=u;this.Bbf(b,h)})}Bbf(b,h){yD.goe||(this.dWe()?(w.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),yD.goe=!0):w.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}yD.goe=!1;Object(m.a)(yD,"RibbonDependencies",null,[780]);class fG{constructor(b,h,u){this.Yrb=b;this.ga=h;this.Vb=u}}Object(m.a)(fG,"WoncaRibbonUserFactory",null,[56]);class sI{constructor(b,h){this.upe=
b;this.FYb=h}Ymb(b){this.upe.Ymb(b);this.FYb&&this.FYb.Ymb(b)}E2c(b){this.upe.E2c(b);this.FYb&&this.FYb.E2c(b)}z7c(b){this.upe.z7c(b);this.FYb&&this.FYb.z7c(b)}}Object(m.a)(sI,"RibbonCommandTrimmer",null,[57]);var iM=c(1218),jM=c(1134);class tI{constructor(b,h){this.Ma=b;this.uWb=h}Ymb(b){ba.a.zi&&6>ba.a.Q0a&&(b.fseaInsertPicture=!0);this.Ma.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ma.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ma.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=
!0);bD.a.Dli()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ma.$("InsertOnlinePictureEnabled"),u=r.AFrameworkApplication.fwf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);u?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);u&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;r.AFrameworkApplication.gwf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=
!0);r.AFrameworkApplication.nge&&(b.btnOpenInClient=!0);r.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&r.AFrameworkApplication.K.$("DisablePrint")&&this.ljc(b)}E2c(b){b.menuJewel=!0;r.AFrameworkApplication.RE||(b.jbtnGiveFeedback=!0)}ljc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}z7c(b){delete b.menuJewel;r.AFrameworkApplication.privacyUrl||
(b.jbtnPrivacy=!0);r.AFrameworkApplication.I0c||(b.jbtnReportAbuse=!0);r.AFrameworkApplication.mfe||(b.jbtnTermsOfUse=!0);r.AFrameworkApplication.HGd||(b.jbtnFileSharing=!0);r.AFrameworkApplication.$lb||(b.jbtnShareRWC=!0);r.AFrameworkApplication.Bcf||r.AFrameworkApplication.Idg||(b.jbtnVersion=!0);this.uWb.U_d&&this.uWb.U_d.w_m||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.uWb.yHb&&this.uWb.yHb.K6n||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);r.AFrameworkApplication.nge?
(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Ra.App.Fs?"btnjOpenInClient":"btnjEditInClient"]=!0;r.AFrameworkApplication.Ppo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);r.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&r.AFrameworkApplication.K.$("DisablePrint")?this.ljc(b):r.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;r.AFrameworkApplication.pM&&(this.ljc(b),b.faShare=!0);if(r.AFrameworkApplication.protectFile||
ba.a.qPa||!r.AFrameworkApplication.$Nc&&!r.AFrameworkApplication.scf&&!r.AFrameworkApplication.Gdg)b.jbtnFileEmbed=!0;iM.a.Lam()||(b.btnjClose=!0);r.AFrameworkApplication.K9b?(b.jbtnVersion=!0,w.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):r.AFrameworkApplication.wVd()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);r.AFrameworkApplication.bVf||(b.faOpen=!0);b.jbtnFileSharing&&
b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ma.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Nmi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(r.AFrameworkApplication.rI||
".ODT"===Ra.App.FGd.toUpperCase()||!r.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!jM.a.zvd||r.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(m.a)(tI,"WoncaCommandTrimmer",null,[57]);var kM=c(981);c(467);var lM=c(1033),mM=c(1133);class uI{constructor(b,h){this.j1=this.NJ=null;this._clientId=b;this.g$=h}Fcl(){if(!Oe.c(this.j1))return this.j1;this.Maf();this.j1.style.display="block";this.g$&&this.g$.jZ(Object(v.a)(this,this.onResize,
"onResize"));return this.j1}onResize(){this.kxa()}kxa(){this.taf()?(document.getElementById("application").style.minWidth="0px",(new mM.a(this.j1,null,r.AFrameworkApplication.isRtl)).eQn(this.j1)):r.AFrameworkApplication.ta.Pb.ZI||lM.a.fQn(this.j1,r.AFrameworkApplication.isRtl)}taf(){return r.AFrameworkApplication.K?r.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}Maf(){if(Oe.c(this.NJ)){var b;({H6b:b}=ir.a.pjc(!r.AFrameworkApplication.zT)).returnValue&&(this.NJ=ZE.a("div"),this.NJ.className=
ir.a.$el,this.NJ.id=Ro.CuiHelper.aGd,b.appendChild(this.NJ),this.Faf(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.H7&&!r.AFrameworkApplication.zT&&this.Gaf(),this.Ecl())}}Ecl(){Oe.c(this.j1)&&(this.j1=ZE.a("div"),this.j1.className=ir.a.fag,this.j1.style.display="none",this.NJ.appendChild(this.j1))}Faf(){Sys.UI.DomElement.addCssClass(this.NJ,ir.a.afl);r.AFrameworkApplication.isRtl&&ZE.b(this.NJ,"cui-rtl")}Gaf(){Sys.UI.DomElement.addCssClass(this.NJ,"FlexBoxLayout")}}Object(m.a)(uI,"HeaderSkeleton",
null,[]);var zD=c(633);class gG{constructor(){this.plc=null}Iro(){this.plc||(this.plc=Ja.a.instance.Pa("Common.App.AccountSwitching.IAccountSwitching"))||w.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}$ql(){this.Iro();return this.plc?this.plc.getCustomAuthConfig():null}static Dmm(){return r.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(m.a)(gG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class hG{constructor(){this.BGb=this.cultureName=null}}
Object(m.a)(hG,"HeaderCultureInfo",null,[]);var mF=c(1575);class vI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(vI,"SearchInitializationSettings",null,[]);var AD=c(287);class wI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(wI,"DocumentTitleAppProps",null,[]);class xI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(xI,"DocumentTitleCalloutAppProps",null,[]);class yI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(yI,"HeaderAppProps",null,[]);class zI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(zI,"HeaderControls",null,[]);class AI{constructor(){this.command=
this.label=null}}Object(m.a)(AI,"WorkflowButtonAppProps",null,[]);var nF;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(nF||(nF={}));Object(m.b)("RenameDisableReason",nF);class BI{constructor(b=""){this.m0f=this.documentTitleAppProps=this.Kfg=null;this.w3j=""!==b?b:Td.a.t4}KQl(b){const h=Ja.a.instance.Pa("Common.IExternalUICommandDefinitionMapping").$fb(b);
if(h&&0<h.length)return h[0].externalUxCommand;w.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}lof(){if(!this.Kfg){const b=zD.a();if(b){const h=this.KQl(b.command);h&&(this.Kfg=Object.assign(new AI,{command:h,label:b.label}))}}return this.Kfg}pyl(){return Object.assign(new zI,{workflowButton:this.lof()})}o3m(){Zh.a.get_instance().PK(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;r.AFrameworkApplication.ya.Ub(Wa.a.SHb,
2,b)}gRl(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}OAl(){let b=null,h=null;var u=Ja.a.instance.Pa("Common.IRenameProps");u?(u=u.d3h(),0!==u&&(b=this.gRl(u),h=nF[u])):w.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new xI,{breadcrumbBrandName:r.AFrameworkApplication.su.breadcrumbBrandName,
breadcrumbBrandUrl:r.AFrameworkApplication.su.breadcrumbBrandUrl,breadcrumbFolderName:r.AFrameworkApplication.su.breadcrumbFolderName,breadcrumbFolderUrl:r.AFrameworkApplication.su.breadcrumbFolderUrl,hideDocumentTitleInput:r.AFrameworkApplication.ta.Pb.e8l,isVersionHistoryEnabled:this.X7n(),documentExtension:A.a.NNa(r.AFrameworkApplication.fileName),isMoveEnabled:32===r.AFrameworkApplication.ya.processAction(Wa.a.SHb,1),onMove:Object(v.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:r.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}eWh(){if(!this.documentTitleAppProps){const b=r.AFrameworkApplication.su.Nz;this.documentTitleAppProps=Object.assign(new wI,{documentTitle:r.AFrameworkApplication.YGc?b:A.a.zI(b),onFirstRender:Object(v.a)(this,this.o3m,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(v.a)(this,this.OAl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}X7n(){return!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Mni}L5n(){return!!r.AFrameworkApplication.ta&&
r.AFrameworkApplication.ta.Pb.Lni}F7n(){const b=!zD.b()&&!r.AFrameworkApplication.hideHeader&&!r.AFrameworkApplication.hqf&&(r.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||r.AFrameworkApplication.K.$("TeamsChatIsEnabled"));w.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}uOk(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});w.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}byn(b=!1){appChrome.getHeaderApi().then(h=>
{const u=Ja.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",y=>{u.onFlexPaneOpen(y)});h.setHeaderCommandHandler("OnFlexPaneClose",y=>{u.onFlexPaneClose(y)});h.setHeaderCommandHandler("SetCookie",y=>Xa.a.set(y.cookieName,y.value));h.setHeaderCommandHandler("GetCookie",y=>this.ryl(y));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(v.a)(this,this.lof,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(v.a)(this,this.eWh,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.p3m();return null}));mF.a.GUd()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(v.a)(this,this.O3h,"getSearchInitializationSettings"))})}p3m(){Ja.a.instance.Za("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.Nob(!1,r.AFrameworkApplication.ya.mode)})}ryl(b){b=
Xa.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}tVl(){return AD.AppChromeOverrideUtilities.isEnabled?AD.AppChromeOverrideUtilities.LLd("suiteux-shell",!1):this.w3j+r.AFrameworkApplication.Gha+"suiteux-shell"}onFirstRender(){Ja.a.instance.Za("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.I4n.continueWith(Object(v.a)(this,this.uOk,"continueShellServiceDataAsync"),3)});Zh.a.get_instance().PK(15)}onFullyLoaded(){Zh.a.get_instance().PK(16)}Nua(b=!1){a:{try{var h=
zl.a.sg(r.AFrameworkApplication.lcid);if(h){var u=Object.assign(new hG,{cultureName:h.name,BGb:h.BGb});break a}}catch(y){w.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+r.AFrameworkApplication.lcid.toString())}u=Object.assign(new hG,{cultureName:"en-us",BGb:"en"})}h=Ja.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");u=Object.assign(new yI,{appName:CommonUIStrings.l_AppNameShort,culture:u.cultureName,language:u.BGb,isConsumer:!r.AFrameworkApplication.Ldg,
showAppLauncher:zD.h(),showMeControl:zD.g(),hideUserName:r.AFrameworkApplication.xPd,defaultDocumentTitleToLeft:r.AFrameworkApplication.iDh,assetsContainerOverride:this.tVl(),controls:this.pyl(),documentTitleAppProps:b?null:this.eWh(),showDocumentTitleControl:!b,showWorkflowButton:!!this.lof(),showChatControl:this.F7n(),showGoPremiumControl:zD.i(),showDiscoverPremiumButton:zD.f(),enableSearchControl:mF.a.zvm(),onFlexPaneOpen:Object(v.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(v.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.L5n(),testTraffic:r.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(v.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(v.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:r.AFrameworkApplication.M5n()});!r.AFrameworkApplication.akc||r.AFrameworkApplication.t6f?(u.userDisplayName=r.AFrameworkApplication.userName,u.emailAddress=r.AFrameworkApplication.K.lb("UserPrincipalName"),
u.userID=r.AFrameworkApplication.K.lb("Puid")||"",u.signOutLink=r.AFrameworkApplication.t6f):r.AFrameworkApplication.signInUrl&&(u.signInLink=r.AFrameworkApplication.signInUrl);mF.a.GUd()&&(h=this.O3h(),u.loadTellMeResources=h.loadTellMeResources,u.getTokenRequestDictionary=h.getTokenRequestDictionary,u.enableVanillaSearchBox=r.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),u.userRing=h.userRing);gG.Dmm()&&(h=new gG,u.shellAuthProviderConfigPromise=Object(v.a)(h,h.$ql,"getAccountSwitchingConfig"));
this.byn(b);return u}O3h(){if(!this.m0f){const b=new mF.a;let h=r.AFrameworkApplication.K.lb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.m0f=Object.assign(new vI,{loadTellMeResources:b.oFm(),getTokenRequestDictionary:Object(v.a)(b,b.uXl,"getTokenRequestDict"),userRing:h})}return this.m0f}}Object(m.a)(BI,"ReactSharedHeaderPropsHelper",null,[1067]);class iG{constructor(){this.label=this.value=null}}Object(m.a)(iG,"TextInfoSectionField",null,[]);var zE=c(749),nM=c(1046);class jG{constructor(){this.commandId=
0;this.externalUxCommand=null}}Object(m.a)(jG,"CommandDefinition",null,[]);class CI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(CI,"CommandDefinitionMapping",null,[]);const oM=b=>Object.assign(new CI,{getCommandByExternalUxId:h=>{const u=b.getCommandByExternalUxId(h);return u?Object.assign(new jG,{commandId:parseInt(u.commandId),externalUxCommand:u.externalUxCommand}):Object.assign(new jG,{externalUxCommand:h})},
getDoNothingCommand:()=>parseInt(Wa.a.Ag),addCommandToMaps:Object(v.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(v.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(v.a)(b,b.addTabToMap,"addTabToMap")});var pM=c(1358);class DI{}Object(m.a)(DI,"RibbonInitState",null,[]);var EI=c(451),qM=c(1301);class FI{constructor(){}flatten(b){const h=[];for(const u of b)h.push.apply(h,u);return h}}Object(m.a)(FI,"ReactAsyncDispatcher",null,[]);var rM=c(1614);class GI{constructor(b,h){this.R2j=
b;this.mHj=h}}Object(m.a)(GI,"ReactExecuteCommandContext",null,[]);class Sx{}Sx.Trigger="FontTrigger";Sx.Name="FontName";Sx.Action="FontAction";Sx.Level="FontLevel";Sx.IsPinned="FontIsPinned";Object(m.a)(Sx,"FontPickerLogProperties",null,[]);class HI{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb=null,Sb=null){this.RY=null;this.B5g=!1;this.nte=[];this.Pbd=-1;this.Grd=!1;this.f4j=0;this.inc=null;this.h1g=!1;this.Nda=b;this.Mab=h;this.z3g=Object(na.a)(864,b);this.lm=u;this.Vb=y;P&&(this.RY=new rM.a(P,y));this.q0j=
aa;this.CLj=ta;this.Zq=Kb;this.ga=Pa;this.mtb={};this.Ma=vb;this.Alg=Sb;vb&&(vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||vb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&li.a.instance.Hvd.CWR(()=>this.B5g=!0);vb&&(b=this.Ma.lb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Uv:this.inc}=z.d(b));this.inc||(this.inc={})}get b3i(){return!!window.appChrome&&!!appChrome.selectors}C1i(){-1!==this.Pbd&&window.clearTimeout(this.Pbd);this.Pbd=
window.setTimeout(()=>{for(this.Pbd=-1;0<this.nte.length;){if(lf.a.instance.Zu){this.C1i();break}const b=this.nte.shift();b&&this.executeCommand(b.R2j,b.mHj)}},0)}executeCommand(b,h){if(lf.a.instance.Zu){if(this.B5g){this.nte.push(new GI(b,h));this.C1i();return}w.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,Ma.a.toJSON(h.payload));
if(this.Ma.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const u=this.lm.getCommandByExternalUxId(b),y=h.modelType;this.Alg&&this.Alg.tIm(b,h);u?this.Mdl(b,u,y,h):this.Ndl(b,y,h);this.aDk(h);this.oQm(b,h)}}Ndl(b,h,u){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.nLh(u,b)}}Lzo(b,h,u,y,P){if(u.payload)switch(u.payload.type){case "CoauthorMenuPayload":b.MenuItemId=u.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=u.payload.commandValueId;
this.P$();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=u.payload.commandValueId;P=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=u.payload.commandValueId;P=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=y;return P}Mzo(b,h,u){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.lm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;
case "MenuClosePayload":b=this.lm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":u.CommandId=h.payload.executedControl;u.ControlId=h.payload.executedControl;u.ParentControlId=h.payload.parentControl;u.CloseAllMenus=!0;this.P$();break;case "TellMeSearchResultChangePayload":u.Value=h.payload.searchText;break;case "SmartLookupPayload":u.CommandValueId=h.payload.selectionContextJson}return b}Mdl(b,h,u,y){var P=this.Thn(y,u),aa=h.commandId;const ta={},Pa={};
switch(u){case "SplitButtonModel":if(this.lNc(y.payload,Object(v.a)(this,this.LAo,"updateSplitButtonMenuState"),P))return;ta.MenuItemId=h.menuItemId;this.w3f(y,ta);break;case "StatefulSplitButtonModel":if(this.lNc(y.payload,Object(v.a)(this,this.SAo,"updateStatefulSplitButtonMenuState"),P))return;u=y.payload.statefulData;P=y.payload.statefulMode;"color"===P?ta.Color=u:"icon"===P&&(u=this.lm.getCommandByExternalUxId(u))&&(ta.MenuItemId=u.menuItemId);break;case "FileMenu":ta.MenuItemId=h.menuItemId;
ta.SourceControlId=b;y.payload&&"FileMenuPageSwitchPayload"===y.payload.type&&this.T2l(aa,y.payload,b);break;case "TellMe":aa=this.Mzo(aa,y,ta);ta.SourceControlId=b;ta.Location=y.payload.location;break;case "ButtonModel":y.payload&&"TabSwitchPayload"===y.payload.type?this.N4l(ta,y):aa=this.Lzo(ta,h,y,b,aa);break;case "CompoundButtonModel":ta.MenuItemId=h.menuItemId;ta.CommandValueId=y.payload.commandValueId;ta.SourceControlId=b;this.w3f(y,ta);this.P$();break;case "ToggleButtonModel":case "InkButtonModel":ta.MenuItemId=
h.menuItemId;ta.SourceControlId=b;this.w3f(y,ta);this.P$();break;case "FontPickerModel":switch(y.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":aa=this.lm.getCommandByExternalUxId("FontPickerMenuClose").commandId;ta[uD.a.FontPickerId]=y.payload.launcherId;break;case "FontPickerFontSelectedPayload":u=y.payload.font;P=null;"string"===typeof u?(P=np.FontUtils.kQa(u),ta.CommandValueId=P,P=np.FontUtils.OBd(P)):(u.data?(ta.CommandValueId=u.data.fontToApply,ta.MenuItemId=u.data.themeIndex,
ta[uD.a.Formatting]=u.data):ta.CommandValueId=u.name,P=u);ta.SourceControlId=b;ta[uD.a.RequestUpdateMru]=P;Pa[Sx.Name]=y.payload.nameToLog?y.payload.nameToLog:"string"===typeof u?np.FontUtils.qSd(u)?"*"+u:np.FontUtils.evf(u)?"[EF]":"[MF]":"";Pa[Sx.IsPinned]=y.payload.isPinned;Pa[Sx.Level]=y.payload.level;this.tCf();break;case "FontPickerFontInfoRequestedPayload":ta.CommandValueId=y.payload.font.name;ta[uD.a.Trigger]=y.payload.trigger;Pa[Sx.Trigger]=y.payload.trigger;Pa[Sx.Name]=y.payload.nameToLog;
this.tCf();break;case "FontPickerFontPinningPayload":u=y.payload.isPinned;ta.CommandValueId=y.payload.fontKey;ta[uD.a.IsPinned]=u;Pa[Sx.Name]=y.payload.nameToLog;Pa[Sx.Action]=u?"pin":"unpin";Pa[Sx.Level]=y.payload.level;this.tCf();break;default:return}break;case "ComboBoxModel":var vb=y.payload.type;switch(vb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Pgc(y.payload.launcherId,P)&&(aa={},aa[y.payload.launcherId]=u,this.Mab.sYc(aa,fh.g(y.payload)),this.mtb[b]=new Date);return;case "MenuClosePayload":return;
case "ComboBoxPayload":case "ComboBoxPreviewPayload":u=y.payload.newValue;if(!u)return;u.value?(ta[te.a.Value]=u.value,ta[te.a.IsFreeForm]=!0):(ta[te.a.Value]=u.text,ta.MenuItemId=u.key,ta.CommandValueId=u.commandValueId);"ComboBoxPreviewPayload"===vb&&(aa=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":aa=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(y.payload.type){case "ZeroTermContextMenuClosePayload":u=Ma.a.bO(y.payload);for(vb of u)ta[vb]=y.payload[vb];
break;default:this.lNc(y.payload,Object(v.a)(this,this.qxo,"updateFlyoutAnchorMenuState"),P),ta.launcherId=y.payload.launcherId}break;case "InkFlyoutAnchorModel":this.lNc(y.payload,Object(v.a)(this,this.oyo,"updateInkFlyoutAnchorMenuState"),P);ta.launcherId=y.payload.launcherId;break;case "ColorPickerModel":switch(y.payload.type){case "ColorPickerPayload":ta[Up.Color]=y.payload.selectedColorId;break;case "ColorPickerPreviewPayload":aa=h.commandPreviewId;ta[Up.Color]=y.payload.selectedColorId;break;
case "ColorPickerRevertPreviewPayload":aa=h.commandRevertId;break;default:return}break;case "SpinButtonModel":ta[Df.a.Number]=y.payload.value;ta[Df.a.UnitType]=Xf.a.tMa(y.payload.unitType.toLowerCase());ta[Df.a.Text]=y.payload.reservedValue;break;case "SliderModel":ta[gg.Value]=y.payload.value;break;case "InsertTableModel":ta[fn.a.Rows]=y.payload.rows;ta[fn.a.Columns]=y.payload.columns;break;case "CheckboxModel":ta[ag.a.On]=y.payload.checked;ta.MenuItemId=h.menuItemId;break;case "PreviewGalleryModel":if(this.lNc(y.payload,
Object(v.a)(this,this.Wzo,"updatePreviewGalleryMenuState"),P)){ta.launcherId=y.payload.launcherId;break}this.nLh(y,b);return;case "DocumentTitleModel":switch(y.payload.type){case "DocumentTitleRenamePayload":ta.getNewDocumentTitle=y.payload.getNewDocumentTitle;break;case "MenuOpenPayload":aa={};aa[y.payload.launcherId]=u;this.Mab.sYc(aa,fh.g(y.payload));this.mtb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ta.MenuItemId=y.payload.url;this.tJm(y.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":ta.MenuItemId=y.payload.assetId;ta.SourceControlId=b;r.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ta.IsPremium=y.payload.isPremium||!1);this.uJm(y.payload.pageId);break;case "CoauthorGallery":ta.RenderTime=y.triggerTime;break;case "PeopleWell":ta.RenderTime=y.triggerTime;break;case "SyncStatus":ta.SourceControlId=b;break;case "InputBoxModel":ta.Text=y.payload.newValue;break;case "PersonaButtonModel":ta.CommandValueId=
y.payload.commandValueId;this.V3l(y.payload);break;default:return}aa&&!this.isShadowMenuOpen(y.payload)&&(ta.CommandValueId||(ta.CommandValueId=ta.MenuItemId),h.legacyControlId&&(ta.LegacyId=h.legacyControlId),ta.SourceControlId||(ta.SqmControlId=b),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ta.launcherId&&(h=this.lm.getCommandByExternalUxId(ta.launcherId))&&(ta.launcherCommandId=parseInt(h.commandId)),y.payload&&!Oe.c(y.payload.PRIReadinessCheck)&&
(ta.PRIReadinessCheck=y.payload.PRIReadinessCheck,this.h1g=!0),y.payload&&!Oe.c(y.payload.shouldTakeFocus)&&(ta[Gy.a.u5a]=y.payload.shouldTakeFocus),h=this.Uch(y,ta),Oe.c(y.triggerTime)||(Pa.TriggerTime=y.triggerTime),y.payload&&!Oe.c(y.payload.userActionKey)&&(Pa.userActionKey=y.payload.userActionKey),this.V4i(Pa,y,b,aa),this.z3g.executeCommand(aa,ta,this.getSelectedTabId(),h,!0,()=>{this.Tyi(ta,b)},Pa,fh.g(y.payload)))}V4i(b,h,u,y){this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",
!1)&&u&&y&&(u=h.payload&&!Oe.c(h.payload.launcherId)?h.payload.launcherId:u,b.ControlId=this.I0i(this.MLl(u,y),y,!1));this.Ma&&this.Ma.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.I0i(h.payload.terminalParentControlId,y,!0))}I0i(b,h,u){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;w.ULS.sendTraceTag(510247689,207,15,u?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":
"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}MLl(b,h){h=parseInt(h);h=De.ActionManager.o1e(h)||De.ActionManager.dea(h)||"";return!Oe.c(h)&&h in this.inc?this.inc[h]:100<b.length?"":b}tCf(){this.Zq&&this.Zq.execute(b=>{b.fCf("ModernFontPickerExperience")})}Uch(b,h){let u=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(u=b.payload.inputMethod,h[Gy.a.ox]=u);return u}Tyi(b,h){const u=Object(na.a)(xe.AFrame,r.AFrameworkApplication.ta);
if(this.Vb&&this.D$i(b)){if(!this.Vb.currentScope&&u){let y="null";if(b){const P=b.Value;delete b.Value;y=Ma.a.toJSON(b);Oe.c(P)||(b.Value=P)}w.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,y,u.L4a)}this.Vb.nPh()}(this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name!==xe.AFrame.Noa&&u&&this.Vb.currentScope.name!==u.L4a||this.D$i(b))&&this.qIk(b)}D$i(b){return!!b&&
!Oe.c(b[Gy.a.u5a])&&b[Gy.a.u5a]}qIk(b){Gy.a.ox in b&&1===b[Gy.a.ox]&&zE.ShyRibbon.hdb(1,0)}N4l(b,h){fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.P$();this.Nda.Nl();if(this.q0j&&this.ga){const u={};u[mI.a.V8f]=h.payload.tabId;this.ga.Ub(Wa.a.K0c,2,u,this.Ifa(h));Oe.c(h.payload.inputMethod)||(this.ga.processAction(Wa.a.qYi,2),this.Grd||this.Oao(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.lm.$mf(h);
w.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Zq&&h){const u=h+"TabSwitchActivity";this.Zq.execute(y=>{y.fCf(u)})}}lNc(b,h,u){const y=b.type;return"MenuClosePayload"===y?!0:"MenuOpenPayload"===y?(h(b,u),!0):!1}V3l(b){b=b.type;"MenuOpenPayload"===b?r.AFrameworkApplication.c5c=!0:"MenuClosePayload"===b&&(r.AFrameworkApplication.c5c=!1)}Thn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const u=
b.payload.launcherId,y=this.lm.getCommandByExternalUxId(u);return y&&y.populationProps?((b=this.Mab.SQf(y,h,b.payload))&&u in this.mtb&&delete this.mtb[u],b):!1}qxo(b,h){const u=b.launcherId;this.Pgc(u,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(u),this.Mjc(h,u,fh.g(b)))}oyo(b,h){const u=b.launcherId;this.Pgc(u,h)&&(h=fh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(u):appChrome.selectors.getFlyoutAnchorMenuItems(u),this.Mjc(h,u,fh.g(b)))}Wzo(b,h){const u=
b.launcherId;this.Pgc(u,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(u),this.Mjc(h,u,fh.g(b)))}LAo(b,h){const u=b.launcherId;this.Pgc(u,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(u),this.Mjc(h,u,fh.g(b)))}SAo(b,h){const u=b.launcherId;this.Pgc(u,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(u),this.Mjc(h,u,fh.g(b)))}getSelectedTabId(){return this.b3i?appChrome.selectors.getSelectedTabId():null}Mjc(b,h,u){this.Mab.sYc(b,u);this.mtb[h]=new Date}Pgc(b,h){let u=!0;b in this.mtb&&
(u=this.mtb[b].getTime()<this.Nda.Nna.getTime());return u&&!h&&this.b3i}nLh(b,h){const u={};var y=b.payload.selectedGalleryId;const P=this.lm.getCommandByExternalUxId(y);if(P){u.SourceControlId=y;u.MenuItemId=P.menuItemId;u.SqmControlId=h;P.legacyControlId&&(u.LegacyId=P.legacyControlId);b.payload&&!Oe.c(b.payload.shouldTakeFocus)&&(u[Gy.a.u5a]=b.payload.shouldTakeFocus);this.nOl(b.payload,u);(y=this.Ifa(b))||(y={});this.V4i(y,b,h,P.commandId);const aa=this.Uch(b,u);this.z3g.executeCommand(P.commandId,
u,this.getSelectedTabId(),aa,!0,()=>{this.Tyi(u,h)},y,fh.g(b.payload))}}nOl(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}w3f(b,h){b.payload&&"toggled"in b.payload&&(h[ag.a.On]=b.payload.toggled)}oQm(b,h){if("MenuOpen"===b){if(this.RY&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.RY.onMenuOpen()}else if("MenuClose"===b&&this.RY)this.RY.onMenuClose()}P$(){this.RY&&this.RY.JKf()}Ifa(b){let h=null;Oe.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}T2l(b,
h,u){if(this.CLj&&this.ga){const y={};y[kI.a.l3d]=u;this.ga.Ub(Wa.a.J0c,2,y)}this.Mjc(h.pageControlIdMap,b,fh.g(h))}uJm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Wa.a.vYi,2);break;case "FileNewPage":this.ga.processAction(Wa.a.wYi,2)}}tJm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Wa.a.YXi,2);break;case "FileOpenPage":this.ga.processAction(Wa.a.ZXi,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}Oao(b){if(r.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&
"Help"===b)this.Zq.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Grd=!0;else{if(r.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Zq.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.f4j)){this.Grd=!0;return}r.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Wa.a.$Mb,2)&&(this.Grd=!0)}}aDk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.h1g&&appChrome.PRIToastManager.dismissToast()}}
Object(m.a)(HI,"ReactExecuteCommandHandler",null,[]);class II{constructor(){this.fileMenu=null}get Oob(){return 0}get O2a(){return 0}get SEa(){return!1}kxa(){}Kij(){}DZ(){return!1}z5i(){}M2(){return!1}xHa(b){return this.fileMenu&&this.fileMenu.fRa(b)?!0:!1}get eia(){return!1}Fmb(){}CSd(){return!1}get PAd(){return null}set PAd(b){}uea(){}jaa(){}Xnf(){return null}UMa(){}refresh(){}get controls(){return null}eec(){return!1}ydb(){}Nl(){}get ME(){return null}set ME(b){}a7c(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(m.a)(II,"ReactRibbonExternal",null,[600,544,601]);class JI{constructor(b,h,u,y){this.Vb=b;this.ga=h;this.U$g=u;this.vWb=y}initialize(){this.ga.pa(Wa.a.v9d,le.a.frame,Object(v.a)(this,this.v_i,"ribbonMoveForwardAction"));this.ga.pa(Wa.a.u9d,le.a.frame,Object(v.a)(this,this.u_i,"ribbonMoveBackwardAction"));this.ga.pa(Wa.a.t9d,le.a.frame,Object(v.a)(this,this.r_i,"ribbonEscAction"));var b=ir.a.jsf(this.vWb,null,this.U$g,!1);b.BK=!0;this.cec(b,Wa.a.v9d,Wa.a.u9d);b.bindAction(Rb.KeyInputManager.lc(fb.a.Q6a,
0),Wa.a.t9d);b=this.Vb.le(xe.AFrame.Noa);b.BK=!0;this.cec(b,Wa.a.MZa,Wa.a.MZa);Re.a.instance.mb(bb.a.qx,this.U$g,Object(v.a)(this,this.v8m,"onRibbonMouseDown"));b=go.a.instance;fh.a("enterKeytipMode")&&b.w_n(this.vWb,()=>{appChrome.api.enterKeytipMode(!1)});fh.a("exitKeytipMode")&&b.s_n(this.vWb,()=>{appChrome.api.exitKeytipMode();zE.ShyRibbon.hdb(1,0)});r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna&&(b=Object(na.a)(ub.FocusManager,this.Vb))&&b.ffk(Object(v.a)(this,this.Z3m,"onFocusScopeChanged"))}Z3m(b,
h){if((b=Object(na.a)(xe.AFrame,r.AFrameworkApplication.ta))&&h.vAi&&r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna){const u=appChrome.selectors.getShyState();u.isActive&&h.vAi.name===b.L4a&&zE.ShyRibbon.hdb(u.state,1)}}v_i(){return 4}u_i(){return 4}r_i(){fh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna&&appChrome.selectors.getShyState().isActive&&zE.ShyRibbon.hdb(1,0),this.Vb.Dg(xe.AFrame.So));return 4}cec(b,h,u){const y=
Rb.KeyInputManager.lc(fb.a.xx,0),P=Rb.KeyInputManager.lc(fb.a.xx,4);b.Mr(y);b.Mr(P);b.bindAction(y,h);b.bindAction(P,u)}v8m(b){b.Ib&&b.Ib.target&&"input"!==b.Ib.target.tagName.toLowerCase()&&b.Ib.preventDefault();return!1}dispose(){this.ga.kz(Wa.a.v9d,le.a.frame,Object(v.a)(this,this.v_i,"ribbonMoveForwardAction"));this.ga.kz(Wa.a.u9d,le.a.frame,Object(v.a)(this,this.u_i,"ribbonMoveBackwardAction"));this.ga.kz(Wa.a.t9d,le.a.frame,Object(v.a)(this,this.r_i,"ribbonEscAction"))}}Object(m.a)(JI,"ReactRibbonFocusManager",
null,[9]);class BB{constructor(b,h,u,y,P,aa,ta,Pa=null,vb=!0,Kb=null,Sb=null){this.w9a=this.Isd=this.rpe=this.Nda=null;this.b5g=[];this.Fod=null;this.MKa=b;this.ODe=h;this.vWb=u;this.Vb=y;this.ga=P;this.lm=aa;this.Nda=Kb?Kb:new YE(Ru.instance,this.lm);this.Lsc=ta;this.o3g=new II;this.NKa=Pa;this.CLe=vb;new FI;this.fKg=Sb;Zh.a.get_instance().al(7,Object(v.a)(this,this.N0n,"setRibbonPostInteractiveReady"));Zh.a.get_instance().al(7,Object(v.a)(this,this.cNm,"logRibbonLoadedActivity"));Zh.a.get_instance().al(19,
Object(v.a)(this,this.XHm,"logAppLoadedActivity"));r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&Zh.a.get_instance().al(7,Object(v.a)(this,this.pBn,"registerSubComponentReporting"));Zh.a.get_instance().al(7,Object(v.a)(this,this.Lqn,"queueSettingsDependentActions"))}initialize(b,h,u=null){this.CLe||this.PK(5);u?u.then(()=>{this.kXi()}).catch(()=>w.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
EI.a.I5c(EI.a.I5c(pf.Task.WAA(this.Csi(b),this.Bsi(BB.EHj)),()=>this.Bsi(BB.$Dj)),()=>this.Csi(h)).continueWith(()=>{this.kXi()},11)}dispose(){this.Nso();this.w9a&&this.w9a.rGh();this.Fod&&this.Fod.dispose();for(const b of this.b5g)Zh.a.get_instance().oFk(b);r.AFrameworkApplication.ya.kz(Wa.a.ZIn,le.a.frame,De.ActionManager.Mf)}Bsi(b){return Ja.a.instance.resolve("Common.ISharedDependencyLoader").Y$b(r.AFrameworkApplication.Nw(b,2))}Csi(b){return""===b?pf.Task.X6(!0):Ja.a.instance.resolve("Common.ISharedDependencyLoader").Y$b(r.AFrameworkApplication.Nw(b,
3))}sem(){(this.NKa||this.Lsc)&&appChrome.api.dispatch(this.Q6h());this.J2n();fh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(r.AFrameworkApplication.u4);this.Nda.Nl()}kXi(){this.sem();this.CLe&&(appChrome.renderAppChrome(this.MKa,fh.e()),this.PK(10));this.cch();this.KYe();this.CLe&&this.PK(5);this.ndi()}ndi(){this.Vb&&this.ga&&this.vWb&&(this.Fod=new JI(this.Vb,this.ga,this.MKa,this.vWb),this.Fod.initialize())}get k1c(){return this.o3g}setCommandDefinitionMapping(){if(fh.a("setCommandDefinitionMapping")){const b=
oM(this.lm);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna&&fh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.jdc()})}cch(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(na.a)(YE,this.Nda);this.rpe=new HI(this.Nda,b.$dc,this.lm,this.Vb,this.ODe,Ja.a.instance.Pa("Common.IRibbonSQMInformation"),Ja.a.instance.Pa("Common.IFileMenuSQMInformation"),
r.AFrameworkApplication.ya,r.AFrameworkApplication.K,Ja.a.instance.Za("Common.ISystemInitiatedFeedback"),null);this.rrk();this.T1l()}rrk(){this.Isd=appChrome.api.bindCommandHandler((b,h)=>{this.rpe.executeCommand(b,h)})}Nso(){this.Isd&&(this.Isd(),this.Isd=null)}J2n(){appChrome.api.initializeLogger(new nm.a)}nDa(){return this.Nda?this.Nda.nDa():[]}jdc(){fq.a.instance.Sd(()=>{let b=null;fq.a.instance.Sd(()=>{b=this.nDa()},"RB:GA");b&&0<b.length&&(this.Nda.Nna=new Date,fq.a.instance.Sd(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.w9a&&fq.a.instance.Sd(()=>{this.w9a.lMi()},"RB:J")},"RB:PFSU")}m7c(){this.Nda.m7c()}vIb(){}R8j(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}Q6h(){var b=r.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ja.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>
{u.isFeatureEnabled("ConnectedServices",!0).then(y=>{y&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.QWh());b=new pM.a(this.lm);this.NKa.uG&&(qM.a.Spo(this.NKa.uG),h.push.apply(h,b.tId(this.NKa.uG)));if(this.NKa.Dkj)for(const u of this.NKa.Dkj)h.push(appChrome.actions.updateGallerySectionHiddenState(u.RQh,u.KZo,u.L0o));h.push.apply(h,b.NRh(this.NKa.Hkj));
return h}QWh(){const b=[];if(this.Lsc&&this.Lsc.uG){const u=this.Lsc.uG;for(let y in u){var h=u[y];const P=this.lm.Aif(y);if(P)for(let aa of P)b.push(appChrome.actions.updateControlHiddenState(aa,h))}}return b}uHa(b){b&&this.Nda.$dc.sYc(b,0)}SQf(b){this.Nda.$dc.SQf(this.lm.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}r6k(){const b=r.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=r.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.GAo(b,
"Shared"===(h.SharingStatus||"")))}Lqn(){r.AFrameworkApplication.K.lp(()=>{this.r6k()})}GAo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}UTl(b){return appChrome.actions.updateControlHiddenState(b,!1)}VTl(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}PK(b){Zh.a.get_instance().PK(b);this.b5g.push(b)}N0n(){fh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new DI,{postRibbonInteractiveReady:!0})))}KYe(){this.Lsc&&
this.fKg&&(this.w9a=this.fKg.l4e(),this.o3g.fileMenu=this.w9a)}dCm(b,h){this.w9a&&this.w9a.eri(b,h)}j_f(b,h,u){if(1===u)return 32;this.j7i(!0);this.jdc();r.AFrameworkApplication.ta.updateCommandUI();return 32}k_f(b,h,u){if(1===u)return 32;this.j7i(!1);this.Y0n();this.jdc();r.AFrameworkApplication.ta.updateCommandUI();return 32}Y0n(){Xa.a.cSa(r.AFrameworkApplication.K.lb("IsSimplifiedRibbonOnCookieName"),"true",Xa.a.aQa)}j7i(b){Xa.a.cSa(r.AFrameworkApplication.K.lb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),Xa.a.aQa)}cNm(){if(r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.nq){const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),r.AFrameworkApplication.Bga("d79fg304;61jba833;h856e313;f5i2f477")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),r.AFrameworkApplication.Bga("69a7h198;dfd7j584"))}}XHm(){const b=
Xa.a.rfa(r.AFrameworkApplication.K.lb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const h=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");h&&(r.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(u=>{u.logActivity("VNextStylesOn",null)}),h.execute(u=>{u.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):r.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(u=>{u.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},
5E3)}pBn(){Zh.a.get_instance().al(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let u in b){var h=u;const y=b[u];if(y)for(const P of y)r.AFrameworkApplication.ya.Z6(P)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):r.AFrameworkApplication.ya.p_n(P,this.wVk(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}wVk(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}T1l(){if(r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&r.AFrameworkApplication.Zcc.NRe){const b=r.AFrameworkApplication.Zcc.NRe,h=r.AFrameworkApplication.Zcc.Bbh;h.payload||(h.payload={});const u=h.payload.launcherId?h.payload.launcherId:b;BB.x_i.ub(u)?BB.x_i.J(u)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():
(h.payload.PRIReadinessCheck=!0,this.rpe.executeCommand(b,h))}}}BB.EHj="common";BB.$Dj="appChrome";BB.x_i=new nM.a(la.a.QMc());Object(m.a)(BB,"ReactRibbonUser",null,[710,152,9]);class kG extends BB{constructor(b,h,u,y,P,aa,ta,Pa,vb=null,Kb=!0,Sb=null,Yb=null){super(b,h,y,P,aa,ta,Pa,vb,Kb,Sb,Yb);this.Ned=null;this.Yrb=u;this.Yrb.execute(Ac=>{this.Ned=Ac});this.Yrb.execute(Ac=>{this.Nda.ME=Ac})}nDa(){return this.Ned?(this.Ned.clearCache(),super.nDa()):[]}vIb(b){if(!b)throw Error.argumentNull();this.Yrb.execute(h=>
{b.ME=h})}}Object(m.a)(kG,"ReactRibbonUser",BB,[]);var sM=c(975);class AE extends kG{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb=!0,Sb=null,Yb=null){super(h,b.ACa,y,$g.AppFrame.Xoa,P.Hh,P.Bc,ta,Pa,vb,Kb,Sb,Yb);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.Kwe=b;this.g$=aa;P.kTa(()=>{this.pAo();r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Zh.a.get_instance().al(7,()=>{this.edi()}):this.edi()},null)}get Kuf(){return!!r.AFrameworkApplication.K.appSettings.BootActivityNavigationId}edi(){this.BTk();
this.l4e();this.dyn()}pAo(){this.MKa.classList.add("FlexBoxLayout");this.Kwe.oma().classList.add("cui-exth");this.Kwe.oma().classList.add("FlexBoxLayout");this.Kwe.oma().classList.add("ScrollableRibbon")}BTk(){r.AFrameworkApplication.zT||this.uXk()}uXk(){if(!r.AFrameworkApplication.zT){var b=(new uI(AE.o0j,this.g$)).Fcl(),h=ir.a.jsf($g.AppFrame.qOa,null,b,!0);h.BK=!0;this.cec(h,Wa.a.v9d,Wa.a.u9d);h.bindAction(Rb.KeyInputManager.lc(fb.a.Q6a,0),Wa.a.t9d);xk(1,()=>{this.mHn(b)})}}mHn(b){const h=new BI;
appChrome.renderSharedHeader(b,h.Nua()).then(this.V8e.bind(this))}VUi(){r.AFrameworkApplication.ta.Pb.Kni?appChrome.getHeaderApi().then(b=>{document.getElementById(r.AFrameworkApplication.ffb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new sM.a).V8e()}V8e(){this.Kuf&&r.AFrameworkApplication.Bga("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.Kuf&&r.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(Zh.a.get_instance().al(12,this.VUi.bind(this),
11),w.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.VUi()}cec(b,h,u){const y=Rb.KeyInputManager.lc(fb.a.xx,0),P=Rb.KeyInputManager.lc(fb.a.xx,4);b.Mr(y);b.Mr(P);b.bindAction(y,h);b.bindAction(P,u)}l4e(){const b=!!this.NKa&&"FileMenu"in this.NKa.Hkj;r.AFrameworkApplication.ta.Pb.jPa&&!b&&xk(1,this.LGn.bind(this))}LGn(){const b=[];if(r.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new iG,
{label:CommonUIStrings.L_DiagnosticsSessionId,value:r.AFrameworkApplication.userSessionId}),Object.assign(new iG,{label:CommonUIStrings.L_DiagnosticsBuild,value:r.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.QWh());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}dyn(){this.ga.pa(Wa.a.ySa,oc.a.view,this.ySa.bind(this));this.ga.pa(Wa.a.j_f,oc.a.view,this.j_f.bind(this));
this.ga.pa(Wa.a.k_f,oc.a.view,this.k_f.bind(this))}activateRibbonTab(b){this.R8j(b)}jdc(){Zh.a.get_instance().isCompleted(7)&&this.Ned&&(kh.a.mark(4893),jv.a.Vzo(),super.jdc(),kh.a.mark(4894))}ySa(b,h,u,y,P){if(2===P[Gy.a.ox]){if(u=Object(na.a)(az.a,h))y=Object(na.a)(rz.a,u.view);else return w.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,Ma.a.join(P," ",":")),8;if(y&&""!==y.vI)Ye.a.dga(h)&&
Ye.a.B8b()||(this.Vb.Dg(y.vI),appChrome.selectors.getShyState().isActive&&zE.ShyRibbon.hdb(0,1));else return w.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(u.view),b,Ma.a.join(P," ",":"),this.WGl(u.view)),8}return 32}WGl(b){return b?"is ContentEditableView: "+b.Kj+" is Editing View: "+b.rva+" is FishbowlView: "+b.mna+" is HtmlView: "+b.L1a+" is InteractiveView: "+b.ue+
" is NavigationPaneView: "+b.sli+" is PageView: "+b.mi+" is WordNavigationPaneHeadingsView "+b.BVd:"null view"}}AE.o0j="WACRibbon";Object(m.a)(AE,"ReactRibbonUser",kG,[709,710,152,9]);class KI extends AE{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd=null,Ad,he){super(b,h,u,y,P,aa,ta,Pa,vb,!1,Sb,nd);this.ijk=()=>{this.Zq&&this.Zq.execute(ce=>{ce.logActivity("WordShyRibbon",null)});return 32};this.Hdm=()=>{eh.a.instance.Wf(jh.a.Sem,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(ce=>
{var Nd;if(!r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerCleanupIsEnabled",!1)&&!r.AFrameworkApplication.K.$("CollabCornerCleanupIsEnabled")){var re=r.AFrameworkApplication.K.$("ShareMenuIsEnabled");const vg=re?"ShareTopBar":"Share";this.FLe?ce.push(this.UTl(vg)):ce.push(appChrome.actions.removePeripheralControl(vg));this.p2j?ce.push(this.VTl()):ce.push(appChrome.actions.removePeripheralControl("CopyLink"));re&&!this.FLe&&ce.push(appChrome.actions.updateControlHiddenState("ShareMenu",
!this.FLe))}this.NKa&&ce.push.apply(ce,this.Q6h());(this.P5g||this.Q5g)&&this.lbb&&ce.push.apply(ce,this.nvl());ce.push(appChrome.actions.setControlCustomTooltip(yn.a.KCm,CommonUIStrings.l_LoopsLearnMoreTooltip));r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Bna&&this.c4n();re=null===(Nd=r.AFrameworkApplication.K)||void 0===Nd?void 0:Nd.lb("ReactShyRibbonPreferenceCookieName");Nd=Xa.a.get(re);appChrome.api.isSmallDevice()&&r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZI&&
""===Nd&&r.AFrameworkApplication.Ce("66h8i182;1ha8c781");ce.push.apply(ce,this.nDa());ce.push(appChrome.actions.setControlBehaviorAttached(!0));const Xd=Ja.a.instance.resolve("WordEditor.IModeSwitcherControl");Nd=Xd.AGl();r.AFrameworkApplication.Ce("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(re=appChrome.selectors.getModeSwitcherMode())&&re!==Nd.activeMode&&w.ULS.sendTraceTag(527778651,
306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${Nd.activeMode}, Actual: ${re}`);"Suggest"===Nd.activeMode||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===Nd.activeMode?appChrome.getUpdateAppModeAndTabsActions(Nd).then(vg=>{appChrome.api.dispatch(ce.concat(vg));Xd.nxi();this.tdi()}):(ce.push(appChrome.actions.updateModeSwitcher(Nd)),appChrome.api.dispatch(ce),Xd.nxi(),this.tdi())})};this.FLe=
Kb.Rbe();this.p2j=Kb.$4f();this.lbb=Yb;this.P5g=Ac;this.Q5g=Sc;this.Zq=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");this.Gb=Ad;this.cve=he}Rem(){w.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Zh.a.get_instance().PK(5);const b=this.Kuf&&r.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;Zh.a.get_instance().al(b,this.Hdm,11);r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.zbk()}zbk(){this.Gb.Xb(new sc.a(5,
1,0,()=>{this.cve.execute(b=>{b.W_n()})}))}nvl(){const b=[];this.P5g&&(b.push(appChrome.actions.setButtonSecondaryText(yn.a.ECd,this.lbb.N8l)),b.push(appChrome.actions.setButtonSecondaryText(yn.a.cBd,this.lbb.M8l)),b.push(appChrome.actions.setButtonSecondaryText(yn.a.X3d,this.lbb.O8l)));this.Q5g&&b.push(appChrome.actions.setButtonSecondaryText(yn.a.U3d,this.lbb.P8l));return b}c4n(){this.Zq&&appChrome.api.isSmallDevice()?this.Zq.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",null)}):this.Zq.execute(b=>
{b.logActivity("ShyRibbonNormalScreenActivity",null)});r.AFrameworkApplication.ya.gb(Wa.a.Ogh,le.a.frame,this.ijk,96)}tdi(){r.AFrameworkApplication.Zcc.Mso();this.cch();this.KYe();this.ndi();Zh.a.get_instance().PK(7);eh.a.instance.Eka(jh.a.eBc,jh.a.rNn,(new Date).getTime())}uHa(b){if(b){const h=this.VXh();try{super.uHa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}nDa(){const b=this.VXh();try{return super.nDa()}finally{null===b||void 0===b?void 0:b.dispose()}}VXh(){var b;let h=void 0;const u=
null===(b=Ra.App.kk)||void 0===b?void 0:b.sl;u&&(h=new dg.GraphTransaction(Ra.App.Iii()&&Ra.App.Wvf?0:2),h.set(u));return h}}Object(m.a)(KI,"ReactRibbonUser",AE,[]);var tM=c(1126);class LI extends fG{constructor(b,h,u,y,P,aa,ta,Pa){super(b,h,u);this.zze=r.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&ba.a.r3;this.lm=P;this.wIe=aa;this.Gb=ta;this.cve=Pa}LWk(b,h){const u=new yD(r.AFrameworkApplication.K,this.ga,this.Vb,this.zze),y=new kM.a(u);return this.eXk(b,h,y,u)}eXk(b,h,u,y){var P=new sI(new tI(r.AFrameworkApplication.K,
y),u);u=this.oem(P);const aa={};P.Ymb(aa);P=!ba.a.r3;const ta=ba.a.Wp||ba.a.kj;var Pa=ba.a.Kl;r.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Pa=ba.a.zi||Pa);Pa=new EH.a(Pa);b=new KI(b,h,WordEditorIntl.WordEditorStrings,this.Yrb,y,b,this.lm,u,new oI(aa),new tM.a(null),this.wIe,Pa,P,ta,new rI,this.Gb,this.cve);b.Rem();return b}oem(b){const h={};b.E2c(h);b.z7c(h);return new pI(null,h,"jewelWordEditor")}}Object(m.a)(LI,"WordEditorRibbonUserFactory",fG,[]);class lG{constructor(b,h){this.Gz=
b;this.Fkd=h}aNa(b,h,u,y=null,P=null){return this.Fkd.n$i(b)?this.Fkd.aNa(b,h,u,y,P):this.Gz.aNa(b,h,u,y,P)}tEa(b,h=null){return this.Fkd.n$i(b)?this.Fkd.tEa(b):this.Gz.tEa(b,h)}}Object(m.a)(lG,"RootCuiUser",null,[355]);class MI extends lG{constructor(b,h){super(b,h)}clearCache(){this.Gz.clearCache()}}Object(m.a)(MI,"WordGeneralCuiUser",lG,[354,355]);class oF{static getSelectedText(){const b=(new zq.a).pmf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static bMd(b){b=b?b.trim():null;
let h=20;b&&0<b.length&&(b.length>h&&(h=A.a.az(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(m.a)(oF,"SearchUtils",null,[]);class Tx extends aF{constructor(b,h,u){super(b,u);this.JH=h}Fff(b){const h=[],u=Hh.a.instance.hb.kb,y=!!this.JH&&this.JH.VRc(Oa.a.r_e.toString()),P=!!this.JH&&this.JH.VRc(Oa.a.pKb.toString()),aa=!y&&!u.A1a&&Tx.Y4a.Axi(),ta=!!this.JH&&this.JH.VRc(Wa.a.newComment.toString())||!!wb.a.instance&&(3===wb.a.instance.mode||2===wb.a.instance.mode),Pa=u.yni()&&
r.AFrameworkApplication.ta.Pb.PRc;var vb=!1;if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){vb=!!u&&(u.Nx||2===u.length&&Se.SelectionEditor.Dk(u.Tc));var Kb=oF.getSelectedText();vb=vb&&0<Kb.length&&60>Kb.length}b=(Kb=3===b||ba.a.zi||r.AFrameworkApplication.wef)&&Tx.u$e.SZ(u,b);Kb&&h.push(this.lm.aDa("ClipboardGroup")[0].externalUxGroupId);aa&&(h.push(this.lm.aDa("TextFormattingGroup")[0].externalUxGroupId),
h.push(this.lm.aDa("StylesGroup")[0].externalUxGroupId));vb&&h.push(this.lm.aDa("DefineGroup")[0].externalUxGroupId);y&&h.push(this.lm.aDa("PictureToolsGroup")[0].externalUxGroupId);P&&h.push(this.lm.aDa("TableToolsGroup")[0].externalUxGroupId);Pa&&h.push(this.lm.aDa("EquationToolsGroup")[0].externalUxGroupId);ta&&h.push(this.lm.aDa("CommentGroup")[0].externalUxGroupId);b&&h.push(this.lm.aDa("ContextMenuGroup")[0].externalUxGroupId);Tx.dnm&&h.push(this.lm.aDa("DesignerGroup")[0].externalUxGroupId);
return h}static get u$e(){return null!=Tx.Mng?Tx.Mng:Tx.Mng=Ja.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get Y4a(){return null!=Tx.Wvg?Tx.Wvg:Tx.Wvg=Ja.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static XOc(b,h,u,y){b.nrk(()=>Tx.Bdb(h,u,y))}static Bdb(b,h,u){return new Tx(b,h,u)}static get dnm(){null==this.yye&&(r.AFrameworkApplication.Ce("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.yye=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",
!1):!1);return this.yye}}Tx.yye=null;Object(m.a)(Tx,"WordReactFloatie",aF,[]);class mG{constructor(){this.ada=this.ryc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").oQf();const h=Ra.App.Bw.kI,u=Ra.App.xa;Tx.XOc(u,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.ada=this.W.Pa("Box4.IContextMenuController");const y=new DH(u,h,this.W.Za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),
P={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=r.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:P["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:P["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:P["floatie.gbUseSmartPasteButton"]=!1}y.XOc("PasteFloatieData",null,P);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();
(new fI(u,h,this.W.Za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).XOc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");Zh.a.get_instance().al(7,()=>{this.ryc=this.W.resolve("WordEditor.UI.StatusBarUser");this.ryc.Wb()})}dispose(){this.ryc&&(this.ryc.dispose(),this.ryc=null);this.ada&&(this.ada.dispose(),this.ada=null)}xc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new IH(b.resolve("CommonUI.IBusinessBar"),
b.resolve("CommonUI.IBusinessBarEntryFactory"),r.AFrameworkApplication.ya,r.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();let h=ba.a.Kl;r.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=ba.a.zi||h);b.ha("Box4.UI.ShortcutHintMapping",()=>new EH.a(h));const u=ba.a.Wp||ba.a.kj,y=r.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(ba.a.r3||u),P=r.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");
b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new Oo(Ja.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ja.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new ie.a)).singleInstance();b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new pp(r.AFrameworkApplication.ya,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),r.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
P?b.Za("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),b.Pa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Za("Box4.IPresenceDataManager"),b.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Za("WordEditor.ContextualSearch.ISearchSuggestionManager"),
b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),y,u?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ja.a.instance.Za("Common.IActionContextProvider"),Ja.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Pa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();
b.ha("Box4.ISelectionContextMenuProvider",()=>new Bz).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new fm(r.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();b.ha("WordEditor.UI.DialogFactory",()=>new eI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();b.ha("Common.NonCanvasCuiUser",()=>new tE(ub.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new MI(b.resolve("Box4.IGeneralCuiUser"),
b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new jI(Ra.App.xa.L7f,b.Za("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),r.AFrameworkApplication.ya,r.AFrameworkApplication.K,Ra.App.xa)).as("WordEditor.IStatusBarUser").singleInstance();b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new wE).singleInstance();const aa=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",
()=>new YE(Ru.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),aa)).singleInstance();const ta=b.Za("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",()=>new LI(ta,r.AFrameworkApplication.ya,ub.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),r.AFrameworkApplication.uc,b.Za("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();
b.ha("WordEditor.UI.ReactLanguageDialog",()=>new xE(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new nI(r.AFrameworkApplication.ya)).as("Common.IRibbonSQMInformation").singleInstance();b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new lI(r.AFrameworkApplication.ya)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new gI).as("WordEditor.IRulerUser");
b.ha("WordEditor.UI.RulerContextMenu",()=>new cC(r.AFrameworkApplication.ya,Ja.a.instance.Za("Common.IZoomManager"),Zq.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();b.ha("Common.IReactContextualUILauncher",()=>new zH(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();b.ha("Box4.IContextMenuController",()=>new FH(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){r.AFrameworkApplication.Ce("5b6i5792;30d4f535");
Lk.instance.eJh();Lk.instance.daf();K.a.instance.Kc(new mG,6)}}Object(m.a)(mG,"WordEditorUIPackage",null,[1,2]);var uM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},
children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},
rC={};rC.Jkc=function(){function b(){return ta()&&(nd()||3<=(Yb()?Ad("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function u(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function y(uf){uf=(new RegExp(uf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var ii=-1;null!=uf&&2<=uf.length&&(ii=parseFloat(uf[1]),isNaN(ii)&&(ii=-1));return ii}function P(){NI||(NI=!0,OI=y("Windows Phone"));return 8<=OI}function aa(){return"function"==typeof navigator.msLaunchUri&&
!u()&&!Sc()&&!Pa()}function ta(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Pa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function vb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Kb(){return vb()?8==window.document.documentMode:!1}function Sb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Yb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Ac(){return 0<=
window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Sc(){var uf=window.navigator.userAgent.toLowerCase();return 0<=uf.indexOf("android")&&0<=uf.indexOf("chrome")}function nd(){return 3<=(Sb()?Ad("firefox/"):0)}function Ad(uf){var ii=window.navigator.userAgent.toLowerCase(),Nl=ii.indexOf(uf);return 0<=Nl?parseInt(ii.substring(Nl+uf.length,ii.length)):0}function he(uf,ii,Nl,nl,tq){if(nl&&null!=ii)ii();else if(aa())navigator.msLaunchUri(uf,ii,Nl);else if(!(Ac()||0<=window.navigator.userAgent.indexOf("iPhone")||
0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ta())||Pa())Nd(uf,ii,Nl);else if(Ac()&&tq)a:{try{window.open(uf,"_self")}catch(ht){null!=Nl&&Nl();break a}null!=ii&&ii()}else ce(uf,ii,Nl)}function ce(uf,ii,Nl){var nl=document.getElementById("OICLinkTag");null==nl&&(nl=document.createElement("a"),nl.id="OICLinkTag",nl.style.visibility="hidden",nl.href="",0==(or.Options&Ux.SupportsTopTargetNavigation)||or.NoBrowserModalDialogs?nl.target="_blank":nl.target="_top",document.body.appendChild(nl),
null!=nl.addEventListener&&nl.addEventListener("click",function(tq){null!=tq.stopPropagation&&tq.stopPropagation()},!1));try{nl.href=uf,nl.click()}catch(tq){null!=Nl&&Nl();return}null!=ii&&ii()}function Nd(uf,ii,Nl){var nl=document.getElementById("OICFrame");null==nl&&(nl=document.createElement("iframe"),nl.className="ObjectInDialog",nl.style.visibility="hidden",nl.src="about:blank",document.body.appendChild(nl),nl.id="OICFrame");try{nl.contentWindow.location.href=uf}catch(tq){null!=Nl&&Nl();return}null!=
ii&&ii()}function re(uf){return 0!=(uf.Options&Ux.SkipProtocolHandler)||Kb()}function Xd(uf){return uf===sC.ReadOnly||uf===sC.ReadWrite}function vg(uf,ii,Nl,nl){var tq;try{var ht=new ActiveXObject("SharePoint.OpenDocuments.4");return(tq=ht.ViewDocument3(window.self,uf,ii,nl))?(BD(CB.O14ActiveX),gq.None):gq.Failed}catch(it){}if(Ux.O14Only===(Nl&Ux.O14Only))return or.DescriptiveUnattemptedEnums?gq.O14AttemptFailure:gq.Unattempted;try{return ht=new ActiveXObject("SharePoint.OpenDocuments.3"),(tq=ht.ViewDocument3(window.self,
uf,ii,nl))?(BD(CB.O12ActiveX),gq.None):gq.Failed}catch(it){}if(Ux.O12UpOnly===(Nl&Ux.O12UpOnly))return or.DescriptiveUnattemptedEnums?gq.O12UpOnlyFail:gq.Unattempted;try{return ht=new ActiveXObject("SharePoint.OpenDocuments.2"),(tq=Xd(ii)?ht.ViewDocument2(window.self,uf,nl):ht.EditDocument2(window.self,uf,nl))?(BD(CB.O11ActiveX),gq.None):gq.Failed}catch(it){}return or.DescriptiveUnattemptedEnums?gq.ActiveXUnattempted:gq.Unattempted}function Vf(uf,ii,Nl,nl,tq){uf==ps.Visio&&Nl==sC.ReadWrite&&(Nl=sC.WriteOnly);
uf=tq;nl=nl||u()&&!P();nl||(nl="",nl=Xd(Nl)?nl+"ofv|ofc|":nl+"ofe|",uf+=zm(nl+"u|"));uf+=zm(ii);or.NewTelemetryDataIsEnabled&&(ii=or.SessionOrigin?"|or|"+or.SessionOrigin:"",ii+=or.ClickTime?"|ct|"+or.ClickTime:"",ii+=or.CorrelationId?"|cid|"+or.CorrelationId:"",uf+=zm(ii));ii=window.location.href;Nl=ii.toLowerCase().indexOf("&wdlor=");-1!=Nl?(Nl+=7,nl=ii.indexOf("&",Nl),ii=-1==nl?ii.substr(Nl):ii.substring(Nl,nl)):ii=void 0;if(null!=ii&&"undefined"!=typeof ii){Nl="";try{Nl=decodeURIComponent(ii)}catch(ht){}0<
Nl.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Nl)&&(uf=uf+"|f|"+Nl)}return uf}function kj(uf,ii,Nl,nl,tq,ht){var it=PI(uf);if(null==it)return IC(or.DescriptiveUnattemptedEnums?gq.ProtocolHandlerIsNull:gq.Unattempted,or.Application),!1;uf=Vf(uf,ii,Nl,nl,it);he(uf,rm,os,tq,ht);return!0}function zm(uf){if(ta()&&Ac()){var ii="";try{ii=decodeURI(uf)}catch(Nl){}if(ii==uf)return encodeURI(uf)}return uf}function rm(){BD(CB.ProtocolHandler)}function os(){or.Options|=Ux.SkipProtocolHandler;
QI(or,CD,DD)}function Us(){null!=nG&&nG(CB.RoamingProtocolHandler)}function Bu(){null!=oG&&oG(gq.ControlNeeded)}function DC(){var uf=document.getElementById("npSharePointPlugin");if(null==uf){uf="application/x-sharepoint";ta()&&3<=(Yb()?Ad("version/"):0)&&Hy("application/x-sharepoint-webkit",!0)&&(uf="application/x-sharepoint-webkit");if(!Hy(uf,!0))if(ta()&&Hy("application/officelive",!0))uf="application/officelive";else return null;var ii=document.createElement("object");ii.id="npSharePointPlugin";
ii.type=uf;ii.style.width="0px";ii.style.height="0px";ii.style.setProperty("visibility","hidden","");document.body.appendChild(ii);uf=document.getElementById("npSharePointPlugin")}return uf}function Hy(uf,ii){var Nl=window.navigator.mimeTypes;if(null==Nl)return!1;uf=Nl[uf];return!uf||ii&&!uf.enabledPlugin?!1:!0}function pF(uf){try{if(null!=new ActiveXObject(uf))return!0}catch(ii){}return!1}function pG(uf){switch(uf){case ps.OneNote:return"OneNote.Notebook";default:return""}}function PI(uf){if(uf!=
ps.OneNote&&u()&&!P())return"office:";switch(uf){case ps.Excel:return"ms-excel:";case ps.OneNote:return"onenote:";case ps.PowerPoint:return"ms-powerpoint:";case ps.Visio:return"ms-visio:";case ps.Word:return"ms-word:";case ps.Project:return"ms-project:";case ps.Publisher:return"ms-publisher:";case ps.Infopath:return"ms-infopath:";case ps.Access:return"ms-access:";default:return""}}function vM(uf){switch(uf){case ps.Excel:return"root\\office15\\excel.exe";case ps.PowerPoint:return"root\\office15\\powerpnt.exe";
case ps.Visio:return"root\\office15\\visio.exe";case ps.Word:return"root\\office15\\winword.exe";case ps.Project:return"root\\office15\\winproj.exe";case ps.Publisher:return"root\\office15\\mspub.exe";case ps.Infopath:return"root\\office15\\infopath.exe";case ps.Access:return"root\\office15\\msaccess.exe";default:return null}}function QI(uf,ii,Nl){or=uf;CD=ii;DD=Nl;if(uf.DocumentUrl){var nl=Nl=ii=uf.DocumentUrl;try{nl=decodeURIComponent(uf.DocumentUrl)}catch(ED){}try{Nl=encodeURI(uf.DocumentUrl)}catch(ED){}ii=
ii+""+uf.CorrelationIdForWinClient;nl+=uf.CorrelationIdForWinClient;Nl+=uf.CorrelationIdForWinClient;uf.Mode===sC.ReadWrite&&Ux.CheckoutRequired===(uf.Options&Ux.CheckoutRequired)&&(uf.Mode=sC.ForceCheckout);Ux.HostIsEditOnly===(uf.Options&Ux.HostIsEditOnly)&&(uf.Mode=sC.WriteOnly);if(re(uf)?0:ta()&&(uf.Application==ps.OneNote||Hy("application/x-sharepoint-protocolhandler",!1)||Hy("application/x-sharepoint-webkit-protocolhandler",!1))||aa()||Sc()||!(b()||nd()||"ActiveXObject"in window&&!u()||Ac())||
15<=qF())kj(uf.Application,uf.EncodeUrl?Nl:ii,uf.Mode,uf.Application==ps.OneNote,uf.SilentExternalHandler,uf.NavigateUsingWindowOpen);else{var tq;if(tq=Kb())a:{var ht=uf.EncodeUrl?ii:nl,it=uf.Mode,BE=pG(uf.Application);try{tq=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,ht,it,BE);break a}catch(ED){}tq=!1}if(tq)BD(CB.O15ActiveX);else{if(b()||nd()){var hu=uf.EncodeUrl?ii:nl;nl=uf.Mode;tq=pG(uf.Application);ht=DC();if(null==ht)hu=or.DescriptiveUnattemptedEnums?gq.PluginIsNull:
gq.Unattempted;else{it=!1;try{it=ht.ViewDocument3(window.self,hu,nl,tq)}catch(ED){}if(!it)try{it=Xd(nl)?ht.ViewDocument2(window.self,hu,tq):ht.EditDocument2(window.self,hu,tq)}catch(ED){}it?(BD(CB.NpapiPlugin),hu=gq.None):hu=gq.Failed}}else{try{hu=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=hu&&hu.SaveSSOCreds()}catch(ED){}hu=vg(uf.EncodeUrl?ii:nl,uf.Mode,uf.Options,pG(uf.Application))}if(hu!=gq.None){if(nl=uf.CouldUseRoamingApps)RI||(RI=!0,SI=y("Windows NT")),nl=6.1<=SI&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(vb()||nd()||Ac());if(nl&&uf.Application!=ps.OneNote){if(!rC.Jkc.uLo()){IC(gq.ControlNeeded,or.Application);return}if(uf.RoamingAppsLauncher){"undefined"==typeof uf.RoamingAppsLauncher||null==uf.RoamingAppsLauncher?IC(or.DescriptiveUnattemptedEnums?gq.RoamingLauncherIsNull:gq.Unattempted,or.Application):"undefined"==typeof uf.RoamingBitsUrl||null==uf.RoamingBitsUrl?rC.Jkc.RMo(uf.DocumentUrl,uf.RoamingAppsLauncher,uf.Application,uf.ApplicationParameters,CD,DD):rC.Jkc.Wxj(uf.DocumentUrl,uf.RoamingAppsLauncher,
uf.RoamingApplicationExe,uf.ApplicationParameters,uf.RoamingPlatform,uf.RoamingBitsUrl,CD,DD);return}if(!uf.ContinueIfLauncherIsNull){IC(gq.LauncherNeeded,or.Application);return}}Ux.NoProtocolHandlerFallback==(uf.Options&Ux.NoProtocolHandlerFallback)||re(uf)||vb()||ta()&&!(or.DescriptiveUnattemptedEnums?hu>=gq.O14Unattempted&&hu<=gq.DocumentUrlIsNull:hu==gq.Unattempted)?IC(hu,or.Application):kj(uf.Application,uf.EncodeUrl?Nl:ii,uf.Mode,uf.Application==ps.OneNote,uf.SilentExternalHandler,uf.NavigateUsingWindowOpen)}}}}else IC(or.DescriptiveUnattemptedEnums?
gq.DocumentUrlIsNull:gq.Unattempted,or.Application)}function BD(uf){null!=CD&&CD(uf)}function IC(uf,ii){"undefined"==typeof ii&&(ii=null);null!=DD&&DD(uf,ii)}function qF(){var uf=0;if(b()||nd()||Ac()){var ii=DC();try{null!=ii&&(uf=ii.GetOfficeVersion())}catch(Nl){}}else pF("SharePoint.OpenDocuments.5")?uf=15:pF("SharePoint.OpenDocuments.4")?uf=14:pF("SharePoint.OpenDocuments.3")?uf=12:pF("SharePoint.OpenDocuments.2")&&(uf=11);return uf}function TI(){return ta()&&(Hy("application/x-sharepoint",!0)||
Hy("application/x-sharepoint-webkit",!0))}var UI="",VI="",WI="",CD,DD,nG,oG,or,RI,SI,NI,OI,sC={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Ux={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},gq={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},CB={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},ps={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:sC,OpenDocumentOptions:Ux,OpenDocumentFailureType:gq,OpenDocumentControl:CB,OfficeApplication:ps,EditDocumentInClient:QI,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=ps.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=
this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:qF,IsO14MacPluginInstalled:TI,OfferOfficeInDialog:function(){return h()&&11>=qF()},OfferOfficeNoIntrusive:function(){return h()&&15>qF()},OfferMacOffice:function(){return ta()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!TI()},InstallRoamingControl:function(){Sb()?window.InstallTrigger.install({Office:{URL:VI}}):Nd(WI,null,null)},CanUseRoamingControl:function(){if(aa())return!0;if(Ac())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Sb()){var uf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(uf);var ii=document.createEvent("Events");ii.initEvent("RoamingOfficeInstalled",!0,!1);uf.dispatchEvent(ii);return!!uf.getAttribute("installed")}if(vb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Nl){}return!1},InitUrls:function(uf,ii,Nl){UI=uf;VI=Nl;WI=ii},LaunchRoamingApps:function(uf,
ii,Nl,nl,tq,ht){rC.Jkc.Wxj(uf,ii,vM(Nl),nl,"x86",UI,tq,ht)},LaunchRoamingApps2:function(uf,ii,Nl,nl,tq,ht,it,BE){var hu="";null!=nl&&(hu+=" "+nl);null!=uf&&(hu+=' "'+uf+'"');if(aa()||Ac())nG=it,oG=BE,it='office: "'+(ht+'" "')+(Nl+'" "ROAMING"'),it+=' "'+ii+'"',it+=' "'+tq+'"',it+=" "+hu,he(it,Us,Bu,!1,!1);else if(Sb())uf=document.createElement("RoamingExtensionElement"),uf.setAttribute("cabUrl",ht),uf.setAttribute("app",Nl),uf.setAttribute("licensingEntitlements",ii),uf.setAttribute("platform",tq),
uf.setAttribute("args",hu),document.documentElement.appendChild(uf),ii=document.createEvent("Events"),ii.initEvent("RoamingOfficeLaunch",!0,!1),uf.dispatchEvent(ii),null!=it&&it(CB.RoamingFFExtension);else if(vb()){if(uf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=uf)try{uf.HrConfigureSingle(ht,Nl,ii,tq,hu),null!=it&&it(CB.RoamingActiveX)}catch(ED){}}else null!=BE&&BE(gq.Failed)},ShouldShowDialog:function(){return!u()},NavigateToUrlUsingClickingOnATag:ce,OpenDocumentWithProtocolHandler:kj,
OpenDocumentWithProtocolHandlerNoCallBack:function(uf,ii,Nl,nl){var tq=PI(uf);if(null==tq)return IC(or.DescriptiveUnattemptedEnums?gq.ProtocolHandlerNoCallbackIsNull:gq.Unattempted,or.Application),!1;uf=Vf(uf,ii,Nl,nl,tq);he(uf,null,null,!1,!1);return!0}}}();rC.ClientUtils=rC.Jkc;var wM=c(1445);class rF{constructor(b,h,u){this.ga=b;this.CRj=h;this.D5=u}Wb(){this.ga.pa(Wa.a.tryMacOffice,le.a.frame,Object(v.a)(this,this.z$m,"onTryMacOffice"));this.ga.pa(Wa.a.xlj,le.a.frame,Object(v.a)(this,this.SHi,
"onTryMacOfficeFromViewer"));this.ga.pa(Wa.a.wlj,le.a.frame,Object(v.a)(this,this.SHi,"onTryMacOfficeFromViewer"))}z$m(b,h,u,y,P){if(1===u)return 32;P?(b=P.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Je.a.en(Fa.a.R_a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&Je.a.en(Fa.a.R_a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.hri();return 32}SHi(b,h,u){if(1===u)return 32;switch(b){case Wa.a.xlj:Je.a.en(Fa.a.R_a(15),"_blank",
void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Wa.a.wlj:Je.a.en(Fa.a.R_a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}hri(){Je.a.en(rF.LPm,"_blank",void 0,"LaunchMacTrialWindow")}get A3c(){return this.CRj&&ba.a.Kl&&!ba.a.yxf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get K6n(){const b=this.A3c;b||r.AFrameworkApplication.Mm.xVn();return b}get J6n(){return this.A3c}static get LPm(){return Fa.a.g7("522401")}}Object(m.a)(rF,"MacOfficeOffer",null,[973]);class sF{constructor(b,
h,u){this.ga=b;this.IRj=h;this.rR=null;(this.Ysd=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ja.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(y=>{this.rR=y});this.D5=u}Wb(){this.ga.pa(Wa.a.tryOffice,le.a.frame,Object(v.a)(this,this.A$m,"onTryOffice"));this.ga.pa(Wa.a.gbg,le.a.frame,Object(v.a)(this,this.gbg,"tryOfficeThroughTellMe"));this.ga.pa(Wa.a.Dlj,le.a.frame,
Object(v.a)(this,this.Elj,"tryOfficeThroughViewer"));this.ga.pa(Wa.a.Clj,le.a.frame,Object(v.a)(this,this.Elj,"tryOfficeThroughViewer"))}A$m(b,h,u,y,P){if(this.Ysd&&1===u)return this.isFreemiumUpsellEnabled&&this.B3c?32:8;2===u&&(P?(b=P.SourceControlId,"btnjTryOfficeForWordEditor"===b?Je.a.en(Fa.a.R_a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?Je.a.en(Fa.a.R_a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.NAf()):this.NAf());return 32}gbg(b,
h,u,y,P){if(this.Ysd&&1===u)return this.isFreemiumUpsellEnabled&&this.B3c?32:8;2===u&&(P?(b=P.SourceControlId,Je.a.en(Fa.a.g7("862405")+this.lOl(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Je.a.en(Fa.a.g7("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}Elj(b,h,u){if(this.Ysd&&1===u)return this.isFreemiumUpsellEnabled&&this.B3c?32:8;if(2===u)switch(b){case Wa.a.Dlj:Je.a.en(Fa.a.R_a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Wa.a.Clj:Je.a.en(Fa.a.R_a(24),
"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get w_m(){return this.B3c}get v_m(){return this.B3c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get B3c(){return this.IRj&&!ba.a.Kl}get isFreemiumUpsellEnabled(){let b=!1;this.rR&&(b=this.rR.isFreemiumUpsellEnabled());return b}NAf(b=null){let h=0;b&&(h=b);Je.a.en(sF.jIl(h),"_blank",void 0,"LaunchOfficeOffer")}lOl(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=
2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=
16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=
29}return 0===h?"":String.format("&pc={0:D}",h)}static jIl(b){if(ba.a.zi)switch(b){case 1:return Fa.a.g7("393806");case 2:return Fa.a.g7("393810");case 3:return Fa.a.g7("393809");case 5:return Fa.a.g7("393805")}else if(ba.a.ZL)switch(b){case 1:return Fa.a.g7("521979");case 3:return Fa.a.g7("521980");case 5:return Fa.a.g7("521978");case 2:return Fa.a.g7("522490")}else{if(2===b)return Fa.a.g7("517778");if(1===b)return Fa.a.R_a(30)}return Fa.a.g7("522402")}}Object(m.a)(sF,"OfficeTrialExperience",null,
[966]);class XI{xc(b){b.register(sF,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Xd(()=>new sF(r.AFrameworkApplication.ya,r.AFrameworkApplication.axf,r.AFrameworkApplication.lcid));b.register(rF,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Xd(()=>new rF(r.AFrameworkApplication.ya,r.AFrameworkApplication.$ki,r.AFrameworkApplication.lcid))}}Object(m.a)(XI,"OpenInClientConfiguration",null,[2]);class HA{constructor(b,
h,u,y,P,aa,ta){this.ag=b;this.characterPropertiesEditor=h;this.qW=u;this.$bf=y;this.Dj=P;this.Kd=aa;this.Oma=ta}egm(b,h){var u;b=h.view;h=h.Yj;if(!h||!this.ag.Qii(h,!0)||this.$bf&&this.$bf.instance&&this.$bf.instance.PT(h))return 2;var y=HA.yca?!HA.OI.fga(h):!0;this.qW&&y&&this.qW.yjc(h.node,fb.a.us,h.cpBegin);y=h.node;(null===(u=this.Oma)||void 0===u?0:u.replaceText)&&this.Oma.NFb(y)?(u=y.qa.OZa(h.cpBegin),this.Oma.replaceText(y,u,u,$x.a.KTc)):this.characterPropertiesEditor.Qfa(h,P=>new $x.a(P));
if(this.Kd.zg){u=new dg.GraphTransaction(15);try{u.Eb(h.node),this.Dj.lpa(h.node,h.cpBegin,h.cpBegin+1,1)}finally{u&&u.dispose()}}y=h.node;u=h.cpEnd+1;" "===be.ParagraphReader.text(y).charAt(u)&&(y=nf.a.createTextRange(y,u,u+1),this.characterPropertiesEditor.replaceTextRange(y,"\u00a0"));h=nf.a.Uc(h.node,u);b.Bb.setSelection(Kf.SelectionFactory.Vn(h));return 32}static get OI(){return null!=HA.vqg?HA.vqg:HA.vqg=Ja.a.instance.resolve("Box4.IHyperlinkStrategy")}static get yca(){null==HA.R1&&(HA.R1=r.AFrameworkApplication.K?
r.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return HA.R1}}HA.R1=null;Object(m.a)(HA,"InsertLineBreakStrategy",null,[]);class Rv{static get ih(){return null!=Rv.gug?Rv.gug:Rv.gug=Ja.a.instance.resolve("Box4.IOutlineElementEditor")}static get Yg(){return im.ContextSetEditor.instance}static get Dj(){return null!=Rv.Cxg?Rv.Cxg:Rv.Cxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Kd(){return null!=Rv.gyg?Rv.gyg:Rv.gyg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static Cgm(b,
h,u,y,P){if(P&&P.hasProperty(ld.a.targetObject)){var aa=h.view.jd.Jc.Db(P.getValue(ld.a.targetObject));aa=nf.a.create(aa)}else aa=Rv.Yg.yS(h.Yj,11);if(!aa)return 8;b=r.AFrameworkApplication.ya.Tf(aa,b,u,!0,y,P);if(32===b&&2===u){if(!h.view.ue)return 2;h=h.view;y=h.Bb.Lg;if(y=Rv.Yg.yS(y,11)){u=new Hi.a;u.set(y.node);u.zd();if(P&&P.hasProperty(ld.a.targetObject))for(P=P.Nf(ld.a.targetObject);!u.currentNode.id.equals(P)&&u.qc()&&(og.OutlineElementNavigator.$d(u),11===u.ef););og.OutlineElementNavigator.u_(u,
!1,!1);P=Se.SelectionEditor.LCa(u,!0);P=be.ParagraphReader.Lt(P)?Kf.SelectionFactory.we(P,0):Kf.SelectionFactory.kq(P);h.Bb.setSelection(P)}}return b}static VQd(b,h,u,y,P){b=b===Oa.a.qPc;h=h.node;if(P&&P.hasProperty(ld.a.targetObject)&&!h.id.equals(P.Nf(ld.a.targetObject)))return 2;if(1===u)return 32;u=new yd.GraphIterator;u.set(h);u.Ab(10);Rv.ih.pD(u,b,!0);Rv.Kd.zg&&(u=og.OutlineElementNavigator.Ee(u),Rv.Dj.sMb(u,1));return 32}}Object(m.a)(Rv,"InsertOutlineElementStrategy",null,[]);class tF{constructor(b,
h,u,y,P,aa,ta,Pa,vb,Kb){this.qei=(Sb,Yb,Ac)=>{var Sc;const nd=!Yb.cpBegin;Ac=Yb.cpBegin===be.ParagraphReader.textLength(Ac);const Ad=!(null===(Sc=Ra.App.yd)||void 0===Sc||!Sc.Xp);let he=!0;Ad&&nd&&!Ac?(he=!1,Sc=new yd.GraphIterator,Sc.ed(Sb),Sc.zd(),this.Bh.pD(Sc,!0,!1)):Sc=this.Bh.bna(Sb);this.Bh.P8(Sb,Sc,Yb,!1,!0,he,!1,!0);!Ad||nd||Ac||(Sb=im.ContextSetEditor.instance.ihf(Yb),Ra.App.yd.Vq.WG(Sb));return Sc};this.pY=h;this.RKj=b;this.zz=aa;this.NTj=P;this.Bh=u;this.LIj=y;this.Tk=ta;this.ib=Pa;this.YD=
vb;this.Bnc=Kb}DXm(b,h,u,y,P){if(!h.view.ue)return 2;h=h.view;let aa=null;h.mi&&(aa=h);const ta=h.Bb.Lg;var Pa=!0;let vb=!1,Kb=null;if(!ta)return 2;const Sb=new dg.GraphTransaction(15);Sb.Eb(h.jd);let Yb=null;2===u&&(Yb=new Hi.a,Yb.set(ta.node),Yb.zd(),Kb=new Vy.a(Yb),og.OutlineElementNavigator.$d(Yb),Pa=wg.OutlineElementReader.isEmpty(Yb,!1),{B$i:Pa,rtj:vb}=this.LIj.C$i(Yb,Pa,dv.a.SCb,-1,ta));b=r.AFrameworkApplication.ya.Tf(ta,b,u,!1,y,P);Pa&&32===b&&2===u&&(vb||og.OutlineElementNavigator.TEa(Yb,
!1,!Se.SelectionEditor.pf(ta),!1),vb&&Kb&&Kb.restore(Yb),this.zz.freeze(),(u=Kf.SelectionFactory.Un(Yb.currentNode,!0))||w.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.Bb.setSelection(u),this.zz.WGa(),this.RKj.Kh.aG());aa&&(Pa||aa.h4(),aa.editingView&&aa.sQ&&(aa.editingView.CH=!0));xf.GrippersManager.instance.MOb(1);Sb.dispose();return b}newLine(b,h,u){b=!1;if(Jd.ImageReader.p3(h)||Jd.ImageReader.q1a(h))h=this.hPk(h),b=!0;const y=h;if((h=Se.SelectionEditor.pf(h))&&
this.Tk.qh&&!this.Tk.msm(y))return 2;if(1===u)return 32;const P=y.node,aa=new yd.GraphIterator;aa.set(P);aa.zd();og.OutlineElementNavigator.$d(aa);u=new dg.GraphTransaction(15);u.ev(aa);h?(this.Bnc.instance&&this.Bnc.instance.mHa(y),be.ParagraphReader.ic(P)&&y.cpBegin===be.ParagraphReader.textLength(P)&&En.m(y)&&9===be.ParagraphReader.Cma(P)&&this.zz.dQk(y),wj.ListReader.lj(aa)?this.NTj.execute(aa,y,P,this.qei):this.qei(aa,y,P),this.pY&&this.pY.yjc(P,fb.a.us,y.cpBegin),b&&(og.OutlineElementNavigator.Jr(aa,
!1,!1),b=aa.Rb(2),(b=this.YD.we(b,0))&&this.ib.setSelection(b))):this.Bh.pD(aa,!0,!0);u.dispose();Ra.App.xa&&Ra.App.xa.updateCommandUI();return 32}hPk(b){if(Jd.ImageReader.p3(b))var h=nf.a.Uc(b.node,b.cpBegin);else{h=be.ParagraphReader.zN(b.node);var u=h.properties.Nf(Lc.a.Sq);b=b.node.properties.getValue(Lc.a.runId);u=tF.Dhf(b,u,h.qa);h=nf.a.Uc(h,u)}return h}static cdf(b,h){let u=0;for(;u<h.length&&!(b<h[u]);)u++;return u}static Dhf(b,h,u){let y=0;b=tF.cdf(b,h);let P=0;if(b===h.length)P=u.length-
1;else for(;P<u.length;){h=u.J(P);if(h.formatting&&h.formatting.Je===b)break;P++}P<u.length&&(y=u.J(P).cp);return y}}Object(m.a)(tF,"NewLineStrategy",null,[]);class JC{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd,Ad){this.Yl=null;this.wka=b;this.vdd=ta;this.xkd=new tF(this,h,u,y,P,aa,Pa,Sb,Yb,nd);this.XOg=new HA(Pa,vb,h,Kb,Ac,Sc,Ad)}get Kh(){return this.Yl||(this.Yl=this.wka())}Wb(){const b=r.AFrameworkApplication.ya,h=Object(v.a)(this.xkd,this.xkd.newLine,"newLine");b.gb(Oa.a.enter,oc.a.view,
Object(v.a)(this.vdd.value,this.vdd.value.Qcl,"enterView"),1124);b.gb(Oa.a.J9i,oc.a.view,Object(v.a)(this.vdd.value,this.vdd.value.M4n,"shiftEnterView"),1124);b.pa(Oa.a.newLine,oc.a.view,Object(v.a)(this.xkd,this.xkd.DXm,"newLineView"));b.pa(Oa.a.newLine,oc.a.Vc,h);b.pa(Oa.a.newLine,oc.a.image,h);b.pa(Oa.a.newLine,oc.a.Fd,h);b.pa(Oa.a.newLine,oc.a.anchoredObject,h);b.pa(Oa.a.newLine,oc.a.embeddedFile,h);b.pa(Oa.a.newLine,oc.a.ink,h);b.pa(Oa.a.newLine,oc.a.paragraph,h);b.pa(Oa.a.newLine,oc.a.iFrame,
h);b.pa(Oa.a.newLine,oc.a.unsupportedObject,h);b.Xc(Oa.a.newLine,1124);b.gb(Oa.a.SQd,oc.a.view,Object(v.a)(this.XOg,this.XOg.egm,"insertLineBreakView"),1028);b.pa(Oa.a.qPc,oc.a.view,Rv.Cgm);b.pa(Oa.a.qPc,oc.a.outlineElement,Rv.VQd);b.Xc(Oa.a.qPc,1092)}static get instance(){return null!=JC.Arg?JC.Arg:JC.Arg=JC.Jl()}static Jl(){return new JC(()=>Ja.a.instance.resolve("Box4.IUndoManager"),Ja.a.instance.Pa("Box4.IAutoCorrectScheduler"),Ja.a.instance.resolve("Box4.IOutlineElementEditor"),Ja.a.instance.resolve("Box4.List.ICursorMovementValidator"),
Ja.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ja.a.instance.resolve("Box4.IInsertionPointFormatting"),Ja.a.instance.af("Box4.Actors.IEnterViewStrategy"),sd.a.instance,Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ja.a.instance.Za("Box4.IExternalSelectionManager"),Hh.a.instance,Ja.a.instance.resolve("Box4.ISelectionFactory"),Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Ja.a.instance.Za("Box4.IContentControlConverter"),Ja.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(m.a)(JC,"EnterActor",null,[]);var qG=c(1361),rG=c(874);class kk{static get paragraphEditor(){return null!=kk.Oug?kk.Oug:kk.Oug=Ja.a.instance.resolve("Box4.IParagraphEditor")}static get fY(){return null!=kk.mwg?kk.mwg:kk.mwg=Ja.a.instance.Pa("Box4.ISpacingCommands")}static get Enb(){return null!=kk.xwg?kk.xwg:kk.xwg=Ja.a.instance.Pa("Box4.Styles.IWACStyleReader")}static get i_(){return null!=kk.gtg?
kk.gtg:kk.gtg=Ja.a.instance.Pa("Box4.ILineSpacingHelper")}static get Dj(){return null!=kk.Lxg?kk.Lxg:kk.Lxg=Ja.a.instance.Pa("Box4.TrackChange.ITrackChangeEditor")}static get Kd(){return null!=kk.lyg?kk.lyg:kk.lyg=Ja.a.instance.Pa("Box4.TrackChange.ITrackChangeManager")}static get Qk(){return Ja.a.instance.Pa("WordEditor.ClientPagination.IClientPaginationSettings")}static Wb(){var b,h,u;const y=r.AFrameworkApplication.ya;y.pa(Oa.a.wBf,oc.a.view,tn.a.Nv);y.Xc(Oa.a.wBf,1028);y.pa(Oa.a.sC,oc.a.view,
tn.a.Nv);y.pa(Oa.a.sC,oc.a.paragraph,kk.awd);y.Xc(Oa.a.sC,1036);y.pa(Oa.a.fgc,oc.a.paragraph,kk.ulk);y.pa(Oa.a.fgc,oc.a.view,tn.a.Nv);y.Xc(Oa.a.fgc,1036);if(null===(b=kk.Qk)||void 0===b?0:b.DEa)y.pa(Oa.a.G2c,oc.a.paragraph,kk.FVe),y.pa(Oa.a.G2c,oc.a.view,tn.a.Nv);if(null===(h=kk.Qk)||void 0===h?0:h.NHa)y.pa(Oa.a.f3c,oc.a.paragraph,kk.ZVe),y.pa(Oa.a.f3c,oc.a.view,tn.a.Nv);if(null===(u=kk.Qk)||void 0===u?0:u.qga)y.pa(Oa.a.F2c,oc.a.paragraph,kk.EVe),y.pa(Oa.a.F2c,oc.a.view,tn.a.Nv);y.pa(Oa.a.gTe,oc.a.view,
kk.nhk);y.Xc(Oa.a.gTe,1036);y.pa(Oa.a.BXf,oc.a.view,kk.rGn);y.Xc(Oa.a.BXf,1036);y.pa(Oa.a.fTe,oc.a.view,kk.mhk);y.Xc(Oa.a.fTe,1036);y.pa(Oa.a.AXf,oc.a.view,kk.qGn);y.Xc(Oa.a.AXf,1036);y.pa(Oa.a.ZRa,oc.a.view,tn.a.Nv);y.pa(Oa.a.ZRa,oc.a.paragraph,kk.awd);y.Xc(Oa.a.ZRa,1036);y.pa(Oa.a.YRa,oc.a.view,tn.a.Nv);y.pa(Oa.a.YRa,oc.a.paragraph,kk.awd);y.Xc(Oa.a.YRa,1036);y.pa(Oa.a.pde,oc.a.view,kk.ode);y.pa(Oa.a.pde,oc.a.paragraph,kk.ode);y.Xc(Oa.a.pde,1028);y.pa(Oa.a.e7f,oc.a.view,kk.ode);y.pa(Oa.a.e7f,oc.a.paragraph,
kk.ode);y.Xc(Oa.a.e7f,1028);y.pa(Oa.a.ede,oc.a.view,tn.a.Nv);y.pa(Oa.a.ede,oc.a.paragraph,kk.Wih);y.Xc(Oa.a.ede,1028);y.pa(Oa.a.dde,oc.a.view,tn.a.Nv);y.pa(Oa.a.dde,oc.a.paragraph,kk.Wih);y.Xc(Oa.a.dde,1028)}static Wih(b,h,u,y,P){if(1===u)return 32;b===Oa.a.ede?b=Oa.a.ZRa:b===Oa.a.dde&&(b=Oa.a.YRa);return kk.awd(b,h,u,y,kk.Xen(P))}static Xen(b){var h=b.indexOf(",");const u=b.substring(0,h);b=b.substring(h+1,b.length);h=new qG.a;h.value=parseFloat(u);h.unit=parseInt(b);return h}static ode(b,h,u,y,
P){if(2===u){h=P[Df.a.Text];u=P[Df.a.Number];P=P.Increment;y=new qG.a;let aa=!1;""===h||P&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(y.value=0,y.unit=Ra.App.A7?2:4,aa=!0):u||P||(y.value=0,y.unit=1,aa=!0);aa&&(r.AFrameworkApplication.ya.Ub(b===Oa.a.pde?Oa.a.ZRa:Oa.a.YRa,2,y),Ra.App.xa.updateCommandUI())}return 32}static awd(b,h,u,y,P){if(!({Lx:u}=tn.a.A4f(u,h)).returnValue)return u;h=h.node;switch(b){case Oa.a.sC:kk.paragraphEditor.sC(h,new rG.a(2,P));break;case Oa.a.ZRa:b=new rG.a(P.unit,P.value);kk.paragraphEditor.TLb(h,
b);break;case Oa.a.YRa:b=new rG.a(P.unit,P.value),kk.paragraphEditor.QLb(h,b)}y&&kr.a.$nb&&(y.Xr|=kr.a.agb(h));return 32}static nhk(b,h,u){if(1===u)return 32;w.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=kk.U4h(h);if(!b)return w.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(Lc.a.oj,240)/20)?b:kk.l0k;kk.fY.Qha(1,b,4);return 32}static rGn(b,h,u){if(1===u)return 32;w.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");
kk.fY.Qha(1,0,4);return 32}static mhk(b,h,u){if(1===u)return 32;w.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=kk.U4h(h);if(!b)return w.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(Lc.a.ra,240)/20;kk.fY.Qha(0,b?b:12,4);return 32}static qGn(b,h,u){if(1===u)return 32;w.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");kk.fY.Qha(0,0,4);return 32}static FVe(b,h,u,y,P){if(2==u){if("boolean"!==typeof P)return 16;
b=h.node;h=null;pe.a.instance.J(3)&&(h=b.hD());kk.paragraphEditor.FVe(b,P);h&&kk.Dj.FU(b,h,kk.Kd.zg)}return 32}static ZVe(b,h,u,y,P){if(2==u){if("boolean"!==typeof P)return 16;b=h.node;h=null;pe.a.instance.J(3)&&(h=b.hD());kk.paragraphEditor.ZVe(b,P);h&&kk.Dj.FU(b,h,kk.Kd.zg)}return 32}static EVe(b,h,u,y,P){if(2==u){if("boolean"!==typeof P)return 16;b=h.node;h=null;pe.a.instance.J(3)&&(h=b.hD());kk.paragraphEditor.EVe(b,P);h&&kk.Dj.FU(b,h,kk.Kd.zg)}return 32}static ulk(b,h,u,y,P){if(2==u){if("boolean"!==
typeof P)return 16;b=new Map;b.set("Value",P.toString());Ta.Health.instance.recordKpiUsage(Nf.a.$Sc.kno,0,Nf.a.eD,b);h=h.node;b=null;pe.a.instance.J(3)&&(b=h.hD());h.hasProperty(Lc.a.qv)&&h.removeProperty(Lc.a.qv);kk.i_.oJd(h)!==P&&h.setValue(Lc.a.qv,P);(P=kk.i_.l5b(h,!0))&&P.Ck(4,!0);(P=kk.i_.l5b(h,!1))&&P.Ck(4,!0);b&&kk.Dj.FU(h,b,kk.Kd.zg)}return 32}static U4h(b){b=b.view;return b.ue&&(b=b.Bb)&&b.hb.kb?kk.Enb.Xn(b.hb.kb.Qa.node):null}}kk.l0k=12;Object(m.a)(kk,"SpacingActor",null,[]);class YI{process(){}}
Object(m.a)(YI,"NoOpFormattingViewOperationFinishedStageProcessor",null,[46]);class ZI{constructor(b){this.ze=b}aYn(b,h){this.ze.S_(b,h.cache.lH);this.ze.Av(b,h.cache.fontSize)}VNa(){return null}jDa(){return null}P5b(){return null}oT(){return null}}Object(m.a)(ZI,"FormattingStewardBridge",null,[50]);class $I{xc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new YI).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",()=>new ZI(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}
Object(m.a)($I,"WoncaActorsConfiguration",null,[2]);class aJ{constructor(b,h,u,y,P,aa,ta,Pa){this.ga=b;this.SFj=h;this.RFj=u;this.qCg=y;this.zYj=P;this.omd=aa;this.EYj=ta;this.FYj=Pa}get Bc(){return this.ga}stk(b){this.Bc.Hoa(b,this.SFj,null,null)}qtk(b){this.Bc.Hoa(b,this.RFj,null,null)}r2(b,h,u){u?this.Bc.Hoa(b,this.qCg,h,null):this.Bc.Ub(this.qCg,2,h)}Afn(b,h){this.Bc.Hoa(b,this.omd,h,null)}n8(b,h){this.Bc.Hoa(b,this.EYj,h,null)}ulb(b,h){this.Bc.Hoa(b,this.FYj,h,null)}NPf(b,h=!1){const u=new uh.DictionaryPropertySet;
u.setValue(ld.a.PQ,b);u.setValue(ld.a.iLi,!0);u.setValue(ld.a.D1a,h);this.Bc.Ub(this.zYj,2,u)}}Object(m.a)(aJ,"ClipboardCommands",null,[1354]);class bJ{}Object(m.a)(bJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1239]);class cJ{constructor(b){this.ga=b}get Bc(){return this.ga}T6i(b,h,u){let y=0;b?1===b&&(y=Oa.a.Z0a):y=Oa.a.Y0a;b=new Px.a;b.unit=u;b.value=h;this.Bc.Ub(y,2,b)}Xae(b,h,u){let y=0;1===b?y=Oa.a.mMb:2===b?y=Oa.a.Smb:b||(y=Oa.a.nMb);b=new Px.a;b.unit=u;b.value=h;this.Bc.Ub(y,2,
b)}}Object(m.a)(cJ,"IndentationCommands",null,[1288]);var uF;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]="numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=
15]="end"})(uF||(uF={}));Object(m.b)("Justification",uF);class dJ{constructor(b){this.PJa={};this.ga=b;this.Ubm()}get Bc(){return this.ga}zD(b){b=this.PJa[uF[b]];void 0!==b&&null!==b&&this.Bc.processAction(b,2)}Ubm(){this.PJa.left=Oa.a.leftJustify;this.PJa.center=Oa.a.centerJustify;this.PJa.right=Oa.a.rightJustify;this.PJa.both=Oa.a.fullJustify;this.PJa.lowKashida=Oa.a.xGb;this.PJa.mediumKashida=Oa.a.xGb;this.PJa.highKashida=Oa.a.xGb;this.PJa.distribute=Oa.a.NGc;this.PJa.thaiDistribute=Oa.a.a3c}}
Object(m.a)(dJ,"JustificationCommands",null,[1282]);class eJ{constructor(b){this.ga=b}sC(b){this.ga.Ub(Oa.a.sC,2,b)}fgc(b){this.ga.Ub(Oa.a.fgc,2,b)}G2c(b){this.ga.Ub(Oa.a.G2c,2,b)}f3c(b){this.ga.Ub(Oa.a.f3c,2,b)}F2c(b){this.ga.Ub(Oa.a.F2c,2,b)}Qha(b,h,u){this.ga.Ub(b?Oa.a.ZRa:Oa.a.YRa,2,Object.assign(new qG.a,{value:h,unit:u}))}}Object(m.a)(eJ,"SpacingCommands",null,[1168]);class fJ{constructor(b,h,u){this.Bc=b;this.qHc=h;this.j$k=u;this.Gan=(y,P,aa)=>{if(1===aa)return this.qHc.D$?32:8;this.qHc.eFm();
this.j$k().R9n(this.qHc.kBl());return 32}}Wb(){this.Bc.gb(Oa.a.Xkb,oc.a.application,this.Gan,1028)}}Object(m.a)(fJ,"EditorSettingsUIActor",null,[]);class gJ extends ff.a{constructor(b,h){super(!1,!1,!0);this.l$k=b;this.GPa=h;this.k$k=u=>{1!==u?w.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.l$k.hvo(),w.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}R9n(b){Object(zs.__awaiter)(this,void 0,void 0,function*(){var h=yield this.GPa.UGb;h={["id"]:"SettingsDialog",
["uiLanguage"]:r.AFrameworkApplication.uiCulture,["selectedLanguage"]:zl.a.sg(r.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.KSc,["editorSettings"]:b};this.Wh(Box4Intl.Box4Strings.l_EditorSettings,this.k$k,h);w.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")})}}Object(m.a)(gJ,"EditorSettingsDialog",ff.a,[]);class hJ{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc){this.Kub=this.Hvc=this.QQb=null;this.lMe=0;this.kye=!1;this.sa=new ie.a;this.gTd=
!1;this.Tsb=null;this.sL=b;this.zz=h;this.ze=u;this.Cs=y;this.eb=P;this.ZH=aa;this.If=ta;this.Rd=Pa;this.Tk=vb;this.Wc=Kb;this.Ud=Sb;this.Eo=Yb;this.Z1=Ac;this.Kz=Sc}get Jal(){return this.Wc?this.Wc.isFeatureEnabled(41):!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get Cef(){return null!=this.xpg?this.xpg:this.xpg=Ja.a.instance.resolve("Box4.IFormatPainterStrategy")}get qQ(){return this.kye}set qQ(b){this.kye!==b&&(this.kye=this.gTd=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}kek(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",
b)}ULi(b){const h=b.Qa;w.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var u=h.node;b=this.pli(b);if(this.Cef.P6n(h.contextId,b))try{this.Kub=this.eb.f0a(u)}catch(y){throw w.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",y.message),y;}this.Hvc=this.Kz.Xn(u);u=Wi.FormattingReader.zr(h);u.Vm&&(this.QQb=Object(na.a)($A.a,u.Vm.clone()));this.lMe=b?oc.a.paragraph:h.contextId}sih(b){if(b){const y=this.pli(b);if(this.dTd)if(b=b.HN().iz(),
null===b||void 0===b?0:b.gl)this.scb(b,y);else if(0==(null===b||void 0===b?void 0:b.length))w.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",b);else{if(b)for(var h=0;h<b.length;h++){var u=b.getContext(h);if(null===u||void 0===u?0:u.Hw){if(u)for(let P=0;P<u.length;P++)b.addContext(u.getContext(P))}else(null===u||void 0===u?0:u.gl)?this.scb(u,y):w.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",u.contextId)}}else for(h=
0;h<b.length;h++)u=b.J(h),(null===u||void 0===u?0:u.gl)?this.scb(u,y):w.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",u.contextId)}}vih(b,h){if(h){var u=b.node,y=u.qa.last,P=this.Rd.VMa(u),aa=P.Xf(P.Nb);this.wih(P,h,null);pe.a.instance.J(3)&&this.Eo.YLb(u,y,b.cpBegin,b.cpEnd,aa,P,this.Ud.zg)}}Glk(b,h,u){if(h||u)0<En.g(b).length&&w.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.Z1.k2(b,y=>{this.wih(y,h,u)})}wih(b,h,u){var y,
P,aa,ta;this.ze.dla(b);b.Vm&&b.Vm.removeProperty(Ge.a.highlight);this.ze.k0e(b);if(u){let Pa=u.$h();if(null===(y=r.AFrameworkApplication.K)||void 0===y?0:y.$("StylesFlatteningCrashFixIsEnabled"))Pa=uk.a.Dna(u)?null===(ta=null===(aa=null===(P=this.Kz)||void 0===P?void 0:P.Yn())||void 0===aa?void 0:aa.SW(Pa))||void 0===ta?void 0:ta.clone():Pa.clone(),Pa.Ng(...$k.a.XF());this.Hs(b,Pa)}this.Hs(b,h)}Hs(b,h){var u;if(h){var y=b.paragraph.Jc;if(y){var P=b.Vm;P=P?Object(na.a)(at.a,P.clone()):$A.a.NBa(1179725);
for(const ta of h.Aj())if(ta!==Lc.a.Zw&&ta!==Lc.a.fieldInstruction&&ta!==Ge.a.$y&&ta!==Ge.a.s3&&ta!==Lc.a.x1a&&ta!==Ge.a.cC&&ta!==Lc.a.languageHint&&ta!==Lc.a.noProof){if(ta===vi.a.Rv){var aa=h.ia(vi.a.Rv,T.a.nil);if(aa!==T.a.nil)if(aa=y.Db(aa)){if(aa=new LB.a(aa),aa=this.Kz.WF(aa),aa===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(aa=this.Kz.jx(b.paragraph).Qua(aa)){(null===(u=r.AFrameworkApplication.K)||void 0===u?0:u.$("StylesFlatteningCrashFixIsEnabled"))?P.oI(aa.$h(),...$k.a.XF()):P.Hs(aa.$h());
continue}else w.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else w.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}P.setValue(ta,h.Nf(ta))}P.Ana?h=y.UQ(P,!0):(y.av(P),h=P);b.Hj=h.id}}}pli(b){return!b.Nx&&b.Tc.contextId!==oc.a.endOfParagraph}reset(){this.Kub=this.Hvc=this.QQb=null;this.lMe=oc.a.none}scb(b,h){if(b.contextId===oc.a.Vc||b.contextId===oc.a.Fd)var u=this.Tk.C7(b);else if(b.contextId===
oc.a.paragraph)u=this.Tk.iUd(b);else if(b.contextId===oc.a.endOfParagraph)u=this.Tk.NSd(b);else{w.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}w.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(u)w.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{u=Object(na.a)(ro.AParagraphNode,b.node);var y=!1;u&&(y=b.contextId===oc.a.Fd&&!!u&&!b.cpBegin&&b.cpEnd===this.eb.textLength(u));
if(h=this.Cef.Y4n(this.lMe,b.contextId,h,y))try{be.ParagraphReader.ic(u)?(this.Hvc&&this.sL.QK(this.Hvc,u,!0),this.Cs.Nih(u,this.Kub)):w.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(P){throw w.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",P.message),P;}y=b;b.contextId===oc.a.paragraph?y=nf.a.createTextRange(u,0,be.ParagraphReader.textLength(u)):b.contextId===oc.a.Vc&&(y=this.zz.tmf(b),y=Hh.a.Fzb(y));
if(y&&y.contextId===oc.a.Fd)try{this.Glk(y,this.QQb,h?null:this.Hvc)}catch(P){throw w.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",P.message),P;}if(b.contextId===oc.a.paragraph||b.contextId===oc.a.endOfParagraph){h=new yd.GraphIterator;h.set(u);h.zd();h.kd(11);y=wj.ListReader.lj(h);const P=!be.ParagraphReader.textLength(u);w.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",y,P);y?(this.If.fG(h),h=h.currentNode,this.If.Xaa(h)&&(yl.a.hh.jO?
this.vih(b,this.QQb):this.ZH.Dae(h,u,this.QQb))):this.Jal&&this.vih(b,this.QQb)}}}get dTd(){null==this.Tsb&&(r.AFrameworkApplication.Ce("0b2ac141;84eff841"),this.Tsb=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.Tsb}}Object(m.a)(hJ,"FormatPainter",null,[1320]);var xM=c(122);class KC{constructor(b,h,u,y,P,aa,ta,Pa=!1,vb,Kb,Sb){this.Qhd=!1;this.Que=new rs.a;this.Tsb=null;this.X2l=()=>{this.JR.qQ=
!1;return 32};this.Y2l=(Yb,Ac,Sc)=>{Yb=!1;if(Ac=this.Ww.lfa){switch(Ac.contextId){case oc.a.Fd:case oc.a.paragraph:case oc.a.endOfParagraph:case oc.a.Vc:Yb=!0}Yb&&Se.SelectionEditor.Ek(Ac)&&En.b(Ac)&&(this.rd.fc($c.a.Zm,{["Reason"]:Zc.a.qEc}),Yb=!1);Yb&&be.ParagraphReader.MT(Ac)&&(this.rd.fc($c.a.Zm,{["Reason"]:Zc.a.BN}),Yb=!1)}if(1===Sc||!Yb)return Yb?32:8;6!==this.ga.bH?(this.JR.qQ?w.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(w.ULS.sendTraceTag(22832075,354,
50,"User activated the Format Painter button"),this.JR.ULi(this.Ww.kb),this.Qhd||(this.Eh.LXa(this.eoj),(Sc=this.Eh.jb.Jt)&&Sc.mi&&Sc.zeh(this.doj),this.Qhd=!0)),this.JR.qQ=!this.JR.qQ):(w.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.JR.ULi(this.Ww.kb),this.JR.qQ=!1);return 32};this.W2l=(Yb,Ac,Sc,nd,Ad)=>{if(6===this.ga.bH||this.JR.qQ){w.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.bH);Yb=this.Eh.tq.jg("UserAction",
"FormatPainterApply");if(KC.$b&&KC.$b.Xx(117)){Ad=Ad?Ad.KeepBrushActive:!1;Sc=null;this.Ww.kb&&2===this.Ww.kb.trigger&&(Ad=Ad||this.JR.gTd,this.JR.gTd&&Se.SelectionEditor.om(this.Ww.kb)&&(Sc=Se.SelectionEditor.Q2(this.Ww.kb.Qa,!1)))&&(Sc.trigger=2);this.JR.gTd=!1;if(Ad||2!==this.Ww.kb.trigger)Ac=new dg.GraphTransaction(15),Sc&&Sc.Qa?(Ac.set(Sc.Qa.node.Wi),this.ib.setSelection(Sc)):Ac.set(this.Ww.M3b.Wi),Sc=this.dTd?Kf.SelectionFactory.Vn(this.ib.Lg):this.Ww.kb,this.JR.sih(Sc),Ac.dispose();this.JR.qQ=
Ad}else Ad=new dg.GraphTransaction(15),Ad.set(this.Ww.M3b.Wi),Ac=this.dTd?Kf.SelectionFactory.Vn(this.ib.Lg):this.Ww.kb,this.JR.sih(Ac),this.JR.qQ=!1,Ad.dispose();Yb.stop()}return 32};this.eoj=()=>{this.t2d(this.JR.qQ)};this.doj=()=>{this.t2d(this.JR.qQ)};this.Eh=b;this.Vb=h;this.ga=u;this.rd=y;this.Ww=P;this.JR=aa;this.ib=ta;this.VQj=Pa;this.tw=vb;this.Tw=Kb;this.SIj=Sb}get gLg(){return ba.a.jt||ba.a.CUd?"url("+this.yXh()+"), pointer":'url("'+this.yXh()+'"), pointer'}yXh(){return this.Tw?this.tw.Eua(Yl.a.Yh("FormatPainterText.cur"),
Yl.a.Yh("FormatPainterTextDarkMode.cur"),new xM.a(Mn.a.SN())):Yl.a.Yh("FormatPainterText.cur")}Wb(){const b=this.Vb.le($g.AppFrame.oE);b.bindAction(Rb.KeyInputManager.lc(fb.a.Q6a,0),Oa.a.Bef);b.bindAction(Rb.KeyInputManager.lc(fb.a.rpb,6),Oa.a.bId);this.VQj||b.bindAction(Rb.KeyInputManager.lc(fb.a.upb,6),Oa.a.s_a);this.ga.gb(Oa.a.bId,oc.a.view,this.Y2l,1028);this.ga.gb(Oa.a.s_a,oc.a.view,this.W2l,1028);this.ga.gb(Oa.a.Bef,oc.a.view,this.X2l,1028);this.JR.kek(()=>{this.odg(this.JR.qQ)});this.Tw&&this.SIj.bvd(()=>
{this.t2d(this.JR.qQ)})}odg(b){const h=this.Eh.tq.jg("UserAction","FormatPainterUpdateCursor");this.t2d(b);this.Eh.updateCommandUI();h.stop()}coj(b,h){for(let u=0;u<b.length;u++)this.boj(b[u],h);(b=this.Eh.jb.Jt)&&b.ue&&this.boj(b.oh.editingElement,h)}boj(b,h){b.style.cursor=h?this.gLg:""}t2d(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const u=h[h.length-2].style.cursor===this.gLg;if(this.Eh.jb.isEditingAllowed||this.Eh.jb.Zx){if(b&&!u||!b&&u)this.coj(h,b),this.Aoj(b);b||
!this.Qhd||this.Que.count||(this.Eh.mWi(this.eoj),(b=this.Eh.jb.Jt)&&b.mi&&b.nFn(this.doj),this.Qhd=!1)}else u&&(this.coj(h,!1),this.Aoj(!1))}}Aoj(b){const h=this.Eh.jb.Jt;h&&(b?this.Que.add(h.jd.Bn):this.Que.remove(h.jd.Bn))}static get $b(){return null!=KC.xog?KC.xog:KC.xog=Ja.a.instance.Pa("Box4.IFeatureHelper")}get dTd(){null==this.Tsb&&(r.AFrameworkApplication.Ce("0b2ac141;84eff841"),this.Tsb=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",
!1):!1);return this.Tsb}}Object(m.a)(KC,"FormatPainterActor",null,[]);class IA{constructor(b,h,u){this.Om=u}Qcl(b,h,u,y,P){var aa;if(!({ye:u,selected:aa,Lx:vb}=this.L$i(h,u,!1)).returnValue)return vb;kh.a.mark(5013);var ta=IA.Yg.vN(aa);for(var Pa=0;Pa<ta.length;++Pa){if(!ta[Pa].isValid)continue;const Kb=ta[Pa].iterator;Kb.jo();if(Jf.OutlineReader.Kw(Kb))return this.CKh(u,Kb)}ta=this.IBl();if(aa.Hw||Se.SelectionEditor.Ek(aa)||be.ParagraphReader.em(aa)&&!Se.SelectionEditor.x7(aa)){if(IA.$b&&IA.$b.isFeatureEnabled(23)&&
im.ContextSetEditor.instance.n6f(aa).returnValue)return 8;var vb=this.DKh(h,u,b,y,P,ta)}else if(Se.SelectionEditor.Dk(aa))vb=this.BKh(h,u,b,y,P,ta);else if(Se.SelectionEditor.pf(aa)){vb=new yd.GraphIterator;vb.set(aa.node);vb.Ab(10);Pa=yi.HyperlinkReader.iD(aa,!1);if(0<Pa.length){if(!Pa[0].hyperlink)return w.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",Pa[0].cpBegin,Pa[0].cpEnd),8;Ra.App.IBb(Pa[0].hyperlink.url);return 32}hi.TableCellReader.e_(vb)&&(wf.returnToContainingCell(vb),
hi.TableCellReader.cga(vb)&&(Pa=new yd.GraphIterator,Pa.ed(vb),wf.returnToContainingRow(Pa),Jf.OutlineReader.cA(vb,aa,!1)&&pm.a.kji(Pa)&&0>=aa.Fb&&(ta=Oa.a.qPc,wf.returnToContainingTable(vb),og.OutlineElementNavigator.$d(vb),P||(P=new uh.DictionaryPropertySet),P.Zg(ld.a.targetObject,vb.currentNode.id))));vb=this.EKh(h,u,b,y,P,ta)}else Se.SelectionEditor.x7(aa)&&(vb=r.AFrameworkApplication.ya.Tf(h,Oa.a.newLine,2,!1,y,P));kh.a.mark(5014);return vb}L$i(b,h,u){let y=null,P=null;if(1===h)return{returnValue:!1,
ye:y,selected:P,Lx:32};if(!b.view.ue)return{returnValue:!1,ye:y,selected:P,Lx:2};y=b.view;return(P=y.Bb.Lg)&&IA.ag.Qii(P,u)?this.Om&&this.Om.instance&&this.Om.instance.PT(P)?{returnValue:!1,ye:y,selected:P,Lx:4}:{returnValue:!0,ye:y,selected:P,Lx:2}:{returnValue:!1,ye:y,selected:P,Lx:2}}M4n(b,h,u,y,P){let aa,ta;if(!({ye:u,selected:aa,Lx:ta}=this.L$i(h,u,!0)).returnValue)return ta;const Pa=IA.Yg.vN(aa);for(let vb=0;vb<Pa.length;++vb){if(!Pa[vb].isValid)continue;const Kb=Pa[vb].iterator;Kb.jo();if(Jf.OutlineReader.Kw(Kb))return this.CKh(u,
Kb)}aa.Hw||Se.SelectionEditor.Ek(aa)?ta=this.DKh(h,u,b,y,P,Oa.a.SQd):Se.SelectionEditor.Dk(aa)?ta=this.BKh(h,u,b,y,P,Oa.a.SQd):Se.SelectionEditor.pf(aa)?ta=this.EKh(h,u,b,y,P,Oa.a.SQd):Se.SelectionEditor.x7(aa)&&(ta=r.AFrameworkApplication.ya.Tf(h,Oa.a.newLine,2,!1,y,P));return ta}CKh(b,h){b.Bb.setSelection(Kf.SelectionFactory.Un(h.currentNode,!1));return 32}DKh(b,h,u,y,P,aa){const ta=new dg.GraphTransaction(15);ta.Kk=u;ta.Eb(h.jd);h=new uh.DictionaryPropertySet;h.setValue(ld.a.SGc,!0);h=r.AFrameworkApplication.ya.Tf(b,
Oa.a.gH,2,!0,y,h);32===h&&(h=r.AFrameworkApplication.ya.Tf(b,aa,2,!1,y,P));ta.dispose();return h}BKh(b,h,u,y,P,aa){const ta=new dg.GraphTransaction(15);ta.Kk=u;ta.Eb(h.jd);h.Bb.setSelection(Se.SelectionEditor.Vj(h.Bb.hb.J(0),!1,!1));b=r.AFrameworkApplication.ya.Tf(b,aa,2,!1,y,P);ta.dispose();return b}EKh(b,h,u,y,P,aa){const ta=new dg.GraphTransaction(15,u);ta.Kk=u;ta.Eb(h.jd);b=r.AFrameworkApplication.ya.Tf(b,aa,2,!1,y,P);ta.dispose();return b}static get Yg(){return im.ContextSetEditor.instance}static get ag(){return sd.a.instance}static get $b(){return null!=
IA.tog?IA.tog:IA.tog=Ja.a.instance.Pa("Box4.IFeatureHelper")}}Object(m.a)(IA,"AEnterViewStrategy",null,[1355]);class iJ extends IA{constructor(b,h,u){super(b,h,u)}IBl(){return Oa.a.newLine}}Object(m.a)(iJ,"EnterViewStrategy",IA,[]);class sG{constructor(b){this.Ll=this.transaction=null;this.ye=b;this.CEc=this.io=0}}Object(m.a)(sG,"SelectAllArguments",null,[]);class dC{constructor(b,h,u){this.Icn=b;this.ECm=h;this.tv=u;this.Bel=(y,P,aa)=>P.view.mi?this.afb(P,aa,this.nej):this.yRn(P,aa);this.XYc=(y,
P)=>P.io?1===P.io?(P.ye.Bb.U2c(P.Ll,y),P.io=2,!0):2===P.io?(P.ye.Bb.hb.oZa=P.Ll.oZa,this.Kh.aG(),P.transaction.nGa(y),P.io=3,P.transaction.dispose(),kh.a.mark(5799),!0):!1:(P.transaction=this.tv.Qc(2),P.transaction.Eb(P.ye.jd),P.io=1,!0);this.yRn=(y,P)=>{if(1===P)return 32;if(!y.view.ue)return 2;y=y.view;return y.Bb&&y.Bb.hb&&y.Bb.hb.kb?this.nej(y).inProgress?1:32:8};this.nej=y=>{r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");y.mi&&w.ULS.sendTraceTag(39098306,
324,50,"Progress select all reach top");y=new ou.a(null,this.Umn,new sG(y));y.il("SelectAllInOutline");y.run();return y};this.Umn=(y,P)=>{if(!P.io)return P.Ll=Kf.SelectionFactory.zRn(P.ye.Bb.hb.kb),P.transaction=this.tv.Qc(2),P.transaction.Eb(P.ye.jd),P.io=1,!0;if(1===P.io){if(!P.CEc)return P.ye.Bb.setSelection(P.Ll.J(0),y),++P.CEc,!0;if(P.CEc<P.Ll.length)return P.ye.Bb.xck(P.Ll.J(P.CEc),y),++P.CEc,!0;P.io=2}return 2===P.io?(P.ye.Bb.hb.oZa=P.Ll.oZa,this.Kh.aG(),P.transaction.nGa(y),P.io=3,P.transaction.dispose(),
!0):!1}}get Kh(){return this.ECm.value}Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.Cxa,le.a.frame,dC.Maj);b.pa(Oa.a.i4f,le.a.frame,dC.Maj);b.gb(Oa.a.afb,oc.a.view,this.Bel,2);b.gb(Oa.a.MLa,oc.a.view,xe.AFrame.Ag,100);b.gb(Oa.a.yFf,oc.a.view,dC.yFf,4)}afb(b,h,u){if(1===h)return 32;if(!b.view.ue)return 2;h=b.view;if(!h.Bb)return 8;const y=h.Bb.hb;if(!y||!y.length)return 8;kh.a.mark(5798);Ra.App.xa.jb.isEditingAllowed||Ra.App.xa.jb.Zx||h.mi?b=Se.SelectionEditor.Mkf(y):(ub.FocusManager.instance().qC(xe.AFrame.So),
b=Kf.SelectionFactory.i2i(h.jd));if(!b)return 8;y.oZa||w.ULS.sendTraceTag(39098305,324,50,"Progress selection start");u&&this.Icn.Gib(Se.SelectionEditor.yVh(b))?u=u(h):(u=new sG(h),u.Ll=b,u=new ou.a(null,this.XYc,u),u.il("ExpandSelection"),u.run());return u.inProgress?1:32}static get Y4a(){return null!=dC.Vvg?dC.Vvg:dC.Vvg=Ja.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static yFf(b,h,u){if(1===u)return 32;if(!h.view.ue)return 8;b=h.view;h=Kf.SelectionFactory.Un(b.root.graphNode,!0);if(!h)return 8;
b.Bb.setSelection(h);return 32}static Maj(){var b=Ra.App.xa.jb.Jt;if(!b.ue)return 2;if(b.ue&&1!==Ra.App.xa.state){kh.a.mark(4668);var h=b.Bb.hb.kb;if(!h&&r.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Se.SelectionEditor.qBa(h);let u=h.x,y=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)u=b.x,y=b.y;dC.Y4a.Cxa(new Sys.UI.Point(u,y),1);kh.a.mark(4669)}return 32}}Object(m.a)(dC,"SelectAllHandlers",
null,[1174]);class jJ{iae(){}}Object(m.a)(jJ,"FontNameFormattingStrategyNoop",null,[1321]);var yM=c(858);class vF{constructor(b,h,u,y,P,aa){this.Ilh=this.Mlh=null;this.Pq=b;this.Hlh=h;this.dsk=u;this.nsk=y;this.Mlh=P;this.Ilh=aa}}Object(m.a)(vF,"BookmarkHighlightContext",null,[]);class kJ extends Qn.a{constructor(){super()}get Kaa(){return!0}get shb(){return 5}get O0a(){if(null!=this.v1)return this.v1;this.v1=[];this.v1.push(new io.a(ko.a.Swd,ko.a.Swd));this.v1.push(new io.a(ko.a.QXe,ko.a.QXe));this.v1.push(new io.a(ko.a.dCc,
ko.a.dCc));return this.v1}nFa(b,h){this.Kaa&&fq.a.instance.Sd(()=>{const u=this.Uu.cCa;var y=this.Uu.lTc;if(u)if(5===u.type){y=u.aA;if(u.jJ&&u.jJ.Pq.includes(b))for(const P of h.LFa("*"))this.Uu.kRa(P);y&&y.Pq.includes(b)&&this.Omb(h,u.action,y,b)}else y&&5===y.type&&3===u.action&&y.aA.Pq.includes(b)&&this.Omb(h,0,y.aA,b)},"BHA:OPHC")}sPa(b){return Object(jb.a)(vF,b)}g0a(b,h){if(b)for(const u of b.Pq)h.add(u)}Omb(b,h,u,y){0===h&&b.htmlElement&&fq.a.instance.Sd(()=>{const P=b.LFa("*"),aa=P.length,
ta=ko.a.Swd;var Pa=y.id===u.Mlh,vb=y.id===u.Ilh;let Kb=!1;var Sb=0,Yb=[];const Ac=Array(aa);for(let Ad=0;Ad<aa;Ad++){var Sc=P[Ad];const he=Xp.a(Sc);Ac[Ad]=he;const ce=Sc.classList;if(0!=Ac[Ad]){const Nd=!ce.contains(ko.a.KF),re=Bh.a.Db(Sc,ko.a.myb);re&&Yb.push(...re);if(Pa){let Xd;if((Xd=Bh.a.Db(Sc,ko.a.Uwd))&&re&&1===Xd.length&&1===re.length&&Xd[0].equals(re[0]))continue;Xd&&(Sb+=Xd.length,1===he?ce.add(ko.a.QXe):ce.add(ta));if(re)for(const vg of re)this.cSd(u,vg)&&(Sb--,Kb&&ce.add(ko.a.dCc));0!==
Sb&&Nd&&ce.add(ta)}if(!Pa&&!vb&&u.nsk.has(y.id))if((Sc=Bh.a.Db(Sc,ko.a.myb))&&Kb){ce.add(ta);for(const Xd of Sc)if(this.cSd(u,Xd)){ce.add(ko.a.dCc);break}}else Nd&&ce.add(ta)}Kb=!ce.contains(ko.a.PMa)}if(vb&&!Pa){Pa=new Set;for(var nd of Yb)this.cSd(u,nd)&&Pa.add(nd);Kb=!1;for(Yb=0;0!==Pa.size&&Yb<aa;Yb++){Sb=P[Yb];nd=Sb.classList;if(0!=Ac[Yb])if(vb=!1,Sb=Bh.a.Db(Sb,ko.a.myb)){for(const Ad of Sb)this.cSd(u,Ad)&&(Pa.delete(Ad),vb=!0);0!==Pa.size&&nd.add(ta);Kb&&vb&&nd.add(ko.a.dCc)}else nd.contains(ko.a.KF)||
nd.add(ta);Kb=!nd.contains(ko.a.PMa)}}},"BHA:SPH")}cSd(b,h){for(const u of b.dsk)if(h.equals(u))return!0;return!1}}Object(m.a)(kJ,"BookmarkHighlightActor",Qn.a,[243]);var wF=c(1808),lJ=c(1598);class xF{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){var Sb;this.fhi=!1;this.rg=b;this.DB=h;this.eb=P;this.bV=aa;this.Gj=ta;this.je=Pa;this.Wc=Kb;this.Ma=vb;this.fhi=null!==(Sb=null===vb||void 0===vb?void 0:vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==Sb?Sb:
!1}T0f(b,h,u,y){const P=b.nbh(h);if(P){var aa=Object(jb.a)(lJ.a,b),ta=this.je.jg("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",aa,u)),Pa=h.Yj.node,vb=()=>{u||this.HDn(h.Yj,P.getId())};aa=xF.Zmh();y=this.ynh(P.getId().toString(),Pa,y,u);try{b.Dhh(y,h)}catch(Kb){w.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Kb.message);this.Kp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);
return}this.rg.qj(aa,2,y.toString(),{},!0,0,Kb=>{w.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.ccc(Kb,P,()=>{this.Kp(b.fMd())},vb,Pa,h,ta)},Kb=>{const Sb=415===Kb.data.jf;let Yb="";Kb&&Kb.data&&Kb.data.Bj&&"X-CorrelationId"in Kb.data.Bj&&Kb.data.Bj["X-CorrelationId"]&&(Yb=Kb.data.Bj["X-CorrelationId"]);b.koa(`Graphics editor request failed. HttpStatus [${Kb.data.jf}], ResponseData [${Kb.data.Ae}], CorrelationId [${Yb}]`,
P,Pa,vb,()=>{this.Kp(Sb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.fMd())},ta,Sb)},null)}else this.Kp(b.fMd())}dTn(b,h,u){return new Promise((y,P)=>{var aa=b.Yj,ta=null;ta=this.fhi&&Bd.a.Pwf(aa)?aa.getContext(0).node:aa.node;aa=xF.Zmh();ta=this.ynh(h.toString(),ta,u,!1);ta.Pe(wF.a.e3e,"2");this.rg.qj(aa,2,ta.toString(),{},!0,0,Pa=>{w.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");y(Pa.data.Ae)},
Pa=>{w.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Pa.data.jf}, ResponseData ${Pa.data.Ae}`);this.Kp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);P(null)},null)})}ynh(b,h,u,y){const P=h.Hi(),aa=new fa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");r.AFrameworkApplication.Dka(aa);aa.Pe(wF.a.strict,this.tqm(h)?"true":"false");aa.Pe(Sd.a.nodeId,b);aa.Pe(Sd.a.cellId,P.gm.toString());aa.Pe(Sd.a.fileId,
P.Js);aa.Pe(Sd.a.WS,u.toString());aa.Pe(wF.a.nel,y?"true":"false");if(b=!!this.Wc&&this.Wc.isFeatureEnabled(47)){aa.Pe(nh.a.YLi,b.toString());if(b=this.Wc.isFeatureEnabled(90))aa.Pe(nh.a.Ngn,b.toString()),aa.Pe(nh.a.ignoreMalformedColors,this.Wc.isFeatureEnabled(54).toString());this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&aa.Pe(nh.a.Wgn,"true")}aa.Pe(nh.a.Tkh,"true");Bl.a.instance.Exb(aa);return aa}tqm(b){if(!this.DB)return!1;b=this.DB.Wt(b);return!!b&&b.Nf(Lc.a.xyf)}HDn(b,
h){b.cpBegin===b.cpEnd-1&&this.Gj.rec(b.node,h,this.eb,this.bV)}Kp(b){const h=new Gh.StandardDialog;h.Ed=0;h.py(Xm.a.f$e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Ra.App.xa.updateCommandUI()}static Zmh(){const b=new fa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");r.AFrameworkApplication.Dka(b);return b.toString()}}Object(m.a)(xF,"GraphicsEditorRequestManager",null,[292]);class mJ extends EA{constructor(b,
h){super(b,h);this.GOa=Oa.a.insertHyperlink}j1a(b){null!=b&&0<b.length&&this.Bc.Ub(this.GOa,2,b[0])}rvj(b,h,u){const y=zl.a.sg(r.AFrameworkApplication.lcid).name;b=String.format(b,r.AFrameworkApplication.lcid,y,r.AFrameworkApplication.buildVersion,h,Ts.Zke,u);b+="&flipgrid=1&ted=1";r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new fa.QueryStringBuilder(b),b.dK("stream2","1"),b=b.toString());return b}}Object(m.a)(mJ,
"InsertHubbleMediaHelper",EA,[]);class nJ{constructor(b,h,u,y,P,aa){this.ga=b;this.Ma=h;this.Agd=u;this.A1=y;this.Jdd=P;this.Tk=aa}Wb(){this.ga.gb(Rc.a.yIi,oc.a.Vc,this.abn.bind(this),1028);this.ga.gb(Rc.a.oei,oc.a.Vc,this.ugm.bind(this),1028)}ugm(b,h,u,y,P){if(1!==u){if(null==P)return 16;if(!h.gl||!Se.SelectionEditor.pf(h))return 2;b=this.wBl(P);P=P.OriginalUrl;r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Jdd.Dhg(b,h,P)}return 32}VAj(){r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}wBl(b){const h=new kC;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;return h}abn(b,h,u){var y,P;if(1!==u)h=A.a.uW(this.Ma.lb("UserId")).toString(),h=this.A1.rvj(this.Ma.appSettings.InsertVideoHubbleEndpoint,
Ua.a.create().toString(),h),this.A1.GOa=Rc.a.oei,h=this.Agd.mLc(h,!0),h.correlationId=Ua.a.create(),h.Kga=5,h.pce(null,this.A1),ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]})),this.VAj();else if(!(h&&h.node&&RB.a(h.node))||Fj.a.IAd&&(null===(y=this.Tk)||void 0===y?0:y.xZ(h))||(null===(P=this.Tk)||void 0===P?0:P.uva(h)))return 2;return 32}}Object(m.a)(nJ,"OnlineMediaActor",null,[]);class oJ extends lC{constructor(b,
h,u,y=null,P=!1){super(b,h,u,y,P);this.Sqc=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}ZJc(){const b={};b.insertMediaServiceEndpoint=this.Bgd;b.iFrameId="mediaiframe";return b}pce(b,h){this.XRb=b;this.Sqc=h;this.Lpc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.ZJc(),["componentIsVisibleCallback"]:this.Yyj.bind(this)};this.Wh(this.XRb,null,b)}Yyj(){this.p_=this.M4b(this.mj("mediaiframe"));this.NG=this.Pmd.getInstance(this.p_.contentWindow,this.Bgd);this.NG.qq(H.a.Ych,
b=>{this.mCi(b,this.Sqc.j1a.bind(this.Sqc))});this.NG.qq(H.a.insert,b=>{this.d1d(b,this.Sqc.j1a.bind(this.Sqc))});this.NG.qq(H.a.AVh,this.jEi.bind(this));this.NG.qq(H.a.getSessionId,this.mEi.bind(this));this.NG.qq(H.a.oTh,this.iEi.bind(this));this.NG.qq(H.a.Qxd,this.XCi.bind(this));this.Dmb(3)}Dmb(b){const h=[];h.push(Object.assign(new ca.a,{name:"DialogResult",string:Rx[b]}));h.push(Object.assign(new ca.a,{name:"DialogMode",string:this.okf()}));h.push(Object.assign(new ca.a,{name:"CorrelationId",
string:this.correlationId.toString()}));h.push(Object.assign(new ca.a,{name:"Provider",string:Tp[this.Kga]||"Unknown"}));ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:this.telemetryEventName,dataFields:h}))}}Object(m.a)(oJ,"OnlineMediaDialog",lC,[]);class pJ{constructor(b,h){this.Qxe=b;this.A1=h}mLc(b,h=!1){return new oJ(b,this.Qxe,this.A1,null,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(pJ,"OnlineMediaDialogFactory",null,[289]);class qJ extends Gq{constructor(){super(1,3);
this.cL=Ja.a.instance.resolve("Common.IReactContextualUILauncher");this.whj=!1}B5a(){r.AFrameworkApplication.ya.processAction(Rc.a.bhc,2)}jFd(){this.VOh&&!this.kv&&(this.kv=this.fJa())}YFd(){if(this.kv&&this.kv.isVisible){var b=Object(na.a)(vm.Control,this.kv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.Fw(b.ggb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)w.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");
else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(hf.a.hwd)||"",hf.a.AL===h&&b.click())}}c_(){return this.cL.c_}}Object(m.a)(qJ,"ExternalContentFloatieManager",Gq,[]);class Es{constructor(){Es.eem()}get nc(){return null!=this.azg?this.azg:this.azg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Cw(){return null}sjc(b){var h=null;if(!be.ParagraphReader.rh(b))return{returnValue:!1,ola:h};if((b=this.nc.Xn(b.currentNode))&&
2===this.nc.lx(b)){const u=this.nc.qf(b);Es.oP.contains(u)&&(h=this.nc.WF(b),h=Object.assign(new fs.a,{kG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,ola:h}}hCb(b,h){let u=null;h&&b.contentId.equals(h.contentId)||(u=b.contentObject);return u}static eem(){Es.oP=new lg.a;Es.oP.add(hl.StyleReader.styleIdHeading1);Es.oP.add(hl.StyleReader.styleIdHeading2);Es.oP.add(hl.StyleReader.styleIdHeading3);Es.oP.add(hl.StyleReader.Mxa);Es.oP.add(hl.StyleReader.qSa);Es.oP.add(hl.StyleReader.rSa);
Es.oP.add(hl.StyleReader.Uhc);Es.oP.add(hl.StyleReader.Q5a);Es.oP.add(hl.StyleReader.wordStyleIdHeading1);Es.oP.add(hl.StyleReader.wordStyleIdHeading2);Es.oP.add(hl.StyleReader.wordStyleIdHeading3);Es.oP.add(hl.StyleReader.b7a);Es.oP.add(hl.StyleReader.c7a);Es.oP.add(hl.StyleReader.d7a);Es.oP.add(hl.StyleReader.dpb);Es.oP.add(hl.StyleReader.epb);Es.oP.add(hl.StyleReader.e7a);Es.oP.add(hl.StyleReader.i7a);Es.oP.add(hl.StyleReader.zkc)}}Es.oP=null;Object(m.a)(Es,"ParagraphStyleDetailsProvider",null,
[621,246]);class rJ{constructor(b,h,u,y){this.kJa=b;this.sTj=h;this.ATj=u;this.BTj=y}hWf(){this.kJa.execute(b=>{b.jec(this.sTj.value);b.jec(new Es);b.jec(this.BTj.value);b.a4(this.ATj.value)})}}Object(m.a)(rJ,"AccessibilityActor",null,[]);class sJ{constructor(b,h,u){this.eg=null;this.M3c=(y,P,aa)=>{if(1===aa)return 32;this.eg=this.Coc.value.MQk(this.Vb);if(!this.eg)return w.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.eg.gSa();return 32};this.Wah=y=>this.eg?
this.eg.K4l(y):2;this.ga=b;this.Coc=h;this.Vb=u}Wb(){if(r.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Rb.KeyInputManager.lc(fb.a.w7a,5);this.Vb.le(xe.AFrame.So).Mr(b);this.Vb.le(xe.AFrame.Hp).bindAction(b,Wa.a.M3c);this.ga.pa(Wa.a.M3c,le.a.frame,this.M3c);this.ga.pa(Wa.a.bAc,le.a.frame,this.Wah);this.ga.pa(Wa.a.aAc,le.a.frame,this.Wah)}}}Object(m.a)(sJ,"AccessibilityHelpDialogActor",null,[]);var zM=c(1016),AM=c(1373);class tJ{constructor(b,h){this.mOj=b.pc("WordHangForActionManagerThresholdTime",
750);this.ga=h;this.SCj=zM.a.sE(26,5,new AM.a)}b4(){this.ga.b4(this)}b8(){}a8(b){const h=+b.endTime-+b.startTime;if(h>this.mOj){let u="";switch(b.behavior){case 1:u="E";break;case 2:u="X";break;case 3:u="A"}(b=De.ActionManager.dea(b.actionId))&&b.length||(b="UnknownAction");this.SCj.track(h,b+"_"+u)}}}Object(m.a)(tJ,"ActionHangDetector",null,[35]);var uJ=c(1437);class vJ extends Te{constructor(b){super(b,void 0,r.AFrameworkApplication.DZa,new Cc(b,!1))}get d3a(){return CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get P$b(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get STc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get EFc(){return r.AFrameworkApplication.DZa?
"UIFontDialogTextLarge":null}nCf(){w.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}oCf(){w.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}iUc(){w.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");r.AFrameworkApplication.ya.processAction(Wa.a.DHh,2)}}Object(m.a)(vJ,"DownloadACopyDialog",Te,[]);var yF;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";
b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(yF||(yF={}));Object(m.b)("OfficeApplication",yF);var CE;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(CE||(CE={}));Object(m.b)("OpenDocumentMode",CE);class wJ extends ff.a{constructor(){super(!1,!1,!0)}B2d(){var b=
{["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};
h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Wh("Send feedback to Microsoft",this.z_n.bind(this),b);return new Promise(u=>{this.nWj=u})}z_n(b,h){1===b&&this.xpa(h.selectedReason)}dispose(){super.dispose();this.nWj()}xpa(b){const h={},u={},y={},P={},aa={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=
Ua.a.create().toString();aa.reason=b;const ta={},Pa={numberOfOptions:5};Pa.selectedRating=b;ta.rating=[Pa];P.surveySpecificData=JSON.stringify(ta);y.extendedManifestData=JSON.stringify(P);h.application=y;aa.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=aa;h.telemetry=this.mCc();h.web=this.nCc();u["Content-Type"]="application/json";this.OFa(JSON.stringify(h),u)}y$(b,h,u,y){h&&b&&y&&u&&y in h&&(b[u]=h[y])}mCc(){const b=r.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=r.AFrameworkApplication.buildVersion;
h.featureArea="Open In Desktop App";this.y$(h,b,"audienceGroup","AudienceGroup");this.y$(h,b,"osBuild","OsVersion");this.y$(h,b,"platform","Platform");this.y$(h,b,"processSessionId","WACSessionID");return h}nCc(){const b=r.AFrameworkApplication.sessionStartInfoSettings,h={};this.y$(h,b,"browser","Browser");this.y$(h,b,"browserVersion","BrowserVersion");this.y$(h,b,"dataCenter","WACDatacenter");return h}OFa(b,h,u=0){let y=0;3<u||(1===u?y=200:1<u&&(y=200+500*(u-1)),r.AFrameworkApplication.uc.Xb(new sc.a(2,
1,y,()=>{r.AFrameworkApplication.Ve.qj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{w.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.OFa(b,h,u+1);w.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",u)},null)})))}}Object(m.a)(wJ,"WordOpenInClientFeedbackDialog",ff.a,[]);var xJ=c(1705);const FD=b=>{for(let h=0;h<b.children.length;h++){const u=b.children[h];u.style.position="relative";
u.style.top=(u.parentNode.offsetHeight-u.offsetHeight)/2+"px"}},zF=b=>b.Ib.keyCode===fb.a.us||b.Ib.keyCode===fb.a.BHa?(b.Bf.click(),!0):!1,DE=(b,h,u,y,P,aa,ta)=>{const Pa=document.createElement("a");Pa.className="ProtocolLaunchingDialogButtonAnchor";Pa.className+=" OICDialog";Pa.id=b;Pa.setAttribute(hf.a.wh,hf.a.l2);Pa.style.padding="0";Pa.style.margin="0";y&&yJ(P,h,u,y,Pa);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=P;Pa.appendChild(b);Pa.tabIndex=
0;aa&&th.a.instance.mb(bb.a.click,Pa,aa);ta&&Rb.KeyInputManager.instance.mb(bb.a.sh,Pa,ta);return Pa},yJ=(b,h,u,y,P)=>{var aa=document.createElement("img");aa.alt=b;aa.className=Gd.getImageClassWithCluster(u,y);aa.src=h;aa.setAttribute(hf.a.wh,hf.a.My);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(aa);aa=document.createElement("span");aa.className="ProtocolLaunchingDialogIconContainer";aa.appendChild(b);P.appendChild(aa)};class AF{static get Hg(){return ff.a.Sy(AF.am,
CommonUIStrings.l_OICLaunchDialogTitle)}}AF.am="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(AF,"OICLaunchDialogHtml",null,[]);class zJ extends ff.a{constructor(b){super();this.CQb=this.aqb=null;this.eL=!1;this.gq=b;this.Hg=AF.Hg;this.Ed=5;this.mg="OICLaunchDialog";this.showDialog("",Object(v.a)(this,this.M_m,"oicLaunchDialogResultHandler"));this.k6i();this.k4("ProtocolLaunchingDialogTitle");4!==r.AFrameworkApplication.ta.Pb.MMa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.EU(this.aqb);w.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}QX(){this.aqb=DE("BtnRichClient",this.gq.PGc,this.gq.HOc,this.gq.wrf,CommonUIStrings.l_OICLaunchRichClient,Object(v.a)(this,this.HGi,"onRichClientButtonClick"),zF);document.getElementById("OICLaunchRichClient").appendChild(this.aqb);FD(this.aqb);this.CQb=DE("BtnReturn",this.gq.PGc,this.gq.HOc,this.gq.bci,CommonUIStrings.l_OICReturnToOnlineClient,Object(v.a)(this,this.DGi,"onReturnButtonClick"),
zF);document.getElementById("OICReturnToApp").appendChild(this.CQb);FD(this.CQb)}DGi(){this.hide();this.gq.Sec();return!0}HGi(){w.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();r.AFrameworkApplication.ya.processAction(Wa.a.mLb,2);return!0}M_m(){this.gq.Sec()}dispose(){this.eL||(this.aqb&&(th.a.instance.sc(bb.a.click,this.aqb,Object(v.a)(this,this.HGi,"onRichClientButtonClick")),Rb.KeyInputManager.instance.sc(bb.a.sh,this.aqb,zF)),this.CQb&&(th.a.instance.sc(bb.a.click,
this.CQb,Object(v.a)(this,this.DGi,"onReturnButtonClick")),Rb.KeyInputManager.instance.sc(bb.a.sh,this.CQb,zF)),super.dispose(),this.eL=!0)}}Object(m.a)(zJ,"OICLaunchDialog",ff.a,[]);class BF{static get Hg(){return ff.a.Sy(BF.am,CommonUIStrings.l_OICDialogTitle)}}BF.am="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(BF,"ProtocolLaunchingDialogV2Html",null,[]);class AJ extends ff.a{constructor(b){super();this.BQb=this.FTa=null;this.eL=!1;this.c8a=null;this.gq=b;this.Hg=BF.Hg;this.Ed=5;this.mg="ProtocolLaunchingDialog";this.KRb="OICRetryDialog";r.AFrameworkApplication.uc.TDb&&r.AFrameworkApplication.uc.restart();r.AFrameworkApplication.uc.Xb(new sc.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(v.a)(this,this.iTf,"protocolLaunchingDialogResultHandler"));this.k6i();this.k4("Issues");
this.oPh();w.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}QX(){const b=document.getElementById("Issues");if(b){yJ("",this.gq.PGc,this.gq.HOc,this.gq.wrf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.gq.mIi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);FD(b);b.style.display="none"}r.AFrameworkApplication.ta.Pb.Z7h?
(this.BQb=DE("GiveFeedback",this.gq.PGc,this.gq.HOc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(v.a)(this,this.Q0d,"onGiveFeedbackClick"),Object(v.a)(this,this.oEi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.BQb),FD(this.BQb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===r.AFrameworkApplication.ta.Pb.MMa||r.AFrameworkApplication.h5k?document.getElementById("ButtonEdit").style.display="none":(this.FTa=
DE("Edit",this.gq.PGc,this.gq.HOc,"",2===r.AFrameworkApplication.ta.Pb.$n?4===r.AFrameworkApplication.ta.Pb.MMa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===r.AFrameworkApplication.ta.Pb.MMa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(v.a)(this,this.PDi,"onEditClick"),Object(v.a)(this,this.SDi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.FTa),FD(this.FTa));0===r.AFrameworkApplication.ta.Pb.MMa&&
!r.AFrameworkApplication.axf&&b&&(b.style.display="none")}pPh(){return this.c8a?(this.EU(this.c8a),!0):!1}oPh(){return this.FTa?(this.EU(this.FTa),!0):!1}SDi(b){return this.AKf(b,0)}oEi(b){return this.AKf(b,2)}CGi(b){return this.AKf(b,1)}AKf(b,h){let u=!1;if(b.Ib.keyCode===fb.a.us||b.Ib.keyCode===fb.a.BHa)b.Bf.click(),u=!0;else if(b.Ib.keyCode===Sys.UI.Key.down||b.Ib.keyCode===Sys.UI.Key.up)switch(h){case 1:u=this.oPh();break;case 0:u=this.pPh()}return u}PDi(){this.hide();4===r.AFrameworkApplication.ta.Pb.MMa?
(w.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.gq.Sec()):(w.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.gq.gNc());return!0}Q0d(){w.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}eMf(){XL.Redirect.showHelp("OICFailure");return!0}O1d(){w.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";r.AFrameworkApplication.ya.processAction(Wa.a.mLb,2);return!0}iTf(){this.gq.Sec()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.c8a=DE("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(v.a)(this,this.O1d,"onRetryOICClick"),Object(v.a)(this,this.CGi,"onRetryOICKeyUp")),b.appendChild(this.c8a),FD(this.c8a),this.FTa||this.pPh())}}dispose(){this.eL||(this.FTa&&
(th.a.instance.sc(bb.a.click,this.FTa,Object(v.a)(this,this.PDi,"onEditClick")),Rb.KeyInputManager.instance.sc(bb.a.sh,this.FTa,Object(v.a)(this,this.SDi,"onEditKeyUp"))),this.BQb&&(th.a.instance.sc(bb.a.click,this.BQb,Object(v.a)(this,this.Q0d,"onGiveFeedbackClick")),Rb.KeyInputManager.instance.sc(bb.a.sh,this.BQb,Object(v.a)(this,this.oEi,"onGiveFeedbackKeyUp"))),this.c8a&&(th.a.instance.sc(bb.a.click,this.c8a,Object(v.a)(this,this.O1d,"onRetryOICClick")),Rb.KeyInputManager.instance.sc(bb.a.sh,
this.c8a,Object(v.a)(this,this.CGi,"onRetryOICKeyUp"))),super.dispose(),this.eL=!0)}}Object(m.a)(AJ,"ProtocolLaunchingDialog",ff.a,[]);class CF extends Gh.StandardDialog{constructor(b){super();this.gq=b;this.mg="ProtocolLaunchingDialog";r.AFrameworkApplication.uc.TDb&&r.AFrameworkApplication.uc.restart();r.AFrameworkApplication.ta.Pb.Z7h&&this.cak(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(v.a)(this,this.Q0d,"onGiveFeedbackClick"));CF.S9h?(this.Ed=12,this.Ue(1,CommonUIStrings.l_CloseFile),
this.Ue(2,CommonUIStrings.l_OICDialogContinueHere),this.Ue(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ed=4,this.Ue(1,CommonUIStrings.l_OICDialogContinueHere),this.Ue(2,CommonUIStrings.l_OICDialogLaunchAgain));this.Sjb(CommonUIStrings.l_OICDialog2ndTitle,5===this.gq.mIi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(v.a)(this,this.iTf,"protocolLaunchingDialogResultHandler"),null)}Q0d(b){w.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.ZDi(b)}O1d(){w.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");r.AFrameworkApplication.ya.processAction(Wa.a.mLb,2)}iTf(b){CF.S9h?3===b?this.VZi():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.VZi():(1===b||0===b)&&this.continueEditing()}closeDocument(){w.ULS.sendTraceTag(577783557,211,50,"Closing the document");r.AFrameworkApplication.ya.Ub(Wa.a.close,2,vj.a)}VZi(){w.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(v.a)(this,this.O1d,
"onRetryOICClick"),0)}continueEditing(){4===r.AFrameworkApplication.ta.Pb.MMa||r.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===r.AFrameworkApplication.ta.mode?(w.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.gq.Sec()):(w.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.gq.gNc())}static get S9h(){return r.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===r.AFrameworkApplication.ya.processAction(Wa.a.close,
1)}}Object(m.a)(CF,"StandardProtocolLaunchingDialog",Gh.StandardDialog,[]);class BJ{}Object(m.a)(BJ,"EditDocumentInClientParams",null,[]);class tG{static aIh(b,h,u,y,P,aa,ta=!1,Pa=!1,vb="",Kb=!1,Sb=!1,Yb=!1,Ac="",Sc="",nd="",Ad=!1,he=""){const ce=new BJ;ce.DocumentUrl=b;ce.DocumentExtension=he;ce.Mode=h;ce.Options=u;ce.Application=y;ce.SilentExternalHandler=ta;ce.EncodeUrl=Pa;ce.CorrelationIdForWinClient=vb;ce.NavigateUsingWindowOpen=Kb;ce.DescriptiveUnattemptedEnums=Sb;ce.NoBrowserModalDialogs=Yb;
ce.SessionOrigin=Ac;ce.CorrelationId=Sc;ce.ClickTime=nd;ce.NewTelemetryDataIsEnabled=Ad;MSOJS.ClientUtils.EditDocumentInClient(ce,P,aa)}}Object(m.a)(tG,"ClientUtils",null,[]);var BM=c(416),CJ=c(936);class LC{constructor(b){this.dWa=this.bpc=this.$mc=null;this.oqc=!1;this.lse=this.$Ce=this.rYg=null;this.zad=this.W0=this.Hpd="";this.application=this.Dy=0;this.Zho=this.I8f=!1;this.PCo=b&&r.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");r.AFrameworkApplication.ya.Z6(Wa.a.mLb)||r.AFrameworkApplication.ya.pa(Wa.a.mLb,
le.a.frame,Object(v.a)(this,this.HMn,"retryOpenInClientAction"));this.ocj=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("SilentExternalHandler")}get mIi(){return this.Dy}m2n(b,h="",u=""){this.W0=u||Ua.a.create().toString();this.Hpd=h||BM.a.o0h();this.zad=b}HMn(b,h,u){return h.contextId!==le.a.frame?2:1===u?32:this.mLb()}get options(){let b=0;r.AFrameworkApplication.GJn&&(b|=1);r.AFrameworkApplication.rIi&&(b|=4);this.Sho()&&(b|=64);return b}Sho(){return!(2===this.application&&r.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get PGc(){return r.AFrameworkApplication.Cr}get HOc(){return r.AFrameworkApplication.mQ}get bci(){return""}get wrf(){return""}get Yho(){return r.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get Blo(){return this.rYg||
(this.rYg=Ja.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.I8f||this.Jdl()}Sec(){this.Zho||this.yLh()}CRi(b){return this.PCo&&ba.a.zi?(new zJ(this),32):this.ovh(b)}ovh(b){const h=({sob:b}=this.MBm(b)).returnValue;w.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}begin(b,h,u,y,P,aa,ta=""){this.$mc=b;this.lse=ta;this.bpc=h;this.dWa=aa;this.application=u;this.Dy=y;return r.AFrameworkApplication.KHh?(this.bri(),32):r.AFrameworkApplication.Qna&&
!r.AFrameworkApplication.Rai?(r.AFrameworkApplication.d6f(),8):this.Zkh(P)}get L_m(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}mLb(){this.L_m&&this.ZHm();return this.ovh(this.oqc)}p3i(){const b=new CJ.a(H.a.openInClient);b.Values["ui-language"]=r.AFrameworkApplication.lcid.toString();b.Values[Qo.a.lCh]=r.AFrameworkApplication.userSessionId;return this.dWa.value.send(b)?32:8}ZHm(){Ta.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Ya.a,{inStaging:!0}))}NTn(b){const h=new CJ.a(H.a.GFo);h.Values["ui-language"]=r.AFrameworkApplication.lcid.toString();h.Values[Qo.a.lCh]=r.AFrameworkApplication.userSessionId;h.Values[G.a.FFo]=b;this.dWa.value.send(h)}MBm(b){this.oqc=b;this.NTn(5===this.Dy?LC.Man:LC.Tan);return 5===this.Dy?this.LBm():this.PBm()}LBm(){this.lri();return{returnValue:32,sob:"HostEditUrl,"}}PBm(){let b;var h=b="";r.AFrameworkApplication.Qdh&&(h="|f|"+r.AFrameworkApplication.userSessionId);
const u=r.AFrameworkApplication.K.$("IsAssignmentMode")&&r.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||r.AFrameworkApplication.DSc||ba.a.qPa,y=r.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),P=r.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(r.AFrameworkApplication.ya.o_d){var aa=r.AFrameworkApplication.ya.Ifa(3588168074);aa&&this.m2n(aa.epochClickTime,aa.sessionOrigin,aa.correlationId);this.cui()}if(r.AFrameworkApplication.eNi){b+="NewOrder,";
aa=8;this.dWa&&this.dWa.value&&this.dWa.value.isEnabled()&&r.AFrameworkApplication.Xjc&&(b+="Post,",aa=this.p3i());if(32===aa)return{returnValue:aa,sob:b};w.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return r.AFrameworkApplication.su.noa?(w.ULS.shipAssertTag(5566816,211,!!r.AFrameworkApplication.su.noa),b+="HostUrl,",{returnValue:r.AFrameworkApplication.ta.I3(!0,r.AFrameworkApplication.su.noa),sob:b}):this.$mc?(w.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",r.AFrameworkApplication.userSessionId),b+="DocUrl,",tG.aIh(this.$mc,this.Dy,this.options,this.application,Object(v.a)(this,this.RDi,"onEditInClientSuccess"),Object(v.a)(this,this.QDi,"onEditInClientFailure"),this.ocj,r.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,u,y,P,this.Hpd,this.W0,this.zad,r.AFrameworkApplication.ya.o_d,this.lse),{returnValue:32,sob:b}):{returnValue:8,sob:b}}b+="OldOrder,";if(!this.$mc&&r.AFrameworkApplication.su.noa)return this.dWa&&
this.dWa.value&&this.dWa.value.isEnabled()&&r.AFrameworkApplication.Xjc?(b+="Post,",h=this.p3i()):(w.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(w.ULS.shipAssertTag(22595484,211,!!r.AFrameworkApplication.su.noa),b+="HostUrl,",{returnValue:r.AFrameworkApplication.ta.I3(!0,r.AFrameworkApplication.su.noa),sob:b}):{returnValue:h,sob:b};w.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",r.AFrameworkApplication.userSessionId);
b+="DocUrl,";tG.aIh(this.$mc,this.Dy,this.options,this.application,Object(v.a)(this,this.RDi,"onEditInClientSuccess"),Object(v.a)(this,this.QDi,"onEditInClientFailure"),this.ocj,r.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,u,y,P,this.Hpd,this.W0,this.zad,r.AFrameworkApplication.ya.o_d,this.lse);return{returnValue:32,sob:b}}LIn(b){r.AFrameworkApplication.Mm.setDw(8981,b)}RDi(b){this.LIn(b);w.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.Yho||this.lri(),this.cui()):this.I8f||this.closeApplication()}QDi(b,h=0){w.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const u=!!this.bpc&&!this.oqc;let y=0;1===b&&(y=2);6<=b&&13>=b&&(y=1,1===h&&(this.I8f=!0));this.Blo.v_m?(w.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",y),xJ.a.instance.vVk(this.oqc?Object(v.a)(this,this.WBi,
"oicErrorDialogHandlerCloseForced"):Object(v.a)(this,this.XBi,"oicErrorDialogHandlerNoCloseForced"),u?Object(v.a)(this,this.PEi,"onLaunchDownload"):null,this.JFh(!1)?Object(v.a)(this,this.Z9l,"iHaveOfficeButtonHandler"):null,y,h)):(w.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",y),xJ.a.instance.tVk(this.oqc?Object(v.a)(this,this.WBi,"oicErrorDialogHandlerCloseForced"):Object(v.a)(this,this.XBi,"oicErrorDialogHandlerNoCloseForced"),u?Object(v.a)(this,this.PEi,"onLaunchDownload"):
null,y))}}cui(){try{const b=[Object.assign(new ca.a,{name:"CorrelationId",string:this.W0}),Object.assign(new ca.a,{name:"SessionOrigin",string:this.Hpd}),Object.assign(new ca.a,{name:"ClickTime",string:this.zad}),Object.assign(new ca.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Ub.a("OpenInClientCompleted",!0,0,b)}catch(b){w.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}lri(){r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.ZA&&
r.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?new CF(this):new AJ(this)}WBi(){this.closeApplication()}XBi(){this.Sec()}PEi(){this.bri()}Z9l(){return this.JFh(!0)}JFh(b){const h=(ba.a.$Qc||ba.a.jt)&&!!r.AFrameworkApplication.GDd;h&&b&&(Je.a.en(r.AFrameworkApplication.GDd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}LC.Tan="OpenInDesktop";LC.Man="OpenInBrowser";Object(m.a)(LC,"AOpenInClientOperation",null,[]);class uG extends LC{constructor(b,h,u=!1){super(u);
this.vPj=b;this.uPj=h}get bci(){return this.uPj}get wrf(){return this.vPj}Jdl(){r.AFrameworkApplication.ya.Ub(Wa.a.close,2,vj.a)}yLh(){}Zkh(b){return this.CRi(b)}bri(){w.ULS.shipAssertTag(5566817,211,!!this.bpc);r.AFrameworkApplication.Qaa?r.AFrameworkApplication.ta.I3(!0,this.bpc):Je.a.en(this.bpc,void 0,void 0,"LaunchDownload")}gNc(){r.AFrameworkApplication.ta.Pb.gNc()}}Object(m.a)(uG,"OpenInClientOperation",LC,[]);class DJ extends uG{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",
!0);this.gCn=b=>{w.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Ra.App.j0.forceOutbound(this.CIi,this.BHm,b)};this.BHm=b=>{w.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new Gh.StandardDialog;h.Ed=0;h.py(Xm.a.sto,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.zHm:this.AHm)};this.zHm=()=>{r.AFrameworkApplication.ya.Ub(Wa.a.close,2,vj.c)};this.AHm=()=>{Ra.App.xa.refreshDocument(null)};this.CIi=
b=>{r.AFrameworkApplication.c5c=!0;w.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.CRi(b)}}drk(b){Ra.App.kk.lQa.YL||Ra.App.yd.pB.zo?(w.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.CIi(b)):Lv.a.VP(4,!0,this.gCn,null,b)}Zkh(b){this.drk(b);return 32}yLh(){Ra.App.xa.refreshDocument(null)}}Object(m.a)(DJ,"OpenInWordOperation",uG,[]);const EJ=(b,h)=>{w.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");
b[ag.a.On]=se.PageReader.instance.Yu(h);se.PageReader.instance.Yu(h)?b[ag.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[ag.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},CM=(b,h,u,y,P)=>{if(!Ra.App.xa||!Ra.App.xa.jb||!r.AFrameworkApplication.wo.Ofb)return 8;h=Ra.App.xa.jb.Yc;if(!h)return 8;if(b===Oa.a.y5d&&2===u){b=new dg.GraphTransaction(15);try{b.Eb(h),se.PageReader.instance.pno(h)}finally{b&&b.dispose()}EJ(P,h)}return 32},DM=(b,h,u,y,P)=>{if(!Ra.App.xa||
!Ra.App.xa.jb)return 8;b=Ra.App.xa.jb.Yc;if(!b)return 8;P[ag.a.Alt]=r.AFrameworkApplication.wo.Ofb?"":CommonUIStrings.l_ProtectDocumentToolTip;EJ(P,b);return 32};class FJ extends uJ.a{constructor(b,h){super(b,h);this.CRg=!1;this.wFi=(u,y,P,aa,ta)=>{var Pa;if(y.contextId!==le.a.frame)return 2;if(!(Ra.App.ADc||r.AFrameworkApplication.su.noa||r.AFrameworkApplication.Xjc||this.CRg))return w.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.CRg=!0,8;if(1===P)return ui.SessionStatusManager.instance.zj?
8:32;let vb=!1;void 0!==ta&&null!==ta&&(vb=ta);if(null===(Pa=r.AFrameworkApplication.K)||void 0===Pa?0:Pa.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new wJ).B2d().then(()=>this.VIb(u,vb));else return this.VIb(u,vb);return 32};this.f7k=u=>{this.QIm();if(!r.AFrameworkApplication.DSc&&r.AFrameworkApplication.ta.Pb.q4f(Wa.a.downloadACopy.toString()))this.sxa(!0,H.a.download,!0,{});else if(r.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let y=r.AFrameworkApplication.IAb;
u&&u.FileDownloadUrl&&(y=u.FileDownloadUrl.toString());new vJ(y)}else super.downloadACopy(0,null,2,null,null)};this.Qzk=u=>{super.workflow(0,null,2,null,u)};this.mS=Ja.a.instance.Za("Common.ISystemInitiatedFeedback")}Wb(){super.Wb();this.ga.pa(Oa.a.openInClient,le.a.frame,this.wFi);r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Xc(Oa.a.openInClient,12288);var b=this.ga;b.gb(Oa.a.y5d,oc.a.application,
CM,4);b.gb(Oa.a.jUf,oc.a.application,DM,96);this.ga.pa(Wa.a.gOf,le.a.frame,this.wFi)}VIb(b,h){w.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new DJ).begin(Ra.App.ADc,r.AFrameworkApplication.IAb,yF.Word,b===Wa.a.gOf?CE.OpenInBrowser:CE.WriteOnly,h,new Zf.a(()=>this.eX))}Gwd(b){return Ak.a.instance.ABa()?!0:Ra.App.xa.O0i(1,$g.AppFrame.JHk,b)}downloadACopy(b,h,u,y,P){if(2===u){if(!r.AFrameworkApplication.IAb&&!r.AFrameworkApplication.ta.Pb.q4f(Wa.a.downloadACopy.toString()))return 8;
Lv.a.VP(2,!0,this.f7k,null,P);return 32}return super.downloadACopy(b,h,u,y,P)}QIm(){r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.mS&&this.mS.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,u,y,P){return 2===u?(Lv.a.VP(13,!0,this.Qzk,null,P),32):super.workflow(b,h,u,y,P)}}Object(m.a)(FJ,"AppFrameCommandUIActor",uJ.a,[]);class GJ extends Gh.StandardDialog{constructor(){super();
this.Ed=0;this.Sjb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(m.a)(GJ,"WheresTheSaveButtonDialog",Gh.StandardDialog,[]);const EM=(b,h,u)=>{if(1===u)return 32;new GJ;return 32};var vG=c(556),HJ=c(1342);class jt extends Eo.a{constructor(b,h,u,y,P,aa,ta=null){var Pa,vb,Kb;super();this.kba=ta;this.BFj=50;this.CFj=56;this.Yvc="px";this.Pme=
"aria-label";this.cIa="BookmarkIndicator";this.vNg="HighlightBookmarkedContent";this.GOj="HighlightBookmark";this.MUa="wwaengidc";this.psk="Bookmark_24";this.eb=b;this.qg=u;this.Qj=h;this.vV=y;this.Az=P;this.L5g=null===(Pa=r.AFrameworkApplication.K)||void 0===Pa?void 0:Pa.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit",!1);this.GFj=null===(vb=r.AFrameworkApplication.K)||void 0===vb?void 0:vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);
this.xFj=null===(Kb=r.AFrameworkApplication.K)||void 0===Kb?void 0:Kb.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.Az&&this.Az.Yud(this.dB.bind(this));this.WH=aa}p5n(b){if(b.Lj){for(const h of b.kg.pi)if(this.r4f(h))return!0;return!1}return this.r4f(b.htmlElement)}fnb(b){let h=!1;r.AFrameworkApplication.Ce("bookmarks-core-ex;bookmarks-core-ex-cf");this.GFj&&(r.AFrameworkApplication.Ce("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf"),this.L5g?fq.a.instance.Sd(()=>
{h=this.p5n(b)},"BIA:SCIVE"):fq.a.instance.Sd(()=>{h=this.r4f(b.htmlElement)},"BIA:SCI"));return h}r4f(b){return jt.MLe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}jZa(b){const h=[];fq.a.instance.Sd(()=>{const u=b.Xcb(0,this.WH?this.CFj:this.BFj,this.zoom);h.push(this.ZBa(b.U3,u,b.pkc[0].y-b.jX[0].y))},"BIA:CIs");return h}ZBa(b,h,u){const y=b.Ug.ownerDocument,P=Mp.a.createElement(y,cm.a.div);P.className=this.WH?jt.FFj:jt.Bne;jt.Bne;
P.style.left=h+this.Yvc;P.style.top=u+this.Yvc;this.WH?(h=Mp.a.createElement(y,cm.a.div),fh.a("renderIcon")&&appChrome.api.renderIcon(this.psk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=Mp.a.createElement(y,cm.a.U0a),h.src=Yl.a.Yh(jt.W$c),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.Pme,"Bookmark");P.appendChild(h);b={context:new vF([],P,new Set,new Set,null,null),FJf:b,container:P};this.WH||(this.Qj.mb(bb.a.DQ,h,this.onMouseEnter),this.Qj.mb(bb.a.GK,h,this.ioa));
this.qg.xD(bb.a.click,P,this.aFa.bind(this),b);return P}Yyd(){const b=Object.assign(new jm.a,{action:1,type:5,aA:null,jJ:this.Zca});this.Zca=null;this.vV.QE(b)}dB(b,h){this.Zca&&(h.a_a.Bf.classList.contains("BookmarkHighlightSelected")||this.Yyd())}onMouseEnter(b){if(null==b)return!1;b=b.Bf;b.parentElement.classList.add(jt.aCg);b.src=Yl.a.Yh(jt.zFj);return!0}ioa(b){if(null==b)return!1;b=b.Bf;b.parentElement.classList.remove(jt.aCg);b.src=Yl.a.Yh(jt.W$c);return!0}aFa(b){this.p4a(this.vNg,this.GOj);
if(null==b){var h=new Map;h.set("Source",this.cIa);h=Object.assign(new Ya.a,{additionalValues:h});Ta.Health.instance.recordKpiFailure(this.vNg,"Unable to highlight bookmarked content",!1,!0,h);return!1}r.AFrameworkApplication.Ce("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.xFj){h=b.Lo.context;if(jt.d2a(h,this.Zca))return!0;h=this.mjf(b.Lo.FJf,h,b.Lo.container);b=Object.assign(new jm.a,{action:0,type:5,aA:h,jJ:this.Zca});this.Zca=h;this.vV.QE(b);return!0}return!1}mjf(b,h,u){h={Klh:new Set,
aJb:new Set,Nlh:null,OXe:null};const y=this.eb.Yv(b.yb,!0,!1),P=[];if(y)for(const aa of y)P.push(aa);this.ubk(b,h,P);h=new vF(P,u,h.Klh,h.aJb,h.Nlh,h.OXe);this.Zca&&this.Zca.Pq===P&&(u.className+=String.format(" {0}",jt.AFj),this.Zca=h);return h}ubk(b,h,u){r.AFrameworkApplication.Ce("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf");if(this.L5g&&b.Lj){const P=new Set;for(const aa of b.kg.pi)aa.querySelectorAll("*").forEach(P.add,P);b=Array.from(P.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),
0);let y=[];h.aJb.add(u[0].id);h.Nlh=u[0].id;h.OXe=u[0].id;b.forEach(P=>{const aa=Bh.a.Db(P,ko.a.Uwd);if(aa)for(const ta of aa)y.push(ta),h.Klh.add(ta);if(!y.length)return!0;P=Bh.a.Db(P,ko.a.myb);if(!P)return!0;y=HJ.a.nec(y,P)});for(b=this.eb.Tg(u[u.length-1],!1,!0);y.length&&b;)h.aJb.add(b.id),h.OXe=b.id,u.push(b),this.kba.value.gh(b).htmlElement.querySelectorAll("."+ko.a.NXe).forEach(P=>{(P=Bh.a.Db(P,ko.a.myb))&&(y=HJ.a.nec(y,P))}),b=this.eb.Tg(b,!1,!0)}p4a(b,h){const u=new Map;u.set("Source",this.cIa);
u.set("Action",h);Ta.Health.instance.recordKpiUsage(b,0,this.MUa,u)}static d2a(b,h){return!!h&&!!b&&b.Hlh===h.Hlh}}jt.aCg="WordBookmarkIndicatorContainerHovered";jt.AFj="WordBookmarkIndicatorContainerSelected";jt.W$c="BookmarkDefault.png";jt.zFj="BookmarkHover.png";jt.MLe=!0;jt.Bne="WordBookmarkIndicatorContainer";jt.FFj="WordBookmarkSvgIndicatorContainer";Object(m.a)(jt,"BookmarkIndicatorActor",Eo.a,[287]);class IJ{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb=null,Sb=null,Yb=null,Ac=null,Sc=null,nd=null,
Ad=null){this.u1="_";this.fne="Bookmark";this.$Ej=/^BOOKMARK\d+$/i;this.cIa="BookmarkRibbonOptions";this.vFj="BookmarkFloatieOptions";this.IFg="CreateBookmarkOnRange";this.JFg="CreateBookmarkOnView";this.HFg="CreateBookmarkOnIP";this.tqe="CreateBookmark";this.MUa="wwaengidc";this.b6g="ShowHideBookmarksOnDocument";this.TGg="DeleteBookmark";this.qJj="DeleteBookmarkAction";this.A2j="ShowHideBookmarks";this.a6g="ShowBookmarksFloatie";this.x2j="ShowBookmarksFloatieAction";this.uIg="EditBookmark";this.rKj=
"EditBookmarkAction";this.fCc="BookmarksUsage";this.tsk="InsertTabSwitchActivity";this.$gm="Insert";this.YPb=b;this.ga=h;this.ib=u;this.ul=y;this.Ex=P;this.A5=aa;this.Ic=ta;this.cL=Pa;this.Zq=Sb;this.$Bg=vb;this.He=Kb;this.i5=Sc;this.ro=Yb;this.fd=Ac;this.uB=nd;this.Tk=Ad}get fy(){return this.Ex.value}Wb(){this.buf()&&(this.ga.pa(Rc.a.vMa,oc.a.view,this.vMa.bind(this)),this.ga.gb(Wa.a.ySa,oc.a.application,this.Dpo.bind(this),96),this.ga.pa(Rc.a.vMa,oc.a.Fd,this.zRk.bind(this)),this.ga.pa(Rc.a.vMa,
oc.a.Vc,this.yRk.bind(this)),this.ga.pa(Rc.a.deleteBookmark,oc.a.view,this.deleteBookmark.bind(this)),this.ga.pa(Rc.a.p$e,oc.a.view,this.E9k.bind(this)),this.ga.gb(Rc.a.Daj,oc.a.view,this.u$n.bind(this),1028),this.ga.gb(Rc.a.F5d,oc.a.application,this.F5d.bind(this),96),this.ga.gb(Rc.a.dce,oc.a.Vc,this.dce.bind(this),1028),this.ga.gb(Oa.a.sWd,oc.a.view,this.sWd.bind(this),1028),this.ga.gb(Rc.a.BPd,oc.a.view,this.BPd.bind(this),1028),this.ga.Xc(Rc.a.vMa,1028))}Dpo(b,h,u,y,P){return P&&P.NewContextId===
this.$gm?(this.cac(this.tsk),32):2}vMa(b,h,u,y,P){var aa,ta;b=this.ib.Lg;if(!b||b.contextId===oc.a.anchoredObject)return 2;if(1===u)return Ye.a.dga(h)||Fj.a.IAd&&(null===(aa=this.Tk)||void 0===aa?0:aa.xZ(b))||(null===(ta=this.Tk)||void 0===ta?0:ta.uva(b))?8:32;h=this.ib.hb.kb;if(!h||this.He.om(h))return 2;this.pUc(P,"User is trying to create bookmark from UILocation : {0}");this.p4a(this.JFg,this.tqe);if(h&&this.ul.lud(this.yNa(),h))return this.cac(this.fCc),32;P=new Map;P.set("Source",this.cIa);
P=Object.assign(new Ya.a,{additionalValues:P});Ta.Health.instance.recordKpiFailure(this.JFg,"Unable to create bookmark",!1,!0,P);return 8}zRk(b,h,u,y,P){if(1===u)return 32;if(oc.a.Fd!==h.contextId)return 8;this.pUc(P,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.kb;if(!b)return 2;this.p4a(this.IFg,this.tqe);if(this.ul.lud(this.yNa(),b))return this.cac(this.fCc),32;b=new Map;b.set("Source",this.cIa);b=Object.assign(new Ya.a,{additionalValues:b});Ta.Health.instance.recordKpiFailure(this.IFg,
"Unable to create bookmark for range",!1,!0,b);return 8}yRk(b,h,u,y,P){if(1===u)return 32;if(oc.a.Vc!==h.contextId)return 8;this.pUc(P,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.kb;if(!b)return 2;this.He.om(b)&&(h=b.Qa,this.He.Rib(h)?(b=this.He.Q2(h,!1),b||(w.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.He.Q2(h,!0))):w.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.p4a(this.HFg,
this.tqe);if(this.ul.lud(this.yNa(),b))return this.cac(this.fCc),32;b=new Map;b.set("Source",this.cIa);b=Object.assign(new Ya.a,{additionalValues:b});Ta.Health.instance.recordKpiFailure(this.HFg,"Unable to create bookmark for IP",!1,!0,b);return 8}F5d(b,h,u,y,P){1===u&&32;P[ag.a.On]=jt.MLe;return 32}u$n(b,h,u,y,P){if(1===u)return 32;this.p4a(this.b6g,this.A2j);(b=P[ag.a.On])||w.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");jt.MLe=b;b=xl.PageNavigator.instance.dQ(this.fy);
if(null!==b)return this.m_c(b),this.YPb.xG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.cIa);b=Object.assign(new Ya.a,{additionalValues:b});Ta.Health.instance.recordKpiFailure(this.b6g,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,u,y,P){if(this.buf()){b=this.ib.hb.kb;if(!b)return 2;b=b.Qa;b=this.ul.JKc(b.node,b.cpBegin);if(1===u)return b?32:8;this.pUc(P,"User is trying to delete bookmark from UILocation : {0}");this.cL.c_&&(w.ULS.sendTraceTag(545118155,
3029,50,"Dismissing the bookmarks floatie"),this.cL.Ew());this.p4a(this.TGg,this.qJj);b||w.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.ul.VWf(b.id))return this.$Bg&&this.$Bg.Yyd(),this.cac(this.fCc),32;u=new Map;u.set("Source",this.cIa);u=Object.assign(new Ya.a,{additionalValues:u});Ta.Health.instance.recordKpiFailure(this.TGg,"Unable to delete bookmark",!1,!0,u);return 8}return 2}E9k(b,h,u,y,P){if(r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.ib.hb.kb;if(!b)return 2;b=b.Qa;b=this.ul.JKc(b.node,b.cpBegin);if(1===u)return b?32:8;this.pUc(P,"User is trying to edit bookmark from UILocation : {0}");this.cL.c_&&(w.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.cL.Ew());this.p4a(this.uIg,this.rKj);b||w.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");
if(b)return this.i5.value.F9k(h,b,this.ul),this.cac(this.fCc),32;h=new Map;h.set("Source",this.cIa);h=Object.assign(new Ya.a,{additionalValues:h});Ta.Health.instance.recordKpiFailure(this.uIg,"Unable to edit bookmark",!1,!0,h);return 8}return 2}pUc(b,h){b&&b.UILocation&&w.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}dce(b,h,u,y,P){if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===u&&32;this.p4a(this.a6g,this.x2j);
if(h.contextId===oc.a.Vc)return b=Array(1),b.push("Bookmarks"),this.cL.showFloatie(P.location,b,1),32;P=new Map;P.set("Source",this.vFj);P=Object.assign(new Ya.a,{additionalValues:P});Ta.Health.instance.recordKpiFailure(this.a6g,"Unable to show bookmark floatie",!1,!0,P);return 8}return 2}sWd(b,h,u,y,P){let aa;return 1===u?(fq.a.instance.Sd(()=>{aa=this.ga.Tf(h,Oa.a.insertHyperlink,u,!0,y,P);32!==aa&&(aa=this.ga.Tf(h,Rc.a.vMa,u,!0,y,P))},"BA:LFE"),aa):8}BPd(b,h,u){var y;if(1===u)return 32;if(b=this.ib.hb.kb){b=
b.Qa.node;if(h=this.WLh(b))return h.click(),32;w.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.ul.JKc(b,0)){b=this.uB.Ska.get(null===(y=b.id)||void 0===y?void 0:y.toString());y=xl.PageNavigator.instance.dQ(this.fy).Jc.Db(b);if(y=this.WLh(y))return y.click(),32;w.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else w.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}WLh(b){let h;
b=this.ro.fl(b).gh(this.fd.od.Sb);b.oFb&&(b=b.htmlElement.querySelectorAll("div."+jt.Bne),0<b.length&&(h=b[0]));return h}m_c(b){const h=vG.b(b);if(h){var u=this.Ic.Qc(2);try{for(u.Eb(b);h.moveNext();){if(!be.ParagraphReader.rh(h.iterator))continue;const y=h.currentNode;this.H8k(y)&&this.A5.J7b(y,!0)}}finally{u&&u.dispose()}}}H8k(b){for(let u=0;u<b.qa.length;u++){const y=b.qa.J(u);if(null!=y.Ph)for(let P=0;P<y.Ph.length;P++){var h=y.Ph.J(P);if(null!=h&&(h=b.Jc.Db(h.an).ia(Lc.a.at,""),!A.a.kf(h)&&!h.startsWith(this.u1)))return!0}}}yNa(){var b=
this.ul.LJc(!1);const h=[];for(let u=0;u<b.count;u++){const y=b.J(u).ia(Lc.a.at,"");this.$Ej.test(y)&&h.push(y)}return 0<h.length?(h.sort((u,y)=>u.localeCompare(y,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.fne.length)),this.fne+(b+1)):this.fne+1}p4a(b,h){const u=new Map;u.set("Source",this.cIa);u.set("Action",h);Ta.Health.instance.recordKpiUsage(b,0,this.MUa,u)}cac(b){this.buf()&&this.Zq&&this.Zq.execute(h=>{h.logActivity(b,null)})}buf(){r.AFrameworkApplication.Ce("bookmarks-core-ex;bookmarks-core-ex-cf");
return r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(m.a)(IJ,"BookmarkActor",null,[]);class JJ{constructor(b,h,u){this.Bc=b;this.k4k=h;this.Uf=u;this.n1e=this.n1e.bind(this)}Wb(){this.Bc.pa(Rc.a.HAf,oc.a.view,this.n1e)}n1e(b,h,u,y,P){return 1===u?32:(b=this.Uf.i7(h.Yj))?(P=3===P.ox,this.k4k.value.Yyh(this.kQl(b),this.wZl(b),P),32):2}kQl(b){const h=new uh.DictionaryPropertySet;h.setValue(Yi.a.fE,this.Uf.Wg(b));
h.setValue(Yi.a.zF,this.Uf.tfa(b));h.setValue(Yi.a.hla,this.Uf.Zfb(b));h.setValue(Yi.a.separator,this.Uf.vMd(b));return h}wZl(b){const h=new uh.DictionaryPropertySet;h.setValue(Lc.a.marginLeft,this.Uf.JI(b));h.setValue(Lc.a.marginRight,this.Uf.sK(b));h.setValue(Lc.a.Ao,this.Uf.Pt(b));return h}}Object(m.a)(JJ,"ColumnsDialogActor",null,[]);class KJ{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){this.Yo=b;this.ara=h;this.ze=u;this.Pr=y;this.zm=P;this.Rd=aa;this.Ic=ta;this.me=Pa;this.ga=vb;this.WQj=Kb;this.qAe=
Sb}get Imm(){return this.WQj}Wb(){this.ga.gb(Oa.a.P3c,oc.a.view,this.Ffm.bind(this),96);this.ga.gb(Oa.a.V_c,oc.a.view,this.V_c.bind(this),4)}Ffm(b,h,u,y,P){h=this.Yo.getById(P);if(!h)return 8;u=h.contentControlNode;if(!u)return 8;if(u.ia(Lc.a.y6,!1))return 2;y=this.Yo.Pxl(h);if(!y)return 8;P=this.Ic.Qc(7);P.Eb(y.node);if(!this.Imm)return(b=h.k4d)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Rd.replaceTextRange(y,b),this.cwd(h),u.setValue(Lc.a.y6,!0),P.dispose(),32;const aa=
new uh.DictionaryPropertySet;aa.setValue(ld.a.b8h,y);var ta=u.ia(Lc.a.K2e,"");ta=this.ara.k7h(ta);if(!ta)return this.Pr.replaceTextRange(y,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Fj.a.er?b:void 0),this.cwd(h),u.setValue(Lc.a.y6,!0),P.dispose(),32;aa.setValue(ld.a.qof,ta);if(1<ta.length&&!h.Yf)return P.dispose(),8;this.bQk(aa);u.setValue(Lc.a.y6,!0);P.dispose();return 32}V_c(b,h,u){var y=h.view.ue?h.view:null;if(!y||!y.Bb)return 8;if(Fj.a.BNk)return this.WCn(y,u);h=y.Bb.hb.J(0);
b=this.zm.saa(h.Qa,h.Tc,1);if(!b||0==b.count)return 8;var P=this.zm.saa(h.Qa,h.Tc,3);h=new Fh.a;if(P&&0<P.count){for(var aa of P)h.add(aa.id,aa);for(aa=b.count-1;0<=aa;aa--)h.ub(b.J(aa).id)&&b.removeAt(aa);0==b.count&&(aa=P.J(0),b.add(aa))}for(aa=0;aa<b.count;aa++)P=b.J(aa),h.add(P.id,P);if(1===u){for(u=b.count-1;0<=u;u--)if(y=b.J(u),aa=h.J(y.parentId),this.xSd(y,aa))return 32;return 8}if(2===u){u=this.Ic.Qc(15);u.Eb(y.jd);for(y=b.count-1;0<=y;y--)aa=b.J(y),P=h.J(aa.parentId),this.xSd(aa,P)&&this.Yo.Tlb(aa.id);
u.dispose();return 32}return 2}WCn(b,h){const [u,y]=this.mTl(b.Bb.hb);if(0===u.length)return 8;if(1===h){for(var P of u){var aa=y.get(P.parentId);if(this.xSd(P,aa))return 32}return 8}if(2===h){h=this.Aco(u,y);P=this.Ic.Qc(15);P.Eb(b.jd);for(aa of h)b=y.get(aa.parentId),this.xSd(aa,b)&&this.Yo.Tlb(aa.id);P.dispose();return 32}return 2}mTl(b){var h,u,y=[];for(const aa of b)y.push(...(null!==(h=this.zm.saa(aa.Qa,aa.Tc,1))&&void 0!==h?h:[]));if(0===y.length)return[y,new Map];h=[];for(const aa of b)h.push(...(null!==
(u=this.zm.saa(aa.Qa,aa.Tc,3))&&void 0!==u?u:[]));b=new Map(y.map(aa=>[aa.id,aa]));if(0===h.length)return[y,b];const P=new Map(h.map(aa=>[aa.id,aa]));y=y.filter(aa=>!P.has(aa.id));b=new Map([...b,...P]);return 0==y.length?[[h[0]],b]:[y,b]}cwd(b){const h=this.Pr.sLd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);h?this.qAe&&(b=this.me.jx(b.start.node).fh("Placeholder Text"))&&(this.ze.dla(h.formatting),this.ze.$mb(h.formatting,b)):w.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}bQk(b){this.ga.Ub(Oa.a.showPlaceholderGlossary,
2,b)}xSd(b,h){return b.Yfa&&b.Jum&&(!h||h.isEditable)}Aco(b,h){const u=(y,P)=>null==y||null==P||y.id===P.id?!1:y.id===P.parentId||u(h.get(y.parentId),P);return b.slice().sort((y,P)=>u(y,P)?1:u(P,y)?-1:0)}}Object(m.a)(KJ,"ContentControlActor",null,[]);class EE{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.thk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it",
"status updates. Thank you."];this.Gmo="Interested in this feature?"}Wb(){this.ga.pa(Rc.a.x6e,oc.a.view,this.Qim.bind(this))}Qim(b,h,u){2===u&&(Object(Ub.c)(Rc.a.x6e),b=new Gh.StandardDialog,b.Ed=4,b.Ue(1,this.primaryButtonText),b.Ue(2,this.secondaryButtonText),b.mAc(this.thk,null),b.xv(this.Gmo,null,0,this.daa));return 32}daa(b){1===b&&(Object(Ub.a)("CountMeIn_CustomizeRibbon",!0),A.a.tX(EE.crj)&&Je.a.en(EE.crj))}}EE.crj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";
Object(m.a)(EE,"CustomizeRibbonActor",null,[]);var JA=c(1048);class wG extends ff.a{constructor(b,h,u){super(!1,!1,!0);this.BUg=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,JA.a.EUe,JA.a.DUe,JA.a.FUe];this.qEj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,JA.a.Hik,JA.a.Gik,JA.a.Jik];this.tAg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.$gc=()=>{new wG(this.ga,this.HNe,this.noc)};this.xGl=
()=>{const y=[];for(const P of this.HNe)y.push(this.B4(P));return y};this.QAo=y=>{const P=new Set;this.Oqa="";for(const aa of y)if(""!==aa.position){const ta=this.t0h(aa.position);if(0>ta||22<ta){this.Oqa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(P.has(ta)){this.Oqa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.Wmo(aa)),P.add(ta)}else{this.Oqa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Oqa&&
(this._tabStops=[],this.HNe=y)};this.LZk=(y,P)=>{try{if(1===y){if(""!==this.Oqa)throw Error.create(this.Oqa);P.DefaultTabStop&&(this.noc=JA.a.w_f(P.DefaultTabStop),this.gEo(this.noc));if(32!==this.ga.Ub(Rc.a.COb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Xf.a.Xy(this.noc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(aa){this.wxa(aa.message,this.$gc)}};this.ga=b;this.HNe=h;this._tabStops=[];this.noc=u;this.Oqa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.ZJc()};
this.Wh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.LZk,b)}B4(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}t0h(b){return Math.floor(100*parseFloat(b))/100}Wmo(b){return new Nn.a(Xf.a.Xy(this.t0h(b.position)),JA.a.MVl(b.alignment),JA.a.KVl(b.leader),1)}gEo(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Ub(Oa.a.KFa,2,h)){var u=h.marginLeft;const y=Bf.a.Mi(h.marginRight,0);u=Bf.a.Mi(u,0);
h=Bf.a.Mi(h.Ao,0);if(Bf.a.p7(b,0,!1)>=h-y-u)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}ZJc(){return{["getInitState"]:this.xGl,["updateState"]:this.QAo,["validPositions"]:this.G4h(-Infinity,Infinity,"Position"),["validAlignments"]:this.sUh(this.tAg,this.tAg,null,"Alignment"),["validLeaders"]:this.sUh(this.BUg,this.BUg,this.qEj,"Leader"),["defaultTabStopSpinButtonProps"]:this.G4h(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.noc,["DefaultTabStop"]:"DefaultTabStop",
["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,
["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}G4h(b,h,u){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:u,["unitType"]:"Inch",["validUnits"]:[AB("Inch",3,b,h,.1)],["numberFormatInfo"]:cG()}}sUh(b,h,u,y){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:y,["options"]:lF(b,h,u)}}}Object(m.a)(wG,"CustomTabDialog",
ff.a,[]);class LJ{constructor(b,h,u){this.Rac=(y,P,aa,ta,Pa)=>{if(2!==aa)return 8;if(!Pa)return 16;y=Pa.tabStop;Pa=Pa.value;if(!y)return 16;Ub.c(Rc.a.Rac);Pa=new Nn.a(Pa,y.Bca,y.Pna,y.W8f);P=P.node;this.$ya.x4a(P,y);this.$ya.MQd(P,Pa);return 32};this.t2c=(y,P,aa,ta,Pa)=>{if(2===aa){if(!Pa)return 16;this.$ya.MQd(P.node,Pa);return 32}return 8};this.aKb=(y,P,aa,ta,Pa)=>{y=this.$ya.wRi(P.node);if(!("customTabs"in Pa))return Pa.customTabs=y,32;P=Pa.customTabs;if(!P||0>=P.length||!y||0>=y.length)return Pa.customTabs=
null,32;aa=[];for(const vb of P)for(const Kb of y)if(Kb.NGa===vb.NGa&&Kb.W8f===vb.W8f&&Kb.Bca===vb.Bca){aa.push(vb);break}Pa.customTabs=aa;return 32};this.x4a=(y,P,aa,ta,Pa)=>{if(2===aa){if(!Pa)return 16;Ub.c(Rc.a.x4a);this.$ya.x4a(P.node,Pa);return 32}return 8};this.NKb=(y,P)=>{this.$ya.NKb(P.node);return 32};this.COb=(y,P,aa,ta,Pa)=>{if(2===aa){if(!Pa)return 16;y=Pa.tabStops;aa=Pa.defaultTabStopLength;P=P.node;ta=!1;const vb=this.$ya.QHn(P,y);Pa.defaultTabStopLengthSaved||(ta=this.TJ.KWn(P,aa),
Pa.defaultTabStopLengthSaved=!0);vb&&Ub.d(Rc.a.COb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Custom Tab Stops Count",string:y.length.toString()})]);if(null==ta)return w.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ta&&(this.w0c&&this.w0c.Mfi(),this.Kd.Ds(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Ub.d(Rc.a.COb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Default Tab Stop Length",string:aa.toString()})]));
return 32}return 8};this.Oaj=(y,P,aa)=>{if(2!==aa)return 8;y={};if(32!==this.ga.Ub(Rc.a.ZN,2,y))return w.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;P={};if(32!==this.ga.Ub(Oa.a.KFa,2,P))return w.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;y=JA.a.w_f(Xf.a.pz(y.defaultTabStop));aa={};aa.defaultTabStopLength=y;aa.sectionPropertiesData=P;if(32!==this.ga.Ub(Rc.a.neg,2,aa))return w.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),
16;if(!aa.isParagraphValid)return w.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.$ya.wxa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;P={};if(32!==this.ga.Ub(Rc.a.aKb,2,P))return w.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(P=P.customTabs)||(P=[]);P=JA.a.LVl(P);new wG(this.ga,P,y);Ub.c(Rc.a.$gc,!0);return 32};this.stm=(y,P,aa,ta,Pa)=>{if(2!==aa)return 8;if(!Pa)return 16;if(Pa.isParagraphValid)return 32;
aa={};if(32!==this.ga.Tf(P,Oa.a.j4a,2,!1,null,aa))return 16;y=Pa.sectionPropertiesData;P=Pa.defaultTabStopLength;var vb=aa.it;ta=vb.Zma;vb=1===vb.specialIndentType?vb.UA:vb.UA-vb.wca;const Kb=y.marginLeft,Sb=y.marginRight;aa.isRtl?(aa=Bf.a.Mi(Math.max(Sb,Sb+ta),0),ta=Bf.a.Mi(Math.max(Kb,Kb+vb),0)):(aa=Bf.a.Mi(Math.max(Kb,Kb+vb),0),ta=Bf.a.Mi(Math.max(Sb,Sb+ta),0));y=Bf.a.Mi(y.Ao,0);P=Bf.a.p7(P,0,!1);Pa.isParagraphValid=P<y-aa-ta;return 32};this.ga=b;this.$ya=h;this.TJ=u}get Kd(){return null!=this.Qxg?
this.Qxg:this.Qxg=Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get w0c(){return null!=this.Evg?this.Evg:this.Evg=Ja.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}Wb(){const b=u=>Ct.OutlineElementGeneralizer.ima(u.hb,!0),h=Ra.App.GSa.aFc(b,!0);this.ga.pa(Rc.a.aKb,oc.a.view,Ra.App.GSa.aFc(b,!1));this.ga.gb(Rc.a.aKb,oc.a.paragraph,this.aKb,96);this.ga.pa(Rc.a.x4a,oc.a.view,h);this.ga.gb(Rc.a.x4a,oc.a.paragraph,this.x4a,96);this.ga.pa(Rc.a.NKb,oc.a.view,
h);this.ga.gb(Rc.a.NKb,oc.a.paragraph,this.NKb,96);this.ga.pa(Rc.a.t2c,oc.a.view,h);this.ga.gb(Rc.a.t2c,oc.a.paragraph,this.t2c,96);this.ga.pa(Rc.a.Rac,oc.a.view,h);this.ga.gb(Rc.a.Rac,oc.a.paragraph,this.Rac,96);this.ga.pa(Rc.a.COb,oc.a.view,h);this.ga.gb(Rc.a.COb,oc.a.paragraph,this.COb,96);this.ga.pa(Rc.a.neg,oc.a.view,h);this.ga.gb(Rc.a.neg,oc.a.paragraph,this.stm,96);this.ga.pa(Rc.a.$gc,oc.a.view,this.Oaj);this.ga.pa(Rc.a.Aei,oc.a.view,this.Oaj)}}Object(m.a)(LJ,"CustomTabActor",null,[]);var FM=
c(129),DF=c(636);class MJ{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.ga=b;this.ktd=u;this.gIa=(this.$Wb=P)&&y;this.mo=aa;this.VV=ta;this.TIj=Pa;this.Tw=vb;this.nEj=h;this.$Wb&&fh.a("isSharedUXDarkModeOn")?(this.mo.jK=appChrome.api.isSharedUXDarkModeOn(),this.wui(!0)):this.mo.jK=!1;this.gIa?this.fti(!0):this.mo.wSa=!1;r.AFrameworkApplication.rJ(()=>{this.sWc()});this.gIa&&fh.a("dispatch")&&appChrome.api.dispatch(this.fgj([]))}Wb(){this.gIa&&(this.ga.pa(Rc.a.lno,oc.a.view,this.$Zk.bind(this)),this.ga.pa(Rc.a.q3c,
oc.a.view,this.q3c.bind(this)),this.ga.gb(Rc.a.PZc,oc.a.view,this.PZc.bind(this),96));this.$Wb&&(this.ga.pa(Rc.a.vbe,oc.a.view,this.vbe.bind(this)),this.ga.gb(Rc.a.s6d,oc.a.view,this.s6d.bind(this),96))}Eim(b){if(!this.y6n(b))return!1;const h=oi.a.instance.Qc(2);try{h.Eb(b.root);const u=yd.GraphIterator.$a(b.root.graphNode),y=tj.a.lq(u);for(;y.moveNext();){const P=Object(na.a)(FM.a,y.currentNode);P&&P.bG(b.Sb,20,!0)}}finally{h&&h.dispose()}return!0}y6n(b){return b&&b.root&&b.$r?b.mi||b.Svf||b.wji||
b.Kj:!1}JJn(){let b=!1;this.ktd.forEach(h=>{this.Eim(h)&&(b=!0)});return b}mno(){w.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.mo.jK?"dark":"light");return this.mo.jK?DF.a.sAc(1):DF.a.CUi(1)}S$f(){const b=this.mo.Aea;w.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.JJn()||(b?!DF.a.sAc(0):!DF.a.CUi(0)))return!1;this.TIj.Orn(b);return!0}fgj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.mo.jK));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.i5h(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.mo.wSa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):w.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){w.ULS.sendTraceTag(527282835,3023,10,h)}return b}$Zk(){return this.S$f()?
32:8}vbe(b,h,u){if(1===u)return 32;b=this.VV.jg("UserAction","sharedUXDarkModeToggle");if(fh.a("toggleSharedUXDarkMode"))w.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),fh.a("isSharedUXDarkModeOn")?this.mo.jK=appChrome.api.isSharedUXDarkModeOn():this.mo.jK=!this.mo.jK,w.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.mo.jK);else return 8;appChrome.getHeaderApi().then(y=>{y.hasOwnProperty("refreshThemeOverride")&&
y.refreshThemeOverride()});this.mno()||w.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.gIa&&!this.mo.wSa&&(this.S$f()||w.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Ra.App.xa.xG(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.mo.jK));this.gIa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.mo.jK));b.stop();w.ULS.sendTraceTag(555885377,3023,50,"{0}",b.vi);Ub.b(this.mo.jK?"DarkModeOn":"DarkModeOff");return 32}q3c(b,h,u){if(1===u)return 32;b=this.VV.jg("UserAction","sharedUXDarkModeSwitchBackground");w.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.mo.wSa=!this.mo.wSa;if(!this.S$f())return 8;h={};h.DarkModeSwitchBackground=this.Tw?"ButtonModel":"ToggleButtonModel";Ra.App.xa.xG(h);b.stop();w.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.vi);w.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.mo.wSa);Ub.b(this.mo.wSa?"DarkCanvasOff":"DarkCanvasOn");return 32}s6d(b,h,u,y,P){if(1===u)return 32;if(!P)return 2;fh.a("isSharedUXDarkModeOn")&&(this.mo.jK=appChrome.api.isSharedUXDarkModeOn());P&&(P[ag.a.On]=this.mo.jK);return 32}PZc(b,h,u,y,P){if(1===u)return 32;if(!P)return 2;!this.Tw&&P&&(P[ag.a.On]=this.mo.wSa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.mo.jK));
this.gIa&&this.fgj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.i5h(!1)));appChrome.api.dispatch(b);return 32}i5h(b){const h={};this.mo.wSa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}sWc(){this.$Wb&&this.wui(!1);this.gIa&&this.fti(!1)}wui(b){var h;w.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.mo.jK?"dark":"light",this.mo.nCa);b&&this.mo.jK!=(null===(h=this.nEj)||void 0===h?void 0:h.$("DarkModeIsOn"))&&w.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.mo.jK?"dark":"light",this.mo.nCa)}fti(b){w.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.mo.Aea?"dark":"light",this.mo.ZZk)}}Object(m.a)(MJ,"DarkModeActor",null,[]);var NJ=c(1546);
class EF{constructor(){this.Height=this.Width=0}static construct(b,h){const u=new EF;u.Width=b;u.Height=h;return u}}Object(m.a)(EF,"ViewportInfo",null,[]);class xG extends dk.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}el(){return 85}static construct(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){const Yb=new xG;Yb.ContractVersion=b;
Yb.DocumentContent=h;Yb.EnhancementId=u;Yb.World=y;Yb.ScalingFactor=P;Yb.DesktopViewportInfo=EF.construct(aa,ta);Yb.MobileViewportInfo=EF.construct(Pa,vb);Yb.MinParagraphCount=Kb;Yb.ContentCulture=Sb;return Yb}}Object(m.a)(xG,"SwayPreviewRequest",dk.a,[]);var GM=c(599);class GD{static get Hg(){return ff.a.Sy(GD.am,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,
GD.ROn,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}GD.ROn=Yl.a.Yh("progress.gif");GD.am="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(m.a)(GD,"DigitalPrintDialogHtml",null,[]);class ix{constructor(b,h,u,y){this.fontFamily=b;this.Z0c=h;this.fontWeight=u;this.fontStyle=y}}Object(m.a)(ix,"FontInfo",null,[]);class kt{constructor(b,h,u,y){this.styleName=b;this.title=h;this.Fmo=u;this.L7l=y}}Object(m.a)(kt,"StyleVisualInfo",null,[]);class MC extends ff.a{constructor(b,h,u,y,P=!0){super();this.u5=this.uo=this.Fja=this.D1=this.Afd=this.D7g=this.jrd=this.yNe=this.zNe=this.QMe=this.uXb=this.XKa=this.U1=this.NWb=null;this.mQe=this.RIe=
!1;this.sed=null;this.j8k=()=>{this.i1i(0)};this.i8k=(aa,ta)=>{this.i1i(ta)};this.LHi=aa=>{this.vZh(aa)===Sys.UI.Key.enter&&(this.sNf(aa),aa.preventDefault(),aa.stopPropagation())};this.gEi=aa=>{((aa=aa.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===aa.id||aa.id===Kh.a.V9c)||ba.a.kt)&&this.XKa&&this.bMb(this.XKa)};this.hEi=aa=>{const ta=this.vZh(aa);ta!==Sys.UI.Key.tab&&ta!==Sys.UI.Key.left&&ta!==Sys.UI.Key.right&&ta!==Sys.UI.Key.up&&ta!==Sys.UI.Key.down||this.J4l(ta)||(aa.preventDefault(),
aa.stopPropagation(),this.i4m(ta))};this.xLf=()=>{this.mQe||(this.mQe=!0,w.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),rf.a.removeHandler(this.U1,bb.a.scroll,this.xLf))};this.eMf=()=>{w.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.sNf=aa=>{aa.preventDefault();aa.stopPropagation();r.AFrameworkApplication.ya.processAction(Oa.a.HFh,2);aa.target?(aa="button"===aa.target.tagName.toLowerCase()?aa.target:aa.target.parentNode)&&aa.id!==this.NWb&&(w.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.NWb,aa.id),this.Qqh(aa),this.OAh()):w.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.R4k=aa=>{const ta=(new Date).getTime()-this.pHg;eh.a.instance.Wf(jh.a.T4k,ta);aa?this.CTn():(w.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),r.AFrameworkApplication.ya.processAction(Oa.a.GFh,2))};
this.ATn=()=>{this.Gao();try{const aa=MC.ZGh.sfl(),ta=xG.construct(2,aa,this.NWb,"VerticalWorld",.3,1366,600,330,280,20,MC.ZGh.qRb.name);r.AFrameworkApplication.Ve.qj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Ra.App.webServiceBase,r.AFrameworkApplication.rootQuerySignature),2,GM.b(ta),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.Wkn,this.ENi,ta)}catch(aa){w.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",aa.message)}};
this.Wkn=aa=>{var ta=null;({group:ta}=je.a.q0(aa.data.Ae)).returnValue?(ta=ta.Responses[0],ta.Succeeded?(this.dYd(aa.data,jh.a.lio),this.ndb(),this.Z6i(this.yNe,ta.PreviewHtml),this.Z6i(this.jrd,ta.PreviewHtmlMobile)):this.ENi(null)):w.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.ENi=()=>{this.Hao();this.zNe.style.background="#E6E6E6";this.D7g.style.background="#E6E6E6"};this.Hg=GD.Hg;this.mg="DigitalPrintDialog";w.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.PZj=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.XRb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.$3j=u;this.Upc=y;this.Ue(1,this.PZj);this.Wh(this.XRb,this.R4k,null);this.rdm();this.Tgo();this.pHg=(new Date).getTime();P&&Lv.a.VP(14,!1,this.j8k,this.i8k,null);this.Aem();this.Sbm();this.PEm();this.WBf();this.GEm();this.OAh()}get uua(){return this.sed}i1i(b){if(!this.RIe){const h=
(new Date).getTime()-this.pHg;eh.a.instance.Wf(jh.a.S4k,h);b?w.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Th.a[b])):w.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.nYa.disabled=!1}}rdm(){this.uXb=document.getElementById("digitalPrintStatusMessageDiv");this.QMe=document.getElementById("digitalPrintStatusMessageIconDiv");this.zNe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.yNe=document.getElementById("swayDesktopPreviewHtmlHolder");this.jrd=document.getElementById("swayMobilePreviewHtmlHolder");this.D7g=document.getElementById("swayMobilePreviewWrapperDiv");this.U1=document.getElementById("swayGallery");this.U1.setAttribute("tabindex","0");rf.a.addHandler(this.U1,bb.a.scroll,this.xLf);this.U1.setAttribute(hf.a.wh,hf.a.Jjh);this.D1=document.getElementById("digitalPrintLearnMoreLink");this.D1.href="https://go.microsoft.com/fwlink/?linkid=871972";rf.a.addHandler(this.D1,
bb.a.click,this.eMf);this.Fja=new ob.a;this.Afd=document.getElementById("homeWrapper");this.k4("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Upc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}Aem(){this.uo=new ob.a;this.uo.add(new kt("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.uo.add(new kt("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.uo.add(new kt("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.uo.add(new kt("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.uo.add(new kt("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.uo.add(new kt("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.uo.add(new kt("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.uo.add(new kt("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.uo.add(new kt("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.uo.add(new kt("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.uo.add(new kt("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.uo.add(new kt("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.uo.add(new kt("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.uo.add(new kt("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.uo.add(new kt("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.uo.add(new kt("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.uo.add(new kt("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.uo.add(new kt("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.uo.add(new kt("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.uo.add(new kt("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.uo.add(new kt("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.uo.add(new kt("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}Sbm(){this.u5=
new ob.a;this.u5.add(new ix("universc","universc","normal","normal"));this.u5.add(new ix("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.u5.add(new ix("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.u5.add(new ix("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.u5.add(new ix("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.u5.add(new ix("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.u5.add(new ix("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.u5.add(new ix("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.u5.add(new ix("ArialNova","ArialNova","normal","normal"));this.u5.add(new ix("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.u5.add(new ix("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.u5.add(new ix("RockwellNova","RockwellNova","normal","normal"));
this.u5.add(new ix("SabonNRegLT","SabonNRegLT","normal","normal"));this.u5.add(new ix("DaytonaThin","DaytonaThin","100","normal"))}PEm(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const u of this.u5)h+=String.format(this.$3j,u.fontFamily,u.Z0c,u.fontWeight,u.fontStyle);b.innerText=h;this.Afd.appendChild(b)}GEm(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Yl.a.Yh("SwayPreviewFrame.svg")),u=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Yl.a.Yh("SwayPreviewFrameHC.svg"));b.innerText=h+u;ba.a.Wp&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Afd.appendChild(b)}vZh(b){return b?b.keyCode:window.event.keyCode}hide(){this.JWf();super.hide()}JWf(){if(this.U1&&!this.RIe){for(let b=0;b<this.Fja.count;b++)rf.a.removeHandler(this.Fja.J(b),
bb.a.click,this.sNf),rf.a.removeHandler(this.Fja.J(b),bb.a.hi,this.LHi);rf.a.removeHandler(this.U1,bb.a.hi,this.hEi);rf.a.removeHandler(this.U1,bb.a.focus,this.gEi);rf.a.removeHandler(this.D1,bb.a.click,this.eMf);this.mQe||rf.a.removeHandler(this.U1,bb.a.scroll,this.xLf);this.RIe=!0}}WBf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Yl.a.dtk());this.Afd.appendChild(b);for(const h of this.uo)this.uUk(this.U1,h);this.EU(this.U1);
this.Qqh(this.U1.firstChild);this.U1.firstChild.focus();rf.a.addHandler(this.U1,bb.a.hi,this.hEi);rf.a.addHandler(this.U1,bb.a.focus,this.gEi)}uUk(b,h){const u=document.createElement("button");u.className="swayGalleryItem swayClip136x90 swayImageBorderButton";u.setAttribute(hf.a.xcb,hf.a.AL);u.setAttribute("title",h.title);u.setAttribute(hf.a.wh,hf.a.Mjh);u.id=h.styleName;b.appendChild(u);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Yl.a.Yh("swayPublish.png");b.setAttribute(hf.a.wh,hf.a.My);b.setAttribute("unselectable","on");b.setAttribute(hf.a.Mz,hf.a.ep);b.id=h.styleName+"img";u.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.Fmo;b.setAttribute(hf.a.Mz,hf.a.ep);b.setAttribute("unselectable","on");b.setAttribute(hf.a.wh,hf.a.My);u.appendChild(b);const y=document.createElement("label");y.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;y.className=h.L7l;y.setAttribute(hf.a.Mz,
hf.a.ep);b.setAttribute("unselectable","on");y.setAttribute(hf.a.wh,hf.a.My);u.appendChild(y);rf.a.addHandler(u,bb.a.click,this.sNf);rf.a.addHandler(u,bb.a.hi,this.LHi);this.Fja.add(u)}i4m(b){const h=this.uua;this.Eml(b,h,!r.AFrameworkApplication.isRtl)||this.Gml(b,h,!r.AFrameworkApplication.isRtl)||this.Bml(b,h)||this.Cml(b,h)}J4l(b){return b===Sys.UI.Key.tab?(this.uua&&this.uua!==this.XKa&&(this.uua.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.sed=this.XKa),!0):!1}Eml(b,
h,u){return b===Sys.UI.Key.right&&u||b===Sys.UI.Key.left&&!u?(b=(b=h.nextSibling)||this.U1.firstChild,this.bMb(b),!0):!1}Gml(b,h,u){return b===Sys.UI.Key.left&&u||b===Sys.UI.Key.right&&!u?(b=(b=h.previousSibling)||this.U1.lastChild,this.bMb(b),!0):!1}Bml(b,h){return b===Sys.UI.Key.down?(b=this.Fja.indexOf(h),h=b+2,h<this.Fja.count?(b=this.Fja.J(h))&&this.bMb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Fja.J(h))&&this.bMb(b)),!0):!1}Cml(b,h){b===Sys.UI.Key.up&&(b=this.Fja.indexOf(h),h=b-2,0<=h?(b=this.Fja.J(h))&&
this.bMb(b):(h=b?20+b-1:this.Fja.count-1,(b=this.Fja.J(h))&&this.bMb(b)))}bMb(b){this.uua&&this.uua.id!==this.XKa.id&&(this.uua.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.sed=b;this.uua.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.uua.focus()}Tgo(){this.nYa.className="WACDialogButtonNormal swayPrintToWebButton";this.nYa.setAttribute("tabindex","0");this.wz.className="WACDialogButtonNormal swayCancelButton";
this.wz.setAttribute("tabindex","0");this.nYa.disabled=!0}Qqh(b){this.uua&&(this.uua.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.XKa&&(this.XKa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.XKa.setAttribute(hf.a.xcb,hf.a.AL));this.NWb=b.id;this.XKa=b;this.XKa.setAttribute(hf.a.xcb,hf.a.ep);this.sed=b;this.uua.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}OAh(){lf.a.instance.Xb(new sc.a(2,
1,50,this.ATn))}Z6i(b,h){b.innerHTML=h}CTn(){w.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.NWb));r.AFrameworkApplication.ya.processAction(Oa.a.IFh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Ra.App.webServiceBase,r.AFrameworkApplication.rootQuerySignature,r.AFrameworkApplication.userSessionId,this.NWb);Je.a.openWindow(4,b)}dYd(b,h){eh.a.instance.Wf(h,+b.FS-+b.oH)}Hao(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.ndb();this.uXb.innerText=b;this.uXb.style.display="block"}Gao(){this.ndb();this.QMe.style.display="block";this.uXb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.uXb.style.display="block"}ndb(){this.zNe.style.background="";this.jrd.style.background="";Hc.a.tZ(this.yNe);Hc.a.tZ(this.jrd);this.uXb.style.display="none";this.QMe.style.display="none"}static get ZGh(){return null!=MC.Gng?MC.Gng:MC.Gng=
Ja.a.instance.Pa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(m.a)(MC,"DigitalPrintDialog",ff.a,[]);class yG{constructor(b,h){this._context=this.Uk=null;this.Goe=0;this.vad=!1;this.B6g=null;this.digitalPrint=(u,y,P,aa,ta)=>{if(1===P)return r.AFrameworkApplication.pM?8:32;this.B6g=ta.SourceControlId;if(r.AFrameworkApplication.K.$("IsAnonymousUser"))return w.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.ghc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=y;if(yG.Wrm())return w.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.j4e(),32;switch(this.Goe){case 1:w.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.j4e();break;case 2:w.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.ghc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.vad=!1,this.Uk=(new Xl.a).create(),this.Uk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Uk.wM(CommonUIStrings.l_DefaultDialogTitle,this.hEk,null),r.AFrameworkApplication.Ve.qj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Ra.App.webServiceBase,r.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.jEk,this.iEk,null)}return 32};this.hEk=()=>{this.vad=!0;w.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.jEk=u=>{if(!this.vad){this.Uk.close();var y=null;this.dYd(u.data,jh.a.kio);({group:y}=je.a.q0(u.data.Ae)).returnValue?(u=y.Responses[0],w.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",u.HasLicense,u.Succeeded),u.Succeeded?(this.Goe=u.HasLicense?1:2,2===this.Goe?this.ghc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.j4e()):this.ghc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(w.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.ghc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.iEk=u=>{this.vad||(this.Uk.close(),w.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.dYd(u.data,jh.a.jio),this.ghc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.i5=h}Wb(){r.AFrameworkApplication.protectFile?w.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):r.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&r.AFrameworkApplication.K.$("DisablePrint")?w.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.gb(Oa.a.digitalPrintToSway,oc.a.view,this.digitalPrint,4),this.ga.gb(Oa.a.HFh,oc.a.view,De.ActionManager.FZ,4),this.ga.gb(Oa.a.IFh,
oc.a.view,De.ActionManager.FZ,4),this.ga.gb(Oa.a.GFh,oc.a.view,De.ActionManager.FZ,4),this.ga.gb(Wa.a.FDd,oc.a.view,De.ActionManager.FZ,4))}j4e(){w.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.B6g);new MC(this._context,this.ga,r.AFrameworkApplication.K.lb("SwayFontDownloadUrlTemplate"),r.AFrameworkApplication.K.lb("FileSource"))}ghc(b){const h=new Gh.StandardDialog;h.Ed=0;h.Yha(CommonUIStrings.l_DefaultDialogTitle,
b,null)}dYd(b,h){eh.a.instance.Wf(h,+b.FS-+b.oH)}static Wrm(){return"OneDriveWOPI"===r.AFrameworkApplication.K.lb("FileSource")}}Object(m.a)(yG,"DigitalPrintActor",null,[]);class OJ{constructor(){this.u9g=null}vui(){w.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}Plj(b){if(!b)return w.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.spi(b.errorDetails))return!1;this.u9g=Object(na.a)(Gf.a,b.errorDetails).typeId;return!0}Jbe(b){return this.spi(b)?
Object(na.a)(Gf.a,b).typeId===this.u9g:!1}spi(b){if(!b)return w.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(na.a)(Gf.a,b);return b?b.token&&b.typeId?!0:(w.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(w.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(m.a)(OJ,"DoNotCheckThisCritiqueTypeStrategy",null,[283]);class PJ extends ff.a{constructor(b,h,u){super(!1,!1,!0);this.Bc=b;this.$la=u;this.eKj="DocumentChoiceGroup";this.KIg="EmbededContent";
this.XNg="HyperLink";this.wBe=u.y8a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.ZJc()};this.MFj=this.Wel.bind(this);this.Ue(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Wh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.MFj,b)}ZJc(){const b=Array(2);b[0]={["key"]:this.KIg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.XNg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.eKj,["defaultSelectedKey"]:this.wBe?this.KIg:this.XNg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}Wel(b,h){1===b?(this.wBe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Rc.a.eNa:Rc.a.efb,this.Bc.processAction(b,2),this.wBe=h.isExternalContentSelected,ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]}))),this.$la.sPn(h.isExternalContentSelected)):0===b&&w.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(m.a)(PJ,"ExternalContentDefaultSettingsDialog",ff.a,[]);class lt{constructor(b,h,u,y,P){this.cL=Ja.a.instance.resolve("Common.IReactContextualUILauncher");this.bqb=ag.a.On;this.bhc=()=>{const aa=Array(1);aa.push("ExternalContent");var ta=Ja.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").QNa();ta=Object.assign(new $E.a,{x:ta.x,y:ta.y});this.cL.showFloatie(ta,aa,1);return 32};this.$Db=()=>{this.cL.c_&&this.cL.Ew();return 32};this.CPi=(aa,ta,Pa,vb,Kb)=>{if(ta="object"===
typeof Kb?Kb:null)aa===Rc.a.HTf?(aa=lt.tVa!==Rc.a.eNa&&lt.tVa!==Rc.a.efb,ta[this.bqb]=lt.tVa===Rc.a.eNa||aa):aa===Rc.a.ITf&&(ta[this.bqb]=lt.tVa===Rc.a.efb);return 32};this.OLh=(aa,ta,Pa)=>{1!==Pa&&(aa===Rc.a.efb&&lt.tVa!==Rc.a.efb?(w.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Yl.undo()&&(ta=new Ff.a(1,r.AFrameworkApplication.isRtl),ta.iYc="ExternalContent",lt.dfb.i_c(ta))):aa===Rc.a.eNa&&lt.tVa!==Rc.a.eNa&&(w.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.CJg.jRi()),lt.tVa=aa);ha.a.sendTelemetryEvent(Object.assign(new ia.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ca.a,{name:"behavior",string:Pa.toString()}),Object.assign(new ca.a,{name:"ActionId",int64:aa})]}));return 32};this.ga=b;this.Yl=h;this.CJg=y;this.sQj=P;this.LFj=this.Xel.bind(this);r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.CJg.ZSi(()=>{this.reset()})}Wb(){this.ga.gb(Rc.a.HTf,oc.a.view,this.CPi,97);this.ga.gb(Rc.a.ITf,oc.a.view,this.CPi,97);this.ga.gb(Rc.a.NLh,oc.a.view,this.LFj,1028);this.ga.gb(Rc.a.eNa,oc.a.view,this.OLh,1028);this.ga.gb(Rc.a.efb,oc.a.view,this.OLh,1028);this.sQj||(this.ga.gb(Rc.a.bhc,oc.a.view,this.bhc,96),this.ga.gb(Rc.a.$Db,oc.a.view,this.$Db,96))}a$n(b){new PJ(this.ga,b,lt.$la)}Xel(b,h,u){1!==u&&this.a$n(lt.tVa);return 32}static get dfb(){return null!=lt.Yng?lt.Yng:lt.Yng=Ja.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get $la(){lt.mza||
(lt.mza=Ja.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return lt.mza}reset(){lt.tVa=null!=lt.$la?lt.$la.y8a?Rc.a.eNa:Rc.a.efb:Rc.a.eNa}}lt.tVa=Rc.a.eNa;lt.mza=null;Object(m.a)(lt,"ExternalContentActor",null,[]);class NC extends Yy{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac){super(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb);this.QPc=Ac;this.MFd=!1;this.mPg=null}E_c(){this.MFd||(super.E_c(),this.MFd=!0)}ghe(){this.MFd&&(super.ghe(),NC.gIh&&this.mPg&&NC.gIh.removeHandler(t.a.Hsa,
this.mPg),this.MFd=!1)}DOb(){if(this.QPc){this.vta.c_&&this.vta.Ew();const b=new Ff.a(0,r.AFrameworkApplication.isRtl);b.location=this.Q3a.QNa();this.showFloatie(null,b)}else this.vta.c_&&r.AFrameworkApplication.ya.processAction(Rc.a.$Db,2),r.AFrameworkApplication.ya.processAction(Rc.a.bhc,2);this.X9b=!1}Ew(b){!this.kze&&(b&&(this.Q3a.rtf(),this.Omj()),this.vta.c_||this.LJa)&&(this.LJa=!b,this.ghe(),this.QPc?this.vta.Ew():r.AFrameworkApplication.ya.processAction(Rc.a.$Db,2))}showFloatie(b,h){h||(h=
new Ff.a(0,r.AFrameworkApplication.isRtl));h.location||(h.location=this.Q3a.QNa());if(!h.location)return!1;this.LJa&&(this.LJa=!1,this.E_c());this.QPc?(b=Array(1),b.push("ExternalContent"),this.vta.showFloatie(this.Q3a.QNa(),b,1)):r.AFrameworkApplication.ya.processAction(Rc.a.bhc,2);return!0}UFc(){if(!this.X9b){const b=new sc.a(3,1,this.MCh,()=>{this.DOb()},196);lf.a.instance.Xb(b);this.X9b=!0}}zha(){this.QPc?this.vta.c_&&this.vta.Ew():r.AFrameworkApplication.ya.processAction(Rc.a.$Db,2);this.UFc()}ELb(){this.QPc?
this.vta.c_&&this.vta.Ew():r.AFrameworkApplication.ya.processAction(Rc.a.$Db,2);this.UFc()}static get gIh(){return null!=NC.Lng?NC.Lng:NC.Lng=Ja.a.instance.resolve("Box4.IEditStateEventManager")}}Object(m.a)(NC,"ExternalContentFloatieEventManager",Yy,[]);class OC extends Yv{constructor(b,h,u,y,P){super(b,h,u,y,P)}Moh(){if(!this.ib||!this.ib.hb||!this.ib.hb.kb)return w.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.hb.kb.Qa,
h=!b.cpBegin&&!b.cpEnd;let u=b.node;if(u&&h&&!u.VI){do u=this.k2h(u);while(u&&!u.VI&&Object(jb.a)(ro.AParagraphNode,u)&&!u.characterData.trim().length)}let y="";const P=Object(na.a)(ro.AParagraphNode,u);P&&(y=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():P.characterData.substring(0,b.cpBegin).trimEnd());h=P?y.length:b.cpBegin;b=Object.assign(new $y,{lha:Object(na.a)(37,(P?Object(na.a)(37,P):Object(na.a)(37,u))||b.node),Wcc:h});return this.Qif(b)}tYh(b,h){let u=null;const y=Object(na.a)(199,
b.lha.gh(h.Sb));if(!y)return null;if(Object(jb.a)(ro.AParagraphNode,b.lha)){const P=Object(na.a)(ro.AParagraphNode,b.lha);if(P.GP){if(b=Object(na.a)(gh.a,be.ParagraphReader.RNa(P)))(b=Object(na.a)(199,b.gh(h.Sb)))&&(u=b.getBounds()),u&&(u.height+=OC.WOh,u.width-=OC.Wll);return u}h=Object(na.a)(132,y);if(!h)return null;try{if(u=this.gsa.pZ(b.Wcc,h,0<b.Wcc,!1,!1,!1))u.height+=OC.WOh}catch(aa){w.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
aa),u=null}}u||(u=y.getBounds());return u}}OC.WOh=65;OC.Wll=100;Object(m.a)(OC,"ExternalContentFloatiePositionProvider",Yv,[]);class QJ{constructor(b,h,u,y,P,aa){this.VYf=(ta,Pa,vb)=>{if(1===vb)return r.AFrameworkApplication.protectFile||r.AFrameworkApplication.pM||r.AFrameworkApplication.tna||ui.SessionStatusManager.instance.zj?8:32;if(ta===Oa.a.print)ta=1;else if(ta===Rc.a.dHc)ta=0;else if(ta===Rc.a.oEd)ta=2;else return 8;return this.cPn(ta)};this.ga=b;this.i5=h;this.LSb=u;this.LJj=y;this.DHg=P;
this.aGj=aa}Wb(){r.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.LJj||r.AFrameworkApplication.pM?(document.body.classList.add("WACStopPrinting"),""!==this.DHg&&this.aGj.z$n(this.DHg)):(this.ga.pa(Oa.a.print,oc.a.application,this.VYf),this.ga.pa(Rc.a.dHc,oc.a.application,this.VYf),this.ga.pa(Rc.a.oEd,oc.a.application,this.VYf))}cPn(b){const h=r.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Ra.App.yd&&Ra.App.yd.pB.zo)return 8;this.LSb.eSd=!1;this.LSb.atj.start();Lv.a.VP(5,!0,
Object(v.a)(this.LSb,this.LSb.oJn,"requestFileDownload"),Object(v.a)(this.LSb,this.LSb.FIb,"onForceSaveFailed"),b);return 32}}Object(m.a)(QJ,"FileDownloadActor",null,[]);class RJ extends Ne{constructor(b,h=null){super(b,!0,h,!1)}get Wqf(){return null}get d3a(){return r.AFrameworkApplication.DZa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get P$b(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get ovd(){return null}}
Object(m.a)(RJ,"DownloadAsPdfDialog",Ne,[]);class Sv{constructor(){this._url=this.gv=null;this.DWa=this.CWa=0;this.Obb=!1;this.makeRequest=()=>{r.AFrameworkApplication.Ve.qj(this._url,1,null,null,!0,2,this.MIb,this.koa,null)};this.MIb=b=>{Sv.S0c();const h=b.data.Aha;let u=null;if(h)try{u=h.selectSingleNode("/docdata/status")}catch(y){}u&&("InProgress"===u.text&&22>this.CWa++||"ServiceBusy"===u.text&&3>this.DWa++)?this.eGa(1E3*(this.CWa+this.DWa)):this.gv(!0,u?u.text:null,b.data)};this.koa=b=>{this.Obb?
(Sv.kAa||(Sv.z$a=new Date,Sv.kAa=!0,Sv.hS=1),18E4>(new Date).getTime()-Sv.z$a.getTime()?this.retryOnFailure(4<=Sv.hS?2E4:1E3):this.w0a(b.data)):4>Sv.hS?this.retryOnFailure(2E3):this.w0a(b.data)}}send(b,h,u){this._url=b;this.gv=h;this.Obb=u;this.makeRequest(null)}eGa(b){b=new sc.a(2,1,b,this.makeRequest);r.AFrameworkApplication.uc.Xb(b)}retryOnFailure(b){this.eGa(b);Sv.hS++}w0a(b){this.gv(!1,null,b)}static haa(b,h){(new Sv).send(b,h,!1)}static S0c(){Sv.kAa=!1;Sv.hS=0}}Sv.z$a=null;Sv.kAa=!1;Sv.hS=0;
Object(m.a)(Sv,"ClientRequestWithRetry",null,[]);class SJ extends Te{constructor(b){super(b,void 0,r.AFrameworkApplication.DZa)}get d3a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get P$b(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get STc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get EFc(){return r.AFrameworkApplication.DZa?"UIFontDialogTextLarge":null}nCf(){w.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}oCf(){w.ULS.sendTraceTag(7628379,
324,50,"ODT download dialog link clicked")}iUc(){w.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get zTc(){return XF.IBi}get sjb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get Yxi(){return!r.AFrameworkApplication.DZa}}Object(m.a)(SJ,"DownloadAsOdtDialog",Te,[]);class TJ{constructor(b,h){this.v9a=this.wXa=null;this.D5a=u=>{1===Ra.App.xa.state||this.wXa||(this.wXa=(new Xl.a).create(),u=u.customData,this.$Hm(u),1===u?this.wXa.message=this.drb.OP.isEnabled?
r.AFrameworkApplication.DZa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:u?2===u&&(this.wXa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.wXa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.wXa.wM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.eSd=!0};this.d8=(u,y,P)=>{this.Q7f("Success. Save and Conversion Complete.");P=new fa.QueryStringBuilder(P.request.get_url());
r.AFrameworkApplication.Dka(P);P=P.toString();const aa=this.CJn(P);this.Hla(aa);2!==aa&&this.drb.Dln();!u||y?this.q4(aa):this.eSd?(this.eSd=!1,this.v9a=null):(this.v9a&&r.AFrameworkApplication.uc.Se(this.v9a),this.v9a=null,this.w6k(P,aa))};this.eSd=!1;this.drb=b;this.atj=h.XPa("UserAction","WordEditorForceSaveAndPrint")}Hla(b){this.wXa&&(this.mIm(b),this.wXa.close(),this.wXa=null)}q4(b){if(1!==Ra.App.xa.state){this.mJm(b);const h=new Gh.StandardDialog;h.Ed=0;h.Ue(1,CommonUIStrings.l_DialogClose);
h.py(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}rRl(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return w.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}oJn(b){var h=r.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.Tel(b)+"?"+h+"&type="+this.rRl(b)+"&rndm="+Ua.a.create(),1===b&&this.drb.W8n()&&(h+="&useNamedAction=1"),
r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&np.FontUtils.zbe()&&(1===b||!b)&&(0<np.FontUtils.xCh&&(h+="&cfcVer="+np.FontUtils.xCh),np.FontUtils.wCh&&(h+="&cfcUrl="+np.FontUtils.wCh),np.FontUtils.yCh&&(h+="&cfcEncData="+np.FontUtils.yCh)),Sv.haa(h,this.d8),this.v9a||(this.v9a=new sc.a(2,1,500,this.D5a),this.v9a.customData=b,r.AFrameworkApplication.uc.Xb(this.v9a))):(this.Q7f("failed. QuerySignature is empty."),this.q4(b))}Tel(b){return 2===b?"odt":"pdf"}FIb(){this.Q7f("Failed. force save failed.")}CJn(b){if(0<
b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;w.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}Q7f(b){w.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.atj.stop()}w6k(b,h){const u=new ob.a;u.add("access_token");u.add("access_token_ttl");1!==Ra.App.xa.state&&(1===h?this.drb.iao(b,u):h?2===h&&new SJ(b):new RJ(b))}dispose(){}$Hm(b){switch(b){case 0:w.ULS.sendTraceTag(38114782,
203,50,"Download Attempt: Pdf");break;case 2:w.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:w.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:w.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}mIm(b){switch(b){case 0:w.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:w.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:w.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");
break;default:w.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}mJm(b){switch(b){case 0:w.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:w.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:w.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:w.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(m.a)(TJ,"FileDownloadManager",null,[]);class PC{get key(){return"LIST"}get Cw(){return Box4Intl.Box4Strings.l_ListContentTitle}sjc(b){let h=
null;const u=PC.hd.Qu(b);if(!u)return{returnValue:!1,ola:h};b=this.rIl(b,u);h=Object.assign(new fs.a,{kG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,ola:h}}hCb(b,h){b=b.contentObject;const u=this.dHl(b.px),y=new Ah.a;h?(h=h.contentObject,h.level!==b.level?(y.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),y.add(u)):h.id.equals(b.id)&&h.px.listType===b.px.listType||y.add(u)):(y.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),y.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),y.add(u));return y.toArray().join(" ")}dHl(b){let h="";const u=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.hs);else if(1===b.listType)switch(u){case 1:h=this.Dnh;break;case 2:h=this.Uwk;break;case 3:h=this.Vwk;break;default:h=this.Dnh}return h}static get hd(){return null!=PC.utg?PC.utg:PC.utg=Ja.a.instance.resolve("Box4.List.IListReader")}}Object(m.a)(PC,"ListDetailsProvider",null,[621,246]);class UJ{constructor(){this.px=this.listId=
this.id=null;this.level=0}}Object(m.a)(UJ,"ListItemInfo",null,[]);class VJ extends PC{constructor(b){super();this.r5=b}get Dnh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get Uwk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get Vwk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}rIl(b,h){const u=this.r5.NA(b);return Object.assign(new UJ,{id:b.currentNode.id,listId:new T.a(Ua.a.nil,u.listID),px:h,level:u.level+1})}}Object(m.a)(VJ,"FlatListDetailsProvider",PC,[]);class WJ{constructor(b,h){this.ga=
b;this.If=h}get nc(){return null!=this.Xyg?this.Xyg:this.Xyg=Ja.a.instance.Pa("Box4.Styles.IWACStyleReader")}Wb(){}}Object(m.a)(WJ,"FormattingActor",null,[]);var HM=c(1143),HD=c(1269),IM=c(1649);class XJ{constructor(b,h,u,y,P,aa,ta,Pa){this.Hb=b;this.r1j=h;this.Ic=u;this.msb=y;this.Am=P;this.Ma=aa;this.Wc=ta;this.tRj=Pa}ccc(b,h,u,y,P,aa,ta){w.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.vi});this.msb.then(()=>
{this.r1j(b.data.Ae);w.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.vi});ta.stop()})}koa(b,h,u,y,P,aa,ta){aa.stop();P();ta?(this.tgn(h,u),w.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,["id"]:Jd.ImageReader.V_a(h.Hb)})):w.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Jd.ImageReader.V_a(h.Hb)})}Dhh(b,h){b.Pe(wF.a.e3e,"1");if(this.Wc&&this.Wc.isFeatureEnabled(47)){var u=
this.Am.Wm(h.Yj);u=this.Am.Ik(u);b.Pe(nh.a.Qq,HD.a[u]);5===u&&this.Nkk(b,h)}this.tRj&&b.Pe(nh.a.gQd,"true")}nbh(){return new IM.a(this.Hb.id,this.Hb)}fMd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}tgn(b,h){const u=this.Ic.Qc(7,Oa.a.a1l);u.Eb(h);b.Hb.setValue(Lc.a.xwh,!0);u.dispose()}Nkk(b,h){var u=h.Yj;h=this.Am.Wm(u);var y=u.node;const P=(u=this.Am.mDa(h,y.Jc,!1))?this.Am.dDa(u):"";if(""===P)throw w.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),
Error.argumentNull("OriginalObjectDataBlobId");y=(y=this.Am.mDa(h,y.Jc,!0))?this.Am.dDa(y):"";b.Pe(nh.a.zcc,P);b.Pe(nh.a.etj,y);u=u.ia(vi.a.TMh,"");""!==u&&b.Pe(nh.a.extension,u);b.Pe(nh.a.width,this.Am.uE(h).toString());b.Pe(nh.a.height,this.Am.RF(h).toString());b.Pe(nh.a.oYc,this.Am.Jgb(h).toString());u=this.Ma.$("WordEditorImageCropIsEnabled");b.Pe(nh.a.PBh,u.toString());u&&(b.Pe(nh.a.top,this.Am.xma(h).toString()),b.Pe(nh.a.bottom,this.Am.uma(h).toString()),b.Pe(nh.a.left,this.Am.vma(h).toString()),
b.Pe(nh.a.right,this.Am.wma(h).toString()));u=this.Ma.$("WordEditorImageRotateIsEnabled");b.Pe(nh.a.U_i,u.toString());u&&(b.Pe(nh.a.angle,this.Am.MZ(h).toString()),b.Pe(nh.a.flipH,this.Am.G4(h,Lc.a.xNc,!1)?"true":"false"),b.Pe(nh.a.flipV,this.Am.G4(h,Lc.a.JNc,!1)?"true":"false"));b.Pe(nh.a.LIh,"true")}}Object(m.a)(XJ,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[295]);class YJ{constructor(){this.mJa=null}prk(b){this.mJa=b}teardown(){null!=this.mJa&&(this.mJa.teardown(),this.mJa=null);this.PHe=
null}getGraphicData(){return this.mJa?this.mJa.getGraphicData():null}iCn(){null!=this.PHe&&this.setGraphicData(this.PHe)}setGraphicData(b){this.PHe=b;if(this.mJa)try{this.mJa.setGraphicData(b)}catch(h){w.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",h.toString())}else w.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.mJa?this.mJa.hasEdits():!1}}Object(m.a)(YJ,
"GraphicsEditorGC2HostUser",null,[296]);var JM=c(1650),KM=c(1062),LM=c(1343),MM=c(608),NM=c(1430),OM=c(1061);class ZJ{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(m.a)(ZJ,"GC2ScriptLoader",null,[]);class zG{constructor(b,h,u){this.ipe=b;this._context=h;this.KKa=u}closeEditor(){this.ipe&&(this.ipe(),this.ipe=null)}logActivity(b,h,u,y){Ub.a(b,h,u,y)}logTrace(b,h,u,y){w.ULS.sendTraceTag(575522531,3001,zG.ROm(h),
y)}isEnabled(b){const h=r.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",
!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");case "ShapeLocksSchema":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);case "RenderOnlyWhenViewDirty":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsRenderOnlyWhenDirty",!1);default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ja.a.instance.resolve("Box4.IFontServiceParser").o_a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",
h);b=np.FontUtils.kff(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(u=>"premium"!==u.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return Ta.Health.instance}getFonts(b){const h=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),u=h?"msofp_hier":"msofp",y=`${Ja.a.instance.resolve("Box4.IFontServiceParser").o_a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(u,y);np.FontUtils.Xbh();
np.FontUtils.ych({});b=np.FontUtils.jff(()=>!1,(P,aa)=>aa).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.EMk()));return b}EMk(){const b=np.FontUtils.kff(()=>!1,()=>"").fonts.map((h,u)=>{const y=h.name;h=h.displayName;const P=np.FontUtils.Fna(y);return Object.assign(new pH.a,{MenuItemId:np.FontUtils.e2i+u,CommandValueId:y,LabelText:h||y,Styles:{["optionText"]:{["fontFamily"]:h&&!P?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:y})});return Object.assign(new xi.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,
Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.Yj;var u=Jd.ImageReader.Wm(h);if(this.$pm(u,h,b)&&(u=Jd.ImageReader.G4(u,ld.a.qoa,""),u.length))return Promise.resolve(u);u=new fa.QueryStringBuilder("/we/GetImage.ashx?");u.VYb(h.node.Hi().Js);u.Pe(nh.a.GCd,b);r.AFrameworkApplication.Dka(u);u.Pe(Sd.a.cpb,"1");Bl.a.instance.Exb(u);u.Pe(nh.a.KCh,"true");const y=u.toString();return new Promise((P,aa)=>{this.KKa.qj(y,1,null,null,!1,2,ta=>{P(ta.data.Ae)},ta=>{aa(ta.data.jf.toString())},
null)})}getPlaceholders(){const b={};b.PictureDownloading=Yl.a.Yh("progress.gif");b.PictureInvalid=Yl.a.Yh("CancelRequest.32x32x32.png");return b}getTheme(){const b=xl.PageNavigator.instance.Wt(this._context.view.jd).properties.ia(Lc.a.xfe,"");return 0===b.length?[]:b.split(" ").map(h=>Ra.App.D0b[h])}static ROm(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}$pm(b,h,u){const y=h.node.Jc;h=Jd.ImageReader.pLd(b,y,!1);b=Jd.ImageReader.pLd(b,
y,!0);return u===h||u===b}}Object(m.a)(zG,"GraphicsEditorApp",null,[319]);class $J extends ff.a{constructor(b,h,u,y,P){super(!1,!1,!0);this.closeEditor=()=>{this.Vwh();this.dispose()};this.daa=aa=>{this.Vwh(2===aa)};this.M9a=b;this.iOj=h;this.pOg=u;this._context=y;this.KKa=P}q$n(b){return new Promise((h,u)=>{this.Wh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.daa,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(y,P)=>this.zsk(P,b),["onload"]:y=>{this.onLoad(y,h,u)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.M9a.iCn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,u){b?(this.M9a.prk(b),h(b)):(w.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),u(null))}zsk(b,h){const u=r.AFrameworkApplication.K,y=OM.a();y.loadScriptWithRetryHandler=b;const P=new zG(this.closeEditor,this._context,this.KKa),aa={["bootConfig"]:Object.assign(new LM.a,
{scriptBaseUrl:AD.AppChromeOverrideUtilities.isEnabled?AD.AppChromeOverrideUtilities.cLd(r.AFrameworkApplication.lcid):r.AFrameworkApplication.u4+r.AFrameworkApplication.lcid+"/",isMLRRibbonMode:r.AFrameworkApplication.ta.Pb.Rgc,isCombinedBundleEnabled:r.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new ZJ(new KM.DynamicScriptLoader(y)),["publicPath"]:r.AFrameworkApplication.u4,["appSettings"]:u.appSettings,["logger"]:new nm.a,["featureGateManager"]:Object.assign(new MM.a,
{getBooleanFeatureGate:Object(v.a)(u,u.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(v.a)(u,u.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(v.a)(u,u.getStringFeatureGate,"getStringFeatureGate")}),["app"]:P,["resolveScript"]:(ta,Pa)=>NM.a.resolveScript(ta,Pa),["initialTabId"]:h};u.$("DynamicBundlesIsEnabled")&&(h=r.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||r.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",aa.dynamicBundlesPath=
AD.AppChromeOverrideUtilities.isEnabled?AD.AppChromeOverrideUtilities.yfc+h:u.lb("StaticContentUrl")+h);return new Promise((ta,Pa)=>{b("gc2",r.AFrameworkApplication.Nw("gc2.js",5),"anonymous",5,!1).then(()=>{ta(aa)}).catch(()=>{w.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Pa(null)})})}Vwh(b){b=this.M9a.hasEdits()&&!b;this.iOj(b?this.M9a.getGraphicData():null,!!this.pOg,this.pOg,b)}}Object(m.a)($J,"ReactGraphicsEditorDialog",ff.a,[]);class aK{constructor(b,
h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc,nd=!1){this.VQh=nd;this.msb=this._context=null;this.r$n=(Ad,he,ce,Nd,re)=>{var Xd,vg,Vf;const kj=!!re&&Object(jb.a)(T.a,re);try{if(1===ce){const rm=he.view;return this.Gj.zea(he)&&rm.features.iee?32:8}this.ORj=4===(null===re||void 0===re?void 0:re.InputMethod)?!0:!1;Ra.App.instance&&Ra.App.instance.sFb&&(this.VQh||HM.a.$eb(()=>{this.VQh=!0}));w.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${kj}`);performance.mark("LaunchStart");this._context=
he;const zm=new $J(this.M9a,this.KKf,kj?re:null,he,this.rg);Ad=null;if(kj&&(null===(Xd=r.AFrameworkApplication.K)||void 0===Xd?0:Xd.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const rm=null===(Vf=null===(vg=he.view.Bb)||void 0===vg?void 0:vg.hb)||void 0===Vf?void 0:Vf.kb;if(null===rm||void 0===rm?0:rm.yK)Ad="Draw"}this.msb=zm.q$n(Ad).then(()=>{w.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${kj}`)}).catch(()=>
{this.kGh()});if(!kj){const rm=Bu=>{this.msb.then(()=>{this.aHi(Bu,!1)})};if(r.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===r.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return rm(JSON.stringify({elements:[]})),32;let os=null;os=xl.PageNavigator.instance.Wt(he.view.jd);const Us=os.properties.ia(Lc.a.WQh,"");if(0<Us.length)return rm(Us),32;this.Kve.dTn(he,T.a.create(),Ua.a.create()).then(Bu=>{const DC=this.Ic.Qc(0,Oa.a.aNc);DC.Eb(os);os.setValue(Lc.a.WQh,Bu);DC.dispose();
rm(Bu);return null}).catch(Bu=>{w.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Bu.toString(),kj);this.kGh()})}return 32}catch(zm){return w.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",zm.toString(),kj),8}};this.D2l=(Ad,he,ce,Nd,re)=>{if(!he.view.features.iee)return 32;w.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.bIh(re,he);return 32};
this.C2l=(Ad,he,ce,Nd,re)=>{var Xd,vg,Vf;const kj=he.view;if(null===(Xd=r.AFrameworkApplication.K)||void 0===Xd?0:Xd.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(Xd=null===(Vf=null===(vg=null===kj||void 0===kj?void 0:kj.Bb)||void 0===vg?void 0:vg.hb)||void 0===Vf?void 0:Vf.kb,null===Xd||void 0===Xd||!Xd.A1a)return 8;return this.Y8h(Ad,he,ce,Nd,re)};this.Y8h=(Ad,he,ce)=>{if(1===ce)return he.view.features.iee?32:8;if(2===ce){Ad=Jd.ImageReader.Wm(he.Yj);if(!Ad)return 2;
w.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.bIh(Ad,he);return 32}return 2};this.aHi=(Ad,he=!0)=>{this.M9a.setGraphicData(Ad);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Ad=performance.getEntriesByName("EditorLaunch");w.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${he} Duration: ${Ad[Ad.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.KKf=(Ad,he,ce,Nd)=>{var re;this.M9a.teardown();if(he&&this._context){var Xd=this._context.view.Bb.Lg,vg=Xd.node;Xd.gl&&be.ParagraphReader.ic(vg)&&(Xd=null===(re=this.kP)||void 0===re?void 0:re.RA(vg),27==(null===Xd||void 0===Xd?void 0:Xd.role)&&w.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",Nd,Nd?" Everything deleted: "+(0==(null===Ad||void 0===Ad?void 0:Ad.json.length)):""))}if(Nd)if(w.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Ad)if(Nd=Ad.json,re=Ad.width,vg=Ad.height,Nd.length||he)if(!Nd.length&&he)if(he=this._context.Yj){he=he.node;if(Jd.ImageReader.u7(he)){if(!this.Gj.BCn(he,new yd.GraphIterator,sd.a.instance,NJ.DeleteActor.IYb)){w.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Gj.rec(he,ce,this.eb,this.bV)){w.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}w.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else w.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else Xd=new JM.a(this._context,r.AFrameworkApplication.ta.yDa,!0,this.Gj,this.Ma,xl.PageNavigator.instance),Ad=Ua.a.create(),ce=new lJ.a(Xd,Nd,this.EJ,this.Yl,Ad,oi.a.instance,he,ce,this.Gj,this.Am,re,vg,this.Ma,this.bV,this.Wc,Ra.App.instance.sFb,Ra.App.instance.zrf),this.Kve.T0f(ce,this._context,he,Ad),this.Ipa(),this.ORj&&this.Apo();else w.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else w.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else w.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ma=h;this.Kve=u;this.Gj=y;this.EJ=P;this.Yl=aa;this.M9a=new YJ;this.Ic=Pa;this.eb=vb;this.bV=Kb;this.Am=Sb;this.Wc=Ac;this.rg=Yb;this.kP=Sc}Wb(){var b;let h=!0;this.Ma.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.Wc&&this.Wc.isFeatureEnabled(47));
h&&!ba.a.kt&&(this.ga.gb(Rc.a.graphicsEditor,oc.a.view,this.r$n,4),this.ga.gb(Oa.a.q$e,oc.a.view,this.D2l,4),this.ga.gb(Rc.a.eIh,oc.a.view,this.C2l,4),(null===(b=r.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.gb(Rc.a.F2b,oc.a.view,this.Y8h,4))}kGh(){const b=new Gh.StandardDialog;b.Ed=0;b.py(Xm.a.f$e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);Ra.App.xa.updateCommandUI()}bIh(b,h){var u=b.ia(zi.a.d4,1);const y=b.ia(vi.a.VZ,0);u&&1!==y?b.ia(Lc.a.xwh,!1)?(h=new Gh.StandardDialog,h.Ed=0,h.py(Xm.a.f$e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Ra.App.xa.updateCommandUI(),w.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Jd.ImageReader.V_a(b)})):(this.ga.Ub(Rc.a.graphicsEditor,2,b.id),
this.msb||(w.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.msb=new Promise(P=>{P(null)})),u=Ua.a.create(),b=new XJ(b,this.aHi,oi.a.instance,this.msb,this.Am,this.Ma,this.Wc,Ra.App.instance.pna(this.Am.Ik(b))),this.Kve.T0f(b,h,!0,u)):w.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Ipa(){const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):
w.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}Apo(){const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):w.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(m.a)(aK,"GraphicsEditorActor",null,[]);var PM=c(538);class bK{constructor(b,h,u){this.MUa="wwaengidc";this.Fbd="CreateLinkForHeading";this.AIj="CreateLinkForHeadingAction";this.JKj="\ufffc";this.xUa=
b;this.ga=h;this.eb=u}Wb(){this.ga.pa(Rc.a.iFc,oc.a.paragraph,this.l5e.bind(this));this.ga.pa(Rc.a.iFc,oc.a.Fd,this.l5e.bind(this));this.ga.pa(Rc.a.iFc,oc.a.Vc,this.l5e.bind(this));this.ga.Xc(Rc.a.iFc,1028)}l5e(b,h,u){b=h.node;if(1===u)return this.Jki(b)?32:8;this.Gvn(this.Fbd,this.AIj);if(!this.Jki(b))return w.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;u=b.getValue(Lc.a.Pc);if(!u)return w.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),
u=new Map,u.set("Source",this.Fbd),u=Object.assign(new Ya.a,{additionalValues:u}),Ta.Health.instance.recordKpiFailure(this.Fbd,"Unable to create sharable link as paragraph id is missing",!1,!0,u),8;this.Lzh(u);return 32}Lzh(b){b=String.format('{{"{0}":"{1}"}}',PM.a.heading,b);const h={};h.nav=btoa(b);h.mode="copy";this.ga.Ub(Wa.a.qua,2,h)}Jki(b){return!this.eb.ic(b)||this.eb.KQc(b)||this.eb.LQc(b)||b.es||""===b.characterData||b.characterData===this.JKj||!this.xUa.nKd(b)?!1:!0}Gvn(b,h){const u=new Map;
u.set("Source",this.Fbd);u.set("Action",h);Ta.Health.instance.recordKpiUsage(b,0,this.MUa,u)}}Object(m.a)(bK,"HeadingsActor",null,[]);class cK{w7n(b){return be.ParagraphReader.rta(this.RXh(b))}y2c(b,h,u){if(b=be.ParagraphReader.RNa(this.RXh(b)))h=b.xe(h),Object(jb.a)(284,h)&&(BA.m(b)?h.Z1n(u):h.y2c())}RXh(b){return b&&b.gl&&b?b.node:null}}Object(m.a)(cK,"IFrameFocusStrategy",null,[285]);class dK{constructor(b){this.Dwb=null;this.Yfd=b}vui(){w.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}Plj(b){if(!b)return w.ULS.sendTraceTag(25007836,
375,15,"Error range is null"),!1;if(!b.errorDetails)return w.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return w.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.Dwb=A.a.Ife(b.errorDetails.token,b.errorDetails.lcid);this.Yfd.add(this.Dwb,b.errorDetails.lcid);return!0}Jbe(b){return b?b.token?A.a.Ife(b.token,b.lcid)===this.Dwb:(w.ULS.sendTraceTag(25007840,375,15,
"ErrorDetails Token is null"),!1):(w.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(m.a)(dK,"IgnoreAllProofingErrorStrategy",null,[283]);var QM=c(1353),eK=c(552);class fK{constructor(b,h){this.filename=b;this.blob=h}}Object(m.a)(fK,"UploadBlobParameters",null,[]);class gK extends lm{constructor(b,h,u,y,P,aa,ta,Pa=null){super(b,h,u,null,P,aa,!1);this.VSj="DragAndDrop";this.dKg="FileName";this.gKg=0;this.Z9g=null;this.die=this.m2b=!1;this.oIg=y;this.J0g=
Pa}get lO(){return this.VSj}get fileExtension(){return this.dKg}get fileSize(){return this.gKg}get arj(){return this.Z9g}U4c(b){const h=new fK(this.oIg.name,this.oIg);b.Cfj(h);this.Z9g=b.Mbb}kNa(b,h){this.J0g&&this.J0g();super.kNa(b,h)}mEo(b){const h=!!b&&this.kya(b.name,null)&&this.meg(b,null);b&&(this.dKg=b.name,this.gKg=b.size);h||this.RXd();return h}}Object(m.a)(gK,"DragDropInsertImageUploader",lm,[]);class mt{constructor(b,h,u,y,P,aa,ta){this.zOc=aa;this.$Q=ta;this.YYd=this.ZYd=this.sZd=this.tZd=
0;this.ga=null;this.Y9e=(Pa,vb,Kb)=>{if(Ra.App.JDd)return 8;Pa=vb.node;return 1===Kb?Pa?32:2:2===Kb?(Kb=Jd.ImageReader.Wm(vb),vb=Jd.ImageReader.ILc(Kb,vb.node.Hi().Bd,r.AFrameworkApplication.K,r.AFrameworkApplication.ta.yDa),Ly(vb),32):2};this.Ngm=(Pa,vb,Kb)=>{const Sb=this.Gj.zea(vb);if(2===Kb&&Sb){if(Oa.a.pQ===Pa||Oa.a.pyd===Pa)r.AFrameworkApplication.Qna?r.AFrameworkApplication.d6f():this.aWk(vb);return 32}return 1!==Kb||Oa.a.pQ!==Pa&&Oa.a.pyd!==Pa?2:Sb?32:2};this.HEb=(Pa,vb,Kb,Sb,Yb)=>this.Gj.zea(vb)?
1===Kb?32:this.Gj.$sf(vb,Yb)?32:2:2;this.s1n=()=>{if(this.ib&&this.ib.hb&&this.ib.hb.kb){const Pa=this.ib.hb.kb.Qa;Pa&&this.ib.setSelection(Kf.SelectionFactory.we(Pa.node,Pa.cpBegin))}};this.k9k=(Pa,vb,Kb,Sb,Yb)=>{w.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Pa=Yb.DataTransfer)&&Pa.files&&0<Pa.files.length){w.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Pa.files.length));for(Kb=0;Kb<Pa.files.length;Kb++)Sb=Pa.files[Kb],0<=A.a.jh(Sb.type).indexOf("image")&&
this.agm(Sb,vb)&&(Sb=this.ib.hb.kb.Qa,this.ib.setSelection(Kf.SelectionFactory.we(Sb.node,Sb.cpBegin+1)));this.PHa();return 32}w.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.Ugn=(Pa,vb,Kb,Sb,Yb)=>{if(2===Kb)return r.AFrameworkApplication.ya.Tf(vb.Yj,Pa,Kb,!0,Sb,Yb);if(!vb.view.ue)return 8;Pa=vb.view;if(!Pa.Bb)return 8;Pa=mt.Yg.vN(Pa.Bb.Lg);return 1===Pa.length&&this.uN(Pa[0])?(this.lMm(),this.HSc||mt.wQf(!0),32):8};this.x1l=(Pa,vb,Kb)=>{if(!this.uN(vb))return 8;
const Sb=Jd.ImageReader.Wm(vb),Yb=Jd.ImageReader.uE(Sb),Ac=Jd.ImageReader.RF(Sb);Pa=Pa===Oa.a.COd;w.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Pa});if(1===Kb)return this.Te.l3||Jd.ImageReader.P1a(Sb)?2:Pa&&Yb<this.ZYd&&Ac<this.YYd||!Pa&&Yb>this.tZd&&Ac>this.sZd?32:2;Kb=Pa?1.1:.9;this.setSize(Sb,vb,Yb*Kb,Ac*Kb,!0);return 32};this.Fdc=(Pa,vb,Kb,Sb,Yb)=>{if(!this.fBa(vb))return 8;Pa=Jd.ImageReader.Wm(vb);vb=Jd.ImageReader.iDa(Pa);Kb=Jd.ImageReader.hDa(Pa);if(0>=vb||0>=Kb)return 2;
Pa=Jd.ImageReader.uE(Pa)/vb*100;Yb.setValue(ld.a.GOc,Pa);return 32};this.h7b=(Pa,vb,Kb,Sb,Yb)=>{if(!this.fBa(vb))return 8;Pa=Jd.ImageReader.Wm(vb);if(1===Kb)return this.Te.l3||Jd.ImageReader.P1a(Pa)?2:32;w.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Kb=Yb.ia(ld.a.GOc,-1)/100;Sb=Yb.ia(ld.a.Wbi,!1);const Ac=Yb.ia(ld.a.srf,!0);Yb=Yb.ia(ld.a.trf,!0);if(0>=Kb)return mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.SEb}),2;const Sc=Jd.ImageReader.iDa(Pa),nd=Jd.ImageReader.hDa(Pa),Ad=Jd.ImageReader.uE(Pa),
he=Jd.ImageReader.RF(Pa);if(0>=Sc||0>=nd)return mt.Mc.fc($c.a.s0,{["Reason"]:Zc.a.SEb}),2;Sb?(Sb=Ac?Kb*Ad:Ad,Kb=Yb?Kb*he:he):(Sb=Ac?Kb*Sc:Ad,Kb=Yb?Kb*nd:he);this.setSize(Pa,vb,Sb,Kb);Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(vb.node);this.PHa();return 32};this.fKb=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;Pa=Jd.ImageReader.Wm(vb);Pa=Jd.ImageReader.RF(Pa);if(0>=Pa)return 2;Yb.setValue(ld.a.FDa,Pa);return 32};this.FDa=(Pa,vb,Kb,Sb,Yb)=>{if(!this.fBa(vb))return 8;Pa=Jd.ImageReader.Wm(vb);if(1===Kb)return this.Te.l3||
Jd.ImageReader.P1a(Pa)?2:32;w.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Kb=Yb.ia(ld.a.FDa,0);Yb=Jd.ImageReader.O1a(Pa);if(0>=Kb)return mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.SEb}),2;Sb=Jd.ImageReader.iDa(Pa);const Ac=Jd.ImageReader.hDa(Pa),Sc=Jd.ImageReader.uE(Pa);var nd=Jd.ImageReader.RF(Pa);nd=Sc/nd;if(0>=Sb||0>=Ac)if(mt.Mc.fc($c.a.s0,{["Reason"]:Zc.a.SEb}),this.K$i(Pa))return 2;this.setSize(Pa,vb,Yb?Kb*nd:Sc,Kb);Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(vb.node);Ra.App.xa.updateCommandUI();
return 32};this.gKb=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;Pa=Jd.ImageReader.Wm(vb);Pa=Jd.ImageReader.uE(Pa);if(0>=Pa)return 2;Yb.setValue(ld.a.GDa,Pa);return 32};this.GDa=(Pa,vb,Kb,Sb,Yb)=>{if(!this.fBa(vb))return 8;Pa=Jd.ImageReader.Wm(vb);if(1===Kb)return this.Te.l3||Jd.ImageReader.P1a(Pa)?2:32;w.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Kb=Yb.ia(ld.a.GDa,0);Yb=Jd.ImageReader.O1a(Pa);if(0>=Kb)return mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.SEb}),2;Sb=Jd.ImageReader.iDa(Pa);
const Ac=Jd.ImageReader.hDa(Pa);var Sc=Jd.ImageReader.uE(Pa);const nd=Jd.ImageReader.RF(Pa);Sc=nd/Sc;if(0>=Sb||0>=Ac)if(mt.Mc.fc($c.a.s0,{["Reason"]:Zc.a.SEb}),this.K$i(Pa))return 2;this.setSize(Pa,vb,Kb,Yb?Kb*Sc:nd);Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(vb.node);Ra.App.xa.updateCommandUI();return 32};this.iKb=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;Pa=Jd.ImageReader.Wm(vb);Pa=Jd.ImageReader.O1a(Pa);Yb.setValue(ld.a.hX,Pa);return 32};this.hX=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;Pa=Jd.ImageReader.Wm(vb);
if(1===Kb&&this.Te.l3)return 2;Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(vb.node);Yb&&(vb=Yb.ia(ld.a.hX,!0),w.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Gj.X5i(Pa,vb),Ra.App.xa.updateCommandUI());return 32};this.i4a=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;Pa=Jd.ImageReader.Wm(vb);Pa=Jd.ImageReader.WW(Pa);Yb.setValue(ld.a.xhb,Pa);return 32};this.xhb=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;if(1===Kb)return this.Te.l3?2:32;if(Ra.App.yd.Xp&&(Pa=vb.node.ia(zi.a.CK,Pg.a.ot),Pa!==
Pg.a.ot&&(Pa=Ra.App.yd.Vq.vgb(Pa),eK.CoauthLockEditor.getInstance().w5a(Pa))))return mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),2;Pa=Jd.ImageReader.Wm(vb);Yb=Yb.ia(ld.a.xhb,null);this.Gj.CYn(Pa,vb,Yb);w.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Kd.Ds(13);return 32};this.h4a=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;Pa=Jd.ImageReader.Wm(vb);Pa=Jd.ImageReader.TNa(Pa);Yb.setValue(ld.a.gX,Pa);return 32};this.gX=(Pa,vb,Kb,Sb,Yb)=>{if(!this.uN(vb))return 8;if(1===Kb)return this.Te.l3?
2:32;if(Ra.App.yd.Xp&&(Pa=vb.node.ia(zi.a.CK,Pg.a.ot),Pa!==Pg.a.ot&&(Pa=Ra.App.yd.Vq.vgb(Pa),eK.CoauthLockEditor.getInstance().w5a(Pa))))return mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),2;Pa=Jd.ImageReader.Wm(vb);Yb=Yb.ia(ld.a.gX,null);this.Gj.BYn(Pa,vb,Yb);w.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Kd.Ds(13);return 32};this.U4a=(Pa,vb,Kb)=>{var Sb,Yb;if(1===Kb)return 32;if(!vb.view.ue)return w.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Pa),
8;vb=vb.view;Kb=null===(Yb=null===(Sb=vb.Bb)||void 0===Sb?void 0:Sb.hb)||void 0===Yb?void 0:Yb.J(0);if(!Kb)return w.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Pa),8;Yb=Kb.Qa;Sb=this.$Q.jg("UserAction",Pa.toString());let Ac;Pa==Oa.a.s0f?Ac=this.zOc.U4a(Yb,2):Pa==Oa.a.v0f?(Ac=this.zOc.U4a(Yb,0),5==Ac&&(Ac=this.zOc.U4a(Yb,2))):Pa==Oa.a.w0f&&(Ac=this.zOc.U4a(Yb,1),5==Ac&&(Ac=this.zOc.U4a(Yb,3)));switch(Ac){case 4:Yb=32;vb.h4();break;case 5:Yb=2;break;default:Yb=8}Sb.stop();w.ULS.sendTraceTag(512267789,
322,50,"Select image: {0}. Duration: {1}. Action: {2}",Ac,Sb.vi,Pa);return Yb};this.Gj=b;this.Om=h;this.Kd=u;this.Kh=y;this.ib=P;this.Fl=Hm.a.getInstance(Dj.a)}get Te(){return se.PageReader.instance}get laa(){return this.Om.instance}get Bc(){return this.ga}zem(){this.tZd=Bf.a.Ml(1,0);this.sZd=Bf.a.Ml(1,1);this.ZYd=Bf.a.Ml(1920,0);this.YYd=Bf.a.Ml(1280,1)}Wb(b){var h;this.ga=b;const u=this.Ugn,y=this.Ngm,P=this.HEb,aa=this.x1l;b.gb(Oa.a.pQ,oc.a.view,y,1284);b.pa(Oa.a.HEb,oc.a.Vc,P);if(null===(h=Ra.App.instance)||
void 0===h?0:h.tib)b.pa(Oa.a.s0f,oc.a.view,this.U4a),b.pa(Oa.a.v0f,oc.a.view,this.U4a),b.pa(Oa.a.w0f,oc.a.view,this.U4a);b.pa(Oa.a.HEb,oc.a.image,P);b.Xc(Oa.a.HEb,1284);b.gb(Oa.a.pyd,oc.a.view,y,1284);b.gb(Oa.a.r_e,oc.a.view,u,1028);this.ar(b,Oa.a.COd,aa);this.ar(b,Oa.a.p6f,aa);this.ar(b,Oa.a.Fdc,this.Fdc);this.ar(b,Oa.a.fKb,this.fKb);this.ar(b,Oa.a.gKb,this.gKb);this.ar(b,Oa.a.i4a,this.i4a);this.ar(b,Oa.a.h4a,this.h4a);this.ar(b,Oa.a.h7b,this.h7b);this.ar(b,Oa.a.oae,this.FDa);this.ar(b,Oa.a.pae,
this.GDa);this.ar(b,Oa.a.C2c,this.xhb);this.ar(b,Oa.a.$Lb,this.gX);this.ar(b,Oa.a.iKb,this.iKb);this.ar(b,Oa.a.hX,this.hX);this.ar(b,Oa.a.Y9e,this.Y9e);b.gb(Oa.a.QHh,oc.a.view,this.k9k,4);b.Xc(Oa.a.COd,4);b.Xc(Oa.a.p6f,4);b.Xc(Oa.a.Fdc,69);b.Xc(Oa.a.fKb,69);b.Xc(Oa.a.gKb,69);b.Xc(Oa.a.iKb,69);b.Xc(Oa.a.i4a,69);b.Xc(Oa.a.h4a,69);b.Xc(Oa.a.hX,4);b.Xc(Oa.a.h7b,4);b.Xc(Oa.a.oae,4);b.Xc(Oa.a.pae,4);b.Xc(Oa.a.C2c,4);b.Xc(Oa.a.$Lb,4);this.zem();this.HSc&&Hh.a.instance.DA(this.Izk)}ar(b,h,u){b.pa(h,oc.a.image,
u);b.pa(h,oc.a.CBb,u);b.pa(h,oc.a.Fd,u);b.pa(h,oc.a.anchoredObject,u)}aWk(b){new lm(b,lf.a.instance,r.AFrameworkApplication.K,null,this.Kh,this.ga)}wEo(b){return this.Te.l3?(mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.Zfl}),!1):mt.ag.xZ(b)?(mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.hE}),!1):this.laa&&this.laa.PT(b)?(mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.externalSelection}),!1):!0}dqm(b){const h=Jd.ImageReader.Wm(b);return h&&5===Jd.ImageReader.Ik(h)&&
this.Gii(b,h)}Gii(b,h){(h=!Jd.ImageReader.c5b(h)&&!Jd.ImageReader.CTd(h))||mt.Mc.fc($c.a.Zm,{["Reason"]:Zc.a.Dwh});return h&&this.wEo(b)}agm(b,h){var u,y;h=new gK(h,lf.a.instance,r.AFrameworkApplication.K,b,this.Kh,this.ga,this.ib,this.s1n);if(h.mEo(b))(null===(y=r.AFrameworkApplication.K)||void 0===y?0:y.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Fl.logKpiUsage({kpiName:Dj.c.HDa,kpiType:0});else return(null===(u=r.AFrameworkApplication.K)||void 0===u?0:u.$("ShouldLogPicturesExtendedHealthKpis"))?
(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Ya.a,{extendedProperties:b}),this.Fl.logKpiFailure({kpiName:Dj.c.HDa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Dj.c.f7b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):Ta.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),w.ULS.sendTraceTag(578380439,
307,50,"The file is not supported"),!1;new Uj.a(document.body,Object(v.a)(h,h.pcc,"onUploadFrameInitialized"),Object(v.a)(h,h.eya,"uploadResponseReceived"),r.AFrameworkApplication.K,!1,void 0,On.a(r.AFrameworkApplication.K));return!0}uN(b){return this.dqm(b)}fBa(b){const h=Jd.ImageReader.Wm(b);if(!h)return!1;const u=Ja.a.instance.Pa("Box4.IFeatureHelper"),y=Jd.ImageReader.Ik(h);return 5===y||10===y||48===y||11===y||u&&u.isFeatureEnabled(47)&&4===y?this.Gii(b,h):!1}get HSc(){var b;return null===(b=
r.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}Izk(){mt.wQf(!0)}setSize(b,h,u,y,P=!1){Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(h.node);const aa=Jd.ImageReader.O1a(b);let ta=1;u>this.ZYd?ta=this.ZYd/u:u<this.tZd&&(ta=this.tZd/u);let Pa=1;y>this.YYd?Pa=this.YYd/y:y<this.sZd&&(Pa=this.sZd/y);if(aa||P)ta=Math.min(ta,Pa),Pa=Math.min(ta,Pa);1!==ta&&(u*=ta);1!==Pa&&(y*=Pa);this.z9e(b,h,u,y)}z9e(b,h,u,y){this.Gj.D1n(b,h,u,y)}lMm(){w.ULS.sendTraceTag(20459969,
322,50,"PictureTools Tab enabled.")}PHa(){r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}K$i(b){const h=Jd.ImageReader.iDa(b);b=Jd.ImageReader.hDa(b);return 0>=h||0>=b}static get Yg(){return im.ContextSetEditor.instance}static get ag(){return sd.a.instance}static get Mc(){return ri.a.instance}}
mt.wQf=null;Object(m.a)(mt,"ImageActor",null,[]);var AG=c(1141),BG=c(1142);class CG{constructor(b,h,u,y,P){this.imagePropertySet=b;this.graphNode=h;this.r$e=u;this.e1l=y;this.aff=P}rotate(b){this.Dga("rotate");if(null===this.imagePropertySet||void 0===this.r$e)return this.Tna("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.imagePropertySet.eDb();if(0!==b){const u=this.aff.y7h();u.rotation=b;try{if(!this.gjh(u,h))return this.Tna("rotate","Failed to apply and update"),
!1}catch(y){return this.Tna("rotate",y.stack?y.stack:y.message?y.message:y.toString()),!1}}return!0}resize(b,h){this.Dga("resize");if(null===this.imagePropertySet||void 0===this.r$e)return this.Tna("resize","Argument(s) invalid"),!1;const u=this.getGraphicData("resize");if(void 0===u)return!1;let y=0;var P=0;({width:y,height:P}=Jd.ImageReader.pgb(this.imagePropertySet));b/=y;h/=P;P=this.aff.y7h();P.scale=this.aff.eUl();P.scale.width=b;P.scale.height=h;try{if(!this.gjh(P,u))return this.Tna("resize",
"Failed to apply and update"),!1}catch(aa){return this.Tna("resize",aa.stack?aa.stack:aa.message?aa.message:aa.toString()),!1}return!0}getGraphicData(b){try{return this.imagePropertySet.getGraphicData()}catch(h){this.Tna(b,h.stack?h.stack:h.message?h.message:h.toString())}}gjh(b,h){this.r$e.apply(b,h);b=this.imagePropertySet.XBb(h);if(void 0===b)return!1;this.wvo(b);return!0}wvo(b){const h=new dg.GraphTransaction(15);h.Eb(this.graphNode);this.imagePropertySet.setValue(Yi.a.e3,b.e3);this.e1l.yPn(b.jfl,
b.zEa,this.imagePropertySet);h.dispose()}Dga(b){const h=this.Bhg;h.edit=b;w.ULS.sendTraceTag(509657553,322,50,"{0}",h)}Tna(b,h){const u=this.Bhg;u.message=h;u.edit=b;w.ULS.sendTraceTag(509666444,322,15,"{0}",u)}get Bhg(){return{["id"]:Jd.ImageReader.V_a(this.imagePropertySet),["type"]:Jd.ImageReader.Ik(this.imagePropertySet)}}}Object(m.a)(CG,"EditWithGC2Command",null,[]);class DG{yPn(b,h,u){this.REm(b,h);this.CPn(u)}REm(b,h){this.iH=Array(4);this.iH[0]=Math.round(b.F$e);this.iH[2]=Math.round(b.H$e);
this.iH[1]=Math.round(b.G$e);this.iH[3]=Math.round(b.E$e);this.cNa=Math.round(b.cNa);this.dNa=Math.round(b.dNa);(this.zEa=h)&&this.aPk()}CPn(b){b.setValue(Yi.a.Vua,this.cNa.toString());b.setValue(Yi.a.Wua,this.dNa.toString());const h=Array(4);this.iH.forEach((u,y)=>{h[y]=u.toString()});b.setValue(Yi.a.fOa,h);b.setValue(Yi.a.z1a,this.zEa)}aPk(){this.iio();const b=this.cNa/2,h=this.dNa/2;this.cNa%2&&0===this.dNa%2?(--this.iH[0],++this.iH[2]):this.dNa%2&&0===this.cNa%2&&(++this.iH[0],--this.iH[2]);this.iH[0]+=
b-h;this.iH[1]-=b-h;this.iH[2]+=h-b;this.iH[3]-=h-b}iio(){let b=this.cNa;this.cNa=this.dNa;this.dNa=b}}Object(m.a)(DG,"GraphicsExtents",null,[]);var RM=c(1576),SM=c(1807);class EG{y7h(){return new RM.a}eUl(){return new SM.a}}Object(m.a)(EG,"Gc2ClassFactory",null,[]);var FF=c(697),hK=c(540),TM=c(539),UM=c(1432);class pr extends mt{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){super(b,h,y,aa,ta,Pa,vb);this.wVg=!1;this.Eza=this.Z9=null;this.iw=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;if(1===Ac)return this.Te.l3?
2:32;Sb=parseInt(nd);w.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Sb);this.cpd.Oqn(Yb,Jd.ImageReader.Wm(Yb),Sb);this.eUc(Yb);this.PHa();return 32};this.W8d=(Sb,Yb,Ac)=>{if(!this.uN(Yb))return 8;w.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Sb=Jd.ImageReader.Wm(Yb);if(1===Ac)return this.Te.l3?2:32;Ac=Jd.ImageReader.qgb(Sb);1===Ac?(Ac=new dg.GraphTransaction(15),Ac.Eb(Yb.node),Jd.ImageReader.c8b()?Sb.setValue(Lc.a.nJb,""):this.OJ.nDn(Sb),Ac.dispose(),this.Kwc.create(Sb,Yb).iw(fd.a.eZi),
this.eUc(Yb)):2===Ac&&this.Kwc.create(Sb,Yb).iw(fd.a.eZi);return 32};this.c3l=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;Sb=Jd.ImageReader.Wm(Yb);if(1===Ac)return this.Te.l3||Jd.ImageReader.O8b(Sb)?2:32;nd&&(this.OJ.U5c(Sb,Yb),w.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Ra.App.xa.updateCommandUI());this.PHa();return 32};this.d3l=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;if(1===Ac)return this.Te.l3?2:32;Sb=Jd.ImageReader.Wm(Yb);if(nd){Ac=Jd.ImageReader.gSd(Jd.ImageReader.Wm(Yb));
w.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Ac);Sc=nd.ia(ld.a.Chb,0);const Ad=nd.ia(ld.a.zhb,0),he=nd.ia(ld.a.Ahb,0);nd=nd.ia(ld.a.Bhb,0);const ce=Jd.ImageReader.xma(Sb),Nd=Jd.ImageReader.uma(Sb),re=Jd.ImageReader.vma(Sb),Xd=Jd.ImageReader.wma(Sb);if(Sc===ce&&Ad===Nd&&he===re&&nd===Xd)return w.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;Ac?(new AG.a(Sb,new BG.a)).rWn(Sc,Ad,he,nd,this.L2m,Yb):this.cpd.Eqn(Yb,
Jd.ImageReader.Wm(Yb),Sc,Ad,he,nd);this.eUc(Yb);Ra.App.xa.updateCommandUI()}return 32};this.KOd=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;Sc=Jd.ImageReader.Wm(Yb);if(1===Ac)return this.Te.l3||Jd.ImageReader.O8b(Sc)?2:32;if(nd){w.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.OJ.tva()||this.OJ.U5c(Sc,Yb);switch(Sb){case Rc.a.wOc:Sb=nd.ia(ld.a.Chb,-1);Ac=0;break;case Rc.a.tOc:Sb=nd.ia(ld.a.zhb,-1);Ac=1;break;case Rc.a.uOc:Sb=nd.ia(ld.a.Ahb,
-1);Ac=2;break;case Rc.a.vOc:Sb=nd.ia(ld.a.Bhb,-1);Ac=3;break;default:return 8}this.OJ.fyo(Sb,Ac);this.eUc(Yb);Ra.App.xa.updateCommandUI()}return 32};this.Jlb=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;Jd.ImageReader.Wm(Yb);nd&&(Sb=this.OJ.tva(),nd.setValue(ld.a.tva,Sb));return 32};this.Edc=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;Yb=Jd.ImageReader.Wm(Yb);if(nd){if(this.OJ.tva())({top:he,bottom:Ac,left:Sb,right:Yb}=this.OJ.ezl());else{Sc=Bf.a.lf(Jd.ImageReader.uE(Yb),0);var Ad=Bf.a.lf(Jd.ImageReader.RF(Yb),
1);var he=Math.max(Jd.ImageReader.xma(Yb),0);Ac=Math.max(Jd.ImageReader.uma(Yb),0);Sb=Math.max(Jd.ImageReader.vma(Yb),0);Yb=Math.max(Jd.ImageReader.wma(Yb),0);Sc=1E5*Sc/(1E5-(Sb+Yb));Ad=1E5*Ad/(1E5-(he+Ac));he=Math.floor(he*Ad/1E5);Ac=Math.floor(Ac*Ad/1E5);Sb=Math.floor(Sb*Sc/1E5);Yb=Math.floor(Yb*Sc/1E5)}nd.setValue(ld.a.Chb,he);nd.setValue(ld.a.zhb,Ac);nd.setValue(ld.a.Ahb,Sb);nd.setValue(ld.a.Bhb,Yb)}return 32};this.p6b=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;if(1===Ac){if(this.Te.l3)return 2;
this.MOm();return 32}Sb=Jd.ImageReader.Wm(Yb);this.OJ.tva()&&this.OJ.U5c(Sb,Yb);Sb=nd.ia(ld.a.EGa,"");nd=nd.ia(ld.a.j7a,0);w.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:nd,["SourceControlId"]:Sb});switch(nd){case 1:this.OJ.v2n(Yb);break;case 8:this.OJ.jbe(Yb,1,1);break;case 9:this.OJ.jbe(Yb,1,3);break;case 3:this.OJ.jbe(Yb,2,void 0,!0);break;case 4:this.OJ.jbe(Yb,2,void 0,!1)}this.PHa();Ra.App.xa.updateCommandUI();return 32};this.Vdc=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;
Sb=Jd.ImageReader.Wm(Yb);Yb=Jd.ImageReader.p3(Yb);Ac=Jd.ImageReader.v7(Sb);Sc=Jd.ImageReader.zMc(Sb);Sb=Jd.ImageReader.Vv(Sb);return this.Cqn(Yb,Ac,Sc,Sb,nd)?32:8};this.f3l=(Sb,Yb,Ac,Sc,nd)=>{var Ad;if(!this.fBa(Yb))return 8;Sc=Jd.ImageReader.Wm(Yb);if(1===Ac)return ui.SessionStatusManager.instance.zj?8:this.Te.l3||Jd.ImageReader.P8b(Sc)?2:32;this.OJ.tva()&&this.OJ.U5c(Sc,Yb);if(this.Cji(Sc)&&(Ac=null===(Ad=k())||void 0===Ad?void 0:Ad.q1b(),Ad=new CG(Sc,Yb.node,Ac,new DG,new EG),Ac=nd.ia(ld.a.QI,
0),Ad.rotate(Ac)))return 32;if(nd){Ac=nd.ia(ld.a.DOc,0);const he=Jd.ImageReader.gSd(Sc);w.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",Ac,he);Ad=Jd.ImageReader.MZ(Sc);let ce=Jd.ImageReader.tKd(Sc),Nd=Jd.ImageReader.vCb(Sc);switch(Ac){case 0:Ad=nd.ia(ld.a.QI,0);break;case 2:Ad-=90;Ad=fg.c(Ad);break;case 1:Ad+=90;Ad=fg.c(Ad);break;case 4:ce=!ce;break;case 3:Nd=!Nd;break;case 5:Ad+=nd.ia(ld.a.QI,0),Ad=fg.c(Ad)}he?(new AG.a(Sc,new BG.a)).S0n(Ad,ce,Nd,this.A8m,Yb):Ac?this.Kwc.create(Sc,
Yb).c0n(Ad,ce,Nd):(nd=Ua.a.create(),Ac=new dg.GraphTransaction(15,Oa.a.imageRotate),Ac.Eb(Yb.node),this.OJ.LYn(Sc,Ad),this.cpd.Kqn(Yb,Jd.ImageReader.Wm(Yb),Ad,nd),Ac.OEa(nd,1),Ac.Kk=Sb,Ac.dispose());this.PHa();this.eUc(Yb);Ra.App.xa.updateCommandUI()}return 32};this.hKb=(Sb,Yb,Ac,Sc,nd)=>{if(!this.uN(Yb))return 8;Sb=Jd.ImageReader.Wm(Yb);Sb=Jd.ImageReader.MZ(Sb);if(0>Sb)return 2;nd.setValue(ld.a.QI,Sb);return 32};this.A8m=(Sb,Yb,Ac,Sc)=>{if(Sb){const nd=new dg.GraphTransaction(15,Oa.a.imageRotate);
nd.Eb(Sc.node);Yb.setValue(ld.a.X_b,JSON.stringify(Ac));Yb.setValue(ld.a.xu,Sb);this.OJ.sae(Yb,Ac.rotationAngle,Ac.R6b,Ac.nkc);this.PBb(Yb);nd.dispose()}};this.l8m=(Sb,Yb,Ac,Sc)=>{if(Sb){const nd=new dg.GraphTransaction(15);nd.Eb(Sc.node);Yb.setValue(ld.a.X_b,JSON.stringify(Ac));Yb.setValue(ld.a.xu,Sb);this.OJ.$$d(Yb,Ac.Vge,Ac.R6c);this.PBb(Yb);nd.dispose()}};this.L2m=(Sb,Yb,Ac,Sc)=>{if(Sb){const nd=new dg.GraphTransaction(15);nd.Eb(Sc.node);Yb.setValue(ld.a.X_b,JSON.stringify(Ac));Yb.setValue(ld.a.xu,
Sb);this.OJ.FYn(Yb,Math.round(Ac.Gta*FF.a.Zdb),Math.round(Ac.Dta*FF.a.Zdb),Math.round(Ac.Eta*FF.a.Zdb),Math.round(Ac.Fta*FF.a.Zdb));this.PBb(Yb);nd.dispose()}};this.AYc=(Sb,Yb,Ac,Sc,nd)=>{if(!this.fBa(Yb))return 8;if(1===Ac)return 32;Sb=Yb.contextId===oc.a.view?se.PageReader.instance.wLd(Yb):xl.PageNavigator.instance.Wt(Yb.node);if(!Sb)return 8;Ac=Jd.ImageReader.Wm(Yb);Yb=this.Ho.L1h(Mn.a.nT(Yb),Ac);pr.XLi.Hfc=Yb;this.QRc&&this.recentColors.gdg(Yb);Yb=pr.XLi.mId(Sb,Ra.App.D0b);if(!Yb)return 8;nd.MenuItems=
Yb;return 32};this.H8=(Sb,Yb,Ac,Sc,nd)=>{if(!this.fBa(Yb))return 8;if((Sc=Jd.ImageReader.Wm(Yb))&&Jd.ImageReader.Yx(Sc))return 2;if(1===Ac)return 32;if(2!==Ac)return 2;if(!nd)return w.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Ac=new dg.GraphTransaction(15);Ac.Eb(Yb.node);const Ad=pr.Kic.GBa(Yb.node,nd);this.Ho.H8(Sc,nd,Yb,Ad);this.PBb(Sc);Ac.dispose();Sb==Oa.a.M2c&&this.recentColors.fcb(nd);this.C9c();this.PHa();return 32};this.$ga=(Sb,Yb,Ac)=>{if(!this.fBa(Yb))return 8;
if(1===Ac)return 32;Ra.App.xa.Ew();pr.n8a=new ot.a("PictureBorder",Oa.a.M2c);pr.n8a.O3c(0);return 32};this.Rha=(Sb,Yb,Ac,Sc,nd)=>{if(!this.fBa(Yb))return 8;if(1===Ac)return 32;if((Sb=Jd.ImageReader.Wm(Yb))&&Jd.ImageReader.Yx(Sb))return 2;if(!nd)return w.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Ac=new dg.GraphTransaction(15);Ac.Eb(Yb.node);this.Ho.Rha(Sb,nd,Yb);this.PBb(Sb);Ac.dispose();this.C9c();this.PHa();return 32};this.p5a=(Sb,Yb,Ac,Sc,nd)=>{if(!this.fBa(Yb))return 8;
if(1===Ac)return 32;if((Sb=Jd.ImageReader.Wm(Yb))&&Jd.ImageReader.Yx(Sb))return 2;if(!nd)return w.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;Ac=new dg.GraphTransaction(15);Ac.Eb(Yb.node);this.Ho.p5a(Sb,nd,Yb);this.PBb(Sb);Ac.dispose();this.C9c();this.PHa();return 32};this.g8d=(Sb,Yb,Ac)=>{if(!this.fBa(Yb))return 8;if(1===Ac)return 32;Sb=Jd.ImageReader.Wm(Yb);Ac=new dg.GraphTransaction(15);Ac.Eb(Yb.node);Jd.ImageReader.A6b(Sb)&&(this.Ho.g8d(Sb),this.PBb(Sb));Ac.dispose();
this.C9c();this.PHa();return 32};this.OJ=b;this.Kwc=u;this.cpd=P;pr.Eh=Kb;mt.wQf=pr.Vgn}get recentColors(){return null!=this.yvg?this.yvg:this.yvg=Ja.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get Ho(){this.Z9||(this.Z9=new hK.a);return this.Z9}Wb(b){super.Wb(b);this.ar(b,Oa.a.iw,this.iw);b.Xc(Oa.a.iw,4);this.ar(b,Oa.a.W8d,this.W8d);this.ar(b,Rc.a.mje,this.p6b);b.Xc(Rc.a.mje,4);this.ar(b,Rc.a.nje,this.p6b);this.ar(b,Rc.a.oje,this.p6b);this.ar(b,Rc.a.pje,this.p6b);this.ar(b,Rc.a.qje,this.p6b);
this.ar(b,Rc.a.rje,this.p6b);this.ar(b,Rc.a.Vdc,this.Vdc);b.Xc(Rc.a.Vdc,101);this.ar(b,Rc.a.imageCrop,this.c3l);b.Xc(Rc.a.imageCrop,4);this.ar(b,Rc.a.Jlb,this.Jlb);b.Xc(Rc.a.Jlb,101);this.ar(b,Rc.a.Pbi,this.d3l);this.ar(b,Rc.a.wOc,this.KOd);this.ar(b,Rc.a.tOc,this.KOd);this.ar(b,Rc.a.uOc,this.KOd);this.ar(b,Rc.a.vOc,this.KOd);this.ar(b,Rc.a.vZc,this.Edc);b.Xc(Rc.a.vZc,101);this.ar(b,Rc.a.N5d,this.Edc);b.Xc(Rc.a.N5d,101);this.ar(b,Rc.a.O5d,this.Edc);b.Xc(Rc.a.O5d,101);this.ar(b,Rc.a.P5d,this.Edc);
b.Xc(Rc.a.P5d,101);this.ar(b,Oa.a.imageRotate,this.f3l);b.Xc(Oa.a.imageRotate,4);this.ar(b,Oa.a.hKb,this.hKb);b.Xc(Oa.a.hKb,101);this.ar(b,Oa.a.AYc,this.AYc);b.Xc(Oa.a.AYc,4);this.ar(b,Oa.a.H8,this.H8);b.Xc(Oa.a.H8,4);this.ar(b,Oa.a.M2c,this.H8);b.Xc(Oa.a.M2c,4);this.ar(b,Oa.a.iOf,this.$ga);b.Xc(Oa.a.iOf,4);this.ar(b,Oa.a.Pwa,this.Pwa.bind(this));b.Xc(Oa.a.Pwa,4);this.ar(b,Oa.a.Rha,this.Rha);b.Xc(Oa.a.Rha,4);this.ar(b,Oa.a.kKb,this.kKb.bind(this));b.Xc(Oa.a.kKb,4);this.ar(b,Oa.a.p5a,this.p5a);b.Xc(Oa.a.p5a,
4);this.ar(b,Oa.a.KIf,this.g8d);b.Xc(Oa.a.KIf,4)}z9e(b,h,u,y){var P;w.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Jd.ImageReader.gSd(b));this.OJ.tva()&&this.OJ.U5c(b,h);if(this.Cji(b)){const aa=null===(P=k())||void 0===P?void 0:P.q1b();if((new CG(b,h.node,aa,new DG,new EG)).resize(u,y))return}Jd.ImageReader.Yx(b)?(b=Ua.a.create(),P=new dg.GraphTransaction(15),P.Eb(h.node),this.cpd.Jqn(h,Jd.ImageReader.Wm(h),u,y,b),P.OEa(b,1),P.dispose()):Jd.ImageReader.Vgc(b)?(new AG.a(b,
new BG.a)).C0n(u,y,this.l8m,h):(super.z9e(b,h,u,y),this.Kd.Ds(13))}uN(b){if(!b.gl)return!1;var h=b.node;return(h=Ra.App.instance&&Ra.App.instance.sFb?h instanceof Bj.a||h instanceof UM.a?h:null:Object(na.a)(Bj.a,h))&&BA.o(h)?(mt.Mc.fc(QM.a.Zm,{["Reason"]:aB.a.BN}),!1):super.uN(b)}static Vgn(b){b&&!pr.pub&&(pr.Eh.MXa(pr.wkb),pr.pub=!0)}Cqn(b,h,u,y,P){return P?(P.Zji=b,P.v7=h,P.SNb=u,P.mt=y,P.j7a=pr.C_l(P),!0):!1}Cji(b){b=Jd.ImageReader.Ik(b);const h=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",
!1);return Ra.App.instance&&Ra.App.instance.pna(b)?(r.AFrameworkApplication.Ce("editswithgc2;editswithgc2cf"),h):!1}eUc(b){Ra.App.yd.Xp&&Ra.App.yd.Vq.WG(b.node)}MOm(){this.wVg||(w.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.wVg=!0)}PBb(b){const h=TM.a.instance.mbf(b);this.OJ.qae(b,h[0],h[1],h[2],h[3])}Pwa(b,h,u,y,P){2===u&&(b=Jd.ImageReader.Wm(h),this.Ho.SAj(P,b));return 32}kKb(b,h,u,y,P){2===u&&(b=Jd.ImageReader.Wm(h),this.Ho.RAj(P,b));return 32}C9c(){r.AFrameworkApplication.K&&
r.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ja.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Kic(){return null!=pr.uxg?pr.uxg:pr.uxg=Wj.a.instance}static get XLi(){pr.fV||(pr.fV=new $v.a("PictureBorder"),pr.b1a(pr.fV));return pr.fV}static C_l(b){if(b.Zji)b=1;else switch(b.SNb){case 2:b=b.v7?3:4;break;case 1:b=1===b.mt?8:3===b.mt?
9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=0}return b}static b1a(b){b.gea(3,Oa.a.H8);b.gea(4,Oa.a.H8);b.gea(5,Oa.a.M2c);b.gea(6,Oa.a.H8);b.iZb(Aw.a.instance,1)}get QRc(){null==this.Eza&&(r.AFrameworkApplication.Ce("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.Eza=r.AFrameworkApplication.K?r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.Eza}}pr.pub=!1;pr.fV=null;pr.n8a=
null;pr.wkb=()=>{pr.Eh.wec(pr.wkb);pr.pub=!1;if(Qs.G_e?fh.c():appChrome){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else w.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(m.a)(pr,"ImageActor",mt,[]);class mn{static get paragraphEditor(){return null!=mn.Rug?mn.Rug:mn.Rug=Ja.a.instance.resolve("Box4.IParagraphEditor")}static get jC(){return null!=
mn.cvg?mn.cvg:mn.cvg=Ja.a.instance.resolve("Box4.IParagraphIndentationReader")}static get D_(){return mn.paragraphEditor.Vp}static get Kh(){return null!=mn.vyg?mn.vyg:mn.vyg=Ja.a.instance.resolve("Box4.IUndoManager")}static Wb(){const b=r.AFrameworkApplication.ya;b.pa(Oa.a.VJb,oc.a.view,tn.a.Nv);b.pa(Oa.a.VJb,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.VJb,1036);b.pa(Oa.a.qAb,oc.a.view,tn.a.Nv);b.pa(Oa.a.qAb,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.qAb,1036);b.pa(Oa.a.neb,oc.a.view,tn.a.Nv);b.pa(Oa.a.neb,oc.a.paragraph,
mn.Lka);b.Xc(Oa.a.neb,1036);b.pa(Oa.a.pec,oc.a.view,tn.a.Nv);b.pa(Oa.a.pec,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.pec,1036);b.pa(Oa.a.$_c,oc.a.view,tn.a.Nv);b.pa(Oa.a.$_c,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.$_c,1036);b.pa(Oa.a.Z0a,oc.a.view,tn.a.Nv);b.pa(Oa.a.Z0a,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.Z0a,1036);b.pa(Oa.a.Hhb,oc.a.view,tn.a.Nv);b.pa(Oa.a.Hhb,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.Hhb,1036);b.pa(Oa.a.Y0a,oc.a.view,tn.a.Nv);b.pa(Oa.a.Y0a,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.Y0a,1036);b.pa(Oa.a.uae,oc.a.view,
mn.lde);b.pa(Oa.a.uae,oc.a.paragraph,mn.lde);b.Xc(Oa.a.uae,1028);b.pa(Oa.a.w2f,oc.a.view,mn.lde);b.pa(Oa.a.w2f,oc.a.paragraph,mn.lde);b.Xc(Oa.a.w2f,1028);b.pa(Oa.a.mMb,oc.a.view,tn.a.Nv);b.pa(Oa.a.mMb,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.mMb,1036);b.pa(Oa.a.Smb,oc.a.view,tn.a.Nv);b.pa(Oa.a.Smb,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.Smb,1036);b.pa(Oa.a.nMb,oc.a.view,tn.a.Nv);b.pa(Oa.a.nMb,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.nMb,1036);b.pa(Oa.a.W6f,oc.a.view,tn.a.Nv);b.Xc(Oa.a.W6f,1028);b.pa(Oa.a.V2c,oc.a.view,
tn.a.Nv);b.pa(Oa.a.V2c,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.V2c,1036);b.pa(Oa.a.W2c,oc.a.view,tn.a.Nv);b.pa(Oa.a.W2c,oc.a.paragraph,mn.Lka);b.Xc(Oa.a.W2c,1036)}static lde(b,h,u,y,P){2===u&&""===P[Df.a.Text]&&(b=b===Oa.a.uae?Oa.a.Z0a:Oa.a.Y0a,h=new Px.a,h.value=0,h.unit=Ra.App.A7?2:1,r.AFrameworkApplication.ya.Ub(b,2,h),Ra.App.xa.updateCommandUI());return 32}static Lka(b,h,u,y,P){if(!({Lx:u}=tn.a.A4f(u,h)).returnValue)return u;h=h.node;switch(b){case Oa.a.VJb:mn.D_.aTf(h,!0);break;case Oa.a.qAb:mn.D_.aTf(h,
!1);break;case Oa.a.neb:mn.D_.neb(h);break;case Oa.a.pec:mn.D_.jca(h,0);break;case Oa.a.$_c:mn.D_.Kmb(h,0);break;case Oa.a.Hhb:case Oa.a.Z0a:u=new yd.GraphIterator;u.set(h);u.Ab(11);let aa=P.value;P=P.unit;b===Oa.a.Hhb&&(aa=(new Dl.a(P,aa)).yt+mn.jC.QF(h).yt,P=1);mn.D_.zxa(u,P,aa);break;case Oa.a.Y0a:mn.D_.aMb(h,P.unit,P.value);break;case Oa.a.mMb:P?(b=(new Dl.a(P.unit,P.value)).yt,mn.D_.jca(h,b)):mn.jC.aKd(h).yt||mn.D_.jca(h,Jf.OutlineReader.ZN(h));break;case Oa.a.Smb:P?(b=(new Dl.a(P.unit,P.value)).yt,
mn.D_.Kmb(h,b)):mn.jC.QF(h).yt||mn.D_.Kmb(h,Jf.OutlineReader.ZN(h));break;case Oa.a.nMb:mn.D_.jca(h,0);break;case Oa.a.V2c:b=P;b=(new Dl.a(b.unit,b.value)).yt;mn.D_.m3f(h,1,b);break;case Oa.a.W2c:b=P,b=(new Dl.a(b.unit,b.value)).yt,mn.D_.m3f(h,2,b)}mn.Kh.aG();y&&kr.a.$nb&&(y.Xr|=kr.a.agb(h));return 32}}Object(m.a)(mn,"IndentationActor",null,[]);var iK=c(314),VM=c(50),GF=c(454),WM=c(1182);class bs{constructor(b){this.XVa=this.NAa=this.Ruc=null;this.lah=!1;this.a5d=h=>{if(this.NAa)if(h===Wa.a.$4d)ub.FocusManager.instance().getRegion(xe.AFrame.Z3a).Uac();
else if(h===Wa.a.Z4d)ub.FocusManager.instance().getRegion(xe.AFrame.Z3a).Sac();else return 2;else return 2;return 32};this._frame=b}ifo(){if(this.lah)this.kri();else{const b=Nb.a.create(r.AFrameworkApplication.K.lb("WopiBootstrapUrl"));b.lW((h,u)=>{u.succeeded?(this.lah=!0,this.kri()):w.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Ib.a.eT(b)}}kri(){if(this.Ruc)w.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.Ypa;
this.NAa=document.createElement("div");b.parentNode.insertBefore(this.NAa,b);this.XVa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:r.AFrameworkApplication.K.lb("FileName"),reactRoot:this.NAa});this.XVa.setWebpackPublicPath(r.AFrameworkApplication.u4);this.XVa.renderDocumentPanel()}}hHl(b){const h={};h.Container=b;h.BootstrapperUrl=r.AFrameworkApplication.K.lb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.Zob;b={};b.HostName=r.AFrameworkApplication.K.lb("FileSource");b.HostSessionId=
r.AFrameworkApplication.K.lb("HostSessionId");b.UserId=r.AFrameworkApplication.K.lb("UserId");b.DocumentClickTime=new Date(this._frame.Tjb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=r.AFrameworkApplication.K.lb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};
b.userClickTime=this._frame.Tjb;h.Diagnostics=b;b={};b.WopiSrc=r.AFrameworkApplication.K.lb("WopiSrc");b.AccessToken=r.AFrameworkApplication.K.lb("AccessToken");b.AccessTokenTtl=r.AFrameworkApplication.K.lb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=u=>{bs.iW=u;this.XVa.setMaxPage(bs.iW.GetPageCount());this.XVa.setCurrentPage(bs.iW.GetCurrentPage());this.XVa.setPageControlVisible(!0);bs.iW.RegisterEventHandler("PageChanged",y=>{this.XVa.setCurrentPage(y.newPage)});bs.iW.RegisterEventHandler("BrowserEvent",
y=>{27===y.keyCode?this.closeViewer():y.button&&1!==y.button||this.NAa.click()});u=this._frame.Tjb-(new Date).getTime();w.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",u);this.Wb();ub.FocusManager.instance().LK(xe.AFrame.Z3a,!0);this.buildFocusRegion();this.RFa(ub.FocusManager.instance().le(xe.AFrame.Z3a));this.NAa.click()};h.FnOnInitializeFailure=(u,y)=>{w.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",u.toString(),y.toString());this.closeViewer()};return h}buildFocusRegion(){const b=
ub.FocusManager.instance();var h=b.getRegion(xe.AFrame.Z3a);h=[2,3];const u=b.le(xe.AFrame.Z3a),y=new ng.DOMFocusListing(()=>this.NAa);y.XFa=!0;for(const P of h)y.Go(P);h=b.Wka(()=>this.NAa,u,y);h.jRa();h.HX=!0;h.RYa=!0;y.vy(y.nfa)}Wb(){r.AFrameworkApplication.ya.pa(Wa.a.$4d,le.a.frame,this.a5d);r.AFrameworkApplication.ya.pa(Wa.a.Z4d,le.a.frame,this.a5d)}RFa(b){b.Mr(ub.FocusManager.instance().XV);b.Mr(ub.FocusManager.instance().YV);b.bindAction(ub.FocusManager.instance().XV,Wa.a.$4d);b.bindAction(ub.FocusManager.instance().YV,
Wa.a.Z4d)}loadViewer(b){b=this.hHl(b);this.Ruc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.Ruc.Complete(b.WopiInfo)}closeViewer(){ub.FocusManager.instance().RQ(xe.AFrame.Z3a);bs.iW&&(bs.iW.Dispose(),bs.iW=null,r.AFrameworkApplication.ya.kz(Wa.a.$4d,le.a.frame,this.a5d),r.AFrameworkApplication.ya.kz(Wa.a.Z4d,le.a.frame,this.a5d));this.Ruc&&(this.NAa.parentNode.removeChild(this.NAa),this.NAa=this.Ruc=null)}printAction(){w.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");
r.AFrameworkApplication.ya.processAction(Oa.a.print,2)}downloadPdfAction(){w.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");r.AFrameworkApplication.ya.processAction(Rc.a.dHc,2)}downloadCopyAction(){w.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");r.AFrameworkApplication.ya.processAction(Wa.a.downloadACopy,2)}zoomInAction(){if(bs.iW){let b=bs.iW.GetZoomLevel();b+=.2;bs.iW.SetZoomLevel(b)}}zoomOutAction(){if(bs.iW){let b=bs.iW.GetZoomLevel();b-=.2;bs.iW.SetZoomLevel(b)}}setPage(b){if(bs.iW){const h=
bs.iW.GetPageCount();1>b?(bs.iW.SetCurrentPage(1),this.XVa.setCurrentPage(1)):1<=b&&b<=h?bs.iW.SetCurrentPage(b):(bs.iW.SetCurrentPage(h),this.XVa.setCurrentPage(h))}}static getInstance(b){bs.NHe||(bs.NHe=new bs(b));return bs.NHe}}bs.iW=null;bs.NHe=null;Object(m.a)(bs,"PreviewPanelActor",null,[]);class Hr{static get Gsj(){return null!=Hr.Fyg?Hr.Fyg:Hr.Fyg=r.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName")}static Wb(b,h){b.gb(Oa.a.yKb,le.a.frame,Hr.Ytj,128);b.pa(Oa.a.see,le.a.frame,
Hr.Ytj);Hr.HC=h;b.pa(Rc.a.tTc,le.a.frame,Hr.tTc);b.pa(Rc.a.vTc,le.a.frame,Hr.vTc);b.gb(Rc.a.LZc,le.a.frame,Hr.LZc,96);b.gb(Rc.a.YZc,le.a.frame,Hr.YZc,96)}static Ytj(b,h,u){if(h.contextId!==le.a.frame)return 2;h=vk.App.Fn;switch(b){case Oa.a.yKb:if(!h.Zob)return 8;if(1===u)return ui.SessionStatusManager.instance.zj?8:32;b=(new Date).getTime();li.a.instance.Xwn(b);h.Tjb=b;r.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Lv.a.VP(3,!0,Hr.vkn,null,h):Lv.a.VP(3,!0,Hr.Ozi,null,h);return 32;case Oa.a.see:return 32;
default:return 2}}static Ozi(b){GF.a()?Hr.lZl(b):Hr.hgj(b)}static lZl(b){const h={};h[G.a.Gqf]=Hr.Gsj;r.AFrameworkApplication.fO().execute(u=>{u.Jv(H.a.Hqf);u.Gto(H.a.Hqf);u.oC(H.a.Hqf,y=>{Hr.JCk(y,b)});u.sendMessage(H.a.pFl,h)})}static JCk(b,h){b.Values[G.a.Gqf]===Hr.Gsj&&("true"===b.Values[G.a.dbi]?Hr.hgj(h):(Hr.Swo(),Hr.sio()))}static Swo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};r.AFrameworkApplication.Ce("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static sio(){r.AFrameworkApplication.Yu=!0;Ra.App.xa.V8(1);Ra.App.xa.jb.Jt&&Ra.App.xa.jb.Jt.mi&&Ra.App.xa.jb.Jt.ssf();r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Ra.App.xa.updateCommandUI();WM.PageView.ckj(r.AFrameworkApplication.K)}static hgj(b){try{const h=
new Tb.a;let u,y;r.AFrameworkApplication.Xsj?(u=Ra.App.hostUrl,y=3):(u=b.Zob,y=1);b.Tjb&&h.add(r.AFrameworkApplication.jFf,b.Tjb.toString());r.AFrameworkApplication.wuf&&h.add(r.AFrameworkApplication.d3e,"1");r.AFrameworkApplication.QZe&&h.add(r.AFrameworkApplication.WMk,"1");h.add(iK.a.$dg,iK.a.userSessionData);h.add(r.AFrameworkApplication.d5d,r.AFrameworkApplication.userSessionId);const P=r.AFrameworkApplication.K.lb(r.AFrameworkApplication.wia);P&&h.add(r.AFrameworkApplication.nmj,P);w.ULS.sendTraceTag(573095942,
324,100,"Navigate to view mode");GF.b(r.AFrameworkApplication.K)?GF.d("view",h,GF.c):(u=Fa.a.qdh(u,h),r.AFrameworkApplication.Xsj?Je.a.en(u,Je.a.aqa(y),void 0,"AuthenticationLostDuringSession"):Je.a.openWindow(y,u,!1,void 0,VM.a.VWi))}catch(h){}}static vkn(b){w.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(r.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ja.a.instance.resolve("Common.IDynamicScriptLoaderProvider").pA.loadScript("previewPanel")).catch(()=>
{w.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Hr.Ozi(b)}).then(()=>{bs.getInstance(b).ifo()})}static tTc(b,h,u){if(1===u)return 32;Hr.HC.$4i(1);Ra.App.xa.updateCommandUI();return 32}static vTc(b,h,u){if(1===u)return 32;Hr.HC.$4i(0);Ra.App.xa.updateCommandUI();return 32}static LZc(b,h,u,y,P){if(1===u)return 32;P[ag.a.On]=1===Hr.HC.Tv;return 32}static YZc(b,h,u,y,P){if(1===u)return 32;P[ag.a.On]=!Hr.HC.Tv;return 32}}Hr.HC=null;Object(m.a)(Hr,"MainViewModeActor",null,
[]);class jK{constructor(b,h,u){this.KQm=(y,P,aa,ta,Pa)=>1===aa?32:(y=this.Pk.i7(P.Yj))?(Pa=3===Pa.ox,this.i5.value.eAh(this.lQl(y),this.uDb(y),Pa),32):2;this.ga=b;this.i5=h;this.Pk=u}Wb(){this.ga.pa(Rc.a.MAf,oc.a.view,this.KQm);this.ga.gb(Rc.a.U5d,oc.a.view,ek.d,96);this.ga.gb(Rc.a.R5d,oc.a.view,ek.d,96);this.ga.gb(Rc.a.S5d,oc.a.view,ek.d,96);this.ga.gb(Rc.a.T5d,oc.a.view,ek.d,96);this.ga.pa(Rc.a.pXc,oc.a.view,ek.c);this.ga.pa(Rc.a.oXc,oc.a.view,ek.c);this.ga.pa(Rc.a.F2d,oc.a.view,ek.c);this.ga.pa(Rc.a.G2d,
oc.a.view,ek.c)}lQl(b){const h=new uh.DictionaryPropertySet;h.setValue(Lc.a.marginTop,this.Pk.zma(b));h.setValue(Lc.a.marginBottom,this.Pk.Kua(b));h.setValue(Lc.a.marginLeft,this.Pk.JI(b));h.setValue(Lc.a.marginRight,this.Pk.sK(b));return h}uDb(b){const h=new uh.DictionaryPropertySet;h.setValue(Lc.a.Ao,this.Pk.Pt(b));h.setValue(Lc.a.ew,this.Pk.OA(b));return h}}Object(m.a)(jK,"MarginsDialogActor",null,[]);class FG{constructor(b){this.V5c=(h,u,y)=>{if(1===y)return 32;h=r.AFrameworkApplication.ta;if(!h)return 32;
h.Iwd();FG.tPn(h);return 32};this.ga=b}Wb(){this.ga.pa(Rc.a.V5c,oc.a.view,this.V5c)}static tPn(b){const h=r.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");var u=r.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");u=Xa.a.rfa(h,!u);Xa.a.cSa(h,(!u).toString(),Xa.a.aQa);u?w.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):w.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Ub.d(Rc.a.V5c,!0,void 0,
void 0,void 0,void 0,[Object.assign(new ca.a,{name:"ModernUxExperimentPreference",string:(!u).toString()})]);b.refreshDocument(null)}}Object(m.a)(FG,"ModernUxActor",null,[]);var XM=c(1037),nt=c(1646);class kK{constructor(b,h,u){this.$ce=Xf.a.Xy(1)/6;this.k0n=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;if(aa=this.Uf.i7(P.Yj)){if(0<=Pa&&Pa<nt.a.G_.length){P=new dg.GraphTransaction(15);P.Eb(aa);P.Kk=y;y=nt.a.G_[Pa].Ktb;ta=nt.a.G_[Pa].Itb;const vb=nt.a.G_[Pa]._marginLeft;Pa=nt.a.G_[Pa].Jtb;this.m3d(y,ta,this.Uf.OA(aa))&&
this.m3d(vb,Pa,this.Uf.Pt(aa))?(this.aE.m5a(aa,y),this.aE.k5a(aa,ta),this.aE.Pha(aa,vb),this.aE.l5a(aa,Pa),this.Ud.Ds(11)):this.wxa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);P.dispose()}else return 2;return 32}w.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj);return 2};this.l0n=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;if(aa=this.Uf.i7(P.Yj)){if(0<=Pa&&Pa<nt.a.Foa.length)P=new dg.GraphTransaction(15),P.Eb(aa),P.Kk=y,y=(ta=this.Uf.cRc(aa))?nt.a.Foa[Pa].Hra:
nt.a.Foa[Pa].wKa,Pa=ta?nt.a.Foa[Pa].wKa:nt.a.Foa[Pa].Hra,this.m3d(this.Uf.Kua(aa),this.Uf.zma(aa),Pa)&&this.m3d(this.Uf.JI(aa),this.Uf.sK(aa),y)?(this.aE.T2f(aa,y),this.aE.S2f(aa,Pa),this.Ud.Ds(11)):this.wxa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),P.dispose();else return 2;return 32}w.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj);return 2};this.C_n=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;if(aa=this.Uf.i7(P.Yj)){P=this.Uf.cRc(aa);ta=new dg.GraphTransaction(15);
ta.Eb(aa);ta.Kk=y;this.aE.l6i(aa,Pa);if(Pa&&!P||!Pa&&P){y=this.Uf.Pt(aa);Pa=this.Uf.OA(aa);this.aE.T2f(aa,Pa);this.aE.S2f(aa,y);y=this.Uf.zma(aa);Pa=this.Uf.Kua(aa);const vb=this.Uf.JI(aa),Kb=this.Uf.sK(aa);P?(this.aE.m5a(aa,r.AFrameworkApplication.isRtl?vb:Kb),this.aE.k5a(aa,r.AFrameworkApplication.isRtl?Kb:vb),this.aE.Pha(aa,r.AFrameworkApplication.isRtl?Pa:y),this.aE.l5a(aa,r.AFrameworkApplication.isRtl?y:Pa)):(this.aE.m5a(aa,r.AFrameworkApplication.isRtl?Kb:vb),this.aE.k5a(aa,r.AFrameworkApplication.isRtl?
vb:Kb),this.aE.Pha(aa,r.AFrameworkApplication.isRtl?Math.abs(y):Pa),this.aE.l5a(aa,r.AFrameworkApplication.isRtl?Pa:y));this.Ud.Ds(11)}ta.dispose();return 32}w.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj);return 2};this.nSd=(y,P,aa)=>{if(1===aa)return 1===this.YR.Tv?32:8};this.Emb=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;aa=this.Uf.i7(P.Yj);if(!aa)return w.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj),2;P=
new dg.GraphTransaction(15);P.Eb(aa);P.Kk=y;y=Math.floor(this.Uf.Pt(aa)/720);if(0>Pa||Pa>y)return 2;this.aE.VLb(aa,Pa);P.dispose();return 32};this.U$d=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;aa=this.Uf.i7(P.Yj);if(!aa)return w.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj),2;P=new dg.GraphTransaction(15);P.Eb(aa);P.Kk=y;y=Pa[0];ta=this.Uf.Pt(aa);if(720>y||y>ta)return 2;this.aE.dgc(aa,Pa);P.dispose();return 32};this.T$d=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;
aa=this.Uf.i7(P.Yj);if(!aa)return w.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj),2;P=new dg.GraphTransaction(15);P.Eb(aa);P.Kk=y;y=this.Uf.Pt(aa);ta=this.Uf.Wg(aa);if(0>Pa||Pa>(y-720*ta)/(ta-1))return 2;this.aE.YVn(aa,Pa);P.dispose();return 32};this.S$d=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;aa=this.Uf.i7(P.Yj);if(!aa)return w.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj),2;P=new dg.GraphTransaction(15);
P.Eb(aa);P.Kk=y;if(null==Pa)return 2;this.aE.x1n(aa,Pa);P.dispose();return 32};this.KFa=(y,P,aa,ta,Pa)=>{if(y=this.Uf.i7(P.Yj))return Pa.marginTop=this.Uf.zma(y),Pa.marginBottom=this.Uf.Kua(y),Pa.marginLeft=this.Uf.JI(y),Pa.marginRight=this.Uf.sK(y),Pa.Ao=this.Uf.Pt(y),Pa.ew=this.Uf.OA(y),Pa.xva=this.Uf.cRc(y),Pa.fE=this.Uf.Wg(y),Pa.hla=this.Uf.Zfb(y),Pa.$Ik=this.Uf.vMd(y),Pa.BHb=this.wJl(Pa),Pa.ZIb=this.tNl(Pa),Pa.MDc=this.Hwl(Pa),32;w.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",
P.Yj);return 2};this.Iae=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;if(aa=this.Uf.i7(P.Yj)){P=new dg.GraphTransaction(15);P.Eb(aa);switch(y){case Oa.a.m5a:this.aE.m5a(aa,Pa);break;case Oa.a.k5a:this.aE.k5a(aa,Pa);break;case Oa.a.Pha:this.aE.Pha(aa,Pa);break;case Oa.a.l5a:this.aE.l5a(aa,Pa)}this.Ud.Ds(11);P.dispose();return 32}w.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj);return 2};this.S6i=(y,P,aa,ta,Pa)=>{if(1===aa)return 32;if(aa=this.Uf.i7(P.Yj)){P=new dg.GraphTransaction(15);
P.Eb(aa);let vb=ta=0;switch(y){case Oa.a.V2f:vb=Pa;this.aE.T2f(aa,vb);ta=this.Uf.OA(aa);break;case Oa.a.U2f:ta=Pa,this.aE.S2f(aa,ta),vb=this.Uf.Pt(aa)}this.aE.l6i(aa,ta<vb);this.Ud.Ds(11);P.dispose();return 32}w.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",P.Yj);return 2};this.aE=b;this.Ud=h;this.YR=u}get Uf(){return so.a.instance}xJl(b){var h=Ra.App.Jwf,u=h?1:3,y=r.AFrameworkApplication.numberFormat;let P=nt.a.G_[b].Ktb;var aa=nt.a.G_[b].Itb;var ta=nt.a.G_[b]._marginLeft;
b=nt.a.G_[b].Jtb;P=h?Xf.a.USa(P):Xf.a.pz(P);aa=h?Xf.a.USa(aa):Xf.a.pz(aa);ta=h?Xf.a.USa(ta):Xf.a.pz(ta);b=h?Xf.a.USa(b):Xf.a.pz(b);h=A.a.SCa(P,u,y);aa=A.a.SCa(aa,u,y);ta=A.a.SCa(ta,u,y);u=A.a.SCa(b,u,y);y={};y.top=h;y.bottom=aa;y.left=ta;y.right=u;return y}IQm(b){const h=WordRibbonStrings.PageMarginsTop,u=WordRibbonStrings.PageMarginsBottom,y=WordRibbonStrings.PageMarginsLeft,P=WordRibbonStrings.PageMarginsRight;b=this.xJl(b);return[[h,b.top,u,b.bottom],[y,b.left,P,b.right]]}KXc(b){var h=Ra.App.Jwf,
u=h?1:3;const y=r.AFrameworkApplication.numberFormat;let P=nt.a.Foa[b].Hra;b=nt.a.Foa[b].wKa;P=h?Xf.a.USa(P):Xf.a.pz(P);b=h?Xf.a.USa(b):Xf.a.pz(b);h=A.a.SCa(b,u,y);u=A.a.SCa(P,u,y);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,u)}Wb(){const b=r.AFrameworkApplication.ya;b.gb(Oa.a.n5a,oc.a.view,this.k0n,4);b.gb(Oa.a.WRa,oc.a.view,this.l0n,4);b.gb(Oa.a.setOrientation,oc.a.view,this.C_n,4);b.gb(Oa.a.KFa,oc.a.view,this.KFa,96);b.pa(Oa.a.m5a,oc.a.view,this.Iae);b.pa(Oa.a.k5a,oc.a.view,
this.Iae);b.pa(Oa.a.Pha,oc.a.view,this.Iae);b.pa(Oa.a.l5a,oc.a.view,this.Iae);b.pa(Oa.a.V2f,oc.a.view,this.S6i);b.pa(Oa.a.U2f,oc.a.view,this.S6i);b.gb(Oa.a.nSd,oc.a.view,this.nSd,4);b.pa(Oa.a.Emb,oc.a.view,this.Emb);b.pa(Oa.a.U$d,oc.a.view,this.U$d);b.pa(Oa.a.T$d,oc.a.view,this.T$d);b.pa(Oa.a.S$d,oc.a.view,this.S$d)}m3d(b,h,u){return u>=b+h+Ra.App.oya}wJl(b){let h=5;for(let u=0;u<nt.a.G_.length;u++)if(nt.a.G_[u].Ktb===b.marginTop&&nt.a.G_[u].Itb===b.marginBottom&&nt.a.G_[u]._marginLeft===b.marginLeft&&
nt.a.G_[u].Jtb===b.marginRight){h=u;break}return h}tNl(b){let h=5;b=new XM.a(Math.min(b.Ao,b.ew),Math.max(b.Ao,b.ew));for(let u=0;u<nt.a.Foa.length;u++)if(this.$cn(b,nt.a.Foa[u])){h=u;break}return h}Hwl(b){let h=0;switch(b.fE){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}$cn(b,h){return Gc.a.Lgi(b.wKa,Math.max(h.wKa-this.$ce,0),h.wKa+this.$ce)&&Gc.a.Lgi(b.Hra,Math.max(h.Hra-this.$ce,0),h.Hra+this.$ce)}wxa(b){if(!Kh.a.KL){const h=new Gh.StandardDialog;h.Ed=0;h.GU(CommonUIStrings.l_DefaultDialogTitle,
b,null)}}}Object(m.a)(kK,"PageActor",null,[282]);class lK{constructor(b){this.ga=b}get Bc(){return this.ga}Hae(b,h){let u=0;b?1===b?u=Oa.a.Pha:2===b?u=Oa.a.l5a:3===b&&(u=Oa.a.k5a):u=Oa.a.m5a;this.Bc.Ub(u,2,h)}WRa(b,h){let u=0;1===b?u=Oa.a.U2f:b||(u=Oa.a.V2f);this.Bc.Ub(u,2,h)}R$d(b,h){let u=0;switch(b){case 0:u=Oa.a.Emb;break;case 1:u=Oa.a.U$d;break;case 2:u=Oa.a.T$d;break;case 3:u=Oa.a.S$d}this.Bc.Ub(u,2,h)}}Object(m.a)(lK,"PageCommands",null,[280]);class mK{constructor(b,h,u){this.Zcn=(y,P,aa,ta,
Pa)=>1===aa?32:(y=this.Pk.i7(P.Yj))?(Pa=3===Pa.ox,this.i5.value.HAh(this.mQl(y),this.uDb(y),Pa),32):2;this.ga=b;this.i5=h;this.Pk=u}Wb(){this.ga.pa(Rc.a.OAf,oc.a.view,this.Zcn);this.ga.gb(Rc.a.i6d,oc.a.view,ek.d,96);this.ga.gb(Rc.a.h6d,oc.a.view,ek.d,96);this.ga.pa(Rc.a.J2d,oc.a.view,ek.c);this.ga.pa(Rc.a.I2d,oc.a.view,ek.c)}mQl(b){const h=new uh.DictionaryPropertySet;h.setValue(Lc.a.Ao,this.Pk.Pt(b));h.setValue(Lc.a.ew,this.Pk.OA(b));return h}uDb(b){const h=new uh.DictionaryPropertySet;h.setValue(Lc.a.marginTop,
Math.abs(this.Pk.zma(b)));h.setValue(Lc.a.marginBottom,Math.abs(this.Pk.Kua(b)));h.setValue(Lc.a.marginLeft,this.Pk.JI(b));h.setValue(Lc.a.marginRight,this.Pk.sK(b));return h}}Object(m.a)(mK,"PaperSizeDialogActor",null,[]);class ID{constructor(b,h,u,y){this.ga=b;this.i5=h;this.DV=u;this.rw=y}Wb(){this.ga.gb(Oa.a.D$b,oc.a.view,this.Mdn.bind(this),1028);this.ga.pa(Oa.a.D$b,oc.a.paragraph,this.Ldn.bind(this));this.ga.gb(Oa.a.t6d,oc.a.view,ek.d,96);this.ga.gb(Oa.a.Mdc,oc.a.view,ek.d,96);this.ga.gb(Oa.a.Q5d,
oc.a.view,ek.d,96);this.ga.gb(Oa.a.IZc,oc.a.view,ek.d,96);this.ga.gb(Oa.a.I5a,oc.a.view,ek.c,96);this.ga.gb(Oa.a.v4c,oc.a.view,ek.c,96);this.ga.gb(Oa.a.K2d,oc.a.view,ek.c,96);this.ga.gb(Oa.a.ucc,oc.a.view,ek.c,96);this.ga.gb(Oa.a.E2d,oc.a.view,ek.c,96);this.ga.gb(Oa.a.nde,oc.a.view,ek.c,96);this.ga.gb(Oa.a.C3a,oc.a.view,ek.c,96)}Ldn(b,h,u,y,P){if(1===u)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.klj(h);P=3===P.ox;this.i5.value.v1b(this.aMc(b),this.uDb(h),P,this.rw);return 32}Mdn(b,
h,u,y,P){b=h.view.Bb;if(!b||ID.ag.m8b(b.Lg))return 8;if(ID.Yg.lya(be.ParagraphReader.MT,b.Lg))return ID.Mc.fc($c.a.vf,{["Reason"]:Zc.a.BN}),8;if(1===u)return 3===this.ga.mode||2===this.ga.mode?32:8;u=b.hb.kb;h=this.klj(h);P=3===P.ox;if(1===u.length&&Se.SelectionEditor.pf(u.J(0)))return u=u.J(0).node,this.i5.value.v1b(this.aMc(u),this.uDb(h),P,this.rw),32;b=[];for(y=0;y<u.length;y++){const aa=u.J(y);(!y&&Se.SelectionEditor.Dk(aa)||be.ParagraphReader.em(aa)||Se.SelectionEditor.Ek(aa))&&b.push(aa.node)}if(!b.length)return 8;
u=Array(b.length);for(y=0;y<b.length;y++)u[y]=this.aMc(b[y]);u=by.APropertySet.jZh(u);this.i5.value.v1b(u,this.uDb(h),P,this.rw);return 32}aMc(b){var h,u,y;const P=new uh.DictionaryPropertySet;P.setValue(ld.a.mt,be.ParagraphReader.Vv(b));const aa=this.DV.jDa(b);var ta=aa.lineSpacing;P.setValue(ld.a.j_,ta.unit);P.setValue(ld.a.ua,ta.value);ta=aa.beforeSpacing;P.setValue(ld.a.zFa,ta.unit);P.setValue(ld.a.AFa,ta.value);ta=aa.afterSpacing;P.setValue(ld.a.xFa,ta.unit);P.setValue(ld.a.yFa,ta.value);P.setValue(ld.a.SXc,
aa.qv);(null===(h=this.rw)||void 0===h?0:h.DEa)&&P.setValue(Yi.a.fi,be.ParagraphReader.fi(b));(null===(u=this.rw)||void 0===u?0:u.NHa)&&P.setValue(Yi.a.IM,be.ParagraphReader.vkc(b));(null===(y=this.rw)||void 0===y?0:y.qga)&&P.setValue(Yi.a.keepTogether,be.ParagraphReader.keepTogether(b));return P}static get ag(){return sd.a.instance}static get Yg(){return im.ContextSetEditor.instance}static get Mc(){return ri.a.instance}}Object(m.a)(ID,"AParagraphDialogActor",null,[]);class nK extends ID{constructor(b,
h,u,y,P,aa){super(b,h,u,aa);this.Pk=y;this.so=P}Wb(){super.Wb();this.ga.gb(Oa.a.jKb,oc.a.view,ek.d,96);this.ga.gb(Oa.a.wZc,oc.a.view,ek.d,96);this.ga.gb(Oa.a.Kdc,oc.a.view,ek.d,96);this.ga.gb(Oa.a.p7b,oc.a.view,ek.c,96);this.ga.gb(Oa.a.sQd,oc.a.view,ek.c,96);this.ga.gb(Oa.a.Fhc,oc.a.view,ek.c,96);this.ga.gb(Oa.a.mde,oc.a.view,ek.c,96);this.ga.gb(Oa.a.ooa,oc.a.view,ek.c,96);this.ga.gb(Oa.a.D3a,oc.a.view,ek.c,96);this.ga.gb(Oa.a.L2d,oc.a.view,ek.c,96);this.ga.gb(Oa.a.qde,oc.a.view,ek.c,96);this.ga.gb(Oa.a.u6d,
oc.a.view,ek.d,96);this.ga.gb(Oa.a.Ndc,oc.a.view,ek.d,96)}klj(b){return this.Pk.i7(b.Yj)}aMc(b){const h=super.aMc(b);var u=this.so.oT(b);const y=this.so.QF(b);h.setValue(ld.a.Jba,1);h.setValue(ld.a.Kba,u.yt-y.yt);u=this.so.l0a(b);h.setValue(ld.a.Cwa,u.unit);h.setValue(ld.a.Dwa,u.value);b=this.so.P5b(b);b.specialIndentType&&(h.setValue(ld.a.pJ,b.specialIndentType),h.setValue(ld.a.vca,b.unit),h.setValue(ld.a.Z_,b.value));return h}uDb(b){const h=new uh.DictionaryPropertySet;h.setValue(Lc.a.Ao,this.Pk.Pt(b));
h.setValue(Lc.a.ew,this.Pk.OA(b));h.setValue(Lc.a.marginTop,Math.abs(this.Pk.zma(b)));h.setValue(Lc.a.marginBottom,Math.abs(this.Pk.Kua(b)));h.setValue(Lc.a.marginLeft,this.Pk.JI(b));h.setValue(Lc.a.marginRight,this.Pk.sK(b));return h}}Object(m.a)(nK,"ParagraphDialogActor",ID,[]);class oK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.ITd=h}}Object(m.a)(oK,"AfterPasteEventArgs",Sys.EventArgs,[]);class pK{constructor(b){this.rye=this.xye=null;this.Jdd=b}get yHd(){return null!=this.jpg?
this.jpg:this.jpg=Ja.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get Xmm(){this.xye||(this.xye=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate(hr.a.EEh,!1));return this.xye}get BSd(){this.rye||(this.rye=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$(hr.a.KEh));return this.rye}Imn(b){if(b&&wg.OutlineElementReader.Oh(b.sua)&&wg.OutlineElementReader.Oh(b.ljb)){this.cnn(b);var h=new Hi.a;for(h.ed(b.sua);h&&h.currentNode;){const u=this.KLd(h),
y=be.ParagraphReader.ic(u);y&&be.ParagraphReader.Gdb(u)&&this.Gmn(u);const P=h.currentNode.id===b.ljb.currentNode.id;y&&(this.Xmm||this.BSd)&&u.Wi.yfa(u.type).P6d(new oK(u,P));if(P)break;og.OutlineElementNavigator.Jr(h,!1,!1)}}}Gmn(b){w.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.Xcc;b=nf.a.Uc(b,0);cu.EQc(h)?this.yHd.W3d(b,h):this.Jdd.W3d(b,h)}cnn(b){if(b.sua.currentNode&&
b.ljb.currentNode&&b.sua.currentNode.id===b.ljb.currentNode.id){const h=this.KLd(b.sua);be.ParagraphReader.ic(h)?this.Lmn(h,b.Cfn,b.Bfn):w.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}Lmn(b,h,u){w.ULS.shipAssertTag(590956771,307,0<=h);w.ULS.shipAssertTag(590958592,307,0<=u);var y=be.ParagraphReader.text(b);if(""!==y){var P=nf.a.createTextRange(b,h,u);P=yi.HyperlinkReader.iD(P,!1);if(1===P.length){const aa=P[0];P=y.substring(h,u).trim();y=y.substring(aa.cpBegin,
aa.cpEnd).trim();h=P===y;P=nf.a.createTextRange(b,aa.cpBegin,aa.cpEnd);if(aa.hyperlink&&h&&!yi.HyperlinkReader.uPa(y))b=aa.hyperlink.url;else if(h)b=y;else{w.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}cu.EQc(b)?this.yHd.EOa(P,b,!1):this.Jdd.EOa(P,b,!1)}else w.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",
P.length)}}KLd(b){const h=og.OutlineElementNavigator.Ee(b);og.OutlineElementNavigator.$d(b);return h}}Object(m.a)(pK,"PastedContentsProcessorPostMergeAfterPaste",null,[144]);class GG extends Ou{constructor(b,h,u,y,P,aa,ta,Pa){super(y);this.uKe=7;this.JB=this.Bpc=null;this.cxe=0;this.$we=b;this.Tk=h;this.kn=u;this.je=P;this.WCj=ta;this.mWa=Pa;this.T1=this.je.XPa("UserAction","WordIgnoreAll")}W3f(b){this.$we.vui();this.Bpc=this.kn.qma(b);this.mWa.Hbi(this.Bpc,null,!1);return this.$we.Plj(this.Bpc)?
(this.T1.start(),this.JB=new dg.GraphTransaction(15),this.JB.Eb(b.node),!0):!1}h5d(b){this.QJb(b.node);return!0}TYc(b){this.QJb(b);return!0}i5d(b){this.QJb(b.node)}I9f(b){this.JB.dispose();this.Bpc.errorDetails.oob(b.actionId);this.T1.stop();w.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.cxe,this.T1.vi,this.Bpc.errorDetails.proofingType));return!0}Dhc(b,h){if(super.Dhc(b,h))return!0;b=b.role;return 9===
b||10===b||13===b||7===b||8===b}B2h(b){if(b&&b.type!==this.uKe){const h=yd.GraphIterator.$a(b);return h.Ab(this.uKe)?h.kd(this.uKe):b}return b}bqm(b,h){return this.$we.Jbe(h.errorDetails)&&!this.Tk.C7(nf.a.createTextRange(b,h.begin,h.end))}QJb(b){if(b){var h=this.kn.Y2(b,u=>this.bqm(b,u));this.WCj?this.kn.Wlb(b,h,!0):0<h.length&&(b.Ck(4,!0),this.kn.gIb(b));this.cxe+=h.length}}}Object(m.a)(GG,"IgnoreAllCallbackSteps",Ou,[]);class qK{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac){this.GZc=(Sc,nd,Ad,
he,ce)=>{if(1===Ad)return 32;Sc=this.XH.UNa(nd.view.Bb.Lg);if(Sc=zl.a.sg(Sc))ce[Qm.a.LabelText]=Sc.displayName;return 32};this.Vma=(Sc,nd,Ad,he,ce,Nd)=>{const re=new GG(this.kPj,this.Tk,this.kn,this.He,this.je,this.PV,0,this.mWa);return new Dg(Sc,nd,Ad,he,ce,Nd,re,this.ga,this.ib,this.He,"IgnoreAllOperation")};this.zAb=(Sc,nd,Ad,he,ce,Nd)=>{const re=new GG(this.aKj,this.Tk,this.kn,this.He,this.je,this.PV,1,this.mWa);return new Dg(Sc,nd,Ad,he,ce,Nd,re,this.ga,this.ib,this.He,"DoNotCheckThisCritiqueType")};
this.ga=b;this.Tk=h;this.ib=u;this.He=y;this.kn=P;this.XH=aa;this.je=ta;this.kPj=Pa;this.aKj=vb;this.UTb=Kb.LRc;this.PV=Kb;this.mWa=Sb;this.Yye=Yb;this.T7a=Ac}Wb(){this.Yye&&(Oo.XA()?this.ga.gb(Oa.a.Vma,oc.a.Vc,this.v$l.bind(this),1028):this.ga.tS(Oa.a.Vma,oc.a.view,this.Vma,1028));this.UTb&&this.ga.tS(Oa.a.zAb,oc.a.view,this.zAb,1028);this.ga.gb(Rc.a.GZc,oc.a.view,this.GZc,96)}v$l(b,h,u,y,P){if(1===u)return 32;w.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.T7a.Tof(P?
P:h,null,bp.b.IgnoreAll);return 32}}Object(m.a)(qK,"ProofingActor",null,[]);var eC=c(1167),YM=c(1648);class fC{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.gq=this.SKa=this.Nqd=this.Oqd=null;this.HD=this.As=this.Bq=0;this.D9a=this.C9a=!1;this.n$=this.I8a=this.H8a=this.F8a=this.J8a=0;this.Ppd=null;this.Vca=this.QV=this.Aq=this.dP=0;this.jm=null;this.zsb=0;this.aNf=Kb=>{var Sb;if(5===this.zsb){const Yb=Object.assign(new Ya.a,{extendedProperties:new Map});Yb.extendedProperties.set("status",Kb.data.status.toString());
Yb.extendedProperties.set("httpStatus",Kb.data.jf.toString());(null===(Sb=r.AFrameworkApplication.K)||void 0===Sb?0:Sb.$("ShouldLogPicturesExtendedHealthKpis"))?(Sb={name:Dj.c.bQd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Yb},Yb.extendedProperties.set("ErrorLevel","warning"),this.Fl.logKpiFailure({kpiName:Dj.c.d7b,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Yb},optionalVeto:Sb})):
Ta.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,Yb)}w.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Kb.data.status,["HttpStatus"]:Kb.data.jf,["Id"]:Kb.data.id,["ResponseData"]:Kb.data.Ae},HD.a[this.zsb]);this.n9d()};this.Gj=u;this._image=b;this._context=h;this.aid=!1;(b=fC.mh.Wt(h.node))&&b.Nf(Lc.a.xyf)&&(this.aid=!0);this.yrc=y.$("ImageDataURLPresentationIsEnabled");this.cZj=y.$("WordOartPostRequestIsEnabled");
this.Ma=y;this.Xq=P;this.je=aa;this.Ud=ta;this.Yl=Pa;this.EJ=vb;this.Fl=Hm.a.getInstance(Dj.a);this.Pdm();this.N1d=this.ccc.bind(this)}Pdm(){this.gq="";this.Bq=Jd.ImageReader.uE(this._image);this.As=Jd.ImageReader.RF(this._image);this.n$=Jd.ImageReader.Jgb(this._image);this.HD=Jd.ImageReader.MZ(this._image);this.C9a=Jd.ImageReader.tKd(this._image);this.D9a=Jd.ImageReader.vCb(this._image);this.J8a=Math.max(Jd.ImageReader.xma(this._image),0);this.F8a=Math.max(Jd.ImageReader.uma(this._image),0);this.H8a=
Math.max(Jd.ImageReader.vma(this._image),0);this.I8a=Math.max(Jd.ImageReader.wma(this._image),0);this.jm=Ua.a.nil;this.SKa=null;this.zsb=Jd.ImageReader.Ik(this._image)}oxd(b,h){return(new YM.a(this.Xq,this.zsb,this.Ma,this.Bq,this.As,this.HD,this.n$,this.J8a,this.F8a,this.H8a,this.I8a,this.C9a,this.D9a,this.aid)).build(this._context.node,this._image,b,h)}resize(b,h){this.gq="Resize";this.Dde();kh.a.mark(this.z5b());this.Bq=b;this.As=h;this.sendMessage(!1,this.N1d)}iw(b){this.gq="Styles";this.Dde();
kh.a.mark(this.z5b());this.n$=b;this.sendMessage(!1,this.N1d)}c0n(b,h,u){this.gq="Rotation";this.Dde();this.HD=b;this.C9a=h;this.D9a=u;this.sendMessage(!1,this.N1d)}b0n(b,h){this.gq="SwordRequestManager";this.Dde();this.SKa=b;this.HD=h.angle;this.Bq=h.width;this.As=h.height;this.n$=h.styleId;this.J8a=h.top;this.F8a=h.bottom;this.H8a=h.left;this.I8a=h.right;this.jm=h.WS;this.sendMessage(!1,this.N1d)}sendMessage(b,h){if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var u=this.Sdb(u);
const y=Jd.ImageReader.Fma(this._image,this.Ma,this.Xq);y?eC.a.Qmb(this._image,y,4):this._image.setValue(zi.a.YHd,!0);u.dispose()}this.uej(b);kh.a.mark(this.z5b());b=new fa.QueryStringBuilder(this.oxd(b,!0));this.yrc&&b.Pe(nh.a.KCh,"true");this.cZj?(u=new fa.QueryStringBuilder("WordOart.ashx"),r.AFrameworkApplication.Ve.qj(u.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.aNf,null)):r.AFrameworkApplication.Ve.qj(b.toString(),1,"",null,!0,0,
h,this.aNf,null)}Sdb(b){b=this.jm&&this.jm!==Ua.a.nil?new dg.GraphTransaction(7,Oa.a.imageRotate):new dg.GraphTransaction(15);b.Eb(this._context.node);return b}get kxj(){const b=new dg.GraphTransaction(3);b.Eb(this._context.node);return b}n9d(){this.JHc();this.UEd();const b=this.kxj;var h=Jd.ImageReader.yua(this._image,this._context.node.Jc,this.Ma,this.Xq);this._image.setValue(zi.a.YHd,!1);this._image.setValue(ld.a.xOc,h);this._image.setValue(ld.a.QI,-1);this._image.setValue(zi.a.d4,1);h=Jd.ImageReader.Fma(this._image,
this.Ma,this.Xq);this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(ld.a.o4d),this._image.removeProperty(ld.a.n4d),h&&eC.a.Qmb(this._image,h,3));b.dispose();fC.Kp();this.SKa&&this.SKa()}uej(b){this.je&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Oqd=this.je.jg("WebServiceCall",b))}JHc(){this.Oqd&&(this.Oqd.stop(),this.Oqd=null)}Dde(){if(this.je){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.gq,HD.a[this.zsb]);
this.Nqd=this.je.jg("WebServiceCall",b)}}UEd(){this.Nqd&&(this.Nqd.stop(),this.Nqd=null)}static get mh(){return xl.PageNavigator.instance}static Kp(){const b=new Gh.StandardDialog;b.Ed=0;b.py(Xm.a.Sgn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Ra.App.xa&&Ra.App.xa.updateCommandUI()}}Object(m.a)(fC,"RenderedImageEditOperation",null,[189]);var HG=c(315),HF=c(532);class rK extends fC{constructor(b,h,u,y,P,aa,ta,Pa,vb){super(b,h,u,y,P,aa,ta,Pa,vb)}sendMessage(b,
h){Object(HG.a)(()=>{let u;u=this.Sdb(u);this._image.setValue(zi.a.d4,0);u.dispose()});this.uej(b);kh.a.mark(this.z5b());b=new fa.QueryStringBuilder("WordOart.ashx");this.qOg=this.Ogb(!0,!1);b=new HF.a(b.toString(),2,this.Ogb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");r.AFrameworkApplication.Ve.send(b).UFa(h,u=>{this.aNf(u)})}ccc(b){try{const h=JSON.parse(b.data.DRa);this.hOj=
h[nh.a.$Mc];this.z7j=h[nh.a.width];this.zOj=h[nh.a.height];this.DAg=h[nh.a.WAc];this.kpc=Array(4);this.kpc[0]=h[nh.a.Feb];this.kpc[1]=h[nh.a.Geb];this.kpc[2]=h[nh.a.Heb];this.kpc[3]=h[nh.a.Eeb];this.FSg=void 0!==h[nh.a.zEa]?"true"===h[nh.a.zEa].toLowerCase():null;Object(HG.a)(()=>{this.o7c();this._context.node.Hi().contentReplicator.forceOutbound(()=>{this.Yjl()},null,null)})}catch(h){w.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
h.message,this.gq,Jd.ImageReader.Ik(this._image)),this.n9d()}}a1d(){w.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}o7c(){let b;b=this.Sdb(b);this._image.setValue(Yi.a.e3,this.hOj);this.DAg&&this._image.setValue(Yi.a.Bvd,this.DAg);this._image.setValue(Yi.a.Vua,this.z7j);this._image.setValue(Yi.a.Wua,this.zOj);this._image.setValue(Yi.a.fOa,this.kpc);this.qPj&&this._image.setValue(ld.a.c7b,this.qPj);eC.a.Qmb(this._image,this.qOg,3);this._image.setValue(Lc.a.Ceb,this.qOg);
this.FSg?this._image.setValue(Yi.a.z1a,this.FSg):this._image.removeProperty(Yi.a.z1a);this.eFk();b.dispose()}eFk(){this._image.removeProperty(ld.a.xu);this._image.removeProperty(ld.a.QI);this._image.removeProperty(ld.a.o4d);this._image.removeProperty(ld.a.n4d)}Yjl(){this.EJ.oGa(this._context);if(this.jm&&this.jm!==Ua.a.nil){const b=this._context.node.Hi(),h=new T.a(this.jm,1);this.Yl.L0b(b,h)}this.Ud.Ds(13);this.JHc();this.UEd();kh.a.mark(this.y5b());Object(HG.a)(()=>{let b;b=this.Sdb(b);this._image.setValue(zi.a.d4,
1);b.dispose()});this.SKa&&this.SKa()}Ogb(b,h){b=new fa.QueryStringBuilder(this.oxd(b,h));b.Pe(nh.a.gQd,"true");return b.toString()}z5b(){return 51511}y5b(){return 51512}}Object(m.a)(rK,"RenderedGraphicEditOperation",fC,[]);class sK extends fC{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){super(b,h,u,y,P,aa,ta,Pa,vb);this.AJg=null;this.a1d=Sb=>{const Yb=this.oxd(!0,!1);let Ac;Ac=this.Sdb(Ac);this._image.setValue(Lc.a.Cvd,this.Ppd);var Sc=Ja.a.instance.Pa("Box4.IFeatureHelper");Sc&&Sc.isFeatureEnabled(47)&&
this._image.setValue(Lc.a.bGd,this.AJg);this.Ma.$("WordEditorImageRotateIsEnabled")&&this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Gj.sae(this._image,this.HD,this.C9a,this.D9a);const nd=Jd.ImageReader.Fma(this._image,this.Ma,this.Xq),Ad=()=>{nd&&eC.a.Qmb(this._image,nd,3);eC.a.Qmb(this._image,Yb,3);this.Gj.qae(this._image,Xf.a.JF(this.dP),Xf.a.JF(this.QV),Xf.a.JF(this.Aq),Xf.a.JF(this.Vca));this._image.setValue(Lc.a.Ceb,Yb);Jd.ImageReader.Yx(this._image)||this._image.setValue(Lc.a.IDa,
1);this.Gj.$$d(this._image,this.Bq,this.As);this.Ma.$("WordEditorImageRotateIsEnabled")&&!this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Gj.sae(this._image,this.HD,this.C9a,this.D9a);2===Sb.data.status&&Jd.ImageReader.d_(Sb.data.Ae)&&(this._image.setValue(ld.a.xu,Sb.data.Ae),Sb.data.request&&this._image.setValue(ld.a.c7b,eC.a.rIc("POST"===Sb.data.request.get_httpVerb()?Sb.data.request.get_body():Sb.data.request.get_url())));this.SKa&&this.SKa();this.EJ.oGa(this._context);if(this.jm&&
this.jm!==Ua.a.nil){const he=this._context.node.Hi(),ce=new T.a(this.jm,1);this.Yl.L0b(he,ce)}this.Ud.Ds(13);this.JHc();this.UEd();kh.a.mark(this.y5b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.jm&&this.jm!==Ua.a.nil&&(Sc=this._context.node.Hi())&&Sc.contentReplicator){Ac.dispose();Sc.contentReplicator.forceOutbound(()=>{let he;he=this.Sdb(he);Ad();he.dispose()},null,null);return}Ad();Ac.dispose()};this.XIe=Kb}z5b(){return 51511}y5b(){return 51512}ccc(b){try{var h=JSON.parse(b.data.Ae);
const P=Sys.Net.XMLDOM("string"===typeof h[nh.a.Ngh]?h[nh.a.Ngh]:null);this.Ppd="string"===typeof h[nh.a.Dvd]?h[nh.a.Dvd]:null;const aa=Ja.a.instance.Pa("Box4.IFeatureHelper");aa&&aa.isFeatureEnabled(47)&&(this.AJg="string"===typeof h[nh.a.w3b]?h[nh.a.w3b]:null);ba.a.kt&&P.setProperty("SelectionNamespaces","xmlns:mc='"+fd.a.fjk+"'");const ta=P.selectSingleNode("/mc:AlternateContent");if(!ta)throw lh.a.argument("Alternate content element could not be retrieved!");const Pa=ta.firstChild;if(!Pa)throw lh.a.argument("Alternate content choice element could not be retrieved!");
const vb=Pa.firstChild;if(!vb)throw lh.a.argument("Drawing element could not be retrieved!");var u=vb.firstChild;if(!u)throw lh.a.argument("Inline element could not be retrieved!");h=b=null;const Kb=RegExp("effectExtent"),Sb=RegExp("extent");for(const Ac of u.childNodes)-1!==Ac.nodeName.search(Kb)&&(b=Ac),-1!==Ac.nodeName.search(Sb)&&(h=Ac);if(!b||!h)throw lh.a.argument("Effect extent or extent could not be retrieved!");this.dP=parseInt(b.selectSingleNode("@l").text);this.QV=parseInt(b.selectSingleNode("@r").text);
this.Aq=parseInt(b.selectSingleNode("@t").text);this.Vca=parseInt(b.selectSingleNode("@b").text);const Yb=fg.c(this.HD);if(45<=Yb&&135>=Yb||225<=Yb&&315>=Yb){const Ac=parseInt(h.selectSingleNode("@cx").text);var y=parseInt(h.selectSingleNode("@cy").text);u=Ac/2;y/=2;this.dP-=u-y;this.QV+=u-y;this.Aq-=y-u;this.Vca+=y-u}}catch(P){w.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",P.message,this.gq,HD.a[this.XIe]);this.n9d();return}this.sendMessage(!0,
this.a1d)}}Object(m.a)(sK,"RenderedDrawingEditOperation",fC,[]);class tK extends fC{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){super(b,h,u,y,P,aa,ta,Pa,vb);this.Z9=null;this.a1d=Yb=>{var Ac;const Sc=this.oxd(!0,!1);let nd;nd=this.Sdb(nd);this._image.setValue(Lc.a.nJb,this.Ppd);const Ad=Jd.ImageReader.Fma(this._image,this.Ma,this.Xq);(null===(Ac=r.AFrameworkApplication.K)||void 0===Ac?0:Ac.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Fl.logKpiSuccess({kpiName:Dj.c.d7b});const he=()=>{Ad&&eC.a.Qmb(this._image,
Ad,3);eC.a.Qmb(this._image,Sc,3);this.Gj.qae(this._image,Xf.a.JF(this.dP),Xf.a.JF(this.QV),Xf.a.JF(this.Aq),Xf.a.JF(this.Vca));this._image.setValue(Lc.a.Ceb,Sc);Jd.ImageReader.Yx(this._image)||this._image.setValue(Lc.a.IDa,1);this._image.setValue(Lc.a.oYc,this.n$);this._image.setValue(ld.a.mam,-1);this.Wc.isFeatureEnabled(90)&&Jd.ImageReader.A6b(this._image)&&this.Ho.g8d(this._image);this._image.setValue(zi.a.YHd,!1);this.Gj.$$d(this._image,this.Bq,this.As);this.Ma.$("WordEditorImageRotateIsEnabled")&&
this.Gj.sae(this._image,this.HD,this.C9a,this.D9a);this.Ma.$("WordEditorImageCropIsEnabled")&&this.Gj.t2f(this._image,this.J8a,this.F8a,this.H8a,this.I8a);2===Yb.data.status&&Jd.ImageReader.d_(Yb.data.Ae)&&(this._image.setValue(ld.a.xu,Yb.data.Ae),Yb.data.request&&this._image.setValue(ld.a.c7b,eC.a.rIc("POST"===Yb.data.request.get_httpVerb()?Yb.data.request.get_body():Yb.data.request.get_url())));this.SKa&&this.SKa();this.EJ.oGa(this._context);if(this.jm&&this.jm!==Ua.a.nil){const ce=this._context.node.Hi(),
Nd=new T.a(this.jm,1);this.Yl.L0b(ce,Nd)}this.Ud.Ds(13);this.JHc();this.UEd();kh.a.mark(this.y5b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.jm&&this.jm!==Ua.a.nil&&(Ac=this._context.node.Hi())&&Ac.contentReplicator){nd.dispose();Ac.contentReplicator.forceOutbound(()=>{let ce;ce=this.Sdb(ce);he();ce.dispose()},null,null);return}he();nd.dispose()};this.XIe=Kb;this.Wc=Sb}z5b(){return 7988}y5b(){return 7989}get Ho(){this.Z9||(this.Z9=new hK.a);return this.Z9}ccc(b){var h;
try{const u=b.data.Aha;this.Ppd=b.data.Ae;ba.a.kt&&u.setProperty("SelectionNamespaces","xmlns:pic='"+fd.a.Qgn+"'");const y=u.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.dP=parseInt(y.selectSingleNode("@l").text);this.QV=parseInt(y.selectSingleNode("@r").text);this.Aq=parseInt(y.selectSingleNode("@t").text);this.Vca=parseInt(y.selectSingleNode("@b").text)}catch(u){b=Object.assign(new Ya.a,{extendedProperties:new Map});b.extendedProperties.set("exception",u.message);b.extendedProperties.set("operation",
this.gq);(null===(h=r.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Dj.c.bQd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.Fl.logKpiFailure({kpiName:Dj.c.d7b,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):Ta.Health.instance.recordQosError("PictureSwordResponseInvalid",
["ImageEditFailed"],!1,!0,!1,!1,b);w.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",u.message,this.gq,HD.a[this.XIe]);this.n9d();return}this.JHc();kh.a.mark(this.y5b());this.sendMessage(!0,this.a1d)}}Object(m.a)(tK,"RenderedPictureEditOperation",fC,[]);class uK{constructor(b,h,u,y,P,aa,ta,Pa){this.Gj=b;this.Ma=h;this.Xq=u;this.je=y;this.Ud=P;this.Yl=aa;this.EJ=ta;this.Wc=Pa}create(b,h){const u=Jd.ImageReader.Ik(b);return vk.App.instance.pna(u)?
new rK(b,h,this.Gj,this.Ma,this.Xq,this.je,this.Ud,this.Yl,this.EJ):10===u||11===u||48===u||4===u?new sK(b,h,this.Gj,this.Ma,this.Xq,this.je,this.Ud,this.Yl,this.EJ,u):5===u?new tK(b,h,this.Gj,this.Ma,this.Xq,this.je,this.Ud,this.Yl,this.EJ,u,this.Wc):null}}Object(m.a)(uK,"Factory",null,[143]);class vK{constructor(){this.TGc=b=>{const h=window.performance.now(),u=uk.a.Xv();if(u){b=vG.a(b.customData,u);b=Le.a.Vr(b,u);var y=0,P=new dg.GraphTransaction(3);try{for(P.Eb(u);b.moveNext();){if(!be.ParagraphReader.rh(b.iterator))continue;
const aa=b.currentNode;this.pHh(aa)&&(y++,aa.Ck(4,!0));const ta=window.performance.now()-h;if(2500<y||100<ta){this.yvb=null;this.$Zc(aa);break}}}finally{P&&P.dispose()}}else Ab.b(570450380,3018,10,"PageContentNode not found")};this.yvb=null}Mfi(){const b=uk.a.Xv();this.m_c(b);this.$Zc(null)}$Zc(b){this.yvb&&(r.AFrameworkApplication.uc.Se(this.yvb),this.yvb=null);this.yvb=new sc.a(1,1,1,this.TGc,198);this.yvb.customData=b;r.AFrameworkApplication.uc.Xb(this.yvb)}m_c(b){const h=vG.b(b);if(h){var u=new dg.GraphTransaction(3);
try{for(u.Eb(b);h.moveNext();){if(!be.ParagraphReader.rh(h.iterator))continue;const y=h.currentNode;this.pHh(y)&&y.Ck(4,!0)}}finally{u&&u.dispose()}}}pHh(b){b=b.FD;for(const h of b)if(h.oFb)return 0<h.sNb;return!1}}Object(m.a)(vK,"RenderParagraphsContainingTabs",null,[]);class wK{constructor(b,h){this.Ure=!0;this.$nc=null;this.M7k=()=>{this.$nc=null;this.Ure=!0;this.TKa&&this.TKa.aTa(!Ra.App.hQ())};this.J6a=(u,y,P)=>{if(1===P)return 32;2===P&&(u=!1,Ra.App.hQ()?this.Ure=!1:this.Ure?u=!0:this.ABo(),
this.TKa&&this.TKa.aTa(u));return 32};this.ga=b;this.TKa=h}Wb(){this.ga.gb(Wa.a.J6a,oc.a.application,this.J6a,1124)}ABo(){this.$nc?r.AFrameworkApplication.uc.Se(this.$nc):this.$nc=new sc.a(4,1,5E3,this.M7k);r.AFrameworkApplication.uc.Xb(this.$nc)}}Object(m.a)(wK,"SaveStatusActor",null,[]);class xK{get W_f(){return null!=this.Pvg?this.Pvg:this.Pvg=Ja.a.instance.Pa("Box4.ISaveStyleManager")}get TJn(){return this.SJn||(this.SJn=Ja.a.instance.Pa("Box4.IResetAndDeleteStyleManager"))}get vj(){return null!=
this.Hwg?this.Hwg:this.Hwg=Ja.a.instance.Pa("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(u,y,P)=>{u=uk.a.bGb(y);if(1===P||u)return u?8:32;this.i5.value.nRk(y);return 32};this.createNewStyle=(u,y,P)=>{u=uk.a.bGb(y);if(1===P||u)return u?8:32;this.i5.value.eVk(y,this.ga);return 32};this.I7e=(u,y,P)=>{u=uk.a.bGb(y)||this.y5n();if(1===P||u)return u?8:32;this.i5.value.I7e(y);return 32};this.ga=b;this.i5=h}get nc(){return null!=this.kzg?this.kzg:this.kzg=Ja.a.instance.resolve("Box4.Styles.IWACStyleReader")}Wb(){this.ga.gb(Oa.a.applyStyles,
oc.a.view,this.applyStyles,1028);this.ga.gb(Oa.a.createNewStyle,oc.a.view,this.createNewStyle,4);this.ga.gb(Oa.a.pAb,oc.a.view,this.I7e,4);this.ga.gb(Oa.a.V_f,oc.a.view,this.SPn.bind(this),4);this.ga.gb(Oa.a.sZf,oc.a.view,this.tZf.bind(this),4);this.ga.gb(Oa.a.D7e,oc.a.view,this.X1k.bind(this),4)}SPn(b,h,u){b=uk.a.bGb(h)||this.D5n();if(1===u||b)return b?8:32;this.W_f.RPn();return 32}tZf(b,h,u){b=uk.a.bGb(h)||this.B5n();if(1===u||b)return b?8:32;this.TJn.tZf();return 32}X1k(b,h,u){b=uk.a.bGb(h)||this.x5n();
if(1===u||b)return b?8:32;this.i5.value.W1k();return 32}x5n(){return"{}"===wD.a.Sob?!0:!1}B5n(){if(0==wD.a.G3.size)return!0;var b=wD.a.G3;const h=this.nc.Yn();let u=0;for(const y of b.values())b=h.fh(y),this.nc.ee(b,h)||u++;return 0==u?!0:!1}D5n(){var b=wD.a.Sob,h=wD.a.G3;const u=this.nc.Yn();if(0==h.size)return!0;if(!({Uv:b}=z.d(b)).returnValue)return w.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const P of h.values()){h=
u.fh(P);var y=b[P];if(null==y)return!1;if(y=uk.a.FMd(y)){if(this.vj.dba||(h=uk.a.FKc(h,u)),uk.a.mRc(h,y))return!1}else w.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}y5n(){var b=uk.a.Xv();if(!b)return Ab.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new uo.WACStyleSet).VL(b);const h=b.GL;for(let y=0;y<h;y++){var u=b.Hfa(y);if(this.nc.isHidden(u)||!this.nc.ee(u,b))continue;const P=this.nc.lx(u);if(2===P||1===P)if(!u.hasProperty(Lc.a.Ac)||
2===P)if(u=u.ia(Lc.a.yF,null),!(u&&0<u.length))return!1}return!0}}Object(m.a)(xK,"StylesActor",null,[]);class IF{constructor(b){this.ree=(h,u,y)=>{h=r.AFrameworkApplication.ta;if(1===y)return 1!==h.mode||ui.SessionStatusManager.instance.zj?2:32;Ta.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,IF.eD,null);const P={};P[G.a.Gqf]=r.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName");P[G.a.dbi]="true";r.AFrameworkApplication.fO().execute(aa=>{aa.sendMessage(H.a.rgo,P)});return r.AFrameworkApplication.ya.processAction(Oa.a.yKb,
2)};this.ga=b}Wb(){this.ga.pa(Rc.a.ree,oc.a.view,this.ree)}}IF.eD="wwaengidc";Object(m.a)(IF,"SwitchToClassicViewModeActor",null,[]);class yK{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.angle=u;this.styleId=y;this.width=b;this.height=h;this.top=P;this.bottom=aa;this.left=ta;this.right=Pa;this.WS=vb}}Object(m.a)(yK,"SWordData",null,[]);class zK{constructor(b,h){this.Ql=this.NR=this.fq=null;this.kJe=this.aVb=!1;this.dP=this.QV=this.Vca=this.Aq=this.n$=this.As=this.Bq=this.HD=0;this.jm=null;this.d8=()=>
{this.kJe=!1;this.aVb&&this.NHc()};this.Am=b;this.Kwc=h;this.mdi()}mdi(){this.QV=this.dP=this.Vca=this.Aq=this.n$=this.As=this.Bq=this.HD=-1;this.jm=Ua.a.nil}NHc(){this.kJe||(this.GEo(),this.uWk(),this.aVb=!1)}uWk(){this.Ql=new yK(this.Bq,this.As,this.HD,this.n$,this.Aq,this.Vca,this.dP,this.QV,this.jm);this.Kwc.create(this.NR,this.fq).b0n(this.d8,this.Ql);this.kJe=!0;let b;Object(jb.a)(3,this.NR)?b=HD.a[Jd.ImageReader.Ik(this.NR)]:(w.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
b="generic");w.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.Bq,this.As,this.HD,this.n$,this.Aq,this.Vca,this.dP,this.QV,b);this.mdi()}GEo(){this.Bq=-1!==this.Bq?this.Bq:this.NR.ia(ld.a.GDa,-1);this.As=-1!==this.As?this.As:this.NR.ia(ld.a.FDa,-1);this.Bq=-1!==this.Bq?this.Bq:this.Am.uE(this.NR);this.As=-1!==this.As?this.As:this.Am.RF(this.NR);this.HD=-1!==this.HD?
this.HD:this.Am.MZ(this.NR);this.n$=-1!==this.n$?this.n$:this.Am.Jgb(this.NR);this.Aq=-1!==this.Aq?this.Aq:this.Am.xma(this.NR);this.Vca=-1!==this.Vca?this.Vca:this.Am.uma(this.NR);this.dP=-1!==this.dP?this.dP:this.Am.vma(this.NR);this.QV=-1!==this.QV?this.QV:this.Am.wma(this.NR)}Kqn(b,h,u,y){this.fq=b;this.HD=u;this.aVb=!0;this.NR=h;this.jm=y;this.NHc()}Jqn(b,h,u,y,P){this.fq=b;this.aVb=!0;this.NR=h;this.jm=P;this.NR.setValue(ld.a.GDa,u);this.NR.setValue(ld.a.FDa,y);this.NHc()}Oqn(b,h,u){this.fq=
b;this.aVb=!0;this.NR=h;this.n$=u;this.NHc()}Eqn(b,h,u,y,P,aa){this.fq=b;this.Aq=u;this.Vca=y;this.dP=P;this.QV=aa;this.aVb=!0;this.NR=h;h=b=0;({width:b,height:h}=this.Am.pgb(this.NR));this.Bq=b-(P+aa)/1E5*b;this.As=h-(u+y)/1E5*h;this.NHc()}}Object(m.a)(zK,"SWordRequestManager",null,[142]);class FE{constructor(b,h,u,y=null,P=null,aa=null,ta=null,Pa=null,vb=null,Kb=null){this.Yl=null;this.x$g=!1;this.Qio=(Sb,Yb,Ac,Sc,nd)=>{var Ad;if(1===Ac)return 32;const he=Sb===Oa.a.j4f;if(!Yb.view.ue)return 2;const ce=
Yb.view,Nd=ce.Bb,re=Nd.Lg;if(!re||FE.ag.xZ(re))return 2;if(this.Om&&this.Om.instance&&this.Om.instance.PT(re))return 4;Sb=null;var Xd=De.ActionManager.kwa;let vg=!1;var Vf=Se.SelectionEditor.pf(re);if(re.Hw)Nd.hb.YI&&(Xd=re.getContext(0),Sb=new yd.GraphIterator,Sb.set(Xd.node),Sb.jo(),Xd=he?Oa.a.x0f:Oa.a.j$d),Xd=this.DNe.kln(Xd),Xd===De.ActionManager.kwa&&((Ad=FE.Yg.yS(re,16))?(he&&(Xd=Oa.a.c_d),Sb=new yd.GraphIterator,Sb.set(Ad.node),Sb.zd()):Xd=he?Oa.a.GE:Oa.a.ML);else if(re.gl)if(Sb=new yd.GraphIterator,
Sb.set(re.node),Se.SelectionEditor.eu(Sb),Jf.OutlineReader.gPa(re))Xd=he?Oa.a.x0f:Oa.a.j$d;else{if(this.Ywe&&this.Ywe.w7n(re))return this.Ywe.y2c(re,ce.Sb,he),32;(null===(Ad=Ra.App.instance)||void 0===Ad?0:Ad.tib)&&Jd.ImageReader.r1a(re)?Xd=he?Oa.a.w0f:Oa.a.v0f:(Xd=he?this.DNe.S0l(Sb,re,Xd,Yb):this.DNe.R0l(Sb,re,Xd,Yb),wg.OutlineElementReader.Oh(Sb)&&re.contextId===oc.a.Vc&&(vg=wg.OutlineElementReader.cA(Sb,re,!1)),Ad=wj.ListReader.lj(Sb)&&vg,Xd!==De.ActionManager.kwa||hi.TableCellReader.Gna(Sb)||
Ad||(this.x$g||(w.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.x$g=!0),r.AFrameworkApplication.ya.processAction(Oa.a.Idi,2),this.gei(Yb)))}else return 2;if(!he&&Xd===De.ActionManager.kwa&&hi.TableCellReader.Gna(Sb))if(wf.returnToCell(Sb),hi.TableCellReader.dPa(Sb)||xh.TableReader.Xji(Sb)&&hi.TableCellReader.Cki(Sb)){if(Xd=this.Q8j(),!Xd)return 2}else Xd=Oa.a.Izi;if(Xd===De.ActionManager.kwa)return 2;switch(Xd){case Oa.a.Izi:case Oa.a.c_d:Sc=Xd===Oa.a.c_d;Vf&&this.M0&&
this.pY&&(Vf=this.M0.Ocf(re,-1,!0,fb.a.xx))&&this.pY.w1i(Vf);Ac=32;wf.returnToCell(Sb);wf.moveToNextOrPreviousCell(Sb,Sc)&&(Vf=!0,Sc=!1,Jf.OutlineReader.Npf(Sb)||(mg.OutlineNavigator.CFf(Sb,!1),og.OutlineElementNavigator.Ee(Sb),be.ParagraphReader.Lt(Sb.currentNode)&&(Vf=!1,be.ParagraphReader.textLength(Sb.currentNode)||(Sc=!0)),Sc||wf.returnToCell(Sb)),Sc?Sb=Kf.SelectionFactory.we(Sb.currentNode,0):(Sb=Kf.SelectionFactory.kq(Sb.currentNode),!Vf&&Se.SelectionEditor.Dk(Sb.Tc)&&(Vf=Sb.toArray(),Array.removeAt(Vf,
Vf.length-1),Sb=new Bq.Selection(Vf,Sb.Sf))),Nd.setSelection(Sb));break;case Oa.a.x0f:case Oa.a.j$d:Xd===Oa.a.j$d?mg.OutlineNavigator.hzi(Sb,!1):mg.OutlineNavigator.hzi(Sb,!0);Nd.setSelection(Kf.SelectionFactory.kq(Sb.currentNode));Ac=32;break;case Oa.a.z4c:Ac=r.AFrameworkApplication.ya.Tf(Yb,Xd,Ac,!0,Sc,nd);break;default:if(Ac=r.AFrameworkApplication.ya.Tf(Yb,Xd,Ac,!0,Sc,nd),!vg&&Vf&&(Xd===Oa.a.GE||Xd===Oa.a.ML)){const kj=Se.SelectionEditor.qBa(Nd.hb.kb).y;Ra.App.gec(()=>{this.aWm(Nd,ce,kj)})}}32===
Ac&&Yb.view.ue&&this.Kh.aG();return Ac};this.wka=b;this.DNe=h;this.Om=u;this.M0=y;this.pY=P;this.GNe=aa;this.$Ha=ta;this.Wc=Pa;this.Ic=vb;this.Ywe=Kb}get Kh(){return this.Yl||(this.Yl=this.wka())}Wb(){const b=r.AFrameworkApplication.ya,h=this.Qio;b.gb(Oa.a.tab,oc.a.view,h,1124);b.gb(Oa.a.j4f,oc.a.view,h,1124);b.pa(Oa.a.Idi,oc.a.view,De.ActionManager.Mf)}aWm(b,h,u){if(b&&h){var y=b.hb.kb;Se.SelectionEditor.qBa(y).y<u?(h=Se.SelectionEditor.JIc(h,y,!1),h=Se.SelectionEditor.rua(h,{hB:!1,Ns:!1,fD:!1,XE:!0})):
h=Se.SelectionEditor.UGd(h,y,!1);b.setSelection(h)}}Q8j(){return Oa.a.m1a}gei(){}oVc(b,h,u){if(b&&h){var y=b.hb.kb;Se.SelectionEditor.qBa(y).y<u?(h=Se.SelectionEditor.JIc(h,y,!1),h=Se.SelectionEditor.rua(h,{hB:!1,Ns:!1,fD:!1,XE:!0})):h=Se.SelectionEditor.rua(y,{hB:!1,Ns:!1,fD:!1,XE:!0});b.setSelection(h)}}static get ag(){return sd.a.instance}static get Yg(){return im.ContextSetEditor.instance}}Object(m.a)(FE,"TabActor",null,[]);class IG{constructor(b){this.Frc=b}get Vp(){return this.Frc}kln(b){return b}S0l(b,
h,u,y){const P=y.view,aa=P.Bb.hb.kb;if(hi.TableCellReader.Gna(b))return this.Tji(b,y)?Oa.a.GE:Oa.a.c_d;og.OutlineElementNavigator.$d(b);if(Se.SelectionEditor.pf(h))wg.OutlineElementReader.cA(b,h,!1)&&this.N$i(b)?u=Oa.a.VJb:Se.SelectionEditor.$Rc(P,aa)&&this.Vp.Gyb(b)?u=Oa.a.GE:Se.SelectionEditor.$Rc(P,aa)&&(u=Oa.a.GE);else if(Se.SelectionEditor.Ek(h)){if(!this.Vp.Gyb(b))return u;Se.SelectionEditor.nib(h)?u=Oa.a.GE:Se.SelectionEditor.Moi(h)&&(u=this.N$i(b)?Oa.a.VJb:Oa.a.GE)}else this.Vp.Gyb(b)&&(u=
Oa.a.GE);return u}R0l(b,h,u,y){if(hi.TableCellReader.e_(b))return this.Tji(b,y)?Oa.a.ML:u;og.OutlineElementNavigator.$d(b);if(Se.SelectionEditor.pf(h))wg.OutlineElementReader.cA(b,h,!1)&&(!wj.ListReader.lj(b)&&wg.OutlineElementReader.isEmpty(b,!1)?u=De.ActionManager.kwa:this.w5n(b)?u=Oa.a.neb:this.Y9i(b)?u=Oa.a.qAb:this.Vp.R_b(b)&&(u=Oa.a.ML));else if(Se.SelectionEditor.Ek(h)){if(!this.Vp.R_b(b))return u;Se.SelectionEditor.nib(h)?u=Oa.a.ML:Se.SelectionEditor.Moi(h)&&(u=this.Y9i(b)?Oa.a.qAb:Oa.a.ML)}else this.Vp.R_b(b)&&
(u=Oa.a.ML);return u}N$i(b){return wj.ListReader.lj(b)?!1:0<wg.OutlineElementReader.Z2(b)?!0:!1}Y9i(b){if(wj.ListReader.lj(b))return!1;const h=wg.OutlineElementReader.Z2(b);b=Jf.OutlineReader.ZN(b.currentNode);return h<b?!0:!1}w5n(b){return wj.ListReader.lj(b)?!1:0<wg.OutlineElementReader.QF(b)?!0:!1}static yr(){return new IG(dv.a.SCb)}Tji(b,h){if(this.oum){h=h.view;const u=h.Bb.hb.kb,y=new yd.GraphIterator;y.ed(b);og.OutlineElementNavigator.$d(y);if(wj.ListReader.lj(y)&&Se.SelectionEditor.$Rc(h,
u))return!0}return!1}get oum(){var b;r.AFrameworkApplication.Ce("egdi3422;7g6fa693");return null===(b=r.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(m.a)(IG,"TabActorPromoteDemoteStrategy",null,[167]);class QC extends FE{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac){super(b,h,u,y,P,aa,ta,Pa,vb,Kb);this.A1d=(Sc,nd)=>{Sc=nd.property;!this.w0c||Sc!==Lc.a.Ao&&Sc!==Lc.a.marginLeft&&Sc!==Lc.a.marginRight||this.w0c.Mfi()};
this.ZN=(Sc,nd,Ad,he,ce)=>{Sc=Jf.OutlineReader.ZN(this.XNl(nd));ce.defaultTabStop=Sc;return 32};this.cVb=Sb;this.ga=Ac;this.fB();this.ga.pa(Rc.a.ZN,oc.a.view,this.ZN)}get w0c(){return null!=this.Dvg?this.Dvg:this.Dvg=Ja.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}fB(){this.cVb.sl.Xe(10).Ap(this.A1d)}gei(b){const h=b.view,u=h.Bb;b=u.Lg;if(this.$Ha&&this.Ic){var y=this.Ic.Qc(15);y.Eb(b.node);b.contextId===oc.a.Fd&&r.AFrameworkApplication.ya.processAction(Oa.a.gH,2);this.$Ha.$Qd(u.Lg);
y.dispose();var P=Se.SelectionEditor.qBa(u.hb.kb).y;Ra.App.gec(()=>{this.oVc(u,h,P)})}}XNl(b){return b.view.Bb.hb.kb.Qa.node}static get instance(){return null!=QC.jsg?QC.jsg:QC.jsg=QC.Jl()}static Jl(){return new QC(()=>Ja.a.instance.resolve("Box4.IUndoManager"),IG.yr(),Ja.a.instance.Za("Box4.IExternalSelectionManager"),Ja.a.instance.resolve("Box4.IAutoCorrectRules"),Ja.a.instance.resolve("Box4.IAutoCorrectScheduler"),Ja.a.instance.Pa("Box4.ITabPresenterFactory"),Ja.a.instance.Pa("Box4.IBlobEditor"),
Ja.a.instance.Pa("Box4.IFeatureHelper"),Ja.a.instance.Pa("Box4.Graph.GraphTransactionFactory"),Ja.a.instance.Pa("Box4.Actors.IIFrameFocusStrategy"),Ra.App.kk,Ja.a.instance.Pa("Box4.ITabRenderer"),r.AFrameworkApplication.ya)}}Object(m.a)(QC,"TabActor",FE,[]);class jx{static get $s(){return null!=jx.Klg?jx.Klg:jx.Klg=Ja.a.instance.resolve("Box4.IAppFrame")}static initialize(){Tt.a.y9b=jx.kvm;Tt.a.Tee=jx.sHo}static kvm(b){return!xh.TableReader.qqm(b)}static wkb(){jx.$s.wec(jx.wkb);jx.pub=!1;const b=
appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static sHo(b){var h,u,y;b&&((null===(h=Zq.a.instance.kb)||void 0===h?0:h.xEa)||(null===(u=Zq.a.instance.kb)||void 0===u?0:u.Lw)||(null===(y=Zq.a.instance.kb)||void 0===y?0:y.hGb))&&!jx.pub&&(jx.$s.MXa(jx.wkb),jx.pub=!0)}}jx.pub=!1;Object(m.a)(jx,"TableActor",null,[]);var ZM=c(906);class JG{Qjl(b,h,u,y){return b?
this.ril(h,u,y):this.Rjl(h,u,y)}SNh(b,h,u,y,P){return b?this.ujl(h,u,y,P):this.hjl(h,u,y,P)}ejl(b){let h=!1;var u=b.Sf?b.Me.Tc:b.Me.Qa;b=new yd.GraphIterator;b.set(u.node);b.Ab(14);u=null;hi.TableCellReader.Waa(b)?hi.TableCellReader.yFb(b)||(h=!0,u=wf.moveToNextRow(b)):u=wf.moveToNextColumn(b);return{returnValue:u,sWm:h}}pjl(b){var h=b.Sf?b.Me.Tc:b.Me.Qa;const u=new yd.GraphIterator;u.set(h.node);u.Ab(14);h=null;hi.TableCellReader.cga(u)?hi.TableCellReader.bga(u)||(h=new yd.GraphIterator,h.set(b.sBa.node),
h.Ab(14),b=pm.a.Ar(h),pm.a.Ar(u)>b?(wf.moveToPreviousRow(u),wf.moveToLastColumn(u),h=u.currentNode):h=wf.moveToPreviousRow(u)):h=wf.moveToPreviousColumn(u);return h}fOh(b,h){var u=b.Sf?b.Me.Tc:b.Me.Qa;b=new yd.GraphIterator;b.set(u.node);b.Ab(14);u=null;h?hi.TableCellReader.bga(b)||(u=wf.moveToPreviousRow(b)):hi.TableCellReader.yFb(b)||(u=wf.moveToNextRow(b));return u}wGb(b,h,u){for(;hi.TableCellReader.pg(b);)if(h){if(u&&b.sva(1)||!u&&b.yva(1))return null;u?wf.moveToPreviousColumn(b):wf.moveToNextColumn(b)}else{if(hi.TableCellReader.z3(b.currentNode)){const y=
new yd.GraphIterator;y.ed(b);if(this.wGb(y,!0,!0)||this.wGb(y,!0,!1)){b.ed(y);break}}else{if(!u&&wf.moveToControllingCell(b,2))break;if(u&&wf.moveToControllingCell(b))break}if(u&&hi.TableCellReader.bga(b)||!u&&hi.TableCellReader.yFb(b))return null;u?wf.moveToPreviousRow(b):wf.moveToNextRow(b)}return b.currentNode}J3b(b,h){if(!pm.a.isTableRow(b))return null;b=yd.GraphIterator.$a(b.currentNode);b.Ab(14);let u;const y=xh.TableReader.YA(b.origin);do u=h?wf.moveToPreviousRow(b):wf.moveToNextRow(b);while(y&&
u&&pm.a.ZOa(b));return u}Zjb(b,h,u,y,P){let aa=null;og.OutlineElementNavigator.$d(b);const ta=wg.OutlineElementReader.isRtl(b.currentNode);if(u)if(wf.returnToCell(b),h=hi.TableCellReader.Waa(b),u=hi.TableCellReader.cga(b),P||!ta&&u||ta&&y&&h)wf.returnToContainingRow(b),(y=this.J3b(b,!0))?aa=Kf.SelectionFactory.Un(y,!h):P&&(og.OutlineElementNavigator.$d(b),P=new Hi.a,P.ed(b),(b=og.OutlineElementNavigator.u_(P,!1,!1))&&(aa=Kf.SelectionFactory.Un(b,!1)));else{do ta?wf.moveToNextColumn(b):wf.moveToPreviousColumn(b);
while(hi.TableCellReader.pg(b)&&!hi.TableCellReader.bga(b));hi.TableCellReader.pg(b)||(aa=Kf.SelectionFactory.Un(b.currentNode,!ta))}else wg.OutlineElementReader.cA(b,h,ta)||Se.SelectionEditor.pf(h)||wf.returnToCell(b),aa=Kf.SelectionFactory.Un(b.currentNode,!ta);return aa}Yjb(b,h,u,y,P){let aa=null;og.OutlineElementNavigator.$d(b);const ta=wg.OutlineElementReader.isRtl(b.currentNode);if(u)if(wf.returnToCell(b),u=hi.TableCellReader.Waa(b),h=hi.TableCellReader.cga(b),P||!ta&&y&&u||ta&&!y&&h)wf.returnToContainingRow(b),
(y=this.J3b(b,!1))?aa=Kf.SelectionFactory.Un(y,h):(og.OutlineElementNavigator.$d(b),y=new Hi.a,y.ed(b),(b=og.OutlineElementNavigator.Jr(y,!1,!1))&&(aa=Kf.SelectionFactory.Un(b,!0)));else{do ta?wf.moveToPreviousColumn(b):wf.moveToNextColumn(b);while(hi.TableCellReader.pg(b)&&!hi.TableCellReader.Waa(b));hi.TableCellReader.pg(b)||(aa=Kf.SelectionFactory.Un(b.currentNode,ta))}else wg.OutlineElementReader.cA(b,h,!ta)||Se.SelectionEditor.pf(h)||wf.returnToCell(b),aa=Kf.SelectionFactory.Un(b.currentNode,
ta);return aa}}Object(m.a)(JG,"ATableCellSelectionStrategy",null,[1361]);class AK extends JG{constructor(){super()}hjl(b,h,u,y){let P=b.kb,aa=null;if(b.Lw)if(h)if(2===P.Me.doa&&!P.Sf&&P.Me.Tc.equals(P.sBa))P=Kf.SelectionFactory.ZAh(P.sBa.node,!1);else{var ta=({sWm:b}=this.ejl(P)).returnValue;ta&&(hi.TableCellReader.Er(ta)&&(ta=yd.GraphIterator.$a(ta),ta.Ab(14),ta=!b&&this.wGb(ta,!0,!1)?ta.currentNode:b||wf.moveToNextRow(ta)?this.wGb(ta,!1,!1):null),ta&&(aa=Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(ta),
P.Sf)))}else P=b.Cca,b=yd.GraphIterator.$a(P.Me.Tc.node),b.Ab(14),hi.TableCellReader.jEa(b.currentNode)&&wf.moveToLastGhostCell(b,2),(ta=wf.moveToNextColumn(b))?(b=hi.TableCellReader.z3(ta),hi.TableCellReader.Er(ta)&&!b&&(ta=yd.GraphIterator.$a(ta),ta.Ab(14),ta=wf.moveToControllingCell(ta)),b?P=Kf.SelectionFactory.Un(P.Me.Tc.node,!1):aa=Kf.SelectionFactory.Un(ta,!0)):(ta=P.Me.Tc.node,aa=Kf.SelectionFactory.Un(ta,!1));else b=h&&P.Sf||!h&&!P.Nva?P.Me.Tc:P.Me.Qa,pm.a.Hna(b.node)&&(b=yd.GraphIterator.$a(b.node),
(ta=this.J3b(b,!1))?aa=h?Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(ta),P.Sf):Kf.SelectionFactory.Un(ta,!0):P=Se.SelectionEditor.Vj(Kf.SelectionFactory.kq(b.currentNode),!1,!0));return aa?aa:y?Se.SelectionEditor.I3b(P,!1,h,!0):Se.SelectionEditor.rua(P,{hB:!h,Ns:h,fD:u,XE:!0})}ujl(b,h,u,y){let P=b.kb;var aa=null;if(b.Lw)h?1===P.Me.doa&&P.Sf&&P.Me.Qa.equals(P.sBa)||(aa=this.pjl(P),(aa=this.QNh(P,aa))||P.Sf&&(P=P.cJc())):(P=b.Cca,aa=Kf.SelectionFactory.Un(P.Me.Qa.node,!0));else if(h){var ta=(P.Sf?
P.Me.Tc:P.Me.Qa).node;b=yd.GraphIterator.$a(ta);Se.SelectionEditor.eu(b);pm.a.Hna(ta)&&(P.Sf&&1===P.Me.doa&&P.Nva?(aa=pm.a.LA(ta).toArray(),(aa=this.QNh(P,0<=aa.length-2?aa[aa.length-2]:null))||P.Sf&&(P=P.cJc())):(ta=this.J3b(b,!0))?aa=Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(ta),P.Sf):P=Kf.SelectionFactory.Un(b.currentNode,!0))}else aa=Se.SelectionEditor.Vj(P,!0,!1);return aa?aa:y?Se.SelectionEditor.I3b(P,!0,h,!0):Se.SelectionEditor.NCa(P,{hB:!h,Ns:h,fD:u,XE:!0})}QNh(b,h){if(!h)return null;
var u=h;hi.TableCellReader.Er(h)&&(u=yd.GraphIterator.$a(h),u.Ab(14),u=this.wGb(u,!0,!0)?u.currentNode:hi.TableCellReader.kfa(h));return u?Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(u),b.Sf):null}Rjl(b,h,u){let y=h.kb,P=null;if(h.Lw){var aa=h.EW>h.PGa;if(u)if(2===h.length&&1===h.Cca.Me.doa&&aa)y=Se.SelectionEditor.Vj(y,!0,!1);else{if(h=this.fOh(y,!0))hi.TableCellReader.Er(h)&&(h=yd.GraphIterator.$a(h),h.Ab(14),h=this.wGb(h,!1,!0)),h&&(P=Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(h),
y.Sf));P||y.Sf&&(y=y.cJc())}else aa&&(y=h.Cca)}else h=u&&y.Sf?y.Me.Tc:y.Me.Qa,pm.a.Hna(h.node)&&(h=yd.GraphIterator.$a(h.node),(aa=this.J3b(h,!0))?P=u?Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(aa),y.Sf):Kf.SelectionFactory.Un(aa,!0):u&&(y=Kf.SelectionFactory.Un(h.currentNode,!0)));return P?P:Se.SelectionEditor.Tdb(b,y,!1,u,u)}ril(b,h,u){let y=h.kb,P=null;if(h.Lw){const aa=h.EW<h.PGa;if(u)if(2===h.length&&1===h.Cca.Me.doa&&aa)y=Se.SelectionEditor.Vj(y,!1,!1);else{if(h=this.fOh(y,!1))hi.TableCellReader.Er(h)&&
(h=yd.GraphIterator.$a(h),h.Ab(14),h=this.wGb(h,!1,!1)),h&&(P=Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(h),y.Sf))}else aa&&(y=h.Cca)}else h=!u||y.Sf?y.Me.Tc:y.Me.Qa,pm.a.Hna(h.node)&&(h=yd.GraphIterator.$a(h.node),(h=this.J3b(h,!1))&&(P=u?Kf.SelectionFactory.Vn(Lq.TableNodeContext.create(h),y.Sf):Kf.SelectionFactory.Un(h,y.Nva)));return P?P:Se.SelectionEditor.Tdb(b,y,!0,u,u)}}Object(m.a)(AK,"TableCellSelectionStrategy",JG,[]);class BK{constructor(b){this.wM=(h,u,y,P,aa)=>{if(1===y)return 32;
h=(new Xl.a).create();u="";switch(aa.DialogType){case "DirectPrintPreparingPDF":u=CommonUIStrings.l_DirectPrintPreparingPDF;aa=CommonUIStrings.l_DefaultDialogTitle;break;default:aa=CommonUIStrings.l_DefaultDialogTitle}h.message=u;h.wM(aa,null,null);return 32};this.ga=b}Wb(){this.ga.gb(Oa.a.wM,oc.a.view,this.wM,1028)}}Object(m.a)(BK,"UIAutomationActor",null,[]);class CK{constructor(b,h,u,y){this.eb=b;this.$Ha=h;this.pmc=u;this.v5=y}Yag(b,h,u){return this.pmc.dtm(h)?u?!0:b&&this.eb.rh(b)?(b=this.Dw(b.currentNode),
this.$Ha.rei(b),!0):!1:!1}gpf(b,h){return this.pmc.jdl(b,h)}npf(b){b&&this.eb.rh(b)&&(b=this.Dw(b.currentNode),this.$Ha.$Qd(b))}Dw(b){return nf.a.Dw(b)}tGa(b,h,u){this.v5.YKi&&this.pmc.Aii(u)&&(this.v5.tGa(b,h),b.setValue(ld.a.Rii,!0))}Eae(){}eTd(b){return this.pmc.eTd(b)}get lUd(){return this.pmc.lUd}sC(){}Qha(){}Xae(){}get laj(){return!1}}Object(m.a)(CK,"WordEditorPasteStewardBridge",null,[141]);class DK{constructor(b){this.sa=new ie.a;this.L0i="WordFileSaveAsButtonClicked";this.uHo=()=>{this.sa.raiseEvent(this.L0i,
null);return 32};this.ga=b}Wb(){r.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.pa(Rc.a.Wtj,le.a.frame,this.uHo)}dgk(b){this.sa.addHandler(this.L0i,b)}}Object(m.a)(DK,"WordFileSaveAsActor",null,[]);class EK extends xs{constructor(){super()}qBc(b,h,u,y,P,aa,ta){return Ur.a.$cc(h,u,y,P,aa,ta)}}Object(m.a)(EK,"WordIndentationActorExtension",xs,[]);class KG{constructor(){this.Khd=null}get name(){return"WordEditor.Actors"}init(){var b;ab.InteractiveViewManager.instance.editingView.d2b=
!0;r.AFrameworkApplication.ya.pa(Rc.a.vGo,le.a.frame,EM);this.W.resolve("WordEditor.Actors.DeleteActor").Wb(r.AFrameworkApplication.ya);JC.instance.Wb();mn.Wb();Hr.Wb(r.AFrameworkApplication.ya,this.W.resolve("WordEditor.IMainViewModeManager"));kk.Wb();QC.instance.Wb();ZM.a.Wb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Wb(r.AFrameworkApplication.ya);this.W.resolve("WordEditor.Actors.ExternalContentActor").Wb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Wb();r.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&
this.W.resolve("Box4.Actors.FormatPainterActor").Wb();r.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Wb();r.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&r.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.PV.sUd=!0);r.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Wb();
r.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Wb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Wb();this.W.resolve("Common.IOfficeTrialExperience").Wb();this.W.resolve("Common.IMacOfficeOffer").Wb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Wb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Wb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Wb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Wb();
this.W.resolve("WordEditor.Actors.StylesActor").Wb();(null===(b=r.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Wb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Wb();this.W.resolve("WordEditor.Actors.ProofingActor").Wb();this.W.resolve("WordEditor.Actors.PageActor").Wb();this.W.resolve("WordEditor.Actors.DarkModeActor").Wb();this.W.resolve("WordEditor.Actors.ImageActor").Wb(r.AFrameworkApplication.ya);
this.W.resolve("WordEditor.Actors.FormattingActor").Wb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Wb();this.W.resolve("WordEditor.Actors.ContentControlActor").Wb();this.W.resolve("WordEditor.Actors.CustomTabActor").Wb();this.W.resolve("WordEditor.Actors.BookmarkActor").Wb();this.W.resolve("WordEditor.Actors.HeadingsActor").Wb();this.W.resolve("Box4.Indicator.IIndicatorManager").t4a(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Wb();
this.W.resolve("WordEditor.Actors.AccessibilityActor").hWf();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Wb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Wb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Wb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").b4();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Wb();
r.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.Pxn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Wb();this.vV.s4a(this.wFj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");r.AFrameworkApplication.Ce("bookmarks-core-ex;bookmarks-core-ex-cf");r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.P9h(!1)&&Ra.App.xa.jb.IJh();Ra.App.xa.updateCommandUI();jx.initialize()}dispose(){}Pxn(){this.Wc.hp.isCompleted?
this.Wc&&this.Wc.isFeatureEnabled(47)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Wb():this.Wc.hp.continueWith(()=>{this.Wc&&this.Wc.isFeatureEnabled(47)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Wb(),Ra.App.xa.updateCommandUI())})}get wtm(){if(null==this.Khd)if(this.Wc)if(this.Wc.hp.isCompleted)this.Khd=this.Wc.isFeatureEnabled(30)&&this.Wc.isFeatureEnabled(2);else return!1;else this.Khd=!1;return this.Khd}xc(b){var h;this.W=b;this.Wc=b.Pa("Box4.IFeatureHelper");this.PV=
this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.PV.LRc=r.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new $I).xc(b);b.ha("Box4.IClipboardCommands",()=>new aJ(r.AFrameworkApplication.ya,Oa.a.CYe,Oa.a.iCc,Oa.a.r2,Oa.a.MPf,Oa.a.paste,Oa.a.n8,Oa.a.ulb)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const u=b.resolve("Common.IAppSettingsManager");
return new dy(!0,u.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const u=b.resolve("Common.IAppSettingsManager"),y=P=>!P.n8b;return new Ir(u.$("ExternalPasteImprovementsEnabled"),u.$("PasteComplexTablesIsEnabled"),!0,u.$("WordWacQoEListBulletsLevelExternalPasteImprovementIsEnabled"),!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,u.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,P=>P.n8b,()=>!1,y,y,y,y,void 0,()=>this.wtm,
P=>!P.n8b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new CK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new pK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();
b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new bJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();b.ha("Box4.IIndentationCommands",()=>new cJ(r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new dJ(r.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ISpacingCommands",()=>new eJ(r.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.IPageCommands",()=>new lK(r.AFrameworkApplication.ya)).singleInstance();
b.ha("WordEditor.Actors.StylesActor",()=>new xK(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(h=r.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new EE(r.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.DigitalPrintActor",()=>new yG(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"))).singleInstance();
b.ha("WordEditor.Actors.FileDownloadManager",()=>new TJ(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new wM.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",()=>new QJ(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),r.AFrameworkApplication.K.$("DisablePrint"),r.AFrameworkApplication.K.lb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).singleInstance();b.ha("WordEditor.Actors.ParagraphDialogActor",
()=>new nK(r.AFrameworkApplication.ya,b.af("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),so.a.instance,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new jK(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"),so.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",()=>new JJ(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"),
so.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new eD.a(b.Za("Common.ISystemInitiatedFeedback"),yM.a.K4b())).as("WordEditor.IModeSwitcherControl").singleInstance();b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new mK(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"),so.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new dK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();b.register(OJ,
"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new qK(r.AFrameworkApplication.ya,sd.a.instance,Ja.a.instance.resolve("Box4.ISelectionManager"),vt.a.instance,Ja.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ja.a.instance.resolve("Box4.ILanguageReader"),Ja.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ja.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ja.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),
this.PV,Ja.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),r.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ja.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();(r.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").pA.loadScript("EditorSettingsManager")).then(()=>{const u=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");u.Mbm();
u.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new fJ(r.AFrameworkApplication.ya,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new gJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();r.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&r.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Wb()});b.ha("WordEditor.Actors.PageActor",
()=>new kK(Ja.a.instance.resolve("Box4.IWordSectionEditor"),Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ja.a.instance.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",()=>new MJ(r.AFrameworkApplication.ya,r.AFrameworkApplication.K,Ra.App.z4,!!Ra.App.instance&&Ra.App.instance.hEa,!!Ra.App.instance&&Ra.App.instance.dSc,Ja.a.instance.resolve("Box4.IDarkModeState"),Ja.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
Ja.a.instance.resolve("Box4.DarkModeEventsManager"),!!Ra.App.instance&&Ra.App.instance.vna)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new VJ(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",()=>new rJ(b.Za("Box4.Accessibility.IAccessibilityContextManager"),b.af("WordEditor.FlatListDetailsProvider"),b.af("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.af("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();
b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new FJ(r.AFrameworkApplication.ya,b.Za("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>{var u,y;return new pr(b.resolve("WordEditor.IImageEditor"),b.Za("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),
(null===(u=Ra.App.instance)||void 0===u?0:u.tib)?b.resolve("Box4.Images.ImageNavigator"):null,(null===(y=Ra.App.instance)||void 0===y?0:y.tib)?b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"):null,b.resolve("Box4.IAppFrame"),r.AFrameworkApplication.K)}).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new DK(r.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new uK(b.resolve("WordEditor.IImageEditor"),
r.AFrameworkApplication.K,r.AFrameworkApplication.ta.yDa,Ja.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new NJ.DeleteActor(Ja.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ja.a.instance.Za("Box4.ContentControlConfigSettings"),
Ja.a.instance.Za("Box4.IContentControlEditor"),Ja.a.instance.resolve("Box4.IDynamicRangeEditor"),Ja.a.instance.Za("WordEditor.Bookmark.IBookmarkManager"),Ja.a.instance.resolve("Box4.IHyperlinkEditor"),Ja.a.instance.resolve("Box4.IHyperlinkStrategy"),Ja.a.instance.resolve("Box4.IParagraphReader"),Ja.a.instance.resolve("Box4.IParagraphIndentationReader"),Ja.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ja.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ja.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).singleInstance();
this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new zK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),r.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new AK).as("Box4.ITableCellSelectionStrategy").singleInstance();r.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new hJ(b.resolve("Box4.Styles.IWACStyleEditor"),
b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),sd.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IFormatPainter").singleInstance();
b.ha("Box4.Actors.FormatPainterActor",()=>new KC(Ra.App.xa,ub.FocusManager.instance(),r.AFrameworkApplication.ya,ri.a.instance,Zq.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Ra.App.instance&&Ra.App.instance.vna,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new WJ(r.AFrameworkApplication.ya,b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",
()=>new BK(r.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new wK(r.AFrameworkApplication.ya,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new iJ(b.Pa("Box4.IAutoCorrectScheduler"),b.af("Box4.IUndoManager"),b.Za("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",()=>new dC(se.PageReader.instance,b.af("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance();
b.ha("WordEditor.Actors.ContentControlActor",()=>new KJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),r.AFrameworkApplication.ya,
r.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),pe.a.instance.J(7))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new sJ(r.AFrameworkApplication.ya,b.af("WordEditor.UI.IDialogFactory"),ub.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new jJ).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new xF(r.AFrameworkApplication.Ve,
xl.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Ja.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),r.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();b.ha("WordEditor.Actors.GraphicsEditorActor",()=>new aK(r.AFrameworkApplication.ya,
r.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),r.AFrameworkApplication.Ve,this.Wc,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new vK).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new LJ(r.AFrameworkApplication.ya,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new bK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),r.AFrameworkApplication.ya,b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>
new IJ(Ra.App.xa,r.AFrameworkApplication.ya,Hh.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Zf.a(()=>Ra.App.xa.jb.Yc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),vt.a.instance,this.W.Za("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),ab.InteractiveViewManager.instance,this.W.af("WordEditor.UI.IDialogFactory"),
this.W.resolve("Box4.BookmarkParagraphMapping"),sd.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var u,y;return new jt(b.resolve("Box4.IParagraphReader"),Re.a.instance,th.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(y=null===(u=Ra.App.instance)||void 0===u?void 0:u.bC)&&void 0!==y?y:!1,new Zf.a(()=>Ra.App.xa.jb.wc))}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new cK).singleInstance();
b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new OC(Hh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),ab.InteractiveViewManager.instance,Je.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new lt(r.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),r.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new qJ).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new tJ(r.AFrameworkApplication.K,r.AFrameworkApplication.ya)).as("WordEditor.Actors.ActionHangDetector").singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new NC(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),
ab.InteractiveViewManager.instance,tt.a.instance(),r.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Ra.App.kk.sl.Xe(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new EK).as("Box4.Actors.IIndentationActorExtension").singleInstance();r.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new FG(r.AFrameworkApplication.ya)).singleInstance());
r.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new IF(r.AFrameworkApplication.ya)).singleInstance();(new XI).xc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new pJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",
()=>new mJ(r.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new nJ(r.AFrameworkApplication.ya,r.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),sd.a.instance)).singleInstance();this.wFj=new kJ;this.vV=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){K.a.instance.Kc(new KG)}}
Object(m.a)(KG,"WordEditorActorsPackage",null,[1,2]);class FK{constructor(b){this.msc=!1;this.pEi=()=>{this.msc=!0;this.Zs.WXf(this.pEi)};this.Zs=b;this.Zs.qZb(this.pEi)}}Object(m.a)(FK,"GraphFullyConnectedGetter",null,[290]);class Pf{constructor(){this.zUg=Object.assign(new kl.a,{})}w$j(b,h){let u;const y=b&1023;({value:u}=this.zUg.Gc(y,0)).returnValue||Pf.g0l().contains(y)||w.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,y);u+=h;this.zUg.Z(y,u);return u}static g0l(){Pf.$qd||
(Pf.$qd=new Ea.a,Pf.rc(0),Pf.rc(1),Pf.rc(2),Pf.rc(3),Pf.rc(4),Pf.rc(5),Pf.rc(6),Pf.rc(7),Pf.rc(8),Pf.rc(9),Pf.rc(10),Pf.rc(11),Pf.rc(12),Pf.rc(13),Pf.rc(14),Pf.rc(15),Pf.rc(16),Pf.rc(17),Pf.rc(18),Pf.rc(19),Pf.rc(20),Pf.rc(21),Pf.rc(22),Pf.rc(23),Pf.rc(24),Pf.rc(25),Pf.rc(26),Pf.rc(27),Pf.rc(28),Pf.rc(29),Pf.rc(30),Pf.rc(31),Pf.rc(32),Pf.rc(33),Pf.rc(34),Pf.rc(35),Pf.rc(36),Pf.rc(37),Pf.rc(38),Pf.rc(39),Pf.rc(40),Pf.rc(41),Pf.rc(42),Pf.rc(43),Pf.rc(44),Pf.rc(45),Pf.rc(46),Pf.rc(47),Pf.rc(48),Pf.rc(49),
Pf.rc(50),Pf.rc(51),Pf.rc(52),Pf.rc(53),Pf.rc(54),Pf.rc(55),Pf.rc(56),Pf.rc(57),Pf.rc(58),Pf.rc(59),Pf.rc(60),Pf.rc(61),Pf.rc(62),Pf.rc(63),Pf.rc(64),Pf.rc(65),Pf.rc(66),Pf.rc(67),Pf.rc(68),Pf.rc(69),Pf.rc(70),Pf.rc(71),Pf.rc(72),Pf.rc(73),Pf.rc(74),Pf.rc(75),Pf.rc(76),Pf.rc(77),Pf.rc(78),Pf.rc(79),Pf.rc(80),Pf.rc(81),Pf.rc(82),Pf.rc(83),Pf.rc(84),Pf.rc(85),Pf.rc(86),Pf.rc(87),Pf.rc(88),Pf.rc(89),Pf.rc(90),Pf.rc(91),Pf.rc(92),Pf.rc(93),Pf.rc(94),Pf.rc(95),Pf.rc(96),Pf.rc(97),Pf.rc(98),Pf.rc(99),Pf.rc(100),
Pf.rc(101),Pf.rc(102),Pf.rc(103),Pf.rc(104),Pf.rc(105),Pf.rc(106),Pf.rc(107),Pf.rc(108),Pf.rc(109),Pf.rc(110),Pf.rc(111),Pf.rc(112),Pf.rc(113),Pf.rc(114),Pf.rc(115),Pf.rc(116),Pf.rc(117),Pf.rc(118),Pf.rc(119),Pf.rc(120),Pf.rc(121),Pf.rc(122),Pf.rc(124),Pf.rc(126),Pf.rc(127),Pf.rc(128),Pf.rc(129),Pf.rc(130),Pf.rc(131),Pf.rc(132),Pf.rc(133),Pf.rc(134),Pf.rc(135),Pf.rc(136),Pf.rc(140),Pf.rc(145),Pf.rc(146),Pf.rc(147));return Pf.$qd}static rc(b){Pf.$qd.add(b&1023)}}Pf.$qd=null;Object(m.a)(Pf,"LanguagePerParagraphModel",
null,[]);class GK{constructor(){this.o5f=!1;this.vyd=this.uyd=this.sPb=0;this.mpi=!0;this.XJo=0}}Object(m.a)(GK,"UpdateWordCountStateResult",null,[]);class HK extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(m.a)(HK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class IK{constructor(){this.Tqh=this.Sqh=this.wordCount=-1;this.MAb=this.Dmh=0;this.LAb=1;this.rKi=1033}}Object(m.a)(IK,"WordCountCache",null,[]);class JK extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(m.a)(JK,"WordCountChangedEventArg",Sys.EventArgs,[]);class KK{constructor(){this.ukc=this.zBa=0}}Object(m.a)(KK,"CharsCountResult",null,[]);class LK{constructor(){this.cp=0;this.wkc=null;this.s6=this.t6=0}}Object(m.a)(LK,"TextChunkResult",null,[]);class MK{constructor(){this.Ktj=this.t6=this.s6=this.wordCount=0}}Object(m.a)(MK,"WordCountStateForParagraph",null,[]);class LG{constructor(){this.Cpa=this.nQ=this.t6=this.s6=this.C_=this.wordCount=0;this.currentNode=null;this.EW=-1;this.cp=0;
this.cQf=[];this.LAb=this.MAb=this.mYa=this.YPf=this.ZPf=0;this.HH=this.yji=!1;this.jpb=new ob.a;this.t2a=new ob.a}}Object(m.a)(LG,"WordCountState",null,[]);class qr{constructor(b,h,u,y,P,aa){this.Keo=1E3;this.sa=new ie.a;this.exb=null;this.Hle=0;this.wMj="\ue000";this.Uoc=!1;this.Qqe=this.Fqe=this.ecd=0;this.bGg=this.jGg=null;this.Cqe=this.Bqe=this.Kqe=0;this.P7k=ta=>{this.exb=null;this.B9e(ta.customData)};this.BB=h;this.GKj=new RegExp(ro.AParagraphNode.UB,"g");this.hd=b;this.taskManager=y;this.un=
u;this.zXa=aa;this.bVa=P.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Z0j=P.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.VYi()}get szm(){return!!this.exb}get KMa(){return this.Uoc}set KMa(b){this.Uoc=b}get cud(){return this.Hle}set cud(b){this.Hle=b}get xPa(){return!this.Hle}get bD(){return this.ecd}get Vzb(){return this.Fqe}get Yzb(){return this.Qqe}get CZk(){return this.jGg}get Z5e(){return this.bGg}get JFc(){return this.Kqe}get HFc(){return this.Bqe}get K1b(){return this.Cqe}qZb(b){this.sa.addHandler(qr.Uie,
b)}WXf(b){this.sa.removeHandler(qr.Uie,b)}YTe(b){this.sa.addHandler(qr.jfg,b)}lGn(b){this.sa.removeHandler(qr.jfg,b)}lDd(){this.kDd();this.VYi()}VYi(){this.Kqe=this.Cqe=this.Bqe=this.Qqe=this.Fqe=this.ecd=-1}k7e(){this.Hde(this.Keo)}L4c(){const b=new LG;b.yji=!0;this.kDd();this.B9e(b)}Hde(b,h=null){this.xPa&&(this.szm&&(h=null,this.kDd()),h||(h=new LG),b=new sc.a(3,1,b,this.P7k,this.Zgj),b.customData=h,this.Pdk(b))}kDd(){this.exb&&(this.taskManager.Se(this.exb),this.exb=null)}Tqj(b,h,u,y,P,aa=!0,
ta=-1,Pa=-1,vb=-1,Kb=1033){const Sb=new GK;Sb.sPb=u;Sb.uyd=P;Sb.vyd=y;if(!b.cp&&h.w8c&&aa&&!this.Z2h(h))return qr.UBo(b,h.w8c),Sb.mpi=!0,Sb;y=0<=Pa&&0<=vb?{xd:Pa,endCp:vb}:void 0;u=this.Hrl(h,y);y&&(Pa=y.xd,vb=y.endCp);u=0<=vb?u.substring(0,vb):u;vb=0<=Pa&&0<=vb?u.substring(Pa,vb):u;y=b.cp>=Pa?b.cp:Pa;P=b.cQf||[];aa=0<b.ZPf?b.ZPf:0;let Yb=0<b.YPf?b.YPf:0,Ac=[];b.HH=!1;do{this.zXa.update();if(!b.yji&&(Sb.sPb+Ac.length/2>qr.aHo||this.zXa.bkb())){let Ad;P=(Ad=P).concat.apply(Ad,Ac);b.cp=y;b.cQf=P;b.YPf=
Yb;b.ZPf=aa;b.EW=ta;b.currentNode=h;this.Hde(qr.xKo,b);Sb.o5f=!0;b.HH=!0;return Sb}if((!y||y===Pa)&&0<u.length&&y<u.length){P.push(Fv.a.instance.xnf(u,y));var Sc=this.Z2h(h);if(0<=ta&&!y&&Sc){b.wordCount+=1;Sb.sPb+=1;const Ad=this.hd.dO(Sc);Sc=this.BB.sbc(Ad,Sc);Sc=qr.nBd(Sc);b.t6+=Sc.zBa+1;b.s6+=Sc.zBa-Sc.ukc}}Sc=this.s7h(u,y,qr.MEk);y=Sc.cp;let nd;Ac=(nd=Ac).concat.apply(nd,Sc.wkc);aa+=Sc.t6;Yb+=Sc.s6}while(-1!==y);b=this.B8j(b,P,Ac,u,vb,Sb.sPb,Sb.uyd,Sb.vyd,h,-1===ta,Kb);Sb.sPb=b.wordCount;Sb.uyd=
b.s6;Sb.vyd=b.t6;Sb.XJo=b.Ktj;return Sb}JGh(b,h){const u=be.ParagraphReader.textLength(h,5);if(u){h=En.e(h);var y=0;for(let P=0;P<h.length;P++)if(this.yhb&&5===h[P].li&&b.nQ++,qr.b5n(h[P])){y++;break}h.length!==u?b.C_++:b.C_+=y}}X9i(b){this.cud=this.A5n(b.mYa,b.wordCount)?1:0;return!!this.cud}cIi(b){this.ecd=b.wordCount;this.Fqe=b.nQ;this.Qqe=b.Cpa;this.Cqe=b.t6;this.Bqe=b.s6;this.Kqe=b.C_;this.jGg=b.jpb;this.bGg=b.t2a;this.cRi(b)}cRi(b){this.sa.raiseEvent(qr.Uie,new JK(b))}bRi(){this.sa.raiseEvent(qr.jfg,
new HK(!1))}A5n(b,h){if(ba.a.kt||ba.a.jt||ba.a.pH)return!1;(h/=2)||(h=1);return(h?b/h:0)>qr.QRm?!0:!1}get yhb(){const b=!this.TDf||1===this.TDf&&this.Z0j;return this.bVa&&b}K_h(b,h){let u=1033,y=0;b=h.Ojf(b);h=new Pf;for(let P=0;P<b.length;P++){const aa=h.w$j(b[P].lcid,b[P].end-b[P].begin);y<aa&&(y=aa,u=b[P].lcid)}return u}B8j(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){var Yb;h=(Yb=h).concat.apply(Yb,u);u=Fv.a.instance.t7h(h,y);b.wordCount+=u.wordCount;const Ac=qr.nBd(P);P=Ac.zBa-Ac.ukc;Yb=Ac.zBa;b.s6+=P;b.t6+=
Yb;aa+=u.wordCount;ta+=Ac.zBa-Ac.ukc;Pa+=Ac.zBa;b.mYa+=u.mYa;({D9k:h,Tno:y}=qr.A8j(h,y));b.MAb+=h;b.LAb+=y;b.t2a.add(Sb);b.jpb.add(u.wordCount);Kb&&qr.Lxk(Yb,P,vb,u,h,y,Sb);b.cp=0;b.cQf=[];b=new MK;b.s6=ta;b.t6=Pa;b.wordCount=aa;b.Ktj=u.wordCount;return b}Hrl(b,h){let u=this.UHn(b);u=be.ParagraphReader.sBb(b,5,u,h);return this.pDn(u)}UHn(b){var h=be.ParagraphReader.text(b);b=En.e(b);if(0<b.length){h=h.split("");for(let y=0;y<b.length;++y){let P=!0;var u=!0;const aa=b[y];if(1===aa.li)u=aa,u=22!==u.kind&&
2!==u.kind;else if(5===aa.li)P=!1;else if(7===aa.li||10===aa.li)h[aa.Nb.cp]=this.wMj,P=!1;if(P){if(aa.Nb.cp>=h.length)return"";h[aa.Nb.cp]=u?" ":"C"}}h=h.join("")}return h}pDn(b){return b.replace(this.GKj,"")}s7h(b,h,u){const y=b.length-h<=u;var P=y?b.length:h+u;const aa=new LK;if(P<h)return aa.cp=-1,aa;aa.wkc=Fv.a.instance.ygf(b,h,P);P=qr.nBd(b.substr(h,P));aa.t6=P.zBa;aa.s6=P.zBa-P.ukc;if(!aa.wkc.length&&!y)return u===b.length-h?aa:this.s7h(b,h,b.length-h);aa.cp=y||!aa.wkc.length?-1:aa.wkc[aa.wkc.length-
1].cp;return aa}Pdk(b){this.exb=b;this.taskManager.Xb(this.exb)}Z2h(b){if(b=b.IS){const h=this.hd.dO(b);if(h&&h.Rt)return b}return null}static b5n(b){return 11===b.li}static UBo(b,h){b.wordCount+=h.wordCount;b.s6+=h.Sqh;b.t6+=h.Tqh;b.mYa+=h.Dmh;b.MAb+=h.MAb;b.LAb+=h.LAb;b.t2a.add(h.rKi);b.jpb.add(h.wordCount)}static Lxk(b,h,u,y,P,aa,ta){const Pa=new IK;Pa.wordCount=y.wordCount;Pa.Tqh=b;Pa.Sqh=h;Pa.Dmh=y.mYa;Pa.MAb=P;Pa.LAb=aa;Pa.rKi=ta;u.w8c=Pa}static nBd(b){const h=b.length,u=new KK;for(let P=0;P<
h;P++){var y=b.charCodeAt(P);u.zBa++;if(55296<=y&&56319>=y&&(y=P+1<h?b.charCodeAt(P+1):0,56320<=y&&57343>=y)){P++;continue}A.a.eba(b.charAt(P))&&u.ukc++}return u}static A8j(b,h){let u=0,y=0;for(let P=0;P<b.length;++P){const aa=b[P],ta=aa.YK;(3===ta||2===ta)&&aa.cp<h.length&&(++u,A.a.v8b(h.charCodeAt(aa.cp))&&++y)}return{D9k:y,Tno:u}}}qr.Uie="wctek";qr.jfg="wcac";qr.xKo=1;qr.MEk=400;qr.aHo=90;qr.QRm=.1;Object(m.a)(qr,"WordCountManagerBase",null,[301]);class NK extends qr{constructor(b,h,u,y,P,aa,ta,
Pa,vb,Kb,Sb){super(b,h,u,P,vb,Kb);this.SPh=this.prd=this.fka=null;this.joa=()=>{this.k7e()};this.ib=y;this.rd=ta;this.Q7g=Pa;this.XH=Sb;this.ib.DA(this.joa);this.Lze=vb.$("ReadingTimeIsEnabled")}get Zgj(){return 66}vem(){if(this.fka)return!0;if(!this.ib||!this.ib.hb)return this.rd&&(Ra.App.lSd||r.AFrameworkApplication.Rk?this.rd.fc("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.rd.fc("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.ib.hb.clone();this.fka=b.HN(!0);if(!this.fka||!this.fka.iz())return this.kDd(),!1;this.Q7g&&(this.prd=this.Q7g.create(h=>b.HN(h),this.un));this.fka.moveNext();return!0}get TDf(){return 1}jOk(b){return b===oc.a.Fd||b===oc.a.paragraph?!0:this.yhb&&(b===oc.a.CBb||b===oc.a.image||b===oc.a.anchoredObject)}B9e(b){this.zXa.reset();if(this.vem()){for(this.yhb&&this.prd&&(this.prd.J7k(b,this.zXa)||this.Hde(1,b));this.fka.current;){const y=-1===b.EW?0:b.EW;let P=0;var h=this.fka.current;if(!this.jOk(h.contextId)){this.fka.moveNext();
continue}if(this.yhb&&Jd.ImageReader.r1a(h)){b.nQ++;this.fka.moveNext();continue}if(!be.ParagraphReader.ic(h.node)){this.fka.moveNext();continue}const aa=h.node;if(this.KMa&&this.SPh&&this.SPh.U4b(aa))this.fka.moveNext();else{if(this.yhb&&h.isValid){var u=yd.GraphIterator.$a(aa);for(u.Rb(6);!u.Dr;)Jd.ImageReader.Wu(u.currentNode)&&b.nQ++,u.yi(6)}u=this.Lze?this.K_h(aa,this.XH):1033;h=this.Tqj(b,aa,0,0,0,this.jTd(h),y,h.cpBegin,h.cpEnd,u);if(h.mpi&&(P+=1,100<P)){b.EW=y+1;this.Hde(1,b);return}if(h.o5f)return;
this.JGh(b,aa);this.fka.moveNext()}}this.prd=this.fka=null;this.X9i(b)?(this.ecd=-1,this.bRi()):this.cIi(b)}}jTd(b){let h=!1;b.contextId===oc.a.paragraph?h=!0:b.contextId===oc.a.Fd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(m.a)(NK,"SelectionWordCountManager",qr,[]);class JF{constructor(b,h){this.NTb=!1;this.twb=null;b&&h&&(this.GXb=b(!1),this.Zc=h,this.GXb.moveNext())}J7k(b,h){if(!b||!this.GXb||!this.GXb.current)return!0;do{const u=this.GXb.current;if(u.contextId===oc.a.tableRow||
u.contextId===oc.a.tableCell){for(this.twb||this.Dem(u.node);this.twb.moveNext();)if(14===this.twb.currentNode.type&&b.Cpa++,h.update(),h.bkb())return!1;this.EQk(u,b);this.twb=null}this.GXb.moveNext()}while(this.GXb.current);return!0}EQk(b,h){const u=this.Zc.ng(b.node);u.Ab(14);b.contextId===oc.a.tableRow&&(pm.a.kji(u)&&(this.NTb=!0),pm.a.JTd(u)&&this.NTb&&(this.NTb=!1,h.Cpa++));b.contextId===oc.a.tableCell&&(hi.TableCellReader.zQc(u)&&(this.NTb=!0),hi.TableCellReader.dPa(u)&&this.NTb&&(this.NTb=
!1,h.Cpa++))}Dem(b){this.twb=Le.a.Dp(b);14===b.type?this.twb.ho(JF.DIc,b):this.twb.ho(JF.DIc,null)}static DIc(b){return b.parentNode?!0:!1}}Object(m.a)(JF,"TableCountSelectionTraverser",null,[300]);class OK{constructor(b){this.bVa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.bVa?new JF(b,h):null}}Object(m.a)(OK,"TableCountSelectionTraverserFactory",null,[288]);class PK extends qr{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb,Sb){super(b,h,u,P,vb,Kb);this.cHo=Yb=>{if(Yb.Dr)return!0;
Yb=Yb.role;return 1===Yb||2===Yb||this.yhb&&6===Yb||3===Yb||4===Yb||5===Yb||!this.KMa&&(7===Yb||8===Yb)};this.ga=y;this.ZXj=aa;this.M5j=ta;this.KFg=Pa;this.XH=Sb;this.ga.gb(Rc.a.Itj,oc.a.application,De.ActionManager.Mf,64);this.ga.gb(Rc.a.Jtj,oc.a.application,De.ActionManager.Mf,64);this.Lze=vb.$("ReadingTimeIsEnabled")}get Zgj(){return 63}get TDf(){return 0}B9e(b){this.zXa.reset();b.HH=!1;var h=this.ZXj();se.PageReader.instance.Gib(h)||(this.lDd(),this.bRi());h=this.un.ZCa(h,7,7).currentNode;var u=
this.fUk(b.currentNode,h);h=this.M5j(u,h);h.ho(this.cHo,null);let y=u=0;for(var P=0;h.moveNext();)if(h.currentNode&&this.hd.Xaa(h.currentNode)){var aa=this.hd.dO(h.currentNode);if(aa.Rt){var ta=this.hd.Z_a(h.currentNode);if(ta&&(ta=ta.qa.last,(null===ta||void 0===ta?0:ta.Uh)&&(vk.App.HU&&ta.gi||ta.C3)))continue;b.wordCount+=1;if(aa=this.BB.sbc(aa,h.currentNode))aa=qr.nBd(aa),b.t6+=aa.zBa+1,b.s6+=aa.zBa-aa.ukc;u+=1;y+=b.t6;P+=b.s6}}else if(this.yhb&&h.currentNode&&Jd.ImageReader.Wu(h.currentNode))b.nQ++;
else if(this.yhb&&h.currentNode&&xh.TableReader.yX(h.currentNode))b.Cpa++;else if(h.currentNode&&be.ParagraphReader.ic(h.currentNode)){aa=h.currentNode;ta=this.Lze?this.K_h(aa,this.XH):1033;P=this.Tqj(b,aa,u,y,P,!0,-1,-1,-1,ta);if(P.o5f){b.HH=!0;r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.JGh(b,aa);u=P.sPb;y=P.vyd;P=P.uyd}this.X9i(b)?(this.lDd(),this.MIn(),this.cRi(b)):this.cIi(b)}fUk(b,h){b?(b=this.KFg(b),
b.Ab(7)):b=this.KFg(h);return b}MIn(){switch(this.cud){case 1:this.ga.processAction(Rc.a.Itj,2);break;case 2:this.ga.processAction(Rc.a.Jtj,2)}}}Object(m.a)(PK,"TotalWordCountManager",qr,[]);class QK{constructor(){this.U2i=this.T2i=this.K0f=this.V2i=this.hjj=this.ijj=this.fjj=this.gjj=0}get BBi(){return this.i5b(this.V2i,this.ijj,"WC")}get HZm(){return this.i5b(this.T2i,this.fjj,"NumCharsNoSp")}get IZm(){return this.i5b(this.K0f,this.gjj,"NumCharsWithSp")}get NZm(){return this.i5b(this.U2i,this.hjj,
"NumParagraphs")}i5b(b,h,u){const y=this.c8c(h,u).toLocaleString();return 0<this.K0f?(b=this.oeg(b,h,u),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),y)):y}oeg(b,h,u){b=this.c8c(b,u);return b>h?(w.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",u),h):b}c8c(b,h){0>b&&w.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(m.a)(QK,"DocumentStats",null,[]);class KF{static h4e(b){return ff.a.Sy(KF.am,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.BBi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.HZm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.IZm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.NZm)}}KF.am="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(m.a)(KF,"DocumentStatsDialogHtml",null,[]);class RK extends ff.a{constructor(b){super();this.eL=!1;this.q8k=()=>{};this.$ra=b}P9n(){this.mg="DocumentStatsDialog";this.Hg=KF.h4e(this.$ra);this.Ed=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.q8k);this.k4("DocumentStatsTable")}QX(){}dispose(){this.eL||(super.dispose(),this.eL=!0)}}Object(m.a)(RK,"DocumentStatsDialog",ff.a,[]);class SK{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.Z6g=this.Mqc=this.Uoc=this.MTb=this.MAe=
!1;this.scc=()=>{this.Whe()};this.moa=()=>{this.Whe()};this.Q1n=()=>{this.Z6g=!0;return 32};this.zUf=()=>this.Zs.xPa?32:8;this.ZZc=(Kb,Sb,Yb,Ac,Sc)=>{if(1===Yb)return this.Zs.xPa?32:8;Sc[ag.a.On]=this.ozf;return 32};this.Jfe=(Kb,Sb,Yb)=>{if(1===Yb)return this.Zs.xPa?32:8;this.ozf?this.y5k():this.yal();Ra.App.xa.xG({ShowWordCount:"CheckboxModel"});return 32};this.qhc=(Kb,Sb,Yb)=>{if(1===Yb)return Ye.a.dga(Sb)?8:this.Zs.xPa?32:8;if(this.Z6g)return r.AFrameworkApplication.ya.processAction(Rc.a.A2d,2),
32;Kb=this.je.jg("UserAction","Show Word Count Dialog");Kb.start();this.Zs.L4c();this.nP.L4c();this.Zs.bD!==this.nP.bD?w.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):w.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Sb=this.DSk();(new RK(Sb)).P9n();Kb.stop();return 32};this.mZc=(Kb,Sb,Yb,Ac,Sc)=>{Sc||w.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===Yb)return 32;if(!this.Zs.xPa)return Sc[Qm.a.Visible]=
!1,32;Sc[Qm.a.Visible]=!0;this.ozf?(Kb=this.Zs.bD,0>Kb?Kb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Kb?(Sb=this.nP?this.nP.bD:-1,Kb=0<Sb?this.xTl(Kb,Sb):String.format(1===Kb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.T9d(Kb))):Kb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.T9d(Kb))):Kb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Sc[Qm.a.LabelText]=Kb;return 32};
this.iqe=ta;this.jqe=aa;this.Zs=b;this.nP=h;this.syc=u;this.A3j=P;this.nP.YTe(this.scc);this.Zs.YTe(this.scc);this.nP.qZb(this.moa);this.Zs.qZb(this.moa);this.je=Pa;this.KMa=y;this.bVa=vb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Z6e(){return!ba.a.t3}Wb(){const b=r.AFrameworkApplication.ya;b.pa(Rc.a.Jfe,oc.a.application,this.Jfe);b.pa(Rc.a.qhc,oc.a.view,this.qhc);b.gb(Rc.a.ZZc,oc.a.application,this.ZZc,96);b.gb(Rc.a.mZc,oc.a.application,this.mZc,96);b.gb(Rc.a.zUf,oc.a.application,
this.zUf,96);b.pa(Rc.a.cJh,oc.a.application,this.Q1n)}get KMa(){return this.Uoc}set KMa(b){this.Uoc=b;this.Zs.KMa=b;this.nP.KMa=b}yal(){this.Zs.xPa&&(this.N8i(!0),this.Whe(),this.Zs.L4c())}DSk(){const b=new QK;b.ijj=this.Zs.bD;b.gjj=this.Zs.K1b;b.fjj=this.Zs.HFc;b.hjj=this.Zs.JFc;b.V2i=this.nP.bD;b.T2i=this.nP.HFc;b.K0f=this.nP.K1b;b.U2i=this.nP.JFc;return b}CBl(){return this.iqe("WACWordCountEnabled",this.Z6e)}fae(b){this.jqe("WACWordCountEnabled",b?"true":"false",Xa.a.aQa)}get ozf(){this.MTb||(this.MAe=
this.CBl(),this.MTb=!0);return this.MAe}N8i(b){this.fae(b);this.MAe=b;this.MTb=!0}y5k(){this.Zs.lDd();this.nP.lDd();this.N8i(!1);this.Whe()}get qJ(){return null!=this.qwg?this.qwg:this.qwg=(()=>this.syc())()}Whe(){this.Mqc||(w.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.sYk()),this.Mqc=!0);this.qJ&&this.qJ.oU(this.A3j)}sYk(){const b={["words"]:this.Zs.bD,["charsWithSpaces"]:this.Zs.K1b,["charsWithNoSpaces"]:this.Zs.HFc,["paragraphs"]:this.Zs.JFc};this.bVa&&(b.images=this.Zs.Vzb,
b.tables=this.Zs.Yzb);return b}T9d(b){try{return b.toLocaleString()}catch(h){w.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}xTl(b,h){h>b&&(w.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.T9d(h),this.T9d(b))}}Object(m.a)(SK,"WordCountActor",
null,[]);class TK extends Vt.a{constructor(b,h,u,y){super();this.P3=(P,aa)=>{if(aa.property===Ge.a.Co||aa.property===Ge.a.An)P=aa.node,aa=vk.App.Fn.jb.wc,aa.$r&&aa.jd&&aa.jd.Jc&&P.Jc&&P.Jc.id===aa.jd.Jc.id&&this.nKh(P)};this.GFi=(P,aa)=>{this.nKh(aa.node)};this.x6m=(P,aa)=>{aa.property!==ld.a.$v&&aa.property!==Lc.a.Vt||this.OX()};this.H0d=()=>{this.OX()};this.r1=b;this.Zs=h;this.eq=u;this.bVa=y.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}jz(){var b=this.eq.Xe(12);b.Ap(this.P3);b.mu(this.GFi);
b.Mv(this.GFi);b=this.eq.Xe(22);b.Ap(this.x6m);b.mu(this.H0d);b.Mv(this.H0d);this.bVa&&this.fAn();this.r1.epa(this,7)}fAn(){var b=[19,14];for(const h of b)b=this.eq.Xe(h),b.mu(this.H0d),b.Mv(this.H0d)}get index(){return 1}run(){this.Zs.k7e()}nKh(b){b.w8c=null;this.OX()}}Object(m.a)(TK,"WordCountAppEventCoordinator",Vt.a,[]);class MG{}MG.C8j="AccurateWordCountButton";Object(m.a)(MG,"WordCountConstants",null,[]);class UK{constructor(b,h){this.Zs=b;this.nP=h}getInstance(b){switch(b){case 1:return this.nP;
case 0:return this.Zs;default:return this.Zs}}}Object(m.a)(UK,"WordCountManagerFactory",null,[140]);class NG{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}xc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new OK(h)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var u=new Bn.a(10,Je.a.Ye);const y=new PK(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Zo.a,r.AFrameworkApplication.ya,r.AFrameworkApplication.uc,()=>vk.App.Fn.jb.wc.jd,Le.a.Vr,yd.GraphIterator.$a,h,u,Ja.a.instance.resolve("Box4.ILanguageReader"));u=new NK(Ja.a.instance.resolve("Box4.List.IListReader"),Ja.a.instance.resolve("Box4.IListMarkerUtility"),new Zo.a,Hh.a.instance,r.AFrameworkApplication.uc,vx.a.instance,ri.a.instance,Ja.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,u,Ja.a.instance.resolve("Box4.ILanguageReader"));return new UK(y,u)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new FK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=Ra.App.xa.jb;b.pva?this.$ha():b.kea(()=>{this.$ha()})}$ha(){if(Ra.App.kk){var b=Ra.App.kk.sl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),u=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
y=Ja.a.instance.resolve("Common.IAppSettingsManager");(new SK(h,u,()=>Ja.a.instance.Pa("WordEditor.IStatusBarUser"),this.HAl(),MG.C8j,Xa.a.cSa,Xa.a.rfa,Ja.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),y)).Wb();(new TK(Pi.GraphTransactionManager.instance,h,b,y)).jz();h.k7e()}else w.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else w.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}HAl(){var b=
vk.App.Fn.jb;if(!b)return w.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.wc;if(!b)return w.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.jd;return b?b.ia(Lc.a.KMa,!1):(w.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){K.a.instance.Kc(new NG)}}Object(m.a)(NG,"PackageManager",null,[1,2]);var VK=c(1953);class WK{constructor(b){this.AKe=null;b.Za("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.AKe=h})}i5i(b){this.AKe&&this.AKe.rjf().handleDocumentContentAugloopAnnotation(b)}}
Object(m.a)(WK,"DocumentContentExtractionManager",null,[255]);class Eh{}Eh.vco="mso_smartLookup";Eh.channelId="SmartLookup";Eh.uco="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Eh.Tcj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Eh.Ucj="https://uci.cdn.office.net/mirrored/smartlookup/";Eh.tco="https://hedwigtestserver.blob.core.windows.net/builds/";Eh.sco="http://localhost:8080/";Eh.o4c="current";Eh.Scj="next";Eh.tdn=2;Eh.Icc=1;Eh.Jcc=CommonUIStrings.L_SmartLookupPaneTitle;
Eh.nB="InsightsTaskPane";Eh.B9f="InsightsTaskPaneData";Eh.Uqf="InsightsContentFrame";Eh.width=400;Eh.pUm="ApplicationPropertiesRequest";Eh.CUm="SelectionRequest";Eh.wUm="PageRendered";Eh.oUm="ApplicationProperties";Eh.BUm="Selection";Eh.EUm="Telemetry";Eh.DUm="TakeFocus";Eh.vUm="LostFocus";Eh.sUm="Keyboard";Eh.tUm="LegalAgreed";Eh.VJo="WordWac";Eh.nan="OneNoteWAC";Eh.APf="yes";Eh.khj="appCorrelationId";Eh.Gko="clientCorrelationId";Eh.lhj="message";Eh.Iri="Microsoft::Office::Insights::LegalAgreed";
Object(m.a)(Eh,"InsightsConstants",null,[]);var GE=c(1566);class JD{}Object(m.a)(JD,"ActivityContractInfo",null,[]);class iu{}Object(m.a)(iu,"BrowserPaneDataField",null,[]);class KD{}Object(m.a)(KD,"BrowserPaneTelemetryEvent",null,[]);class sm{static lB(b,h){const u=new KD;u.eventName="Diagnostics";u.isActivity=!1;u.activityContract=Object.assign(new JD,{success:!0});const y=[],P=new iu;P.name="Message";P.dataType=0;P.value=b;b=new iu;b.name="Level";b.dataType=0;b.value=sm.getLevelString(h);Array.add(y,
P);Array.add(y,b);u.dataFields=y;sm.sendTelemetryEvent(u)}static j3i(b,h){const u=new KD;u.eventName=b;u.isActivity=!1;u.activityContract=Object.assign(new JD,{success:!0});b=[];const y=new iu;y.name="AppCorrelationId";y.dataType=0;y.value=h;Array.add(b,y);u.dataFields=b;sm.sendTelemetryEvent(u)}static hTn(b,h,u,y,P,aa){const ta=new KD;ta.eventName="LaunchPaneWithError";ta.isActivity=!1;ta.activityContract=Object.assign(new JD,{success:!0});const Pa=[],vb=new iu;vb.name="IsNetworkConnected";vb.dataType=
0;vb.value=b?"true":"false";b=new iu;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new iu;h.name="EntryPoint";h.dataType=0;h.value=u;u=new iu;u.name="RuntimeVersion";u.dataType=0;u.value=y;y=new iu;y.name="IsFirstRelease";y.dataType=1;y.value=P?"true":"false";P=new iu;P.name="IsZeroTerm";P.dataType=1;P.value=aa?"true":"false";aa=new iu;aa.name="IsClientSideRendering";aa.dataType=1;aa.value="false";Array.add(Pa,vb);Array.add(Pa,h);Array.add(Pa,b);Array.add(Pa,u);Array.add(Pa,
y);Array.add(Pa,P);Array.add(Pa,aa);ta.dataFields=Pa;sm.sendTelemetryEvent(ta)}static N0f(b,h,u){const y=new KD;y.eventName="CDNDownloadLatency";y.isActivity=!0;y.activityContract=Object.assign(new JD,{duration:u,success:!0});u=[];const P=new iu;P.name="CDNHostname";P.dataType=0;P.value=b;b=new iu;b.name="Filename";b.dataType=0;b.value=h;Array.add(u,P);Array.add(u,b);y.dataFields=u;sm.sendTelemetryEvent(y,1)}static Ofc(b,h,u,y,P,aa,ta,Pa){const vb=new KD;vb.eventName="LaunchPane";vb.isActivity=!0;
vb.activityContract=Object.assign(new JD,{duration:h,success:!0});h=[];const Kb=new iu;Kb.name="AppCorrelationId";Kb.dataType=0;Kb.value=b;b=new iu;b.name="EntryPoint";b.dataType=0;b.value=u;u=new iu;u.name="IsServerSideRendering";u.dataType=1;u.value="true";const Sb=new iu;Sb.name="UxVersion";Sb.dataType=0;Sb.value=y;y=new iu;y.name="FeatureGates";y.dataType=0;y.value=P;P=new iu;P.name="IsFirstRelease";P.dataType=1;P.value=aa?"true":"false";aa=new iu;aa.name="IsZeroTerm";aa.dataType=1;aa.value=ta?
"true":"false";ta=new iu;ta.name="IsClientSideRendering";ta.dataType=1;ta.value=Pa?"true":"false";Array.add(h,Kb);Array.add(h,b);Array.add(h,u);Array.add(h,Sb);Array.add(h,y);Array.add(h,P);Array.add(h,aa);Array.add(h,ta);vb.dataFields=h;sm.sendTelemetryEvent(vb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)sm.qJm(b.eventName);else{var u=-1<b.eventName.indexOf(sm.jhj)?b.eventName:sm.jhj+b.eventName,y=sm.Jzl(b.dataFields);b.isActivity?(b=Object.assign(new tm.a,{name:u,samplingPolicy:h,
dataFields:y,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ha.a.sendActivityEvent(b)):(b=Object.assign(new ia.a,{name:u,samplingPolicy:h,dataFields:y}),ha.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static Jzl(b){const h=[];if(b&&0<b.length)for(const u of b)(b=Pj.a.vfa(u.name,u.value,sm.GPk(u.dataType)))&&Array.add(h,b);return h}static GPk(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static qJm(b){const h=Ja.a.instance.Pa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):w.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}sm.jhj="Office.Insights.SmartLookup.";Object(m.a)(sm,"TelemetryUtils",null,[]);var LD;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.prefetch=99]="prefetch"})(LD||(LD={}));Object(m.b)("EntryPoint",LD);var ju=c(1502),Vx=c(1516);class tv{static lX(b,h,u,y,P,aa){if(1===
u)return ui.SessionStatusManager.instance.XI?32:8;if(P.value.r8n())return sm.lB("Skipping Serplet launch",10),32;h=aa;if(!h)return 8;b=tv.UBb();if(u=h.CommandValueId)try{h=z.a(u)}catch(ta){return w.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",u),8}u=h;h.selection||(h.neighborhood?u=Object.assign(new ju.a,{selection:h}):(h=P.value.BCb(),u.selection=Object.assign(new Vx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));
u.selection.clientDetectedLanguage=P.value.aZh();return tv.s3b(aa,null,u,b,0,P)}static s3b(b,h,u,y,P,aa){const ta={};ta.controlId=b?b.SourceControlId:"shortcut";u&&(ta.entryPoint=LD[u.entryPoint]);w.ULS.sendTraceTag(594044172,1303,50,tv.kT("Show insights",y,ta));h?aa.value.G$n(h,y,P):u&&(r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?aa.value.f9n(u,y):aa.value.H$n(u,y,P));return 32}static kT(b,h,u=null){b={["appCorrelationId"]:h,["message"]:b};
if(u)for(let y in u)b[y]=u[y];return z.c(b)}static UBb(){return Ua.a.create().toString()}}Object(m.a)(tv,"InvokingPaneUtils",null,[]);class XK{}Object(m.a)(XK,"LaunchDataInDoc",null,[]);class YK{}Object(m.a)(YK,"LaunchDataPasteAsSlide",null,[]);class ZK{}Object(m.a)(ZK,"LaunchDataSlidesCompression",null,[]);var av=c(1505);class OG{constructor(b,h,u,y,P,aa,ta,Pa,vb){this.Xoc=this.Gfd=this.ow=null;this.zB=b;this.ga=h||r.AFrameworkApplication.ya;this.Zo=u;this.Vb=y;this.$Rg=Pa;this.Muc=P;this.Ma=aa;
this.Gb=ta;this.Bdm();this.UUa=new Zf.a(()=>new Vn.a(vb.value,Object(v.a)(this,this.NCb,"getMoreInfoEventReceived")))}Wb(){this.ga.pa(Wa.a.shm,le.a.frame,Object(v.a)(this,this.E$n,"showInsights"));this.ga.pa(Wa.a.thm,le.a.frame,Object(v.a)(this,this.F$n,"showInsightsForTellMe"));this.ga.pa(Wa.a.definitions,le.a.frame,Object(v.a)(this,this.F9n,"showDefinitions"));this.ga.pa(Wa.a.h7e,le.a.frame,Object(v.a)(this,this.G9n,"showDefinitionsForTellMe"));this.ga.pa(Wa.a.M5f,le.a.frame,Object(v.a)(this,this.M5f,
"showInsightsForSuggestion"));this.$Rg&&(this.ga.pa(Wa.a.Vfa,le.a.frame,Object(v.a)(this,this.lX,"invokeSmartLookupPane")),this.ga.pa(Wa.a.OPc,le.a.frame,Object(v.a)(this,this.OPc,"invokeInDocSerplet")),this.ga.pa(Wa.a.ERd,le.a.frame,Object(v.a)(this,this.ERd,"invokeSerpletRibbon")),this.ga.pa(Wa.a.PPc,le.a.frame,Object(v.a)(this,this.PPc,"invokeSerpletContextMenu")),this.ga.pa(Wa.a.Otf,le.a.frame,Object(v.a)(this,this.Otf,"invokeSerpletTellMeZeroTerm")),this.ga.pa(Wa.a.Ntf,le.a.frame,Object(v.a)(this,
this.Ntf,"invokeSerpletTellMeNotes")),this.ga.pa(Wa.a.ARd,le.a.frame,Object(v.a)(this,this.ARd,"invokeImageSerpletContextMenu")),this.ga.pa(Wa.a.FRd,le.a.frame,Object(v.a)(this,this.FRd,"invokeSynonymsSerpletContextMenu")),this.ga.pa(Wa.a.zRd,le.a.frame,Object(v.a)(this,this.zRd,"invokeDictionarySerpletContextMenu")),this.ga.pa(Wa.a.HRd,le.a.frame,Object(v.a)(this,this.HRd,"invokeZeroTermSerpletContextMenu")),this.ga.pa(Wa.a.yRd,le.a.frame,Object(v.a)(this,this.yRd,"invokeDefinitionSearchFromFloatie")),
this.ga.pa(Wa.a.DRd,le.a.frame,Object(v.a)(this,this.DRd,"invokeSerpletBrowseFiles")),this.ga.pa(Wa.a.BRd,le.a.frame,Object(v.a)(this,this.BRd,"invokeInDocSerpletWithLaunchData")),this.ga.pa(Wa.a.E6d,le.a.frame,Object(v.a)(this,this.E6d,"queryToggleSerplet")),this.ga.pa(Wa.a.tae,le.a.frame,Object(v.a)(this,this.tae,"setInDocSearchParameter")),this.ga.pa(Wa.a.Mtf,le.a.frame,Object(v.a)(this,this.Mtf,"invokeSerpletSlidesCompression")),this.ga.pa(Wa.a.Ltf,le.a.frame,Object(v.a)(this,this.Ltf,"invokeSerpletPasteAsNewSlide")),
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.pa(Wa.a.Yfi,le.a.frame,Object(v.a)(this,this.djm,"invokeSmartLookupPaneConversations")),this.ga.pa(Wa.a.wRd,le.a.frame,Object(v.a)(this,this.wRd,"invokeAutoLaunchSearchRequest"))),this.Pyn().continueWith(()=>{r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.updateCommandUI(!0)}))}Hch(){this.ga.gb(Wa.a.dEa,le.a.frame,Object(v.a)(this,this.dEa,"invokeFilesSerplet"),4);this.ga.gb(Wa.a.Ftf,
le.a.frame,Object(v.a)(this,this.dEa,"invokeFilesSerplet"),4);this.ga.gb(Wa.a.Tfi,le.a.frame,Object(v.a)(this,this.Uim,"invokeLinkFilesSerplet"),4);if(this.Ma.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ma.$("SmartLookupTokenPrefetchIsEnabled")){const b=sc.a.F6(0,Object(v.a)(this,this.fNi,"prefetchToken"),0,177);this.Gb.Xb(b)}}oTe(){fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.pa(Wa.a.dEa,le.a.frame,Object(v.a)(this,
this.Gtf,"invokeFilesSerpletUnavailable")),this.ga.pa(Wa.a.Ftf,le.a.frame,Object(v.a)(this,this.Gtf,"invokeFilesSerpletUnavailable")),this.ga.pa(Wa.a.Tfi,le.a.frame,Object(v.a)(this,this.Gtf,"invokeFilesSerpletUnavailable")))}fNi(b){w.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.tjc().then(h=>{let u=1;if(h)w.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.d1f("SmartLookupFiles: Token prefetch succeeded",
!0),h=6E4*this.Ma.pc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{w.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.d1f("SmartLookupFiles: Token prefetch failed",!1);u=parseInt(b.data||"1");if(u>this.Ma.pc("SmartLookupTokenRenewalRetryThreshold",5)){w.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.d1f("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Ma.pc("SmartLookupTokenRetryWaitDurationInMinutes",
10);u++}h=new sc.a(3,1,h,Object(v.a)(this,this.fNi,"prefetchToken"),177);h.data=u.toString();this.Gb.Xb(h)})}d1f(b="",h=!1){this.Muc.execute(u=>{u&&u.Bmb("PrefetchToken",h,0,"SmartLookup",b)})}tjc(){return this.Muc?new Promise(b=>{this.Muc.execute(h=>{if(h){var u=Date.now();h.getToken("SmartLookup",this.Ma.lb("SmartLookupShredderServiceEndpoint")).then(y=>{b(!!y&&0<y.length);h.Bmb("TryGetTokenInternal",!!y&&0<y.length,Date.now()-u,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}Pyn(){const b=
new Jk.a;if(this.Ma.$("BrowserSupportsInsightsPaneSSO"))this.Hch(),b.Cg(!0);else{if(!this.Muc)return w.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Cg(!1),this.oTe(),b.task;this.Muc.execute(h=>{h?h.getToken("SmartLookup",this.Ma.lb("SmartLookupShredderServiceEndpoint")).then(u=>{w.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!u&&0<u.length);u&&0<u.length?(this.Hch(),b.Cg(!0)):this.oTe()}):(w.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.Cg(!1),
this.oTe())})}return b.task}E$n(b,h,u,y,P){if(1===u)return r.AFrameworkApplication.ta&&r.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!r.AFrameworkApplication.DEc?8:this.zB.value.jki()?32:8;b=tv.UBb();h=this.zB.value.BCb();return this.$Rg?(h=Object.assign(new Vx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new ju.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new av.a,{landingTab:"All"})}),
tv.s3b(P,null,h,b,0,this.zB)):tv.s3b(P,h,null,b,0,this.zB)}F9n(b,h,u,y,P){if(1===u)return this.zB.value.jki()?32:8;b=tv.UBb();h=this.zB.value.BCb();return tv.s3b(P,h,null,b,1,this.zB)}F$n(b,h,u,y,P){return 1===u?32:this.zLh(P,0)}G9n(b,h,u,y,P){return 1===u?32:this.zLh(P,1)}zLh(b,h){const u=tv.UBb(),y=b.CommandValueId;let P;try{P=z.a(y)}catch(aa){return w.ULS.sendTraceTag(6295941,1303,15,tv.kT(String.format("Insights parameters [{0}] is not in proper format.",y),u)),8}return tv.s3b(b,P,null,u,h,this.zB)}M5f(b,
h,u,y,P){if(1===u)return 32;if(!P)return 8;b=P.query?P.query:"";h=tv.UBb();u=new GE.a;u.neighborhood=b;u.mentionStart=0;u.mentionLength=b.length;return tv.s3b(P,u,null,h,0,this.zB)}Uim(b,h,u,y){if(1===u)return ui.SessionStatusManager.instance.XI?32:8;const P=r.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),aa=this.zB.value.W_a();return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new av.a,
{landingTab:"File"}),entryPoint:P?32:10}))}dEa(b,h,u,y){if(1===u)return ui.SessionStatusManager.instance.XI?32:8;const P=r.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),aa=this.zB.value.W_a();return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new av.a,{landingTab:P?"Slide":"File"}),entryPoint:P?20:10}))}Gtf(){return 2}OPc(b,h,u,y,P){if(1===u)return ui.SessionStatusManager.instance.zj?
8:32;const aa=this.zB.value.W_a();P=void 0===P||null===P?18:19;return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:aa.neighborhood,mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new av.a,{landingTab:"Indoc"}),entryPoint:P}))}BRd(b,h,u,y,P){P=P.CommandValueId;if(!P||P&&this.Xoc&&P.query===this.Xoc.query&&P.matchCase===this.Xoc.matchCase&&P.matchWholeWordOnly===this.Xoc.matchWholeWordOnly)return 32;const aa=this.zB.value.W_a();
return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:aa.neighborhood,mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new av.a,{landingTab:"Indoc",data:Object.assign(new XK,{type:4,query:P.query,matchCase:P.matchCase,matchWholeWord:P.matchWholeWordOnly})}),entryPoint:18}))}E6d(b,h,u,y,P){P&&(P[ag.a.On]=this.zB.value.HFb);return 32}tae(b,h,u,y,P){if(b=P.CommandValueId)this.Xoc=b;return 32}djm(b,h,u){if(1===u)return ui.SessionStatusManager.instance.XI?
32:8;b=this.zB.value.W_a();b=Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new av.a,{landingTab:"All"})});this.zB.value.fWd(b);return 32}wRd(b,h,u){if(1===u)return ui.SessionStatusManager.instance.XI?32:8;b=this.zB.value.W_a();b=Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new av.a,
{landingTab:"All",data:r.AFrameworkApplication.IAb})});h=tv.UBb();this.zB.value.MLb(b,h);return 32}ERd(b,h,u,y){if(1===u)return ui.SessionStatusManager.instance.XI?32:8;const P=this.zB.value.cZh();return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:P.mentionLength}),entryPoint:4,launchData:Object.assign(new av.a,{landingTab:"All"})}))}PPc(b,h,u,y){return this.lX(b,h,u,y,Object.assign(new ju.a,{entryPoint:5,
launchData:Object.assign(new av.a,{landingTab:"All"})}))}Otf(b,h,u,y){if(1===u)return ui.SessionStatusManager.instance.XI?32:8;const P=this.zB.value.W_a();return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new av.a,{landingTab:"All"}),entryPoint:26}))}zRd(b,h,u,y){return 1===u?(b=this.zB.value.BCb())&&0<b.mentionLength?32:8:this.lX(b,h,u,y,Object.assign(new ju.a,{entryPoint:22,
launchData:Object.assign(new av.a,{landingTab:"All"})}))}yRd(b,h,u,y){return 1===u?(b=this.zB.value.BCb())&&0<b.mentionLength?32:8:this.lX(b,h,u,y,Object.assign(new ju.a,{entryPoint:7,launchData:Object.assign(new av.a,{landingTab:"All"})}))}ARd(b,h,u,y){return this.lX(b,h,u,y,Object.assign(new ju.a,{launchData:Object.assign(new av.a,{landingTab:"Image"}),entryPoint:9}))}FRd(b,h,u,y){return this.lX(b,h,u,y,Object.assign(new ju.a,{launchData:Object.assign(new av.a,{landingTab:"All"}),entryPoint:24}))}Ntf(b,
h,u,y){return this.lX(b,h,u,y,Object.assign(new ju.a,{launchData:Object.assign(new av.a,{landingTab:"Notes"}),entryPoint:33}))}HRd(b,h,u,y){if(1===u)return ui.SessionStatusManager.instance.XI?32:8;const P=this.zB.value.W_a();return this.lX(b,h,u,y,Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new av.a,{landingTab:"All"}),entryPoint:27}))}Mtf(b,h,u,y,P){if(!P)return 8;const aa=P.url;P=P.selectedSlideIDs;
return this.lX(b,h,u,y,Object.assign(new ju.a,{launchData:Object.assign(new av.a,{landingTab:"All",data:Object.assign(new ZK,{type:6,url:aa,selectedSlideIDs:P})}),entryPoint:37}))}Ltf(b,h,u,y,P){if(!P)return 8;const aa=P.Selection;P=P.CurrentDocTitle;return this.lX(b,h,u,y,Object.assign(new ju.a,{launchData:Object.assign(new av.a,{landingTab:"All",data:Object.assign(new YK,{type:5,selection:aa,currentDocTitle:P})}),entryPoint:36}))}lX(b,h,u,y,P){return tv.lX(b,h,u,y,this.zB,P)}DRd(b,h,u){if(1===u)return 32;
this.ow||this.UUa.value.gk("Browse File from Search pane",!0);if(!this.Gfd||""===this.Gfd)return w.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Je.a.en(this.Gfd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}NCb(b){this.ow||3!==b.state||(this.ow=b,this.Gfd=this.ow.Oba)}Bdm(){const b=this.Vb.le(Eh.nB);b.parent=xe.AFrame.Hp;b.hea(Object(v.a)(this,this.Nfc,"sendIFrameTakeFocusMessage"));this.Zo.uS(Eh.nB)}Nfc(){document.activeElement.blur();r.AFrameworkApplication.ta&&
r.AFrameworkApplication.ta.Pb.Kib||(this.zB.value.FXn(),this.zB.value.fTn())}dispose(){this.zB.value&&this.zB.value.dispose()}}Object(m.a)(OG,"InsightsActor",null,[9]);const PG=b=>{b=b.split("-");return b[b.length-1]},aN=()=>{var b=LF();if(b)return Promise.resolve(b);b=HE().replace("SearchWeb","searchweb");b=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Eh.Scj+"/":b+Eh.o4c+"/";b+="version.json";if(ba.a.rna)return $M(b);try{const h=
new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(sm.lB("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(u=>u.json()).catch(()=>{sm.lB("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(u=>{u=z.b(JSON.stringify(u));return u.version?u.version:""},u=>{sm.lB("InsightsUtils - Failed to deserialize version: "+
u.toString(),10);w.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+u.toString());return""}).then(u=>u)}catch(h){return sm.lB("InsightsUtils - Failed to download version.json: "+h.toString(),10),w.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},$M=b=>{const h=r.AFrameworkApplication.Ve;return new Promise(u=>{const y=new HF.a(b,1,null,null,!0,2,null);h.send(y).UFa(P=>{P&&P.data?P.data.Ae||(sm.lB("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
P.data.jf,10),u("")):(sm.lB("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),u(""));try{const aa=z.b(P.data.Ae);aa.version&&u(aa.version)}catch(aa){sm.lB("InsightsUtils - Failed to deserialize version: "+aa.toString(),10),u("")}},P=>{P&&P.data?sm.lB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+P.data.jf,10):sm.lB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);u("")})})},MF=()=>r.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),NF=()=>{const b=HE();return MF()||r.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?b+LF()+"/":r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Eh.Scj:b+Eh.o4c},LF=()=>MF()?"dev":r.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?
r.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/")[1]:r.AFrameworkApplication.K.lb("SmartLookupClientVersion"),QG=b=>{var h=3===r.AFrameworkApplication.ta.Pb.$n?"wordwac":2===r.AFrameworkApplication.ta.Pb.$n?"pptwac":"excelwac";var u=zl.a.sg(r.AFrameworkApplication.lcid);const y=u?u.name:"en-us";u=HE();const P=tC();h="main_ssr_wac.html?appName="+h+"&culture="+y;return"LOCAL"===P?u+h:u+((""!==b?b:Eh.o4c)+"/")+h},bN=b=>HE()+(""!==b?b:Eh.o4c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
HE=()=>{switch(tC()){case "LOCAL":return Eh.sco;case "PR":const b=r.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/");return Eh.tco+b[0]+"/";case "INT":return Eh.uco;case "EDOG":return Eh.Tcj;default:return Eh.Ucj}},cN=()=>{if(!r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(tC()){case "EDOG":return Eh.Tcj;case "PROD":return Eh.Ucj;default:return""}},tC=()=>{if(r.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(r.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(r.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(r.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")&&r.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc"))return"PR";if(MF())return"LOCAL";switch(Object(na.a)(String,r.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=r.AFrameworkApplication.K.lb("UserPrincipalName");b=A.a.jh(b);const h=
r.AFrameworkApplication.K.Sv("SmartLookupINTEnabledForSKITeam")?r.AFrameworkApplication.K.XB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},$K=()=>{let b;b=r.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":r.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":r.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":tC();const h=r.AFrameworkApplication.K.lb("IntentServiceEndpoint"),u=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return r.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(u?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(u?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class aL{sendTelemetryEvent(b){sm.sendTelemetryEvent(b)}}Object(m.a)(aL,"OtelTelemetrySink",null,[267]);class bL{}Object(m.a)(bL,"ApplicationProperties",null,[]);class cL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(m.a)(cL,"CurrentDocumentProperties",null,[]);class dL{}Object(m.a)(dL,"EnterpriseUserInfo",null,[]);class eL{}Object(m.a)(eL,"FeatureGates",
null,[]);class RG{constructor(b,h){this.Bu=this.Ei=null;this.Qvi=!0;this.Ywb=h;this.vz=b;this.vz.execute(u=>{u.isFeatureEnabled("mso_sendASmile",!0).then(y=>{this.Qvi=y}).catch(y=>{sm.lB("SearchHelper - Failed to check if Feedback feature is enabled: "+y.toString(),15)})});b=$K();h=r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(r.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.Bu=
{};const u=this.GTl();if(u&&0<u.length)for(let y=0;y<u.length;y++){const P=u[y],aa=this.RTl(P);switch(aa.toLowerCase()){case "true":this.Bu[P]=!0;break;case "false":this.Bu[P]=!1;break;default:this.Bu[P]=aa}}this.Bu.EnableInDocumentSearch=h;this.Bu.EnableInDocumentSearchReplace=!0;this.Bu.EnableInDocumentParamLocalSearch=!0;this.Bu.EnableInDocumentQuerySuggest=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1);this.Bu.EnableInDocumentQuestionGeneration=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.Bu.EnableInDocumentGlobalEncoder=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.Bu.EnableInDocumentExperiment1=
h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Bu.EnableInDocumentExperiment2=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.Bu.EnableInDocumentExperiment3=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Bu.EnableZeroTermAutoRefresh=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Bu.EnableTap3SZeroTerm=r.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.Bu.EnableLocalSearch=!0;
this.Bu.EnableInDocumentStickyFilters=!0;this.Bu.IntentServiceEndpoint=b;this.Bu.EnablePDFShredding=r.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Bu.FilterNonPPTFilesForReuseSlides=r.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.Bu.UXBundleVersion=LF();this.Bu.SmartLookupServicePath=NF();this.Bu.EnableAcronymSearch=!0;this.Bu.UseAltAnswerEndpoint1=
r.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Bu.UseAltAnswerEndpoint2=r.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Bu.UseAltAnswerEndpoint3=r.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",
!1);this.Bu.UseNextUXVersion=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Bu.IgnoreNeighborhoodContext=r.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Bu.ShowDebugInfo="INT"===tC();this.Bu.DebugCommands=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.Bu.ChangeGates=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",
"");this.Bu.QnaInMixSection=!0;this.Bu.EnableNoteSearch=r.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Bu.EnableWikiL2=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.Bu.EnableFilteringOutRedundantKPE=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",
!1);this.Bu.EnableZeroTermEntitySuggestion=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Bu.RankingModels=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Bu.EnableClientSideRendering=!0}else this.Ei=new eL,this.Ei.EnableInDocumentSearch=h,this.Ei.EnableInDocumentSearchReplace=!0,this.Ei.EnableInDocumentParamLocalSearch=!0,this.Ei.EnableInDocumentQuerySuggest=h&&
r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Ei.EnableInDocumentQuestionGeneration=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Ei.EnableInDocumentGlobalEncoder=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.Ei.EnableInDocumentExperiment1=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Ei.EnableInDocumentExperiment2=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1),this.Ei.EnableInDocumentExperiment3=h&&r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Ei.EnableZeroTermAutoRefresh=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Ei.EnableTap3SZeroTerm=r.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Ei.EnableLocalSearch=!0,this.Ei.EnableInDocumentStickyFilters=!0,this.Ei.IntentServiceEndpoint=b,this.Ei.EnablePDFShredding=r.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Ei.FilterNonPPTFilesForReuseSlides=r.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Ei.UXBundleVersion=LF(),this.Ei.SmartLookupServicePath=NF(),this.Ei.EnableAcronymSearch=
!0,this.Ei.UseAltAnswerEndpoint1=r.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Ei.UseAltAnswerEndpoint2=r.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Ei.UseAltAnswerEndpoint3=r.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Ei.UseNextUXVersion=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Ei.IgnoreNeighborhoodContext=r.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Ei.ShowDebugInfo="INT"===tC(),this.Ei.DebugCommands=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Ei.ChangeGates=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Ei.QnaInMixSection=!0,this.Ei.EnableNoteSearch=r.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Ei.EnableWikiL2=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Ei.EnableFilteringOutRedundantKPE=
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Ei.EnableZeroTermEntitySuggestion=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Ei.RankingModels=r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Ei.EnableClientSideRendering=!0,this.Ei.SharedSerpletFeatureGate1=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Ei.SharedSerpletFeatureGate2=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Ei.SharedSerpletFeatureGate3=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Ei.SharedSerpletFeatureGate4=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Ei.SharedSerpletFeatureGate5=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Ei.SharedSerpletFeatureGate6=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Ei.SharedSerpletFeatureGate7=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Ei.SharedSerpletFeatureGate8=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Ei.SharedSerpletFeatureGate9=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Ei.SharedSerpletFeatureGate10=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Ei.SharedSerpletFeatureGate11=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Ei.SharedSerpletFeatureGate12=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Ei.SharedSerpletFeatureGate13=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Ei.SharedSerpletFeatureGate14=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Ei.SharedSerpletFeatureGate15=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Ei.SharedSerpletFeatureGate16=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Ei.SharedSerpletFeatureGate17=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Ei.SharedSerpletFeatureGate18=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Ei.SharedSerpletFeatureGate19=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Ei.SharedSerpletFeatureGate20=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Ei.SharedSerpletFeatureGate21=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Ei.SharedSerpletFeatureGate22=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Ei.SharedSerpletFeatureGate23=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Ei.SharedSerpletFeatureGate24=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Ei.SharedSerpletFeatureGate25=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Ei.SharedSerpletFeatureGate26=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Ei.SharedSerpletFeatureGate27=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Ei.SharedSerpletFeatureGate28=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Ei.SharedSerpletFeatureGate29=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Ei.SharedSerpletFeatureGate30=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Ei.SharedSerpletFeatureGate31=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Ei.SharedSerpletFeatureGate32=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Ei.SharedSerpletFeatureGate33=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Ei.SharedSerpletFeatureGate34=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Ei.SharedSerpletFeatureGate35=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Ei.SharedSerpletFeatureGate36=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Ei.SharedSerpletFeatureGate37=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Ei.SharedSerpletFeatureGate38=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Ei.SharedSerpletFeatureGate39=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Ei.SharedSerpletFeatureGate40=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Ptc=Ja.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.wHb=!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Kjb=RG.isEnterpriseUser();this.SPa=r.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint");this.JDf=Fa.a.LZ(r.AFrameworkApplication.K.lb("AppCatalogUrl")||"");this.IPm=r.AFrameworkApplication.K.lb("UserPrincipalName");(this.Kjb||this.wHb)&&this.t4h()}RTl(b){return r.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+
b,"")}GTl(){const b=r.AFrameworkApplication.K.m_a,h=r.AFrameworkApplication.K.XB("SmartLookupFlightKeywordList"),u=[];if(b&&h&&0<h.length)for(let P in b){var y={key:P,value:b[P]};y=y&&y.key?y.key:"";for(let aa=0;aa<h.length;aa++)if(-1<y.toLowerCase().indexOf(h[aa].toLowerCase())){const ta=y.split(".");ta&&4===ta.length&&Array.add(u,ta[ta.length-1])}}return u}Cmf(b,h,u,y){return new Promise(P=>{this.qwm().then(aa=>{const ta=new bL;ta.anid="";ta.applicationName=3===r.AFrameworkApplication.ta.Pb.$n?
"WORD":"POWERPNT";ta.applicationVersion=r.AFrameworkApplication.buildVersion;ta.appCorrelationId=b?b:tv.UBb();ta.themePlatform="web";ta.lcid=r.AFrameworkApplication.lcid;ta.launchUtcTime=(new Date).toUTCString();r.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ta.featureGates=z.c(this.Bu):ta.featureGates=z.c(this.Ei);var Pa=zl.a.sg(r.AFrameworkApplication.lcid);Pa=Pa?Pa.name:null;ta.market=PG(Pa);ta.uiLanguage=Pa;ta.sessionId=r.AFrameworkApplication.userSessionId;ta.themeId=u;ta.parentalControl=
"yes";ta.processorOnlyMode=aa;ta.isEditingAllowed=h.isEditingAllowed();ta.isFeedbackEnabled=this.Qvi;ta.isClientSideRendering=18===y||19===y||15===y;ta.disableClipboard=r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&r.AFrameworkApplication.pM&&!r.AFrameworkApplication.TAb;ta.accessToken=this.Kjb||this.wHb?this.t4h():"";aa=new dL;aa.CountryCode=PG(Pa);aa.ServiceEndpoint=this.SPa;aa.IsGoLocal=r.AFrameworkApplication.K.$("IsGoLocalEnvironment");
aa.IsEnabled=this.Kjb;aa.IsEnterpriseEnabled=this.Kjb;aa.TenantRoot=this.JDf;aa.Upn=this.IPm;Pa=tC();aa.IsEUDB="PROD"===Pa&&""!==r.AFrameworkApplication.K.lb("IntentServiceEndpoint");ta.enterpriseUserInfo=aa;aa=new cL;aa.filePath=r.AFrameworkApplication.K.lb("EditDocInClientUrl");aa.docName=r.AFrameworkApplication.K.lb("FileName");aa.author=99!==y?h.author():null;aa.createdDate=99!==y?h.createdDate():null;ta.currentDocument=aa;P(ta)})})}qwm(){return new Promise(b=>{this.vz?this.vz.execute(h=>{h.isFeatureEnabled(Eh.vco,
!0).then(u=>{b(!u)}).catch(u=>{sm.lB("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+u.toString(),10);b(!0)})}):b(!0)})}dgn(b){this.Ptc&&(this.Kjb||this.wHb)&&this.v6h(this.SPa).then(h=>{b(h)})}t4h(){if("Dev Box"===r.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const b=this.wHb?"Search":"SmartLookup";return this.Ptc?
this.Ptc.sXl(b,this.SPa,this.wHb):""}v6h(b){if("Dev Box"===r.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(u=>{u(window.SearchPaneShredderTokenOverride)});const h=this.wHb?"Search":"SmartLookup";return this.Ptc?this.Ptc.getToken(h,b,this.wHb):Promise.resolve("")}mMc(){return this.Ywb?this.Ywb.getVersion():""}mCl(){return r.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?
z.c(this.Bu):z.c(this.Ei)}static isEnterpriseUser(){const b=r.AFrameworkApplication.K.lb("SovereignEnvironmentName"),h=r.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(m.a)(RG,"SearchHelper",null,[256]);class RC{constructor(){RC._instance=""}getVersion(){return RC._instance}V2n(b){RC._instance=b}}RC._instance=null;Object(m.a)(RC,"SmartLookupVersion",null,[]);class fL{}Object(m.a)(fL,"ConfigurationProvider",null,[]);class MD{constructor(b){MD._instance=
b}rjf(){return MD._instance}}MD._instance=null;Object(m.a)(MD,"SearchHostRuntime",null,[]);class SG{constructor(){this.rda=this.cQb=this.W=null}get name(){return"Common.App.Insights"}xc(b){this.W=b;const h=Jh.a.sq(Ja.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>")),u=r.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||r.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(OG,"Common.App.Insights.InsightsActor").singleInstance().Xd(()=>new OG(b.af("Common.App.Insights.IInsightsManager"),
r.AFrameworkApplication.ya,go.a.instance,ub.FocusManager.instance(),b.Za("Common.App.SearchCommon.ISearchOAuthManager"),r.AFrameworkApplication.K,lf.a.instance,u,new Zf.a(()=>h.result)));b.register(255,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Xd(()=>new WK(b));u&&(b.register(RC,"Common.App.Insights.SmartLookupVersion").singleInstance().Xd(()=>new RC),b.register(256,"Common.App.SearchCommon.ISearchHelper").singleInstance().Xd(()=>new RG(Ja.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
b.Pa("Common.App.Insights.SmartLookupVersion"))))}init(){r.AFrameworkApplication.XZ&&(this.cQb=this.W.Pa("Common.App.Insights.InsightsActor"),this.cQb.Wb())}W8k(){this.Mhm()}Mhm(){aN().then(b=>{if(""!==b){const h=this.W.Pa("Common.App.Insights.SmartLookupVersion");h&&h.V2n(b)}this.pEd();this.cQb=this.W.resolve("Common.App.Insights.InsightsActor");b=bN(b);b=Nb.a.create(b);b.lW((h,u)=>{u.succeeded?this.U3n()&&this.prefetchZeroTerm():sm.lB("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
u.pC,10);this.cQb.Wb()});Ib.a.eT(b)})}U3n(){const b=Object.assign(new fL,{channelId:Eh.channelId,approvedOriginPattern:MF()?"^(http)?://(localhost:8080)$":r.AFrameworkApplication.K.lb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const u=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),y=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),P=new ob.a;h&&P.add(h);u&&P.add(u);y&&P.add(y);h=$K();try{const aa=new aL,
ta=SmartLookupHostRuntime.setup(b,P.toArray(),!0,h,aa);this.W.register(MD,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Xd(()=>new MD(ta));return!0}catch(aa){return sm.lB("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+aa,10),!1}}prefetchZeroTerm(){if(r.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=
Ja.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime");if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),u=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.Cmf(null,u,0,99).then(y=>{b.rjf().prefetchZeroTerm(y,r.AFrameworkApplication.userSessionId,NF(),!0,"Indoc",null)})}else sm.lB("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}pEd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=QG(b.mMc());
b=b.mMc();b=HE()+(""!==b?b:Eh.o4c)+"/scripts/microsoft.office.smartlookup.ssr.js";const u=cN();ba.a.rna?this.V8k(h,b):(this.T8k(h,u),this.U8k(b,u))}T8k(b,h){const u=new Sys.Net.WebRequest;u.set_httpVerb("GET");const y={};y.method=u.get_httpVerb();u.set_url(b);const P=(new Date).getTime();try{window.fetch(u.getResolvedUrl(),y).then(()=>{""!==h&&sm.N0f(h,b,(new Date).getTime()-P);this.W.Pa("Common.App.Insights.SmartLookupVersion")})}catch(aa){sm.lB("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
aa.toString(),10)}}U8k(b,h){var u=new Sys.Net.WebRequest;u.set_httpVerb("GET");const y={};y.method=u.get_httpVerb();u.set_url(b);let P=-1;if(r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))u=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),lf.a.instance.Xb(new sc.a(5,1,u,()=>{const aa=Nb.a.create(b);aa.yTe(()=>{P=Date.now()});aa.lW((ta,Pa)=>{Pa.succeeded?""!==h&&sm.N0f(h,b,Date.now()-
P):sm.lB("InsightsPackage - Failed to prefetch JS file.",10)});Ib.a.eT(aa)}));else{P=Date.now();try{window.fetch(u.getResolvedUrl(),y).then(()=>{""!==h&&sm.N0f(h,b,Date.now()-P)})}catch(aa){sm.lB("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+aa.toString(),10)}}}V8k(b,h){if(ba.a.rna){var u=r.AFrameworkApplication.Ve;b=new HF.a(b,1,null,null,!0,2,null);u.send(b).UFa(y=>{y&&y.data?y.data.Ae?this.W.Pa("Common.App.Insights.SmartLookupVersion"):sm.lB("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
y.data.jf,10):sm.lB("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},y=>{y&&y.data?sm.lB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+y.data.jf,10):sm.lB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});r.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new HF.a(h,1,null,null,!0,2,null),u.send(h).UFa(y=>{y&&y.data?y.data.Ae||sm.lB("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
y.data.jf,10):sm.lB("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},y=>{y&&y.data?sm.lB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+y.data.jf,10):sm.lB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.cQb&&this.cQb.dispose()}}Object(m.a)(SG,"InsightsPackage",null,[1,2]);var gL=c(1549);class hL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(m.a)(hL,"DocumentContentParams",null,[]);var OF=c(1809),TG=c(1812),UG=c(510),ND=c(840),iL=c(1412),qs;(function(b){b.vTa="SearchProvider";b.v7a="TextSummarization";b.yPb="ExtractiveTextSummarization"})(qs||(qs={}));Object(m.b)("WorkflowType",qs);var Fu;(function(b){b.Success="Success";b.Ihg="Invoked";b.Error="Error"})(Fu||(Fu={}));Object(m.b)("LogType",Fu);var zw;(function(b){b.jvj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck=
"BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";b.Ehg="InvalidAnnotation";b.oAj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(zw||(zw={}));Object(m.b)("ErrorReason",zw);class SC{constructor(b,h,u,y,P){this.YGh=b;this.Yil=h;this.Ujl=u;this.WPi=y;this.tv=P;this.fLf=this.fLf.bind(this);this.kcc=this.kcc.bind(this);this.lLf=this.lLf.bind(this);this.N3a=[];this.vlo=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3);
this.Hfl=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.ExtractiveTextSummarizationRequestTimeout",5E3)}EFk(){if(this.N3a&&!(0>=this.N3a.length))for(const b of this.N3a)this.Csh(b.paragraphNode)}dCl(b,h,u){return Object(zs.__awaiter)(this,void 0,void 0,function*(){try{if(!SC.$ii)return{success:!1,resultCount:0};if(this.revisionId===u&&this.N3a&&0<this.N3a.length)return this.E8l(),{success:!0,resultCount:this.N3a.length};this.Ifl=Date.now();this.revisionId=u;this.Pq=b;this.N3a=
[];yield this.activateAnnotation();const y={content:h.join(". ")},P=new Nt.a({parentPath:["Signal",iL.b.getTypeName()],items:[{id:"ExtractiveSummaries",body:new iL.b(y)}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:P});this.cMh=window.setTimeout(()=>{this.onError(qs.yPb,Fu.Error,zw.Timeout)},this.Hfl);return new Promise(aa=>{this.x3b=aa})}catch(y){window.clearTimeout(this.cMh),this.onError(qs.yPb,Fu.Error,zw.Other,this.vif(y))}})}submitDocumentContentExtractionSignal(){return Object(zs.__awaiter)(this,
void 0,void 0,function*(){try{this.iRn=Date.now();this.vmb=Ua.a.create().toString();this.log({GH:qs.vTa,logType:Fu.Ihg,success:!0,correlationId:this.vmb});var b=tC().toLowerCase();b="int"===b||"local"===b;yield this.activateAnnotation();const h=new Nt.l({parentPath:["Signal",OF.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new OF.SearchProviderSignal({correlationId:this.vmb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});
this.$1i=window.setTimeout(()=>{this.onError(qs.vTa,Fu.Error,zw.Timeout)},1500)}catch(h){window.clearTimeout(this.$1i),this.onError(qs.vTa,Fu.Error,zw.Other,this.vif(h))}})}generateDocumentSummaryDetails(){return Object(zs.__awaiter)(this,void 0,void 0,function*(){try{if(!SC.Q9b)return null;this.ulo=Date.now();this.log({GH:qs.v7a,logType:Fu.Ihg,success:!0});yield this.activateAnnotation();const b=new Nt.l({parentPath:["Signal",ND.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",
body:new ND.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.Hhj=window.setTimeout(()=>{this.onError(qs.v7a,Fu.Error,zw.Timeout)},this.vlo);return new Promise(h=>{this.Zhc=h})}catch(b){window.clearTimeout(this.Hhj),this.onError(qs.v7a,Fu.Error,zw.Other,this.vif(b))}})}generateDocumentSummary(){var b;return Object(zs.__awaiter)(this,void 0,void 0,function*(){return null===(b=yield this.generateDocumentSummaryDetails())||void 0===b?
void 0:b.summary})}static get Q9b(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get uwm(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",!1)}static get $ii(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableExtractiveTextSummarization",!1)}activateAnnotation(){return Object(zs.__awaiter)(this,
void 0,void 0,function*(){if(!this.T7b){yield Fk.a.nm();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new UG.a,{annotationType:OF.SearchProviderAnnotation.getTypeName(),handler:this.fLf}))];SC.$ii&&h.push(b(Object.assign(new UG.a,{annotationType:TG.TextExtractiveSummaryAnnotation.getTypeName(),handler:this.lLf})));SC.Q9b&&h.push(b(Object.assign(new UG.a,{annotationType:ND.TextSummaryAnnotation.getTypeName(),handler:this.kcc})));yield Promise.all(h);
this.T7b=!0}})}kcc(b){var h,u,y;if(this.Zhc)if(this.fxf(b)){if(b=b.items[0],ND.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.Hhj),b=b.body,b.status!==ND.Result.Success)this.onError(qs.v7a,Fu.Error,this.zWh(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({GH:qs.v7a,logType:Fu.Success,success:!0});var P=null!==b.summary&&""!==b.summary,aa=SC.uwm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===ND.TTSStatus.Success&&null!==(null===(u=b.tts)||void 0===
u?void 0:u.base64Audio)&&""!==(null===(y=b.tts)||void 0===y?void 0:y.base64Audio);this.Zhc({succeeded:P,summary:P?b.summary:null,audioSucceeded:aa,audioBase64:aa?b.tts.base64Audio:null});this.Zhc=null}}else this.log({GH:qs.v7a,logType:Fu.Error,success:!1,CFd:zw.Ehg})}fLf(b){if(this.fxf(b)&&(b=b.items[0],OF.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.$1i),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.vmb)this.log({GH:qs.vTa,
logType:Fu.Error,CFd:zw.jvj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.vmb!==b.correlationId)this.log({GH:qs.vTa,logType:Fu.Error,CFd:zw.oAj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.mzh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);
this.log({GH:qs.vTa,logType:Fu.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.vmb=void 0;this.YGh.i5i(h)}else this.onError(qs.vTa,Fu.Error,zw.Ehg)}lLf(b){if(this.x3b&&this.fxf(b)&&(b=b.items[0],TG.TextExtractiveSummaryAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.cMh),b=b.body,b.status!==TG.Result.Success)this.onError(qs.yPb,Fu.Error,this.zWh(b),`[ExtractiveTextSummarization] workflow failed with status: ${b.status}`);else{var h=b.extractiveSummarizationArrays;
b=[];for(var u of h){h=u.extractiveSummarizations;for(const y of h)b.push(y.summary.slice(0,-1))}u=b.length;if(0<u)for(const y of this.Pq)this.Csh(y),b=b.filter(P=>(P=this.tma(P,y))&&0<P.length?(this.Oha(y,P),this.N3a.push({paragraphNode:y,R8l:P}),!1):!0);this.log({GH:qs.yPb,logType:Fu.Success,success:!0});this.x3b({success:!0,resultCount:u});this.x3b=null}}zWh(b){switch(b.status){case "BlockedByPrefilter":return zw.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return zw.BlockedByQualityCheck;
default:return zw.Other}}tma(b,h){var u=this.WPi.plb(this.WPi.qdc(b));b=bf.a.createQuery(b,qh.a.matchCase);u=this.Ujl.aDb(u.join("|"),b);return this.Yil.FDb(h.Fua(),u)}Oha(b,h){const u=this.tv.Qc(3);u.Eb(b);const y=b.tma();if(y&&0<y.length)for(const P of y)if(P.begin<h[0].end&&P.end>h[0].begin)return;b.Oha(h);u&&u.dispose()}Csh(b){const h=this.tv.Qc(3);h.Eb(b);b.Bea();h&&h.dispose()}E8l(){for(const b of this.N3a)this.Oha(b.paragraphNode,b.R8l)}fxf(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.GH){case qs.vTa:var h=
this.iRn;break;case qs.v7a:h=this.ulo;break;case qs.yPb:h=this.Ifl;break;default:h=-1}const u=Date.now(),y=h?u-h:-1;h=[Object.assign(new ca.a,{name:"WorkflowType",string:b.GH}),Object.assign(new ca.a,{name:"LogType",string:b.logType}),Object.assign(new ca.a,{name:"ErrorReason",string:b.CFd}),Object.assign(new ca.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ca.a,{name:"Message",string:b.message}),Object.assign(new ca.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),
Object.assign(new ca.a,{name:"StartTime",int64:h}),Object.assign(new ca.a,{name:"EndTime",int64:u}),Object.assign(new ca.a,{name:"Duration",int64:y})];Object(Ub.a)("AugloopSearchProviderData",b.success,y,h)}vif(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}mzh(b="",h="",u=""){return Object.assign(new hL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:u})}onError(b,h,u,y){h={GH:b,logType:h,success:!1,message:y,CFd:u};switch(b){case qs.vTa:if(!this.vmb)break;h.correlationId=
this.vmb;this.log(h);this.vmb=void 0;this.$fl();break;case qs.v7a:if(!this.Zhc)break;this.log(h);this.Zhc(null);this.Zhc=null;break;case qs.yPb:if(!this.x3b)break;this.log(h);this.x3b({success:!1,resultCount:0});this.x3b=null;break;default:return null}}$fl(){this.YGh.i5i(this.mzh())}}Object(m.a)(SC,"AugloopSearchProviderManager",null,[]);class PF{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(m.a)(PF,"DocumentContentSearchResults",null,[]);class VG{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,
h,u,y,P){this.selectRange(h,u,y,P)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,u=>{h(Object.assign(new PF,{results:u,totalResultCount:u.length,hasTooManyResults:100<u.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,u=>{h(Object.assign(new PF,{results:u,totalResultCount:u.length,hasTooManyResults:u.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(m.a)(VG,"BaseDocumentContentExecutor",null,[917,163]);var WG=c(1983),jL=c(1427);class QF{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(m.a)(QF,"DocumentContentSearchParams",null,[]);class XG{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(m.a)(XG,"DocumentSelection",null,[]);class kL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(m.a)(kL,"IAuthorProperties",null,[]);var TC=c(686);class YG{constructor(){this.PIc=this.w1e=0}}Object(m.a)(YG,"CommentFindResultIndexInfo",null,[]);const ZG=b=>{b.setSelection(Se.SelectionEditor.Vj(b.hb.kb,!0,!1))},lL=b=>{b=WG.a.OLd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class mL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(m.a)(mL,"DocumentContentSearchResult",null,[]);var dN=c(1764);class nL{constructor(){this.authorEmail=this.authorName=this.wBb=this.B1e=null}}Object(m.a)(nL,"CommentFindResults",null,[]);class oL{constructor(){this.end=this.begin=0}}Object(m.a)(oL,"FindResultOffset",null,[]);class Iy{constructor(b,h,u,y,P,aa,ta,Pa,vb,Kb){this.ioe=this.gv=this.gue=this.rA=null;this.X8g=0;this.qL=null;this.mnc=new ob.a;this.DEg=null;this.gF=b;this.eb=h;this.cbb=u;this.Lda=
P;this.PSb=aa;this.Irb=ta;this.ii=Pa;this.ga=vb;this.ib=Kb}lFl(b,h){var u;const y=[];if(12!=b.type)return y;const P=Wi.FormattingReader.YRh(b);let aa=null,ta=-1;var Pa=rn.a.auto;for(let Kb=0;Kb<=P.length;Kb++){let Sb=-1;var vb=rn.a.auto;Kb<P.length&&(vb=P[Kb],Sb=vb.cp,vb=null===(u=vb.formatting)||void 0===u?void 0:u.cache,vb=(null===vb||void 0===vb?0:vb.RDb)?vb.highlight:(null===vb||void 0===vb?0:vb.oOa)?vb.$t:rn.a.auto);if(Pa!=vb){if(Pa!=rn.a.auto){aa||(aa=this.Irb.Fua(b.id));-1==Sb&&(Sb=aa.length);
Pa=this.cbb.YBd(aa,ta,Sb,"");const Yb={};Yb.context=Pa.OAd;Yb.startOffsetInContext=Pa.g9d;Yb.endOffsetInContext=Pa.e9d-1;y.push({data:Yb,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ta,endOffsetInParagraph:Sb-1})}ta=Sb;Pa=vb}}return y}get S$(){return this.DEg}initialize(){this.rA=Ve.FindManager.createInstance(this,this.Lda,Iz.a.instance,!1,!0)}search(b,h){this.rA.vYa();this.Ixf(b)?(this.gv=h,this.qL=new ob.a,b=this.b5e(b),this.rA.find(b)):h(null)}searchV2(b,h){r.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.rA.vYa();if(this.Ixf(b)){this.Yji()&&this.ga.Ub(Wa.a.tae,2,{CommandValueId:b});this.ioe=h;this.X8g=b.totalResultLimit;this.qL=new ob.a;b=this.b5e(b);this.DEg=new kl.a;this.rA.find(b);h=this.Lda.qdc(b.text);h=this.Lda.plb(h);b=this.PSb.aDb(h.join("|"),b);h=this.ii.YP();for(let y=0;y<h.length;y++){const P=h[y],aa=lL(P);var u=this.Irb.FDb(aa,b);const ta=this.Irb.FDb(P.author,b);if(!u&&!ta){w.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!aa,!b);continue}u=ta?ta:
u;let Pa="",vb="";ta&&(Pa=P.author,vb=P.authorId);for(const Kb of u)u=dN.a.createInstance(Kb.begin,Kb.end,T.a.Gf(P.objectId),y,32,!1),this.mnc.add(u),this.S$.ub(y)||this.S$.add(y,Object.assign(new nL,{B1e:aa,wBb:[],authorName:Pa,authorEmail:vb}))}}else h(null)}get KNh(){null==this.gue&&(this.gue=Ve.FindManager.createInstance(this,this.Lda,Iz.a.instance));return this.gue}Yji(){var b;return null===(b=r.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}sTd(){var b;return null===(b=r.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}highlight(b){var h=this.Ixf(b);b=h?this.b5e(b):null;var u={};this.Yji()&&this.ga.Ub(Rc.a.yUf,2,u);if(u[ag.a.On]){if(h){h={};u={};var y={};this.ga.Ub(Rc.a.K5d,2,h);this.ga.Ub(Wa.a.J5d,2,u);this.ga.Ub(Wa.a.L5d,2,y);if(b.text!=h.CommandValueId||b.matchCase!=u[ag.a.On]||b.matchWholeWord!=y[ag.a.On])ZG(this.ib),this.ga.Ub(Wa.a.findInDocument,
2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else u=this.KNh,u.vYa(),h&&u.find(b)}selectNextPrevHighlight(b){const h=this.KNh;return 0<h.Mj.ria?(b?h.vNd():h.wNd(),h.Mj.SRe-1):-1}b5e(b){let h=qh.a.none;b.matchCase&&(h|=qh.a.matchCase);b.matchWholeWordOnly&&(h|=qh.a.wholeWordOnly);return bf.a.createQuery(b.query,h)}Ixf(b){return b&&!!b.query&&0<b.query.length}mbe(){}K$d(){}reset(){}edf(){}F3b(){if(this.gv){var b=this.nzh(this.qL);this.gv(b)}if(this.ioe){b=new PF;
const h=this.qL.count+this.mnc.count>this.X8g;b.totalResultCount=this.qL.count+this.mnc.count;b.hasTooManyResults=h;h||(this.qL.VA(this.qL.count,this.mnc),b.results=this.nzh(this.qL));this.ioe(b);this.mnc.clear()}}nzh(b){var h;const u=[];var y=Object.assign(new TC.a,{xOa:!1,yOa:this.sTd(),zOa:!0});y=this.eb.YCa(this.gF.value,y);for(const ta of b){var P=ta.begin;let Pa=ta.end;var aa=void 0;b=-1;let vb=null,Kb=0;if(32===ta.type){vb=Iy.A1e;Kb=3;b=y.count+ta.rOa;const Sb=({begin:P,end:Pa}=gL.a.LUi(this.S$.J(ta.rOa).B1e,
P,Pa)).returnValue;aa=this.cbb.YBd(Sb,P,Pa,ki.a(ta.type));this.S$.J(ta.rOa).B1e=Sb;this.S$.J(ta.rOa).wBb.push(Object.assign(new oL,{begin:P,end:Pa}))}else{!this.sTd()||2!==ta.type&&4!==ta.type||(Kb=2===ta.type?1:2,vb=Iy.$pf);for(aa=0;aa<y.count;aa++)if(y.J(aa).id===ta.nodeId){b=aa;break}aa=this.cbb.ZBd(ta)}P=(null===(h=this.S$)||void 0===h?0:h.ub(ta.rOa))?this.S$.J(ta.rOa):null;if(0<=b||(null===P||void 0===P?0:P.authorName))b=Object.assign(new mL,{snippet:aa.OAd,subdocumentId:vb,subdocumentType:Kb,
startOffsetInSnippet:aa.g9d,endOffsetInSnippet:aa.e9d-1,paragraphIndex:b,startOffsetInParagraph:ta.begin-aa.g9d,endOffsetInParagraph:ta.end-aa.e9d-1,authorName:P?P.authorName:"",authorEmail:P?P.authorEmail:""}),u.push(b)}u.sort((ta,Pa)=>ta.paragraphIndex===Pa.paragraphIndex?ta.startOffsetInParagraph-Pa.startOffsetInParagraph:ta.paragraphIndex-Pa.paragraphIndex);return u}update(){}mNa(b,h){switch(b){case 0:h&&0<h.length&&!this.qL&&(w.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),
this.qL=new ob.a);for(const u of h)this.qL.add(u)}}Rmb(){}dispose(){}}Iy.A1e="Comment";Iy.$pf="HeaderFooter";Iy.Xbi="Image";Object(m.a)(Iy,"WordDocumentSearchProcessor",null,[165,9,166]);class pL extends VG{get ZQ(){return!this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}sTd(){var b;return null===(b=r.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}constructor(b,
h,u,y,P,aa,ta,Pa,vb,Kb,Sb,Yb,Ac,Sc){super();this.Ma=Kb;this.WKa=null;this.P3=(nd,Ad)=>{nd=Ad.node;Ad=Ad.property;this.F4f(nd)&&Ad===Ge.a.Co&&this.KDb(nd,3)};this.Wga=(nd,Ad)=>{nd=Ad.node;!Ad.Luf&&this.F4f(nd)&&this.KDb(nd,1)};this.Mkb=(nd,Ad)=>{nd=Ad.node;this.F4f(nd)&&this.KDb(nd,2)};this.gF=b;this.eb=h;this.fd=u;this.ib=y;this.YD=P;this.ll=Pa;this.Vb=vb;this.a6=aa;this.EB=ta;this.ii=Sb;this.YPj=Yb;this.l3g=T.a.create();this.G7d(this.P3,this.Wga,this.Mkb);Sc&&Sc.execute(nd=>this.Sja=nd);Ac.execute(nd=>
{this.eka=nd})}submitDocumentContentExtractionSignal(){this.eka&&this.eka.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.eka?this.eka.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.eka?this.eka.generateDocumentSummaryDetails():Promise.resolve(null)}highlightDocumentKeySentences(){if(this.eka){const b=this.s1h();return this.eka.dCl(b,this.Agb(b).toArray(),this.getRevision())}return Promise.resolve({success:!1,resultCount:0})}clearDocumentKeySentencesHighlights(){this.eka&&
this.eka.EFk()}getAllParagraphsInDocument(){const b=this.Agb(this.s1h());for(let u of this.ii.YP()){var h=WG.a.OLd(u.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new TC.a,{xOa:!1,yOa:!1,zOa:!0}),u=this.eb.YCa(this.gF.value,h);h=[];const y=[];for(var P=0;P<u.count;++P){var aa=u.J(P);h.push(...this.eGl(aa,P));y.push(...this.a6.lFl(aa,P))}u=[];P=this.ii.YP();for(aa=0;aa<P.length;aa++)u.push(this.Uwl(P[aa]));P={};P.images=
h;P.comments=u;P.highlights=y;b(P)}selectRange(b,h,u,y,P){const aa=Date.now(),ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.XRa();if(0>b||0>h||0>u||0>y||b>u||b===u&&h>y)throw Error("Provided select range offsets incorrect");const Sc=Object.assign(new TC.a,{xOa:!1,yOa:!1,zOa:!0}),nd=this.eb.YCa(this.gF.value,Sc);if(u>=nd.count){const Ad=Ja.a.instance.resolve("Common.Comments.ICommentModel").YP(),he=u-nd.count;if(he<Ad.length){P=-1;if(this.a6.S$.ub(he)){const Nd=
this.a6.S$.J(he).wBb;for(var Pa=0;Pa<Nd.length;Pa++)if(Nd[Pa].begin===h){P=Pa;break}}this.WKa=-1!==P?Object.assign(new YG,{w1e:he,PIc:P}):null;const ce=Ad[he];r.AFrameworkApplication.ya.processAction(Rc.a.ZS,2);r.AFrameworkApplication.ya.Ub(Rc.a.eaa,2,null);r.AFrameworkApplication.ya.Ub(Rc.a.selectComment,2,Object.assign(new jL.a,{commentId:ce.id,B8:2,ZQ:this.ZQ}))}}else{this.WKa=null;var vb=nd.J(b),Kb=nd.J(u);if(!this.tVd(vb,h)||!this.tVd(Kb,y))throw Error("Provided select range offsets incorrect");
r.AFrameworkApplication.ya.processAction(Rc.a.ZS,2);this.Iij(vb);var Sb=this.YD.we(vb,h);Pa=this.YD.Vz(Sb,nf.a.Uc(Kb,y+1));if(P){const Ad=Pa.toArray();h=[];for(const he of Ad)h.push(this.ELd(he.node));h.join(" ").includes(P)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}var Yb=this.ll.value.Jt,Ac=this.ib.hb.kb;Ac&&Ac.equals(Pa)&&this.fd.pca(Yb,null);this.fd.pca(Yb,Pa);ta.duration=Date.now()-aa;this.logMessage(ta)}}catch(Sc){ta.success=!1,ta.message=Sc.stack,
ta.duration=Date.now()-aa,this.logMessage(ta)}}search(b,h){this.XRa();this.a6.search(Object.assign(new QF,{query:b}),h)}searchV2(b,h){this.XRa();this.a6.searchV2(Object.assign(new QF,{query:b}),h)}selectNextPrevHighlight(b){this.XRa();return this.a6.selectNextPrevHighlight(b)}searchWithParam(b,h){this.XRa();this.a6.search(b,h)}searchWithParamV2(b,h){this.XRa();this.a6.searchV2(b,h)}highlight(b){this.XRa();this.a6.highlight(Object.assign(new QF,{query:b}))}highlightWithParam(b){this.XRa();this.a6.highlight(b)}getRevision(){return this.l3g.toString()}getSelectedText(){const b=
this.YPj.getSelectedText();return Object.assign(new Vx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new TC.a,{xOa:!1,yOa:this.sTd(),zOa:!0}),h=({Pq:aa}=this.sTl(b)).returnValue;if(h)return h;var u=this.ib.hb.kb;if(!u||!u.length)return null;h=u.Qa;u=u.Tc;let y=-1,P=-1;var aa=aa||this.eb.YCa(this.gF.value,b);b=null;for(let ta=0;ta<aa.count;ta++){const Pa=aa.J(ta);-1===y&&h.node.id===Pa.id&&(y=ta,b=Pa);-1===P&&u.node.id===
Pa.id&&(P=ta)}aa=null;5===(null===b||void 0===b?void 0:b.zCa)&&(aa=Iy.$pf);return Object.assign(new XG,{subdocumentId:aa,startParagraphIndex:y,startParagraphOffset:h.xk,endParagraphIndex:P,endParagraphOffset:u.$q})}clearDocumentSelection(){ZG(this.ib)}selectRangeV2(b,h,u,y,P,aa){const ta=Date.now(),Pa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.XRa();if(0>h||0>u||0>y||0>P||h>y||h===y&&u>P)throw Error("Provided select range offsets incorrect");
var vb=Object.assign(new TC.a,{xOa:!1,yOa:!0,zOa:!0});const Ac=this.eb.YCa(this.gF.value,vb);if(b==Iy.A1e)this.n2i(u,y,Ac.count);else{vb=this.WKa=null;var Kb={};Kb.subdocumentId=b;Kb.startParagraphIndex=h;Kb.startParagraphOffset=u;Kb.endParagraphIndex=y;Kb.endParagraphOffset=P;vb=b==Iy.Xbi?this.GYh(Ac.J(h),Object.assign({isFloatingImage:!1,imageId:""},Kb)):this.e6h(Ac.J(h),Ac.J(y),Object.assign({clickedPassage:aa},Kb),Pa);var Sb=this.ll.value.Jt,Yb=this.ib.hb.kb;(null===Yb||void 0===Yb?0:Yb.equals(vb))&&
this.fd.pca(Sb,null);this.fd.pca(Sb,vb)}Pa.duration=Date.now()-ta;this.logMessage(Pa)}catch(Ac){Pa.success=!1,Pa.message=Ac.stack,Pa.duration=Date.now()-ta,this.logMessage(Pa)}}selectRangeV3(b){const h=Date.now(),u={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.XRa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&
b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var y=Object.assign(new TC.a,{xOa:!1,yOa:!0,zOa:!0});const ta=this.eb.YCa(this.gF.value,y);if(b.subdocumentId==Iy.A1e)this.n2i(b.startParagraphOffset,b.endParagraphIndex,ta.count);else{y=this.WKa=null;y=b.subdocumentId==Iy.Xbi?this.GYh(ta.J(b.startParagraphIndex),b):this.e6h(ta.J(b.startParagraphIndex),ta.J(b.endParagraphIndex),b,u);var P=this.ll.value.Jt,aa=this.ib.hb.kb;(null===aa||void 0===aa?0:aa.equals(y))&&
this.fd.pca(P,null);this.fd.pca(P,y)}u.duration=Date.now()-h;this.logMessage(u)}catch(ta){u.success=!1,u.message=ta.stack,u.duration=Date.now()-h,this.logMessage(u)}}s1h(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},u=Object.assign(new TC.a,{xOa:!1,yOa:!1,zOa:!0});h.duration=Date.now()-b;this.logMessage(h);return this.eb.YCa(this.gF.value,u)}Agb(b){const h=Date.now(),u={activityName:"GetParagraphContent",success:!0,message:"",duration:0},y=new ob.a;for(let P of b)y.add(this.ELd(P));
u.duration=Date.now()-h;this.logMessage(u);return y}GYh(b,h){if(h.isFloatingImage)return h=T.a.Gf(h.imageId),b=b.Jc.Db(h),b=Kf.SelectionFactory.kq(b);const u=this.YD.we(b,h.startParagraphOffset);return b=this.YD.Vz(u,nf.a.Uc(b,h.startParagraphOffset+1))}getAuthorImageUrlFromClient(b,h){return Object(zs.__awaiter)(this,void 0,void 0,function*(){var u=new Be.a(b,"O365",h,b);if(!this.Sja||!this.Sja.getPersonaIconPropertiesArray)return null;u=yield this.Sja.getPersonaIconPropertiesArray([u]);return 0<
u.length&&u[0].authorImageURL?Object.assign(new kL,{authorImageURL:u[0].authorImageURL,authorColor:u[0].authorColor,authorID:u[0].authorID}):null})}e6h(b,h,u,y){if(!this.tVd(b,u.startParagraphOffset)||!this.tVd(h,u.endParagraphOffset))throw Error("Provided select range offsets incorrect");u.subdocumentId==Iy.$pf?r.AFrameworkApplication.ya.Ub(Rc.a.pjb,2,new Ww.a(b)):r.AFrameworkApplication.ya.processAction(Rc.a.ZS,2);this.Iij(b);b=this.YD.we(b,u.startParagraphOffset);h=this.YD.Vz(b,nf.a.Uc(h,u.endParagraphOffset+
1));if(u.clickedPassage){b=h.toArray();const P=[];for(const aa of b)P.push(this.ELd(aa.node));P.join(" ").includes(u.clickedPassage)||(y.success=!1,y.message="The text in clicked passage does not match the selected hit")}return h}n2i(b,h,u){const y=Ja.a.instance.resolve("Common.Comments.ICommentModel").YP();h-=u;if(h<y.length){u=-1;if(this.a6.S$.ub(h)){const P=this.a6.S$.J(h).wBb;for(let aa=0;aa<P.length;aa++)if(P[aa].begin===b){u=aa;break}}this.WKa=-1!==u?Object.assign(new YG,{w1e:h,PIc:u}):null;
b=y[h];r.AFrameworkApplication.ya.processAction(Rc.a.ZS,2);r.AFrameworkApplication.ya.Ub(Rc.a.eaa,2,null);r.AFrameworkApplication.ya.Ub(Rc.a.selectComment,2,Object.assign(new jL.a,{commentId:b.id,B8:2,ZQ:this.ZQ}))}}XRa(){this.Vb&&(this.Vb.currentScope&&this.Vb.currentScope.name===Eh.nB||this.Vb.Dg(Eh.nB))}nAo(){this.l3g=T.a.create()}ELd(b){if(b.bFb)return"";b=this.eb.text(b);return ro.AParagraphNode.uU(b," ")}tVd(b,h){b=this.ELd(b);return h<b.length}KDb(b,h){switch(h){case 1:case 2:case 3:this.nAo()}}logMessage(b){const h=
[Object.assign(new ca.a,{name:"Message",string:b.message})];Object(Ub.a)(b.activityName,b.success,b.duration,h)}F4f(b){return!b.bFb&&this.rRc(b)}rRc(b){const h=this.gF.value;return!!h&&!!h.Bd&&!!b.Jc&&b.Jc.id.equals(h.Bd.id)}Iij(b){this.eb.KQc(b)?32===r.AFrameworkApplication.ya.Ub(Rc.a.Wkb,2,new Ww.a(b))&&r.AFrameworkApplication.ya.processAction(Rc.a.eef,2):r.AFrameworkApplication.ya.Ub(Rc.a.eaa,2,null)}G7d(b,h,u){this.EB&&(this.EB.Ap(b),this.EB.mu(h),this.EB.Mv(u))}sTl(b){let h=null;var u=this.Vb?
this.Vb.currentScope.name:"";if(!this.ii.Ss||u!==xe.AFrame.sr&&u!==xe.AFrame.QL)return{returnValue:null,Pq:h};u=Array.indexOf(this.ii.YP(),this.ii.Ss);if(0>u)return{returnValue:null,Pq:h};h=this.eb.YCa(this.gF.value,b);var y=WG.a.OLd(this.ii.Ss.text[0]).split("\n");b=0;y=(1===y.length?y[0]:y.join(" ")).length-1;this.WKa&&u===this.WKa.w1e&&this.a6.S$.ub(u)&&this.a6.S$.J(u).wBb.length>this.WKa.PIc&&(b=this.a6.S$.J(u).wBb[this.WKa.PIc].begin,y=this.a6.S$.J(u).wBb[this.WKa.PIc].end);return{returnValue:Object.assign(new XG,
{startParagraphIndex:h.count+u,startParagraphOffset:b,endParagraphIndex:h.count+u,endParagraphOffset:y,subdocumentId:"Comment"}),Pq:h}}eGl(b,h){const u=[];if(12!=b.type)return u;u.push(...this.FGl(b,h));u.push(...this.nDl(b,h));return u}nDl(b,h){const u=[],y=yd.GraphIterator.$a(b);if(!y.$z())return u;let P=y.Vd();for(;P;){if(!this.XOa(P)){P=y.ht();continue}const aa=P.properties;aa&&Jd.ImageReader.TQc(aa)&&u.push(this.Qjj(aa,h,0,b.Jc,!0,P.id.toString()));P=y.ht()}return u}XOa(b){if(19!==b.type)return!1;
b=yd.GraphIterator.$a(b);if(!b.$z())return!0;let h=b.Vd();for(;h;){if(59===h.type)return!1;h=b.ht()}return!0}FGl(b,h){const u=[],y=b.Jc;if(y){if(!b.hasProperty(Ge.a.An))return u;var P=b.ia(Ge.a.An,null);if(!P)return u;b=b.ia(Ge.a.vm,null);for(let ta=0;ta<P.length;++ta){var aa=P[ta];if(!aa)continue;aa=y.Db(aa);if(!aa||!Jd.ImageReader.TQc(aa))continue;let Pa=0;0!=ta&&b&&ta-1<b.length&&(Pa=b[ta-1]);u.push(this.Qjj(aa,h,Pa,y,!1,""))}return u}}Qjj(b,h,u,y,P,aa){y=(new Sys.Net.WebRequest).getResolvedUrl()+
Jd.ImageReader.yua(b,y,this.Ma,r.AFrameworkApplication.ta.yDa);const ta=b.ia(ld.a.xu,""),Pa={};Pa.base64Encoding=ta;Pa.url=y;Pa.width=Jd.ImageReader.jD(b);Pa.height=Jd.ImageReader.DI(b);Pa.altText=Jd.ImageReader.WW(b);Pa.description=Jd.ImageReader.TNa(b);Pa.imageId=aa;Pa.isFloatingImage=P;return{data:Pa,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:u,endOffsetInParagraph:u+1}}Uwl(b){return{data:{comment:lL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},
startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(m.a)(pL,"WordDocumentContentExecutor",VG,[]);class RF{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(m.a)(RF,"BaseDocumentHelper",null,[274]);class qL extends RF{constructor(b){super();this.ppl=b}get gEd(){const b=this.ppl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Ra.App.xa.jb.isEditingAllowed}author(){var b;return null===(b=this.gEd)||
void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.gEd)||void 0===b?void 0:b.creationDate}}Object(m.a)(qL,"WordDocumentHelper",RF,[]);class rL{constructor(b){this.nvi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.Msf(b.htmlText)}getId(){return"InsertContentExecutor"}Msf(b){return this.executeCommand(Oa.a.Rsa,b)}executeCommand(b,h){const u=new uh.DictionaryPropertySet;u.setValue(ld.a.PQ,h);u.setValue(ld.a.pxa,!1);h=this.nvi.processAction(b,1);32===h&&(h=this.nvi.Ub(b,2,u));return h}}
Object(m.a)(rL,"WordInsertContentExecutor",null,[162,163]);class sL{constructor(b,h,u,y){this.aoc="undefined";this.a4f="Something went wrong with retrieving a summary. Please try again.";this.ejm=(P,aa,ta,Pa,vb)=>tv.lX(P,aa,ta,Pa,this.zB,vb);this.hce=(P,aa,ta,Pa,vb)=>{if(1===ta)return this.XQj?32:8;P=oF.getSelectedText();P=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,oF.bMd(P));vb[Qm.a.LabelText]=P;return 32};this.tff=(P,aa,ta)=>{if(1===ta)return 32;const Pa=
{};this.eka?this.eka.generateDocumentSummary().then(vb=>{vb||(vb=this.a4f,w.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));Pa.additionalData=this.K3e(vb);this.ga.Ub(Wa.a.qua,2,Pa)}).catch(()=>{w.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");Pa.additionalData=this.K3e(this.a4f);this.ga.Ub(Wa.a.qua,2,Pa)}):(w.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),
Pa.additionalData=this.K3e(this.a4f),this.ga.Ub(Wa.a.qua,2,Pa));return 32};this.zB=b;this.ga=h||r.AFrameworkApplication.ya;this.Ma=u;this.GQj=(this.ww=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.vX)&&!!this.Ma&&this.Ma.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.XQj=!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);y&&y.execute(P=>{this.eka=P})}Wb(){this.ga.gb(Rc.a.Okh,le.a.frame,this.ejm,1028);this.ga.gb(Rc.a.hce,
le.a.frame,this.hce,1028);this.ga.gb(Rc.a.gRh,le.a.frame,this.tff,1028);this.GQj&&(this.aoc=Ra.App.xa.eI.getWindowMode(),this.OJh(this.aoc),Ra.App.xa.eI.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.aoc&&(this.aoc=h,this.OJh(this.aoc))}))}OJh(b){"DP"===b&&Vj.UISurfaces.wu().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Ub(Rc.a.Okh,2,{SourceControlId:"smartlookupAuto"});return null})}K3e(b){return{["documentSummary"]:b}}}Object(m.a)(sL,"WordInsightsActor",null,[]);class OD{constructor(){this.Bbd=
this.cP=null}W_a(){return this.BCb()}cZh(){return this.BCb()}aZh(){return null}G$n(b,h,u){this.cP||(this.cP=this.IBd());this.cP.wO(b,h,u)}H$n(b,h,u){this.cP||(this.cP=this.IBd());this.cP.W5f(b,h,u)}f9n(b,h){this.Bbd||(this.Bbd=null);this.Bbd&&this.Bbd.W5f(b,h)}MLb(b,h){this.cP||(this.cP=this.IBd());this.cP.MLb(b,h)}fWd(b){this.cP||(this.cP=this.IBd());this.cP.fWd(b)}fTn(){this.cP&&this.cP.Nfc()}FXn(){this.cP&&this.cP.hae()}r8n(){var b=r.AFrameworkApplication.K.pc("SmartLookupLaunchThrottleThresholdInMilliseconds",
1500);b=window.performance.now()-OD.Sqi<=b;b||(OD.Sqi=window.performance.now());return b}dispose(){this.cP&&(this.cP.dispose(),this.cP=null)}get HFb(){return this.cP?this.cP.isVisible:!1}}OD.Sqi=0;Object(m.a)(OD,"InsightsManager",null,[943,9]);class IE{constructor(b,h,u,y,P,aa=!0,ta=null,Pa=null){this.R4=this.MC=this.HJa=null;this.Jsc=!1;this.rda=null;this.Vb=h;this.aUb=aa;this.QHg=Pa?Pa:new RF;this.vz=ta;this.Zo=b;this.aUb&&(Ja.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime")&&(this.rda=
Ja.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").rjf()),this.dbb=Ja.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Ywb=this.dbb.mMc())}Hkb(b){if(this.aUb){b=b.rawEvent;try{var h=z.a(b.data)}catch(u){w.ULS.sendTraceTag(595161728,1303,15,this.kT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.MC&&(b=this.MC.entryPoint);this.dbb.Cmf(this.R4,this.QHg,this.b6b(),b).then(u=>{h.data=u;this.ylb(h)});break;
case 118:h.data=this.MC?this.MC:Object.assign(new ju.a,{selection:Object.assign(new Vx.a,{neighborhood:this.HJa.neighborhood,mentionStart:this.HJa.mentionStart,mentionLength:this.HJa.mentionLength})});this.ylb(h);break;case 103:b=z.a(Object(na.a)(String,h.data));sm.sendTelemetryEvent(b);break;case 206:this.dbb.v6h(h.data).then(u=>{h.data=u;this.ylb(h)});break;case 112:h.data.shiftPressed?(ba.a.kj&&document.activeElement.blur(),this.Zo.IOd(0,null,2,null,null),w.ULS.sendTraceTag(592545156,1303,50,this.kT("Serplet UX lost focus through Ctrl + Shift + F6"))):
(this.Zo.hNc(0,null,2,null,null),w.ULS.sendTraceTag(592545155,1303,50,this.kT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Tma()}}}J1c(b){if(this.rda){var h=0;this.MC&&(h=this.MC.entryPoint);this.dbb.Cmf(this.R4,this.QHg,this.b6b(),h).then(u=>{sm.j3i("SearchFromHost",this.R4);this.MC.launchData||(this.MC.launchData=new av.a);const y=NF();try{this.rda.search(this.MC,u,r.AFrameworkApplication.userSessionId,y,b),this.dbb.dgn(P=>{sm.j3i("SearchFromHostWithToken",this.R4);this.rda.searchAuthenticatedProviders(this.MC,
u,r.AFrameworkApplication.userSessionId,y,null,P)})}catch(P){sm.lB("BaseSmartLookupPane - Fail to search from host. Error: "+P,10)}}).catch(u=>{sm.lB("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+u.toString(),10)})}}Ofc(b){if(this.aUb){var h=sm,u=h.Ofc,y=this.R4;b=Math.round(window.performance.now()-b);var P=this.MC?LD[this.MC.entryPoint]:"",aa=this.dbb.mMc(),ta=this.dbb.mCl(),Pa=this.MC?this.MC.entryPoint:0;u.call(h,y,b,P,aa,ta,r.AFrameworkApplication.LUe,this.Jsc,
18===Pa||19===Pa||15===Pa)}}}Object(m.a)(IE,"BaseSmartLookupPane",null,[264,9]);class JE{constructor(b){this.messageType=null;this.messageType=b}}Object(m.a)(JE,"InsightsMessage",null,[]);class KE extends JE{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(m.a)(KE,"InsightsMessageWithContent",JE,[]);class tL extends KE{constructor(b){super(Eh.oUm,b)}}Object(m.a)(tL,"InsightsMessageAppProperties",KE,[]);class uL extends KE{constructor(b){super(Eh.BUm,b)}}Object(m.a)(uL,
"InsightsMessageSelection",KE,[]);class vL extends JE{constructor(){super(Eh.DUm)}}Object(m.a)(vL,"InsightsMessageTakeFocus",JE,[]);class LE extends IE{constructor(b,h,u,y,P=null,aa=null,ta=null,Pa=!0,vb=null,Kb=null){super(h,u,P,aa,ta,Pa,vb,Kb);this.Bad=this.uA=this.hj=null;this.Yld=!1;this.Cgd=b;this.krc=this.aUb?QG(this.Ywb):r.AFrameworkApplication.uhm;this.qZ();this.rWf();this.Lp=y;this.GGg=0}get isVisible(){return!1}qZ(){this.hj=this.Cgd.xFc();r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb.Kib&&
this.hj.qAn(b=>{b===this.hj&&(this.hae(),this.Nfc())});this.qsf(this.hj.oSa.ulh);this.hj.Nl()}qsf(b){b.style.overflow="hidden";const h=kg.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.uA=h;b.appendChild(this.uA);this.uA.id=Eh.Uqf}rWf(){rf.a.addHandler(this.uA,"load",Object(v.a)(this,this.Mbc,"onIFrameLoad"));rf.a.addHandler(this.uA,"error",Object(v.a)(this,this.Gkb,"onIFrameError"));$addHandler(window,"message",Object(v.a)(this,
this.Hkb,"onIFrameMessage"))}Mbg(){rf.a.removeHandler(this.uA,"load",Object(v.a)(this,this.Mbc,"onIFrameLoad"));rf.a.removeHandler(this.uA,"error",Object(v.a)(this,this.Gkb,"onIFrameError"));$removeHandler(window,"message",Object(v.a)(this,this.Hkb,"onIFrameMessage"))}dispose(){this.uA&&(this.Mbg(),this.uA.parentNode.removeChild(this.uA),this.uA=null);this.hj&&(this.Cgd.u2b(this.hj),this.hj=null)}wO(b,h,u){this.R4=h;this.Bad=null;this.GGg=u;this.Jsc=!b.mentionLength;this.Yld=!1;w.ULS.sendTraceTag(6295947,
1303,50,this.kT("Start to show Insights"));this.HJa=b;this.krc&&this.krc.length?this.uA.src=this.krc:(this.uA.src=LE.vBi,w.ULS.sendTraceTag(6295948,1303,15,this.kT("The Insights URL config setting is null or empty")));this.Lp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.hj.zX||this.hj.wWf(Object(v.a)(this,this.k5m,"onInsightsTaskPaneHidden"));this.aUb&&this.J1c(!1);b=window.performance.now();this.Cgd.showTaskPane(this.hj);this.hj.Nl();this.Ofc(b)}W5f(b,h,u){this.MC=b;this.wO(Object.assign(new GE.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,u)}MLb(){}fWd(){}Nfc(){this.uA.src===this.krc&&this.Yld&&(this.Vb.Dg(Eh.nB),this.ylb(new vL))}hae(){this.uA&&ub.FocusManager.wJ(this.uA.contentWindow)}Q6e(){this.uA.src=LE.vBi;this.hj.sm()}Tma(){this.Cgd.hideTaskPane(this.hj);this.Q6e()}k5m(b){b===this.hj&&this.Tma()}Mbc(){w.ULS.sendTraceTag(6295951,1303,50,this.kT("The iframe is successfully loaded in Insights task pane"))}Gkb(){w.ULS.sendTraceTag(6295952,
1303,15,this.kT("The iframe failed to load in Insights task pane"))}Hkb(b){const h=b.rawEvent;if(h.source===this.uA.contentWindow)if(this.aUb)super.Hkb(b);else{let u;try{u=z.a(h.data)}catch(y){w.ULS.sendTraceTag(6295953,1303,15,this.kT("Message data [{0}] failed to deserialize.",h.data));return}if(Oe.c(u.messageType))w.ULS.sendTraceTag(6295954,1303,15,this.kT("Message data [{0}] is in wrong format.",h.data));else switch(u.messageType){case Eh.pUm:this.ylb(new tL(this.OGl()));break;case Eh.CUm:this.ylb(new uL(this.HJa));
break;case Eh.wUm:this.Yld=!0;this.hae();this.Nfc();w.ULS.sendTraceTag(6295955,1303,50,this.kT("Insights pane rendering is completed"));break;case Eh.EUm:b=u.messageContent;this.Bad=b.clientCorrelationId;this.R4!==b.appCorrelationId&&w.ULS.sendTraceTag(6403778,1303,15,this.kT("App correlation ID on client {0} does not match one on server {1}",this.R4,b.appCorrelationId));break;case Eh.vUm:u.messageContent?(ba.a.kj&&document.activeElement.blur(),this.Zo.IOd(0,null,2,null,null),w.ULS.sendTraceTag(6604741,
1303,50,this.kT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Zo.hNc(0,null,2,null,null),w.ULS.sendTraceTag(6604742,1303,50,this.kT("Insights UX lost focus through Ctrl + F6")));break;case Eh.sUm:u.messageContent.keyCode===fb.a.Q6a&&this.Tma();break;case Eh.tUm:try{this.Yld=!1,localStorage.setItem(Eh.Iri,"true")}catch(y){w.ULS.sendTraceTag(17961859,1303,10,this.kT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}OGl(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=
this.R4;3===r.AFrameworkApplication.ta.Pb.$n?b.applicationName=Eh.VJo:4===r.AFrameworkApplication.ta.Pb.$n&&(b.applicationName=Eh.nan);b.applicationVersion=r.AFrameworkApplication.buildVersion;var h=zl.a.sg(r.AFrameworkApplication.lcid);h=h?h.name:null;b.market=PG(h);b.uiLanguage=h;b.sessionId=r.AFrameworkApplication.userSessionId;b.parentalControl=Eh.APf;b.clientType="user";b.legalAgreed=this.YHl();b.defaultDefineTab=1===this.GGg?"true":null;return b}kT(b,...h){const u={};this.R4&&(u[Eh.khj]=this.R4);
this.Bad&&(u[Eh.Gko]=this.Bad);u[Eh.lhj]=String.format.apply(null,[b].concat(h));return z.c(u)}b6b(){return 5}YHl(){try{const b=localStorage.getItem(Eh.Iri);return!!b&&"true"===b}catch(b){return w.ULS.sendTraceTag(17961860,1303,10,this.kT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}ylb(b){b=z.c(b);this.uA.contentWindow.postMessage(b,Fa.a.getOrigin(this.krc))}}LE.vBi="about:blank";Object(m.a)(LE,"InsightsPane",IE,[]);class wL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(m.a)(wL,
"SmartLookupTaskPaneProps",null,[]);class xL{}Object(m.a)(xL,"ActionDescriptor",null,[]);class yL extends IE{constructor(b,h,u,y=null,P=null,aa=null,ta=!0,Pa=null,vb=null){super(h,u,y,P,aa,ta,Pa,vb);this.WNe=!!r.AFrameworkApplication.ta&&!!r.AFrameworkApplication.ta.Pb&&r.AFrameworkApplication.ta.Pb.Oyf;this.Ku=this.MIe=!1;this.GUj=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.EUj=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.JUj=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.IUj=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ta||sm.lB("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.Zza=b;this.bOg=QG(this.Ywb)}get isVisible(){return this.Ku}MLb(b,h){this.MC=b;this.HJa=b=Object.assign(new GE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength});this.Jsc=!b.mentionLength;this.R4=h;this.J1c(!1)}fWd(b){this.MC=b;this.ihc(Object.assign(new GE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}wO(b,h){this.R4=h;this.ihc(b,!0)}W5f(b,h,u){this.MC=b;this.wO(Object.assign(new GE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,u)}Tma(){this.kca();this.Zza.hideTaskPane()}ihc(b,
h){ui.SessionStatusManager.instance.XI&&this.rda?(this.HJa=b,this.Jsc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?r.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.Zza.updateTaskPane(null),h&&this.JTn()):(h&&this.J1c(!1),this.MIe=!this.MIe,this.Zza.updateTaskPane(this.Pz())):(h&&this.J1c(this.isVisible),this.Zza.showTaskPane(this.Pz())),this.Ofc(b)):(this.Zza.showTaskPane(this.Pz()),sm.hTn(ui.SessionStatusManager.instance.XI,!!this.rda,this.MC?
LD[this.MC.entryPoint]:"",this.dbb.mMc(),r.AFrameworkApplication.LUe,this.Jsc))}JTn(){if(!this.MC){const b=Object.assign(new Vx.a,{neighborhood:this.HJa.neighborhood,mentionStart:this.HJa.mentionStart,mentionLength:this.HJa.mentionLength});this.MC=Object.assign(new ju.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.J1c(this.isVisible)}pTn(){const b=new xL;b.transactionId=this.R4;b.actionType=15;b.channelId=Eh.channelId;this.ylb(b)}Hkb(b){const h=b.rawEvent;document.getElementById(Eh.nB)&&
h.source!==document.getElementById(Eh.nB).contentWindow||this.ftn(b)}ftn(b){const h=b.rawEvent;let u;try{u=z.b(h.data)}catch(y){w.ULS.sendTraceTag(545604257,1303,15,this.kT("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(u.actionType){case 32:r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Hc.a.wDb()>=this.GUj?this.Zza.updateTaskPane(this.v5e(this.EUj)):Hc.a.wDb()>=this.JUj&&this.Zza.updateTaskPane(this.v5e(this.IUj)));
break;case 33:r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.Zza.updateTaskPane(this.v5e(u.data));break;case 42:this.Zza.updateTaskPane(this.GXk(u.data));break;case 43:this.Zza.updateTaskPane(this.Pz());break;default:super.Hkb(b)}}dispose(){}initialize(){this.qZ();this.Wha()}qZ(){this.Zza.xFc()}Wha(){const b=this.Vb.le(Eh.nB);b.parent=xe.AFrame.Hp;b.BK=!0}MXn(){this.Vb.Dg(Eh.nB)}kca(){this.i2a()&&this.Vb.Dg(this.Vb.QS)}rWf(){$addHandler(window,
"message",Object(v.a)(this,this.Hkb,"onIFrameMessage"))}Mbg(){$removeHandler(window,"message",Object(v.a)(this,this.Hkb,"onIFrameMessage"))}i2a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Eh.nB}ylb(b){b=z.c(b);document.getElementById(Eh.nB)&&document.getElementById(Eh.nB).contentWindow.postMessage(b,Fa.a.getOrigin(this.bOg))}kT(b,...h){const u={};this.R4&&(u[Eh.khj]=this.R4);u[Eh.lhj]=String.format.apply(null,[b].concat(h));return z.c(u)}b6b(){return fh.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}KHi(){if(this.rda)this.rda.onPaneThemeChanged(this.b6b());return fh.a("getTheme")?appChrome.api.getTheme():null}Nfc(){}hae(){document.getElementById(Eh.nB)&&ub.FocusManager.wJ(document.getElementById(Eh.nB).contentWindow)}Gkb(){sm.lB("ReactSmartLookupPane - Iframe component failed to load.",10)}Mbc(){r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||sm.lB("ReactSmartLookupPane - Onload detected no network.",
50)}syl(){let b;if(!this.MC)return"";10===this.MC.entryPoint?b=2===r.AFrameworkApplication.ta.Pb.$n?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.MC.entryPoint?b=CommonUIStrings.l_FindInDocumentPaneTitle:(b=CommonUIStrings.L_CoPilotPaneTitle,!this.MC.launchData||""===this.MC.launchData.landingTab||"ActionAI"!==this.MC.launchData.landingTab&&"Copilot"!==this.MC.launchData.landingTab||(b=CommonUIStrings.l_CoPilotPreviewPaneTitle));return b}Pz(){var b=CommonUIStrings.L_SmartLookupPaneTitle;
r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCoPilotPaneTitle",!1)&&(b=this.syl());const h=new wL;h.src=this.bOg;h.id=Eh.nB;h.refreshPane=this.MIe;h.onError=Object(v.a)(this,this.Gkb,"onIFrameError");h.onLoad=Object(v.a)(this,this.Mbc,"onIFrameLoad");h.title=b;ui.SessionStatusManager.instance.XI?this.rda||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=
0);b=Object.assign(new An.a,{title:b,hideHeader:!1,width:Eh.width,location:Eh.tdn,contentProps:h,isModernPane:!0,onOpen:()=>{this.MXn();this.Ku=!0;this.rWf();fh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(v.a)(this,this.KHi,"onThemeIdChanged"));r.AFrameworkApplication.ta.updateCommandUI();if(this.rda)this.rda.onPaneStateChanged(!0)},onClose:()=>{this.pTn();this.kca();this.Ku=!1;this.Mbg();fh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(v.a)(this,
this.KHi,"onThemeIdChanged"));r.AFrameworkApplication.ta.updateCommandUI();if(this.rda)this.rda.onPaneStateChanged(!1)}});this.WNe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}GXk(b){const h=this.Pz();h.title=b;h.contentProps.title=b;return h}v5e(b){const h=this.Pz();h.resizeWidth=b;return h}}Object(m.a)(yL,"ReactSmartLookupPane",IE,[]);class zL{xFc(){const b=new Ro.CuiHelper(Yl.a.lYa,WordEditorIntl.WordEditorStrings);return Ed.a.instance.sBh(Eh.nB,Eh.Icc,Eh.width,Eh.B9f,
b)}showTaskPane(b){Ed.a.instance.showTaskPane(b)}hideTaskPane(b){Ed.a.instance.hideTaskPane(b)}u2b(b){Ed.a.instance.u2b(Eh.nB,b)}}Object(m.a)(zL,"WordInsightsPaneHandler",null,[250]);class AL{xFc(){Ed.a.instance.yMa()}showTaskPane(b){Vj.UISurfaces.wu().then(h=>{h.showTaskPane(Eh.nB,b);return null})}updateTaskPane(b=null){Vj.UISurfaces.wu().then(h=>{h.setSelectedTaskPane(Eh.nB);b&&h.updateTaskPane(Eh.nB,b);return null})}hideTaskPane(){Vj.UISurfaces.wu().then(b=>{b.hideTaskPane(Eh.nB,2);return null})}}
Object(m.a)(AL,"WordReactSmartLookupPaneHandler",null,[182]);class BL extends OD{constructor(b,h){super();this.Vw=b;this.ib=h}IBd(){const b=!!r.AFrameworkApplication.ta&&!!r.AFrameworkApplication.ta.Pb&&r.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pb&&r.AFrameworkApplication.ta.Pb.Nxf?new yL(new AL,go.a.instance,ub.FocusManager.instance(),Ja.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ja.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Ja.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ja.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ja.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new LE(new zL,go.a.instance,ub.FocusManager.instance(),Ja.a.instance.resolve("Common.Utils.IAriaNotifier"),Ja.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ja.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ja.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Ja.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ja.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}BCb(){return this.Vw.getSelectedText()}aZh(){if(!this.ib||!this.ib.hb||1>this.ib.hb.length)return null;var b=this.ib.hb.kb.Qa;b=null==b?null:Wi.FormattingReader.zr(b);return(b=null==b?null:zl.a.sg(Wi.FormattingReader.language(b)))?b.name:""}W_a(){return this.Vw.pmf()}cZh(){return this.Vw.pmf()}jki(){return this.Vw.Bmm()}}Object(m.a)(BL,"WordInsightsManager",
OD,[]);var eN=c(172);class CL{}Object(m.a)(CL,"CommandMetadataResponse",null,[]);class UC{constructor(){this.Xqf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){eN.PrivacyDialogManager.ece()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new CL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const u=appChrome.selectors.getControlIconSet(b.commandId),y=Array(2);y[0]=u["default"];y[1]=u.icon32;h.svgData=this.getCommandIconSvg(y)}catch(u){return null}return h}getCommandIconSvg(b){if(!this.Xqf)return"";
for(let h=0;h<b.length;h++){const u=b[h];if(u in this.Xqf)return this.Xqf[u]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const u={};u.featureArea=UC.rgl;h.telemetryGroup=u;h.appData=b;return h}}UC.mai="FA000000012";UC.queryPrefix="AssetID=";UC.rgl="SearchPane";Object(m.a)(UC,"BaseSerpletExecutor",null,[252,163]);
class DL extends UC{constructor(b,h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Ub(Oa.a.MGb,2,null);break;case 1:this.ga.Ub(Rc.a.ZMb,2,null);break;case 2:this.ga.Ub(Oa.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Ub(Wa.a.DRd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Ub(Wa.a.Afc,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Ub(Wa.a.adf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};ZG(this.ib);this.ga.Ub(Wa.a.adf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Ub(Wa.a.findInDocument,2,h)}openNavigationPane(){this.ga.Ub(Rc.a.dhc,2,null)}openSerpletTaskPane(){this.ga.Ub(Wa.a.Yfi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Ub(Wa.a.wRd,2,null)}getAllIcons(){const b=
{};for(const u of Object.keys(window))if(u.startsWith("word")){var h=window[u];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(y=>b[y.id]=JSON.stringify(y)))}return b}}Object(m.a)(DL,"WordSerpletExecutor",UC,[]);class EL extends SG{constructor(){super();this.fGe=null;this.rx=()=>{r.AFrameworkApplication.XZ&&(this.W8k(),Fk.a.nm().then(()=>this.fGe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){r.AFrameworkApplication.XZ&&(this.fGe.Pa("WordEditor.Insights.WordInsightsActor").Wb(),
r.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&r.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?r.AFrameworkApplication.K.lp(this.rx):super.init())}xc(b){super.xc(b);this.fGe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new zq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new rL(r.AFrameworkApplication.ya)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new DL(r.AFrameworkApplication.ya,Hh.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new SC(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"),b.resolve("Box4.Search.IFindManagerHelper"),VK.a.instance,Zd.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",
()=>{const h=new Iy(new Zf.a(()=>Ra.App.xa?Ra.App.xa.jb.Yc:null),b.resolve("Box4.IParagraphReader"),gL.a.instance,r.AFrameworkApplication.K,Zd.a.instance,VK.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),r.AFrameworkApplication.ya,Hh.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new pL(new Zf.a(()=>Ra.App.xa?Ra.App.xa.jb.Yc:null),b.resolve("Box4.IParagraphReader"),ab.InteractiveViewManager.instance,Hh.a.instance,b.resolve("Box4.ISelectionFactory"),
h,Ra.App.kk.sl.Xe(12),new Zf.a(()=>Ra.App.xa.jb),ub.FocusManager.instance(),r.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Za("WordEditor.Insights.IAugloopSearchProviderManager"),b.Za("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordInsightsManager",()=>new BL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();
b.ha("WordEditor.Insights.WordInsightsActor",()=>new sL(b.af("Common.App.Insights.IInsightsManager"),r.AFrameworkApplication.ya,r.AFrameworkApplication.K,b.Za("WordEditor.Insights.IAugloopSearchProviderManager"))).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new qL(b.Za("WordEditor.Extension.DocumentProperties"))).singleInstance()}}Object(m.a)(EL,"WordInsightsPackage",SG,[]);class fN{}Object(m.a)(fN,"ScalingStep",null,[]);class FL{constructor(b,h,u){this.Trc=!1;this.PO=null;
this.Eyc=this.OTb=!1;this.UWa=[];this.T8d=y=>{this.w9&&this.w9!==y&&appChrome.api.dispatch(this.K3h(!1))};h.execute(y=>{this.PO=y});b.DA(Object(v.a)(this,this.$8m,"onProcessSetSelectionFinished"));this.Zq=u}K5b(b,h,u){const y=[];for(const P of b)y.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:P},u));return y}f2h(b){const h=[];for(let u=0;4>u;u++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>u?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",
{type:"GalleryToFlyout",controlId:b},void 0));return h}K3h(b){const h=[];if(b)switch(this.w9){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.f2h("PictureStyles"));h.push(...this.K5b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.UWa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.K5b(b,"MoveToOverflow"));break;case "Table":this.Eyc||
h.push(...this.f2h("TableStyles"));h.push(...this.K5b(this.UWa,"DropLabel",this.Eyc?0:void 0));b=this.UWa.slice().reverse();h.push(...this.K5b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.K5b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.UWa.slice().reverse(),h.push(...this.K5b(b,"MoveToOverflow"))}else for(const u of this.UWa)h.push(appChrome.actions.removeControlScalingStepsFromTab(u,"Home"));return h}Y6c(b){const h={};for(const u of b)try{h[u]=appChrome.selectors.getModelType(u)}catch(y){this.rH("Error",
"GetModelType failed for "+u)}Ra.App.xa.aId(h)}Zuo(b){if(0!==b.length){var h=[],u={},y=!1;for(const P of b)try{if(appChrome.selectors.isControlDefined(P))u[P]=appChrome.selectors.getModelType(P);else{y=!0;break}}catch(aa){this.rH("Error","GetModelType failed for "+P);y=!0;break}if(y)this.w9=void 0,this.ohe(!1);else{if("Image"===this.w9&&!this.OTb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.OTb=!0;else if(this.OTb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));y=
appChrome.selectors.getVisibleControlsInGroup("Font");for(const P of y)u[P]=appChrome.selectors.getModelType(P);this.OTb=!1}Ra.App.xa.aId(u);this.UWa=b;u=[];for(const P of b)appChrome.selectors.isControlDisabled(P)&&u.push(P);0<u.length&&this.rH("Disabled",u.join(","));0<this.UWa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.UWa)),h.push(...this.K3h(!0)),this.Trc=!0);appChrome.api.dispatch(h)}}}ohe(b){if(b||
this.Trc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.Trc=b;if("Image"===this.w9||this.OTb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const u=appChrome.selectors.getVisibleControlsInGroup("Font");this.Y6c(u)}this.OTb=!b}appChrome.api.dispatch(h)}}RSa(){this.Trc&&this.Zq&&this.Zq.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}$8m(b,h){!r.AFrameworkApplication.ta.Pb.Rgc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.PO&&h.Ll&&h.Ll.kb&&0!==h.Ll.length?(b=()=>{let u=[],y=!1;var P=this.PO.contentType,aa=appChrome.selectors.getActiveContextualTabIds();P.includes("Image")?(this.T8d("Image"),this.w9&&"Image"===this.w9?y=!0:(u="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.w9="Image")):P.includes("Table")&&0<=aa.indexOf("Table")?(P=!(Zq.a.instance.kb.xEa||Zq.a.instance.kb.Lw||
Zq.a.instance.kb.hGb),(aa="Table"===this.w9&&P!==this.Eyc)?this.T8d("TableCellEdit"):this.T8d("Table"),!this.w9||"Table"!==this.w9||aa?(P?(u=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.Eyc=!0):(u="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.Eyc=!1),this.w9="Table"):y=!0):
P.includes("Hyperlink")&&(this.T8d("Hyperlink"),this.w9&&"Hyperlink"===this.w9?y=!0:(u=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.w9="Hyperlink"));y?this.Trc||(this.Y6c(this.UWa),this.ohe(!0),this.RSa()):0<u.length?(this.Zuo(u),this.RSa()):this.ohe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.ohe(!1)}rH(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new tm.a;h.name="Events";
h.dataFields=Pj.a.mE(b);h.durationMs=window.performance.now();ha.a.lGa(h,"TellMeWAC.")}}Object(m.a)(FL,"AdaptiveTabGroupUpdater",null,[]);class GL{constructor(){this.W=null;this.I0m=()=>{r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new FL(this.W.resolve("Box4.ISelectionManager"),this.W.Za("Common.IActionContextProvider"),this.W.Za("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}xc(b){this.W=b}init(){xk(1,this.I0m)}dispose(){}}Object(m.a)(GL,"PackageManager",null,[1,2]);const gN=(b,h,u)=>1===u?32:2===u?(c.e(5).then(c.bind(null,1971)).then(y=>{y.createAndShowDevToolsMenu()}),32):2;class $G{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))r.AFrameworkApplication.ya.pa(Rc.a.x5f,le.a.frame,gN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(5).then(c.bind(null,1971))}dispose(){}xc(){}static main(){K.a.instance.Kc(new $G)}}Object(m.a)($G,"WordDevToolsPackage",null,[1,2]);c(581);class aH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(m.a)(aH,"FormattingData",null,[]);class HL extends aH{constructor(){super();this.hyperlinkData=null}}Object(m.a)(HL,"RichContentCommandData",
aH,[]);class Li{constructor(){Li.$i.add(Rc.a.W5a);Li.$i.add(Rc.a.rNb);Li.$i.add(Rc.a.dic);Li.$i.add(Rc.a.iY);Li.$i.add(Rc.a.EIf);Li.$i.add(Rc.a.QRf);Li.$i.add(Rc.a.deleteComment);Li.$i.add(Rc.a.dGc);Li.$i.add(Rc.a.s7e);Li.$i.add(Rc.a.wce);Li.$i.add(Rc.a.i6a);Li.$i.add(Rc.a.x5f);Li.$i.add(Rc.a.ZMb);Li.$i.add(Rc.a.D5f);Li.$i.add(Rc.a.dHc);Li.$i.add(Rc.a.oEd);Li.$i.add(Oa.a.digitalPrintToSway);Li.$i.add(Oa.a.openInClient);Li.$i.add(Oa.a.print);Li.$i.add(Oa.a.y5d);Li.$i.add(Oa.a.jUf);Li.$i.add(Oa.a.yKb);
Li.$i.add(Oa.a.MGb);Li.$i.add(Wa.a.Eij);Li.$i.add(Wa.a.tellMe);Li.$i.add(Wa.a.x5c);Li.$i.add(Wa.a.Afc);Li.$i.add(Wa.a.giveFeedback);Li.$i.add(Wa.a.M3c);Li.$i.add(Wa.a.q5f);Li.$i.add(Wa.a.bfg);Li.$i.add(Wa.a.qua);Li.$i.add(Wa.a.newComment);Li.$i.add(Wa.a.b1e);Li.$i.add(Wa.a.FPa);Li.$i.add(Wa.a.NYf);Li.$i.add(Wa.a.MYf);Li.$i.add(Wa.a.OYf);Li.$i.add(Wa.a.FDd);Li.$i.add(Wa.a.Jka);Li.$i.add(Wa.a.Lce);Li.$i.add(Wa.a.Vaj);Li.$i.add(Wa.a.close);Li.$i.add(Wa.a.r6d);Li.$i.add(Wa.a.G5d);Li.$i.add(Wa.a.M2d);
Li.$i.add(Wa.a.Fce);Li.$i.add(Wa.a.Kce);Li.$i.add(Wa.a.LJb);Li.$i.add(Wa.a.renameFile);Li.$i.add(Wa.a.w7b);Li.$i.add(Wa.a.c6f);Li.$i.add(Wa.a.mhc);Li.$i.add(Wa.a.downloadACopy);Li.$i.add(Wa.a.wfc);Li.$i.add(Wa.a.D4d);Li.$i.add(Wa.a.rKb);Li.$i.add(Wa.a.aQi);Li.$i.add(Wa.a.Rth);Li.$i.add(Wa.a.uzd);Li.$i.add(Wa.a.a1e);Li.$i.add(Wa.a.Tth);Li.$i.add(Wa.a.Sth);Li.$i.add(Wa.a.b1e);Li.$i.add(Wa.a.vzd);Li.$i.add(Rc.a.vje);Li.$i.add(Rc.a.Wfg);Li.$i.add(Rc.a.zoomToPageWidth);Li.$i.add(Rc.a.B0f);Li.$i.add(Rc.a.Hlb);
Li.$i.add(Rc.a.M6d);Li.$i.add(Rc.a.Dia);Li.$i.add(Wa.a.Ghb);Li.$i.add(Wa.a.jeb);Li.$i.add(Wa.a.rhc);Li.$i.add(Wa.a.Fuj);Li.$i.add(Wa.a.hQi);Li.$i.add(Oa.a.wJb);Li.$i.add(Oa.a.$ga)}}Li.$i=new Set;Object(m.a)(Li,"CommentRibbonCommands",null,[]);class IL{constructor(b,h,u,y,P){this.RAi=b;this.xi=h;this.gp=u;this.$e=y;this.Tlo=P;this.wWb=null;this.Eya=new Fh.a(0);this.Ypb=new Fh.a(0);this.Gne=new Fh.a(0);this.TPe=!1;this.Scm();this.bBn()}Dlm(b){return this.wWb&&this.gp.Wy?!Li.$i.has(b):!1}fNc(b,h,u){if(b===
Wa.a.Ag)return 32;if(!this.Eya.ub(b)&&!this.Ypb.ub(b)||!this.wWb)return 2;const y=this.Ypb.ub(b);var P=y?this.Ypb.J(b):this.Eya.J(b);const aa=y?2:this.Gne.J(u);y||1!==aa||(this.Zom(Ra.App.xa.qp.currentScope.name)||Ra.App.xa.qp.Dg(this.xi.vn?xe.AFrame.sr:xe.AFrame.QL),Ra.App.xa.updateCommandUI(!0));u=new HL;switch(P){case 1:u.highlight={color:this.I2h(h.Color)};break;case 6:u.fontColor={color:this.I2h(h.Color)}}P=this.wWb.executeCommand(P,aa,u);2===P&&y&&(b===Oa.a.Cdc?h[ag.a.On]=!!u.bold:b===Oa.a.Idc?
h[ag.a.On]=!!u.italic:b===Oa.a.Udc?h[ag.a.On]=!!u.underline:b===Oa.a.Odc?h[ag.a.On]=!!u.strikethrough:b===Oa.a.bY?h[ag.a.On]=!!u.highlight:b===Oa.a.Us&&(h[ag.a.On]=!!u.fontColor));return 2===P?32:1===P?2:8}iyn(b){this.wWb=b;this.wWb.registerSelectionChangeHandler(()=>{this.TPe||(this.TPe=!0,Ra.App.xa.updateCommandUI(!0),this.TPe=!1)});this.wWb.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case fb.a.LPb:case fb.a.G9c:case fb.a.Vke:case fb.a.yTa:Ra.App.xa.updateCommandUI(!0)}h.key!==fb.a.sB&&
h.key!==fb.a.z0||Ra.App.xa.updateCommandUI(!0)})}bBn(){this.RAi.MTi(xe.AFrame.sr,this);this.RAi.MTi(xe.AFrame.QL,this)}Scm(){this.Eya.Z(Oa.a.bold,0);this.Eya.Z(Oa.a.setItalic,3);this.Eya.Z(Oa.a.strikethrough,4);this.Eya.Z(Oa.a.underline,5);this.Eya.Z(Oa.a.bY,1);this.Eya.Z(Oa.a.dta,1);this.Eya.Z(Oa.a.Us,6);this.Eya.Z(Oa.a.u2,6);this.Eya.Z(Oa.a.Nha,6);this.Ypb.Z(Oa.a.Cdc,0);this.Ypb.Z(Oa.a.Idc,3);this.Ypb.Z(Oa.a.Odc,4);this.Ypb.Z(Oa.a.Udc,5);this.Gne.Z(1,0);this.Gne.Z(2,1)}Zom(b){return b===xe.AFrame.sr||
b===xe.AFrame.QL}I2h(b){return b?rn.a.jE(this.Tlo.GBa(this.$e.jd,b)):""}}Object(m.a)(IL,"CommentRibbonCommandHandler",null,[138,139]);class bH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").RUf?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").tha("OnCommentRenderedOnce",()=>
{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}xc(b){this.W=b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new IL(this.W.Pa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),vk.App.Fn.jb.wc,Wj.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new Li).singleInstance()}static main(){K.a.instance.Kc(new bH)}}
Object(m.a)(bH,"PackageManager",null,[1,2]);var hN=c(1874);class ME{constructor(b,h){this.$_k=2E3;this.qbh=null;this.nPf=b.sKi;this.maxLength=r.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.$_k);h&&h.execute(u=>{this.qbh=u})}Jgf(b){b=this.dvl(b,this.maxLength);return{semantic:Wp.ObjectSemantic.CanvasContext,type:Wp.ObjectSchemaType.WordCanvasContext,value:b}}dvl(b,h){try{return this.cvl(b,h)}catch(u){return w.ULS.sendTraceTag(522725067,1303,15,
"Error processing selection for Canvas Context: {0}",u),null}}yTl(b,h){const u={WZa:[],lwa:0,selection:{start:null,end:null},cursor:null,tiles:[]},y=b.length;for(let aa=0;aa<y;aa++){const ta=b.J(aa);var P=ta.node;if(!be.ParagraphReader.ic(P)||Array.contains(u.WZa,P.Bn))continue;u.WZa.push(P.Bn);const Pa=be.ParagraphReader.textLength(P);if(u.lwa+Pa>h)break;P=this.nPf.szb(P);u.tiles.push(P);u.lwa+=Pa;1!==y||u.cursor||(u.cursor=ME.uzl(ta,u.tiles.length-1));null===u.selection.start&&0===aa&&(u.selection.start=
this.i6h(ta,!0,u.tiles.length-1));null===u.selection.end&&aa===y-1&&(u.selection.end=this.i6h(ta,!1,u.tiles.length-1))}return u}MKl(b,h,u){const y={L5c:[],eij:[],lwa:0};var P=b.J(0).node;let aa=b.J(b.length-1).node;for(b=h;0<b&&(P||aa);){var ta=ME.EOi(P,!0,b,u);if(P=ta.node)P=this.nPf.szb(P),y.L5c.push(P),b-=ta.lwa,P=ta.node,u=ta.WZa;ta=ME.EOi(aa,!1,b,u);if(aa=ta.node)u=this.nPf.szb(aa),y.eij.push(u),b-=ta.lwa,aa=ta.node,u=ta.WZa}y.lwa=h-b;return y}evl(b,h){let u=0;var y=this.yTl(b,h);const P={tiles:y.tiles,
selection:y.selection,cursor:y.cursor};u+=y.lwa;y=y.WZa;u<h&&(b=this.MKl(b,h-u,y),P.tiles.unshift.apply(P.tiles,b.L5c),P.tiles.push.apply(P.tiles,b.eij),P.selection.start&&(P.selection.start.index+=b.L5c.length),P.selection.end&&(P.selection.end.index+=b.L5c.length),P.cursor&&(P.cursor.index+=b.L5c.length));return P}cvl(b,h){var u;if(!b)return null;b=this.evl(b,h);return{contentType:null===(u=this.qbh)||void 0===u?void 0:u.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}i6h(b,
h,u){if(b.contextId===oc.a.Fd||b.contextId===oc.a.paragraph||b.contextId===oc.a.Vc){if(h&&-1!==b.xk)return{index:u,offset:b.xk};if(!h&&-1!==b.$q)return{index:u,offset:b.$q}}return null}static uzl(b,h){return b.contextId===oc.a.Vc?{index:h,offset:b.xk}:null}static EOi(b,h,u,y){y={node:null,lwa:0,WZa:y};if(!b||0>=u||!y.WZa)return y;do y.node=be.ParagraphReader.Tg(b,h,!1,!1),y.lwa=y.node?be.ParagraphReader.textLength(y.node):0,b=y.node;while(y.node&&(Array.contains(y.WZa,y.node.Bn)||!be.ParagraphReader.ic(y.node)||
!y.lwa));y.node&&(y.lwa>u?y.node=null:y.WZa.push(y.node.Bn));return y}}Object(m.a)(ME,"Box4CanvasContextProvider",null,[136]);class cH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}xc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new ME(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Za("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){K.a.instance.Kc(new cH)}}Object(m.a)(cH,"Box4CanvasContextPackage",
null,[1,2]);class JL{constructor(b,h){this.$D=null;this.yy={};this.epd=0;this.Gb=b;this.nf=h;this.SQe=new Map;this.TQe=new Map;this.AYb=new Map}start(){0!=this.AYb.size&&(this.$D=new sc.a(3,2,3E4,this.HOn.bind(this),216),this.Gb.Xb(this.$D))}stop(){this.$D&&this.Gb.Se(this.$D)}Pck(b,h){this.SQe.set(b,h)}Qck(b,h){this.TQe.set(b,h)}HOn(){if(0!=this.AYb.size)if(this.nf.zo)w.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var b=50;this.yy.ScanTime=Date.now();this.yy.NumWatchDogs=
this.AYb.size;this.yy.WatchDogManagerScanNumber=++this.epd;this.AYb.forEach((h,u)=>{this.yy[u]={["WatchDogStatus"]:h.zVm()};h.fzm()||(b=15)});w.ULS.sendTraceTag(520974674,306,b,JSON.stringify(this.yy))}}wLn(){this.hNi(this.SQe);this.qGb&&this.hNi(this.TQe)}get Pik(){return this.SQe.size+this.TQe.size===this.AYb.size}hNi(b){b.forEach((h,u)=>{h.execute(y=>{y?(this.AYb.set(u,y),this.$D||this.start()):w.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",u)})})}get qGb(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WaitForRealEditEnabledForRADS",
!1)}}Object(m.a)(JL,"WatchDogManager",null,[22]);class dH{constructor(){this.W=this.xXa=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.wPa&&(this.xXa=this.W.resolve(this.name),this.Pem())}dispose(){this.xXa&&this.xXa.stop()}xc(b){this.wPa&&(this.W=b,b.ha(this.name,this.oYk.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance())}static main(){K.a.instance.Kc(new dH)}UEo(){if(!this.xXa.Pik){const b=[];let h=0;this.Yod.forEach((u,y)=>{u&&(this.W.Pa(y)||(b[h++]=
y))});0<b.length&&w.ULS.sendTraceTag(512550819,306,10,"{0} did not resolve",b)}}oYk(){return new JL(r.AFrameworkApplication.uc,this.W.resolve("Common.ISessionStatus")||ui.SessionStatusManager.instance)}Gdk(){const b=new sc.a(1,1,12E4,this.UEo.bind(this),216);r.AFrameworkApplication.uc.Xb(b)}Mdk(){this.Yod=new Map;this.Zod=new Map;this.Zod.set("WordEditor.RunawayDataLossMonitorWatchDog",(Ra.App.Lm||Ra.App.Fs)&&this.A9b);this.Zod.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",this.KTd)}Pem(){this.Mdk();
this.qGb?this.neh(this.Zod,this.xXa.Qck.bind(this.xXa)):this.Yod=new Map([...this.Yod,...this.Zod]);this.neh(this.Yod,this.xXa.Pck.bind(this.xXa));this.xXa.wLn();this.Gdk()}neh(b,h){b.forEach((u,y)=>{u&&h(y,this.W.Za(y))})}get wPa(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WatchDogManagerIsEnabled",!1)}get KTd(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsWatchDogEnabled",!1)}get A9b(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossWatchDogEnabled",
!1)}get qGb(){return r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WaitForRealEditEnabledForRADS",!1)}}Object(m.a)(dH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");
Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");
Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");F.main();Type.registerNamespace("Common.App.WopiIdentity");da.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Gb.main();Object(hN.a)(!1);Zb.main();xc.main();pd.main();$G.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Wc.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");lj.main();Type.registerNamespace("Common.App.WildFire");bd.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Fb.main();Type.registerNamespace("Common.App.HostNotification");zg.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Mi.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");xg.main();Type.registerNamespace("CNT");Qk.main();Type.registerNamespace("Common.App.NewAndOpen.Core");K.a.instance.Kc(new xo);Type.registerNamespace("Common.App.NewAndOpen.UX");K.a.instance.Kc(new wn);Type.registerNamespace("Common.App.OneDriveFilePickerApi");eo.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Wf.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");$b.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");mf.main();Type.registerNamespace("CADWLTR");Ba.main();Type.registerNamespace("Common.App.DirectPrint");K.a.instance.Kc(new ak);Type.registerNamespace("Common.App.SearchOAuthManager");Wl.main();Fm.main();Ce.main();Ue.main();Mf.main();Vk.main();qd.main();K.a.instance.Kc(new ni);di.main();Yg.main();
Ig.main();K.a.instance.Kc(new Hn);Type.registerNamespace("Common.App.SaveStatus");K.a.instance.Kc(new Ko);Type.registerNamespace("Common.App.EventsCacheManager");Wk.main();Type.registerNamespace("CUIB");Nc.main();Type.registerNamespace("CommandUI.TaskPane");try{K.a.instance.Kc(new zv(Ra.App.xa.jb))}catch(b){w.ULS.shipAssertTag(575930383,3016,!1,b.message)}Kr.main();Type.registerNamespace("Common.App.Insights");Qq;K.a.instance.Kc(new ok);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");Cl("Begin");K.a.instance.Kc(new Nj);try{K.a.instance.Kc(new Ee(Zh.a.get_instance(),Ra.App.xa.jb,Ra.App.xa.Pb))}catch(b){w.ULS.shipAssertTag(575930384,3016,!1,b.message)}Mr.main();K.a.instance.Kc(new $a);mp.main();Uq.main();Ys.main();Qp.main();ap.main();Ks.main();Qw.main();cz.main();K.a.instance.Kc(new iy);Qu.main();ls.main();pq.main();
Vw.main();cH.main();bH.main();K.a.instance.Kc(new aA);K.a.instance.Kc(new YA);iz.main();sy.main();$r.main();K.a.instance.Kc(new ax);K.a.instance.Kc(new Hj);Rp;Ga.main();Cy.main();E.main();wd.main();Fd;K.a.instance.Kc(new lu);K.a.instance.Kc(new Jr);oB.main();Nx.main();dD.main();K.a.instance.Kc(new mE);K.a.instance.Kc(new Az);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Ds;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");oD.main();wB.main();nC.main();oC;mG.main();uM;window.MSOJS=rC;KG.main();NG.main();K.a.instance.Kc(new EL);K.a.instance.Kc(new GL);(()=>Object(zs.__awaiter)(void 0,void 0,void 0,function*(){r.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&(yield c.e(25).then(c.bind(null,1976)).then(b=>{b.initializeOnDemandPackage()}))}))();dH.main()},1983:function(D,L,c){D=c(0);var l=c(8),e=c(1562);class a{static get pSm(){return 50}static OLd(m){if(""===
m)return"";let w=0,v="";try{const r=e.a.lCb(m);for(const z of r.ops)if(a.cG(z))w||(v+=a.VCl(z.attributes.atmention.fullName)),w+=1;else{const A=z.insert?z.insert:"";" "!==A&&0<A.length&&(w=0,v+=A)}}catch(r){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return v}static cxl(m){m=a.OLd(m);return 0<m.length&&m.split(" ").length<=a.pSm?m:null}static VCl(m){let w="";m&&(m=m.split(" "),0<m.length&&(w=m[0]));return w}static cG(m){return!!m.attributes&&
!!m.attributes.atmention}}Object(D.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(L,"a",function(){return k});class k extends a{constructor(){super()}static cCb(m,w,v=!1){if(!m)return null;m=m.text&&0<m.text.length?m.text[0]:"";w=!w||!w.Hf||""===w.Hf;return 0<m.length&&w&&!v?a.cxl(m):null}}Object(D.a)(k,"CommentSmartReplyHelpers",a,[])},713:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});var l=c(71);l.__exportStar(c(929),L);l.__exportStar(c(1191),L);l.__exportStar(c(930),L);l.__exportStar(c(1192),
L);l.__exportStar(c(1193),L);l.__exportStar(c(1194),L);D.exports.getChangeGateDictionary||Object.defineProperty(D.exports,"getChangeGateDictionary",{enumerable:!0,get:function(){return D.exports.HTh}});D.exports.getFeatureGateDictionary||Object.defineProperty(D.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return D.exports.KWh}});D.exports.makeGetTypedFeatureGate||Object.defineProperty(D.exports,"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return D.exports.lwi}});D.exports.makeTypedIsChangeGateEnabled||
Object.defineProperty(D.exports,"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return D.exports.qwi}})},857:function(D,L,c){function l(){return c(857)}function e(sb){for(var ob=[],fc=1;fc<arguments.length;fc++)ob[fc-1]=arguments[fc];return e.p6c.apply(e,Object(X.__spreadArray)([sb,void 0],ob,!1))}function a(sb){return k(sb)&&"WorkerError"===sb.name&&"object"===typeof sb.info}function k(sb){return null==sb?!1:sb instanceof Error?!0:"string"===typeof sb.name&&"string"===typeof sb.message&&
(null==sb.stack||"string"===typeof sb.stack)}function m(sb){if(k(sb))var ob=sb;else{ob=Error;var fc="(non-Error object) ".concat;a:{var Eb=typeof sb;switch(Eb){case "function":case "symbol":case "undefined":sb="<".concat(Eb,">");break a;case "object":sb=JSON.stringify(sb);break a;default:sb="".concat(sb)}}ob=ob(fc.call("(non-Error object) ",sb))}return ob}function w(sb){var ob=sb.name,fc=a(sb)?sb.Cqk:sb.message,Eb=sb.stack;a(sb)?(sb=sb.info,sb=Object(X.__assign)(Object(X.__assign)({},sb),{error:sb.error?
w(sb.error):void 0})):sb=void 0;return{name:ob,message:fc,stack:Eb,info:sb}}function v(sb){return k(sb)?{$fa:!0,value:w(sb)}:{$fa:!1,value:sb}}function r(sb){if("WorkerError"===sb.name){var ob=sb.message;var fc=sb.info;fc=Object(X.__assign)(Object(X.__assign)({},fc),{error:fc.error?r(fc.error):void 0});ob=new ua(ob,fc)}else(ob=Ha[sb.name])?ob=new ob(sb.message):(ob=Error(sb.message),ob.name=sb.name);null!=sb.stack&&(ob.stack=sb.stack);return ob}function z(sb){return sb.$fa?r(sb.value):sb.value}function A(){return"undefined"!==
typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!==typeof Worker}function G(sb){if(Ea)throw new TypeError("setConfig has already been called");Ea=sb}function H(){var sb=null!==Ea&&void 0!==Ea?Ea:{};return{createTimeout:sb.createTimeout,createMode:sb.createMode,importScriptUrls:sb.importScriptUrls?Object(X.__spreadArray)([],sb.importScriptUrls,!0):void 0,typedWorkersUrl:sb.typedWorkersUrl,typedWorkersName:sb.typedWorkersName,xrf:sb.xrf}}
function I(sb){var ob,fc;return null!==(fc=null!==(ob=null===sb||void 0===sb?void 0:sb.createTimeout)&&void 0!==ob?ob:null===Ea||void 0===Ea?void 0:Ea.createTimeout)&&void 0!==fc?fc:3E5}function K(sb){var ob,fc;sb=null!==(fc=null!==(ob=null===sb||void 0===sb?void 0:sb.createMode)&&void 0!==ob?ob:null===Ea||void 0===Ea?void 0:Ea.createMode)&&void 0!==fc?fc:"Thread";return"ThreadOrLocal"===sb?A()?"Thread":"Local":sb}function F(sb){setTimeout(function(){throw sb;})}function J(){return"undefined"!==typeof self&&
"__typed_workers_thread"in self?self:void 0}function N(sb){var ob=J();void 0!==ob?(sb={kind:1,error:v(sb)},ob.postMessage(sb)):console.warn(sb)}function O(sb){var ob;try{(null!==(ob=null===Ea||void 0===Ea?void 0:Ea.VXo)&&void 0!==ob?ob:N)(sb)}catch(fc){console.warn(sb),F(fc)}}function M(sb){var ob=J();void 0!==ob&&ob.postMessage({kind:2,stats:sb})}function T(sb){var ob;try{(null!==(ob=null===Ea||void 0===Ea?void 0:Ea.qXo)&&void 0!==ob?ob:M)(sb)}catch(fc){F(fc)}}function R(sb,ob){return sb.then(function(fc){ob();
return fc},function(fc){ob();return Promise.reject(fc)})}function W(sb,ob,fc){if(1073741824<sb)return fc;var Eb=setTimeout(ob,Math.max(0,sb));return{resolve:function(Ib){clearTimeout(Eb);fc.resolve(Ib)},reject:function(Ib){clearTimeout(Eb);fc.reject(Ib)}}}function V(){var sb=Object.create(null);sb.key=void 0;delete sb.key;return sb}function ba(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(sb){return!1}}function ha(sb,ob){var fc=V(),Eb=sa("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?
function(Ib,Nb){var pb;return"then"===Nb?void 0:null!==(pb=Ib[Nb])&&void 0!==pb?pb:Ib[Nb]=sb(Nb)}:function(Ib,Nb){var pb;return null!==(pb=Ib[Nb])&&void 0!==pb?pb:Ib[Nb]=sb(Nb)};if(!ob)return new Proxy(fc,{get:Eb});ob.forEach(function(Ib){return Eb(fc,Ib)});return fc}function ca(sb){throw sb;}function ia(){return{status:"Pending",start:Ya()}}function ra(sb,ob,fc){"Pending"===sb.status&&(sb.status=ob,sb.end=Math.max(sb.start,null!==fc&&void 0!==fc?fc:Ya()))}function da(sb,ob){function fc(Eb){ra(sb,
a(Eb)&&"Timeout"===Eb.info.rZ?"Timeout":"Error");throw Eb;}try{return ob().then(function(Eb){var Ib;return null!==(Ib=ra(sb,"Success"))&&void 0!==Ib?Ib:Eb},fc)}catch(Eb){fc(Eb)}}function za(sb,ob,fc){var Eb,Ib,Nb,pb=null!==(Eb=null===sb||void 0===sb?void 0:sb.start)&&void 0!==Eb?Eb:Infinity;Eb=pb<ob?ob:pb>fc?fc:pb;pb=null!==(Ib=null===sb||void 0===sb?void 0:sb.end)&&void 0!==Ib?Ib:Infinity;fc=pb<ob?ob:pb>fc?fc:pb;return{status:null!==(Nb=null===sb||void 0===sb?void 0:sb.status)&&void 0!==Nb?Nb:"Pending",
start:Math.round(1E3*(Eb-ob))/1E3,end:Math.round(1E3*(fc-ob))/1E3,duration:Math.round(1E3*(fc-Eb))/1E3}}function la(sb,ob,fc){fc="def"in fc?fc:e(fc);var Eb=fc.def,Ib=fc.args;return"function"!==typeof Eb?Promise.reject(new ua("Loading an InsideScript to create a local worker is unimplemented",{rZ:"InternalError",nD:{type:"Endpoint",cNb:"Inside",id:sb.options.id}})):Promise.resolve().then(function(){return da(ob.itf=ia(),function(){return Eb.apply(void 0,Object(X.__spreadArray)([{config:H(),importTypedWorkers:l,
connection:sb}],Ib,!1)).then(function(){})})})}function na(sb,ob,fc,Eb,Ib){var Nb=new MessageChannel,pb=Nb.port2,Aa;return Promise.all([Eb({port:Nb.port1,options:sb,createMode:ob}),da(fc.RBd=ia(),function(){return Qa.RBd({port:pb,options:sb,createMode:ob},function(xb){return Ib(Aa=xb)})})]).then(function(){return Aa},function(xb){Aa?Aa.close("Force"):pb.close();return Promise.reject(xb)})}function Ca(sb,ob,fc,Eb){return na(sb,"Local",ob,function(Ib){return la(Ib,ob,fc)},Eb)}function Na(sb,ob,fc,Eb){ob.aCd=
ia();try{var Ib=new Wa(sb,fc)}catch(Nb){return ra(ob.aCd,"Error"),Promise.reject(Nb)}ra(ob.aCd,"Success");return na(sb,"Thread",ob,function(Nb){return Ib.G4e(Nb,ob)},Eb).then(function(Nb){Nb.D5l()?Ib.terminate():Nb.gWj=Ib.terminate.bind(Ib);return Nb},function(Nb){Ib.terminate();return Promise.reject(Nb)})}function Ta(sb,ob,fc){void 0===fc&&(fc=function(){});var Eb=K(sb),Ib="local"in ob?"Local"===Eb?ob.local:ob.Vlo:ob,Nb="Local"===Eb?Ca:Na,pb={id:sb.id,createMode:Eb,B5e:ia()};ob=da(pb.B5e,function(){return Nb({id:sb.id,
createTimeout:sb.createTimeout,createMode:sb.createMode,importScriptUrls:sb.importScriptUrls,xrf:sb.xrf},pb,Ib,fc)});return R(ob,function(){var Aa=pb.createMode;var xb=pb.B5e,gb=pb.itf,Xa=pb.RBd,Va=pb.aCd,Gb=xb.status,Xb=xb.start;xb=xb.end;Aa="Pending"!==Gb&&void 0!==xb?{id:pb.id,createMode:Aa,B5e:{status:Gb,RPo:Xb,duration:Math.round(1E3*(xb-Xb))/1E3},aCd:"Thread"===Aa?za(Va,Xb,xb):void 0,RBd:za(Xa,Xb,xb),itf:za(gb,Xb,xb)}:void 0;Aa&&T(Aa)})}function Fa(sb,ob){if(0===ob)importScripts.apply(void 0,
sb);else for(var fc=0;fc<sb.length;fc++)a:{for(var Eb=void 0,Ib=sb[fc],Nb=ob,pb=0;pb<=Nb;pb+=1)try{Eb=importScripts;if(0<pb){var Aa=Ib,xb=String(pb),gb=Aa.indexOf("?");if(0>gb)var Xa="".concat(Aa,"?").concat("retries","=").concat(xb);else{var Va=Aa.slice(0,gb+1),Gb=Aa.slice(gb+1).split("&");for(Aa=0;Aa<Gb.length&&("="!==Gb[Aa][7]||"retries"!==Gb[Aa].slice(0,7));Aa+=1);Gb[Aa]="".concat("retries","=").concat(xb);Xa=Va+Gb.join("&")}}else Xa=Ib;Eb(Xa);break a}catch(Xb){Eb=Xb}throw Eb;}}function qa(){return"undefined"!==
typeof WorkerGlobalScope}function ja(){return self.name}c.r(L);var X=c(71),ua=function(sb){function ob(fc,Eb){var Ib=this.constructor,Nb;var pb=sb.call(this,"".concat(fc,"; info = ").concat(JSON.stringify(Object(X.__assign)(Object(X.__assign)({},Eb),{error:null===(Nb=Eb.error)||void 0===Nb?void 0:Nb.message}))))||this;pb.Cqk=fc;pb.info=Eb;pb.name="WorkerError";fc=Ib.prototype;Object.getPrototypeOf(pb)!==fc&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(pb,fc):pb.__proto__=fc);return pb}Object(X.__extends)(ob,
sb);return ob}(Error),Ha={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},Ea;e.p6c=function(sb,ob){for(var fc=[],Eb=2;Eb<arguments.length;Eb++)fc[Eb-2]=arguments[Eb];return{def:sb,args:fc,transferables:null!==ob&&void 0!==ob?ob:[]}};var wa=c(713),sa=Object(wa.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(wa.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var fa,Ma=-1,Ua=function(){function sb(ob,
fc){function Eb(){var gb;return null===(gb=pb.onClose)||void 0===gb?void 0:gb.call(pb)}var Ib,Nb,pb=this;this.nD=ob;this.port=fc;this.isClosed=!1;this.exports={};this.T6c=V();var Aa=(Ib={},Ib[0]=this.e1d.bind(this),Ib[1]=this.onResult.bind(this),Ib[2]=function(gb){var Xa;gb=gb.npl;null===(Xa=pb.X4m)||void 0===Xa?void 0:Xa.call(pb,ha(pb.fWk.bind(pb),gb),ha(pb.DRk.bind(pb),gb))},Ib[3]=Eb,Ib),xb=(Nb={},Nb[0]=this.c9m.bind(this),Nb[1]=this.$Gi.bind(this),Nb[2]=Eb,Nb[3]=Eb,Nb);this.port.onmessage=function(gb){gb=
gb.data;return Aa[gb.kind](gb)};this.port.onmessageerror=function(gb){gb=gb.data;return xb[gb.kind](gb)}}sb.prototype.oXn=function(ob){this.exports=ob;if(null!==fa&&void 0!==fa?fa:fa=ba())ob=void 0;else{for(var fc=V();null!=ob;){for(var Eb=0,Ib=Object.getOwnPropertyNames(ob);Eb<Ib.length;Eb++){var Nb=Ib[Eb];try{"function"===typeof ob[Nb]&&(fc[Nb]=!0)}catch(pb){}}ob=Object.getPrototypeOf(ob)}ob=Object.getOwnPropertyNames(fc)}this.port.postMessage({kind:2,npl:ob})};sb.prototype.close=function(){if(!this.isClosed){this.isClosed=
!0;this.port.postMessage({kind:3});this.port.close();for(var ob in this.T6c){var fc=this.T6c[ob],Eb=fc.reject;fc=fc.JZ;var Ib={rZ:"Connection",nD:this.nD,JZ:fc};fc=new ua("Importing Endpoint closed while waiting for ".concat(fc," result"),Ib);Eb(fc)}}};sb.prototype.e1d=function(ob){var fc=this,Eb=ob.yea,Ib=ob.JZ,Nb=ob.args;ob=Promise.resolve().then(function(){var pb=fc.exports[Ib];if(pb)return pb.apply(fc.exports,Nb);pb={rZ:"Connection",nD:fc.nD,yea:Eb,JZ:Ib};throw new ua("Exporting Endpoint received a ".concat(0<=
Eb?"call":"post"," to unknown function ").concat(Ib),pb);});0<=Eb?ob.then(function(pb){return fc.Z0f(Eb,Ib,!0,pb)},function(pb){return fc.Z0f(Eb,Ib,!1,pb)}):ob.catch(function(pb){pb=m(pb);pb={rZ:"UnhandledError",nD:fc.nD,error:pb,yea:Eb,JZ:Ib};O(new ua("Exporting Endpoint's ".concat(Ib," implementation threw or rejected"),pb))})};sb.prototype.Z0f=function(ob,fc,Eb,Ib){Ib=v(Ib);ob={kind:1,yea:ob,JZ:fc,rpm:Eb,HZi:Ib};try{this.port.postMessage(ob,void 0)}catch(Nb){this.$Gi(ob,m(Nb))}};sb.prototype.$Gi=
function(ob,fc){var Eb=ob.yea,Ib=ob.JZ;ob=ob.HZi;var Nb=fc?"Exporting Endpoint failed to send ".concat(Ib," result"):"Importing Endpoint failed to deserialize ".concat(Ib," result");fc=new ua(Nb,{rZ:"MessageError",nD:this.nD,error:fc,yea:Eb,JZ:Ib});ob.$fa?O(fc):this.Z0f(Eb,Ib,!1,fc)};sb.prototype.Vee=function(ob){var fc=this.T6c[ob];fc&&delete this.T6c[ob];return fc};sb.prototype.HVn=function(ob,fc,Eb,Ib){var Nb=this;return 1073741824<Eb?Ib:W(Eb,function(){var pb=Nb.Vee(ob);if(pb){var Aa={rZ:"Timeout",
nD:Nb.nD,timeout:Eb,yea:ob,JZ:fc};pb.reject(new ua("Importing Endpoint's call to ".concat(fc," timed out"),Aa))}},Ib)};sb.prototype.ESn=function(ob,fc,Eb,Ib){var Nb=this;return new Promise(function(pb,Aa){var xb=Ma+=1,gb={kind:0,yea:xb,JZ:ob,args:fc};Nb.T6c[xb]=Object(X.__assign)(Object(X.__assign)({},Nb.HVn(xb,ob,Eb,{resolve:pb,reject:Aa})),{JZ:ob});try{Nb.port.postMessage(gb,Ib)}catch(Xa){if(pb=Nb.Vee(xb))Aa=m(Xa),xb={rZ:"MessageError",nD:Nb.nD,error:Aa,yea:xb,JZ:ob},pb.reject(new ua("Importing Endpoint failed to send call to ".concat(ob),
xb))}})};sb.prototype.vTn=function(ob,fc,Eb,Ib){fc={kind:0,yea:-1,JZ:ob,args:fc};try{this.port.postMessage(fc,Ib)}catch(Nb){Ib=m(Nb),Ib={rZ:"MessageError",nD:this.nD,error:Ib,yea:-1,JZ:ob},Eb(new ua("Importing Endpoint failed to post to ".concat(ob),Ib))}};sb.prototype.c9m=function(ob){var fc,Eb=ob.yea;ob=ob.JZ;var Ib={rZ:"MessageError",nD:this.nD,yea:Eb,JZ:ob};ob=new ua("Exporting Endpoint failed to deserialize ".concat(0<=Eb?"call":"post"," to ").concat(ob),Ib);Eb=0<=Eb?this.Vee(Eb):void 0;(null!==
(fc=null===Eb||void 0===Eb?void 0:Eb.reject)&&void 0!==fc?fc:O)(ob)};sb.prototype.onResult=function(ob){var fc=ob.yea,Eb=ob.JZ,Ib=ob.rpm;ob=ob.HZi;0<=fc?(Eb=this.Vee(fc))&&(Ib?Eb.resolve:Eb.reject)(z(ob)):(Ib={rZ:"InternalError",nD:this.nD,yea:fc,JZ:Eb},O(new ua("Exporting Endpoint sent a result for a post to ".concat(Eb),Ib)))};sb.prototype.fWk=function(ob){function fc(){for(var Ib=[],Nb=0;Nb<arguments.length;Nb++)Ib[Nb]=arguments[Nb];return fc.p6c.apply(fc,Object(X.__spreadArray)([void 0],Ib,!1))}
var Eb=this;fc.p6c=function(Ib){for(var Nb,pb,Aa,xb=[],gb=1;gb<arguments.length;gb++)xb[gb-1]=arguments[gb];Eb.isClosed||(gb=null!==(Aa=null!==(Nb=fc.bGi)&&void 0!==Nb?Nb:null===(pb=Eb.lMl)||void 0===pb?void 0:pb.call(Eb))&&void 0!==Aa?Aa:ca,Eb.vTn(ob,xb,gb,Ib))};return fc};sb.prototype.DRk=function(ob){function fc(){for(var Ib=[],Nb=0;Nb<arguments.length;Nb++)Ib[Nb]=arguments[Nb];return fc.p6c.apply(fc,Object(X.__spreadArray)([void 0],Ib,!1))}var Eb=this;fc.p6c=function(Ib){for(var Nb,pb,Aa,xb=[],
gb=1;gb<arguments.length;gb++)xb[gb-1]=arguments[gb];if(Eb.isClosed)return Nb={rZ:"Connection",nD:Eb.nD,JZ:ob},Promise.reject(new ua("".concat(Eb.nD.cNb," Endpoint's call.").concat(ob," called after close"),Nb));gb=null!==(Aa=null!==(Nb=fc.zZe)&&void 0!==Nb?Nb:null===(pb=Eb.avl)||void 0===pb?void 0:pb.call(Eb))&&void 0!==Aa?Aa:Infinity;return Eb.ESn(ob,xb,gb,Ib)};fc.zZe=void 0;return fc};return sb}(),Qa=function(){function sb(ob,fc,Eb){function Ib(Nb){return function(){var pb="Outside"===ob.cNb?"inside":
"outside",Aa={rZ:"Connection",nD:ob};throw new ua("".concat(ob.cNb," Endpoint's ").concat(Nb," referenced before the ").concat(pb," Endpoint started"),Aa);}}this.zZe=Infinity;this.bGi=ca;this.Qfd=ob;this._state=fc;this.createMode=Eb;Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:Ib("post")},call:{configurable:!0,enumerable:!1,get:Ib("call")}})}sb.GFg=function(ob,fc,Eb){var Ib=fc.port,Nb=fc.options;fc=fc.createMode;var pb={type:"Endpoint",cNb:ob,id:null===Nb||void 0===Nb?void 0:
Nb.id};try{var Aa=new Ua(pb,Ib);var xb=new sb(pb,Aa,fc)}catch(gb){return Promise.reject(gb)}return(new Promise(function(gb,Xa){var Va;Aa.avl=function(){return xb.zZe};Aa.lMl=function(){return xb.bGi};Aa.X4m=function(qb,Zb){Object.defineProperties(xb,{post:{configurable:!0,enumerable:!1,writable:!1,value:qb},call:{configurable:!0,enumerable:!1,writable:!1,value:Zb}});Xb.resolve()};Aa.onClose=function(){return xb.close("Force")};var Gb=I(Nb),Xb=W(Gb,function(){var qb="Outside"===ob?"inside":"outside",
Zb={rZ:"Timeout",nD:pb,timeout:Gb};qb=new ua("".concat(ob," Endpoint timed out waiting for the ").concat(qb," to start"),Zb);Xb.reject(qb)},{resolve:gb,reject:Xa});xb.Had=function(){Xb.resolve()};try{var rc=Eb(xb)}catch(qb){return Xb.reject(qb)}null===(Va=xb._state)||void 0===Va?void 0:Va.oXn(rc)})).then(function(){xb.Had=void 0;return xb},function(gb){xb.Had=void 0;xb.close();return Promise.reject(gb)})};sb.prototype.D5l=function(){return void 0===this._state};sb.prototype.close=function(ob){var fc;
if(this._state){if(this.Had)if("Force"===ob)this.Had();else{var Eb={rZ:"Connection",nD:this.Qfd};throw new ua("".concat(this.Qfd.cNb," Endpoint's close called during creation"),Eb);}ob=this._state;this._state=void 0;try{ob.close(),null===(Eb=this.gWj)||void 0===Eb?void 0:Eb.call(this),null===(fc=this.onClose)||void 0===fc?void 0:fc.call(this)}catch(Ib){Eb={rZ:"Connection",nD:this.Qfd,error:m(Ib)},O(new ua("".concat(this.Qfd.cNb," Endpoint's close threw an error"),Eb))}}};sb.RBd=function(ob,fc){void 0===
fc&&(fc=function(){});return sb.GFg("Outside",ob,fc)};sb.G4e=function(ob,fc){return sb.GFg("Inside",ob,fc)};return sb}(),Ja=-1,Wa=function(){function sb(ob,fc){var Eb;try{var Ib=void 0;var Nb="def"in fc?fc:e(fc),pb=Nb.def,Aa=Nb.args,xb=Nb.transferables;if("function"!==typeof pb)var gb=[pb,Aa,xb,void 0];else{var Xa="__generatedInsideInit".concat(Ja+=1),Va="var ".concat(Xa," = ").concat(pb.toString(),";");gb=[{scriptUrl:void 0,insideInitName:Xa},Aa,xb,Va]}this.script=gb[0];this.args=gb[1];this.transferables=
gb[2];Ib=gb[3];this.Pwd=URL.createObjectURL(new Blob(void 0===Ib?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);']:
[Ib,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'],
{type:"application/javascript"}));fc={};null!=ob.id&&(fc.name=ob.id);this.worker=new Worker(this.Pwd,fc)}catch(Gb){throw null===(Eb=this.worker)||void 0===Eb?void 0:Eb.terminate(),this.l_i(),Gb;}}sb.prototype.l_i=function(){void 0!==this.Pwd&&(URL.revokeObjectURL(this.Pwd),this.Pwd=void 0)};sb.prototype.G4e=function(ob,fc){var Eb=this,Ib=ob.port,Nb=ob.options,pb={type:"Thread",cNb:"Outside",id:Nb.id},Aa=this.worker;ob=new Promise(function(xb,gb){Eb.i1b={resolve:xb,reject:gb};xb={config:H(),port:Ib,
options:Nb,script:Eb.script,args:Eb.args,featureGateDictionary:Object(wa.getFeatureGateDictionary)(),cRo:Object(wa.getChangeGateDictionary)()};Aa.postMessage(xb,Object(X.__spreadArray)([Ib],Eb.transferables,!0));Aa.onerror=function(Xa){Xa.preventDefault();if(k(Xa.error))if(a(Xa.error))var Va=Xa.error;else Va={rZ:"UnhandledError",nD:pb,error:Xa.error},Va=new ua("".concat("worker.onerror"," received an unhandled error"),Va);else null==Xa.message?(Va={rZ:"UnhandledError",nD:pb},Va=new ua("".concat("worker.onerror",
" received a non-error (worker script fetch probably failed)"),Va)):(Va={rZ:"UnhandledError",nD:pb},Xa="".concat(Xa.message," at ").concat(Xa.filename,":").concat(Xa.lineno,":").concat(Xa.colno),Va=new ua("".concat("worker.onerror"," received an unhandled error: ").concat(Xa),Va));Eb.i1b?Eb.i1b.reject(Va):O(Va)};Aa.onmessage=function(Xa){var Va,Gb;Xa=Xa.data;switch(Xa.kind){case 0:return fc.itf=Xa.ry,void 0===Xa.error?null===(Va=Eb.i1b)||void 0===Va?void 0:Va.resolve():null===(Gb=Eb.i1b)||void 0===
Gb?void 0:Gb.reject(z(Xa.error));case 1:return O(z(Xa.error));case 2:return T(Xa.stats)}}});return R(ob,function(){return void(Eb.i1b=void 0)})};sb.prototype.terminate=function(){var ob;if(this.worker){var fc=this.worker;this.worker=void 0;null===(ob=this.i1b)||void 0===ob?void 0:ob.resolve();fc.terminate();this.l_i()}};return sb}(),Ya="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};c.d(L,"WorkerError",
function(){return ua});c.d(L,"isThreadingSupported",function(){return A});c.d(L,"setConfig",function(){return G});c.d(L,"dispatchWorkerError",function(){return O});c.d(L,"paramInsideDef",function(){return e});c.d(L,"Endpoint",function(){return Qa});c.d(L,"createWorker",function(){return Ta});c.d(L,"importScriptsWithRetry",function(){return Fa});c.d(L,"isWorkerThread",function(){return qa});c.d(L,"workerName",function(){return ja})},929:function(D,L,c){function l(){return"undefined"===typeof __get_feature_gate_dictionary_variable?
k:__get_feature_gate_dictionary_variable()}function e(m,w){var v;return null!==(v=l()[m])&&void 0!==v?v:w}Object.defineProperty(L,"__esModule",{value:!0});L.b2f=L.getIntFeatureGate=L.s0h=L.getBooleanFeatureGate=L.getStringFeatureGate=L.KWh=void 0;var a=c(1015),k={};L.KWh=l;L.getStringFeatureGate=e;L.getBooleanFeatureGate=function(m,w){var v;m=null===(v=e(m))||void 0===v?void 0:v.trim().toLowerCase();return"true"===m?!0:"false"===m?!1:w};L.s0h=function(m,w){var v;m=null===(v=e(m))||void 0===v?void 0:
v.trim().toLowerCase();if(void 0===m)return w;if("infinity"===m||"+infinity"===m)return Infinity;if("-infinity"===m)return-Infinity;v=parseFloat(m);return isNaN(v)?w:v};L.getIntFeatureGate=function(m,w){var v;m=null===(v=e(m))||void 0===v?void 0:v.trim();if(void 0===m)return w;v=parseInt(m,10);return isNaN(v)?w:v};L.b2f=function(m){var w=a.globalThis.BCj;a.globalThis.BCj=m;return w}},930:function(D,L,c){function l(){return"undefined"===typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}
Object.defineProperty(L,"__esModule",{value:!0});L.K1f=L.isChangeGateEnabled=L.HTh=void 0;var e=c(1015);L.HTh=l;L.isChangeGateEnabled=function(a){var k;return null!==(k=l()[a])&&void 0!==k?k:!0};L.K1f=function(a){var k=e.globalThis.ACj;e.globalThis.ACj=a;return k}},940:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.method=this.api=0}}Object(D.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18198024/wdjs/WordEditorDS.box4.dll1.js.map