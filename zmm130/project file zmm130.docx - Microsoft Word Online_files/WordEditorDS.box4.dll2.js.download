'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1452:function(D,L,c){D=c(0);var l=c(17),e=c(44),a=c(7),k=c(124),m=c(152),w=c(797),v=c(228),r=c(621),z=c(2),A=c(412),G=c(22),H=c(52),I=c(231),K=c(1),F=c(1519);class J{constructor(R,W){this.WKj=R;this.Qz=W}J(R){return this.WKj.Ty(R,this.Qz)}}Object(D.a)(J,"PropertyMergeStrategies",null,[]);var N=c(1582),O=c(1540);class M extends O.a{constructor(){super();this.MVc=this.mZd=this.Gn=null;this.u5d=0}get ifa(){return"Property"}pCb(){this.detail.Z("Type",
this.ifa);this.detail.Z("ComplexMerger",null!=this.Gn?this.Gn:-1);this.detail.Z("Strategy",null!=this.mZd?this.mZd:-1);this.detail.Z("ClassId",null!=this.MVc?this.MVc:-1);this.detail.Z("PropId",this.u5d);return this.detail}}Object(D.a)(M,"PropertyMergeFailureDetail",O.a,[]);c.d(L,"a",function(){return T});class T{constructor(R=null){this.s1g=this.$b=null;this.VUb=R||this.tLc()}get Gn(){return 1}get Rjb(){return this.VUb}tLc(){return[Object(H.a)(this,this.yro,"tryPreProcessFavoredRevision"),Object(H.a)(this,
this.mHk,"cloneObjectAndRemoveNeededProperties"),Object(H.a)(this,this.pro,"tryMergeNodeInternal")]}get Qz(){return 5}get w5d(){return this.s1g||(this.s1g=new J(this.qk(),this.Qz))}rB(R,W){const V=R.Sg.value.Af;m.a.instance.Sa(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",V.id,V.Rc);R.Ip.logger.Vg(Object.assign(new M,{Gn:this.Gn,MVc:V.Rc,u5d:W}));return!1}cbg(R){const W=R.Sg.value;m.a.instance.Sa(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.Af.id,W.Af.Rc);for(let V=0;V<this.Rjb.length;V++)if(!(0,this.Rjb[V])(R))return m.a.instance.Sa(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.Af.id,W.Af.Rc,V),R.Ip.logger.UXd("GraphNodeComplexMerge.GetMergeFunctions()",V),this.kJm(R),R.Sk=null,!1;m.a.instance.Sa(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",W.Af.id,W.Af.Rc);
return!0}kJm(R){R.Teg||(R.Teg=!0,N.a(R.Sg.value.Eu,"Base",1),N.a(R.Sg.value.Af,"Favored",1),N.a(R.nn.value.Af,"Conflict",1))}yro(R){const W=R.Sg.value,V=this.w5d;if(!W.qX)return!0;let ba=!0;W.Joa.forEach((ha,ca)=>{if(!ca.qX||R.xg.contains(ha))return!0;ca=V.J(ha);if(5===ca){const ia=W.Eu.Rc;m.a.instance.Sa(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ia,ha,ca);R.Ip.logger.Vg(Object.assign(new M,
{Gn:this.Gn,MVc:ia,u5d:ha,mZd:ca}));return ba=!1}6===ca&&R.fTf.add(ha);return!0});return ba}mHk(R){R.Sk=R.Sg.value.Af.aH();const W=R.fTf,V=R.Sk;W&&W.forEach(ba=>{V.removeProperty(w.a.QW(ba));return!0});return!0}pro(R){const W=R.nn.value,V=W.Eu.Rc,ba=this.w5d;let ha=!0;W.Joa.forEach((ca,ia)=>{const ra=ba.J(ca);ha=this.qro(R,ia,ca,ra);ha||(R.Sk=null,m.a.instance.Sa(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",V,ca,ra),R.Ip.logger.Vg(Object.assign(new M,
{Gn:this.Gn,MVc:V,u5d:ca,mZd:ra})));return ha});return ha}qro(R,W,V,ba){const ha=R.Sk;if(!W.qX&&8!==ba||2===ba||7===ba||R.xg.contains(V))return!0;if(5===ba)return!1;if(4===ba||3===ba){let ca;if(({value:ca}=R.Sg.value.Joa.Gc(V)).returnValue&&ca.qX)return 4!==ba;ba=0}8===ba&&(ba=0);if(0===ba){if(!W.isDeleted)return R=w.a.QW(V),(T.EEo(W,V,R)||T.m7n())&&ha.Bxa(R,W.newValue),!0;ba=6}return 6===ba?(ha.removeProperty(w.a.QW(V)),!0):1===ba?this.rB(R,V):!1}PTm(R,W,V,ba,ha,ca){R=R||new v.a;W=W||new v.a;V=V||
new v.a;var ia=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",R.length,W.length,V.length),ra=R.length<=W.length&&R.length<=V.length;this.Tki()&&ra&&m.a.instance.Sa(541181455,1,1,ia);if(!ra&&this.aji(ca.runtime.$b))return null;if(this.Tki())for(ia=0;ia<R.length;ia++){ra=R.ig(ia);var da=W.ig(ia);let za=V.ig(ia);ra=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",
ra,da,za,ia,R.length);m.a.instance.Sa(541181457,1,1,ra)}if(this.aji(ca.runtime.$b))for(ca=0;ca<R.length;ca++)if(ia=R.ig(ca),ra=W.ig(ca),da=V.ig(ca),!ba(ia,ra)||!ba(ia,da))return null;R=R.p4();ba=new r.a;ca=R.length;for(ia=ca;ia<W.length;ia++)ra=W.ig(ia),R.add(ra),ba.add(ra);for(;ca<V.length;ca++)W=V.ig(ca),ba.contains(W)?m.a.instance.Sa(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(R.add(W),ha(W));return R}Tki(){return!!z.AFrameworkApplication.K&&
z.AFrameworkApplication.K.$("LogMPALErrors")}aji(R){if(!R)return!1;R.Eof(1000008);return R.CDb(1000008)}owm(R){if(!R)return!1;R.Eof(1000009);return R.CDb(1000009)}Sxi(R,W,V,ba){return F.a(R,W,V,ba)}REa(R,W,V){R=R||new v.a;W=W||new v.a;V=V||new v.a;const ba=R.tG(),ha=W.tG(),ca=V.tG();R=T.filter(R,ia=>ha.contains(ia)&&ca.contains(ia));R.tG();R.VA(R.length,T.filter(W,ia=>!ba.contains(ia)));R.VA(R.length,T.filter(V,ia=>!ba.contains(ia)&&!ha.contains(ia)));return R}ITm(R,W){const V=w.a.QW(W),ba=R.Yd;var ha=
ba.getPropertyObjectIds(R.Sg.value.Eu,V),ca=ba.getPropertyObjectIds(R.Sg.value.Af,V);const ia=ba.getPropertyObjectIds(R.nn.value.Af,V);ha=this.REa(ha,ca,ia);ca=R.Sk;0<ha.length?ba.setPropertyObjectIds(ca,V,ha):ca.removeProperty(V);R.xg.add(W)}Pdb(R,W,V){R.hasProperty(V)?W.Bxa(V,R.cQ(V)):W.removeProperty(V)}RHn(R,W){var V=W.Aj();for(const ba of V)W.removeProperty(ba);V=R.Aj();for(const ba of V)W.Bxa(ba,R.cQ(ba))}Kzf(R,W,V,ba,ha){W=R.getPropertyInt32(W,ha);V=R.getPropertyInt32(V,ha);V=null!=W&&null!=
V?Math.max(W,V):null!=V?V:null!=W?W:null;null!=V?R.setPropertyInt32(ba,ha,V):ba.removeProperty(ha)}O_e(R,W,V,ba,ha,ca){W=R(W,ha);V=R(V,ha);R=R(ba,ha);ba=W.tG();let ia=!1;ca&&(ia=ca(W,V,R));ia?(ca=!0,ba=!1):(ca=ba.rwh(V),ba=ba.rwh(R));m.a.instance.Sa(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",w.a.zb(ha),W.Oq(),V.Oq(),R.Oq(),ca,ba);return{jEc:R,E1a:ca,w1a:ba}}gDk(R,
W,V,ba,ha){let ca;W=R(W,ha);V=R(V,ha);R=R(ba,ha);ba=this.Yni(W,V);ca=this.Yni(W,R);m.a.instance.Sa(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",w.a.zb(ha),W.Oq(),V.Oq(),R.Oq(),ba,ca);return{jEc:R,E1a:ba,w1a:ca}}Yni(R,W){if(!R&&!W)return!0;if(!R||!W)return!1;if(!R.count&&!W.count)return!0;let V=!1;W.forEach((ba,ha)=>V=R.ub(ba)&&ha==R.J(ba));return V}qk(){let R;
R=this.owm(this.$b)?T.oTj.value:T.nTj.value;const W=new A.a(0);for(let V=0;V<R.length;V++)W.Z(R[V],7);return W}static Nea(){return new T}static get instance(){return T._instance.value}static m7n(){return G.a.instance.Pa("Box4.IFeatureHelper").isFeatureEnabled(77)}static EEo(R,W,V){if(void 0!==R.newValue&&null!==R.newValue||K.a.Bli(V.type))return!0;T.yKm(R,W,V);return!1}static yKm(R,W,V){V=V.type===K.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);V||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",
R.newValue,R.oldValue));m.a.instance.Sa(19145822,1,2,W)}static LEf(R,W,V){const ba=w.a.zb(V),ha=R.Yd;var ca=ha.getPropertyObjectIds(R.Sg.value.Eu,V);const ia=ha.getPropertyObjectIds(R.Sg.value.Af,V);var ra=ha.getPropertyObjectIds(R.nn.value.Af,V);ra=T.sZl(ra,R.Ip.runtime.xhc);W=W.REa(ca,ia,ra);ca=R.Sk;0<W.length?ha.setPropertyObjectIds(ca,V,W):ca.removeProperty(V);R.xg.add(ba);return!0}static sZl(R,W){const V=new v.a;R.forEach(ba=>{W.contains(ba,(ha,ca)=>ha.equals(ca))||V.add(ba);return!0});return V}static filter(R,
W){const V=new v.a;R.forEach(ba=>{W(ba)&&V.add(ba);return!0});return V}static GFl(){return[w.a.zb(l.a.saf),w.a.zb(l.a.lastModifiedTime),w.a.zb(l.a.KK),w.a.zb(l.a.rLb),w.a.zb(l.a.g_f),w.a.zb(e.a.KVc),w.a.zb(a.a.mAd),w.a.zb(a.a.Ceb),w.a.zb(k.a.C0i)]}static HFl(){return[w.a.zb(l.a.saf),w.a.zb(l.a.lastModifiedTime),w.a.zb(l.a.KK),w.a.zb(l.a.rLb),w.a.zb(l.a.g_f),w.a.zb(e.a.KVc),w.a.zb(a.a.mAd),w.a.zb(k.a.C0i)]}}T._instance=new I.a(T.Nea);T.nTj=new I.a(T.GFl);T.oTj=new I.a(T.HFl);Object(D.a)(T,"GraphNodeComplexMerge",
null,[2003])},1453:function(D,L,c){c.r(L);D=c(0);var l=c(123),e=c(1472),a=c(1458),k=c(1586),m=c(1587);class w{constructor(r,z){this.p$a=!1;this.Fga=null;if(!r)throw Error.argumentNull("annotations");if(!r.b$b(z))throw Error.argument("structTypeID","Invalid struct type ID");this.aw=r;this.nac=this.aw.r0h(z);this.L3j=z}get CZb(){return this.aw}get isReadOnly(){return this.p$a}get pSa(){return this.L3j}jgb(r){if(0>r||r>=this.nac)throw Error.argument("iField","Invalid field index");return this.Fga&&null!=
this.Fga[r]?this.Fga[r]:this.aw.S4h(this.pSa,r)}c2f(r,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>r||r>=this.nac)throw Error.argument("iField","Invalid field index");if(!this.aw.W8b(this.aw.lDb(this.pSa,r),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Fga||(this.Fga=Array(this.nac)))[r]=z}Mca(){const {Annotations:r}=c(1453);let z="[";if(this.Fga){let A=!0;for(let G=0;G<this.nac;++G){if(null==
this.Fga[G])continue;const H=this.aw.lDb(this.pSa,G);if(r.Vob(H,this.Fga[G],this.aw.S4h(this.pSa,G)))continue;A?A=!1:z+=", ";z+=this.aw.T4h(this.pSa,G);z+="=";const I=this.aw.Mca(H,this.Fga[G]);H===r.b9?(z+='"',z+=e.a.lbf(I),z+='"'):z+=I}}return z+"]"}isEqual(r){const {Annotations:z}=c(1453);if(this===r)return!0;if(!r||this.aw!==r.CZb||this.pSa!==r.pSa)return!1;for(let A=0;A<this.nac;++A)if(!z.Vob(this.aw.lDb(this.pSa,A),this.jgb(A),r.jgb(A)))return!1;return!0}clone(){const r=new w(this.aw,this.pSa);
this.Fga&&(r.Fga=Array.clone(this.Fga));return r}AS(){return this.isReadOnly?this.clone():this}eCf(){const {Annotations:r}=c(1453);if(!this.isReadOnly&&(this.p$a=!0,this.Fga))for(let z=0;z<this.nac;++z){const A=this.Fga[z];null!=A&&r.iHb(A)}}toString(){return this.Mca()}}Object(D.a)(w,"StructValue",null,[1223,1224]);c.d(L,"Annotations",function(){return v});class v{constructor(r,z){if(!r)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.pPm=z.P8k;let A=0;var G=
z.Ufb(r.J(A));++A;this.HDf=new k.a(new m.a(G));this.TKj=r.J(A);++A;this.xvi=Array(this.vFd);this.vUc=Array(this.vFd);this.Jjb=Array(this.vFd);for(G=0;G<this.vFd;++G){this.xvi[G]=z.vE(r.J(A));++A;this.vUc[G]=r.J(A);++A;var H=r.J(A);++A;this.Jjb[G]=Array(H);for(var I=0;I<H;++I)this.Jjb[G][I]=z.vE(r.J(A)),++A}this.K3j=r.J(A);++A;this.cwi=Array(this.O4c);this.DYd=Array(this.O4c);this.EYd=Array(this.O4c);this.CYd=Array(this.O4c);for(G=0;G<this.O4c;++G)for(this.cwi[G]=z.vE(r.J(A)),++A,H=r.J(A),++A,this.DYd[G]=
Array(H),this.EYd[G]=Array(H),this.CYd[G]=Array(H),I=0;I<H;++I)this.DYd[G][I]=z.vE(r.J(A)),++A,this.EYd[G][I]=r.J(A),++A,this.CYd[G][I]=({Ofa:A}=this.GMa(this.EYd[G][I],r,A,null,null,null)).returnValue,v.iHb(this.CYd[G][I]);this.GEj=r.J(A);++A;this.lDf=Array(this.b_b);this.mDf=Array(this.b_b);this.kDf=Array(this.b_b);for(G=0;G<this.b_b;++G)this.lDf[G]=z.vE(r.J(A)),++A,this.mDf[G]=r.J(A),++A,this.kDf[G]=({Ofa:A}=this.GMa(this.mDf[G],r,A,null,null,null)).returnValue,v.iHb(this.kDf[G])}VJc(r){for(let z=
0;z<this.b_b;++z)if(this.lDf[z]===r)return z;return-1}ESh(r){if(!this.$9b(r))throw Error.argument("attrID","Invalid attribute ID");return this.lDf[r]}getAttributeType(r){if(!this.$9b(r))throw Error.argument("attrID","Invalid attribute ID");return this.mDf[r]}lDb(r,z){if(!this.b$b(r))throw Error.argument("structTypeID","Invalid struct type ID");r=this.EYd[v.P4c(r)];if(0>z||z>=r.length)throw Error.argument("iField","Invalid field index");return r[z]}Mca(r,z){if(!this.izf(r))throw Error.argument("typeID",
"Invalid type ID");if(!this.W8b(r,z))throw Error.argument("value","Value is not of the correct type");switch(r){case v.b9:return z;case v.Zxa:return z?"True":"False";case v.pHa:case v.Lpa:return z.toString();case v.RU:return z.Mca();default:if(!v.EH(r)&&v.P6c(r)){r=v.cbf(r);const H=this.Jjb[r].length;switch(this.vUc[r]){case 0:return this.Jjb[r][z];case 1:if(z){var A="";for(var G=1;G<H;++G)z&1<<G-1&&(0<A.length&&(A+=" & "),A+=this.Jjb[r][G]);return A}return this.Jjb[r][0];case 2:A="";for(G=0;G<H;++G)z&
1<<G&&(0<A.length&&(A+=" & "),A+=this.Jjb[r][G]);return A;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.vUc[r]);}}else return z.Mca()}}izf(r){switch(r){case v.b9:case v.Zxa:case v.pHa:case v.Lpa:case v.RU:return!0;default:return v.EH(r)?this.izf(v.$_a(r)):v.P6c(r)?this.zym(r):this.b$b(r)}}zym(r){r=v.cbf(r);return 0<=r&&r<this.xvi.length}b$b(r){r=v.P4c(r);return 0<=r&&r<this.cwi.length}$9b(r){return 0<=r&&r<this.b_b}W8b(r,z){if(null==z)return!1;switch(r){case v.b9:return"string"===
typeof z;case v.Zxa:return"boolean"===typeof z;case v.pHa:return"number"===typeof z;case v.Lpa:return"number"===typeof z;case v.RU:return Object(l.a)(1221,z);default:if(v.EH(r))return Object(l.a)(1222,z)&&z.F3===v.$_a(r);if(v.P6c(r)){if("number"!==typeof z)return!1;r=v.cbf(r);const A=this.Jjb[r].length;switch(this.vUc[r]){case 0:return 0<=z&&z<A;case 1:return!(z&-1<<A-1);case 2:return!!z&&!(z&-1<<A);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.vUc[r]);}}else return Object(l.a)(1223,
z)&&z.pSa===r}}get b_b(){return this.GEj}get vFd(){return this.TKj}get O4c(){return this.K3j}ntl(r){if(!this.$9b(r))throw Error.argument("attrID","Invalid attribute ID");return this.kDf[r]}r0h(r){if(!this.b$b(r))throw Error.argument("structTypeID","Invalid struct type ID");return this.DYd[v.P4c(r)].length}T4h(r,z){if(!this.b$b(r))throw Error.argument("structTypeID","Invalid struct type ID");return this.DYd[v.P4c(r)][z]}S4h(r,z){if(!this.b$b(r))throw Error.argument("structTypeID","Invalid struct type ID");
r=this.CYd[v.P4c(r)];if(0>z||z>=r.length)throw Error.argument("iField","Invalid field index");return r[z]}GMa(r,z,A,G,H,I){if(!z)throw Error.argumentNull("initData");if(v.EH(r)){var K=z.J(A);++A;r=v.$_a(r);var F=new a.a(this,r);for(var J=0;J<K;++J)Array.add(F.items,({Ofa:A}=this.GMa(r,z,A,G,H,I)).returnValue);return{returnValue:F,Ofa:A}}switch(r){case v.b9:return{returnValue:(G||this.HDf).vE(z.J(A++)),Ofa:A};case v.Zxa:return{returnValue:1===z.J(A++),Ofa:A};case v.pHa:return{returnValue:z.J(A++),
Ofa:A};case v.Lpa:return{returnValue:(H||this.pPm)[z.J(A++)],Ofa:A};case v.RU:r=z.J(A++);K=new e.a(this);for(F=0;F<r;++F)J=z.J(A),++A,I&&(J=I[J]),K.ny(J,({Ofa:A}=this.GMa(this.getAttributeType(J),z,A,G,H,I)).returnValue);return{returnValue:K,Ofa:A};default:if(v.P6c(r))return{returnValue:z.J(A++),Ofa:A};if(v.hmj(r)){K=z.J(A++);F=new w(this,r);for(J=0;J<K;++J){const N=z.J(A);++A;F.c2f(N,({Ofa:A}=this.GMa(this.lDb(r,N),z,A,G,H,I)).returnValue)}return{returnValue:F,Ofa:A}}throw Error.argument("typeID",
"Invalid type ID");}}static P6c(r){return 16<=(r&16383)&&16384!==(r&16384)&&32768!==(r&32768)}static hmj(r){return 16<=(r&16383)&&16384===(r&16384)&&32768!==(r&32768)}static EH(r){return 32768===(r&32768)}static UIl(r){if(v.EH(r))throw Error.argument("nonListTypeID","Non-list type ID required");return r|32768}static $_a(r){if(!v.EH(r))throw Error.argument("listTypeID","List type ID required");return r&-32769}static Vob(r,z,A){switch(r){case v.b9:case v.Zxa:case v.pHa:case v.Lpa:return z===A;case v.RU:return z.isEqual(A);
default:return v.EH(r)?z.isEqual(A):v.P6c(r)?z===A:z.isEqual(A)}}static iHb(r){Object(l.a)(1224,r)&&r.eCf()}static AS(r){return Object(l.a)(1224,r)?r.AS():r}static cbf(r){return r-16}static P4c(r){return(r&-16385)-16}}v.b9=1;v.Zxa=2;v.pHa=3;v.Lpa=5;v.RU=9;Object(D.a)(v,"Annotations",null,[1225])},1456:function(D,L,c){D=c(0);var l=c(283);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(D.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;
this.mentionLength=this.mentionStart=0}}Object(D.a)(a,"InsightsParameters",null,[]);var k=c(1669),m=c(1670),w=c(1671),v=c(1672),r=c(2),z=c(1502),A=c(1516),G=c(33),H=c(15),I=c(16),K=c(27);c.d(L,"a",function(){return F});class F{static get jtf(){return"Insights_16x16x32"}static get Kil(){return"Find_16x16x32"}static get wKi(){return"-Parameterized"}static get v6f(){return"Parameterized"}static get Hge(){return"bTryQuery"}static get jbg(){return"TellMeSuggestion_"}static get Jlj(){return"bTryQueryAlternate"}static get O9f(){return"MenuTellMe"}static get Vfn(){const J=
{},N=[];Array.add(N,{Term:{PeopleType:"Person"}});J.And=N;return J}static D5e(J){return J+F.wKi}static getParameter(J){let N="",O="";if(J)for(let M=0;M<J.PMh;++M)"Type"===J.Fif(M)?N=J.getValue(M):"Value"===J.Fif(M)&&(O=J.getValue(M));return new l.a(N,O)}static Nzb(J){J=Object.assign(new a,{neighborhood:J,mentionStart:0,mentionLength:J.length});return G.c(J)}static bBh(J,N,O){J=Object.assign(new e,{displayName:J,email:N,userId:O});return G.c(J)}static zMa(J,N,O=null){J=Object.assign(new A.a,{neighborhood:J,
mentionStart:0,mentionLength:J?J.length:0});N=Object.assign(new z.a,{selection:J,userIntent:null,entryPoint:N,launchData:O});return G.c(N)}static aMn(J,N){return F.zMa(J,F.bMn(N))}static bMn(J){switch(J){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static Fji(){return!!r.AFrameworkApplication.K&&r.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static YFb(){const J=r.AFrameworkApplication.K?
r.AFrameworkApplication.K.lb("SovereignEnvironmentName"):null;return!!J&&0<J.length}static isEnterpriseUser(){const J=r.AFrameworkApplication.K?r.AFrameworkApplication.K.lb("HostAuthType"):null;return!!J&&"aad"===J.toLowerCase()||"external"===J&&F.Puf()}static y4f(J){return J.Nko&&!F.YFb()}static uni(){const J=r.AFrameworkApplication.K?r.AFrameworkApplication.K.lb("UiHostIntegrationType"):"";return!!r.AFrameworkApplication.K&&"UnifiedUiHostTeams"===J&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static x4f(J){return J.CSa&&J.Rgl&&(J.y5c||J.w5c||J.Yib)&&!F.uni()&&F.isEnterpriseUser()&&!F.YFb()}static mga(){return r.AFrameworkApplication.K?r.AFrameworkApplication.G5a||r.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):r.AFrameworkApplication.G5a}static rQ(J){return!J||F.Uni(J.Ig)}static Uni(J){return!J||!J.trim().length}static qge(J){if(!J)return 0;const N=Math.pow(10,5);return Math.round(J*N)/N}static Ymo(){var J=new Date;return J?new Date(J.getUTCFullYear(),J.getUTCMonth(),J.getUTCDate(),
J.getUTCHours(),J.getUTCMinutes(),J.getUTCSeconds(),J.getUTCMilliseconds()):null}static Cnf(J){J=new Date(J);return(F.Ymo().getTime()-J.getTime())/1E3}static Doi(J){const {InsightsMenuItemFactory:N}=c(1668);switch(J){case k.a.cqf:case m.a.zOh:case N.Iei:case w.a.IAi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":return!0}return J.startsWith(F.Hge)||
J.startsWith(F.jbg)||J.startsWith(F.Jlj)||J.startsWith("PeopleSuggestion")||J.startsWith("FileSuggestion")||J.startsWith("FindInDocumentSuggestion")||J.startsWith("NotesSuggestion")||J.startsWith("OnenoteNotesSuggestion")||J.startsWith("SmartLookupFromTellMe")||J.startsWith("GetHelpFromTellMe")||J.startsWith("GetHelpWithDescriptionFromTellMe")||J.startsWith("AddinSuggestion")||J.startsWith("OfficeScripts")?!0:!1}static Yif(J,N){const O=[];Array.add(O,new v.a(400,J));Array.add(O,new v.a(200,N));J=
{};J.parts=O;return JSON.stringify(J)}static Sfb(J){const N=J.indexOf("<b0>"),O=J.lastIndexOf("</b0>"),M=[];Array.add(M,new v.a(400,J.substring(0,N)));Array.add(M,new v.a(600,J.substring(N+4,O)));Array.add(M,new v.a(400,J.substring(O+5,J.length)));J={};J.parts=M;return JSON.stringify(J)}static r6h(J){const N=F.Cnf(J);return 60>N?CommonUIStrings.l_TimeSince_SecsAgo:3600>N?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(N/60).toString()):86400>N?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(N/3600).toString()):172800>N?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(J)).localeFormat("MMMM dd, yyyy"))}static Jwl(J){const N=Array(J.length);for(let O=0;O<J.length;O++)N[O]=J[O].commandId;return N}static Puf(){if("Dev Box"===r.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse"))return!0;let J=r.AFrameworkApplication.K.lb("UserPrincipalName");J=K.c(J)?"":I.a.jh(J);const N=r.AFrameworkApplication.K.Sv("TellMeIntEnabledForFeatureCrew")?
r.AFrameworkApplication.K.XB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(N,J)&&"inner"===r.AFrameworkApplication.K.lb("Microsoft365Ring")}static CFl(J){switch(J.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static rna(){return H.a.r3&&!H.a.Wp}}F.MSa=9E5;Object(D.a)(F,"TellMeUtils",null,[])},1457:function(D,L,c){c.r(L);D=c(0);var l=c(52),e=c(123),a=c(68),k=c(1599),m=c(223);class w{constructor(bb,Ub,Oa,Fc,xc,pd){this.groupType=bb;this.resultType=
Ub;this.i8f=Oa;this.k7=Fc;this.i9e=xc;this.resultIndex=pd}}Object(D.a)(w,"ClickLoggingInfo",null,[]);const v=bb=>{const Ub=[];for(;bb;)Array.add(Ub,"{ContextId:"+bb.contextId+", IsGraphNodeContext:"+bb.gl+"}"),bb=bb.Yj;Ub.reverse();return"{"+Ub.join(", ")+"}"};class r{constructor(){this.fna=this.sessionId=null}}Object(D.a)(r,"CorrelationRecord",null,[1106]);var z=c(1477);class A{constructor(bb,Ub){this.Id=null;this.TimeStamp=0;this.Id=bb;this.TimeStamp=Ub}}Object(D.a)(A,"MRUControl",null,[]);var G=
c(1588),H=c(1584),I=c(1456),K=c(2),F=c(1347);class J{constructor(bb,Ub){this.BUj=10;this.L5=[];this.Nza=[];this.oRg=this.nRg=!1;this.tuc=this.suc="";this.SUb=Ub;this.oc=bb;this.cSg=bb.nq}vKc(){!this.nRg&&this.cSg&&this.oc&&H.a.Zki()&&(this.suc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.oc.application,this.L5=this.tTh(),this.nRg=!0);return this.L5}yQl(){!this.oRg&&this.cSg&&this.oc&&H.a.Zki()&&(this.tuc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.oc.application,this.Nza=this.tTh(!0),this.oRg=!0);
return this.Nza}Bxm(bb){return bb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===bb||"TryOfficeUpsell"===bb}vuf(bb){return this.dkm(bb)||this.Bxm(bb)||I.a.Doi(bb)?!1:!0}BLa(bb){bb=bb.ControlId;this.vuf(bb)&&(bb=this.HXf(bb),this.eEn(bb),this.gQm(),Array.insert(this.L5,0,new A(bb,Date.now())),this.suc.length&&(bb=JSON.stringify(this.L5),F.a.instance.setItem(this.suc,bb)))}kF(bb){this.fQm();Array.insert(this.Nza,0,new A(G.a[bb],Date.now()));this.tuc.length&&(bb=JSON.stringify(this.Nza),F.a.instance.setItem(this.tuc,
bb))}tTh(bb=!1){if(!this.L5.length){var Ub=bb?F.a.instance.getItem(this.tuc):F.a.instance.getItem(this.suc);if(!Ub||""===Ub)return bb?this.Nza:this.L5;let Oa=null;try{Oa=JSON.parse(Ub)}catch(Fc){this.sFk(bb),Oa=null}if(!Oa||!Oa.length||10<Oa.length)return bb?this.Nza:this.L5;Ub=0;for(const Fc of Oa)if(bb||this.oc.sVd(Fc.Id)&&this.vuf(Fc.Id))if(bb?Array.insert(this.Nza,Ub++,Fc):Array.insert(this.L5,Ub++,Fc),Ub===this.SUb)break}return bb?this.Nza:this.L5}s2e(bb){bb=this.HXf(bb);for(const Ub of this.L5)if(Ub.Id===
bb)return!0;return!1}sFk(bb=!1){F.a.instance.setItem(bb?this.tuc:this.suc,"")}pmm(bb){bb=this.HXf(bb.ControlId);return this.vuf(bb)?this.s2e(bb):!1}eEn(bb){if(0<this.L5.length){let Ub=0;for(const Oa of this.L5){if(Oa.Id===bb){Array.removeAt(this.L5,Ub);break}Ub++}}}HXf(bb){return"Excel"===this.oc.application&&bb.startsWith("m_excelWebRenderer_ewaCtl_")?bb.substr(26,bb.length):bb}gQm(){this.L5.length===this.SUb&&Array.removeAt(this.L5,this.L5.length-1)}fQm(){this.Nza.length===this.BUj&&Array.removeAt(this.Nza,
this.Nza.length-1)}dkm(bb){bb=bb.split("|");let Ub="";if(6<=bb.length)Ub=bb[0];else if(3<=bb.length){if("3"===bb[0])return!0;Ub=bb[1]}return Ub.startsWith("WA")}static createInstance(bb){let Ub=3;K.AFrameworkApplication.K&&(Ub=K.AFrameworkApplication.K.pc("TellMeMaxRecommendedResultsToReturn",3));return new J(bb,Ub)}}Object(D.a)(J,"MruControlsManager",null,[1103]);class N{constructor(bb){this.Lub=bb}Qea(bb,Ub){let Oa;return bb.kC&&(Oa=this.Lub[bb.value])?Oa.Qea(bb,Ub):(Oa=this.tUh(bb.value))?Oa.Qea(Oa.EVm,
Ub):null}mOl(bb,Ub){if(bb=this.Lub[bb])for(const Oa of Ub)if(Ub=I.a.getParameter(Oa),Ub.key===bb.vPf)return Ub.value;return null}kZm(bb){(bb=this.tUh(bb))&&bb.hZm()}tUh(bb){const Ub=bb.indexOf(I.a.wKi);return 0<Ub?this.Lub[bb.substring(0,Ub)]:null}}Object(D.a)(N,"ParameterizedCommandManager",null,[1102]);var O=c(1485);class M{constructor(bb,Ub){this.Ig=bb;this.Ilb=Ub}}Object(D.a)(M,"TellMeQuery",null,[]);var T=c(1585);class R{constructor(bb,Ub){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=bb;
this.TimeElapsedSinceClick=Ub}}Object(D.a)(R,"CommandClickedEvent",null,[]);var W=c(27);class V{constructor(bb,Ub){this.SWj=bb;this.Qra=Ub}resultsUpdated(bb){this.SWj(W.c(bb.query)?"":bb.query.Ig,bb.eo,bb.attributes,this.Qra,bb.q9b)}}Object(D.a)(V,"ResultsUpdatedCallback",null,[1101]);class ba{constructor(bb,Ub,Oa,Fc,xc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=bb;this.TimeElapsedSinceClick=Oa;this.CommandSurface=
Fc;this.CommandId=Ub;this.TerminalParentControlId=xc}}Object(D.a)(ba,"UserActionEvent",null,[]);var ha=c(82);class ca{constructor(bb,Ub){this.menuModel=bb;this.resultCount=Ub}}Object(D.a)(ca,"GeneratedMenuModel",null,[]);class ia{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(D.a)(ia,"MenuModel",null,[]);class ra{constructor(bb,Ub,Oa){this.oc=bb;this.Lub=Ub;this.Zda=Oa}vql(bb,Ub,Oa){const {TellMeActor:Fc}=c(1457);let xc=0;const pd=
new ia,lb=[];let Tb="";pd.sections=[];let pc=new ha.a;const Db=!!this.oc&&this.oc.j2a;var Ob=!!this.oc&&this.oc.hnb||K.AFrameworkApplication.ta.Pb.hnb;for(const tb of bb){bb=0;Db||(pc=new ha.a);const ac=new ha.a;let zc=tb.displayName;for(const yc of tb.results){if(0<=yc.value.indexOf(I.a.v6f)){if(yc.kC){var jb=this.Lub[yc.value];if(jb&&yc.value.endsWith(I.a.v6f)){if("FindParameterized"!==yc.value&&!Ob){const cd=[];cd.push(appChrome.actions.setControlLabel(yc.value,jb.MKd(yc)));cd.push(appChrome.actions.setButtonCommandValueId(yc.value,
jb.Ygf(yc)));appChrome.api.dispatch(cd)}jb=yc.value.replace(I.a.v6f,"");pc.remove(jb)?bb--:ac.add(jb);pc.add(yc.value);bb++}}}else switch(yc.type){case 5:ac.contains(yc.value)||(pc.add(yc.value),bb++);break;case 7:pc.add(yc.kC);bb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 6:case 19:case 20:case 21:case 26:case 28:case 27:pc.add(yc.value),bb++}13===tb.groupType&&(zc=I.a.mga()?0<Ub.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Ub):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Ub));21===tb.groupType&&(zc=CommonUIStrings.l_LearningUILiveText)}xc+=bb;""!==zc&&0<bb&&(Tb+=" , "+bb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+zc+" , ");0<pc.count&&!Db&&(bb=appChrome.api.menuSection(pc.toArray(),tb.displayName,null,O.a[tb.groupType]),lb.push(bb))}Ob=null;0<xc&&(Ob=0<Ub.length?1!==xc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
xc,Ub):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Ub):1!==xc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,xc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Db?(Ub=appChrome.api.menuSection(pc.toArray(),"",null,null),lb.push(Ub)):Ob+=Tb);Oa&&(this.oc.Xua?Fc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Ob)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Ob)));pd.sections=
lb;return new ca(pd,xc,[])}static get aaf(){return ra.OIg||(ra.OIg=new ca(Object.assign(new ia,{sections:[]}),0,[]))}}ra.OIg=null;Object(D.a)(ra,"TellMeMenuDefintionGenerator",null,[]);var da;(function(bb){bb[bb.TellMeControlActivated=0]="TellMeControlActivated";bb[bb.TellMeQueryExecuted=1]="TellMeQueryExecuted";bb[bb.TellMeResultsRendered=2]="TellMeResultsRendered";bb[bb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(da||(da={}));Object(D.b)("PerformanceMarker",da);var za;(function(bb){bb[bb.TellMeTimeToRender=
0]="TellMeTimeToRender";bb[bb.TellMeSessionLength=1]="TellMeSessionLength";bb[bb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(za||(za={}));Object(D.b)("PerformanceMeasure",za);class la{mark(bb){window.performance.mark(da[bb])}measure(bb,Ub,Oa){const {TellMeActor:Fc}=c(1457);try{window.performance.measure(za[bb],da[Ub],da[Oa])}catch(xc){Fc.instance.Qe.onError("TellMePerformance:Measure","error measuring "+za[bb])}}ACf(bb,Ub,Oa){const {TellMeActor:Fc}=c(1457);Fc.instance.Qe.KCf(Ub,Oa,bb,this.EJl(bb))}UFk(){var bb=
[0,1,2,3];for(const Ub of bb)window.performance.clearMarks(da[Ub])}clearMeasures(bb){for(const Ub of bb)window.performance.clearMeasures(za[Ub])}EJl(bb){let Ub=0;(bb=this.asl(bb))&&0<bb.length&&(Ub=bb[bb.length-1].duration);return Ub}asl(bb){return window.performance.getEntriesByName(za[bb],"measure")}}Object(D.a)(la,"TellMePerformance",null,[]);var na=c(1522),Ca=c(1521),Na=c(33);class Ta{constructor(bb){this.M4j=bb}QIb(bb,Ub,Oa){const {TellMeActor:Fc}=c(1457);Fc.instance.Qe.d8(Ub,Ca.a.Gdc,bb.data.jf.toString(),
Math.round(window.performance.now()-Oa),Ca.a.Gdc,!0,na.a.tOa);bb=Na.b(bb.data.Ae);Ub=-1;bb.Index&&(Ub=bb.Index);Fc.instance.Qe.KMm(Ub,this.M4j)}EIb(bb,Ub,Oa){const {TellMeActor:Fc}=c(1457);Fc.instance.Qe.d8(Ub,Ca.a.Gdc,bb.data.jf.toString(),Math.round(window.performance.now()-Oa),Ca.a.Gdc,!1,na.a.tOa)}EQl(bb){if(bb&&""!==bb.trim()){const Oa=window.performance.now(),Fc=K.AFrameworkApplication.ohj;var Ub={};Ub.Text=bb;Ub.IsFileHash="false";Ub=Na.c(Ub);K.AFrameworkApplication.Ve.qj(Fc,2,Ub,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,xc=>{this.QIb(xc,bb.length,Oa)},xc=>{this.EIb(xc,bb.length,Oa)},null,null,!1,4E3,6E3)}}}Object(D.a)(Ta,"TellMeQueryIndexCallback",null,[]);var Fa=c(1459);class qa{constructor(bb,Ub,Oa){this.xml=bb;this.resultCount=Ub;this.F6k=Oa}}Object(D.a)(qa,"GeneratedMenuXml",null,[]);var ja=c(1669),X=c(16);class ua{constructor(bb,Ub){this.vbd=bb||{};this.YVa=Ub}get gLb(){return 5}Qea(bb,Ub=null){return this.YVa.Qea(bb,Ub)||this.fuk(bb.value)}fuk(bb){return ua.LYe(bb,this.vbd[bb]||
null)}static LYe(bb,Ub=null){bb=String.format('<ClonedControl Id="{0}" ',bb);for(let xc in Ub){var Oa=xc,Fc=Ub[xc];Fc=Fc?X.a.Cf(Fc.toString()):"";bb+=String.format('{0}="{1}" ',Oa,Fc)}return bb+"/>"}}Object(D.a)(ua,"CommandMenuItemFactory",null,[1098]);var Ha=c(239);class Ea{constructor(){this.OLj=CommonUIStrings.l_FindInDocumentText}get gLb(){return 8}Qea(bb){var Ub=bb.kC;bb=X.a.Cf(bb.value);const Oa=X.a.Cf(Ub);Ub=X.a.Cf(String.format(this.OLj,Ub));return this.Jpl(bb,Oa,Ub)}Jpl(bb,Ub,Oa){return Ha.a(bb,
"1540292897",Oa,I.a.Kil,null,Ub,Oa,null,null)}}Object(D.a)(Ea,"FindInDocumentMenuItemFactory",null,[1098]);var wa=c(1670),sa=c(1668),fa=c(1671);class Ma{get gLb(){return 7}Qea(bb){const Ub=Object(a.a)(T.a,bb);return this.Eql(X.a.Cf(bb.value),Ub.id)}Eql(bb,Ub){return Ha.a(Ub,"1404166600",bb,null,null,bb,bb,null,null)}}Object(D.a)(Ma,"TryQueryMenuItemFactory",null,[1098]);class Ua{constructor(bb){this.o5=[];this.oc=bb}fCl(bb){for(const Ub of this.o5)if(Ub.gLb===bb)return Ub;return null}ha(bb){this.o5.push(bb)}uyn(bb){this.ha(new ua(this.oc.AOk,
bb));this.ha(new fa.a(this.oc.dYm));this.ha(new ja.a(this.oc.dRn,this.oc.cRn,this.oc.Xko,this.oc.V7l,this.oc.t6n));this.ha(new sa.InsightsMenuItemFactory);this.ha(new Ea);this.ha(new wa.a);this.ha(new Ma)}}Object(D.a)(Ua,"MenuItemFactoryRegistry",null,[]);var Qa=c(1460);class Ja{constructor(bb,Ub){this.oc=bb;this.lWg=new Ua(this.oc);this.lWg.uyn(Ub)}wql(bb,Ub){let Oa=0;const Fc=[],xc=[];for(const lb of bb){bb=I.a.O9f;var pd=[];for(const Tb of lb.results){const pc=this.lWg.fCl(Tb.type).Qea(Tb,Ub);
bb=I.a.O9f;pd.push(pc);if(13===Tb.type||14===Tb.type)bb="Menu32";17===Tb.type&&(bb="MenuTellMeExtended");Tb.groupType=lb.groupType;xc.push(Object(a.a)(Qa.a,Tb))}Oa=Oa?Oa:pd.length;pd=Ha.d("TellMeDropdownControls",pd);bb=Ha.h("TellMeDropdownMenuSection",pd,bb,lb.displayName);Fc.push(bb)}Ub=Ha.i(Fc,"LookupDropdownMenu");return new qa(Ub,Oa,xc)}static get NEd(){return Ja.PIg||(Ja.PIg=new qa(Ha.i([],"LookupDropdownMenu"),0,[]))}}Ja.PIg=null;Object(D.a)(Ja,"TellMeXmlGenerator",null,[]);class Wa{}Wa.tWm=
"MRU";Wa.test="Test";Object(D.a)(Wa,"ActionType",null,[]);var Ya=c(1507),sb;(function(bb){bb[bb.Service=0]="Service";bb[bb.Local=1]="Local";bb[bb.MRU=2]="MRU";bb[bb.TestResult=3]="TestResult";bb[bb.Unknown=4]="Unknown"})(sb||(sb={}));Object(D.b)("SubResultType",sb);var ob=c(77);class fc{constructor(bb,Ub,Oa,Fc,xc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=bb;this.IsEnabled=Ub;this.ResultType=G.a[Oa];this.SubResultType=sb[Fc];
this.OptionalData=xc?ob.a.toJSON(xc):null}}Object(D.a)(fc,"ResultInfo",null,[]);var Eb=c(101),Ib=c(142),Nb=c(249);class pb{constructor(bb,Ub=null){this.Kgd="TellMeWAC.";this.uYj=bb;this.O5j=Ub}mGa(bb,Ub,Oa){Ub=Eb.a.mE(Ub);bb=Eb.a.z5e(bb,this.uYj,this.O5j,Oa,Ub);Ib.a.mGa(bb,this.Kgd)}lGa(bb,Ub,Oa=0){Ub=Eb.a.mE(Ub);Ib.a.lGa(Object.assign(new Nb.a,{name:bb,dataFields:Ub,durationMs:Oa}),this.Kgd)}}Object(D.a)(pb,"TellMeOtelLogger",null,[1123]);var Aa=c(119);class xb{constructor(bb,Ub,Oa,Fc,xc,pd,lb){this.N5=
this.j$=this.yEg=null;this.xya=bb;this.qRb=Ub;this.HKa=Oa;this.o$a=Fc;this.oVa=xc;this.qSj=pd;this.N5=lb?lb:new pb(this.o$a?m.CuiHelper.u6f:m.CuiHelper.gfe)}get nq(){return this.o$a}get Poa(){return this.HKa}Sae(bb){this.yEg=bb;switch(bb){case Fa.a.contextMenu:this.j$=Fa.a.contextMenu;break;default:this.j$=Fa.a.tellMe}}Wqk(bb,Ub){this.HKa.fna||(this.HKa.fna=Aa.a.create().toString(),this.ati(bb,!0,Ub))}qJh(bb,Ub=!0){this.HKa.fna&&this.YIm(bb,Ub);this.o$a&&appChrome.api.updateTellMeCorrelationId("");
this.HKa.fna=null}ati(bb,Ub,Oa){const {TellMeActor:Fc}=c(1457),xc=this.E6(z.a.o1a);xc[Ya.a.culture]=this.qRb;xc[Ya.a.appName]=this.xya;xc[Ya.a.context]=bb;xc[Ya.a.GUd]=this.oVa;xc[Ya.a.xxm]=this.qSj;xc[Ya.a.hwm]=Oa;xc[Ya.a.Cqm]=Ub;xc[Ya.a.contentType]=Fc.instance.sCd;this.N5.mGa(z.a.o1a,xc,this.yEg);this.o$a&&appChrome.api.updateTellMeCorrelationId(this.HKa.fna)}YIm(bb,Ub){const Oa=this.E6(z.a.REb);Oa[Ya.a.u9k]=bb;Oa[Ya.a.Bqm]=Ub;this.N5.lGa(z.a.REb,Oa)}IMm(bb,Ub,Oa){let Fc=0;!Oa&&0<bb.length&&(Fc=
bb.trim().split(" ").length);const xc=this.E6(z.a.query);xc[Ya.a.query]="!";xc[Ya.a.eKb]=Ub;xc[Ya.a.SPi]=bb.length;xc[Ya.a.Ppi]=Oa;xc[Ya.a.WJo]=Fc;this.N5.mGa(z.a.query,xc,this.j$)}FKm(bb,Ub,Oa,Fc,xc,pd,lb,Tb=null){const pc=this.E6(z.a.latency);pc[Ya.a.culture]=this.qRb;pc[Ya.a.SPi]=bb;pc[Ya.a.lmj]=Ub;pc[Ya.a.statusCode]=Oa;pc[Ya.a.service]=xc;pc[Ya.a.isSuccess]=pd;pc[Ya.a.EBm]=lb;Tb&&(pc[Ya.a.vno]=Tb);this.N5.lGa(z.a.latency,pc,Fc)}KCf(bb,Ub,Oa,Fc){const xc=this.E6(z.a.performance);xc[Ya.a.culture]=
this.qRb;xc[Ya.a.$qk]=da[bb];xc[Ya.a.Lal]=da[Ub];xc[Ya.a.mgn]=za[Oa];this.N5.lGa(z.a.performance,xc,Fc)}UMm(bb,Ub){var {TellMeActor:Oa}=c(1457);const {CommandResultsUtility:Fc}=c(1493);if(bb.results.length){var xc=this.E6(z.a.vXi);xc[Ya.a.k7]=Ub.toString();xc[Ya.a.groupType]=O.a[bb.groupType];16===bb.groupType&&(xc[Ya.a.Kvm]=Oa.instance.S7c);Ub=[];Oa=[];var pd=[];for(const lb of bb.results)xc[Ya.a.resultType]||(xc[Ya.a.resultType]=G.a[lb.type]),bb={},26===lb.type&&(bb.AssetId=lb.fI),Oa.push(Fc.gQc(lb.value)),
Ub.push(lb.value),pd.push(new fc(lb.value,Fc.gQc(lb.value),lb.type,lb.zfj,bb));0<Ub.length&&(xc[Ya.a.dMn]="{"+Ub.join(", ")+"}",xc[Ya.a.pal]="{"+Oa.join(", ")+"}",xc[Ya.a.ZLn]=Na.c(pd));this.N5.mGa(z.a.vXi,xc,this.j$)}}frl(bb,Ub){if(4===bb)return Wa.tWm;switch(Ub){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G.a[Ub]}uIm(bb,Ub,Oa,Fc,xc){const pd=this.E6(z.a.click);pd[Ya.a.lmj]=bb;pd[Ya.a.ien]=Ub;pd[Ya.a.commandId]=
Oa;pd[Ya.a.P$]=Fc;pd[Ya.a.actionType]=this.frl(xc.groupType,xc.resultType);pd[Ya.a.resultType]=G.a[xc.resultType];pd[Ya.a.i8f]=sb[xc.i8f];pd[Ya.a.groupType]=O.a[xc.groupType];pd[Ya.a.k7]=xc.k7.toString();pd[Ya.a.i9e]=xc.i9e.toString();pd[Ya.a.resultIndex]=xc.resultIndex.toString();this.N5.mGa(z.a.click,pd,this.j$)}AIm(bb,Ub){this.HKa.fna||(this.HKa.fna=Aa.a.create().toString(),this.ati("",!1,Ub));Ub=this.E6(z.a.fxh);Ub[Ya.a.eKb]=bb;this.N5.lGa(z.a.fxh,Ub)}wti(bb,Ub,Oa){if(bb){if(Oa)for(let Fc in Oa)bb[Fc]=
Oa[Fc];this.N5.lGa(z.a.events,bb,Ub)}}rH(bb,Ub,Oa=null){const Fc=this.E6(z.a.events);Fc[Ya.a.event]=bb;this.wti(Fc,Math.round(Ub),Oa)}JEa(bb,Ub,Oa=null){const Fc=this.E6(z.a.events);Fc[Ya.a.event]=z.a.error;Fc[Ya.a.module]=bb;Fc[Ya.a.errorMessage]=Ub;Fc[Ya.a.message]=Ub;this.wti(Fc,Math.round(window.performance.now()),Oa)}sIm(bb){const Ub=this.E6(z.a.iuh);Ub[Ya.a.value]=bb;Ub[Ya.a.l7d]=this.o$a;this.N5.mGa(z.a.iuh,Ub,this.j$)}LHm(bb){const Ub=this.E6(z.a.rbh);Ub[Ya.a.value]=bb;Ub[Ya.a.l7d]=this.o$a;
this.N5.mGa(z.a.rbh,Ub,this.j$)}xJm(bb){const Ub=this.E6(z.a.jNh);Ub[Ya.a.value]=bb;Ub[Ya.a.l7d]=this.o$a;this.N5.mGa(z.a.jNh,Ub,this.j$)}GMm(bb){const Ub=this.E6(z.a.iPi);Ub[Ya.a.value]=bb;Ub[Ya.a.l7d]=this.o$a;this.N5.mGa(z.a.iPi,Ub,this.j$)}YHm(bb){const Ub=this.E6(z.a.P3i);Ub[Ya.a.value]=bb;this.N5.mGa(z.a.P3i,Ub,this.j$)}LMm(bb,Ub){const Oa=this.E6(z.a.NPi);Oa[Ya.a.Gdc]=bb;Ub&&(Oa[Ya.a.fna]=Ub);this.N5.lGa(z.a.NPi,Oa)}E6(bb){return{["SessionID"]:this.HKa.sessionId,["CorrelationID"]:this.HKa.fna,
["Time"]:(new Date).getTime(),["Event"]:bb,["Scenario"]:this.j$}}}Object(D.a)(xb,"UsageLogger",null,[1100]);var gb=c(57),Xa=c(1622),Va=c(1184),Gb=c(83),Xb=c(23),rc=c(227),qb=c(379),Zb=c(15),Rb=c(594),Ra=c(63),ab=c(13);c.d(L,"TellMeActor",function(){return fb});class fb{constructor(){this.YVa=this.G1=this.Vb=this.Ma=this.PO=this.vz=this.Gb=this.ga=this.Qe=this.WJ=this.yDe=this.Lah=this.Rra=this.oc=null;this.kUb=!1;this.qpe=[];this.uEg=[];this.s$g=[];this.ZWg=[];this.$Wg=[];this.aSg=!1;this.fRb=this.Zda=
null;this.vsc=this.oVa=!1;this.jkd=!0;this.eZ=this.mrc=this.xMg=this.PDe=this.LWg=null;this.nY=[];this.L8a=this.JRb=this.Zya=null;this.FTb=!1;this.IDe=0;this.GQb=null;this.Qra=-1;this.nWg=0;this.Csc=!1;this.l9a=null;this.n$g=!1;this.Zq=null}get sCd(){return this.PO?this.PO.contentType:fb.unknown}get actions(){return this.nY}set actions(bb){this.nY=bb}UMd(){return this.Qe?this.Qe.Poa.fna:null}VN(){return this.oc}get jVm(){return this.jkd}get UFo(){return this.LWg}performance(){return this.WJ}get S7c(){return this.n$g}set S7c(bb){this.n$g=
bb}xG(bb){const Ub=window.performance.now();this.Zda&&!W.c(bb)&&(this.Zda(bb),this.Qe.hA(z.a.xG,window.performance.now()-Ub))}initialize(bb,Ub=null,Oa=null,Fc=null,xc=null,pd=null,lb=null,Tb=null,pc=null,Db=null,Ob=null){const {InteractionLogger:jb}=c(1886),{GroupsPlacementInfo:tb}=c(1882),{AggregatorResultsProvider:ac}=c(1697);this.oc=bb;this.oVa=!!K.AFrameworkApplication.ta&&K.AFrameworkApplication.ta.Pb.G9b;this.Qe=Fc;if(!Fc){Fc=new r;Fc.sessionId=K.AFrameworkApplication.userSessionId;const zc=
Rb.a.sg(K.AFrameworkApplication.lcid)||Rb.a.LPc;this.Qe=new jb(new xb(this.oc.application,zc.name,Fc,this.oc.nq,this.oVa,bb.CSa,null),this.oc.HOk,this.oc)}this.YVa=new N(this.oc.parameterData);this.Lah=Oa||new Ja(this.oc,this.YVa);this.Zda=lb;this.yDe=this.yDe||new ra(this.oc,this.oc.parameterData,lb);this.Vb=gb.FocusManager.instance();this.G1=J.createInstance(this.oc);this.xMg=new tb(bb);this.ga=xc||K.AFrameworkApplication.ya;this.Gb=pd||K.AFrameworkApplication.uc;this.vz=pc;this.Rra=Ub;this.Zq=
Ob;this.WJ=new la;pc?pc.execute(zc=>{zc.isFeatureEnabled(fb.Mko,!0).then(yc=>{const {AggregatorResultsProvider:cd}=c(1697);this.Csc=yc;this.Rra=this.Rra||cd.createInstance(this.G1,this.oc,this.YVa,this.Csc);return null})}):(this.Csc=!0,this.Rra=this.Rra||ac.createInstance(this.G1,this.oc,this.YVa,this.Csc));this.Ma=Tb;this.Zya=Ja.NEd;this.LWg=new Promise(zc=>{this.PDe=zc});Db&&Db.execute(zc=>{this.PO=zc});this.oc.nq&&I.a.uni()&&(bb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.oc.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(bb,bb)))}Wb(){this.cdk()}Mzn(bb){this.mrc=bb}cdk(){this.ga.gb(ab.a.tellMe,Ra.a.frame,Object(l.a)(this,this.tellMe,"tellMe"),96);this.ga.gb(ab.a.N9f,Ra.a.frame,Object(l.a)(this,this.boh,"cacheAsyncMenuRefreshFunction"),96);this.ga.gb(ab.a.S9f,Ra.a.frame,Object(l.a)(this,this.Oti,"logItemExecuted"),96);this.ga.gb(ab.a.V9f,Ra.a.frame,Object(l.a)(this,this.lti,"logControlDeactivation"),96);this.ga.gb(ab.a.U9f,Ra.a.frame,Object(l.a)(this,
this.Kti,"logInputFocus"),96);this.ga.gb(ab.a.Q9f,Ra.a.frame,Object(l.a)(this,this.o1a,"interactionBegin"),96);this.ga.gb(ab.a.X9f,Ra.a.frame,Object(l.a)(this,this.o1a,"interactionBegin"),96);this.ga.gb(ab.a.T9f,Ra.a.frame,Object(l.a)(this,this.Jti,"logInputBlur"),96);this.ga.gb(ab.a.W9f,Ra.a.frame,Object(l.a)(this,this.kti,"logControlActivated"),96);this.ga.gb(ab.a.x5c,Ra.a.frame,Object(l.a)(this,this.sPh,"focusSearchBox"),96);this.ga.gb(ab.a.M9f,Ra.a.frame,Object(l.a)(this,this.cwh,"constructLiveNotificationForMenu"),
96);this.ga.gb(ab.a.Y9f,Ra.a.frame,Object(l.a)(this,this.gtf,"insertTryQuery"),96);this.ga.gb(ab.a.jBf,Ra.a.frame,Object(l.a)(this,this.gtf,"insertTryQuery"),96);this.ga.gb(ab.a.wcf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.xcf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.ycf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.zcf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.Acf,
Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.ZNf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.$Nf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.aOf,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.dQf,Ra.a.frame,Object(l.a)(this,this.k1a,"insertMention"),96);this.ga.gb(ab.a.eQf,Ra.a.frame,Object(l.a)(this,this.k1a,"insertMention"),96);this.ga.gb(ab.a.fQf,Ra.a.frame,Object(l.a)(this,
this.k1a,"insertMention"),96);this.ga.gb(ab.a.P9f,Ra.a.frame,Object(l.a)(this,this.pIi,"openFeedback"),96);this.ga.gb(ab.a.Z9f,Ra.a.frame,Object(l.a)(this,this.yQa,"openOrInsertUrl"),96);this.ga.gb(ab.a.hUe,Ra.a.frame,Object(l.a)(this,this.cWd,"launchAddin"),96);this.ga.gb(ab.a.iUe,Ra.a.frame,Object(l.a)(this,this.cWd,"launchAddin"),96);this.ga.gb(ab.a.jUe,Ra.a.frame,Object(l.a)(this,this.cWd,"launchAddin"),96);this.ga.gb(ab.a.$Mb,Ra.a.frame,Object(l.a)(this,this.$Mb,"showTellMeCoachmark"),96);this.ga.gb(ab.a.FAf,
Ra.a.frame,Object(l.a)(this,this.Zqi,"launchAddinStore"),96)}Oxn(bb){this.jkd=!1;const Ub=window.performance.now();bb.G2a.isCompleted?(this.jkd=!0,this.PDe(!0)):bb.lW(()=>{this.jkd=!0;this.PDe(!0);this.Qe.hA(z.a.t2k,window.performance.now()-Ub)});this.zyn(bb)}zyn(bb){qb.a.D_c(Object(l.a)(this,this.e9e,"dispatcher"));qb.a.MHc([new rc.a(ab.a.tellMe,Ra.a.frame,96),new rc.a(ab.a.N9f,Ra.a.frame,96),new rc.a(ab.a.S9f,Ra.a.frame,96),new rc.a(ab.a.V9f,Ra.a.frame,96),new rc.a(ab.a.U9f,Ra.a.frame,96),new rc.a(ab.a.Q9f,
Ra.a.frame,96),new rc.a(ab.a.X9f,Ra.a.frame,96),new rc.a(ab.a.T9f,Ra.a.frame,96),new rc.a(ab.a.W9f,Ra.a.frame,96),new rc.a(ab.a.x5c,Ra.a.frame,96),new rc.a(ab.a.M9f,Ra.a.frame,96),new rc.a(ab.a.Y9f,Ra.a.frame,96),new rc.a(ab.a.jBf,Ra.a.frame,96),new rc.a(ab.a.wcf,Ra.a.frame,96),new rc.a(ab.a.xcf,Ra.a.frame,96),new rc.a(ab.a.ycf,Ra.a.frame,96),new rc.a(ab.a.zcf,Ra.a.frame,96),new rc.a(ab.a.Acf,Ra.a.frame,96),new rc.a(ab.a.ZNf,Ra.a.frame,96),new rc.a(ab.a.$Nf,Ra.a.frame,96),new rc.a(ab.a.aOf,Ra.a.frame,
96),new rc.a(ab.a.dQf,Ra.a.frame,96),new rc.a(ab.a.eQf,Ra.a.frame,96),new rc.a(ab.a.fQf,Ra.a.frame,96),new rc.a(ab.a.P9f,Ra.a.frame,96),new rc.a(ab.a.Z9f,Ra.a.frame,96),new rc.a(ab.a.hUe,Ra.a.frame,96),new rc.a(ab.a.iUe,Ra.a.frame,96),new rc.a(ab.a.jUe,Ra.a.frame,96),new rc.a(ab.a.$Mb,Ra.a.frame,96),new rc.a(ab.a.FAf,Ra.a.frame,96)],bb)}e9e(bb,Ub,Oa,Fc,xc){if(Ub.contextId===Ra.a.frame)switch(bb){case ab.a.tellMe:return this.tellMe(bb,Ub,Oa,Fc,xc);case ab.a.N9f:return this.boh(bb,Ub,Oa,Fc,xc);case ab.a.S9f:return this.Oti(bb,
Ub,Oa,Fc,xc);case ab.a.V9f:return this.lti(bb,Ub,Oa,Fc,xc);case ab.a.U9f:return this.Kti(bb,Ub,Oa,Fc,xc);case ab.a.Q9f:return this.o1a(bb,Ub,Oa,Fc,xc);case ab.a.X9f:return this.LLn(Oa);case ab.a.T9f:return this.Jti(bb,Ub,Oa,Fc,xc);case ab.a.W9f:return this.kti(bb,Ub,Oa,Fc,xc);case ab.a.x5c:return this.sPh(bb,Ub,Oa,Fc,xc);case ab.a.M9f:return this.cwh(bb,Ub,Oa,Fc,xc);case ab.a.Y9f:case ab.a.jBf:return this.gtf(bb,Ub,Oa,Fc,xc);case ab.a.wcf:case ab.a.xcf:case ab.a.ycf:case ab.a.zcf:case ab.a.Acf:case ab.a.ZNf:case ab.a.$Nf:case ab.a.aOf:case ab.a.Z9f:return this.yQa(bb,
Ub,Oa,Fc,xc);case ab.a.dQf:case ab.a.eQf:case ab.a.fQf:return this.k1a(bb,Ub,Oa,Fc,xc);case ab.a.P9f:return this.pIi(bb,Ub,Oa,Fc,xc);case ab.a.hUe:case ab.a.iUe:case ab.a.jUe:return this.cWd(bb,Ub,Oa,Fc,xc);case ab.a.$Mb:return this.$Mb(bb,Ub,Oa,Fc,xc);case ab.a.FAf:return this.Zqi(bb,Ub,Oa,Fc,xc)}return 2}sPh(bb,Ub,Oa){if(1===Oa)return 32;this.J7i();bb=!1;(this.oc.CSa||this.oVa)&&(Ub=document.getElementById("SearchButton"))&&Ub.click();if(!this.oc.CSa&&this.oVa)for(Ub=document.getElementsByClassName("ms-suiteux-search-box"),
Oa=0;Oa<Ub.length;Oa++){const Fc=Ub[Oa].querySelector("input[type=search]");Fc&&(bb=gb.FocusManager.wJ(Fc))}else bb=gb.FocusManager.wJ($get(this.oc.nq?m.CuiHelper.u6f:m.CuiHelper.gfe));this.vsc=!0;return bb?32:8}gtf(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.J7i();bb=xc.CommandValueId;Ub=this.oc.nq?m.CuiHelper.u6f:m.CuiHelper.gfe;this.oc.nq&&!W.c(xc[Va.a.u5a])&&(xc[Va.a.u5a]=!1);if(bb){if(this.oc.nq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(bb)),
this.l9a=[19],32;if(xc=$get(Ub))xc.value=bb}return gb.FocusManager.wJ($get(Ub))?32:8}J7i(){this.Vb.LK(this.oc.CSa||this.oVa?this.oc.WDb:this.oc.L4a,!1)}Yql(bb,Ub){switch(bb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Ub);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Ub);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Ub);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Ub)}return Ub}cwh(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;bb=this.Zya?this.Zya.resultCount:0;xc.Value=1!==bb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,bb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.Zya)for(const pd of this.Zya.F6k)xc=Object(e.a)(T.a,pd)?pd.id:X.a.replaceAll(pd.value,'"',""),(xc=$get(xc+"-"+I.a.O9f))&&Xb.a.Tq(xc,Xb.a.pea,
X.a.Cf(this.Yql(pd.groupType,xc.innerText)));return 32}boh(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.GQb=new Gb.a(2,1,0,()=>{xc[Xa.a.Callback]()},97);this.Zya&&this.Gb.Xb(this.GQb);return 32}Oti(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;xc.CloseAllMenus&&(bb=void 0===xc.ParentControlId||null===xc.ParentControlId?
"<NA>":xc.ParentControlId,Ub=this.fRb?this.fRb[xc.ControlId]:null,!Ub&&this.fRb&&"<NA>"!==bb&&(Ub=this.fRb[bb]),Ub||(Ub=this.kUb&&this.G1.pmm(xc),Ub=this.M3k(Ub,xc.ControlId),Ub=new w(Ub,29,4,-1,-1,-1),this.Qe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+xc.ControlId+" determined group:"+O.a[Ub.groupType])),this.Qe.X1m(xc.ControlId,bb,xc.CommandId,xc.CloseAllMenus,Ub),this.YVa.kZm(xc.ControlId),xc.Location!==Fa.a.contextMenu&&(this.G1.BLa(xc),this.G1.kF(Ub.resultType),this.oc.Sbe&&
this.Rra.Nak(xc.CommandId)));return 32}lti(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;H.a.zxm()&&(new Ta(this.UMd())).EQl(this.JRb);bb=this.JRb;Ub=this.Qra;Oa=this.Qe.Xbd;if(W.c(xc))return this.Qe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;xc=xc.UILocation;bb&&0<bb.length&&this.Csc&&I.a.y4f(this.oc)&&this.oc.cVd&&19!==xc&&Ub>Oa&&!this.oc.zO&&(this.Qe.MCf(bb),this.Qe.S1f(Ub));this.Qe.zKn();this.oc.gie&&19!==xc&&(this.WJ.mark(3),this.WJ.measure(1,0,3),this.WJ.measure(2,2,3),this.WJ.ACf(0,
1,2),this.WJ.ACf(2,2,3),this.WJ.ACf(1,0,3),this.WJ.UFk(),this.WJ.clearMeasures([0,2,1]));this.Qe.E2m(window.performance.now()-this.IDe);this.oc.nq&&(this.L8a=null,this.Qe.swa());this.vsc=this.FTb=!1;this.JRb="";return 32}Kti(bb,Ub,Oa){if(1===Oa)return 32;this.Qe.Ikb(v(Ub),this.vsc);return 32}Jti(bb,Ub,Oa){if(1===Oa)return 32;this.Qe.swa();this.FTb=!1;return 32}kti(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;this.eZ=null;xc&&(this.eZ=xc);this.oc.gie&&(W.c(this.eZ)||this.eZ.Location!==Fa.a.contextMenu)&&this.WJ.mark(0);
this.Qe.Sae(W.c(this.eZ)||W.c(this.eZ.Location)?Fa.a.unknown:this.eZ.Location);this.Qe.D2m(this.nWg,this.vsc);this.FTb||this.v3a();return 32}uzh(bb,Ub){const Oa=[],Fc=Date.now();for(let xc of bb)bb=(Fc-xc.timeStamp)/1E3,bb=I.a.qge(bb),Array.add(Oa,new R(Ub?xc.commandId:xc.controlId,bb));return Oa}xYk(bb){const Ub=[],Oa=Date.now();for(let Fc of bb)if(Fc.controlId||"keyboardShortcut"===Fc.commandSurface)bb=(Oa-Fc.timeStamp)/1E3,bb=I.a.qge(bb),Array.add(Ub,new ba(Fc.controlId,Fc.commandId,bb,Fc.commandSurface,
Fc.lfe));return Ub}dAh(bb=!1){var Ub=bb?this.G1.yQl():this.G1.vKc();bb=[];const Oa=Date.now();for(const Fc of Ub)Ub=(Oa-Fc.TimeStamp)/1E3,Ub=I.a.qge(Ub),Array.add(bb,new R(Fc.Id,Ub));return bb}v3a(){if(!this.FTb){this.kUb=this.FTb=!0;""!==this.oc.n0f&&K.AFrameworkApplication.Xm(this.oc.n0f);if(!this.aSg){this.aSg=!0;const bb={};bb.IsMLREnabled=this.oc.asm;bb.IsReactRibbonEnabled=this.oc.nq;bb.IsSharedHeaderEnabled=!!K.AFrameworkApplication.ta&&K.AFrameworkApplication.ta.Pb.ZI;bb.IsSearchUxEnabled=
this.oVa;bb.IsTellMeInHeaderEnabled=this.oc.CSa;bb.IsGoLocalEnv=I.a.Fji();bb.IsSovereignEnvironment=I.a.YFb();bb.IsTellMeServiceResultsEnabled=I.a.y4f(this.oc);bb.IsSubstrateProviderEnabled=I.a.x4f(this.oc);bb.ShouldFetchTokens=!!K.AFrameworkApplication.ta&&K.AFrameworkApplication.ta.Pb.FMb;bb.IsSerpletEnabled=I.a.mga();bb.FirstOnClickTimeInMS=Math.round(window.performance.now());bb.IsHeaderHidden=K.AFrameworkApplication.hideHeader||K.AFrameworkApplication.zT;bb.IsSearchInHeaderHidden=K.AFrameworkApplication.RNc;
void 0!==window.performance.timing&&null!==window.performance.timing&&(bb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));bb.IsFindWithMatchesEnabled=this.oc.RGd;bb.HelpShowsTopSearchResult=this.oc.y3c;bb.HelpShowsNumberOfMatches=this.oc.x3c;K.AFrameworkApplication.K&&(bb.UiHost=K.AFrameworkApplication.K.lb("UiHostIntegrationType"));this.Qe.pNm(JSON.stringify(bb))}this.qpe=this.uzh(k.a.instance.mKc(),!1);this.uEg=this.uzh(k.a.instance.Kfb(),!0);this.s$g=this.xYk(k.a.instance.Kfb());
this.ZWg=this.dAh();this.$Wg=this.dAh(!0);this.Qe.v3a()}}o1a(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Zb.a.aRc)return 32;this.IDe=window.performance.now();this.v3a();bb=new V(Object(l.a)(this,this.vwa,"onRequestCompleted"),0);this.Qra++;this.Qe.beginQuery("",this.Qra,this.kUb);this.Zya=Ja.NEd;this.L8a=ra.aaf;if(this.Rra)fb.instance.actions=[],this.Rra.qH(new M("",this.Qra),bb,this.oc.nq);else this.Qe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.GQb&&this.Gb.Xb(this.GQb);return 32}LLn(bb){if(1===bb)return 32;this.Vb.RQ(this.oc.CSa||this.oVa?this.oc.WDb:this.oc.L4a,!1);return 32}tellMe(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.eZ=xc;this.Qe.Sae(W.c(this.eZ.Location)?Fa.a.unknown:this.eZ.Location);bb=this.eZ.Value;this.oc.nq||bb&&""!==bb.trim()?(!this.L8a&&this.oc.nq&&(this.Qe.Ikb(v(Ub),this.vsc),this.v3a()),this.jel(bb,
this.eZ.Location),this.eZ.PopulationXML=this.Zya.xml):this.kUb?this.eZ.PopulationXML=this.Zya.xml:(this.eZ.PopulationXML=Ja.NEd.xml,this.L8a=ra.aaf,this.JRb="");return 32}jel(bb,Ub){this.IDe=window.performance.now();this.oc.gie&&Ub!==Fa.a.contextMenu&&this.WJ.mark(1);this.oc.nq&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(bb));bb&&0<bb.trim().length&&(this.kUb=!1);this.oc.Hcl();Ub=W.c(Ub)?Fa.a.tellMe:Ub;if(bb!==this.JRb||this.oc.nq){this.Qra++;this.Qe.beginQuery(bb,this.Qra,this.kUb);
const Oa=new M(bb,this.Qra),Fc=new V(Object(l.a)(this,this.vwa,"onRequestCompleted"),this.Qra);this.Zya=Ja.NEd;this.L8a=ra.aaf;if(this.Rra)fb.instance.actions=[],this.Rra.qH(Oa,Fc,this.oc.nq,Ub,this.l9a),this.l9a=null;else this.Qe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.nWg=this.Qra;this.JRb=bb}}vyo(bb){if(this.oc.nq){var Ub=appChrome.selectors.getActiveControlStates();if(Ub=Object(a.a)(Object,Ub[bb.value])){bb.label=Ub.label;let Oa=null;"description"in
Ub&&(Oa=Ub.description);Oa&&Object.getType(Oa)===String?bb.description=Oa:"secondaryText"in Ub?bb.description=Ub.secondaryText:"fullDescriptionLabel"in Ub&&(bb.description=Ub.fullDescriptionLabel)}}}Rhn(bb){this.fRb={};let Ub=0,Oa=0;for(const Fc of bb){bb=0;for(const xc of Fc.results)this.fRb[xc.value]=new w(xc.groupType,xc.type,xc.zfj,Ub,bb,Oa),bb++,Oa++,xc.label||5!==xc.type||this.vyo(xc);0<bb&&Ub++}}vcc(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(bb=xc.CommandValueId)&&window.open(bb,"_blank");return 32}k1a(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:InsertMention","actiondata comes null"),16;bb=xc.UILocation;let pd;xc=xc.CommandValueId;try{pd=Na.a(xc)}catch(lb){return this.Qe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return W.c(pd)?(this.Qe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):W.c(this.mrc)?(this.Qe.onError("TellMeActor:InsertMention",
"_iInsertContentHandler comes null"),16):19!==bb?(this.Qe.onError("TellMeActor:InsertMention","location "+bb+" is unexpected"),16):this.mrc.k1a(pd.displayName,pd.email,pd.userId)?32:(this.Qe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}yQa(bb,Ub,Oa,Fc,xc){return 1===Oa?32:W.c(xc)?(this.Qe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===xc.UILocation?this.phm(Oa,xc):this.vcc(bb,Ub,Oa,Fc,xc)}pIi(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.Zq&&window.setTimeout(()=>{this.Zq.execute(pd=>{pd.CGa("TellMeSurvey",null)})},fb.pgl);return 32}phm(bb,Ub){if(1===bb)return 32;if(W.c(Ub))return this.Qe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(W.c(this.mrc))return this.Qe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;bb=Ub.CommandValueId;return W.c(bb)?(this.Qe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.mrc.insertHtmlText(bb)?32:(this.Qe.onError("TellMeActor:InsertUrl",
"url is not inserted"),16)}vwa(bb,Ub,Oa,Fc,xc){Oa=window.performance.now();this.Rhn(Ub);this.Qe.eZn(Ub);this.oc.nq?(this.L8a=this.yDe.vql(Ub,bb,xc),this.oc.Xua?(this.nY.push(appChrome.actions.updateTellMeSearchResults(this.L8a.menuModel,bb,xc)),appChrome.api.dispatch(this.nY)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.L8a.menuModel,bb,xc)),this.oc.gie&&this.FTb&&(W.c(this.eZ)||this.eZ.Location!==Fa.a.contextMenu)&&(this.WJ.mark(2),this.WJ.measure(0,1,2))):this.Zya=this.Lah.wql(Ub,
this.Qe.Poa);this.GQb&&this.Gb.Xb(this.GQb);xc={};xc.GroupsCount=Ub.length;xc.QueryID=Fc;xc.QueryLength=bb.length;this.Qe.hA(z.a.CWk,window.performance.now()-Oa,xc)}M3k(bb,Ub){return Ub.startsWith(this.oc.nq?I.a.jbg:I.a.Hge)?5:bb?4:"bSearchHelp"===Ub||Ub.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ub||Ub.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ub?24:Ub===this.oc.Qcf?2:0}kF(bb,Ub){this.Rra&&this.Rra.kF(bb,Ub)}Zqi(bb,Ub,Oa,Fc,xc){if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){bb={};bb.SourceControlId=xc.SourceControlId;bb.Query=xc.CommandValueId;xc=this.ga.Ub(ab.a.rTc,2,bb);if(32!==xc)this.Qe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+xc+".");return xc}return this.ga.Ub(ab.a.rTc,2,xc)}cWd(bb,Ub,Oa,Fc,xc){({AddinResultsProvider:bb}=c(1597));if(1===Oa)return 32;if(W.c(xc))return this.Qe.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;Oa=xc.CommandValueId;if(W.b(Oa))return this.Qe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!bb.Qxb[Oa])return this.Qe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Oa+" doesn't not exist in entitlements"),16;xc=c(1597).AddinResultsProvider.Qxb[Oa];bb={};bb.solutionId=xc.id;bb.version=xc.appVersion;bb.storeType=xc.storeType;bb.storeId=xc.storeId;bb.assetId=xc.assetId;bb.assetStoreId=xc.assetStoreId;bb.displayName=xc.displayName;bb.targetType=
xc.targetType;bb.height=xc.height;bb.width=xc.width;xc=this.ga.Ub(ab.a.Usf,2,bb);if(32!==xc)this.Qe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+xc+". AssetId: "+Oa);return xc}$Mb(){if(!W.c(this.Zq))for(let bb of k.a.instance.Kfb()){if("ShowContextMenuWithFloatie"===bb.commandId)return this.Zq.execute(Ub=>{Ub.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(bb.commandId&&-1===bb.commandId.indexOf("Tab"))break}return 8}static get instance(){return fb._instance||
(fb._instance=new fb)}}fb._instance=null;fb.Mko="mso_tellMeService";fb.unknown="Unknown";fb.pgl=500;Object(D.a)(fb,"TellMeActor",null,[])},1458:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(1472);class e{constructor(a,k){this.p$a=!1;const {Annotations:m}=c(1453);if(!a)throw Error.argumentNull("annotations");if(!a.izf(k))throw Error.argument("memberTypeID","Invalid type ID");if(m.EH(k))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.aw=a;this.KUj=k;this.$o=
[]}get CZb(){return this.aw}get isReadOnly(){return this.p$a}get F3(){return this.KUj}get items(){return this.$o}Mca(){const {Annotations:a}=c(1453);let k="[";for(let m=0,w=this.items.length;m<w;++m){0<m&&(k+=", ");const v=this.aw.Mca(this.F3,this.items[m]);this.F3===a.b9?(k+='"',k+=l.a.lbf(v),k+='"'):k+=v}return k+"]"}isEqual(a){const {Annotations:k}=c(1453);if(this===a)return!0;if(!a||a.CZb!==this.aw||a.F3!==this.F3||a.items.length!==this.items.length)return!1;for(let m=0;m<this.items.length;++m)if(!k.Vob(this.F3,
this.items[m],a.items[m]))return!1;return!0}clone(){const a=new e(this.aw,this.F3);Array.addRange(a.items,this.items);return a}AS(){return this.isReadOnly?this.clone():this}eCf(){const {Annotations:a}=c(1453);if(!this.isReadOnly){this.p$a=!0;for(const k of this.items)a.iHb(k)}}toString(){return this.Mca()}}Object(D.a)(e,"ListValue",null,[1222,1224])},1459:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(D.a)(l,
"TellMeScenario",null,[])},1460:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k=null,m=null,w=4,v=-99999,r=0){this.fI="";this.vvd=-1;this.value=e;this.type=a;this.zfj=w;this.label=this.kC=k;this.groupType=28;this.description=m;this.score=v;this.count=r}}Object(D.a)(l,"ResultBinding",null,[])},1463:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.attributes=null;this.query=e;this.eo=[]}Lv(e){this.eo.push(e)}EVi(e){const a=[];for(const k of this.eo)k.groupType!==
e&&a.push(k);this.eo.length!==a.length&&(this.eo=a)}get q9b(){return!1}}Object(D.a)(l,"SimpleResultsUpdatedEventArgs",null,[1075])},1464:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e=28,a=""){this.qL=[];this.groupType=e;this.displayName=a}get results(){return this.qL}Ly(e){e.groupType=this.groupType;Array.add(this.results,e)}wXf(e=1){if(this.results.length>=e)for(let a=0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(l,"SimpleResultGroup",null,
[1076])},1472:function(D,L,c){D=c(0);class l{constructor(a,k){this.Acb=a;this.value=k}}Object(D.a)(l,"AttrValuePair",null,[]);c.d(L,"a",function(){return e});class e{constructor(a){this.p$a=!1;if(!a)throw Error.argumentNull("annotations");this.aw=a;this.IX=[]}get CZb(){return this.aw}get isReadOnly(){return this.p$a}get tpf(){return 0<this.IX.length}uq(a){if(!this.aw.$9b(a))throw Error.argument("attributeID","Invalid attribute ID");for(const k of this.IX)if(a===k.Acb)return a=k.value,{returnValue:!0,
value:a};return{returnValue:!1,value:null}}ny(a,k){var {Annotations:m}=c(1453);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.aw.$9b(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.aw.W8b(this.aw.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");m.iHb(k);for(m=0;m<this.IX.length;++m){const w=this.IX[m];if(a===w.Acb){w.value=k;return}}Array.add(this.IX,
new l(a,k))}lRa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.aw.$9b(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.IX.length;++k)if(a===this.IX[k].Acb){Array.removeAt(this.IX,k);break}}OHd(a){if(!a)throw Error.argumentNull("action");for(const k of this.IX)a(k.Acb,k.value)}clone(){const a=new e(this.aw);a.aZa(this);return a}aZa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");
if(!a)throw Error.argumentNull("other");if(a.CZb!==this.aw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.IX);a.OHd((k,m)=>{this.ny(k,m)})}Mca(){const {Annotations:a}=c(1453);let k="[",m=!0;for(const w of this.IX){m?m=!1:k+=", ";k+=this.aw.ESh(w.Acb);k+="=";const v=this.aw.getAttributeType(w.Acb),r=this.aw.Mca(v,w.value);v===a.b9?(k+='"',k+=e.lbf(r),k+='"'):k+=r}return k+"]"}isEqual(a){const {Annotations:k}=c(1453);if(!a)throw Error.argumentNull("other");if(this===a)return!0;
if(!a||this.aw!==a.CZb||this.tpf!==a.tpf)return!1;let m=0,w=null,v=!1;a.OHd((r,z)=>{++m;if(!v){var A=-1;for(let G=0,H=this.IX.length;G<H;++G)if(this.IX[G].Acb===r){A=G;break}0>A?v=!0:(w||(w=Array(this.IX.length)),w[A]=z)}});if(this.IX.length!==m||v)return!1;for(let r=0,z=this.IX.length;r<z;++r)if(!k.Vob(this.aw.getAttributeType(this.IX[r].Acb),this.IX[r].value,w[r]))return!1;return!0}AS(){return this.isReadOnly?this.clone():this}eCf(){const {Annotations:a}=c(1453);if(!this.isReadOnly){this.p$a=!0;
for(const k of this.IX)a.iHb(k.value)}}toString(){return this.Mca()}static lbf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(e,"FeatureBundle",null,[1221,1224])},1477:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.click="Click";l.o1a="InteractionBegin";l.REb="InteractionEnd";l.fxh="ControlActivated";l.query="Query";l.NPi="QueryIndexRecorded";l.iuh="Clicks";l.rbh="ActionEvents";l.jNh="FilteredActionEvents";l.P3i="SessionContext";
l.latency="Latency";l.performance="Performance";l.vXi="RenderedResults";l.events="Events";l.CWk="CreateResultsMenu";l.xG="UpdateRibbonControls";l.cMn="ResultsAggregation";l.qH="IssueQuery";l.uJk="CommandSuggestions";l.error="Error";l.UBf="LoadModelData";l.t2k="DepsResolveTime";l.kVm="ModelDataWaitTime";l.timedOut="TimedOut";l.ghk="AddinQueryCommandReady";l.zrl="GetAddinEntitlements";l.iPi="ProviderMRUEvents";l.hal="EnableAddinSearchCommands";Object(D.a)(l,"EventNames",null,[])},1480:function(D,L,
c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.EDf=null;this.oba=this.GDf=0}Oef(e,a,k){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>e.length)throw Error.argumentOutOfRange("length");if(a+k>e.length)throw Error.argument("Invalid start-length range");this.EDf=e;this.GDf=a;this.oba=k}Efb(e,a,k){this.Oef(e.EDf,e.GDf+a,k)}J(e){if(0>e||e>=this.oba)throw Error.argumentOutOfRange("index");return this.EDf[this.GDf+
e]}get count(){return this.oba}static c5e(e){const a=new l;a.Oef(e,0,e.length);return a}}Object(D.a)(l,"ReadOnlyList",null,[1248])},1485:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=
8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.Addin=
25]="Addin";e[e.OfficeScript=26]="OfficeScript";e[e.AddinStoreEntry=27]="AddinStoreEntry";e[e.None=28]="None";e[e.MergedActions=29]="MergedActions";e[e.MergedScopedSearches=30]="MergedScopedSearches";e[e.MergedSuggestedSearches=31]="MergedSuggestedSearches"})(l||(l={}));Object(D.b)("ResultGroupType",l)},1491:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1540);class l extends c.a{constructor(){super();this.info=this.tj=this.eventId=null}get ifa(){return"Misc"}pCb(){this.detail.Z("Type",
this.ifa);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.tj);this.detail.Z("Info",this.info);return this.detail}}Object(D.a)(l,"BasicMergeFailureDetail",c.a,[])},1492:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(621),e=c(797),a=c(1511);class k{constructor(m,w=!0){this.rm=w&&m?m.aH():m;this.YXb=new l.a}KB(m){this.YXb.add(e.a.zb(m))}A2n(m){this.YXb=m}Wxi(m){this.rm&&(new a.a(this.rm,m)).Joa.forEach((w,v)=>{v.qX&&!this.YXb.contains(w)&&(this.YXb.add(w),v.isDeleted?
(v=this.rm,v.hasProperty(e.a.QW(w))&&v.removeProperty(e.a.QW(w))):this.rm.Bxa(e.a.QW(w),v.newValue));return!0})}}Object(D.a)(k,"PartialMergeResult",null,[])},1493:function(D,L,c){c.r(L);c.d(L,"CommandResultsUtility",function(){return z});D=c(0);var l=c(1507),e=c(1477),a=c(1508),k=c(1460),m=c(1464),w=c(1457),v=c(1456),r=c(2);class z{static Y6c(A,G){if(G&&G.nq){const H={};for(const I of A)G.sVd(I)&&(H[I]=appChrome.selectors.getModelType(I));w.TellMeActor.instance.xG(H)}}static Yko(A){return A.startsWith("btnTellMeOfficeAddIn")}static gQc(A){const G=
w.TellMeActor.instance.VN();return!!G&&G.nq&&!appChrome.selectors.isControlDisabled(A)}static MXd(A,G,H,I){if(w.TellMeActor.instance.Qe&&A){const K=[];for(const F of A)K.push(String.format('{{"Id":"{0}","Score":{1}}}',F.commandId,F.score));A={};A[l.a.suggestions]="[{"+K.join(",")+"}]";A[l.a.Ppi]=G;A[l.a.groupType]=H;A[l.a.provider]=I;w.TellMeActor.instance.Qe.hA(e.a.uJk,window.performance.now(),A)}}static vyl(A,G){const H=[],I=[];for(const K of G){G=K.commandId;let F=K;K.commandId in A&&(G=A[K.commandId],
F=new a.a(G,K.score));Array.contains(I,G)||(H.push(F),I.push(G))}return H}static iMd(A,G,H,I,K,F,J,N){H.Ahf&&(G=z.vyl(H.Ahf,G));var O=v.a.Jwl(G);z.Y6c(O,H);var M=[],T=[];O=[];const R=new m.a(J);J=16===J||18===J||7===J||4===J?r.AFrameworkApplication.K?r.AFrameworkApplication.K.pc("TellMeMaxRecommendedResultsToReturn",3):3:0===J||17===J?5:0;for(const W of G)if(!z.nmm(W.commandId)){G=z.Yko(W.commandId);if(H.sVd(W.commandId)&&!G){if(v.a.Doi(W.commandId))continue;G=null;K&&F&&(G=K.mOl(W.commandId,F));
z.gQc(W.commandId)?Array.add(M,new k.a(W.commandId,5,G,null,N,W.score)):Array.add(T,new k.a(W.commandId,5,G,null,N,W.score))}else H.Xxb&&G&&I&&Array.add(O,W.commandId.substr(21));if(M.length+O.length>=J)break}H=0;for(K=0;K<M.length&&H<J;K++,H++)R.Ly(M[K]);for(M=0;M<T.length&&H<J;M++,H++)R.Ly(T[M]);for(T=0;T<O.length&&H<J;T++,H++)I.l1o(A,O[T],R);return R}static nmm(A){z.plh||(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.Sv("TellMeControlPredictionBlockList")&&r.AFrameworkApplication.K.XB("TellMeControlPredictionBlockList").forEach(G=>
{Array.add(z.olh,G.toLowerCase())}),z.plh=!0);return Array.contains(z.olh,A.toLowerCase())}static muf(A){return 2<A.length&&";"===A.charAt(0)&&";"===A.charAt(A.length-1)&&!!r.AFrameworkApplication.K&&(r.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static vUh(A){const G=new m.a(0);var H=A.split(";");A=w.TellMeActor.instance.VN();for(const I of H)if(0<I.length){H=I.split(":");
const K=2===H.length?H[0]:I;if(!A.sVd(K))break;if(1===H.length)H=new k.a(K,5,null,null,1),G.Ly(H);else if(2===H.length)H=new k.a(K,5,H[1],null,1),G.Ly(H);else break}return G}static sak(A,G,H){if(!(G&&G.results&&A&&A.results&&A.results.length))return{returnValue:!1,xSe:A,kTe:G};const I=[];for(var K of G.results)Array.add(I,K.value);K=0;const F=0<G.results.length?G.results[0].score:0;for(const J of A.results)if(J.score>H&&!Array.contains(I,J.value)&&z.gQc(J.value)&&(0<F&&(J.score=F),Array.insert(G.results,
K,J),K++),2===K)break;return 0<K?(H=G.results.length-5,0<H&&G.wXf(H),{returnValue:!0,xSe:A,kTe:G}):{returnValue:!1,xSe:A,kTe:G}}}z.plh=!1;z.olh=[];Object(D.a)(z,"CommandResultsUtility",null,[])},1494:function(D,L,c){function l(a){return new Promise((k,m)=>{try{a.execute(w=>k(w))}catch(w){m(w)}})}function e(a){var k;return null===(k=null===a||void 0===a?void 0:a.split("\\",3))||void 0===k?void 0:k.pop()}c.d(L,"b",function(){return l});c.d(L,"a",function(){return e})},1506:function(D,L,c){c.d(L,"a",
function(){return l});D=c(0);class l{static Mmo(e){return e.toString().charCodeAt(0)}static Ywm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static tjh(e,a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static sjh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.CXi(e);a=l.CXi(a);return e===a}static CXi(e){return e.replace(l.KUc," ")}static Fnb(e,a,k){return e.substring(a,a+k)}}l.KUc=RegExp("\u00a0","g");Object(D.a)(l,"CharUtils",
null,[])},1507:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.appName="AppName";l.P$="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture="Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.fna="CorrelationID";l.ien="ParentUiElement";l.query="Input";l.eKb="QueryID";l.SPi="QueryLength";l.Gdc="QueryIndex";l.dMn="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.lmj=
"UiElement";l.l7d="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.vno="TokenAcquired";l.EBm="LatencyType";l.groupName="GroupName";l.k7="GroupIndex";l.groupType="GroupType";l.ZLn="ResultInfoList";l.resultType="ResultType";l.i8f="SubResultType";l.Bqm="IsInputBlur";l.Cqm="IsInputFocus";l.hwm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.u9k="DwellTime";l.Ppi="IsZeroTerm";l.WJo="WordsCount";l.GUd="IsSearchUxEnabled";l.xxm="IsTellMeInHeaderEnabled";
l.module="Module";l.resultIndex="ResultIndex";l.i9e="DisplayIndex";l.pal="EnableList";l.provider="Provider";l.contentType="ContentType";l.Kvm="IsSelectionBased";l.$qk="BeginPerformanceMarker";l.Lal="EndPerformanceMarker";l.mgn="PerformanceMeasure";Object(D.a)(l,"Columns",null,[])},1508:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.commandId=e;this.score=a}}Object(D.a)(l,"CommandSuggestion",null,[])},1511:function(D,L,c){D=c(0);var l=c(412),e=c(797),a=c(231),
k=c(52);class m{constructor(v,r,z){this.JZj=v;this.aWj=r;this.vVj=z;this.Aye=new a.a(Object(k.a)(this,this.tDk,"checkIfDifferent"))}get Flb(){return this.JZj}get oldValue(){return this.aWj}get newValue(){return this.vVj}get cib(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get qX(){return this.cib||this.isDeleted||this.Aye.value}tDk(){return this.cib||
this.isDeleted?!0:!e.a.zjh(this.Flb,this.oldValue,this.newValue)}}Object(D.a)(m,"PropertyDiff",null,[]);c.d(L,"a",function(){return w});class w{constructor(v,r){this.YVj=v;this.sVj=r;this.Aye=new a.a(()=>this.pQc());this.LZj=new a.a(Object(k.a)(this,this.sdl,"evaluatePropertyDiffs"))}get Eu(){return this.YVj}get Af(){return this.sVj}get cib(){return!!this.Af&&!this.Eu}get isDeleted(){return!this.Af&&!!this.Eu}get qX(){return this.cib||this.isDeleted||this.Aye.value}get Joa(){return this.LZj.value}pQc(v=
null){let r=!1;this.Joa.forEach((z,A)=>{r=A.qX&&(!v||7!==v.J(z));return!r});return r}sdl(){const v=new l.a;var r=this.Af,z=this.Eu;if(this.cib){z=r.Aj();for(var A=0;A<z.length;A++){var G=z[A];v.Z(e.a.zb(G),new m(G,null,r.cQ(G)))}}else if(this.isDeleted)for(r=z.Aj(),A=0;A<r.length;A++)G=r[A],v.Z(e.a.zb(G),new m(G,z.cQ(G),null));else{A=z.Aj();for(G=0;G<A.length;G++){var H=A[G],I=e.a.zb(H),K=z.cQ(H);const F=r.hasProperty(H)?r.cQ(H):null;v.Z(I,new m(H,K,F))}A=r.Aj();for(G=0;G<A.length;G++)H=A[G],z.hasProperty(H)||
(I=e.a.zb(H),K=r.cQ(H),v.Z(I,new m(H,null,K)))}return v}}Object(D.a)(w,"MergeableObjectDiff",null,[])},1519:function(D,L,c){c.d(L,"b",function(){return m});c.d(L,"a",function(){return v});var l=c(228),e=c(412),a=c(621),k=c(1660);const m=(z,A,G)=>{const H=w(z,A,G);let I=0,K=0,F=0,J=new k.a;const N=new l.a;for(let O=0;O<H.length;O++){const M=H.ig(O+1);J.Lvd(z.ig(I));J.Nvd(A.ig(K));J.Rvd(G.ig(F));I++;K++;for(F++;I<z.length&&(!M||!M.equals(z.ig(I)));)J.Lvd(z.ig(I)),I++;for(;K<A.length&&(!M||!M.equals(A.ig(K)));)J.Nvd(A.ig(K)),
K++;for(;F<G.length&&(!M||!M.equals(G.ig(F)));)J.Rvd(G.ig(F)),F++;N.add(J);J=new k.a}for(;I<z.length;)J.Lvd(z.ig(I)),I++;for(;K<A.length;)J.Nvd(A.ig(K)),K++;for(;F<G.length;)J.Rvd(G.ig(F)),F++;J.isEmpty||N.add(J);return N},w=(z,A,G)=>{const H=new l.a,I=A.tG(),K=G.tG();z.forEach(F=>{I.contains(F)&&K.contains(F)&&H.add(F);return!0});return H},v=(z,A,G)=>{z=z||new l.a;A=A||new l.a;G=G||new l.a;const H=new l.a,I=new e.a(0),K=new a.a;for(var F=0;F<z.length;F++){var J=z.ig(F);I.Z(J,F)}for(z=F=0;F<A.length&&
z<G.length;){J=A.ig(F);let N=G.ig(z),O=I.Ty(J,-1),M=I.Ty(N,-1);-1===O?(r(K,H,J),F++):-1===M?(r(K,H,N),z++):O===M?(r(K,H,J),F++,z++):O<M?F++:z++}for(;F<A.length;F++)J=A.ig(F),-1===I.Ty(J,-1)&&r(K,H,J);for(;z<G.length;z++)A=G.ig(z),-1===I.Ty(A,-1)&&r(K,H,A);return H},r=(z,A,G)=>{z.contains(G)||(A.add(G),z.add(G))}},1520:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(61);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(D.a)(e,"LcsUpdateHint",null,[1306,85])},1521:function(D,
L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Gdc="QueryIndex";l.phj="TellMeRanker";l.qhj="TellMeRankerLogging";Object(D.a)(l,"Services",null,[])},1522:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.tOa="HttpRequest";l.provider="Provider";Object(D.a)(l,"LatencyTypes",null,[])},1525:function(D,L,c){D=c(0);var l=c(17),e=c(7),a=c(228),k=c(152),m=c(201),w=c(61),v=c(621),r=c(52),z=c(251),A=c(1540);class G extends A.a{constructor(){super();
this.oLb=null}get ifa(){return"CreateMergeBlock"}pCb(){this.detail.Z("Type",this.ifa);this.detail.Z("Revision",this.oLb);return this.detail}}Object(D.a)(G,"CreateMergeBlockFailureDetail",A.a,[]);var H=c(1580),I=c(1582),K=c(1659),F=c(1541),J=c(1492),N=c(1719);c.d(L,"a",function(){return O});class O{static MBd(M,T,R,W,V,ba,ha){let ca;ca="";const ia=new a.a;for(let da=0;da<R.length;da++){var ra=void 0;let za;ra=H.a.Nyl(T,R.J(da),W,V,ba,ha,M);if(!ra)return{returnValue:null,$2a:ca};({KEf:za,$2a:ra}=ra.B_h());
if(!za)return{returnValue:null,$2a:ca};ca+=ra;ia.VA(ia.length,za)}return{returnValue:ia,$2a:ca}}static gAh(M,T,R,W,V,ba,ha,ca){let ia,ra,da,za,la,na;na=la=za=da=ra=ia=null;({$2a:za,returnValue:ia}=O.MBd(T,Ca=>M.runtime.nk.J(Ca),R,1,ba,ha,ca));if(!ia)return k.a.instance.Sa(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),M.logger.Vg(Object.assign(new G,{oLb:"Base"})),{returnValue:!1,gK:ia,uIc:ra,S6c:da,
Ewd:za,rGd:la,bhe:na};({$2a:la,returnValue:ra}=O.MBd(T,Ca=>M.runtime.uu.J(Ca)||M.runtime.nk.J(Ca),W,2,ba,ha,ca));if(!ra)return k.a.instance.Sa(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),M.logger.Vg(Object.assign(new G,{oLb:"Favored"})),{returnValue:!1,gK:ia,uIc:ra,S6c:da,Ewd:za,rGd:la,bhe:na};({$2a:na,returnValue:da}=O.MBd(T,Ca=>M.runtime.vq.J(Ca)||M.runtime.nk.J(Ca),V,4,ba,ha,ca));return da?
{returnValue:!0,gK:ia,uIc:ra,S6c:da,Ewd:za,rGd:la,bhe:na}:(k.a.instance.Sa(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),M.logger.Vg(Object.assign(new G,{oLb:"Unfavored"})),{returnValue:!1,gK:ia,uIc:ra,S6c:da,Ewd:za,rGd:la,bhe:na})}static guh(M,T=!1){const R=new a.a;let W=0;for(;W<M.length;){var V=M.J(W);if(1===V.type||4===V.type||2===V.type)R.add(V),W++;else if(3===V.type){let ha="";ha+=
V.character;W++;let ca=V.hPa,ia=!1;for(;W<M.length;W++){var ba=M.J(W);3===ba.type?V.runId===ba.runId&&V.xI.equals(ba.xI)&&(V.Iaa===ba.Iaa||V.vDa===ba.vDa)&&V.NE.bA(ba.NE)&&(!T||V.Mt&&V.Mt.equals(ba.Mt))?(ha+=ba.character,ba.hPa&&(ca=!0)):ia=!0:ia=!0;if(ia){V=new N.a(null,V.source,V.Jj,V.Bg,V.runId,V.xI,ha,V.gkb,!0,ca,V.Iaa,V.vDa,V.UQa,V.NE,V.Mt);R.add(V);break}}}}k.a.instance.Sa(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",R.Oq());return R}static lJk(M,
T=!1){const R=new a.a;let W=0;for(;W<M.length;){var V=M.J(W);if(1===V.type||4===V.type||2===V.type)R.add(V),W++;else if(3===V.type){let ha=V.character.toString();W++;let ca=V.hPa;for(;W<M.length;W++){var ba=M.J(W);if(3===ba.type&&O.z6n(V,ba,T))ha+=ba.character,ba.hPa&&(ca=!0);else break}V=new N.a(null,V.source,V.Jj,V.Bg,V.runId,V.xI,ha,V.gkb,!0,ca,V.Iaa,V.vDa,V.UQa,V.NE,V.Mt);R.add(V)}}k.a.instance.Sa(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",R.Oq());
return R}static z6n(M,T,R){return M.runId===T.runId&&M.xI.equals(T.xI)&&(M.Iaa===T.Iaa||M.vDa===T.vDa)&&M.NE.bA(T.NE)&&(!R||!!M.Mt&&M.Mt.equals(T.Mt))}static p0n(M,T,R,W,V,ba,ha,ca,ia,ra,da,za,la,na,Ca,Na){M.setPropertyString(R.rm,l.a.Co,V);M.setPropertyUint32(R.rm,e.a.Pc,W);M.setPropertyUint32s(R.rm,e.a.Sq,ba);M.setPropertyUint32s(R.rm,e.a.rt,ha);M.setPropertyObjectIds(R.rm,l.a.An,ia);M.hasProperty(R.rm,e.a.wj)&&M.setPropertyUint32(R.rm,e.a.wj,O.bql());T&&T(10)&&M.setPropertyObjectIds(R.rm,e.a.ov,
Na);W=!1;for(V=0;V<ra.length;V++)if(ra.J(V)){W=!0;break}W&&M.setPropertyBools(R.rm,e.a.DIf,ra);O.Yxk(T,M,R,da,za,la,na);O.Zxk(M,R,Ca);R.KB(l.a.Co);R.KB(e.a.Pc);R.KB(e.a.Sq);R.KB(e.a.rt);R.KB(l.a.An);R.KB(e.a.DIf);R.KB(l.a.vm);R.KB(l.a.vnb);R.KB(e.a.cOa);R.KB(e.a.IFa);R.KB(l.a.iwa);R.KB(e.a.ov);M.hasProperty(R.rm,e.a.wj)&&R.KB(e.a.wj);0<ca.length?M.setPropertyUint32s(R.rm,l.a.vm,ca):R.rm.removeProperty(l.a.vm)}static Yxk(M,T,R,W,V,ba,ha){if(M(100)){M=W.contains(!0,(ca,ia)=>ia);O.$2f(T,R,l.a.iwa,M?
W:null);O.$2f(T,R,l.a.vnb,O.hZi(W,V));O.$2f(T,R,e.a.cOa,O.hZi(W,ba));W=!1;for(V=0;V<ha.length;V++)0!==ha.J(V)&&(W=!0);W?T.setPropertyUint32s(R.rm,e.a.IFa,ha):R.rm.removeProperty(e.a.IFa)}}static Zxk(M,T,R){const W=ha=>ha;var V=Object(r.a)(M,M.setPropertyBools,"setPropertyBools");O.SLa(T,R.Vhb,W,V,e.a.SDa);O.SLa(T,R.meb,W,V,e.a.Wea);O.SLa(T,R.$3a,W,V,e.a.HFa);V=ha=>0<ha.length;var ba=Object(r.a)(M,M.setPropertyStrings,"setPropertyStrings");O.SLa(T,R.Uhb,V,ba,e.a.TDa);O.SLa(T,R.leb,V,ba,e.a.qCa);O.SLa(T,
R.Alb,V,ba,e.a.fHa);V=ha=>!!ha;ba=Object(r.a)(M,M.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");O.SLa(T,R.Whb,V,ba,e.a.UDa);O.SLa(T,R.BZa,V,ba,e.a.rCa);O.SLa(T,R.Clb,V,ba,e.a.gHa);R.$3a.any(W)?O.SLa(T,R.Blb,()=>!0,Object(r.a)(M,M.setPropertyObjectIds,"setPropertyObjectIds"),e.a.Yxa):T.rm.removeProperty(e.a.Yxa)}static hZi(M,T){const R=new a.a;let W=!1;for(let V=0;V<M.length;V++){const ba=T.J(V)&&!M.J(V);R.add(ba);W=ba||W}return W?R:null}static $2f(M,T,R,W){W?M.setPropertyBools(T.rm,
R,W):T.rm.removeProperty(R)}static bql(){return m.a.lG()}static y0h(M,T){return M.runtime.uu.Ty(T,M.runtime.nk.J(T)||M.runtime.vq.get(T))}static uLc(M,T,R,W,V){let ba;ba=new a.a;const ha=!!R&&R(10);if(M.runtime.$b.isFeatureEnabled(76)){var ca=O.lJk(W,ha);var ia=O.guh(W,ha);ca.length!==ia.length&&M.runtime.$b.ez(76)}else ca=O.guh(W,ha);ia=0;let ra="",da=new a.a,za=new a.a,la=new a.a,na=new a.a,Ca=new a.a,Na=new a.a,Ta=new a.a,Fa=new a.a,qa=new a.a;const ja=new K.a;let X=new a.a;var ua=ca.J(ca.length-
1);if(2!==ua.type&&4!==ua.type)return k.a.instance.Sa(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",ua.type),M.logger.Vg(Object.assign(new F.a,{tj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",ua.type)})),{returnValue:!1,R3d:ba};var Ha=0;for(ua=0;ua<ca.length;ua++){var Ea=ca.J(ua),wa=null;if(1===Ea.type||3===Ea.type)wa=Ea,ra+=wa.text;else if(4===Ea.type){Ea=
O.y0h(M,Ea.Jj);Ea=new J.a(Ea);ba.add(Ea);continue}wa?(da.add(wa.runId),za.add(wa.Bg),Ha+=wa.text.length,la.add(Ha),na.add(wa.xI),Ca.add(wa.gkb),Na.add(wa.hPa),Ta.add(wa.Iaa),Fa.add(wa.vDa),qa.add(wa.UQa),ja.Vhb.add(wa.NE.m6l),ja.meb.add(wa.NE.P5l),ja.$3a.add(wa.NE.O6l),ja.Uhb.add(wa.NE.insertion.author),ja.leb.add(wa.NE.deletion.author),ja.Alb.add(wa.NE.GFa.author),ja.Whb.add(wa.NE.insertion.gVc),ja.BZa.add(wa.NE.deletion.gVc),ja.Clb.add(wa.NE.GFa.gVc),ja.Blb.add(wa.NE.GFa.RRf),ha&&X.add(wa.Mt)):
da.length||(da.add(0),za.add(0),la.add(0),na.add(w.a.nil),Ca.add(!1),Na.add(!1),Ta.add(!1),Fa.add(!1),qa.add(0),ja.Vhb.add(!1),ja.meb.add(!1),ja.$3a.add(!1),ja.Uhb.add(""),ja.leb.add(""),ja.Alb.add(""),ja.Whb.add(0),ja.BZa.add(0),ja.Clb.add(0),ja.Blb.add(w.a.nil));if(2===Ea.type){Ha=Ea;Ea=Ha.Pc;la.FF(la.length-1);wa=V.J(ia);if(!wa)return k.a.instance.Sa(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ia,V.length,W.length,ua,ca.length),M.logger.Vg(Object.assign(new F.a,{tj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.tia(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",V.Oq()),k.a.instance.tia(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",W.Oq()),k.a.instance.tia(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ca.Oq()),{returnValue:!1,R3d:ba};if(wa=O.y0h(M,wa))wa=new J.a(wa.aH()),O.p0n(T,R,wa,
Ha.Pc,ra,da,za,la,na,Ca,Na,Ta,Fa,qa,ja,X),ba.add(wa);k.a.instance.Sa(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ha.Jj,Ea,da.Oq(),za.Oq(),la.Oq(),Na.Oq(),Ta.Oq(),Fa.Oq(),na.Oq(),"",qa.Oq());ia++;ra="";da=new a.a;za=new a.a;la=new a.a;na=new a.a;Ca=new a.a;Na=new a.a;Ta=new a.a;Fa=new a.a;qa=new a.a;ja.reset();Ha=
0;X=new a.a}}return{returnValue:!0,R3d:ba}}static SKn(M,T){const R=M.runtime.Ym.J(z.a.VK),W=T.getPropertyObjectIds(R.rm,e.a.v0);for(let V=0;V<W.length;V++)M.runtime.Ym.remove(W.J(V));T.setPropertyObjectIds(R.rm,e.a.v0,new a.a);T.setPropertyString(R.rm,e.a.YSa,w.a.nil.toString());R.KB(e.a.v0);R.KB(e.a.YSa)}static Mem(M,T){if(M.runtime.Ym.ub(z.a.VK))return null;const R=new J.a(M.runtime.nk.J(z.a.VK).aH());T.setPropertyString(R.rm,e.a.YSa,M.output.gM.last().id.toString());T.setPropertyObjectIds(R.rm,
e.a.v0,new a.a);R.KB(e.a.v0);R.KB(e.a.YSa);M.runtime.Ym.Z(z.a.VK,R);return R}static skf(M){const T=new a.a;M.forEach(R=>{T.add(R.id);return!0});return T}static dac(M,T,R,W){let V=0;R.forEach(ba=>{I.a(ba,T+V++,1);393230===ba.Rc&&M.getPropertyObjectIds(ba,l.a.An).forEach(ha=>{W.add(ha);return!0});return!0})}static jJm(M,T){const R=new v.a;let W=0;T.forEach(V=>{if(R.contains(V))return!0;R.add(V);if(({index:W}=O.uCf("BaseFormatting_",W,V,ba=>M.runtime.nk.J(ba))).returnValue||({index:W}=O.uCf("FavoredFormatting_",
W,V,ba=>M.runtime.uu.J(ba))).returnValue||({index:W}=O.uCf("ConflictingFormatting_",W,V,ba=>M.runtime.vq.J(ba))).returnValue)return!0;W++;return!0})}static uCf(M,T,R,W){if(R=W(R))if(I.a(R,M+T,1),1179649===R.Rc)return T++,{returnValue:!0,index:T};return{returnValue:!1,index:T}}static O9e(M){return!!M.runtime.nk.J(z.a.VK)}static SLa(M,T,R,W,V){T.any(R)?(W(M.rm,V,T),M.KB(V)):M.rm.removeProperty(V)}static n7i(M,T){const R=new a.a;R.add(0);const W=M?M.length:0;for(let V=0;V<W;V++)R.insert(V+1,M.ig(V));
R.insert(R.length,T);return R}}Object(D.a)(O,"ParagraphMergeUtils",null,[])},1538:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(228);class e{constructor(a,k,m){this.xm=null;this.nl=a;this.source=k;this.Jj=m}get type(){return this.nl}get U5a(){return!1}get opm(){return 1===(this.source&1)}get ppm(){return 2===(this.source&2)}get qpm(){return 4===(this.source&4)}B3(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.Ztl(),this.s4b())}Ztl(){let a="";this.opm&&
(a+="Base");this.ppm&&(a+="FavoredUpdate");this.qpm&&(a+="UnfavoredUpdate");return a}s4b(){return""}bA(a){return this.type===a.type}A4c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(D.a)(e,"AMergeBlock",null,[103,104])},1539:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1538);class l extends c.a{constructor(e,a,k){super(2,e,a);this.Pc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Pc,this.Jj)}s4b(){return"Eop"}clone(){return new l(this.source,
this.Jj,this.Pc)}bA(e,a,k,m=!1,w=!0){return super.bA(e,a,k,m)?w?e.Pc===this.Pc:e.Jj===this.Jj&&e.Pc===this.Pc:!1}get length(){return 1}}Object(D.a)(l,"EopMergeBlock",c.a,[])},1540:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(412);class e{constructor(){this.detail=new l.a}}Object(D.a)(e,"AMergeFailureDetail",null,[2009])},1541:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1491);class l extends c.a{constructor(){super()}get ifa(){return"ParagraphMerge"}}Object(D.a)(l,
"ParagraphMergeFailureDetail",c.a,[])},1542:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1491);class l extends c.a{constructor(){super()}get ifa(){return"RdOpLcs"}}Object(D.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1543:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1491);class l extends c.a{constructor(){super()}get ifa(){return"TableMerge"}}Object(D.a)(l,"TableMergeFailureDetail",c.a,[])},1547:function(D,L,c){D=c(0);class l{constructor(){this.X5c=this.gPc=null;this.qEf=
this.score=this.MUc=0}BPf(H,I,K){this.score=H.J(I);++I;this.gPc=H.J(I)?K.rma(H.J(I)):null;++I;this.X5c=H.J(I)?K.rma(H.J(I)):null;++I;this.MUc=H.J(I);++I;this.qEf=H.J(I);++I;return I}}Object(D.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(H,I,K,F,J){this.rfb=H;this.count=I;this.mHd=K;this.LN=F;this.depth=J}}Object(D.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1595),k=c(1677);class m{constructor(H=null,I=0,K=0,F=0){this.N5j=H||new k.a;this.tua=I;this.LN=K;this.depth=F}get F4(){return this.N5j}getKey(){return this.F4.nx.toString()+
":"+this.tua.toString()}}Object(D.a)(m,"TrieBookmark",null,[]);class w{constructor(H,I){this.TPa=H;this.yDf=I}YOm(H){if(null==H)throw Error.argumentNull("prefix");let I={};var K=I[""]=new m;this.QPd(K,I);for(K=0;K<H.length;++K){const F=H.charCodeAt(K),J={};for(let N in I)this.aik(F,I[N],J);I=J}return this.hpo(I)}QPd(H,I){if(!(H.LN>=this.yDf)&&(H=new m(a.a.N0e(H.F4),H.tua,H.LN+1,H.depth),H.F4.ZE&a.a.u7a&&(H.tua+=1),this.TPa.iOb(H.F4))){H.depth+=1;let K=!0;for(;K;)w.Hhe(H,I),this.QPd(H,I),H.tua+=this.TPa.H4b(H.F4,
!0)+(H.F4.ZE&a.a.u7a?1:0),K=this.TPa.r6c(H.F4)}}aik(H,I,K){I.LN+1<=this.yDf&&(I.LN+=1,w.Hhe(I,K),--I.LN);I.F4.ZE&a.a.u7a&&(I.tua+=1);if(this.TPa.iOb(I.F4)){I.depth+=1;let F=!0;for(;F;)I.F4.lPb===H?(w.Hhe(I,K),this.QPd(I,K)):I.LN+1<=this.yDf&&(I.LN+=1,w.Hhe(I,K),this.QPd(I,K),--I.LN),I.tua+=this.TPa.H4b(I.F4,!0)+(I.F4.ZE&a.a.u7a?1:0),F=this.TPa.r6c(I.F4)}}hpo(H){const I=[];for(var K in H){const F=H[K];if(!F.F4.nx)continue;const J=!!(F.F4.ZE&a.a.u7a),N=this.TPa.H4b(F.F4,!1)+(J?1:0);Array.add(I,new e(F.tua,
N,J,F.LN,F.depth))}I.sort((F,J)=>{let N=F.rfb-J.rfb;return N||(N=-(F.count-J.count))?N:N=F.depth-J.depth});if(2>I.length)return I;H=[];for(K=0;K<I.length;)K+=w.Wjj(K,I,H);return H}static Hhe(H,I){const K=H.getKey();K in I?(I=I[K],I.LN=Math.min(I.LN,H.LN)):I[K]=new m(a.a.N0e(H.F4),H.tua,H.LN,H.depth)}static Wjj(H,I,K){const F=I[H];let J=F.rfb;const N=J+F.count;let O=1,M=F.mHd;for(;H+O<I.length&&I[H+O].rfb<N;){const T=I[H+O];T.rfb>J&&(Array.add(K,new e(J,T.rfb-J,M,F.LN,F.depth)),M=!1);O+=w.Wjj(H+O,
I,K);J=T.rfb+T.count}J<N&&Array.add(K,new e(J,N-J,M,F.LN,F.depth));return O}}Object(D.a)(w,"ErrorTolerantTrieLookupEngine",null,[1287]);class v extends l{constructor(H,I,K){super();this.nci=this.kIi=!1;this.OKh=null;if(H){var F=0;try{F=this.BPf(H,F,I);this.kIi=1===H.J(F);++F;this.nci=1===H.J(F);++F;const J=H.J(F);this.OKh=this.Den(K,J)}catch(J){throw Error.argument("initData");}}}Den(H,I){return new w(H,I)}}Object(D.a)(v,"FuzzyMatchTokenStringGeneratorInit",l,[]);class r extends l{constructor(H,I){super();
this.query=this.name=null;if(H){this.annotations=I.annotations;var K=0;try{K=this.BPf(H,K,I),this.name=I.vE(H.J(K)),++K,this.query=I.pK(H.J(K))}catch(F){throw Error.argument("initData");}}}}Object(D.a)(r,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(H,I){super();if(H)try{this.BPf(H,0,I)}catch(K){throw Error.argument("initData");}}}Object(D.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var A=c(1480);c.d(L,"a",function(){return G});class G{constructor(H){this.oDf=H}get gPc(){return this.oDf.gPc}get X5c(){return this.oDf.X5c}get MUc(){return this.oDf.MUc}static create(H,
I,K){const {SurfaceStringTokenStringGenerator:F}=c(1821),{QueryTokenStringGenerator:J}=c(1822),{FuzzyMatchTokenStringGenerator:N}=c(1823);let O=0;try{if(H.J(O)!==G.wyb)throw Error.argument("initData","Input does not represent a token string generator");++O;const M=H.J(O);++O;const T=new A.a;T.Efb(H,O,H.count-O);switch(M){case F.xCc:return new F(new z(T,I));case J.xCc:return new J(new r(T,I));case N.xCc:return new N(new v(T,I,K));default:throw Error.argument("initData");}}catch(M){throw Error.argument("initData");
}}static eeh(H,I,K,F,J,N){H=H.Ano.getId(I,null);if(0>H)return++N,N;G.feh(H,K,F,J);return N}static feh(H,I,K,F){Array.add(F.Y7f,H);Array.add(F.kfj,I);++F.Uic[K]}}G.wyb=1099767983;Object(D.a)(G,"TokenStringGenerator",null,[1265])},1579:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(228);L=c(1538);var e=c(1506);class a extends L.a{constructor(k,m,w){super(k,m,w)}Hdo(k){let m;m=null;if(!this.text||!this.U5a||0>=k||k>=this.length)return{returnValue:!1,Kdj:m};m=new l.a;const w=this.clone();
w.j3c(e.a.Fnb(this.text,0,k));const v=this.clone();v.j3c(e.a.Fnb(this.text,k,this.length-k));m.add(w);m.add(v);return{returnValue:!0,Kdj:m}}B3(){return!0}get length(){return this.text.length}}Object(D.a)(a,"ATextMergeBlock",L.a,[])},1580:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(152);class e{lVe(a,k){return a+("[Block: "+k+"] ")}static Nyl(a,k,m,w,v,r,z){const {ParagraphMergeBlockCreator:A}=c(1888),{TableMergeBlockCreator:G}=c(1891);if(393230===k.Rc)return new A(a,k,m,v,r,w(10),
z);if(393250===k.Rc)return new G(k,m);l.a.instance.Sa(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Rc);return null}}Object(D.a)(e,"MergeBlockCreator",null,[])},1581:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(7),e=c(61);L=c(1579);var a=c(1511);class k extends L.a{constructor(m,w,v,r,z,A,G,H,I,K,F,J,N,O){super(w,v,r);this.Bg=z;this.runId=A;this.gkb=H;this.DMj=G;this.mme=m;this.hPa=I;this.Iaa=K;this.vDa=F;this.UQa=J;this.NE=N;this.Mt=O}get UAc(){return this.mme}get xI(){return this.DMj}get MBb(){return this.UAc(this.xI)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.Bg,this.runId,this.gkb,this.Jj,this.xI.toString(),this.Mt?this.Mt.toString():"NULL")}bA(m,w,v,r=!1){if(!super.bA(m,w,v,r))return!1;if(r)return!0;if(!this.NE.bA(m.NE)||this.Mt&&!this.Mt.equals(m.Mt))return!1;if(this.xI.equals(m.xI)||this.xI.equals(e.a.nil)||m.xI.equals(e.a.nil))return!0;m=new a.a(this.MBb,m.MBb);w=w.Izh(this.MBb,v);return m.pQc(w.w5d)?!1:!0}get okm(){return this.B3()&&"\ufffc"===this.text&&this.MBb?this.MBb.hasProperty(l.a.Qq)||1179725!==this.MBb.Rc?!0:!1:!1}}
Object(D.a)(k,"AUserRunMergeBlock",L.a,[])},1582:function(D,L,c){c.d(L,"a",function(){return e});var l=c(152);const e=(a,k,m=4)=>{a?l.a.instance.tia(4273285,m,4,k,a.Q5c()):l.a.instance.Sa(4293845,m,1,k,"{0}: Node was null.",k)}},1583:function(D,L,c){c.d(L,"e",function(){return w});c.d(L,"a",function(){return v});c.d(L,"d",function(){return r});c.d(L,"b",function(){return z});c.d(L,"c",function(){return A});var l=c(7),e=c(17),a=c(61),k=c(1012),m=c(1519);const w=(I,K,F)=>{const J=new k.a;let N=a.a.nil;
K=J.getPropertyObjectId(K,l.a.Onb);K.equals(a.a.nil)||(I=I.runtime.nk.J(K),F&&(I=F.Ty(K,I)),I&&(N=J.getPropertyObjectId(I,l.a.Onb)));return N},v=(I,K,F,J,N)=>{const O=new k.a;let M=null;var T=O.getPropertyObjectId(F,l.a.Onb);T!==a.a.nil&&(M=I.runtime.nk.J(T),K&&(M=K.Ty(T,M)));if(M){T=O.getPropertyObjectIds(M,e.a.gf);for(N=0;N<T.length&&!T.J(N).equals(F.id);N++);N===T.length&&(N=-1)}F=w(I,F,K);if(!F.equals(a.a.nil)&&(I=I.runtime.nk.J(F),K&&(I=K.Ty(F,I)),I)){K=O.getPropertyObjectIds(I,e.a.gf);for(J=
0;J<K.length&&!K.J(J).equals(M.id);J++);J===K.length&&(J=-1)}return{rowIndex:J,z0b:N}},r=(I,K,F,J,N)=>{var O=new k.a;let M=null;var T=I.runtime.nk.J(F);K&&(T=K.Ty(F,T));if(!T)return null;T=O.getPropertyObjectIds(T,e.a.gf);F=null;J<T.length&&(J=T.J(J),F=I.runtime.nk.J(J),K&&(F=K.Ty(J,F)));F&&(O=O.getPropertyObjectIds(F,e.a.gf),N<O.length&&(N=O.J(N),M=I.runtime.nk.J(N),K&&(M=K.Ty(N,M))));return M},z=(I,K,F)=>{let J,N;N=J=-1;const O=(new k.a).getPropertyObjectId(F,l.a.Onb);var M=w(I,F,K);if(M.equals(a.a.nil)||
O.equals(a.a.nil))return{rowIndex:J,z0b:N};K=I.runtime.f9f;var T=K.J(M);if(!T){T=G(I,M);if(!T)return{rowIndex:J,z0b:N};K.Z(M,T)}for(M=0;M<T.length;M++)if(T.J(M).equals(O)){J=M;break}T=K.J(O);if(!T){T=H(I,O);if(!T)return{rowIndex:J,z0b:N};K.Z(O,T)}for(I=0;I<T.length;I++)if(T.J(I).equals(F.id)){N=I;break}return{rowIndex:J,z0b:N}},A=(I,K,F,J)=>{if(0>F||0>J)return a.a.nil;new k.a;const N=I.runtime.f9f;let O=N.J(K);if(!O){O=G(I,K);if(!O)return a.a.nil;N.Z(K,O)}if(F<O.length)K=O.J(F);else return a.a.nil;
F=N.J(K);if(!F){F=H(I,K);if(!F)return a.a.nil;N.Z(K,F)}if(J<F.length)I=F.J(J);else return a.a.nil;return I},G=(I,K)=>{var F=new k.a;const J=I.runtime.nk.J(K);if(J){var N=I.runtime.uu.Ty(K,J);I=I.runtime.vq.Ty(K,J);K=F.getPropertyObjectIds(J,e.a.gf);N=F.getPropertyObjectIds(N,e.a.gf);F=F.getPropertyObjectIds(I,e.a.gf);return K.Qp(N,(O,M)=>O.equals(M))?F:K.Qp(F,(O,M)=>O.equals(M))?N:m.a(K,N,F,(O,M)=>O.equals(M))}return(N=I.runtime.uu.J(K))?F.getPropertyObjectIds(N,e.a.gf):(N=I.runtime.vq.J(K))?F.getPropertyObjectIds(N,
e.a.gf):null},H=(I,K)=>{var F=new k.a;const J=I.runtime.nk.J(K);if(J){var N=I.runtime.uu.Ty(K,J);I=I.runtime.vq.Ty(K,J);K=F.getPropertyObjectIds(J,e.a.gf);N=F.getPropertyObjectIds(N,e.a.gf);F=F.getPropertyObjectIds(I,e.a.gf);return K.Qp(N,(O,M)=>O.equals(M))?F:K.Qp(F,(O,M)=>O.equals(M))?N:null}return(N=I.runtime.uu.J(K))?F.getPropertyObjectIds(N,e.a.gf):(N=I.runtime.vq.J(K))?F.getPropertyObjectIds(N,e.a.gf):null}},1584:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(1456);c=c(2);class e{static zxm(){return!l.a.Fji()&&
!l.a.YFb()&&e.isFeatureEnabled(0)}static Rni(){return e.isFeatureEnabled(1)}static Zki(){return e.isFeatureEnabled(2)}static isFeatureEnabled(a){return!!(e.uLj&1<<a)}}e.uLj=c.AFrameworkApplication.K?c.AFrameworkApplication.K.pc("TellMeFeatureConfigValue",0):0;Object(D.a)(e,"TellMeFeatureAvailability",null,[])},1585:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1460);class l extends c.a{constructor(e,a,k,m,w=null){super(e,a,w,null,k);this.id=m}}Object(D.a)(l,"TryQueryResultBinding",c.a,
[])},1586:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.Cb=e}get q3a(){return this.Cb.q3a}get Pho(){return 4!==this.Cb.style}get Rho(){return!0}get trie(){return this.Cb.trie}getId(e,a){if(!this.Pho)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Cb.style){case 0:return this.EFl(e,a);default:throw Error.notImplemented();}}vE(e){if(!this.Rho)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.q3a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Cb.style){case 0:return this.PUl(e);case 4:return this.OUl(e);default:throw Error.notImplemented();}}EFl(e,a){e=this.Cb.trie.Wui(e,0,e.length,a);if(!e.succeeded)return-1;if(0>e.ijc||e.ijc>=this.Cb.q3a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Cb.s6c?this.Cb.l_c.ly(this.Cb.s6c+4*e.ijc,4):e.ijc}PUl(e){if(this.Cb.s6c){let a=0;for(;a<this.Cb.q3a&&this.Cb.l_c.ly(this.Cb.s6c+
4*a,4)!==e;++a);if(a>=this.Cb.q3a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Cb.trie.R4h(a)}return this.Cb.trie.R4h(e)}OUl(e){const a=this.Cb.l_c.ly(this.Cb.hfj+4*e,4);e=this.Cb.l_c.ly(this.Cb.ifj+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let m=0;m<a;++m)k[m]=({b$l:e}=this.ttn(e)).returnValue;return String.fromCharCode.apply(null,k)}ttn(e){let a=0;for(let k=0;3>k;++k){const m=
this.Cb.l_c.J(this.Cb.Rqh+e)^182;++e;a|=(m&127)<<7*k;if(!(m&128))break}return{returnValue:a,b$l:e}}}Object(D.a)(l,"StringTable",null,[1251])},1587:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(1595);class e{constructor(a){this.trie=null;this.Rqh=this.hfj=this.ifj=this.s6c=0;if(a){this.l_c=a;var k=0;if(a.ly(k,4)!==e.wyb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.q3a=a.ly(k,4);k+=4;this.style=a.ly(k,4);k+=4;switch(this.style){case 0:const m=1===
a.ly(k,4);k+=4;m||(this.s6c=k,k+=4*this.q3a);a.ly(k,4);this.trie=this.dfn(a,k+4);break;case 4:this.ifj=k;this.hfj=k+=4*this.q3a;k+=4*this.q3a;a.ly(k,4);this.Rqh=k+4;break;default:throw Error.argument("bytes");}}}dfn(a,k){return new l.a(a,k)}}e.wyb=1025118440;Object(D.a)(e,"StringTableInit",null,[])},1588:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=
4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=
18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.Addin=26]="Addin";e[e.OfficeScript=27]="OfficeScript";e[e.AddinStoreEntry=28]="AddinStoreEntry";e[e.Unknown=29]="Unknown"})(l||(l={}));Object(D.b)("ResultType",l)},1592:function(D,L,c){D=c(0);var l=c(7),e=c(621),a=c(152),k=c(228),m=c(61),w=c(412),
v=c(68),r;(function(pb){pb[pb.none=0]="none";pb[pb.mergeConflict=1]="mergeConflict";pb[pb.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";pb[pb.failedToApplyHints=3]="failedToApplyHints";pb[pb.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";pb[pb.other=5]="other"})(r||(r={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",r);var z=c(1012),A=c(251),G=c(893);const H=pb=>{const Aa=new k.a;pb.forEach(xb=>{Aa.add(xb);return!0});return Aa};var I=c(1539),K=
c(1519),F=c(1542);const J=(pb,Aa)=>{if(pb.length!==Aa.length)return!1;for(let xb=0;xb<pb.length;xb++)pb.J(xb).xm=Aa.J(xb),Aa.J(xb).xm=pb.J(xb);return!0},N=(pb,Aa,xb)=>{let gb,Xa,Va;gb=0;Xa=!1;Va=0;var Gb;if(!({idx:Gb}=W(pb,Aa)).returnValue)return a.a.instance.Sa(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,pb.Oq()),{returnValue:!1,XMc:gb,ckb:Xa,zVc:Va};if(!xb&&2===pb.J(Gb).type)return{returnValue:!0,XMc:Gb,ckb:Xa,zVc:Va};if(!pb.J(Gb).B3())return a.a.instance.Sa(17044256,
1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",Gb,xb,pb.Oq()),{returnValue:!1,XMc:gb,ckb:Xa,zVc:Va};let Xb=!1,rc=0;for(;Gb<pb.length&&pb.J(Gb).Jj.equals(Aa);Gb++){if(xb===rc){Xb=!0;break}if(xb>rc&&xb<rc+pb.J(Gb).length){Xa=Xb=!0;Va=xb-rc;break}rc+=pb.J(Gb).length}Xb||xb!==rc||(Xb=!0);Xb&&(gb=Gb);return{returnValue:Xb,XMc:gb,ckb:Xa,zVc:Va}},O=(pb,Aa,xb)=>{let gb,Xa,Va;Va=Xa=0;gb=!1;let Gb=0,Xb=!1;for(;Xa<pb.length;Xa++){if(Aa===Gb){Xb=
!0;break}if(Aa>Gb&&Aa<Gb+pb.J(Xa).length){gb=Xb=!0;Va=Aa-Gb;break}Gb+=pb.J(Xa).length}Xb||Aa!==Gb||(Xb=!0);Xb||(pb=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",pb.length,Gb,Aa),a.a.instance.Sa(573178201,1,2,pb),xb.Vg(Object.assign(new F.a,{eventId:"8k6fz",info:pb})));return{returnValue:Xb,ckb:gb,nlh:Xa,mlh:Va}},M=(pb,Aa,xb)=>{let gb;if(pb.J(Aa).B3()&&({Kdj:gb}=pb.J(Aa).Hdo(xb)).returnValue)return pb.VA(Aa+1,gb),pb.FF(Aa),!0;a.a.instance.Sa(18969441,1,
5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Aa,xb,pb.Oq());return!1},T=(pb,Aa,xb)=>{let gb,Xa;if(!({XMc:xb,ckb:Xa,zVc:gb}=N(pb,Aa,xb)).returnValue)return{returnValue:!1,index:0};if(!Xa)return{returnValue:!0,index:xb};if(M(pb,xb,gb))return{returnValue:!0,index:xb+1};a.a.instance.Sa(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Aa,gb,pb.Oq());return{returnValue:!1,index:0}},R=(pb,
Aa,xb)=>{let gb;if(!({ckb:gb,nlh:Aa,mlh:xb}=O(pb,Aa,xb)).returnValue)return{returnValue:!1,index:0};if(!gb)return{returnValue:!0,index:Aa};if(M(pb,Aa,xb))return{returnValue:!0,index:Aa+1};a.a.instance.Sa(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",xb,pb.Oq());return{returnValue:!1,index:0}},W=(pb,Aa)=>{let xb;xb=0;for(let gb=0;gb<pb.length;gb++)if(pb.J(gb).Jj.equals(Aa))return xb=gb,{returnValue:!0,idx:xb};a.a.instance.Sa(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",
Aa,pb.Oq());return{returnValue:!1,idx:xb}},V=(pb,Aa)=>{let xb;xb=-1;for(let gb=Aa;gb<pb.length;gb++)if(2===pb.J(gb).type)return xb=gb,{returnValue:!0,ffa:xb};a.a.instance.Sa(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Aa,pb.Oq());return{returnValue:!1,ffa:xb}},ba=(pb,Aa,xb)=>{let gb;gb=-1;for(let Xa=xb;Xa<pb.length;Xa++)if(2===pb.J(Xa).type&&pb.J(Xa).Jj.equals(Aa))return gb=Xa,{returnValue:!0,ffa:gb};a.a.instance.Sa(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
Aa,xb,pb.Oq());return{returnValue:!1,ffa:gb}},ha=(pb,Aa)=>{let xb;xb=0;var gb;if(!({idx:gb}=W(pb,Aa)).returnValue)return a.a.instance.Sa(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,pb),{returnValue:!1,length:xb};for(;gb<pb.length;gb++)if(6!==pb.J(gb).type){if(2===pb.J(gb).type)return{returnValue:!0,length:xb};a.a.instance.shipAssertTag(17342617,1,pb.J(gb).B3(),"We found something other than text with type "+pb.J(gb).type);a.a.instance.shipAssertTag(17877021,1,pb.J(gb).Jj.equals(Aa),
"Unexpected GraphNodeId {0} for ParaId {1}",pb.J(gb).Jj,Aa);xb+=pb.J(gb).length}a.a.instance.Sa(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,pb);return{returnValue:!1,length:xb}},ca=pb=>{const Aa=new k.a;for(let xb=0;xb<pb.length;xb++)Aa.add(pb.J(xb).clone());return Aa};var ia=c(1541),ra=c(1506);class da{constructor(pb,Aa,xb=null,gb=null){this.Jj=pb;this.type=Aa;this.text=xb;this.Pc=gb}isEqual(pb){return pb.Jj.equals(this.Jj)&&this.type===pb.type&&this.Pc===pb.Pc&&ra.a.sjh(this.text,
pb.text)}toString(){let pb=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Jj,this.Pc,this.type);this.text&&(pb+=String.format(" [TextLength: {0}]",this.text.length));return pb}}Object(D.a)(da,"MergeBlockValidationState",null,[]);var za=c(123),la=c(934),na=c(861),Ca=c(554),Na=c(496),Ta=c(933),Fa=c(860),qa=c(1491),ja=c(1667),X;(function(pb){pb[pb.base=1]="base";pb[pb.favoredUpdate=2]="favoredUpdate";pb[pb.unfavoredUpdate=4]="unfavoredUpdate";pb[pb.min=1]="min";pb[pb.max=
7]="max"})(X||(X={}));Object(D.b)("MergeBlockSource",X);class ua{constructor(pb,Aa,xb,gb){this.Bg=pb;this.cp=Aa;this.Dwd=xb;this.B7c=gb}}Object(D.a)(ua,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var Ha=c(1538);class Ea extends Ha.a{constructor(pb,Aa){super(6,pb,Aa);this.Pc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Jj)}s4b(){return"Selection"}clone(){return new Ea(this.source,this.Jj)}bA(){return!1}get length(){return 0}}Object(D.a)(Ea,"SelectionMergeBlock",
Ha.a,[]);var wa;(function(pb){pb[pb.success=0]="success";pb[pb.selfSplit=1]="selfSplit";pb[pb.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";pb[pb.unexpected=3]="unexpected"})(wa||(wa={}));Object(D.b)("SplitTwinListResult",wa);var sa=c(1579);class fa extends sa.a{constructor(pb,Aa,xb,gb){super(5,pb,Aa);this._text=null;this.j3c(xb);this.q6j=gb}get text(){return this._text}j3c(pb){this._text=pb}get f7c(){return this.q6j}clone(){return new fa(this.source,this.Jj,this.text,this.f7c)}get U5a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(fa,"UpdateHintTextMergeBlock",sa.a,[]);class Ma{constructor(pb,Aa,xb,gb){this.F1=!1;this.Pab=new w.a;this.ae=pb;this.T9g=gb;this.bDg=xb;this._base=Aa;this.tre=ca(Aa);if(!J(this.base,this.Le))throw a.a.instance.Sa(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),pb.logger.Vg(Object.assign(new qa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Le(){return this.tre}get mergeConflict(){return this.F1}YVe(pb,
Aa){switch(pb.type){case 1:return this.Nlk(pb,Aa);case 2:return this.xVe(pb,Aa);case 3:return this.Lmk(pb,Aa);case 4:return this.hmk(pb);case 5:return this.flk(pb,Aa);case 6:return this.vVe(pb);default:return!1}}XVe(pb,Aa){switch(pb.type){case 1:return this.CVe(pb,Aa);case 2:return this.wVe(pb,Aa);case 3:return this.Kmk(pb,Aa);case 4:return this.gmk(pb);case 5:return this.elk(pb,Aa);case 6:return this.uVe(pb);default:return{returnValue:!1,fu:null}}}Nlk(pb,Aa){let xb;const gb=({Pfa:xb}=this.HGa(pb.Bg,
Aa,!1,pb.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==gb&&1!==gb)return 3!==gb&&(a.a.instance.Sa(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",X[Aa],wa[gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.F1=!1;Aa=new fa(Aa,pb.Bg,pb.text,pb.id);this.Jsf(pb,xb,Aa);return!0}xVe(pb,Aa){let xb,gb=({Pfa:xb}=this.HGa(pb.Bg,Aa,!1,pb.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==gb&&1!==gb)return 3!==gb&&(a.a.instance.Sa(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",X[Aa],wa[gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Xa;({Pfa:Xa,returnValue:gb}=this.HGa(pb.Bg,Aa,!1,pb.cp+pb.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==gb&&1!==gb)return 3!==gb&&(a.a.instance.Sa(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
X[Aa],wa[gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.F1=!1;this.t7e(pb,xb,Xa);return!0}Lmk(pb,Aa){let xb;const gb=({brf:xb}=this.RYh(pb,Aa,!1)).returnValue;if(0!==gb&&1!==gb)return 3!==gb&&(a.a.instance.Sa(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",X[Aa],wa[gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.F1=!1;Aa=new I.a(Aa,pb.It,pb.wsa);this.Jsf(pb,xb,Aa);return!0}hmk(pb){let Aa;if(!({VPd:Aa}=this.SYh(pb,this.Le,"Derived")).returnValue)return!1;this.t7e(pb,Aa,Aa+1);return!0}flk(pb,Aa){let xb;if(!({JEf:Aa,arf:xb}=this.A_h(pb,!1,Aa)).returnValue)return!1;this.Jsf(pb,xb,Aa);return!0}vVe(pb){let Aa;if(!({UPd:Aa}=this.IYh(pb,this.Le,"Derived")).returnValue)return!1;this.t7e(pb,Aa,Aa+1);return!0}Bih(pb,Aa,xb){const gb=({Pfa:Aa}=this.HGa(pb,xb,!1,Aa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==gb&&1!==gb)return 3!==gb&&(a.a.instance.Sa(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",X[xb],wa[gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.F1=!1;pb=new Ea(xb,pb);this.Le.insert(Aa,pb);return!0}CVe(pb,Aa){var xb=null;if(Ma.Oii(pb.text.length))return{returnValue:!1,fu:xb};let gb,Xa,Va;var Gb=({Pfa:gb,hva:Xa,Lea:Va}=this.HGa(pb.Bg,Aa,!0,pb.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Gb&&2!==Gb)return 3!==Gb&&(a.a.instance.Sa(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",X[Aa],wa[Gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,fu:xb};this.F1=!1;({ffa:Gb}=V(this.Le,Xa));Gb=this.Le.J(Gb).Jj;xb=new fa(Aa,pb.Bg,pb.text,pb.id);Aa=new fa(Aa,Gb,pb.text,pb.id);xb.xm=Aa;Aa.xm=
xb;this.base.insert(gb,xb);this.Le.insert(Xa,Aa);xb=new k.a;xb.add(new Na.a(Gb,Va,pb.text,pb.id,pb.yu));return{returnValue:!0,fu:xb}}wVe(pb,Aa){let xb;xb=null;if(Ma.Oii(pb.text.length))return{returnValue:!1,fu:xb};let gb;var Xa,Va=({Pfa:gb,hva:Gb,Lea:Xa}=this.HGa(pb.Bg,Aa,!0,pb.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Va){if(2!==Va)return 3!==Va&&(a.a.instance.Sa(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
X[Aa],wa[Va]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,fu:xb};var Gb=0;for({idx:Xa}=W(this.base,pb.Bg);Xa<this.base.length&&Gb<pb.cp;Xa++)Gb+=this.base.J(Xa).length;Gb-=this.base.J(Xa-1).length;({hva:Gb,Lea:Xa,returnValue:Va}=this.HGa(pb.Bg,Aa,!0,Gb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Va)return 3!==Va&&(a.a.instance.Sa(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
X[Aa],wa[Va]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,fu:xb};this.F1=!1}var Xb,rc;({Pfa:Xb,hva:rc,Lea:qb,returnValue:Va}=this.HGa(pb.Bg,Aa,!0,pb.cp+pb.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Va){if(2!==Va)return 3!==Va&&(a.a.instance.Sa(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",X[Aa],wa[Va]),this.ae.logger.Vg(Object.assign(new ja.a,
{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,fu:xb};var qb=0;for({idx:rc}=W(this.base,pb.Bg);rc<this.base.length&&qb<pb.cp+pb.text.length;rc++)qb+=this.base.J(rc).length;({hva:rc,Lea:qb,returnValue:Va}=this.HGa(pb.Bg,Aa,!0,qb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Va)return 3!==Va&&(a.a.instance.Sa(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",X[Aa],wa[Va]),this.ae.logger.Vg(Object.assign(new ja.a,
{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,fu:xb};this.F1=!1}Aa="";xb=new k.a;for(--rc;rc>=Gb;rc--)if(6!==this.Le.J(rc).type)if(this.Le.J(rc).xm)Aa=this.Le.J(rc).text+Aa,this.Le.FF(rc);else{if(5===this.Le.J(rc).type)Va=qb-Aa.length;else if(2===this.Le.J(rc).type){if(Va=0,!({length:qb}=ha(this.Le,this.Le.J(rc).Jj)).returnValue)return a.a.instance.Sa(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.ae.logger.Vg(Object.assign(new ja.a,
{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,fu:xb}}else return a.a.instance.Sa(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,fu:xb};if(!({ffa:Zb}=V(this.Le,rc+1)).returnValue)return a.a.instance.Sa(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ae.logger.Vg(Object.assign(new ja.a,
{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,fu:xb};var Zb=this.Le.J(Zb).Jj;xb.add(new Ca.DeleteTextUpdateHint(Zb,Va,Aa));Aa=""}for(--Xb;Xb>=gb;Xb--)this.base.FF(Xb);if(!({ffa:Zb}=V(this.Le,Gb)).returnValue)return a.a.instance.Sa(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,fu:xb};Zb=this.Le.J(Zb).Jj;Aa&&Aa.length&&xb.add(new Ca.DeleteTextUpdateHint(Zb,
Xa,Aa,pb.id,pb.yu));return{returnValue:!0,fu:xb}}Kmk(pb,Aa){var xb=null;let gb,Xa,Va;var Gb=({brf:gb,Ebi:Xa,Lea:Va}=this.RYh(pb,Aa,!0)).returnValue;if(0!==Gb)return 3!==Gb&&(a.a.instance.Sa(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",X[Aa],wa[Gb]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,fu:xb};var Xb;if(!({ffa:Xb}=V(this.Le,Xa)).returnValue)return a.a.instance.Sa(17342618,
1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,fu:xb};Gb=this.Le.J(Xb).Jj;const rc=this.Le.J(Xb).Pc;let qb,Zb,Rb;({It:Xb,n6:qb,wsa:Zb,G$:Rb}=this.XKl(pb,Xb));this.Mqh(this.Le,Xb,qb,Rb,Xa);xb=new I.a(Aa,pb.It,pb.wsa);Aa=new I.a(Aa,Xb,Zb);xb.xm=Aa;Aa.xm=xb;this.base.insert(gb,xb);this.Le.insert(Xa,Aa);xb=new k.a;xb.add(new Fa.a(Gb,rc,Va,Xb,Zb,qb,Rb,pb.id,pb.yu));return{returnValue:!0,fu:xb}}gmk(pb){let Aa;Aa=null;let xb,gb;var Xa;if(!({VPd:xb}=
this.SYh(pb,this.base,"Base")).returnValue)return{returnValue:!1,fu:Aa};if(!this.base.J(xb).xm||!({ffa:gb}=ba(this.Le,this.base.J(xb).xm.Jj,0)).returnValue)return a.a.instance.Sa(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.F1=!0,{returnValue:!1,fu:Aa};if(!({ffa:Xa}=V(this.Le,gb+1)).returnValue)return a.a.instance.Sa(17342620,
1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.F1=!0,{returnValue:!1,fu:Aa};let Va,Gb,Xb,rc,qb,Zb;({b3a:Xa,c3a:Xb,vIf:Va,KXm:rc,rXm:Gb,sXm:qb}=this.jzl(pb,gb,Xa));if(!({length:Zb}=ha(this.Le,Xa)).returnValue)return{returnValue:!1,fu:Aa};this.Lqh(this.Le,Xa,Xb,gb);this.Le.FF(gb);this.base.FF(xb);Aa=new k.a;Aa.add(new Ta.MergeParagraphUpdateHint(Va,
rc,Zb,Gb,qb,Xa,Xb,pb.id,pb.yu));return{returnValue:!0,fu:Aa}}elk(pb,Aa){var xb=null;let gb,Xa,Va;if(!({JEf:Va,arf:gb}=this.A_h(pb,!0,Aa)).returnValue)return{returnValue:!1,fu:xb};if(!({whb:Xa}=this.kLc(this.base,this.Le,gb,!0)).returnValue)return a.a.instance.Sa(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,fu:xb};if(0<Xa&&2!==this.Le.J(Xa-1).type)return a.a.instance.Sa(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),
this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.F1=!0,{returnValue:!1,fu:xb};let Gb;if(!({It:Gb}=this.KRh(Xa)).returnValue)return{returnValue:!1,fu:xb};Aa=new I.a(Aa,pb.Bg,pb.Pc);xb=Va;xb.xm=Aa;Aa.xm=xb;this.base.insert(gb,Va);this.Le.insert(Xa,Aa);xb=new k.a;xb.add(new la.AddParagraphUpdateHint(pb.Bg,pb.Pc,Gb,pb.id,pb.yu));return{returnValue:!0,fu:xb}}uVe(pb){let Aa;Aa=null;let xb;var gb;if(!({UPd:gb}=this.IYh(pb,this.base,"Base")).returnValue)return{returnValue:!1,
fu:Aa};if(!this.base.J(gb).xm||!this.base.J(gb).xm.Jj.equals(pb.Bg))return a.a.instance.Sa(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.F1=!0,{returnValue:!1,fu:Aa};if(!({whb:xb}=this.kLc(this.base,this.Le,gb,!0)).returnValue)return a.a.instance.Sa(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,fu:Aa};if(0<xb&&2!==this.Le.J(xb).type)return a.a.instance.Sa(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.F1=!0,{returnValue:!1,fu:Aa};const Xa=this.Le.J(xb).Jj,Va=this.Le.J(xb).Pc;this.Le.FF(xb);this.base.FF(gb);({It:gb}=this.KRh(xb));0<xb&&6===this.Le.J(xb-1).type&&this.Jin(xb-1,gb);Aa=new k.a;Aa.add(new na.a(Xa,Va,gb,pb.id,
pb.yu));return{returnValue:!0,fu:Aa}}Aih(pb,Aa,xb){let gb;var Xa=({Pfa:Aa,hva:gb}=this.HGa(pb,xb,!0,Aa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Xa)return 3!==Xa&&(a.a.instance.Sa(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",X[xb],wa[Xa]),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({ffa:Xa}=V(this.Le,gb));Xa=this.Le.J(Xa).Jj;
pb=new Ea(xb,pb);xb=new Ea(xb,Xa);pb.xm=xb;xb.xm=pb;this.base.insert(Aa,pb);this.Le.insert(gb,xb);return!0}jzl(pb,Aa,xb){let gb,Xa,Va;gb=pb.b3a.equals(pb.Bg)?this.Le.J(Aa).Jj:this.Le.J(xb).Jj;pb=pb.c3a===pb.Pc?this.Le.J(Aa).Pc:this.Le.J(xb).Pc;Xa=this.Le.J(Aa).Jj;Aa=this.Le.J(Aa).Pc;Va=this.Le.J(xb).Jj;xb=this.Le.J(xb).Pc;return{b3a:gb,c3a:pb,vIf:Xa,KXm:Aa,rXm:Va,sXm:xb}}XKl(pb,Aa){let xb;var gb=pb.Bg.equals(pb.It)?pb.n6:pb.It;const Xa=pb.Pc===pb.wsa?pb.G$:pb.wsa;pb.Bg.equals(pb.It)?xb=this.Le.J(Aa).Jj:
(xb=gb,gb=this.Le.J(Aa).Jj);pb.Pc===pb.wsa?(pb=this.Le.J(Aa).Pc,Aa=Xa):(pb=Xa,Aa=this.Le.J(Aa).Pc);return{It:xb,n6:gb,wsa:pb,G$:Aa}}Nqh(pb,Aa,xb,gb){for(;gb<pb.length;gb++){if(!pb.J(gb).B3()&&6!==pb.J(gb).type&&2!==pb.J(gb).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+pb.J(gb).type);break}pb.J(gb).Jj=Aa;if(2===pb.J(gb).type){pb.J(gb).Pc=xb;break}}}Mqh(pb,Aa,xb,gb,Xa){this.Nqh(pb,xb,gb,Xa);Ma.Oqh(pb,Aa,Xa)}Lqh(pb,Aa,xb,gb){this.Nqh(pb,Aa,xb,gb+1);Ma.Oqh(pb,Aa,gb)}SYh(pb,
Aa,xb){let gb,Xa=-1;if(!({ffa:gb}=ba(Aa,pb.Bg,0)).returnValue)return a.a.instance.Sa(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+xb+"for GraphNodeId "+pb.Bg),{returnValue:!1,VPd:gb};if(!({ffa:Xa}=V(Aa,gb+1)).returnValue||!Aa.J(Xa).Jj.equals(pb.n6))return a.a.instance.Sa(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+gb+1+" in "+xb+" of length "+Aa.length),{returnValue:!1,VPd:gb};this.Lqh(Aa,pb.b3a,pb.c3a,gb);return{returnValue:!0,VPd:gb}}RYh(pb,Aa,xb){let gb;
const Xa=xb?this.base:this.Le,Va=xb?"Base":"Derived",Gb=({Pfa:Aa,hva:xb,Lea:gb}=this.HGa(pb.Bg,Aa,xb,pb.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Gb||2===Gb)return a.a.instance.Sa(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Va),{returnValue:Gb,brf:Aa,Ebi:xb,Lea:gb};this.Mqh(Xa,pb.It,pb.n6,pb.G$,Aa);return{returnValue:Gb,brf:Aa,Ebi:xb,Lea:gb}}IYh(pb,Aa,xb){return({idx:pb}=W(Aa,pb.Bg)).returnValue?2!==Aa.J(pb).type?(a.a.instance.Sa(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
xb),{returnValue:!1,UPd:-1}):{returnValue:!0,UPd:pb}:(a.a.instance.Sa(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+xb),{returnValue:!1,UPd:-1})}Jin(pb,Aa){var xb=this.Le.J(pb);if(Aa){let gb;({ffa:gb}=ba(this.Le,Aa,0));xb=xb.clone();xb.Jj=Aa;this.Le.FF(pb);this.Le.insert(gb,xb)}else this.Le.length>pb&&(this.Le.J(pb+1).B3()||2===this.Le.J(pb+1).type)&&(xb.Jj=this.Le.J(pb+1).Jj)}A_h(pb,Aa,xb){var gb=Aa?this.base:this.Le;Aa=Aa?"Base":"Derived";xb=new I.a(xb,pb.Bg,pb.Pc);if(pb.It){if(!({ffa:gb}=
ba(gb,pb.It,0)).returnValue)return a.a.instance.Sa(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",pb.It,Aa),{returnValue:!1,JEf:xb,arf:gb};gb+=1}else gb=0;return{returnValue:!0,JEf:xb,arf:gb}}KRh(pb){let Aa;Aa=null;let xb=pb-1;if(-1===xb)return{returnValue:!0,It:Aa};6===this.Le.J(xb).type&&xb--;if(2===this.Le.J(xb).type||4===this.Le.J(xb).type)return Aa=this.Le.J(xb).Jj,{returnValue:!0,It:Aa};a.a.instance.Sa(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Le.J(pb-1).type);return{returnValue:!1,It:Aa}}kLc(pb,Aa,xb,gb){let Xa,Va=!0;Xa=-1;if(xb>pb.length)return a.a.instance.Sa(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,whb:Xa};if(xb<pb.length){if(-1<xb&&xb<pb.length&&!pb.J(xb).xm){Va=!1;for(var Gb=xb+1;Gb<pb.length;Gb++)if(pb.J(Gb).xm){xb=Gb;Va=!0;break}}if(!Va)return{returnValue:!1,whb:Xa};Va=!1;for(Gb=0;pb.J(xb)&&Gb<Aa.length;Gb++)if(Aa.J(Gb).xm===pb.J(xb)){Xa=Gb;Va=!0;break}if(!Va)return{returnValue:!1,
whb:Xa}}else Xa=Aa.length;if(0<Xa&&gb&&!Aa.J(Xa-1).xm){for(pb=Xa-1;0<=pb&&!Aa.J(pb).xm;pb--);Xa=pb+1;6===Aa.J(Xa).type&&5!==this.ae.input.source&&Xa++}return{returnValue:!0,whb:Xa}}HGa(pb,Aa,xb,gb,Xa,Va){let Gb;var Xb;let rc;var qb=this.base;let Zb=this.Le,Rb=!1;xb||(qb=this.Le,Zb=this.base);rc=Xb=Gb=0;let Ra,ab,fb=0;if(!({XMc:gb,ckb:Ra,zVc:ab}=N(qb,pb,gb)).returnValue)return a.a.instance.Sa(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,Pfa:Gb,hva:Xb,Lea:rc};0<=gb&&gb<qb.length&&!qb.J(gb).xm&&Ra&&!Xa&&(a.a.instance.Sa(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",Va),this.F1=!0,fb=Aa===qb.J(gb).source?1:2,Rb=!0);Xa&&!qb.J(gb)&&gb--;Xa&&Ra&&!qb.J(gb).xm&&(Ra=!1,ab=0);if(!xb&&!({idx:pb}=W(Zb,pb)).returnValue&&!Ra)return{returnValue:0,Pfa:gb,hva:Xb,Lea:rc};if(!({whb:pb}=this.kLc(qb,Zb,gb,xb&&!Ra)).returnValue&&!Rb&&(Aa=
!1,1===this.T9g&&0<gb&&!ab&&(gb--,{whb:pb,returnValue:Aa}=this.kLc(qb,Zb,gb,xb&&!Ra),Aa&&(gb++,pb<Zb.length-1?pb++:Aa=!1)),!Aa))return a.a.instance.Sa(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.ae.logger.Vg(Object.assign(new ja.a,{tj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.F1=!0,{returnValue:3,Pfa:Gb,hva:Xb,Lea:rc};if(Ra&&(!M(qb,gb,ab)||!Rb&&!M(Zb,pb,ab)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Pfa:Gb,hva:Xb,Lea:rc};Gb=gb;Xb=pb;Ra&&(Gb=gb+1,Rb||(Xb=qb.J(gb),xb=Zb.J(pb),Xb.xm=xb,xb.xm=Xb,qb=qb.J(gb+1),Xb=Zb.J(pb+1),qb.xm=Xb,Xb.xm=qb,Xb=pb+1));if(Xb>=Zb.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Xb+" secondaryList length was "+Zb.length),{returnValue:3,Pfa:Gb,hva:Xb,Lea:rc};
for(qb=0;qb<Xb;qb++)Zb.J(qb).Jj.equals(Zb.J(Xb).Jj)&&(rc+=Zb.J(qb).length);return{returnValue:fb,Pfa:Gb,hva:Xb,Lea:rc}}t7e(pb,Aa,xb){this.bDg.contains(pb.id)&&this.Pab.Z(pb.id,new k.a);for(--xb;xb>=Aa;xb--)this.bDg.contains(pb.id)?this.Pab.J(pb.id).insert(this.Pab.J(pb.id).length,this.Le.J(xb)):this.Le.J(xb).xm&&(this.Le.J(xb).xm.xm=null),this.Le.FF(xb)}Jsf(pb,Aa,xb){if(this.Pab.ub(pb.yu)){const gb=this.Pab.J(pb.yu);for(let Xa=0;Xa<gb.length;Xa++)gb.J(Xa).Jj=xb.Jj,Object(za.a)(I.a,xb)&&Object(za.a)(I.a,
gb.J(Xa))&&(gb.J(Xa).Pc=xb.Pc);this.Le.VA(Aa,this.Pab.J(pb.yu));this.Pab.remove(pb.yu)}else this.Le.insert(Aa,xb)}rYl(pb){let Aa,xb;xb=Aa=-1;if(!pb.xm)return{returnValue:!1,h2b:Aa,Q7e:xb};var gb;let Xa=0,Va=!1;if(!({idx:gb}=W(this.Le,pb.xm.Jj)).returnValue)return{returnValue:!1,h2b:Aa,Q7e:xb};for(;gb<this.Le.length;gb++){if(pb.xm===this.Le.J(gb)){Aa=gb;xb=Xa;Va=!0;break}Xa+=this.Le.J(gb).length}return{returnValue:Va,h2b:Aa,Q7e:xb}}Ucf(pb){let Aa;Aa=new k.a;let xb=0,gb=0;for(;xb<pb.length;){if(gb>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Bjc:Aa};if(pb.J(xb).length>this.base.J(gb).length){if(!M(pb,xb,this.base.J(gb).length))return a.a.instance.Sa(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",xb,this.base.J(gb).length),{returnValue:!1,Bjc:Aa}}else if(pb.J(xb).length<this.base.J(gb).length){var Xa=
!!this.base.J(gb).xm,Va=0;if(Xa&&!({whb:Va}=this.kLc(this.base,this.Le,gb,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",gb),{returnValue:!1,Bjc:Aa};if(!M(this.base,gb,pb.J(xb).length)||Xa&&!M(this.Le,Va,pb.J(xb).length))return a.a.instance.Sa(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,Bjc:Aa};if(Xa){Xa=this.base.J(gb);var Gb=this.Le.J(Va);Xa.xm=Gb;Gb.xm=Xa;Xa=this.base.J(gb+1);Va=this.Le.J(Va+1);Xa.xm=Va;Va.xm=Xa}}if(this.base.J(gb).xm&&5!==this.base.J(gb).type&&this.base.J(gb).B3()&&(Va=this.base.J(gb),Xa=pb.J(xb),!Va.xI.equals(Xa.xI)||!Va.NE.bA(Xa.NE))){let Xb;if(!({h2b:Gb,Q7e:Xb}=this.rYl(this.base.J(gb))).returnValue)return{returnValue:!1,Bjc:Aa};Aa.add(new ua(this.Le.J(Gb).Jj,Xb,Va,Xa))}xb++;gb++}return{returnValue:!0,Bjc:Aa}}static Oqh(pb,Aa,xb){for(--xb;0<=
xb;xb--){if(!pb.J(xb).B3()&&6!==pb.J(xb).type){a.a.instance.shipAssertTag(17311187,1,2===pb.J(xb).type||4===pb.J(xb).type,"Found merge block of type "+pb.J(xb).type);break}pb.J(xb).Jj=Aa}}static Oii(pb){return pb?!1:(a.a.instance.Sa(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(D.a)(Ma,"ParagraphMergeUsingHintsTwinList",null,[2002]);var Ua=c(1665),Qa=c(1666),Ja=c(1662),Wa=c(1664),Ya=c(1663);class sb{constructor(pb,Aa,
xb,gb){this.cp=pb;this.length=Aa;this.Dwd=xb;this.B7c=gb}}Object(D.a)(sb,"UpdateFormattingIdsPosInfo",null,[]);class ob{constructor(pb,Aa,xb){this.F1=!1;this.Pab=new w.a;this.ae=pb;this.T9g=xb;this._base=Aa;this.tre=ca(Aa);if(!J(this.base,this.Le))throw a.a.instance.Sa(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),pb.logger.Vg(Object.assign(new F.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Le(){return this.tre}get mergeConflict(){return this.F1}YVe(pb,
Aa){switch(pb.type){case 11:return this.Llk(pb,Aa);case 8:return this.xVe(pb,Aa);case 10:return this.vVe(pb);default:return!1}}XVe(pb,Aa){switch(pb.type){case 11:return this.Klk(pb,Aa);case 8:return this.wVe(pb,Aa);case 10:return this.uVe(pb);default:return{returnValue:!1,fu:null}}}Bih(){a.a.instance.Sa(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}Aih(){a.a.instance.Sa(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Ucf(pb){let Aa;Aa=new k.a;let xb=0,gb=0,Xa=0;for(;xb<pb.length;){if(gb>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,A7c:Aa};if(pb.J(xb).length>this.base.J(gb).length){if(!M(pb,xb,this.base.J(gb).length))return a.a.instance.Sa(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,A7c:Aa}}else if(pb.J(xb).length<this.base.J(gb).length&&!this.K5a(Xa+pb.J(xb).length,!0).returnValue)return a.a.instance.Sa(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,A7c:Aa};if(this.base.J(gb).xm&&5!==this.base.J(gb).type&&this.base.J(gb).B3()){const Va=this.base.J(gb),Gb=pb.J(xb);if(!Va.xI.equals(Gb.xI)||!Va.NE.bA(Gb.NE)){let Xb,rc;if(({h2b:Xb,CEh:rc}=this.sYl(this.base.J(gb))).returnValue)Aa.add(new sb(rc,this.Le.J(Xb).length,Va,Gb));else return a.a.instance.Sa(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,A7c:Aa}}}Xa+=this.base.J(gb).length;xb++;gb++}return{returnValue:!0,A7c:Aa}}Llk(pb,Aa){let xb;if(!({sCa:xb}=this.K5a(pb.cp,!0)).returnValue)return a.a.instance.Sa(574433300,1,2,"ApplyInsertTextHintToDerived"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Xa=0;Xa<pb.TZ.length;Xa++)switch(pb.TZ.J(Xa).type){case 7:var gb=pb.TZ.J(Xa);this.Le.insert(xb,new fa(Aa,null,gb.text,gb.id));break;case 9:gb=pb.TZ.J(Xa);this.Le.insert(xb,new I.a(Aa,gb.Bg,gb.Pc));break;default:return a.a.instance.Sa(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}xVe(pb,Aa){let xb,gb;if(!({sCa:xb}=this.K5a(pb.cp,!0)).returnValue||!({sCa:gb}=this.K5a(pb.cp+
pb.text.length,!1)).returnValue)return a.a.instance.Sa(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(pb=gb;pb>=xb;pb--)this.Le.J(pb).source!==Aa&&this.dDd(this.Le,pb);return!0}vVe(pb){let Aa;if(!({sCa:Aa}=this.K5a(pb.cp,!0)).returnValue)return a.a.instance.Sa(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.x7e(this.Le,pb,Aa);return!0}Klk(pb,Aa){let xb;xb=null;let gb,Xa;if(!({gyb:gb,sCa:Xa}=this.K5a(pb.cp,!0)).returnValue)return a.a.instance.Sa(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,fu:xb};var Va=this.Chf(this.Le,Xa-1);Va=new Ya.a(Va);for(let Gb=0;Gb<pb.TZ.length;Gb++)switch(pb.TZ.J(Gb).type){case 7:Va.TZ.add(this.CVe(pb.TZ.J(Gb),Aa,gb,Xa));break;
case 9:Va.TZ.add(this.Mlk(pb.TZ.J(Gb),Aa,gb,Xa));break;default:return a.a.instance.Sa(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,fu:xb}}xb=new k.a;xb.add(Va);return{returnValue:!0,fu:xb}}CVe(pb,Aa,xb,gb){const Xa=new fa(Aa,pb.Bg,pb.text,pb.id);Aa=new fa(Aa,pb.Bg,pb.text,pb.id);Xa.xm=Aa;Aa.xm=Xa;this.base.insert(xb,Xa);this.Le.insert(gb,Aa);xb=new Wa.a(pb.Bg,pb.text);xb.id=pb.id;return xb}Mlk(pb,
Aa,xb,gb){const Xa=new I.a(Aa,pb.Bg,pb.Pc);Aa=new I.a(Aa,pb.Bg,pb.Pc);Xa.xm=Aa;Aa.xm=Xa;this.base.insert(xb,Xa);this.Le.insert(gb,Aa);return new Ja.a(pb.Bg,pb.Pc)}wVe(pb){let Aa;Aa=new k.a;let xb;var gb;let Xa;if(!({gyb:xb,sCa:gb}=this.K5a(pb.cp,!0)).returnValue||!({gyb:Xa,sCa:Va}=this.K5a(pb.cp+pb.text.length,!1)).returnValue)return a.a.instance.Sa(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,fu:Aa};for(pb=Va;pb>=gb;pb--)if(this.Le.J(pb).xm){var Va=pb;Aa.add(({BXm:pb}=this.pil(pb,gb)).returnValue);this.dDd(this.Le,pb,Va)}for(gb=Xa;gb>=xb;gb--)this.dDd(this.base,gb);return{returnValue:!0,fu:Aa}}uVe(pb){let Aa;Aa=null;let xb,gb;if(!({gyb:xb,sCa:gb}=this.K5a(pb.cp,!0)).returnValue)return a.a.instance.Sa(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,fu:Aa};
if(!this.x7e(this.base,pb,xb))return a.a.instance.Sa(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,fu:Aa};this.x7e(this.Le,pb,gb)&&(Aa=new k.a,Aa.add(new Ua.a(this.Chf(this.Le,gb-1),pb.Bg,pb.Pc)));return{returnValue:!0,fu:Aa}}K5a(pb,Aa){var xb;var gb=xb=-1;let Xa,Va;if(!({ckb:Va,nlh:pb,mlh:Xa}=O(this.base,pb,this.ae.logger)).returnValue)return{returnValue:!1,gyb:xb,
sCa:gb};const Gb=pb>=this.base.length;Gb&&pb--;if(this.base.J(pb).xm){const Xb=this.Mjl(this.Le,this.base.J(pb));if(Va){if(0>Xb||!M(this.base,pb,Xa)||!M(this.Le,Xb,Xa))return a.a.instance.Sa(575706444,1,2,"SplitTwinListAndFindIdx"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,gyb:xb,sCa:gb};xb=this.base.J(pb);gb=this.Le.J(Xb);xb.xm=gb;gb.xm=xb;xb=this.base.J(pb+1);gb=this.Le.J(Xb+1);xb.xm=gb;gb.xm=xb;xb=Aa?pb+1:pb;gb=Aa?Xb+1:Xb}else Aa?(xb=
Gb?pb+1:pb,gb=Gb?Xb+1:Xb):(xb=Gb?pb:pb-1,gb=Gb?Xb:Xb-1)}else if(Va){if(M(this.base,pb,Xa))xb=Aa?pb+1:pb;else return a.a.instance.Sa(575706445,1,2,"SplitTwinListAndFindIdx"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,gyb:xb,sCa:gb};Aa?(gb=({jEb:gb}=this.G3b(this.base,this.Le,pb,!1)).returnValue?gb+1:0,gb=gb>=this.Le.length?this.Le.length-1:gb):(gb=({jEb:gb}=this.G3b(this.base,this.Le,pb,!0)).returnValue?gb-1:this.Le.length-1,gb=0>gb?0:gb)}else Aa?
(({jEb:gb}=this.G3b(this.base,this.Le,pb,!0)).returnValue||(({jEb:gb}=this.G3b(this.base,this.Le,pb,!1)).returnValue?gb+=1:(gb=Gb?this.Le.length-1:0,gb=0>gb?0:gb)),xb=Gb?pb+1:pb):(({jEb:gb}=this.G3b(this.base,this.Le,pb,!1)).returnValue||(({jEb:gb}=this.G3b(this.base,this.Le,pb,!0)).returnValue?--gb:(gb=pb?this.Le.length-1:0,gb=0>gb?0:gb)),xb=Gb?pb:pb-1);return{returnValue:!0,gyb:xb,sCa:gb}}G3b(pb,Aa,xb,gb){let Xa=null;if(gb)for(;xb<pb.length;xb++){if(pb.J(xb).xm){Xa=pb.J(xb).xm;break}}else for(;0<=
xb;xb--)if(pb.J(xb).xm){Xa=pb.J(xb).xm;break}if(Xa)for(pb=0;pb<Aa.length;pb++)if(Aa.J(pb)===Xa)return Aa=pb,{returnValue:!0,jEb:Aa};return{returnValue:!1,jEb:-1}}Mjl(pb,Aa){for(let xb=0;xb<pb.length;xb++)if(pb.J(xb).xm===Aa)return xb;return-1}dDd(pb,Aa,xb=-1){for(xb=0>xb?Aa:xb;xb>=Aa;xb--)pb.J(xb).xm&&(pb.J(xb).xm.xm=null),pb.FF(xb)}Chf(pb,Aa){let xb=0;for(;0<=Aa;Aa--)xb+=pb.J(Aa).length;return xb}MWl(pb){pb=Object(v.a)(sa.a,pb);pb||(a.a.instance.Sa(575706448,1,2,"GetTextBlock"),this.ae.logger.Vg(Object.assign(new F.a,
{tj:"GetTextBlock",eventId:"8ujvq"})));return pb}pil(pb,Aa){let xb="";for(;pb>=Aa&&this.Le.J(pb).xm&&2!==this.Le.J(pb).type;)xb=this.MWl(this.Le.J(pb)).text+xb,pb--;Aa=0>pb?0:this.Chf(this.Le,pb);pb+=1;return{returnValue:new Qa.a(Aa,xb),BXm:pb}}sYl(pb){let Aa,xb,gb=!1;xb=Aa=0;if(!pb.xm)return{returnValue:!1,h2b:Aa,CEh:xb};for(Aa=0;Aa<this.Le.length;Aa++){if(this.Le.J(Aa).xm===pb){gb=!0;break}xb+=this.Le.J(Aa).length}return{returnValue:gb,h2b:Aa,CEh:xb}}x7e(pb,Aa,xb){xb=xb===pb.length?--xb:xb;xb>pb.length-
1&&(a.a.instance.Sa(571757957,1,2,"DeleteEopInList: Idx out of range"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"DeleteEopInList",eventId:"8ffwf"})));if(2===pb.J(xb).type){const gb=pb.J(xb);if(gb.Jj!==Aa.Bg||gb.Pc!==Aa.Pc)return!1;this.dDd(pb,xb);return!0}return!1}}Object(D.a)(ob,"ParagraphMergeUsingHintsTwinListLcs",null,[2002]);var fc=c(1525),Eb=c(1492),Ib=c(1661);c.d(L,"a",function(){return Nb});class Nb{constructor(pb,Aa,xb,gb,Xa,Va,Gb=null,Xb=null,rc=null){this.gP=this.psa=this.ZIa=this.oqa=
null;this._initialized=!1;this.ae=pb;this.aF=Aa;this.EAa=gb;this.nza=xb;this.Sqa=Xa;this.sne=new e.a;for(pb=0;pb<this.aF.length;pb++)this.sne.add(this.aF.J(pb).id);this.RJg=new e.a;for(pb=0;pb<this.nza.length;pb++)this.RJg.add(this.nza.J(pb).id);this.G9g=new e.a;for(pb=0;pb<this.EAa.length;pb++)this.G9g.add(this.EAa.J(pb).id);this.Qg=Va;this.YPe=Gb||G.a.instance;this.QH=Xb;this.cW=rc;this.etb=1===(this.QH&&this.cW&&1===this.QH.wHa&&1===this.cW.wHa?1:0);this.Rqa=0}get TZf(){return 1!==this.Rqa}Lem(){var pb=
!0;if(this.QH&&this.cW)return pb;if(this.QH||this.cW)return a.a.instance.Sa(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.ae.runtime.uu.ub(A.a.VK)&&(pb=this.ae.runtime.uu.J(A.a.VK),pb=this.peg(pb,this.ae.runtime.LBa.id,"favored")&&({updateHints:this.QH}=this.xdi(pb,this.sne,this.RJg,this.ae.runtime.uu,"favored")).returnValue);pb&&this.ae.runtime.vq.ub(A.a.VK)&&
(pb=this.ae.runtime.vq.J(A.a.VK),pb=this.peg(pb,this.ae.runtime.LBa.id,"unfavored")&&({updateHints:this.cW}=this.xdi(pb,this.sne,this.G9g,this.ae.runtime.vq,"unfavored")).returnValue);this.QH=this.QH?this.QH:new Ib.a(new k.a,0);this.cW=this.cW?this.cW:new Ib.a(new k.a,0);pb&&this.ae.input.lEb&&(pb=this.ae.input.Z8.last().a0a(A.a.VK),pb=this.peg(pb,this.ae.input.Z8.last().rW.id,"alreadyMerged"));return pb}Vcm(){const pb=new e.a;if(this.etb)return pb;const Aa=this.QH?this.QH.updateHints.p4():new k.a;
let xb=0;for(;xb<Aa.length-1;){const gb=Aa.J(xb);let Xa,Va=!1;for(Xa=xb+1;Xa<Aa.length;Xa++){const Gb=Aa.J(Xa);if(gb.oki(Gb)){pb.add(gb.id);Aa.FF(Xa);Aa.FF(xb);Va=!0;break}}Va||xb++}return pb}peg(pb,Aa,xb){pb=this.Qg.getPropertyString(pb,l.a.YSa);pb=m.a.Gf(pb);return Aa.equals(pb)?!0:(this.I2c(2),a.a.instance.Sa(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.ae.runtime.LBa.id,
pb,xb),!1)}xdi(pb,Aa,xb,gb,Xa){let Va;Va=new Ib.a(new k.a,0);pb=this.Qg.getPropertyObjectIds(pb,l.a.v0).p4();for(let Xb=0;Xb<pb.length;Xb++){if(!gb.ub(pb.J(Xb)))return a.a.instance.Sa(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",pb.J(Xb),Xa),{returnValue:!1,updateHints:Va};const rc=gb.J(pb.J(Xb));var Gb=m.a.Gf(this.Qg.getPropertyString(rc,l.a.Bia));if(Aa.contains(Gb)||xb.contains(Gb)){Gb=this.YPe.GMc(rc);
if(!Gb)return a.a.instance.Sa(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",rc.id,Xa),{returnValue:!1,updateHints:Va};Va.updateHints.add(Gb)}}0<pb.length&&a.a.instance.Sa(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Xa,pb.Oq(),Va.updateHints.Oq());return{returnValue:!0,updateHints:Va}}Wdm(){return({gK:this.oqa,
uIc:this.ZIa,S6c:this.psa}=fc.a.gAh(this.ae,this.Qg,this.aF,this.nza,this.EAa,this.Sqa,!0,!0)).returnValue?!0:!1}Iem(pb){const Aa=fc.a.MBd(this.Qg,xb=>this.ae.runtime.nk.J(xb),this.aF,1,this.Sqa,!0,!0).returnValue;if(!Aa)return a.a.instance.Sa(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.gP=this.etb?new ob(this.ae,Aa,1):new Ma(this.ae,Aa,pb,this.QH?this.QH.wHa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;
if(!this.Lem()||!this.Wdm())return!1;const pb=this.Vcm();return this.Iem(pb)?!0:!1}C_h(pb){const Aa=new k.a;let xb="";for(let gb=0;gb<pb.length;gb++){const Xa=pb.J(gb);Xa.B3()?xb+=pb.J(gb).text:2===Xa.type?(Aa.add(new da(Xa.Jj,Xa.type,xb,Xa.Pc)),xb=""):4===Xa.type&&(Aa.add(new da(Xa.Jj,Xa.type)),xb="")}return Aa}validateUpdateHintsAreComplete(pb,Aa,xb){Aa=this.C_h(Aa);pb=this.C_h(pb);let gb=Aa.length===pb.length;if(gb)for(let Xa=0;Xa<Aa.length;Xa++)if(!Aa.J(Xa).isEqual(pb.J(Xa))){gb=!1;break}gb||
(this.I2c(4),a.a.instance.Sa(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",xb,pb.Oq(),Aa.Oq()));return gb}hjh(pb,Aa,xb){(Aa=({F6a:pb}=this.unk(pb,Aa,xb)).returnValue)||this.I2c(this.gP.mergeConflict?1:3);return{returnValue:Aa,F6a:pb}}unk(pb,Aa,xb){let gb;gb=new k.a;let Xa=!0;var Va=0;let Gb=null,Xb=this.QH?this.QH.updateHints.length:0;for(var rc=0;rc<Xb&&Xa;rc++)Gb=this.QH.updateHints.J(rc),
Va<this.cW.updateHints.length&&Gb.id.equals(this.cW.updateHints.J(Va).id)&&5!==this.ae.input.source?({returnValue:Xa}=this.gP.XVe(Gb,2),Va++):Xa=this.gP.YVe(Gb,2);if(!Xa)return a.a.instance.Sa(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Gb.toString()),{returnValue:!1,F6a:gb};if(!this.validateUpdateHintsAreComplete(this.gP.Le,this.ZIa,"Favored"))return{returnValue:!1,F6a:gb};if(pb&&1===this.ae.input.Lga&&!this.gP.Bih(Aa,xb,2))return a.a.instance.Sa(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Aa,xb),{returnValue:!1,F6a:gb};Xa=!0;rc=new k.a;for(Xb=this.cW?this.cW.updateHints.length:0;Va<Xb&&Xa;Va++){Gb=this.cW.updateHints.J(Va);let qb;({fu:qb,returnValue:Xa}=this.gP.XVe(Gb,4));Xa&&qb&&rc.VA(rc.length,qb)}return Xa?this.validateUpdateHintsAreComplete(this.gP.base,this.psa,"Unfavored")?pb&&2===this.ae.input.Lga&&!this.gP.Aih(Aa,xb,4)?(a.a.instance.Sa(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Aa,xb),{returnValue:!1,F6a:gb}):{returnValue:!0,
F6a:rc}:{returnValue:!1,F6a:gb}:(a.a.instance.Sa(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Gb.id,Gb.type),{returnValue:!1,F6a:gb})}IJl(){let pb,Aa=0;let xb=0,gb=m.a.nil;for(pb=new w.a;xb<this.gP.base.length;){const Gb=this.gP.base.J(xb);gb.equals(Gb.Jj)||(Aa=0,gb=Gb.Jj);if(5===Gb.type){var Xa=Aa+Gb.length;var Va=void 0;let Xb;const rc=ca(this.psa);if(!({index:Va}=T(rc,Gb.Jj,Aa)).returnValue||!({index:Xb}=T(rc,Gb.Jj,Xa)).returnValue)return a.a.instance.Sa(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Gb.f7c),{returnValue:!1,Kxi:pb};for(Xa=new k.a;Va<Xb;Va++)Xa.add(rc.J(Va));pb.Z(Gb.f7c,Xa)}Aa+=Gb.length;xb++}return{returnValue:!0,Kxi:pb}}JJl(){let pb;pb=new w.a;let Aa=0;for(let gb=0;gb<this.gP.base.length;gb++){const Xa=this.gP.base.J(gb);if(5===Xa.type){var xb=void 0;let Va;const Gb=ca(this.psa);if(!({index:xb}=R(Gb,Aa,this.ae.logger)).returnValue||!({index:Va}=
R(Gb,Aa+Xa.length,this.ae.logger)).returnValue)return a.a.instance.Sa(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,Lxi:pb};const Xb=new k.a;for(;xb<Va;xb++)Xb.add(Gb.J(xb));pb.Z(Xa.f7c,Xb)}Aa+=Xa.length}return{returnValue:!0,Lxi:pb}}imk(pb){let Aa;Aa=new k.a;let xb;if(this.etb){if(!({Lxi:xb}=this.JJl()).returnValue)return{returnValue:!1,eVc:Aa}}else if(!({Kxi:xb}=this.IJl()).returnValue)return{returnValue:!1,eVc:Aa};let gb;gb=this.etb?
new ob(this.ae,ca(this.ZIa),1):new Ma(this.ae,ca(this.ZIa),new e.a,this.QH?this.QH.wHa:0);for(var Xa=0;Xa<pb.length;Xa++)if(!gb.YVe(pb.J(Xa),4))return{returnValue:!1,eVc:Aa};for(pb=gb.Le.length-1;0<=pb;pb--)5===gb.Le.J(pb).type&&(Xa=gb.Le.J(pb).f7c,gb.Le.FF(pb),gb.Le.VA(pb,xb.J(Xa)));this.etb&&(this.UCh(gb.Le),this.UCh(this.gP.Le));if(!this.validateUpdateHintsAreComplete(this.gP.Le,gb.Le,"Merged"))return{returnValue:!1,eVc:Aa};Aa=gb.Le;return{returnValue:!0,eVc:Aa}}UCh(pb){const Aa=new w.a;for(let xb=
pb.length-1;0<=xb;xb--){const gb=Object(v.a)(I.a,pb.J(xb));gb&&(Aa.ub(gb.Pc)?Aa.J(gb.Pc).source!==gb.source&&pb.FF(xb):Aa.add(gb.Pc,gb))}}tnk(pb){let Aa;if(!({A7c:Aa}=this.gP.Ucf(ca(this.psa))).returnValue)return!1;for(let gb=0;gb<Aa.length;gb++){const Xa=Aa.J(gb);let Va,Gb;if(!({index:Va}=R(pb,Xa.cp,this.ae.logger)).returnValue||!({index:Gb}=R(pb,Xa.cp+Xa.length,this.ae.logger)).returnValue)return a.a.instance.Sa(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.ae.logger.Vg(Object.assign(new F.a,
{tj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var xb=!1;for(let Xb=Va;Xb<Gb&&!xb;Xb++)xb=!Xa.Dwd.xI.equals(pb.J(Xb).xI);if(!xb){for(xb=Va;xb<Gb;xb++)pb.FF(Va);pb.insert(Va,Xa.B7c)}}return!0}snk(pb){let Aa;if(!({Bjc:Aa}=this.gP.Ucf(ca(this.psa))).returnValue)return!1;for(let Xa=0;Xa<Aa.length;Xa++){var xb=Aa.J(Xa);let Va,Gb;if(({index:Va}=T(pb,xb.Bg,xb.cp)).returnValue&&({index:Gb}=T(pb,xb.Bg,xb.cp+xb.B7c.length)).returnValue){var gb=!1;for(let Xb=Va;Xb<Gb&&!gb;Xb++)gb=!xb.Dwd.xI.equals(pb.J(Xb).xI)||
!xb.Dwd.NE.bA(pb.J(Xb).NE);if(gb){if(this.QH&&1===this.QH.wHa||this.cW&&1===this.cW.wHa)return!1}else{for(gb=Va;gb<Gb;gb++)pb.FF(Va);pb.insert(Va,xb.B7c)}}else if(xb=xb.B7c.okm,a.a.instance.Sa(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",xb),xb||this.QH&&1===this.QH.wHa||this.cW&&1===this.cW.wHa)return!1}return!0}COl(pb){let Aa,xb;xb=new k.a;Aa=this.ae.runtime.Ym.J(A.a.VK);let gb;({REf:gb}=Nb.hSh(this.ae,
this.Qg));const Xa=new k.a;for(let Gb=0;Gb<pb.length;Gb++){if(gb.contains(pb.J(Gb).id,(rc,qb)=>rc.equals(qb)))continue;if(this.ae.runtime.Ym.ub(pb.J(Gb).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",pb.J(Gb).id),{returnValue:!1,T3d:Aa,S3d:xb};Xa.add(pb.J(Gb).id);var Va=pb.J(Gb).e0a();const Xb=new Eb.a(Va);Va=Va.Aj();for(const rc of Va)Xb.KB(rc);xb.add(Xb)}pb=this.Qg.getPropertyObjectIds(Aa.rm,l.a.v0);pb.VA(pb.length,Xa);this.Qg.setPropertyObjectIds(Aa.rm,
l.a.v0,pb);return{returnValue:!0,T3d:Aa,S3d:xb}}PJd(pb){return String.format("Name: {0}, Message: {1}, Stack: {2}",pb.name,pb.message,pb.stack)}I2c(pb){0===this.Rqa&&(this.Rqa=pb)}ojc(){let pb;pb=null;let Aa,xb;var gb;try{if({Ym:pb,T3d:Aa,S3d:xb,returnValue:gb}=this.nqo(),gb){if(Aa&&xb){this.ae.runtime.Ym.Z(Aa.rm.id,Aa);for(gb=0;gb<xb.length;gb++){const Xb=xb.J(gb);this.ae.runtime.Ym.Z(Xb.rm.id,Xb)}const Xa=Aa.rm,Va=this.Qg.getPropertyObjectIds(Xa,l.a.v0),Gb=this.Qg.getPropertyString(Xa,l.a.YSa);
a.a.instance.Sa(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Va.Oq(),Gb)}else a.a.instance.Sa(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Ym:pb}}}catch(Xa){a.a.instance.Sa(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.PJd(Xa))}this.I2c(5);a.a.instance.Sa(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.Rqa,this.TZf);this.L2a();this.QH&&1===this.QH.wHa&&this.ae.logger.Vg(Object.assign(new ia.a,{eventId:"bc04c",tj:"ParagraphMergeUsingHints.TryDoMerge",info:r[this.Rqa]+"/LCS"}));return{returnValue:!1,Ym:pb}}nqo(){let pb,Aa,xb;xb=Aa=pb=null;let gb;gb=this.initialize();this.ae.logger.dU("PMUH Initialize");let Xa=null;gb=gb&&({F6a:Xa}=this.hjh(!1,m.a.nil,0)).returnValue;this.ae.logger.dU("PMUH ApplyUpdateHints");let Va=new k.a;gb=gb&&({eVc:Va}=this.imk(Xa)).returnValue;this.ae.logger.dU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
gb=this.etb?gb&&this.tnk(Va):gb&&this.snk(Va);this.ae.logger.dU("PMUH ApplyUnfavoredFormattingChanges");this.etb&&!this.SMn(Va)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.ae.logger.Vg(Object.assign(new F.a,{tj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),gb=!1);const Gb=this.zLd(Va);gb=gb&&({R3d:pb}=fc.a.uLc(this.ae,this.Qg,this.Sqa,Va,Gb)).returnValue;this.ae.logger.dU("PMUH GetMergeableObjectsFromMergeBlocks");this.QH&&1===this.QH.wHa&&this.cW&&1===this.cW.wHa||(gb=
gb&&({T3d:Aa,S3d:xb}=this.COl(H(Xa))).returnValue,this.ae.logger.dU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:gb,mergeConflict:!!this.gP&&this.gP.mergeConflict,Ym:pb,T3d:Aa,S3d:xb}}zLd(pb){const Aa=new k.a;for(let xb=0;xb<pb.length;xb++)2===pb.J(xb).type&&Aa.add(pb.J(xb).Jj);return Aa}uif(pb){const Aa=new k.a;for(let xb=0;xb<pb.length;xb++)2===pb.J(xb).type&&Aa.add(pb.J(xb));return Aa}SMn(pb){var Aa=this.uif(this.oqa),xb=this.uif(this.ZIa),gb=this.uif(this.psa),Xa=this.zLd(Aa),
Va=this.zLd(xb),Gb=this.zLd(gb);Va=K.b(Xa,Va,Gb);Xa=new k.a;for(Gb=0;Gb<Va.length;Gb++)Xa.VA(Xa.length,Va.J(Gb).Ojl());Va=this.Tjl(pb);Aa=this.Pjl(Va,Xa,Aa,xb,gb);xb=0;gb=new e.a;for(Xa=0;Xa<pb.length;Xa++)if(Va=pb.J(Xa),2===Va.type)if(gb.contains(Va.Jj))if(xb<Aa.length)pb.FF(Xa),pb.insert(Xa,Aa.J(xb)),xb++;else return!1;else gb.add(Va.Jj);0<pb.length&&2!==pb.J(pb.length-1).type&&xb<Aa.length&&pb.insert(pb.length,Aa.J(xb));return!0}Tjl(pb){const Aa=new e.a;for(let xb=0;xb<pb.length;xb++)2===pb.J(xb).type&&
Aa.add(pb.J(xb).Jj);return Aa}Pjl(pb,Aa,xb,gb,Xa){const Va=new k.a;for(let Gb=0;Gb<Aa.length;Gb++){const Xb=Aa.J(Gb);if(!pb.contains(Xb)){let rc;(({block:rc}=this.Lcf(gb,Xb)).returnValue||({block:rc}=this.Lcf(Xa,Xb)).returnValue||({block:rc}=this.Lcf(xb,Xb)).returnValue)&&rc&&Va.add(rc)}}return Va}Lcf(pb,Aa){for(let xb=0;xb<pb.length;xb++)if(2===pb.J(xb).type&&pb.J(xb).Jj===Aa)return pb=pb.J(xb),{returnValue:!0,block:pb};return{returnValue:!1,block:null}}L2a(){const pb=new k.a;fc.a.dac(this.Qg,"BaseObjects_",
this.aF,pb);fc.a.dac(this.Qg,"FavoredObjects_",this.nza,pb);fc.a.dac(this.Qg,"ConflictObjects_",this.EAa,pb)}bzk(){let pb,Aa;pb=m.a.nil;Aa=-1;let xb=0;for(let gb=0;gb<this.gP.Le.length;gb++){const Xa=this.gP.Le.J(gb);if(Xa.B3())xb+=Xa.length;else if(6!==Xa.type)xb=0;else return pb=Xa.Jj,Aa=xb,{returnValue:!0,objectId:pb,cp:Aa}}a.a.instance.Sa(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:pb,cp:Aa}}b7c(pb,Aa){let xb,gb;gb=Aa;xb=pb;try{let Xa=
this.initialize();if(Xa=(Xa=Xa&&this.hjh(!0,pb,Aa).returnValue)&&({objectId:xb,cp:gb}=this.bzk()).returnValue)return a.a.instance.Sa(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",xb,gb),{returnValue:!0,H4a:xb,Voa:gb}}catch(Xa){a.a.instance.Sa(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.PJd(Xa))}this.I2c(5);a.a.instance.Sa(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.Rqa,this.TZf);this.L2a();return{returnValue:!1,H4a:xb,Voa:gb}}static hSh(pb,Aa){let xb;xb=new k.a;if(!pb.input.lEb)return{returnValue:!0,REf:xb};pb=pb.input.Z8.last().a0a(A.a.VK);xb=Aa.getPropertyObjectIds(pb,l.a.v0);return{returnValue:!0,REf:xb}}static njn(pb){if(!fc.a.O9e(pb))return!0;const Aa=new z.a;pb.runtime.Ym.Z(A.a.VK,fc.a.Mem(pb,Aa));return!0}static Vin(pb){if(!pb.runtime.Ym.ub(A.a.VK)||!pb.runtime.vq.ub(A.a.VK))return!0;const Aa=new z.a,xb=pb.runtime.Ym.J(A.a.VK);var gb=Aa.getPropertyString(xb.rm,
l.a.YSa);if(m.a.Gf(gb).equals(m.a.nil))return!0;gb=Aa.getPropertyObjectIds(xb.rm,l.a.v0);const Xa=Aa.getPropertyObjectIds(pb.runtime.vq.J(A.a.VK),l.a.v0);let Va;({REf:Va}=Nb.hSh(pb,Aa));for(let Gb=0;Gb<Xa.length;Gb++)gb.contains(Xa.J(Gb),(Xb,rc)=>Xb.equals(rc))||Va.contains(Xa.J(Gb),(Xb,rc)=>Xb.equals(rc))||(gb.add(Xa.J(Gb)),pb.runtime.Ym.Z(Xa.J(Gb),new Eb.a(pb.runtime.vq.J(Xa.J(Gb)).aH())));Aa.setPropertyObjectIds(xb.rm,l.a.v0,gb);return!0}}Object(D.a)(Nb,"ParagraphMergeUsingHints",null,[1920])},
1595:function(D,L,c){D=c(0);class l{constructor(v){this.wAi=v;this.succeeded=!1;this.ijc=v?v.ijc:0;this.sxm=!1;this.length=this.Yjo=0}}Object(D.a)(l,"TrieResult",null,[]);class e{constructor(v,r,z){this.Ljb=new l(null);this.xPm=v;this.xUc=r;this.wvi=r+z-1}get result(){return this.Ljb}U_h(){let v;return this.xUc<=this.wvi?(v=this.xPm.charAt(this.xUc),++this.xUc,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}CWf(v,r,z){v&&(this.Ljb.sxm=!0,this.Ljb.Yjo=r);this.Ljb.length=this.xUc;this.Ljb.succeeded=
!0;this.Ljb.ijc=z;this.xUc!==this.wvi+1&&(this.Ljb=new l(this.Ljb))}}Object(D.a)(e,"LookUpStringVisitor",null,[1262]);var a=c(1677);class k{constructor(){this.vqh=this.Wnh=this.Ynh=this.Vnh=this.Xnh=this.eZe=this.cZe=this.gZe=this.bZe=0}}Object(D.a)(k,"TRIESTATS",null,[]);class m{constructor(){this.symbol=this.XVc=0}}Object(D.a)(m,"TrieSymbol",null,[]);c.d(L,"a",function(){return w});class w{constructor(v,r){this.D3=null;this.xYd=this.Lvi=this.Jvi=this.Nvi=this.Fvi=this.Mvi=this.Kvi=this.Ovi=this.Gvi=
0;this.eJ=v;if(v.ly(r,4)!==w.wyb)throw Error.argument("Input does not represent a trie");r+=4;this.yvi=1===v.ly(r,4);r+=4;this.uPm=1===v.ly(r,4);r+=4;this.qPm=v.ly(r,4);r+=4;if(v.ly(r,4)){v=r+4;this.D3=this.Ctn(v);this.Gvi=r=v+w.txk;this.Ovi=r+=w.xxd*(this.D3.bZe+(this.D3.bZe%2?1:0));this.Kvi=r+=w.xxd*(this.D3.gZe+(this.D3.gZe%2?1:0));this.Mvi=r+=w.xxd*(this.D3.cZe+(this.D3.cZe%2?1:0));this.Fvi=r+=w.xxd*(this.D3.eZe+(this.D3.eZe%2?1:0));this.Nvi=r+=w.iZe*this.D3.Vnh;this.Jvi=r+=w.jZe*this.D3.Ynh;
this.Lvi=r+=w.jZe*this.D3.Wnh;r+=w.jZe*this.D3.Xnh;if(r!==v+this.D3.vqh)throw Error.argument("Corrupted trie binary");this.xYd=r}else this.D3=null}Wui(v,r,z,A){v=new e(v,r,z);this.Nsj(v,A);return v.result}R4h(v){if(this.yvi)if(v)--v;else return"";if(!this.D3)throw Error.argument("Invalid trieID");const r=new a.a;r.ZE=0;this.iOb(r);const z=[];for(;;){if(r.ZE&w.u7a)if(v)--v;else return Array.add(z,r.lPb),String.fromCharCode.apply(null,z);const A=!!(r.ZE&w.Gke),G=this.H4b(r,!0);if(A||v<G){if(Array.add(z,
r.lPb),!this.iOb(r))throw Error.argument("Invalid trieID");}else if(v-=G,!this.r6c(r))throw Error.argument("Invalid trieID");}}Nsj(v,r){let z=0;this.yvi&&(v.CWf(this.uPm,this.qPm,0),++z);if(this.D3){var A=new a.a;A.ZE=0;if(this.iOb(A))for(;;){var G=void 0;if(!({ch:G}=v.U_h()).returnValue)break;r&&(G=r(G));G=G.toString().charCodeAt(0);let H=!1;for(;!H;){const I=!!(A.ZE&w.u7a);if(A.lPb===G){if(H=!0,I&&v.CWf(!!(A.ZE&w.ukg),A.Uee,z),!this.iOb(A))return}else if(z+=this.H4b(A,!0),!this.r6c(A))return;I&&
++z}}}}iOb(v){if(!v.ZE)return this.Eag(v),!0;if(!(v.ZE&w.Fke))return!1;v.vOa=0;v.nx=v.vhb;this.Eag(v);return!0}r6c(v){if(v.ZE&w.Gke)return!1;this.Eag(v);return!0}H4b(v,r){return v.ZE&w.tkg?v.wxd:v.ZE&w.Fke?!r&&v.ZE&w.Gke?this.Ayl(v):1:0}Ayl(v){v=w.N0e(v);if(!this.iOb(v))return 0;let r=0;do v.ZE&w.u7a&&++r,r+=this.H4b(v,!1);while(this.r6c(v));return r}Eag(v){v.ZE||(v.vOa=0,v.nx=this.xYd);var r=this.LCd(this.Gvi,v.nx),z=r.symbol;v.nx+=r.XVc;r=this.eJ.ly(this.Fvi+w.iZe*z,w.iZe);v.lPb=r&65535;v.ZE=r>>
16;v.ZE&w.tkg&&(v.wxd=this.r_k(v));v.ZE&w.ukg&&(r=this.LCd(this.Ovi,v.nx),z=r.symbol,v.nx+=r.XVc,v.Uee=this.eJ.ly(this.Nvi+4*z,4));v.ZE&w.GAj?(v.vhb=this.xYd+((this.eJ.J(v.nx)<<8|this.eJ.J(v.nx+1))<<8|this.eJ.J(v.nx+2)),v.nx+=3):v.ZE&w.HAj?(v.vhb=v.nx,v.vOa=v.vhb):v.ZE&w.IAj?(r=this.LCd(this.Kvi,v.nx),z=r.symbol,v.nx+=r.XVc,v.vhb=this.xYd+this.eJ.ly(this.Jvi+4*z,4)):v.ZE&w.Fke&&(r=this.LCd(this.Mvi,v.nx),z=r.symbol,v.nx+=r.XVc,v.vOa||(v.vOa=v.nx),v.vOa+=this.eJ.ly(this.Lvi+4*z,4),v.vhb=v.vOa)}LCd(v,
r){const z=new m;let A=0;for(;;){A+=this.eJ.J(r);++r;++z.XVc;const G=this.eJ.ly(v,2);if(A<G)break;z.symbol+=G;A-=G;v+=2;A<<=8}z.symbol+=A;return z}r_k(v){let r=this.eJ.J(v.nx);192<=r?(r=(r&63)<<15|(this.eJ.J(v.nx+1)&127)<<8,r|=this.eJ.J(v.nx+2),v.nx+=3):128<=r?(r=(r&127)<<8|this.eJ.J(v.nx+1),v.nx+=2):v.nx+=1;return r}Ctn(v){const r=new k;r.bZe=this.eJ.ly(v+12,2);r.gZe=this.eJ.ly(v+14,2);r.cZe=this.eJ.ly(v+16,2);r.eZe=this.eJ.ly(v+18,2);r.Xnh=this.eJ.ly(v+24,4);r.Vnh=this.eJ.ly(v+28,4);r.Ynh=this.eJ.ly(v+
32,4);r.Wnh=this.eJ.ly(v+36,4);r.vqh=this.eJ.ly(v+40,4);return r}static N0e(v){const r=new a.a;r.lPb=v.lPb;r.ZE=v.ZE;r.wxd=v.wxd;r.nx=v.nx;r.vhb=v.vhb;r.vOa=v.vOa;r.Uee=v.Uee;return r}}w.wyb=1654263084;w.txk=48;w.xxd=2;w.jZe=4;w.iZe=4;w.u7a=1;w.Gke=2;w.tkg=4;w.ukg=8;w.Fke=16;w.HAj=64;w.IAj=128;w.GAj=256;Object(D.a)(w,"Trie",null,[1263])},1597:function(D,L,c){c.r(L);D=c(0);c(1459);var l=c(1477);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(D.a)(e,"AppsForOfficeStoreType",null,[]);
var a=c(1457),k=c(2),m=c(83),w=c(13);class v{constructor(){this.KMe=0}GTf(F,J){this.KMe=window.performance.now();this.kTa(()=>{const N=window.performance.now(),O={},M=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);J.ihk&&(O.callback=T=>{F(T,e.marketPlace,N)},M&&(O.storeType=e.marketPlace),k.AFrameworkApplication.ya.Ub(w.a.cKb,2,O));J.jhk&&(O.callback=T=>{F(T,e.privateCatalog,N)},M?O.storeType=e.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",
!0)?O.storeType=10:O.storeType=e.privateCatalog,k.AFrameworkApplication.ya.Ub(w.a.cKb,2,O))},0,()=>{if(a.TellMeActor.instance.Qe)a.TellMeActor.instance.Qe.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.KMe)+" ms")})}kTa(F,J=0,N=null){2!==k.AFrameworkApplication.ya.processAction(w.a.cKb,1)?(a.TellMeActor.instance.Qe&&a.TellMeActor.instance.Qe.hA(l.a.ghk,window.performance.now()-this.KMe),F()):J<v.BSm?k.AFrameworkApplication.uc.Xb(new m.a(2,
1,v.XFo,()=>{this.kTa(F,J+1,N)})):N&&N()}static get instance(){v._instance||(v._instance=new v);return v._instance}}v._instance=null;v.BSm=20;v.XFo=500;Object(D.a)(v,"AddinEntitlementsQuery",null,[]);class r{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Tzf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(D.a)(r,"AddinInfo",null,[]);var z=c(1460),A=c(1464),G=c(1463),
H=c(1456),I=c(141);c.d(L,"AddinResultsProvider",function(){return K});class K{constructor(F){this.QIe=[];this.oc=F;this.p4m=(J,N,O)=>{if(J){const M=J.errorCode;if(a.TellMeActor.instance.Qe){const T={};T.StoreType=N;T.ErrorCode=M;T.AddinCount=J.value?J.value.length:0;a.TellMeActor.instance.Qe.hA(l.a.zrl,window.performance.now()-O,T)}if(0===M&&J.value){K.Qxb=K.Qxb||{};J=J.value;for(const T of J)J=new r,J.displayName=T[0],J.id=T[1],J.description=T[2],J.targetType=T[3],J.appVersion=4<T.length?T[4]:"",
J.assetId=5<T.length?T[5]:"",J.assetStoreId=6<T.length?T[6]:"",J.width=7<T.length?T[7]:0,J.height=8<T.length?T[8]:0,J.iconUrl=9<T.length?T[9]:"",J.providerName=10<T.length?T[10]:"",J.storeId=11<T.length?T[11]:"",J.storeType=12<T.length?T[12]:"",this.oc.V1i&&(J.Tzf=this.pHl(J)),K.Qxb[J.id]=J,0<J.iconUrl.length&&(N="AddinIcon_"+J.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.wTi(N,J.iconUrl):appChrome.addInApi.registerAddinIcon(N,
J.iconUrl))}}};v.instance.GTf(this.p4m,this.oc)}uK(){return"Add-ins"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(F,J,N,O,M=null){N=new G.a(F);M&&!Array.contains(M,25)||H.a.rQ(F)||(M=new A.a(25),M.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.QGl(F.Ig,M),N.Lv(M));J.resultsUpdated(N)}QGl(F,J){if((F=this.bRn(F))&&0<F.length){let N=0;F.forEach(O=>{if(!(3<++N)){var M="AddinSuggestion"+N,T={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)){var R="AddinIcon_"+O.id;0>Array.indexOf(this.QIe,R)&&0<O.iconUrl.length&&this.wTi(R,O.iconUrl);T["default"]=0<=Array.indexOf(this.QIe,R)?R:"AppForOfficeLogo_20"}else T["default"]=0<O.iconUrl.length?"AddinIcon_"+O.id:"AppForOfficeLogo_20";R=[];R.push(appChrome.actions.setControlLabel(M,O.displayName));R.push(appChrome.actions.setControlIconSet(M,T));R.push(appChrome.actions.setCompoundButtonCommandValueId(M,O.id));R.push(appChrome.actions.updateCompoundButtonDescription(M,O.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",
!0)&&(T=window.performance.now(),R.push(appChrome.actions.updateControlEnabledDisabledState(M,!1)),a.TellMeActor.instance.Qe&&a.TellMeActor.instance.Qe.hA(l.a.hal,window.performance.now()-T));appChrome.api.dispatch(R);M=new z.a(M,26,void 0,void 0,1);M.fI=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.id,O.storeType,O.assetId,null,null,O.storeId);J.Ly(M)}})}}wTi(F,J){I.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(F,J),Array.add(this.QIe,F))}bRn(F){if(!K.Qxb)return null;
const J=[],N=K.Qxb;for(let M in N){var O=N[M];O&&(this.oc.V1i?K.FRm(F,O)&&Array.add(J,O):0<=O.displayName.toLowerCase().indexOf(F.toLowerCase())?Array.add(J,O):this.oc.yvm&&0<=O.description.toLowerCase().indexOf(F.toLowerCase())&&Array.add(J,O))}return J}pHl(F){const J=K.Ndj(F.displayName);this.oc.hhk&&Array.addRange(J,K.Ndj(F.description));return J}static FRm(F,J){if(!J.Tzf)return!1;for(const N of F.split(" ")){F=!1;for(const O of J.Tzf)if(O.toLowerCase().startsWith(N.toLowerCase())){F=!0;break}if(!F)return!1}return!0}static Ndj(F){const J=
[];for(const N of F.split(" ")){F=0;for(let O=0;O<N.length;O++){const M=N.charAt(O);M.toString().toUpperCase()===M.toString()&&O>F&&(Array.add(J,N.substring(F,O)),F=O)}Array.add(J,N.substring(F,N.length));F&&Array.add(J,N.substring(0,N.length))}return J}}K.Qxb=null;Object(D.a)(K,"AddinResultsProvider",null,[1099])},1659:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(228);class e{constructor(){this.Blb=this.Clb=this.BZa=this.Whb=this.Alb=this.leb=this.Uhb=this.$3a=this.meb=this.Vhb=
null;this.reset()}reset(){this.Vhb=new l.a;this.meb=new l.a;this.$3a=new l.a;this.Uhb=new l.a;this.leb=new l.a;this.Alb=new l.a;this.Whb=new l.a;this.BZa=new l.a;this.BZa=new l.a;this.Clb=new l.a;this.Blb=new l.a}FEo(a){return this.lOa(this.Vhb,a)&&this.lOa(this.meb,a)&&this.lOa(this.$3a,a)&&this.lOa(this.Uhb,a)&&this.lOa(this.leb,a)&&this.lOa(this.Alb,a)&&this.lOa(this.Whb,a)&&this.lOa(this.BZa,a)&&this.lOa(this.Clb,a)&&this.lOa(this.Blb,a)}lOa(a,k){return!a||!a.length||a.length===k}}Object(D.a)(e,
"MergeableTrackedChangesProperties",null,[])},1660:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(228),e=c(621);class a{constructor(){this.ZHa=new l.a;this.YIa=new l.a;this.rLa=new l.a}get eyb(){return this.ZHa}get kcf(){return this.YIa}get Bob(){return this.rLa}get isEmpty(){return!this.ZHa.length&&!this.YIa.length&&!this.rLa.length}get oEf(){return Math.max(Math.max(this.ZHa.length,this.YIa.length),this.rLa.length)}get YUm(){return Math.min(Math.min(this.ZHa.length,this.YIa.length),
this.rLa.length)}Lvd(k){this.ZHa.add(k)}Nvd(k){this.YIa.add(k)}Rvd(k){this.rLa.add(k)}Ojl(){const k=new e.a,m=new l.a;let w=0;for(;w<this.ZHa.length||w<this.YIa.length||w<this.rLa.length;)w<this.ZHa.length&&!k.contains(this.ZHa.J(w))&&(m.add(this.ZHa.J(w)),k.add(this.ZHa.J(w))),w<this.YIa.length&&!k.contains(this.YIa.J(w))&&(m.add(this.YIa.J(w)),k.add(this.YIa.J(w))),w<this.rLa.length&&!k.contains(this.rLa.J(w))&&(m.add(this.rLa.J(w)),k.add(this.rLa.J(w))),w++;return m}}Object(D.a)(a,"ObjectCollection",
null,[])},1661:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.wHa=a;this.updateHints=e}}Object(D.a)(l,"UpdateHintCollection",null,[])},1662:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(e,a){super();this.Bg=e;this.Pc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Pc)}}Object(D.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1663:function(D,
L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(228);c=c(1520);class e extends c.a{constructor(a){super();this.TZ=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let k=0;k<this.TZ.length;k++)a+=String.format("({0}), ",this.TZ.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(D.a)(e,"LcsInsertUpdateHint",c.a,[])},1664:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(e,a){super();this.text=a;this.Bg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Bg,this.text)}}Object(D.a)(l,"LcsInsertTextUpdateHint",c.a,[])},1665:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(e,a,k){super();this.cp=e;this.Bg=a;this.Pc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Pc)}}Object(D.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1666:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(e,
a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(D.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1667:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1491);class l extends c.a{constructor(){super()}get ifa(){return"Conflict"}}Object(D.a)(l,"ConflictMergeFailureDetail",c.a,[])},1668:function(D,L,c){c.r(L);c.d(L,"InsightsMenuItemFactory",function(){return k});D=c(0);var l=c(1456),e=c(239),
a=c(16);class k{constructor(m=null){this.WPj=m||CommonUIStrings.l_InsightsButtonText}get gLb(){return 10}Qea(m){var w=m.kC;m=l.a.mga()?l.a.zMa(w,1):l.a.Nzb(w);w=String.format(this.WPj,w);return this.Upl(m,w)}Upl(m,w){return e.a(k.Iei,l.a.mga()?"1914896509":"3317204163",a.a.Cf(w),l.a.jtf,null,a.a.Cf(m),a.a.Cf(w),null,null)}}k.Iei="bInsights";Object(D.a)(k,"InsightsMenuItemFactory",null,[1098])},1669:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(239),e=c(16);class a{constructor(k,m,
w,v,r){this.zKe=k;this.yKe=m;this.Q4j=w;this.BOj=v;this.hOg=r}get gLb(){return 4}Qea(k,m=null){m=m.sessionId+"|"+m.fna+"|"+k.kC;if(this.hOg||this.BOj){let w=this.hOg||e.a.lA(CommonUIStrings.l_HelpTooltip)===e.a.lA(k.kC.trim());if(this.Q4j&&2<k.kC.length){const v=k.kC;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===a.cqf&&(w=!0)}k=w?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.kC);return this.wRh(m,e.a.Cf(k),w)}return this.wRh(m,
e.a.Cf(String.format(CommonUIStrings.l_TextWithQuotation,k.kC)),!1)}wRh(k,m,w){return l.a(a.cqf,w?this.yKe:this.zKe,m,"OfficeAssistant_16x16x32","A0",e.a.Cf(k),m,null,null)}}a.cqf="bSearchHelp";Object(D.a)(a,"AssistanceMenuItemFactory",null,[1098])},1670:function(D,L,c){c.d(L,"a",function(){return m});D=c(0);var l=c(2),e=c(239),a=c(95),k=c(16);class m{get gLb(){return 13}Qea(){return m.yuk()}static yuk(){return e.b(m.zOh,"798637440",k.a.Cf(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Cr,
a.getImageClass("Info_32x32x32"),null,null,k.a.Cf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,k.a.Cf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}m.zOh="bTellMeFirstRun";Object(D.a)(m,"FirstRunMenuItemFactory",null,[1098])},1671:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(2),e=c(239),a=c(16);class k{constructor(m=null,w=null){this.CXg=m;this.EVj=w||CommonUIStrings.l_LookupNoResultsDescription}get gLb(){return 14}Qea(m){m=String.format(this.EVj,
m.kC);return this.wvk(m)}wvk(m){return e.b(k.IAi,"798637440",a.a.Cf(CommonUIStrings.l_LookupNoResultsTitle),this.CXg?l.AFrameworkApplication.Cr:null,this.CXg,null,null,a.a.Cf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Cf(m),null,null)}}k.IAi="lookupNoResults";Object(D.a)(k,"NoCommandsFoundMenuItemFactory",null,[1098])},1672:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(D.a)(l,
"LabelFormatted",null,[])},1673:function(D,L,c){c.d(L,"a",function(){return w});D=c(0);c(1459);var l=c(1460),e=c(1464),a=c(1463),k=c(1456),m=c(16);class w{constructor(v){this.oc=v}uK(){return"Assistance"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:this.oc.nXc?3:2}qH(v,r,z=!1,A,G=null){A=new a.a(v);if((!G||Array.contains(G,8))&&!k.a.rQ(v)){G=new e.a(8);if(z){z=m.a.lA(CommonUIStrings.l_HelpTooltip)===m.a.lA(v.Ig.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
v.Ig);const H=[];this.oc.j2a&&(this.oc.$be||H.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.k0h(v.Ig));const I="||"+v.Ig;H.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));H.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",I));appChrome.api.dispatch(H);v=new l.a("GetHelpFromTellMe",4,v.Ig,null,1)}else v=new l.a("bSearchHelp",4,v.Ig,null,1);G.Ly(v);G.displayName=CommonUIStrings.l_HelpButtonTitle;A.Lv(G)}r.resultsUpdated(A)}Zgb(v,
r=null){const z=new e.a(8),A=m.a.lA(CommonUIStrings.l_HelpTooltip)===m.a.lA(v.Ig.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.Ig);for(let H=0;H<r.length&&2>H;H++){var G=void 0;G=[];let I="GetHelpWithDescriptionFromTellMe"+(H+1).toString(),K=4;if(this.oc.x3c)G.push(appChrome.actions.setControlLabel(I,A)),G.push(appChrome.actions.setCompoundButtonCommandValueId(I,v.Ig)),G.push(appChrome.actions.updateCompoundButtonDescription(I,this.Inf(r.length)));
else if(this.oc.y3c){let F=this.B6h(r[H]);I="GetHelpFromTellMe"+(H+1).toString();this.oc.j2a&&(F=this.k0h(F));K=9;G.push(appChrome.actions.setControlLabel(I,F));G.push(appChrome.actions.setButtonCommandValueId(I,this.IXl(r[H])))}appChrome.api.dispatch(G);G=new l.a(I,K,null,null,0);G.label=this.B6h(r[H]);G.description=this.HXl(r[H]);z.Ly(G);if(this.oc.y3c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}Inf(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,
v)}k0h(v){return this.oc.yyf?k.a.Yif(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}B6h(v){return v.name?v.name:""}HXl(v){return v.description?v.description:""}IXl(v){return v.id?"AssetID="+v.id:""}}Object(D.a)(w,"AssistanceResultsProvider",null,[1099])},1674:function(D,L,c){c.d(L,"a",function(){return v});D=c(0);c(1459);var l=c(1460),e=c(1464),a=c(1463),k=c(1457),m=c(1456),w=c(1505);class v{constructor(r){this.oc=r}uK(){return"Image"}sT(){return 0===this.oc.Su?
0:1===this.oc.Su?1:3===this.oc.Su?3:2}qH(r,z,A,G,H=null){A=new a.a(r);(!H||Array.contains(H,19))&&m.a.rQ(r)&&this.oc.zO&&this.Zgb(r,A,1);z.resultsUpdated(A)}Zgb(r,z,A,G=null){var H=[];let I;k.TellMeActor.instance.VN()&&k.TellMeActor.instance.VN().j2a?(I=this.oc.yyf?m.a.Yif(r.Ig,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):r.Ig+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.oc.$be||H.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):
I=this.oc.zO?m.a.rQ(r)?this.oc.wcb?m.a.Sfb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.oc.wcb?m.a.Sfb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,r.Ig)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,r.Ig):this.oc.Ogc?CommonUIStrings.l_TellMeImageSuggestionButtonText:r.Ig+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.oc.Xua?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
I)),H=m.a.zMa(r.Ig,9,Object.assign(new w.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",H))):(H.push(appChrome.actions.setControlLabel("ImageForSearch",I)),r=m.a.zMa(r.Ig,9,Object.assign(new w.a,{landingTab:"Image"})),H.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",r)),appChrome.api.dispatch(H));A=new l.a("ImageForSearch",12,null,null,A);G&&(A.score=G.ConfidenceScore);G=new e.a(19,this.oc.Ogc?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);G.Ly(A);z.Lv(G)}}Object(D.a)(v,"ImageResultsProvider",null,[1099])},1675:function(D,L,c){c.d(L,"a",function(){return w});D=c(0);c(1459);var l=c(1460),e=c(1464),a=c(1463),k=c(1456),m=c(2);class w{constructor(v){this.oc=v}uK(){return"Template"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:3}qH(v,r){v=new a.a(v);r.resultsUpdated(v)}Zgb(v,r,z){var A=[];let G;G=this.oc.zO?this.oc.wcb?k.a.Sfb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,v.Ig)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
v.Ig):String.format(CommonUIStrings.l_TellMeTemplateButtonText,v.Ig);A.push(appChrome.actions.setControlLabel("TemplateForSearch",G));A.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(m.AFrameworkApplication.K.lb("TellMeTemplateProviderURL"),m.AFrameworkApplication.uiCulture,v.Ig)));appChrome.api.dispatch(A);v=new e.a(23);v.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;A=new l.a("TemplateForSearch",24,null,null,0);A.label=z[0].Title?z[0].Title:"";A.description=
z[0].Description?z[0].Description:"";v.Ly(A);r.Lv(v)}}Object(D.a)(w,"TemplateResultsProvider",null,[1099])},1676:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);c(1459);var l=c(1493),e=c(1460),a=c(1464),k=c(1463),m=c(1585),w=c(1457),v=c(1456),r=c(16);class z{constructor(A,G,H,I){this.G1=A;this.Ibb=G;this.q9g=I;this.YLj=H;this.oc=w.TellMeActor.instance.VN()}uK(){return"EmptyQuery"}sT(){return 1===this.oc.Su?1:0}qH(A,G,H=!1,I,K=null){I=new k.a(A);if((!K||Array.contains(K,5)||Array.contains(K,
6)||Array.contains(K,4))&&v.a.rQ(A)){this.G1.vKc().length||!this.YLj||this.q9g||(A=new a.a(6),K=new e.a(null,13,void 0,void 0,1),A.Ly(K),I.Lv(A));A=new a.a(4);if(0<this.G1.vKc().length){A.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;K=this.G1.vKc();var F=[];for(var J of K)F.push(J.Id);l.CommandResultsUtility.Y6c(F,this.oc);for(var N of K)l.CommandResultsUtility.gQc(N.Id)&&A.Ly(new e.a(N.Id,5,null,null,2));I.Lv(A)}if(this.q9g&&0<this.Ibb.length&&this.G1.vKc().length<z.maxResults){J=new a.a(5);
J.displayName=CommonUIStrings.l_TellMeTryQueryTitle;N=z.maxResults-A.results.length;A=[];for(K=0;K<this.Ibb.length&&K<N;++K){if(H){F=v.a.jbg+(K+1);const O=this.Ibb[K].key,M=r.a.replaceAll(O,'"',"");A.push(appChrome.actions.setControlLabel(F,O));A.push(appChrome.actions.setButtonCommandValueId(F,M));F=new m.a(O,7,0,M,F)}else F=new m.a(this.Ibb[K].key,7,0,this.Ibb[K].value);J.Ly(F)}0<A.length&&appChrome.api.dispatch(A);I.Lv(J)}}G.resultsUpdated(I)}}z.maxResults=5;Object(D.a)(z,"EmptyQueryResultsProvider",
null,[1099])},1677:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.Uee=this.vOa=this.vhb=this.nx=this.wxd=this.ZE=this.lPb=0}}Object(D.a)(l,"TRIESCAN",null,[])},1697:function(D,L,c){c.r(L);var l=c(0),e=c(1459),a=c(1507),k=c(1477),m=c(1460),w=c(1464),v=c(1463),r=c(1457),z=c(1456),A=c(1505);class G{constructor(hb){this.oc=hb}uK(){return"ActionAI"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb=!1,uc,Xc=null){uc=new v.a(hb);if(!Xc||Array.contains(Xc,24))if(this.B7n()||
!z.a.rQ(hb)){Xc=new w.a(24);var xd=z.a.rQ(hb);Qb&&(Qb=null,z.a.mga()&&(Qb=z.a.zMa(xd?"":hb.Ig,1,Object.assign(new A.a,{landingTab:"ActionAI"}))),this.oc.Xua?Qb&&r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Qb)):(hb=[],Qb&&hb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Qb)),appChrome.api.dispatch(hb)));Xc.Ly(new m.a("ActionAIFromTellMe",25,null,null,1));uc.Lv(Xc)}Ab.resultsUpdated(uc)}B7n(){return z.a.mga()&&this.oc.IRd}}
Object(l.a)(G,"ActionAIResultsProvider",null,[1099]);var H=c(1597);class I{constructor(hb,Ab){this.uya=hb;this.Mk=Ab}resultsUpdated(hb){this.uya.J0n(this.Mk,hb)}}Object(l.a)(I,"AggregatorResultsProviderCallback",null,[1101]);class K{constructor(hb){this.iqa=null;this.oc=hb;this.oc.Xxb&&(this.iqa=null)}uK(){return"AppsForOffice"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb,uc,Xc=null){Qb=new v.a(hb);if(!Xc||Array.contains(Xc,1))Xc=new w.a(1),this.iqa.dQo(Xc,hb.Ig),Qb.Lv(Xc);Ab.resultsUpdated(Qb)}}
Object(l.a)(K,"AppsForOfficeRecommendationResultsProvider",null,[1099]);var F=c(1673),J=c(1453),N=c(1472),O=c(123);class M{constructor(hb,Ab){this.Cb=hb;this.tPm=Ab}isMatch(hb,Ab){if(!Object(O.a)(1221,hb))throw Error.argument("objToTest","Expected feature bundle");let Qb;return({value:Qb}=hb.uq(this.Cb.Usa)).returnValue?this.Cb.reg.isMatch(Qb,Ab):this.tPm}}Object(l.a)(M,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1252]);class T{constructor(hb,Ab){this.Cb=hb;this.uDf=Ab}isMatch(hb){if(!Object(O.a)(1221,
hb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.uDf^hb.uq(this.Cb.Usa).returnValue)}}Object(l.a)(T,"AnnotatedWithAnnotationFilter",null,[1252]);class R{constructor(hb){this.Cb=hb}isMatch(hb,Ab){if(!Object(O.a)(1223,hb))throw Error.argument("objToTest","Expected struct value");return this.Cb.reg.isMatch(hb.jgb(this.Cb.jNa),Ab)}}Object(l.a)(R,"FieldValueMatchesStructFilter",null,[1252]);class W{constructor(hb,Ab){hb&&(this.jNa=hb.J(0),this.reg=Ab.rma(hb.J(1)))}}Object(l.a)(W,
"FieldValueMatchesStructFilterInit",null,[]);class V{constructor(hb){this.uDf=hb}isMatch(hb){if(!Object(O.a)(1221,hb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.uDf^hb.tpf)}}Object(l.a)(V,"HasAnnotationsAnnotationFilter",null,[1252]);class ba{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb,Ab){if(!Object(O.a)(1222,hb))throw Error.argument("objToTest","Expected list value");switch(this.X7){case 0:for(const Qb of hb.items)if(this.Cb.filter.isMatch(Qb,Ab))return!0;
return!1;case 1:for(const Qb of hb.items)if(!this.Cb.filter.isMatch(Qb,Ab))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(ba,"ItemTestListFilter",null,[1252]);class ha{constructor(hb){this.Cb=hb}isMatch(hb,Ab){if(!Object(O.a)(1222,hb))throw Error.argument("objToTest","Expected list value");return this.Cb.filter.isMatch(hb.items.length,Ab)}}Object(l.a)(ha,"LengthMatchesListFilter",null,[1252]);class ca{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb,Ab,Qb=null){let uc=0===
this.X7;for(const Xc of this.Cb.Qrh)if((uc=Xc.isMatch(hb,Ab,Qb))?1===this.X7:0===this.X7)return uc;2===this.X7&&(uc=!uc);return uc}}Object(l.a)(ca,"NonterminalFilter",null,[1252]);class ia{constructor(hb,Ab){if(hb){var Qb=hb.J(0);this.Qrh=Array(Qb);for(let uc=0;uc<Qb;++uc)this.Qrh[uc]=Ab.rma(hb.J(1+uc))}}}Object(l.a)(ia,"NonterminalFilterInit",null,[]);class ra{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb,Ab){if("number"!==typeof hb)throw Error.argument("objToTest","Expected number value");
let Qb=this.Cb.number;if(this.Cb.query){Ab=this.Cb.query.nt(null,Ab);if("number"!==typeof Ab)throw Error.invalidOperation("Query did not return number");Qb+=Ab}switch(this.X7){case 0:return hb===Qb;case 1:return hb<Qb;case 2:return hb<=Qb;case 3:return hb>Qb;case 4:return hb>=Qb;default:throw Error.notImplemented();}}}Object(l.a)(ra,"NumberFilter",null,[1252]);class da{constructor(hb,Ab){hb&&(this.number=hb.J(0),this.query=hb.J(1)?Ab.pK(hb.J(1)):null)}}Object(l.a)(da,"NumberFilterInit",null,[]);class za{constructor(hb,
Ab,Qb){this.TJd=this.lCl;this.zPm=hb;this.Cvi=Ab;this.Bvi=Qb}t_e(hb){this.Cvi=hb}lCl(hb){if(!hb)throw Error.argument("name","Invalid named feature bundle reference");const Ab=hb.substr(1);return 1===hb.charCodeAt(0)&&Ab===this.zPm?this.Cvi:this.Bvi?this.Bvi.TJd(hb):null}}Object(l.a)(za,"SimpleNamedFeatureBundleResolver",null,[1268]);class la{constructor(hb){this.Cb=hb}isMatch(hb,Ab){if(!Object(O.a)(1221,hb))throw Error.argument("objToTest","Expected feature bundle");hb=this.Cb.query.nt(null,new za(this.Cb.wie,
hb,Ab));if("boolean"!==typeof hb)throw Error.invalidOperation("Query did not return bool");return hb}}Object(l.a)(la,"PredicateAnnotationFilter",null,[1252]);class na{constructor(hb,Ab){hb&&(this.wie=Ab.vE(hb.J(0)),this.query=Ab.pK(hb.J(1)))}}Object(l.a)(na,"PredicateAnnotationFilterInit",null,[]);class Ca{constructor(hb){this.Cb=hb}isMatch(hb,Ab){if("boolean"!==typeof hb)throw Error.argument("objToTest","Expected bool value");Ab=this.Cb.query.nt(null,Ab);if("boolean"!==typeof Ab)throw Error.invalidOperation("Query did not return bool");
return hb===Ab}}Object(l.a)(Ca,"QueryBooleanFilter",null,[1252]);class Na{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb,Ab){if("number"!==typeof hb)throw Error.argument("objToTest","Expected integer");Ab=this.Cb.query.nt(null,Ab);if("number"!==typeof Ab)throw Error.invalidOperation("Query did not return an enum value");switch(this.X7){case 0:return hb===Ab;case 1:return 0!==(hb&Ab);case 2:return hb===(hb&Ab);case 3:return Ab===(hb&Ab);default:throw Error.notImplemented();}}}Object(l.a)(Na,"QueryEnumFilter",
null,[1252]);class Ta{constructor(hb,Ab){hb&&(this.ZTd=1===hb.J(0),this.query=Ab.pK(hb.J(1)))}}Object(l.a)(Ta,"QueryEnumFilterInit",null,[]);class Fa{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb,Ab){if(!Object(O.a)(1222,hb))throw Error.argument("objToTest","Expected list value");Ab=this.Cb.query.nt(null,Ab);if(!Object(O.a)(1222,Ab))throw Error.invalidOperation("Query did not return list value");if(hb.F3!==Ab.F3)return!1;switch(this.X7){case 0:return J.Annotations.Vob(J.Annotations.UIl(hb.F3),
hb,Ab);case 1:for(const Qb of hb.items)for(const uc of Ab.items)if(J.Annotations.Vob(hb.F3,Qb,uc))return!0;return!1;case 2:for(const Qb of hb.items)for(const uc of Ab.items)if(!J.Annotations.Vob(hb.F3,Qb,uc))return!1;return!0;case 3:for(const Qb of Ab.items)for(const uc of hb.items)if(!J.Annotations.Vob(hb.F3,Qb,uc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Fa,"QueryListFilter",null,[1252]);class qa{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb,Ab){if("string"!==
typeof hb)throw Error.argument("objToTest","Expected string");Ab=this.Cb.query.nt(null,Ab);if("string"!==typeof Ab)throw Error.invalidOperation("Query did not return string");this.Cb.guf&&(hb=hb.toUpperCase(),Ab=Ab.toUpperCase());switch(this.X7){case 0:return hb===Ab;case 1:return 0<=hb.indexOf(Ab);case 2:return hb.startsWith(Ab);case 3:return hb.endsWith(Ab);case 4:return 0<=Ab.indexOf(hb);case 5:return Ab.startsWith(hb);case 6:return Ab.endsWith(hb);default:throw Error.notImplemented();}}}Object(l.a)(qa,
"QueryStringFilter",null,[1252]);class ja{constructor(hb,Ab){hb&&(this.query=Ab.pK(hb.J(0)),this.guf=1===hb.J(1))}}Object(l.a)(ja,"QueryStringFilterInit",null,[]);class X{constructor(hb){this.Cb=hb}isMatch(hb,Ab){if(!Object(O.a)(1223,hb))throw Error.argument("objToTest","Expected struct value");Ab=this.Cb.query.nt(null,Ab);if(!Object(O.a)(1223,Ab))throw Error.invalidOperation("Query did not return struct value");return hb.isEqual(hb)}}Object(l.a)(X,"QueryStructFilter",null,[1252]);class ua{constructor(hb){this.Cb=
hb}isMatch(hb,Ab){hb=this.Cb.query.nt(null,Ab);if("boolean"!==typeof hb)throw Error.invalidOperation("Query did not return bool");return hb}}Object(l.a)(ua,"QueryWhereConstraintFilter",null,[1252]);class Ha{constructor(hb){this.Cb=hb}isMatch(hb){if("string"!==typeof hb)throw Error.argument("objToTest","Expected string");return this.Cb.XVf.test(hb)}}Object(l.a)(Ha,"RegexStringFilter",null,[1252]);class Ea{constructor(hb,Ab){hb&&(this.XVf=Ab.aDb(hb.J(0)))}}Object(l.a)(Ea,"RegexStringFilterInit",null,
[]);class wa{constructor(hb,Ab){hb&&(this.filter=Ab.rma(hb.J(0)))}}Object(l.a)(wa,"SingleFilterFilterInit",null,[]);class sa{constructor(hb,Ab){hb&&(this.query=Ab.pK(hb.J(0)))}}Object(l.a)(sa,"SingleQueryFilterInit",null,[]);class fa{constructor(hb){this.Cb=hb}isMatch(hb){if("boolean"!==typeof hb)throw Error.argument("objToTest","Expected bool value");return hb===this.Cb.value}}Object(l.a)(fa,"StoredValueBooleanFilter",null,[1252]);class Ma{constructor(hb){hb&&(this.value=1===hb.J(0))}}Object(l.a)(Ma,
"StoredValueBooleanFilterInit",null,[]);class Ua{constructor(hb,Ab){this.Cb=hb;this.X7=Ab}isMatch(hb){if("number"!==typeof hb)throw Error.argument("objToTest","Expected integer");switch(this.X7){case 0:return this.Cb.ZTd?this.Cb.value?!!(hb&this.Cb.value):!hb:hb===this.Cb.value;case 1:return this.Cb.ZTd?(hb&this.Cb.value)===this.Cb.value:32>hb&&(1<<hb&this.Cb.value)===this.Cb.value;case 2:return this.Cb.ZTd?!!(hb&this.Cb.value):32>hb&&!!(1<<hb&this.Cb.value);default:throw Error.notImplemented();}}}
Object(l.a)(Ua,"StoredValueEnumFilter",null,[1252]);class Qa{constructor(hb){hb&&(this.ZTd=1===hb.J(0),this.value=hb.J(1))}}Object(l.a)(Qa,"StoredValueEnumFilterInit",null,[]);class Ja{constructor(){this.hen=null;this.hZe=this.iEb=0}}Object(l.a)(Ja,"WHEREConstraintData",null,[]);class Wa{constructor(hb){this.Cb=hb}isMatch(hb,Ab){if(!Object(O.a)(Ja,hb))throw Error.argument("objToTest","Expected WHERE constraint data");let Qb=-1,uc=-1;const Xc=hb.hen;switch(this.Cb.b_e){case 4:Qb=Xc.YIc;uc=Xc.M6f;break;
case 5:Qb=hb.iEb;uc=Xc.YIc-hb.iEb;break;case 6:Qb=Xc.YIc+Xc.M6f;uc=hb.iEb+hb.hZe-Qb;break;case 1:case 2:case 3:let xd=!1;for(let de=Xc.XQo;de;de=de.next)if(this.Cb.mDo===de.name){xd=!0;1===this.Cb.b_e?(Qb=de.YIc,uc=de.M6f):2===this.Cb.b_e?(Qb=hb.iEb,uc=de.YIc-hb.iEb):(Qb=de.YIc+de.M6f,uc=hb.iEb+hb.hZe-Qb);break}if(!xd)return!1;break;case 7:Qb=hb.iEb;uc=hb.hZe;break;default:throw Error.notImplemented();}return null!==this.Cb.ieo.hUo(Xc.d0o,Qb,uc,Qb,!0,2,Ab)}}Object(l.a)(Wa,"SubSreWhereConstraintFilter",
null,[1252]);class Ya{constructor(hb,Ab){if(hb){var Qb=Ab.vE(hb.J(0));this.b_e=Qb.charCodeAt(0);this.mDo=Qb.substr(1);this.ieo=Ab.xSl(hb.J(1))}}}Object(l.a)(Ya,"SubSreWhereConstraintFilterInit",null,[]);class sb{constructor(hb){this.Cb=hb}isMatch(hb,Ab,Qb=null){if(!Object(O.a)(1221,hb))throw Error.argument("objToTest","Expected feature bundle");if(null==Qb)throw Error.argumentNull("parentTextForSpan");if(this.Cb.Ygh&&!this.Cb.Ygh.isMatch(hb,Ab))return!1;if(this.Cb.g$f){let uc;if(({value:uc}=hb.uq(this.Cb.ddo)).returnValue){if(!this.Cb.g$f.isMatch(uc,
Ab))return!1}else{let Xc,xd;if(!({value:Xc}=hb.uq(this.Cb.jdj)).returnValue||!({value:xd}=hb.uq(this.Cb.idj)).returnValue||0>Xc||0>xd||Xc+xd>Qb.length||!this.Cb.g$f.isMatch(Qb.substr(Xc,xd),Ab))return!1}}if(this.Cb.hej){let uc;if(!({value:uc}=hb.uq(this.Cb.jdj)).returnValue||!this.Cb.hej.isMatch(uc,Ab))return!1}if(this.Cb.Jri){let uc;if(!({value:uc}=hb.uq(this.Cb.idj)).returnValue||!this.Cb.Jri.isMatch(uc,Ab))return!1}return!0}}Object(l.a)(sb,"TextSpanFilter",null,[1252]);class ob{constructor(hb,
Ab){hb&&(this.annotations=Ab.annotations,this.jdj=hb.J(0),this.idj=hb.J(1),this.ddo=hb.J(2),this.g$f=hb.J(3)?Ab.rma(hb.J(3)):null,this.Ygh=hb.J(4)?Ab.rma(hb.J(4)):null,this.hej=hb.J(5)?Ab.rma(hb.J(5)):null,this.Jri=hb.J(6)?Ab.rma(hb.J(6)):null)}}Object(l.a)(ob,"TextSpanFilterInit",null,[]);class fc{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.Usa=hb.J(0),this.reg=hb.J(1)?Ab.rma(hb.J(1)):null)}}Object(l.a)(fc,"ValueFilterAnnotationFilterInit",null,[]);var Eb=c(1480);class Ib{rma(hb,
Ab){const Qb=hb.J(0),uc=new Eb.a;uc.Efb(hb,1,hb.count-1);switch(Qb){case 1:return new ca(new ia(uc,Ab),0);case 2:return new ca(new ia(uc,Ab),1);case 3:return new ca(new ia(uc,Ab),2);case 101:return new Ha(new Ea(uc,Ab));case 103:return new qa(new ja(uc,Ab),0);case 104:return new qa(new ja(uc,Ab),1);case 105:return new qa(new ja(uc,Ab),2);case 106:return new qa(new ja(uc,Ab),3);case 107:return new qa(new ja(uc,Ab),4);case 108:return new qa(new ja(uc,Ab),5);case 109:return new qa(new ja(uc,Ab),6);case 201:return new fa(new Ma(uc));
case 202:return new Ca(new sa(uc,Ab));case 301:return new ra(new da(uc,Ab),0);case 302:return new ra(new da(uc,Ab),1);case 303:return new ra(new da(uc,Ab),2);case 304:return new ra(new da(uc,Ab),3);case 305:return new ra(new da(uc,Ab),4);case 401:return new Ua(new Qa(uc),0);case 402:return new Ua(new Qa(uc),1);case 403:return new Ua(new Qa(uc),2);case 404:return new Na(new Ta(uc,Ab),0);case 405:return new Na(new Ta(uc,Ab),1);case 406:return new Na(new Ta(uc,Ab),2);case 407:return new Na(new Ta(uc,
Ab),3);case 501:return new R(new W(uc,Ab));case 502:return new X(new sa(uc,Ab));case 601:return new ba(new wa(uc,Ab),0);case 602:return new ba(new wa(uc,Ab),1);case 603:return new ha(new wa(uc,Ab));case 604:return new Fa(new sa(uc,Ab),0);case 605:return new Fa(new sa(uc,Ab),1);case 606:return new Fa(new sa(uc,Ab),2);case 607:return new Fa(new sa(uc,Ab),3);case 701:return new V(!1);case 702:return new V(!0);case 703:return new T(new fc(uc,Ab),!1);case 704:return new T(new fc(uc,Ab),!0);case 705:return new M(new fc(uc,
Ab),!1);case 706:return new M(new fc(uc,Ab),!0);case 707:return new la(new na(uc,Ab));case 901:return new sb(new ob(uc,Ab));case 1002:return new ua(new sa(uc,Ab));case 1001:return new Wa(new Ya(uc,Ab));default:throw Error.argument("initData");}}}Object(l.a)(Ib,"FilterFactory",null,[1220]);var Nb=c(1458);class pb{constructor(hb){this.Cb=hb}get oD(){return this.Cb.oD}get f4(){return this.Cb.f4}get mee(){return this.Cb.mee}get ASd(){return this.Cb.ASd}load(hb,Ab){return this.nt(hb,hb?new za("root",hb,
Ab):Ab)}store(hb,Ab,Qb){this.Qhc(hb,Ab,hb?new za("root",hb,Qb):Qb,null)}nt(hb,Ab){if(!this.ASd&&!this.Cb.annotations.W8b(this.oD,hb))throw Error.argument("input","Input value not of expected type");let Qb=this.Cb.FOh;for(;Qb;)hb=Qb.load(hb,Ab),Qb=Qb.next;return hb}Qhc(hb,Ab,Qb,uc){if(!this.mee)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.ASd&&!this.Cb.annotations.W8b(this.oD,hb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Cb.annotations.W8b(this.f4,
Ab))throw Error.argument("rvalue","Rvalue not of expected type");return this.Cb.FOh.store(hb,Ab,Qb,uc)}static Vth(hb,Ab,Qb,uc){if(Qb===uc)return Ab;if(J.Annotations.EH(Qb)&&J.Annotations.EH(uc)){Qb=J.Annotations.$_a(Qb);uc=J.Annotations.$_a(uc);const Xc=new Nb.a(hb,uc);for(const xd of Ab.items)Array.add(Xc.items,pb.Vth(hb,xd,Qb,uc));return Xc}if(Qb===J.Annotations.pHa){if(uc===J.Annotations.Lpa)return Ab;if(uc===J.Annotations.b9)return Ab.toString()}else if(Qb===J.Annotations.Lpa){if(uc===J.Annotations.pHa)return Math.floor(Ab);
if(uc===J.Annotations.b9)return Ab.toString()}else if(Qb===J.Annotations.b9){if(uc===J.Annotations.pHa)return parseInt(Ab);if(uc===J.Annotations.Lpa)return parseFloat(Ab)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(pb,"AnnotationQuery",null,[1257]);class Aa{constructor(){this.f4=this.oD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}d0a(hb){if(this.next)return{returnValue:this.next,KGa:hb};if(hb){const Ab=hb.dxh;hb=hb.FNi;return{returnValue:Ab,
KGa:hb}}return{returnValue:null,KGa:hb}}}Object(l.a)(Aa,"AnnotationQueryStep",null,[1277]);class xb extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){Ab=this.Cb.query.nt(hb,Ab);if(J.Annotations.EH(this.oD)){var Qb=J.Annotations.$_a(this.oD);let Xc=new Nb.a(this.Cb.annotations,Qb);if(J.Annotations.EH(this.Cb.query.f4)){if(hb.items.length!==Ab.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let xd=0,de=hb.items.length;xd<de;++xd)Array.add(Xc.items,
this.Cxd(hb.items[xd],Ab.items[xd],Qb===J.Annotations.Lpa))}else for(var uc of hb.items)Array.add(Xc.items,this.Cxd(uc,Ab,Qb===J.Annotations.Lpa));return Xc}if(J.Annotations.EH(this.Cb.query.f4)){uc=new Nb.a(this.Cb.annotations,this.oD);for(Qb of Ab.items)Array.add(uc.items,this.Cxd(hb,Qb,this.oD===J.Annotations.Lpa));return uc}return this.Cxd(hb,Ab,this.oD===J.Annotations.Lpa)}Cxd(hb,Ab,Qb){hb=this.O_b(hb,Ab);return Qb?hb:Math.floor(hb)}}Object(l.a)(xb,"NumericAnnotationQueryStep",Aa,[]);class gb extends xb{constructor(hb){super(hb)}O_b(hb,
Ab){return hb+Ab}}Object(l.a)(gb,"AddAnnotationQueryStep",xb,[]);class Xa extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){if(this.oD===J.Annotations.Zxa&&this.Cb.query.f4===J.Annotations.Zxa){let Xc;if(({result:Xc}=this.Dph(hb)).returnValue)return Xc}if(J.Annotations.EH(this.oD)){var Qb=new Nb.a(this.Cb.annotations,J.Annotations.Zxa);Ab=this.Cb.query.nt(hb,Ab);if(J.Annotations.EH(this.Cb.query.f4)){if(hb.items.length!==Ab.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");
for(let Xc=0,xd=hb.items.length;Xc<xd;++Xc)Array.add(Qb.items,this.fEc(Ab.items[Xc],hb.items[Xc]))}else for(var uc of hb.items)Array.add(Qb.items,this.fEc(Ab,uc));return Qb}uc=this.Cb.query.nt(hb,Ab);if(J.Annotations.EH(this.Cb.query.f4)){Ab=new Nb.a(this.Cb.annotations,J.Annotations.Zxa);for(Qb of uc.items)Array.add(Ab.items,this.fEc(Qb,hb));return Ab}return this.fEc(uc,hb)}}Object(l.a)(Xa,"BinaryBooleanAnnotationQueryStep",Aa,[]);class Va extends Xa{constructor(hb){super(hb)}Dph(hb){return{returnValue:!hb,
result:!1}}fEc(hb,Ab){return hb&&Ab}}Object(l.a)(Va,"AndAnnotationQueryStep",Xa,[]);class Gb{constructor(hb){hb&&(this.annotations=hb)}}Object(l.a)(Gb,"AnnotationsOnlyQueryStepInit",null,[]);class Xb extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){Ab=this.Cb.query.nt(hb,Ab);hb=hb.clone();J.Annotations.EH(this.Cb.query.f4)?Array.addRange(hb.items,Ab.items):Array.add(hb.items,Ab);return hb}}Object(l.a)(Xb,"AppendAnnotationQueryStep",Aa,[]);class rc extends Aa{constructor(hb){super();this.Cb=
hb}load(hb,Ab){if(this.oD===J.Annotations.RU)return this.hIc(hb,Ab);const Qb=new Nb.a(this.Cb.annotations,J.Annotations.RU);for(const uc of hb.items)Array.add(Qb.items,this.hIc(uc,Ab));return Qb}hIc(hb,Ab){const Qb=new N.a(this.Cb.annotations);Qb.aZa(hb);hb=new N.a(this.Cb.annotations);this.Cb.script.ZMa(null,new za("Input",Qb,new za("Output",hb,Ab)));return hb}}Object(l.a)(rc,"ApplyAnnotationQueryStep",Aa,[]);class qb extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){if(this.oD===J.Annotations.RU)return Ab=
this.hIc(hb,Ab),Ab.uq(this.Cb.Wgh).returnValue||new Nb.a(this.Cb.annotations,J.Annotations.RU),Ab;const Qb=new Nb.a(this.Cb.annotations,J.Annotations.RU);for(const uc of hb.items)if(hb=this.hIc(uc,Ab),({value:hb}=hb.uq(this.Cb.Wgh)).returnValue)for(const Xc of hb.items)Array.add(Qb.items,Xc);return Qb}hIc(hb,Ab){const Qb=new N.a(this.Cb.annotations);Qb.aZa(hb);hb=new N.a(this.Cb.annotations);this.Cb.script.ZMa(null,new za("Input",Qb,new za("Output",hb,Ab)));return hb}}Object(l.a)(qb,"ApplyExpandAnnotationQueryStep",
Aa,[]);class Zb{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.script=Ab.TBb(hb.J(0)),this.Wgh=hb.J(1))}}Object(l.a)(Zb,"ApplyExpandQueryStepInit",null,[]);class Rb{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.script=Ab.TBb(hb.J(0)))}}Object(l.a)(Rb,"ApplyQueryStepInit",null,[]);class Ra extends Aa{constructor(hb){super();this.Cb=hb}load(hb){if(this.oD===J.Annotations.RU)return this.AXd(hb);const Ab=new Nb.a(this.Cb.annotations,this.Cb.annotations.getAttributeType(this.Cb.Usa));
for(const Qb of hb.items)Array.add(Ab.items,this.AXd(Qb));return Ab}store(hb,Ab,Qb,uc){if(this.oD===J.Annotations.RU){var Xc=Ab,xd=({KGa:uc}=this.d0a(uc)).returnValue;xd&&(Xc=xd.store(J.Annotations.AS(this.AXd(hb)),Ab,Qb,uc));hb.ny(this.Cb.Usa,Xc)}else{var de=Ab;if(Xc=({KGa:uc}=this.d0a(uc)).returnValue){de=new Nb.a(this.Cb.annotations,this.Cb.annotations.getAttributeType(this.Cb.Usa));for(xd of hb.items)Array.add(de.items,this.AXd(xd));de=Xc.store(de,Ab,Qb,uc)}Ab=de;if(Ab.items.length!==hb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let Dd=0,ee=hb.items.length;Dd<ee;++Dd)Qb=hb.items[Dd],Qb.isReadOnly&&(Qb=Qb.clone(),hb.items[Dd]=Qb),Qb.ny(this.Cb.Usa,Ab.items[Dd])}return hb}AXd(hb){({value:hb}=hb.uq(this.Cb.Usa)).returnValue||(hb=this.Cb.annotations.ntl(this.Cb.Usa));return hb}}Object(l.a)(Ra,"AttrAnnotationQueryStep",Aa,[]);class ab{constructor(hb,Ab){hb&&(this.annotations=Ab,this.Usa=hb.J(0))}}Object(l.a)(ab,"AttrQueryStepInit",null,[]);class fb extends Aa{constructor(hb){super();this.Cb=hb}load(hb){const Ab=new N.a(this.Cb.annotations);
Ab.aZa(hb);return this.Cb.module.execute(Ab)}}Object(l.a)(fb,"CallModuleAnnotationQueryStep",Aa,[]);class bb{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.module=Ab.xkf(hb.J(0)))}}Object(l.a)(bb,"CallModuleQueryStepInit",null,[]);class Ub extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){if(J.Annotations.EH(this.oD)){var Qb=this.Cb.query.nt(hb,Ab);Ab=new Nb.a(this.Cb.annotations,J.Annotations.b9);let xd="string"===typeof Qb;for(var uc of hb.items)if(xd)Array.add(Ab.items,uc+
Qb);else for(var Xc of Qb.items)Array.add(Ab.items,uc+Xc);return Ab}uc=this.Cb.query.nt(hb,Ab);if("string"===typeof uc)return hb+uc;Xc=new Nb.a(this.Cb.annotations,J.Annotations.b9);for(Qb of uc.items)Array.add(Xc.items,hb+Qb);return Xc}}Object(l.a)(Ub,"ConcatAnnotationQueryStep",Aa,[]);class Oa extends Aa{constructor(hb){super();this.Cb=hb}load(hb){return pb.Vth(this.Cb.annotations,hb,this.oD,this.f4)}}Object(l.a)(Oa,"ConvertAnnotationQueryStep",Aa,[]);class Fc extends Aa{constructor(){super()}load(hb){return hb.items.length}}
Object(l.a)(Fc,"CountAnnotationQueryStep",Aa,[]);class xc extends xb{constructor(hb){super(hb)}O_b(hb,Ab){return hb/Ab}}Object(l.a)(xc,"DivideAnnotationQueryStep",xb,[]);class pd extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){Ab=new za(this.Cb.wie,null,Ab);for(const Qb of hb.items)if(Ab.t_e(Qb),this.Cb.query.nt(Qb,Ab))return!0;return!1}}Object(l.a)(pd,"ExistsAnnotationQueryStep",Aa,[]);class lb extends xb{constructor(hb){super(hb)}O_b(hb,Ab){return Math.pow(hb,Ab)}}Object(l.a)(lb,"ExpAnnotationQueryStep",
xb,[]);class Tb{constructor(hb,Ab){hb&&(this.hNa=Ab.vE(hb.J(0)))}}Object(l.a)(Tb,"FeatureBundleNameQueryStepInit",null,[]);class pc extends Aa{constructor(hb){super();this.Cb=hb}load(hb){if(J.Annotations.EH(this.oD)){const Ab=new Nb.a(this.Cb.annotations,this.Cb.annotations.lDb(J.Annotations.$_a(this.oD),this.Cb.jNa));for(const Qb of hb.items)Array.add(Ab.items,Qb.jgb(this.Cb.jNa));return Ab}return hb.jgb(this.Cb.jNa)}store(hb,Ab,Qb,uc){if(J.Annotations.EH(this.oD)){var Xc=Ab,xd=({KGa:uc}=this.d0a(uc)).returnValue;
if(xd){Xc=new Nb.a(this.Cb.annotations,this.Cb.annotations.lDb(J.Annotations.$_a(this.oD),this.Cb.jNa));for(var de of hb.items)Array.add(Xc.items,de.jgb(this.Cb.jNa));Xc=xd.store(Xc,Ab,Qb,uc)}Ab=Xc;if(Ab.items.length!==hb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Dd=0,ee=hb.items.length;Dd<ee;++Dd)Qb=hb.items[Dd],Qb.isReadOnly&&(Qb=Qb.clone(),hb.items[Dd]=Qb),Qb.c2f(this.Cb.jNa,Ab.items[Dd])}else xd=Ab,(de=({KGa:uc}=this.d0a(uc)).returnValue)&&
(xd=de.store(J.Annotations.AS(hb.jgb(this.Cb.jNa)),Ab,Qb,uc)),hb.c2f(this.Cb.jNa,xd);return hb}}Object(l.a)(pc,"FieldAnnotationQueryStep",Aa,[]);class Db{constructor(hb,Ab){hb&&(this.annotations=Ab,this.jNa=hb.J(0))}}Object(l.a)(Db,"FieldQueryStepInit",null,[]);class Ob extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){for(const Qb of hb.items)if(this.Cb.filter.isMatch(Qb,Ab))return Qb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(hb,Ab,Qb,uc){let Xc=
Ab,xd=-1;for(let Dd=0,ee=hb.items.length;Dd<ee;Dd++)if(this.Cb.filter.isMatch(hb.items[Dd],Qb)){xd=Dd;break}if(0>xd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const de=({KGa:uc}=this.d0a(uc)).returnValue;de&&(Xc=de.store(J.Annotations.AS(hb.items[xd]),Ab,Qb,uc));hb.items[xd]=Xc;return hb}}Object(l.a)(Ob,"FirstItemMatchingAnnotationQueryStep",Aa,[]);class jb extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){Ab=new za(this.Cb.wie,null,Ab);for(const Qb of hb.items)if(Ab.t_e(Qb),
!this.Cb.query.nt(Qb,Ab))return!1;return!0}}Object(l.a)(jb,"ForAllAnnotationQueryStep",Aa,[]);class tb extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){hb=Ab?Ab.TJd(this.Cb.hNa):null;if(!hb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Cb.hNa+'"');return hb}store(hb,Ab,Qb,uc){hb=Qb?Qb.TJd(this.Cb.hNa):null;if(!hb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Cb.hNa+'"');let Xc=Ab;const xd=({KGa:uc}=this.d0a(uc)).returnValue;xd&&(Xc=xd.store(hb,
Ab,Qb,uc));hb!==Xc&&hb.aZa(Xc);return hb}}Object(l.a)(tb,"GetAnnotationQueryStep",Aa,[]);class ac{constructor(hb,Ab){this.tIj=hb;this.oZj=Ab}get dxh(){return this.tIj}get FNi(){return this.oZj}}Object(l.a)(ac,"AnnotationQueryStoreContinuation",null,[1279]);class zc extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){return this.Cb.nfe.nt(hb,Ab)?this.Cb.Jkj.nt(hb,Ab):this.Cb.nGd?this.Cb.nGd.nt(hb,Ab):hb}store(hb,Ab,Qb,uc){var Xc=this.Cb.nfe.nt(hb,Qb);this.next&&(uc=new ac(this.next,uc));if(Xc)return this.Cb.Jkj.Qhc(hb,
Ab,Qb,uc);if(this.Cb.nGd)return this.Cb.nGd.Qhc(hb,Ab,Qb,uc);Xc=Ab;let xd=null;uc&&(xd=uc.dxh,uc=uc.FNi);xd&&(Xc=xd.store(J.Annotations.AS(hb),Ab,Qb,uc));return Xc}}Object(l.a)(zc,"IfAnnotationQueryStep",Aa,[]);class yc{constructor(hb,Ab){hb&&(this.nfe=Ab.pK(hb.J(0)),this.Jkj=Ab.pK(hb.J(1)),this.nGd=hb.J(2)?Ab.pK(hb.J(2)):null)}}Object(l.a)(yc,"IfQueryStepInit",null,[]);class cd{constructor(hb,Ab){hb&&(this.nbm=Ab.pK(hb.J(0)),this.Spi=Ab.pK(hb.J(1)))}}Object(l.a)(cd,"IndexAndItemQueryStepInit",null,
[]);class Cd extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){const Qb=this.Cb.nbm.nt(hb,Ab);Ab=this.Cb.Spi.nt(hb,Ab);hb=hb.clone();if(0>Qb||Qb>hb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(J.Annotations.EH(this.Cb.Spi.f4))for(let uc=0;uc<Ab.items.length;++uc)Array.insert(hb.items,Qb+uc,Ab.items[uc]);else Array.insert(hb.items,Qb,Ab);return hb}}Object(l.a)(Cd,"InsertAtAnnotationQueryStep",Aa,[]);class ud extends Aa{constructor(hb){super();
this.Cb=hb}load(hb,Ab){return!(!Ab||!Ab.TJd(this.Cb.hNa))}}Object(l.a)(ud,"IsDefinedAnnotationQueryStep",Aa,[]);class $d extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){Ab=this.EI(hb,Ab);return hb.items[Ab]}store(hb,Ab,Qb,uc){const Xc=this.EI(hb,Qb);let xd=Ab;const de=({KGa:uc}=this.d0a(uc)).returnValue;de&&(xd=de.store(J.Annotations.AS(hb.items[Xc]),Ab,Qb,uc));hb.items[Xc]=xd;return hb}EI(hb,Ab){Ab=this.Cb.query.nt(hb,Ab);if(0>Ab||Ab>=hb.items.length)throw Error.invalidOperation("Index out of range in Item store step");
return Ab}}Object(l.a)($d,"ItemAnnotationQueryStep",Aa,[]);class gc extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){const Qb=new Nb.a(this.Cb.annotations,J.Annotations.$_a(this.oD));for(const uc of hb.items)this.Cb.filter.isMatch(uc,Ab)&&Array.add(Qb.items,uc);return Qb}}Object(l.a)(gc,"ItemsMatchingAnnotationQueryStep",Aa,[]);class kc extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){Ab=this.EI(hb,Ab);return hb.items[hb.items.length-Ab-1]}store(hb,Ab,Qb,uc){const Xc=this.EI(hb,
Qb);let xd=Ab;const de=({KGa:uc}=this.d0a(uc)).returnValue;de&&(xd=de.store(J.Annotations.AS(hb.items[hb.items.length-Xc-1]),Ab,Qb,uc));hb.items[hb.items.length-Xc-1]=xd;return hb}EI(hb,Ab){Ab=this.Cb.query?this.Cb.query.nt(hb,Ab):0;if(0>Ab||Ab>=hb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ab}}Object(l.a)(kc,"LastItemAnnotationQueryStep",Aa,[]);class Wc extends Aa{constructor(hb){super();this.Cb=hb}load(hb){if(J.Annotations.EH(this.oD)){const Ab=
new Nb.a(this.Cb.annotations,J.Annotations.pHa);for(const Qb of hb.items)Array.add(Ab.items,Qb.length);return Ab}return hb.length}}Object(l.a)(Wc,"LengthAnnotationQueryStep",Aa,[]);class td extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){if(J.Annotations.EH(this.oD)){const Qb=new Nb.a(this.Cb.annotations,J.Annotations.Zxa);for(const uc of hb.items)Array.add(Qb.items,this.Cb.filter.isMatch(uc,Ab));return Qb}return this.Cb.filter.isMatch(hb,Ab)}}Object(l.a)(td,"MatchesAnnotationQueryStep",
Aa,[]);class Fe extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){return this.Cb.filter.isMatch(hb,Ab)}}Object(l.a)(Fe,"MatchesAsListAnnotationQueryStep",Aa,[]);class Cf extends xb{constructor(hb){super(hb)}O_b(hb,Ab){return hb%Ab}}Object(l.a)(Cf,"ModuloAnnotationQueryStep",xb,[]);class ie extends xb{constructor(hb){super(hb)}O_b(hb,Ab){return hb*Ab}}Object(l.a)(ie,"MultiplyAnnotationQueryStep",xb,[]);class Ae extends Aa{constructor(hb){super();this.Cb=hb}load(hb){if(J.Annotations.EH(this.oD)){const Ab=
new Nb.a(this.Cb.annotations,J.Annotations.Zxa);for(const Qb of hb.items)Array.add(Ab.items,!Qb);return Ab}return!hb}}Object(l.a)(Ae,"NotAnnotationQueryStep",Aa,[]);class xe extends Xa{constructor(hb){super(hb)}Dph(hb){return{returnValue:hb,result:!0}}fEc(hb,Ab){return hb||Ab}}Object(l.a)(xe,"OrAnnotationQueryStep",Xa,[]);class ng extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){const Qb=this.Cb.E7f.nt(hb,Ab);hb=this.Cb.REc.nt(hb,Ab);Ab=new Nb.a(this.Cb.annotations,J.Annotations.pHa);for(let uc=
0;uc<hb;++uc)Array.add(Ab.items,Qb+uc);return Ab}}Object(l.a)(ng,"RangeAnnotationQueryStep",Aa,[]);class Af{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.filter=Ab.rma(hb.J(0)))}}Object(l.a)(Af,"SingleFilterQueryStepInit",null,[]);class De{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.query=hb.J(0)?Ab.pK(hb.J(0)):null)}}Object(l.a)(De,"SingleOptionalQueryQueryStepInit",null,[]);class Rf{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.query=Ab.pK(hb.J(0)))}}
Object(l.a)(Rf,"SingleQueryQueryStepInit",null,[]);class Je{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.E7f=Ab.pK(hb.J(0)),this.REc=hb.J(1)?Ab.pK(hb.J(1)):null)}}Object(l.a)(Je,"StartAndCountOrLengthQueryStepInit",null,[]);class le extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){let Qb;({startIndex:Ab,length:Qb}=this.AMd(hb,Ab));const uc=new Nb.a(this.Cb.annotations,hb.F3);for(let Xc=0;Xc<Qb;++Xc)Array.add(uc.items,hb.items[Ab+Xc]);return uc}store(hb,Ab,Qb,uc){let Xc,xd;
({startIndex:Xc,length:xd}=this.AMd(hb,Qb));var de=Ab;const Dd=({KGa:uc}=this.d0a(uc)).returnValue;if(Dd){de=new Nb.a(this.Cb.annotations,hb.F3);for(let ee=0;ee<xd;++ee)Array.add(de.items,hb.items[Xc+ee]);de=Dd.store(de,Ab,Qb,uc)}Ab=de;for(Qb=0;Qb<xd;++Qb)Array.removeAt(hb.items,Xc);for(let ee=0,vf=Ab.items.length;ee<vf;++ee)Array.insert(hb.items,Xc+ee,Ab.items[ee]);return hb}AMd(hb,Ab){let Qb;Qb=this.Cb.E7f.nt(hb,Ab);if(0>Qb)throw Error.invalidOperation("Invalid start index in Sublist() query step");
Ab=this.Cb.REc?this.Cb.REc.nt(hb,Ab):hb.items.length-Qb;if(0>Ab||Qb+Ab>hb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Qb,length:Ab}}}Object(l.a)(le,"SublistAnnotationQueryStep",Aa,[]);class dh extends Aa{constructor(hb){super();this.Cb=hb}load(hb,Ab){if(J.Annotations.EH(this.oD)){const Qb=new Nb.a(this.Cb.annotations,J.Annotations.b9);for(let uc=0,Xc=hb.items.length;uc<Xc;++uc)Array.add(Qb.items,this.c5h(hb.items[uc],Ab));
return Qb}return this.c5h(hb,Ab)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}c5h(hb,Ab){let Qb;({startIndex:Ab,length:Qb}=this.AMd(hb,Ab));return hb.substr(Ab,Qb)}AMd(hb,Ab){let Qb;Qb=this.Cb.E7f.nt(hb,Ab);if(0>Qb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ab=this.Cb.REc?this.Cb.REc.nt(hb,Ab):hb.length-Qb;if(0>Ab||Qb+Ab>hb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");
return{startIndex:Qb,length:Ab}}}Object(l.a)(dh,"SubstringAnnotationQueryStep",Aa,[]);class lj extends xb{constructor(hb){super(hb)}O_b(hb,Ab){return hb-Ab}}Object(l.a)(lj,"SubtractAnnotationQueryStep",xb,[]);class sh extends Aa{constructor(hb){super();this.Cb=hb}load(hb){const Ab=new Nb.a(this.Cb.annotations,J.Annotations.b9);for(let Qb=0;Qb<hb.length;++Qb)Array.add(Ab.items,hb.charAt(Qb).toString());return Ab}}Object(l.a)(sh,"ToCharListAnnotationQueryStep",Aa,[]);class We extends Aa{constructor(hb){super();
this.Cb=hb}load(hb){const Ab=new Nb.a(this.Cb.annotations,this.oD);Array.add(Ab.items,hb);return Ab}}Object(l.a)(We,"ToListAnnotationQueryStep",Aa,[]);class Fh extends Aa{constructor(hb){super();this.Cb=hb}load(){return this.Cb.value}}Object(l.a)(Fh,"ValueAnnotationQueryStep",Aa,[]);class cc{constructor(hb,Ab){if(hb){var Qb=hb.J(0),uc=1;this.value=({Ofa:uc}=Ab.GMa(Qb,hb,uc,null,null,null)).returnValue;J.Annotations.iHb(this.value)}}}Object(l.a)(cc,"ValueQueryStepInit",null,[]);class tc{constructor(hb,
Ab){hb&&(this.wie=Ab.vE(hb.J(0)),this.query=Ab.pK(hb.J(1)))}}Object(l.a)(tc,"VarNameAndQueryQueryStepInit",null,[]);class bd{constructor(hb,Ab){this.GKg=null;if(hb){this.annotations=Ab.annotations;var Qb=0;this.oD=hb.J(Qb);++Qb;this.f4=hb.J(Qb);++Qb;this.mee=1===hb.J(Qb);++Qb;this.ASd=1===hb.J(Qb);++Qb;var uc=hb.J(Qb);++Qb;if(uc){var Xc=Qb,xd=Qb+uc,de=Qb+2*uc;Qb+=3*uc;var Dd=hb.count-Qb,ee=null;for(let eg=0;eg<uc;++eg){var vf=Qb+hb.J(de+eg);const $b=(eg===uc-1?Dd:hb.J(de+eg+1))-hb.J(de+eg),Hd=new Eb.a;
Hd.Efb(hb,vf,$b);vf=bd.ZKl(hb.J(xd+eg),Hd,Ab);vf.oD=hb.J(Xc+eg);vf.f4=eg===uc-1?this.f4:hb.J(Xc+eg+1);ee?ee.next=vf:this.GKg=vf;ee=vf}}}}get FOh(){return this.GKg}static ZKl(hb,Ab,Qb){switch(hb){case 1:return new tb(new Tb(Ab,Qb));case 2:return new ud(new Tb(Ab,Qb));case 3:return new Ra(new ab(Ab,Qb.annotations));case 4:return new pc(new Db(Ab,Qb.annotations));case 5:return new zc(new yc(Ab,Qb));case 6:return new td(new Af(Ab,Qb));case 43:return new Fe(new Af(Ab,Qb));case 45:return new rc(new Rb(Ab,
Qb));case 49:return new qb(new Zb(Ab,Qb));case 46:return new Fh(new cc(Ab,Qb.annotations));case 51:return new fb(new bb(Ab,Qb));case 52:return new ng(new Je(Ab,Qb));case 53:return new Oa(new Gb(Qb.annotations));case 13:return new $d(new Rf(Ab,Qb));case 14:return new kc(new De(Ab,Qb));case 15:return new Fc;case 18:return new Ob(new Af(Ab,Qb));case 16:return new jb(new tc(Ab,Qb));case 17:return new pd(new tc(Ab,Qb));case 22:return new Cd(new cd(Ab,Qb));case 24:return new Xb(new Rf(Ab,Qb));case 26:return new le(new Je(Ab,
Qb));case 27:return new gc(new Af(Ab,Qb));case 30:return new We(new Gb(Qb.annotations));case 31:return new dh(new Je(Ab,Qb));case 32:return new Ub(new Rf(Ab,Qb));case 47:return new Wc(new Gb(Qb.annotations));case 48:return new sh(new Gb(Qb.annotations));case 34:return new gb(new Rf(Ab,Qb));case 35:return new lj(new Rf(Ab,Qb));case 36:return new ie(new Rf(Ab,Qb));case 37:return new xc(new Rf(Ab,Qb));case 38:return new Cf(new Rf(Ab,Qb));case 39:return new lb(new Rf(Ab,Qb));case 40:return new Va(new Rf(Ab,
Qb));case 41:return new xe(new Rf(Ab,Qb));case 42:return new Ae(new Gb(Qb.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(bd,"AnnotationQueryInit",null,[]);class vd{constructor(hb){this.Cb=hb}execute(hb,Ab){this.ZMa(hb,hb?new za("root",hb,Ab):Ab)}ZMa(hb,Ab){for(const Qb of this.Cb.commands)Ab=Qb.execute(hb,Ab)}}Object(l.a)(vd,"AnnotationScript",null,[1256]);class Tc{constructor(hb){this.Cb=hb}execute(hb,Ab){const Qb=this.Cb.mfm.nt(hb,Ab),uc=this.Cb.ccn.nt(hb,Ab);this.Cb.script.ZMa(hb,
new za("Input",Qb,new za("Output",uc,Ab)));return Ab}}Object(l.a)(Tc,"ApplyAnnotationScriptCommand",null,[1270]);class nb{constructor(hb,Ab){hb&&(this.mfm=Ab.pK(hb.J(0)),this.ccn=Ab.pK(hb.J(1)),this.script=Ab.TBb(hb.J(2)))}}Object(l.a)(nb,"ApplyScriptCommandInit",null,[]);class Fb{constructor(hb){this.Cb=hb}execute(hb,Ab){const Qb=this.Cb.H_f.nt(hb,Ab);this.Cb.oYd.Qhc(hb,Qb,Ab,null);return Ab}}Object(l.a)(Fb,"AssignAnnotationScriptCommand",null,[1270]);class Kc{constructor(hb){this.Cb=hb}execute(hb,
Ab){const Qb=this.Cb.oYd.nt(hb,Ab);hb=this.Cb.H_f.nt(hb,Ab);Qb!==hb&&Qb.aZa(hb);return Ab}}Object(l.a)(Kc,"CopyAnnotationScriptCommand",null,[1270]);class sc{constructor(hb){this.Cb=hb}execute(hb,Ab){let Qb=this.Cb.KBf.nt(hb,Ab);if(this.Cb.KBf.mee){Qb=J.Annotations.AS(Qb);var uc=new za(this.Cb.hNa,null,Ab);for(let xd=0,de=Qb.items.length;xd<de;++xd){var Xc=this.kLh(hb,Qb.items[xd],uc);if(0>this.Cb.d9d)Qb.items[xd]=Xc;else if(({value:Xc}=Xc.uq(this.Cb.d9d)).returnValue)Qb.items[xd]=Xc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Cb.KBf.Qhc(hb,Qb,Ab,null)}else{uc=new za(this.Cb.hNa,null,Ab);for(let xd=0,de=Qb.items.length;xd<de;++xd)this.kLh(hb,Qb.items[xd],uc)}return Ab}kLh(hb,Ab,Qb){let uc;0>this.Cb.d9d?uc=J.Annotations.AS(Ab):(uc=new N.a(this.Cb.annotations),uc.ny(this.Cb.d9d,Ab));Qb.t_e(uc);this.Cb.Zrk.ZMa(hb,Qb);return uc}}Object(l.a)(sc,"EnumerateAnnotationScriptCommand",null,[1270]);class Oc{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.hNa=Ab.vE(hb.J(0)),this.KBf=Ab.pK(hb.J(1)),this.Zrk=Ab.TBb(hb.J(2)),
this.d9d=hb.J(3))}}Object(l.a)(Oc,"EnumerateScriptCommandInit",null,[]);class Ke{constructor(hb){this.Cb=hb}execute(hb,Ab){this.Cb.nfe.nt(hb,Ab)?this.Cb.Xpo.ZMa(hb,Ab):this.Cb.oMh&&this.Cb.oMh.ZMa(hb,Ab);return Ab}}Object(l.a)(Ke,"IfAnnotationScriptCommand",null,[1270]);class Re{constructor(hb,Ab){hb&&(this.nfe=Ab.pK(hb.J(0)),this.Xpo=Ab.TBb(hb.J(1)),this.oMh=hb.J(2)?Ab.TBb(hb.J(2)):null)}}Object(l.a)(Re,"IfScriptCommandInit",null,[]);class lf{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,
this.oYd=Ab.pK(hb.J(0)),this.H_f=Ab.pK(hb.J(1)))}}Object(l.a)(lf,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Jh{constructor(hb){this.Cb=hb}execute(hb,Ab){const Qb=this.Cb.H_f.nt(this.Cb.oYd.nt(hb,Ab),Ab);this.Cb.oYd.Qhc(hb,Qb,Ab,null);return Ab}}Object(l.a)(Jh,"ModifyAnnotationScriptCommand",null,[1270]);class zg{constructor(hb){this.Cb=hb}execute(hb,Ab){const Qb=new N.a(this.Cb.annotations);this.Cb.query&&Qb.aZa(this.Cb.query.nt(hb,Ab));return Ab=new za(this.Cb.hNa,Qb,Ab)}}Object(l.a)(zg,
"NewAnnotationScriptCommand",null,[1270]);class Kd{constructor(hb,Ab){hb&&(this.annotations=Ab.annotations,this.hNa=Ab.vE(hb.J(0)),this.query=hb.J(1)?Ab.pK(hb.J(1)):null)}}Object(l.a)(Kd,"NewScriptCommandInit",null,[]);class Td{constructor(hb){this.Cb=hb}execute(hb,Ab){hb=this.Cb.query.nt(hb,Ab);if(this.Cb.query.f4===J.Annotations.RU)hb.lRa(this.Cb.Usa);else for(const Qb of hb.items)Qb.lRa(this.Cb.Usa);return Ab}}Object(l.a)(Td,"RemoveAnnotationScriptCommand",null,[1270]);class Gd{constructor(hb,
Ab){hb&&(this.annotations=Ab.annotations,this.query=Ab.pK(hb.J(0)),this.Usa=hb.J(1))}}Object(l.a)(Gd,"RemoveScriptCommandInit",null,[]);class rf{constructor(hb,Ab){if(hb){var Qb=0,uc=hb.J(Qb);++Qb;if(uc){var Xc=Qb,xd=Qb+uc;Qb+=2*uc;var de=hb.count-Qb;this.commands=Array(uc);for(let Dd=0;Dd<uc;++Dd){const ee=Qb+hb.J(xd+Dd),vf=(Dd===uc-1?de:hb.J(xd+Dd+1))-hb.J(xd+Dd),eg=new Eb.a;eg.Efb(hb,ee,vf);this.commands[Dd]=rf.PKl(hb.J(Xc+Dd),eg,Ab)}}}}static PKl(hb,Ab,Qb){switch(hb){case 1:return new Fb(new lf(Ab,
Qb));case 2:return new Jh(new lf(Ab,Qb));case 3:return new Td(new Gd(Ab,Qb));case 6:return new zg(new Kd(Ab,Qb));case 7:return new sc(new Oc(Ab,Qb));case 8:return new Ke(new Re(Ab,Qb));case 9:return new Kc(new lf(Ab,Qb));case 10:return new Tc(new nb(Ab,Qb));default:throw Error.argument("initData");}}}Object(l.a)(rf,"AnnotationScriptInit",null,[]);var hf=c(1595);class Ui{constructor(hb){this.K0=hb;this.Bx=0}t8(){const hb=this.K0.ly(this.Bx,4);this.Bx+=4;return hb}get rea(){return this.K0}get offset(){return this.Bx}set offset(hb){this.Bx=
hb}}Object(l.a)(Ui,"ByteArrayReader",null,[]);class Ik{constructor(){this.eJ=null;this.Hvi=this.oba=0}J(hb){if(0>hb||hb>=this.oba)throw Error.argumentOutOfRange("index");return this.eJ.ly(this.Hvi+4*hb,4)}get count(){return this.oba}static oTk(hb,Ab,Qb){const uc=new Ik;uc.eJ=hb;uc.Hvi=Ab;uc.oba=Qb;return uc}}Object(l.a)(Ik,"ReadOnlyListOverByteArray",null,[1248]);class th{constructor(hb,Ab){this.Avi=this.zvi=!1;this.aw=this.TPa=this.jDf=this.Dvi=null;try{this.aw=Ab.annotations;const Qb=Ab.Ufb(hb.J(0)),
uc=new Ui(Qb);if(-914743053!==uc.t8())throw Error.argument("Input does not represent a flat lexicon");this.zvi=1===uc.t8();this.Avi=1===uc.t8();const Xc=uc.t8();uc.offset+=Xc;const xd=uc.t8();this.jDf=th.nen(uc,xd,this.aw);const de=uc.t8();this.Dvi=th.Fen(uc,de);const Dd=uc.t8();this.TPa=new hf.a(uc.rea,uc.offset);uc.offset+=Dd}catch(Qb){throw Error.argument("initData");}}get trie(){return this.TPa}hvl(hb){return"i"===hb&&this.Avi?"\u0130":hb.toUpperCase()}guf(){return this.zvi}Dsl(hb){let Ab;Ab=
new Nb.a(this.aw,J.Annotations.RU);if(1!==hb)if(0===hb)hb=new N.a(this.aw),Array.add(Ab.items,hb);else if(hb&1073741824){hb=this.Dvi[hb&-1073741825];for(let uc=0;uc<hb.length;++uc){var Qb=hb[uc];Qb=0===Qb?new N.a(this.aw):this.jDf[Qb-2];Array.add(Ab.items,Qb)}}else Array.add(Ab.items,this.jDf[hb-2]);return{returnValue:!0,eDm:Ab}}static nen(hb,Ab,Qb){if(Ab%4)throw Error.argument("reader");const uc=Ik.oTk(hb.rea,hb.offset,Ab/4);hb.offset+=Ab;hb=[];for(Ab=0;Ab<uc.count;){const Xc=({Ofa:Ab}=Qb.GMa(J.Annotations.RU,
uc,Ab,null,null,null)).returnValue;Array.add(hb,Xc)}return hb}static Fen(hb,Ab){Ab=hb.offset+Ab;const Qb=[];for(;hb.offset<Ab;){const uc=hb.t8(),Xc=Array(uc);for(let xd=0;xd<uc;++xd){const de=hb.t8();Xc[xd]=de}Array.add(Qb,Xc)}return Qb}}Object(l.a)(th,"RawFlatLexicon",null,[1255]);var Mi=c(1586),of=c(1587);class ci{constructor(hb){if(null==hb)throw Error.argumentNull("base64String");const Ab=hb.length;if(Ab%4)throw Error.argument("base64String's length must be a multiple of 4");this.oba=.75*Ab;this.tHb=
Array(Math.ceil(this.oba/4));hb.endsWith("==")?this.oba-=2:hb.endsWith("=")&&--this.oba;let Qb=0;for(let uc=0;uc<Ab;uc+=4){const Xc=ci.R9d[hb.charCodeAt(uc)-43]<<18|ci.R9d[hb.charCodeAt(uc+1)-43]<<12|ci.R9d[hb.charCodeAt(uc+2)-43]<<6|ci.R9d[hb.charCodeAt(uc+3)-43];let xd=Xc>>16&255;this.tHb[Math.floor(Qb/4)]|=xd<<Qb%4*8;++Qb;xd=Xc>>8&255;this.tHb[Math.floor(Qb/4)]|=xd<<Qb%4*8;++Qb;xd=Xc&255;this.tHb[Math.floor(Qb/4)]|=xd<<Qb%4*8;++Qb}}get length(){return this.oba}J(hb){if(0>hb||hb>=this.oba)throw Error.argumentOutOfRange("i");
return this.nTh(hb)}ly(hb,Ab){if(0>hb||0>Ab||hb+Ab>this.oba)throw Error.argument("Bad range");let Qb=0;for(let uc=0;uc<Ab;++uc)Qb|=this.nTh(hb+uc)<<8*uc;return Qb}Etn(hb,Ab){let Qb=0,uc=0,Xc=Math.floor(hb/8);for(hb%=8;uc<Ab;){const xd=8-hb>Ab-uc?Ab-uc:8-hb,de=this.J(Xc);Qb|=(de>>hb&~(255<<xd))<<uc;uc+=xd;++Xc;hb=0}return Qb}nTh(hb){return this.tHb[Math.floor(hb/4)]>>hb%4*8&255}}ci.R9d=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(ci,"ByteArray",null,[]);class Fl{constructor(hb,Ab,Qb){this.rD=hb;this.vPm=Ab;this.yPm=Qb;this.Pvi=Array(hb.b?hb.b.length:0);this.HDf=new Mi.a(new of.a(this.Ufb(this.rD.s)));this.V7=Array(hb.t.length);this.KD=new J.Annotations(this.Rfb(0),this)}get annotations(){return this.KD}get P8k(){return this.rD.d}mKl(){if(!(""in this.rD.m))throw Error.argument("name","Unrecognized module");return this.xkf(this.rD.m[""])}Ufb(hb){if(0>
hb||!this.rD.b||hb>=this.rD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Pvi[hb]||(this.Pvi[hb]=new ci(this.rD.b[hb]))}vE(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.V7[hb]){const Ab=this.Rfb(hb).J(0);this.V7[hb]=this.HDf.vE(Ab)}return this.V7[hb]}aDb(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.rD.t[hb])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.V7[hb]){var Ab=this.Rfb(hb);const Qb=this.vE(Ab.J(0));Ab=1===Ab.J(1);this.V7[hb]=new RegExp(Qb,Ab?"i":"")}return this.V7[hb]}xSl(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}xkf(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not an NL module");
return this.V7[hb]||(this.V7[hb]=this.yPm.FKl(this.Rfb(hb),this))}pK(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not an annotation query");return this.V7[hb]||(this.V7[hb]=new pb(new bd(this.Rfb(hb),this)))}TBb(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.V7[hb]||
(this.V7[hb]=new vd(new rf(this.Rfb(hb),this)))}rma(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not a filter");return this.V7[hb]||(this.V7[hb]=this.vPm.rma(this.Rfb(hb),this))}IQl(hb){if(1>hb||hb>=this.rD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.rD.t[hb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.V7[hb]||(this.V7[hb]=new th(this.Rfb(hb),
this))}Rfb(hb){const Ab=this.rD.n[hb];hb=(hb<this.rD.t.length-1?this.rD.n[hb+1]:this.rD.n.length)-Ab;if(0>Ab||0>hb||Ab+hb>this.rD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ab+","+hb+")");const Qb=new Eb.a;Qb.Oef(this.rD.n,Ab,hb);return Qb}}Object(l.a)(Fl,"ObjectFetcher",null,[1219]);class xg{constructor(hb,Ab,Qb){if(!hb)throw Error.argumentNull("prediction");if(!Ab)throw Error.argumentNull("fieldNames");if(!Qb)throw Error.argumentNull("values");if(Ab.length!==
Qb.length)throw Error.argument("values","fieldNames and values do not have same length");this.dZj=hb;this.uHb=Ab;this.BUc=Qb}get prediction(){return this.dZj}get PMh(){return this.uHb.length}Fif(hb){return 0<=hb&&hb<this.uHb.length?this.uHb[hb]:null}getValue(hb){return 0<=hb&&hb<this.BUc.length?this.BUc[hb]:null}}Object(l.a)(xg,"PredictionData",null,[]);class Uf{constructor(hb,Ab){if(!hb)throw Error.argumentNull("predictions");if(!Ab)throw Error.argumentNull("tokenAttributes");this.BPm=hb;this.FPm=
Ab}Elf(){return this.BPm}fSh(){return this.FPm}}Object(l.a)(Uf,"PredictionDataWithTokenAttributes",null,[]);class tg{constructor(hb,Ab){this.prediction=null;this.score=0;this.prediction=hb;this.score=Ab}}Object(l.a)(tg,"PredictionWithScore",null,[]);class sg{constructor(hb,Ab){if(!hb)throw Error.argumentNull("predictions");if(!Ab)throw Error.argumentNull("attributes");this.eZj=hb;this.IEj=Ab}Elf(){return this.eZj}fSh(){return this.IEj}}Object(l.a)(sg,"PredictionsWithTokenAttributes",null,[]);class jh{constructor(hb,
Ab,Qb){if(!hb)throw Error.argumentNull("attributeName");if(!Ab)throw Error.argumentNull("fieldNames");if(!Qb)throw Error.argumentNull("values");if(Ab.length!==Qb.length)throw Error.argument("values","fieldNames and values do not have same length");this.HEj=hb;this.uHb=Ab;this.BUc=Qb}get attributeName(){return this.HEj}get PMh(){return this.uHb.length}Fif(hb){return 0<=hb&&hb<this.uHb.length?this.uHb[hb]:null}getValue(hb){return 0<=hb&&hb<this.BUc.length?this.BUc[hb]:null}}Object(l.a)(jh,"TokenAttributes",
null,[]);var eh=c(52),li=c(691);class Oj{constructor(hb,Ab,Qb,uc,Xc){this.Q8c=0;this.Zfg=null;this.R8c=this.Fkc=0;this.wje=this.tPb=this.eqa=this.Gkc=null;this.$fg=0;this.sEe=this.vB=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.mR=hb;this.Iuj=this.Muj=Ab;this.Huj=this.Kuj=Qb;this.O8c=this.Juj=uc;this.P8c=this.Luj=Xc}Nuj(){this.R8c=0;return this.Xfg}Xfg(){if(!(this.R8c<this.O8c))return this.Yfg;this.Gkc=this.Iuj.items[this.R8c+
this.Huj];this.eqa=new N.a(this.mR.Cb.annotations);1!==this.O8c&&this.mR.Cb.cQc||this.eqa.aZa(this.Gkc);if(0<=this.mR.Cb.ZZd){({value:this.tPb}=this.eqa.uq(this.mR.Cb.ZZd)).returnValue?this.tPb=this.tPb.AS():this.tPb=new Nb.a(this.mR.Cb.annotations,J.Annotations.RU);this.wje=this.P8c.items;this.$fg=this.wje.length;for(this.Q8c=0;this.Q8c<this.$fg;++this.Q8c)this.Zfg=this.wje[this.Q8c],Array.add(this.tPb.items,this.Zfg);this.eqa.ny(this.mR.Cb.ZZd,this.tPb)}else 0<=this.mR.Cb.w6f?this.eqa.ny(this.mR.Cb.w6f,
this.P8c.items[0]):0<=this.mR.Cb.SXe?this.eqa.ny(this.mR.Cb.SXe,!0):this.mR.Cb.Tli?this.P8c.items[0].OHd((hb,Ab)=>this.eqa.ny(hb,Ab)):(this.eqa.aZa(this.P8c.items[0]),1!==this.O8c&&this.mR.Cb.cQc||(({value:this.Fkc}=this.Gkc.uq(this.mR.Cb.n2)).returnValue&&this.eqa.ny(this.mR.Cb.n2,this.Fkc),({value:this.Fkc}=this.Gkc.uq(this.mR.Cb.l6)).returnValue&&this.eqa.ny(this.mR.Cb.l6,this.Fkc),this.Gkc.uq(this.mR.Cb.Bcb).returnValue&&this.eqa.ny(this.mR.Cb.Bcb,this.Fkc)));this.vB=this.eqa;this._state=2;return this.Puj}Yfg(){this._state=
3}Ouj(){this.R8c++;return this.Xfg}Puj(){return 1<this.O8c&&this.mR.Cb.cQc?this.Yfg:this.Ouj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Oj(this.mR,this.Muj,this.Kuj,this.Juj,this.Luj)).getEnumerator()}[Symbol.iterator](){return Object(li.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.sEe=this.Nuj());for(;1===this._state;)this.sEe=this.sEe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");
}get_current(){return this.vB}}Object(l.a)(Oj,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[9,73,81]);class yk{constructor(hb,Ab,Qb){this.yUc=this.Ivi=0;this.oac=null;this.IDf=this.pDf=this.lac=this.vYd=this.sDf=0;this.wYd=!1;this.CDf=hb;this.KDf=Ab;this.APm=Qb}U_h(){null===this.oac&&({Ghj:this.oac,wbi:this.sDf,length:this.vYd,Kfl:hb}=this.CDf.z6h(this.KDf.items[this.yUc],this.APm),this.wYd=hb||this.wYd);if(this.lac<
this.vYd){var hb=this.oac.charAt(this.sDf+this.lac);++this.lac;return{returnValue:!0,ch:hb}}if(this.yUc===this.KDf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.yUc;this.lac=0;this.oac=null;return{returnValue:!0,ch:" "}}CWf(hb,Ab){this.lac===this.vYd&&this.oac&&(this.IDf=Ab,this.pDf=this.yUc-this.Ivi+1)}MKn(hb){if(0>hb||hb>=this.KDf.items.length)throw Error.argumentOutOfRange("iToken");this.yUc=this.Ivi=hb;this.oac=null;this.pDf=this.lac=this.vYd=this.sDf=0;this.IDf=-1;this.wYd=!1}lJl(){return{rxk:this.pDf,
DAm:this.IDf,Jfl:this.wYd}}}Object(l.a)(yk,"TriePrefixVisitor",null,[1262]);class dj{constructor(hb){this.Cb=hb}execute(hb){if(!({value:Qb}=hb.uq(this.Cb.OLa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ab;({value:Ab}=hb.uq(this.Cb.eYa)).returnValue||(Ab=null);var Qb=this.Irl(Qb,Ab);hb=J.Annotations.AS(hb);hb.ny(this.Cb.OLa,Qb);return hb}Irl(hb,Ab){let Qb=null;const uc=this.Cb.flatLexicon.trie,Xc=new yk(this,hb,Ab);let xd=null;this.Cb.flatLexicon.guf()&&
(xd=Object(eh.a)(this.Cb.flatLexicon,this.Cb.flatLexicon.hvl,"getCaseInsensitiveForm"));let de=0,Dd;var ee;let vf;for(;de<hb.items.length;){const eg=hb.items[de];Xc.MKn(de);uc.Nsj(Xc,xd);({rxk:Dd,DAm:ee,Jfl:vf}=Xc.lJl());if(0<Dd){({eDm:ee}=this.Cb.flatLexicon.Dsl(ee));for(let $b of this.iVk(hb,de,Dd,ee)){1<Dd&&this.Cb.cQc&&this.$Vk(hb,Ab,de,eg,Dd,vf,$b);if(!Qb)for(Qb=new Nb.a(this.Cb.annotations,J.Annotations.RU),ee=0;ee<de;++ee)Array.add(Qb.items,hb.items[ee]);Array.add(Qb.items,$b)}de+=Dd}else Qb&&
Array.add(Qb.items,eg),++de}return Qb||hb}$Vk(hb,Ab,Qb,uc,Xc,xd,de){if(xd)xd=!0;else if(this.Cb.zli){xd=!1;var Dd=-1;for(var ee=0;ee<Xc;ee++){var vf=hb.items[Qb+ee];let $f;var eg=void 0;if(!({value:$f}=vf.uq(this.Cb.n2)).returnValue||!({value:eg}=vf.uq(this.Cb.l6)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<ee){if($f>Dd+1){xd=!0;break}if(0>Dd||null===Ab||Dd>=Ab.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Ab.charAt(Dd)){xd=!0;break}}Dd=$f+eg}}else xd=!1;if(xd){eg=new Sys.StringBuilder;for(xd=0;xd<Xc;++xd)({Ghj:Dd,wbi:ee,length:vf}=this.z6h(hb.items[Qb+xd],Ab)),0<xd&&eg.append(" "),eg.append(Dd.substr(ee,vf));de.ny(this.Cb.Bcb,eg.toString())}hb=hb.items[Qb+Xc-1];let $b,Hd;({value:uc}=uc.uq(this.Cb.n2)).returnValue&&({value:$b}=hb.uq(this.Cb.n2)).returnValue&&({value:Hd}=hb.uq(this.Cb.l6)).returnValue?(de.ny(this.Cb.n2,uc),de.ny(this.Cb.l6,$b+Hd-uc)):(de.lRa(this.Cb.n2),de.lRa(this.Cb.l6))}iVk(hb,
Ab,Qb,uc){return new Oj(this,hb,Ab,Qb,uc)}z6h(hb,Ab){let Qb,uc;if(({value:Qb}=hb.uq(this.Cb.Bcb)).returnValue)uc=!0,Ab=0,hb=Qb.length;else{uc=!1;if(null===Ab)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Qb=Ab;if(!({value:Ab}=hb.uq(this.Cb.n2)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:hb}=hb.uq(this.Cb.l6)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>Ab||0>hb||Ab+hb>Qb.length)throw Error.argument("Token start/length values out of range","token");}return{Ghj:Qb,wbi:Ab,length:hb,Kfl:uc}}}Object(l.a)(dj,"FlatLexiconNLModule",null,[1249]);class bl{constructor(hb,Ab){this.SXe=this.ZZd=this.w6f=this.Bcb=this.l6=this.n2=this.eYa=this.OLa=0;this.Tli=this.zli=this.cQc=!1;this.flatLexicon=null;this.annotations=Ab.annotations;let Qb=0;try{this.OLa=hb.J(Qb),++Qb,this.eYa=hb.J(Qb),++Qb,this.n2=hb.J(Qb),++Qb,this.l6=hb.J(Qb),++Qb,this.Bcb=hb.J(Qb),++Qb,
this.w6f=hb.J(Qb),++Qb,this.ZZd=hb.J(Qb),++Qb,this.SXe=hb.J(Qb),++Qb,this.cQc=1===hb.J(Qb),++Qb,this.zli=1===hb.J(Qb),++Qb,this.Tli=1===hb.J(Qb),++Qb,this.flatLexicon=Ab.IQl(hb.J(Qb))}catch(uc){throw Error.argument("initData");}}}Object(l.a)(bl,"FlatLexiconNLModuleInit",null,[]);class mh{constructor(){this.kOc=0;this.Hcf=null;this.H1c=0}}Object(l.a)(mh,"FeatureGenStackRec",null,[]);class Qk{constructor(hb){this.Y$f=Array(hb);this.Uic=Array(hb);this.Y7f=[];this.kfj=[]}}Object(l.a)(Qk,"TokenStringLattice",
null,[]);const Zf=(hb,Ab,Qb)=>{for(let uc=0;uc<hb.length;uc++)Qb=Ab(Qb,hb[uc]);return Qb},Pl=(hb,Ab)=>{const Qb=Array(hb.length);for(let uc=0;uc<hb.length;uc++)Qb[uc]=Ab(hb[uc]);return Qb},rh=(hb,Ab)=>{Ab=Array(Math.min(Ab,hb.length));for(let Qb=0;Qb<Ab.length;Qb++)Ab[Qb]=hb[Qb];return Ab},tf=(hb,Ab)=>{const Qb=[];for(const uc of hb)Ab(uc)&&Array.add(Qb,uc);return Qb};class Ql{constructor(hb,Ab){this.key=hb;this.value=Ab}}Object(l.a)(Ql,"KeyValuePair",null,[]);const ji=(hb,Ab)=>({returnValue:Ab in
hb,value:hb[Ab]}),fi=hb=>{const Ab=[];for(let Qb in hb){const uc=new Ql(Qb,hb[Qb]);Array.add(Ab,uc)}return Ab};class Yh{constructor(hb){this.y6h=this.wXl;this.Cb=hb;this.zYd=this.zDf=this.ADf=0;for(const Ab of this.Cb.uGd)this.ADf=Math.max(this.ADf,Ab.pRf),this.zDf=Math.max(this.zDf,Ab.kRf),this.zYd=Math.max(this.zYd,Ab.rnb.length)}get Ohl(){return this.Cb.Ufe.trie}execute(hb){if(!hb)throw Error.argumentNull("input");let Ab,Qb;({tokens:Ab,HBm:Qb}=this.xXl(hb));let uc=null,Xc=null,xd={};if(this.Cb.GQc){Ab=
J.Annotations.AS(Ab);for(var de=0;de<Ab.items.length;++de)Ab.items[de]=J.Annotations.AS(Ab.items[de])}else({vMh:Xc,returnValue:uc}=this.N0h(hb,xd));de=Array(this.zYd);const Dd=Array(this.zYd);for(var ee=0;ee<Dd.length;++ee)Dd[ee]=new mh;for(ee=-this.ADf;ee<Ab.items.length+this.zDf;++ee){let vf=null;this.Cb.GQc&&(vf=Ab.items[ee],xd={},{vMh:Xc,returnValue:uc}=this.N0h(vf,xd));for(const eg of this.Cb.uGd){if(0>ee&&-ee>eg.pRf||ee>=Ab.items.length&&ee-Ab.items.length+1>eg.kRf)continue;let $b=!0;for(let Hd=
0;Hd<eg.rnb.length;++Hd){const $f=ee+eg.rnb[Hd];de[Hd]=$f;if(0>$f?0>this.Cb.qRf:$f>=Ab.items.length?0>this.Cb.lRf:!Qb.Uic[$f]){$b=!1;break}}$b&&({dZk:uc,eZk:Xc}=this.Ahm(eg,Qb,uc,Xc,xd,Dd,de))}this.Cb.GQc&&(vf.ny(this.Cb.J1a?this.Cb.a_b:this.Cb.ZZb,uc),this.Cb.J1a&&vf.ny(this.Cb.$Zb,Xc))}hb=J.Annotations.AS(hb);this.Cb.GQc?hb.ny(this.Cb.OLa,Ab):(hb.ny(this.Cb.J1a?this.Cb.a_b:this.Cb.ZZb,uc),this.Cb.J1a&&hb.ny(this.Cb.$Zb,Xc));return hb}xXl(hb){let Ab,Qb;if(!hb||!({value:Ab}=hb.uq(this.Cb.OLa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let uc;({value:uc}=hb.uq(this.Cb.eYa)).returnValue||(uc="");Qb=new Qk(Ab.items.length);const Xc=tf(this.Cb.aag,xd=>!xd.gPc||xd.gPc.isMatch(hb,null));for(let xd=0;xd<Ab.items.length;++xd){const de=Ab.items[xd];let Dd=null;Qb.Y$f[xd]=Qb.Y7f.length;let ee=Qb.Uic[xd]=0;for(const vf of Xc)0<vf.MUc&&Qb.Uic[xd]+ee>=vf.MUc||vf.X5c&&!vf.X5c.isMatch(de,null)||({Y5c:Dd,wCc:ee}=vf.apply(this,de,xd,Qb,uc,Dd,ee))}return{tokens:Ab,HBm:Qb}}Ahm(hb,Ab,Qb,uc,Xc,xd,de){let Dd=0;xd[0].kOc=-1;for(xd[0].Hcf=hb.N_i;;){var ee=
de[Dd],vf=0>ee||ee>=Ab.Uic.length?1:Ab.Uic[ee];let Hd=!1;for(;xd[Dd].kOc<vf-1;){++xd[Dd].kOc;var eg=void 0,$b=void 0;0>ee?(eg=this.Cb.qRf,$b=1):ee>=Ab.Y$f.length?(eg=this.Cb.lRf,$b=1):($b=Ab.Y$f[ee]+xd[Dd].kOc,eg=Ab.Y7f[$b],$b=Ab.kfj[$b]);xd[Dd].H1c=$b*(Dd?xd[Dd-1].H1c:hb.score);if(({value:eg}=ji(xd[Dd].Hcf,eg.toString())).returnValue){Dd===hb.rnb.length-1?(ee=eg,xd[Dd].H1c&&(({value:vf}=ji(Xc,ee.toString())).returnValue||(vf=-1),0>vf&&(Qb=J.Annotations.AS(Qb),Array.add(Qb.items,ee)),this.Cb.J1a&&
(uc=J.Annotations.AS(uc),0>vf?Array.add(uc.items,xd[Dd].H1c):uc.items[vf]+=xd[Dd].H1c),0>vf&&(this.Cb.jpi||this.Cb.J1a)&&(Xc[ee.toString()]=Qb.items.length-1))):(++Dd,xd[Dd].kOc=-1,xd[Dd].Hcf=eg);Hd=!0;break}}if(!Hd&&(--Dd,0>Dd))break}return{dZk:Qb,eZk:uc}}N0h(hb,Ab){let Qb;if(({value:Qb}=hb.uq(this.Cb.J1a?this.Cb.a_b:this.Cb.ZZb)).returnValue)for(let uc=0;uc<Qb.items.length;++uc)Ab[Qb.items[uc].toString()]=uc;else Qb=new Nb.a(this.Cb.annotations,J.Annotations.pHa);if(this.Cb.J1a){if(({value:Ab}=
hb.uq(this.Cb.$Zb)).returnValue||(Ab=new Nb.a(this.Cb.annotations,J.Annotations.Lpa)),Ab.items.length!==Qb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Cb.annotations.Mca(J.Annotations.RU,hb));}else Ab=null;return{returnValue:Qb,vMh:Ab}}get Ano(){return this.Cb.Ufe}wXl(hb,Ab){var Qb;if(({value:Qb}=Ab.uq(this.Cb.Bcb)).returnValue)hb=Qb;else{if(!({value:Qb}=Ab.uq(this.Cb.n2)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Ab}=Ab.uq(this.Cb.l6)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Qb||0>Ab||Qb+Ab>hb.length)throw Error.argument("Token indices are out of range");hb=hb.substr(Qb,Ab)}return hb}}Object(l.a)(Yh,"NGramNLModule",null,[1249,1250]);class Yj{constructor(hb){this.rnb=null;this.score=this.kRf=this.pRf=0;this.N_i=null;if(hb){var Ab=0;try{if(hb.J(Ab)!==Yj.wyb)throw Error.argument("initData","Input does not represent a feature template");++Ab;const Qb=hb.J(Ab);++Ab;this.rnb=
Array(Qb);for(let uc=0;uc<Qb;++uc)this.rnb[uc]=hb.J(Ab),++Ab;this.pRf=hb.J(Ab);++Ab;this.kRf=hb.J(Ab);++Ab;this.score=hb.J(Ab);++Ab;this.N_i=({qbi:Ab}=Yj.yRi(hb,Ab)).returnValue}catch(Qb){throw Error.argument("initData");}}}static yRi(hb,Ab){const Qb=hb.J(Ab);++Ab;const uc={};for(let Xc=0;Xc<Qb;++Xc){const xd=hb.J(Ab);++Ab;hb.J(Ab)?uc[xd.toString()]=({qbi:Ab}=Yj.yRi(hb,Ab)).returnValue:(++Ab,uc[xd.toString()]=hb.J(Ab),++Ab)}return{returnValue:uc,qbi:Ab}}}Yj.wyb=240803228;Object(l.a)(Yj,"FeatureTemplate",
null,[1264]);var ef=c(1547);class Zj{constructor(hb,Ab){this.J1a=this.jpi=this.GQc=!1;this.Bcb=this.l6=this.n2=this.OLa=this.eYa=this.$Zb=this.a_b=this.ZZb=0;this.Ufe=null;this.lRf=this.qRf=0;this.uGd=this.aag=null;if(hb){this.annotations=Ab.annotations;var Qb=0;try{this.GQc=1===hb.J(Qb);++Qb;this.jpi=1===hb.J(Qb);++Qb;this.J1a=1===hb.J(Qb);++Qb;this.ZZb=hb.J(Qb);++Qb;this.a_b=hb.J(Qb);++Qb;this.$Zb=hb.J(Qb);++Qb;this.eYa=hb.J(Qb);++Qb;this.OLa=hb.J(Qb);++Qb;this.n2=hb.J(Qb);++Qb;this.l6=hb.J(Qb);
++Qb;this.Bcb=hb.J(Qb);++Qb;this.Ufe=this.Zen(Ab.Ufb(hb.J(Qb)));++Qb;this.qRf=hb.J(Qb);++Qb;this.lRf=hb.J(Qb);++Qb;const uc=hb.J(Qb);++Qb;this.aag=Array(uc);for(let xd=0;xd<uc;++xd){const de=hb.J(Qb);++Qb;const Dd=this.Ufe.trie,ee=new Eb.a;ee.Efb(hb,Qb,de);this.aag[xd]=this.cfn(ee,Ab,Dd);Qb+=de}const Xc=hb.J(Qb);++Qb;this.uGd=Array(Xc);for(Ab=0;Ab<Xc;++Ab){const xd=hb.J(Qb);++Qb;const de=new Eb.a;de.Efb(hb,Qb,xd);this.uGd[Ab]=this.Gen(de);Qb+=xd}}catch(uc){throw Error.argument("initData");}}}Zen(hb){return new Mi.a(new of.a(hb))}cfn(hb,
Ab,Qb){return ef.a.create(hb,Ab,Qb)}Gen(hb){return new Yj(hb)}}Object(l.a)(Zj,"NGramNLModuleInit",null,[]);class Od{constructor(hb){this.Cb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");hb=hb.clone();this.Cb.script.execute(hb,null);return hb}}Object(l.a)(Od,"ScriptNLModule",null,[1249]);class Sh{constructor(hb,Ab){hb&&(this.script=Ab.TBb(hb.J(0)))}}Object(l.a)(Sh,"ScriptNLModuleInit",null,[]);const qf=hb=>{hb=Pl(hb,Ab=>Ab*Ab);return Math.sqrt(Zf(hb,(Ab,Qb)=>Ab+Qb,0))},Ld=hb=>Zf(hb,(Ab,Qb)=>
Ab>Qb?Ab:Qb,hb[0]);class fh{constructor(hb){this.Cb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");var Ab=[],Qb=[];this.GIk(hb,Ab,Qb);this.xhk(Ab,Qb);const uc={};for(let xd=0;xd<Ab.length;++xd){var Xc=Ab[xd];const de=this.Cb.ifi.J(Xc);Xc=this.Cb.jfi.J(Xc);for(let Dd=0;Dd<Xc;++Dd){const ee=this.Cb.u6.J(this.Cb.$rh.J(de+Dd)),vf=this.Cb.ash.J(de+Dd);let eg;({value:eg}=ji(uc,ee)).returnValue||(eg=0);uc[ee]=eg+Qb[xd]*vf}}Qb=fi(uc);Qb.sort((xd,de)=>{var Dd=xd.value,ee=de.value;(Dd=-(Dd>ee?1:Dd<
ee?-1:0))||(Dd=xd.key.localeCompare(de.key));return Dd});Ab=new Nb.a(this.Cb.annotations,J.Annotations.RU);for(const xd of rh(Qb,this.Cb.SRm))Qb=new N.a(this.Cb.annotations),Qb.ny(this.Cb.gpk,xd.key),Qb.ny(this.Cb.ipk,xd.value),Array.add(Ab.items,Qb);hb.ny(this.Cb.hpk,Ab);return hb}GIk(hb,Ab,Qb){if(({value:hb}=hb.uq(this.Cb.fpk)).returnValue){let uc;if(({value:uc}=hb.uq(this.Cb.a_b)).returnValue){let Xc;if(!({value:Xc}=hb.uq(this.Cb.$Zb)).returnValue||uc.items.length!==Xc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.Dzd(uc,Xc,Ab,Qb)}if(({value:uc}=hb.uq(this.Cb.kpk)).returnValue){let Xc;if(!({value:Xc}=hb.uq(this.Cb.lpk)).returnValue||uc.items.length!==Xc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.Dzd(uc,Xc,Ab,Qb)}({value:uc}=hb.uq(this.Cb.ZZb)).returnValue&&this.Dzd(uc,null,Ab,Qb);({value:uc}=hb.uq(this.Cb.jpk)).returnValue&&this.Dzd(uc,null,Ab,Qb)}}Dzd(hb,Ab,Qb,uc){for(let xd=0;xd<hb.items.length;++xd){var Xc=void 0;hb.F3===
J.Annotations.b9?({value:Xc}=ji(this.Cb.YHh,hb.items[xd])).returnValue||(Xc=-1):(Xc=hb.items[xd],Xc=Xc>=this.Cb.hFf&&Xc<=this.Cb.vSm?this.Cb.PIf?this.Cb.PIf.J(Xc-this.Cb.hFf)-1:Xc-this.Cb.hFf:-1);if(0<=Xc){let de;de=Ab?Ab.items[xd]:1;0<de&&(Array.add(Qb,Xc),Array.add(uc,de))}}}xhk(hb,Ab){if(hb.length){switch(this.Cb.dpn){case 0:break;case 1:for(var Qb=0;Qb<Ab.length;++Qb)Ab[Qb]=1+Math.log(Ab[Qb]);break;case 2:Qb=Ld(Ab);for(let uc=0;uc<Ab.length;++uc)Ab[uc]=.5+Ab[uc]/Qb*.5;break;case 3:for(Qb=0;Qb<
Ab.length;++Qb)Ab[Qb]=1;break;default:throw Error.notImplemented();}if(this.Cb.nRd)for(Qb=0;Qb<Ab.length;++Qb)Ab[Qb]*=this.Cb.nRd.J(hb[Qb]);hb=qf(Ab);for(Qb=0;Qb<Ab.length;++Qb)Ab[Qb]/=hb}}}Object(l.a)(fh,"TfIdfRankerNLModule",null,[1249]);class Vm{constructor(hb,Ab=0){if(!hb)throw Error.argumentNull("byteArray");this.AYd=Ab;if(604662927!==hb.ly(this.AYd+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.gj=hb.ly(this.AYd+4,4);this.rvi=hb.ly(this.AYd+8,4);this.oPm=
hb}J(hb){if(0>hb||hb>=this.count)throw Error.argumentOutOfRange("index");return this.oPm.Etn(8*this.AYd+96+hb*this.rvi,this.rvi)}get count(){return this.gj}}Object(l.a)(Vm,"CompactIntArray",null,[1248]);const zl=(hb,Ab)=>{Ab=Array(Ab);for(let xd=0;xd<Ab.length;xd++){var Qb=xd,uc=hb.t8(),Xc=1===(uc>>31&1)?-1:1;const de=uc&8388607;uc=uc>>23&255;256===uc+1?Xc=de?Number.NaN:1===Xc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:uc?(uc-=127,Xc=Xc*Pm(de,1)*Math.pow(2,uc)):Xc=Xc*Pm(de,0)*Math.pow(2,-126);
Ab[Qb]=Xc}return Ab},Pm=(hb,Ab)=>{let Qb=0;for(let uc=0;23>uc;uc++)Qb+=(hb>>22-uc&1)/Math.pow(2,uc+1);return Ab+Qb};class xo{constructor(hb,Ab){this.PIf=null;this.zBi=0;this.jfi=this.ifi=this.nRd=null;this.yBi=0;this.ash=this.$rh=null;this.annotations=Ab.annotations;let Qb=0;this.jpk=hb.J(Qb);++Qb;this.ZZb=hb.J(Qb);++Qb;this.kpk=hb.J(Qb);++Qb;this.lpk=hb.J(Qb);++Qb;this.a_b=hb.J(Qb);++Qb;this.$Zb=hb.J(Qb);++Qb;this.fpk=hb.J(Qb);++Qb;this.hpk=hb.J(Qb);++Qb;this.gpk=hb.J(Qb);++Qb;this.ipk=hb.J(Qb);
++Qb;var uc=hb.J(Qb);++Qb;var Xc=Array(uc);for(var xd=0;xd<uc;++xd)Xc[xd]=Ab.vE(hb.J(Qb)),++Qb;this.u6=Eb.a.c5e(Xc);this.SRm=hb.J(Qb);++Qb;this.dpn=hb.J(Qb);++Qb;uc=hb.J(Qb);++Qb;this.YHh={};for(Xc=0;Xc<uc;++Xc){xd=Ab.vE(hb.J(Qb));++Qb;const de=hb.J(Qb);++Qb;this.YHh[xd]=de}this.hFf=hb.J(Qb);++Qb;this.vSm=hb.J(Qb);++Qb;uc=hb.J(Qb);++Qb;0<uc&&(uc=Ab.Ufb(hb.J(Qb)),++Qb,this.PIf=this.L3d(new Ui(uc)));++Qb;hb=Ab.Ufb(hb.J(Qb));this.Nen(hb)}L3d(hb){return new Vm(hb.rea,hb.offset)}Nen(hb){try{const Ab=new Ui(hb);
this.zBi=Ab.t8();1===Ab.t8()?this.nRd=Eb.a.c5e(zl(Ab,this.zBi)):this.nRd=null;const Qb=Ab.t8();this.ifi=this.L3d(Ab);Ab.offset+=Qb;const uc=Ab.t8();this.jfi=this.L3d(Ab);Ab.offset+=uc;this.yBi=Ab.t8();const Xc=Ab.t8();this.$rh=this.L3d(Ab);Ab.offset+=Xc;this.ash=Eb.a.c5e(zl(Ab,this.yBi))}catch(Ab){throw Error.argument("byteReader");}}}Object(l.a)(xo,"TfIdfRankerNLModuleInit",null,[]);class Vn{constructor(hb,Ab,Qb,uc){this.zPf=hb;this.rOh=Qb;this.tokens=uc;this.yla=Ab;this.Sfc=-1;this.D$d=0}}Object(l.a)(Vn,
"TokenizerData",null,[]);class zk{constructor(hb){this.Cb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");if(!({value:uc}=hb.uq(this.Cb.eYa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ab;({value:Ab}=hb.uq(this.Cb.n2)).returnValue||(Ab=0);let Qb;({value:Qb}=hb.uq(this.Cb.l6)).returnValue||(Qb=uc.length-Ab);if(0>Ab||Ab>uc.length)throw Error.argument("input","Start index out of range");if(0>Qb||Qb>uc.length)throw Error.argument("input",
"Length out of range");if(Ab+Qb>uc.length)throw Error.argument("input","Bad start-length range");var uc=new Vn(uc,Ab,Ab+Qb,new Nb.a(this.Cb.annotations,J.Annotations.RU));this.Bno(uc);hb=hb.isReadOnly?hb.clone():hb;hb.ny(this.Cb.OLa,uc.tokens);return hb}Bno(hb){for(;hb.yla<hb.rOh;){if(this.Cb.Jof){var Ab=this.Cb.Jof.Wui(hb.zPf,hb.yla,hb.rOh-hb.yla,null);!Ab.succeeded&&Ab.wAi&&(Ab=Ab.wAi);if(Ab.succeeded){this.qFi(hb,Ab.length,this.Cb.C8h);hb.yla+=Ab.length;continue}}Ab=hb.zPf.substr(hb.yla);let Qb=
-1,uc=-1,Xc=-1;for(let xd=0;xd<this.Cb.H9d.length;++xd){const de=this.Cb.H9d[xd].exec(Ab);de&&0<de[1].length&&(0>Qb||de[0].length>uc)&&(Qb=xd,uc=de[0].length,Xc=de[1].length)}0<=Qb?(this.qFi(hb,Xc,this.Cb.C_f[Qb]),hb.yla+=Xc):hb.yla+=1}}qFi(hb,Ab,Qb){if(this.Cb.Ani)Qb!==zk.Axk&&(0>hb.Sfc&&(hb.Sfc=hb.yla),hb.D$d=hb.yla+Ab-hb.Sfc,Qb===zk.zxk&&(0<=hb.Sfc&&0<hb.D$d&&(Ab=new N.a(this.Cb.annotations),Ab.ny(this.Cb.n2,hb.Sfc),Ab.ny(this.Cb.l6,hb.D$d),Ab.ny(this.Cb.GWe,zk.Bxk),Ab.ny(this.Cb.eYa,hb.zPf),Array.add(hb.tokens.items,
Ab)),hb.Sfc=-1,hb.D$d=0));else{let uc=new N.a(this.Cb.annotations);uc.ny(this.Cb.n2,hb.yla);uc.ny(this.Cb.l6,Ab);uc.ny(this.Cb.GWe,Qb);Array.add(hb.tokens.items,uc)}}}zk.Axk="GAP";zk.zxk="EOS_CHUNK";zk.Bxk="SENTENCE";Object(l.a)(zk,"TokenizerNLModule",null,[1249]);class Lh{constructor(hb,Ab){this.l6=this.n2=this.GWe=this.OLa=this.eYa=0;this.Ani=!1;this.C_f=this.H9d=this.C8h=this.Jof=null;if(hb){this.annotations=Ab.annotations;var Qb=0;try{this.eYa=hb.J(Qb);++Qb;this.OLa=hb.J(Qb);++Qb;this.GWe=hb.J(Qb);
++Qb;this.n2=hb.J(Qb);++Qb;this.l6=hb.J(Qb);++Qb;this.Ani=1===hb.J(Qb);++Qb;var uc=hb.J(Qb);++Qb;0<uc&&(this.Jof=Ab.xkf(uc).Ohl);this.C8h=hb.J(Qb)?Ab.vE(hb.J(Qb)):"";++Qb;const Xc=hb.J(Qb);++Qb;this.H9d=Array(Xc);this.C_f=Array(Xc);for(uc=0;uc<Xc;++uc)this.H9d[uc]=new RegExp(Ab.vE(hb.J(Qb))),++Qb,this.C_f[uc]=Ab.vE(hb.J(Qb)),++Qb}catch(Xc){throw Error.argument("initData");}}}}Object(l.a)(Lh,"TokenizerNLModuleInit",null,[]);class rk{constructor(hb){this.Cb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");
let Ab;if(!({value:Ab}=hb.uq(this.Cb.pkh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Qb of this.Cb.p7f)Ab=Qb.apply(Ab);hb=J.Annotations.AS(hb);hb.ny(this.Cb.qkh,Ab);return hb}static WVe(hb,Ab){const Qb=new Sys.StringBuilder;for(let uc=0;uc<hb.length;++uc)Qb.append(Ab(hb.substr(uc,1)));return Qb.toString()}}Object(l.a)(rk,"TransliteratorNLModule",null,[1249]);class Jj{constructor(hb){hb&&(this.style=hb.J(0))}apply(hb){return rk.WVe(hb,
Ab=>Jj.XBk(Ab,this.style))}static XBk(hb,Ab){switch(Ab){case 0:return hb.toLowerCase();case 1:return"I"===hb?"\u0131":hb.toLowerCase();case 2:return hb.toUpperCase();case 3:return"i"===hb?"\u0130":hb.toUpperCase();default:throw Error.invalidOperation();}}}Jj.xyb=0;Object(l.a)(Jj,"ChangeCaseTransliterationStage",null,[1261]);class Rl{apply(hb){return rk.WVe(hb,Rl.Xoo)}static Xoo(hb){const Ab=hb.charCodeAt(0);return 65281<=Ab&&65374>=Ab?String.fromCharCode(Ab-65248):hb}}Rl.xyb=4;Object(l.a)(Rl,"LatinFullWidthToHalfWidthTransliterationStage",
null,[1261]);class cl{constructor(hb,Ab){hb&&(this.XVf=Ab.aDb(hb.J(0)),this.wIn=Ab.vE(hb.J(1)))}apply(hb){return hb.replace(this.XVf,this.wIn)}}cl.xyb=1;Object(l.a)(cl,"RegexReplaceTransliterationStage",null,[1261]);class Am{constructor(hb,Ab){if(hb){var Qb=hb.J(0),uc=Ab.vE(hb.J(1)),Xc=new Vm(Ab.Ufb(hb.J(2)));hb=0>hb.J(3)?null:new Vm(Ab.Ufb(hb.J(3)));this.p8f={};for(Ab=0;Ab<Qb;++Ab)this.p8f[uc.charAt(Ab).toString()]=uc.substr(Xc.J(Ab),hb?hb.J(Ab):1)}}apply(hb){return rk.WVe(hb,Ab=>Ab in this.p8f?
this.p8f[Ab]:Ab)}}Am.xyb=2;Object(l.a)(Am,"SingleCharSubstitutionsTransliterationStage",null,[1261]);class fk{constructor(hb,Ab){this.qkh=this.pkh=0;this.p7f=null;if(hb){this.annotations=Ab.annotations;var Qb=0;try{this.pkh=hb.J(Qb);++Qb;this.qkh=hb.J(Qb);++Qb;const uc=hb.J(Qb);++Qb;this.p7f=Array(uc);for(let Xc=0;Xc<uc;++Xc){const xd=hb.J(Qb);++Qb;const de=hb.J(Qb);++Qb;const Dd=new Eb.a;Dd.Efb(hb,Qb,de);Qb+=de;this.p7f[Xc]=this.Yen(xd,Dd,Ab)}}catch(uc){throw Error.argument("initData");}}}Yen(hb,
Ab,Qb){switch(hb){case Jj.xyb:return new Jj(Ab);case cl.xyb:return new cl(Ab,Qb);case Am.xyb:return new Am(Ab,Qb);case Rl.xyb:return new Rl;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(fk,"TransliteratorNLModuleInit",null,[]);class cf{FKl(hb,Ab){const Qb=hb.J(0),uc=new Eb.a;uc.Efb(hb,1,hb.count-1);switch(Qb){case 0:return new Od(new Sh(uc,Ab));case 2:return new zk(new Lh(uc,Ab));case 3:return new Yh(new Zj(uc,Ab));case 5:return new dj(new bl(uc,
Ab));case 9:return new rk(new fk(uc,Ab));case 10:return new fh(new xo(uc,Ab));default:throw Error.notImplemented();}}}Object(l.a)(cf,"NLModuleFactory",null,[1226]);class ig{constructor(hb){this.xxk=";";if(!hb)throw Error.argumentNull("resource");this.Gga=new Fl(hb,new Ib,new cf);this.CDf=this.Gga.mKl();this.qvi=this.Gga.annotations.VJc("Text.Text");this.ovi=this.Gga.annotations.VJc("Classification.Predictions");this.nDf=this.Gga.annotations.VJc("Classification.PredictionString");this.pvi=this.Gga.annotations.VJc("Classification.Probability");
this.nPm=this.Gga.annotations.VJc("NLMod.Tokens");if(0>this.qvi||0>this.ovi||0>this.nDf||0>this.pvi)throw Error.argument("resourceObj","Resource does not represent a ranker");}Jtl(){const hb=[];this.zbf(void 0,this.QSh(hb),null);return hb}Ltl(hb,Ab){const Qb=[],uc=[];this.zbf(hb,this.QSh(Qb),(Xc,xd)=>{const de=this.Gga.annotations.ESh(Xc),Dd=[],ee=[];Ab&&Ab.length&&-1===Array.indexOf(Ab,de)||(Xc=this.Gga.annotations.getAttributeType(Xc),this.AMi(Xc,xd,Dd,ee),xd=new jh(de,Dd,ee),Array.add(uc,xd))});
return new sg(Qb,uc)}Ktl(hb){const Ab=[];this.zbf(hb,Qb=>{let uc;if(({value:uc}=Qb.uq(this.nDf)).returnValue){let Xc;({value:Xc}=Qb.uq(this.pvi)).returnValue&&Array.add(Ab,new tg(uc,Xc))}},null);return Ab}zbf(hb,Ab,Qb){var uc=new N.a(this.Gga.annotations);uc.ny(this.qvi,hb);hb=this.CDf.execute(uc);if(({value:uc}=hb.uq(this.ovi)).returnValue)for(const Xc of uc.items)Ab(Xc);if(Qb&&({value:Ab}=hb.uq(this.nPm)).returnValue)for(const Xc of Ab.items)Xc.OHd(Qb)}AMi(hb,Ab,Qb,uc){if(J.Annotations.EH(hb))for(var Xc of Ab.items)this.AMi(Ab.F3,
Xc,Qb,uc);else if(J.Annotations.hmj(hb)){Xc=this.Gga.annotations.r0h(hb);for(let xd=0;xd<Xc;xd++)Array.add(Qb,this.Gga.annotations.T4h(hb,xd)),Array.add(uc,this.Gga.annotations.Mca(this.Gga.annotations.lDb(hb,xd),Ab.jgb(xd)))}else Array.add(Qb,"VALUE"),Array.add(uc,this.Gga.annotations.Mca(hb,Ab))}QSh(hb){return Ab=>{let Qb;({value:Qb}=Ab.uq(this.nDf)).returnValue&&Array.add(hb,this.pPl(Qb))}}pPl(hb){const Ab=hb.indexOf(this.xxk);return 0>Ab?hb:hb.substring(0,Ab)}}Object(l.a)(ig,"Ranker",null,[]);
var gk=c(1493),wi=c(1508),pf=c(2);class wn{constructor(hb,Ab){this.QTg="";this.sIe=null;this.tIe=!1;this.iqa=null;this.KEj=["TellMe.TellMeParamCollection"];this.oc=hb;this.YVa=Ab;this.oc.Xxb&&(this.iqa=null)}get m6d(){if(!this.sIe&&!this.tIe){let hb=null;try{hb=window.TellMeModel}catch(Ab){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("QueryRanker","TellMeModel not found. Exception: "+Ab)}if(hb){try{this.sIe=new ig(hb)}catch(Ab){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("QueryRanker",
"Exception thrown while loading classifier. Exception: "+Ab)}this.tIe=!0}else if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("QueryRanker","Classifier model not found")}return this.sIe}uK(){return"Command"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb=!1,uc=e.a.tellMe,Xc=null){const xd=new v.a(hb);if((!Xc||Array.contains(Xc,0))&&!z.a.rQ(hb)){if(!this.m6d&&this.tIe){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("CRASH","CommandResultsProvider: Found invalid Model data");
throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.oc.Xxb&&this.iqa&&this.iqa.initialize();if(gk.CommandResultsUtility.muf(hb.Ig)&&(Xc=gk.CommandResultsUtility.vUh(hb.Ig),0<Xc.results.length)){Xc.displayName="Classifier Debug";xd.Lv(Xc);Ab.resultsUpdated(xd);return}Xc=hb?this.QTg=hb.Ig:this.QTg;if(pf.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Xc=this.rPl(Xc);var de=this.aJd(Xc.Elf());Xc=Xc.fSh()}else Xc=this.qPl(Xc),de=this.Mwl(Xc),Xc=[];gk.CommandResultsUtility.MXd(de,
!1,"Classifier","TFIDF");de=gk.CommandResultsUtility.iMd(hb,de,this.oc,this.iqa,this.YVa,Xc,0,1);0<de.results.length&&uc!==e.a.contextMenu&&(de.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Qb||de.results.length||this.oc.XZ||this.oc.G5a||(hb=new m.a("lookupNoResults",14,hb.Ig,null,1),de.Ly(hb));0<de.results.length&&xd.Lv(de);xd.attributes=Xc}Ab.resultsUpdated(xd)}Elf(){let hb=[];try{hb=this.m6d.Jtl()}catch(Ab){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("GetPredictions",
"Exception: "+Ab)}return hb}qPl(hb){let Ab=[];try{Ab=this.m6d.Ktl(hb)}catch(Qb){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("GetPredictionsWithScore","Exception: "+Qb)}return Ab}rPl(hb){try{return this.m6d.Ltl(hb,this.KEj)}catch(Ab){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("GetPredictionsWithTokenAttributes","Exception: "+Ab)}return new sg([],[])}aJd(hb){const Ab=[];if(hb)for(const Qb of hb)Ab.push(new wi.a(Qb,-99999));return Ab}Mwl(hb){const Ab=[];if(hb)for(const Qb of hb)Ab.push(new wi.a(Qb.prediction,
Qb.score));return Ab}}Object(l.a)(wn,"CommandResultsProvider",null,[1099]);var Gh=c(1676);class Gl{constructor(hb){this.oc=hb}uK(){return"Feedback"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb,uc,Xc=null){hb=new v.a(hb);if(!Xc||Array.contains(Xc,21))Xc=[],Xc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Xc),Xc=new w.a(22),Xc.displayName="",Xc.Ly(new m.a("TellMeFeedback",23,null,null,1)),hb.Lv(Xc);Ab.resultsUpdated(hb)}}
Object(l.a)(Gl,"FeedbackResultsProvider",null,[1099]);class Jk{constructor(hb,Ab,Qb,uc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=hb;this.CommandId=Ab;this.CommandValueId=Qb;this.InputText=uc}}Object(l.a)(Jk,"FindInDocumentProp",null,[]);var Ei=c(16);class bc{constructor(hb){this.kDe=2;this.Utb=[];this.Y$a=[];this.oc=hb;bc.MCa=hb.Qcf;bc.JNh="FindInDocumentSuggestion";bc.OLi="FindInDocumentSuggestion3";this.XBe=Object.assign(new A.a,{landingTab:"Indoc",data:null});
this.E1j=this.oc.hnb||!!pf.AFrameworkApplication.ta&&pf.AFrameworkApplication.ta.Pb.hnb}uK(){return"FindInDocument"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:3===this.oc.Su?this.oc.Gcj?2:3:2}qH(hb,Ab,Qb=!1,uc,Xc=null){const xd=new v.a(hb);if(Xc&&!Array.contains(Xc,2))Ab.resultsUpdated(xd);else if(Array.clear(this.Utb),z.a.rQ(hb)){if(Qb&&this.aaj()){Qb=new w.a(2);Qb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Xc=1;uc="";if(0<this.Y$a.length&&!this.oc.Ogc)for(var de of this.Y$a)if(""!==
de.Label.toLowerCase()){if(Xc>=this.kDe)break;this.Xpj(Qb,de.Label,de.CommandValueId,bc.JNh+Xc,de.InputText);Xc++}de="";this.oc.zO?(xd.Lv(Qb),Qb=new w.a(3),de=this.oc.wcb?z.a.Sfb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):de=CommonUIStrings.l_TellMeOpenFindPaneText;uc=this.uUh("");this.Xpj(Qb,de,uc,bc.OLi,"");xd.Lv(Qb)}Ab.resultsUpdated(xd)}else de="",Qb&&(Qb=this.uUh(hb.Ig),uc=[],this.oc.j2a?(this.oc.$be&&uc.push(appChrome.actions.setControlIconSet(bc.MCa,
{"default":"FindInDocument_20"})),de=this.oc.yyf?z.a.Yif(hb.Ig,CommonUIStrings.l_FindInDocumentScopedButtonText):hb.Ig+CommonUIStrings.l_FindInDocumentScopedButtonText):this.oc.zO?(de=this.oc.wcb?z.a.Sfb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,hb.Ig)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,hb.Ig),uc.push(appChrome.actions.setControlIconSet(bc.MCa,{"default":"FindInDocument_20"}))):de=this.oc.Ogc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,
hb.Ig),this.oc.Xua?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(bc.MCa,de)),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(bc.MCa,Qb))):(uc.push(appChrome.actions.setControlLabel(bc.MCa,de)),uc.push(appChrome.actions.setButtonCommandValueId(bc.MCa,Qb)),appChrome.api.dispatch(uc)),this.B6i(de,bc.MCa,Qb,hb.Ig)),this.oc.Gcj?(de=new m.a(bc.MCa,8,hb.Ig),Qb=new w.a(2),Qb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Qb.Ly(de),xd.Lv(Qb),
Ab.resultsUpdated(xd)):this.oc.WJd(hb.Ig).then(Dd=>{const ee=new m.a(bc.MCa,8,hb.Ig,null,1);ee.count=Dd;Dd=new w.a(2);Dd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Dd.Ly(ee);xd.Lv(Dd);Ab.resultsUpdated(xd)},Dd=>{r.TellMeActor.instance.Qe.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+Dd);Dd=new m.a(bc.MCa,8,hb.Ig,null,1);const ee=new w.a(2);ee.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ee.Ly(Dd);xd.Lv(ee);Ab.resultsUpdated(xd)})}aaj(){return!!this.oc&&
this.oc.Sbe}Xpj(hb,Ab,Qb,uc,Xc=null){const xd=[];Ab&&xd.push(appChrome.actions.setControlLabel(uc,Ab));this.oc.zO&&xd.push(appChrome.actions.setControlIconSet(uc,{"default":"FindInDocument_20"}));xd.push(appChrome.actions.setButtonCommandValueId(uc,Qb));appChrome.api.dispatch(xd);this.B6i(Ab,uc,Qb,"");hb.Ly(new m.a(uc,8,Xc,null,1,-99999))}uUh(hb){return this.E1j?z.a.zMa(hb,15,this.XBe):Ei.a.Cf(hb)}B6i(hb,Ab,Qb,uc){this.aaj()&&this.Utb.length<this.kDe&&(hb=new Jk(hb,Ab,Qb,uc),Array.add(this.Utb,hb))}OZn(hb){for(let Ab=
0;Ab<this.Utb.length;Ab++)if(this.Utb[Ab].CommandId===hb){const Qb=this.Utb[Ab].Label;let uc=!1;if(0<this.Y$a.length){let Xc=0;for(const xd of this.Y$a){if(xd.Label===Qb){Array.removeAt(this.Y$a,Xc);uc=!0;break}Xc++}}!uc&&this.Y$a.length>=this.kDe-1&&Array.removeAt(this.Y$a,1);Array.insert(this.Y$a,0,this.Utb[Ab])}}}bc.MCa=null;bc.JNh=null;bc.OLi=null;Object(l.a)(bc,"FindInDocumentResultsProvider",null,[1099]);var oe=c(1674);class Me{constructor(hb){this.oc=hb}uK(){return"Insights"}sT(){return 0===
this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb=!1,uc,Xc=null){uc=new v.a(hb);if(!Xc||Array.contains(Xc,13))if(this.P7n()||!z.a.rQ(hb)){Xc=new w.a(13);var xd=""===hb.Ig.trim(),de=xd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Dd=new m.a(de,10,hb.Ig,null,1);Qb&&(Qb=null,z.a.mga()?xd?xd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(xd=this.oc.Ogc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,hb.Ig),Qb=z.a.zMa(hb.Ig,1)):(xd=
String.format(CommonUIStrings.l_InsightsButtonText,hb.Ig),Qb=z.a.Nzb(hb.Ig)),this.oc.Xua?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(de,xd)),Qb&&r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Qb))):(hb=[],hb.push(appChrome.actions.setControlLabel(de,xd)),Qb&&hb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Qb)),appChrome.api.dispatch(hb)),Dd.label=xd);Xc.Ly(Dd);uc.Lv(Xc)}Ab.resultsUpdated(uc)}P7n(){return z.a.mga()&&
this.oc.Lko}}Object(l.a)(Me,"InsightsResultsProvider",null,[1099]);var Ri=c(1672);class Rk{constructor(hb){this.oc=hb}uK(){return"Learning"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb,uc,Xc=null){Qb=new v.a(hb);Xc&&!Array.contains(Xc,21)||!z.a.rQ(hb)||(Xc=[],uc=this.oc.OCm,Xc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",uc)),uc=Rk.TDl(uc),Xc.push(appChrome.actions.setControlLabel("LearningForSearch",uc)),appChrome.api.dispatch(Xc),hb=new m.a("LearningForSearch",
22,hb.Ig,null,1),Xc=new w.a(21),Xc.Ly(hb),Qb.Lv(Xc));Ab.resultsUpdated(Qb)}static TDl(hb){const Ab=[];Array.add(Ab,new Ri.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ab,new Ri.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Ab,new Ri.a(600,hb));Array.add(Ab,new Ri.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));hb={};hb.parts=Ab;return JSON.stringify(hb)}}Object(l.a)(Rk,"LearningProvider",null,[1099]);var cg=c(482);class af{constructor(hb,Ab){this.oUb=this.jYb=
this.Bab=this.ikd=null;this.Uw=!1;this.XUb=hb;this.RIj=Ab;hb&&this.XLh(hb)}Dge(){this.XUb.Dge()&&this.XLh(this.XUb)}Umf(hb){let Ab=[];var Qb=[];hb=af.FYm(hb);var uc="";Array.clear(Qb);for(let Xc=0;Xc<hb.length;Xc++){const xd=hb.charAt(Xc);-1!==" ".indexOf(xd)?(uc.length&&Array.add(Qb,uc),uc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(xd)?(uc.length&&Array.add(Qb,uc),uc=xd,Array.add(Qb,uc),uc=""):uc+=xd}uc.length&&Array.add(Qb,uc);for(hb=0;hb<Qb.length;hb++)uc=this.Lwl(Qb[hb]),uc=this.qPk(uc),
Ab=af.vTm(Ab,uc);return Ab=this.Lbk(Ab)}Mwf(){this.Uw||this.Dge();return this.Uw}KCd(hb){return this.ikd[hb.toString()]}Lbk(hb){for(let Ab=0;Ab<hb.length;Ab++){const Qb=this.Bab[Ab];if(hb[Ab].commandId!==this.KCd(Qb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let uc;(uc=hb[Ab]).score=uc.score+Qb[1]}return hb}qPk(hb){const Ab=[];for(var Qb=0;Qb<this.Bab.length;Qb++)Ab.push(new wi.a(this.KCd(this.Bab[Qb][0]),-5));Qb=new cg.a;for(var uc=0;uc<hb.length;uc++)Qb.add(this.KCd(hb[uc][0]));
for(uc=0;uc<Ab.length;uc++){const xd=Ab[uc];for(let de=0;de<hb.length;de++){var Xc=hb[de];const Dd=this.KCd(Xc[0]);Xc=Xc[1];if(Dd===xd.commandId){xd.score=Xc;Qb.remove(Dd);break}}if(!Qb.count)break}return Ab}Lwl(hb){const Ab=1>hb.length;for(let de=0;2>=de;de++){const Dd=this.oUb;for(let ee in Dd){var Qb=Dd[ee],uc=hb,Xc=ee;const vf=Xc.length+1,eg=Array((uc.length+1)*vf);for(var xd=0;xd<=uc.length;xd++)eg[xd*vf]=xd;for(xd=0;xd<=Xc.length;xd++)eg[xd]=xd;for(xd=0;xd<Xc.length;xd++)for(let $b=0;$b<uc.length;$b++)eg[($b+
1)*vf+(xd+1)]=uc.charAt($b)===Xc.charAt(xd)?eg[$b*vf+xd]:Math.min(Math.min(eg[$b*vf+(xd+1)]+1,eg[($b+1)*vf+xd]+1),eg[$b*vf+xd]+1);uc=eg[uc.length*vf+Xc.length];if((!uc||!Ab)&&uc<=de)return Qb}}return this.jYb}XLh(hb){this.ikd=hb.wkf();this.Bab=hb.ZPl();this.jYb=hb.DYl();this.oUb=hb.rHl();if(this.Uw=!!this.ikd&&!!this.Bab&&!!this.oUb&&!!this.jYb)this.Uw=0<this.Bab.length&&af.Vtf(this.Bab);this.Uw&&(this.Uw=0<this.jYb.length&&af.Vtf(this.jYb));this.Uw&&(this.oUb=af.rZl(this.oUb));this.Uw||(this.oUb=
this.jYb=this.Bab=this.ikd=null)}JXl(hb){hb=this.Umf(hb);return this.Ahl(hb,this.RIj)}Ahl(hb,Ab){let Qb=[];for(let uc=0;uc<hb.length;uc++)hb[uc].score>=Ab&&Qb.push(hb[uc]);Qb.sort((uc,Xc)=>uc.score<Xc.score?1:uc.score>Xc.score?-1:0);0<Qb.length-10&&(Qb=Qb.slice(0,10));return Qb}static vTm(hb,Ab){if(!hb.length)return Ab;if(hb.length!==Ab.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Qb=0;Qb<hb.length;Qb++){if(hb[Qb].commandId!==Ab[Qb].commandId)throw Error.create("Incorrect CommandId");
let uc;(uc=hb[Qb]).score=uc.score+Ab[Qb].score}return hb}static FYm(hb){return Ei.a.jh(hb)}static Vtf(hb){for(let Ab=0;Ab<hb.length;Ab++)if(2!==hb[Ab].length)return!1;return!0}static rZl(hb){const Ab={};for(let Xc in hb){var Qb=Xc,uc=hb[Xc];const xd=uc;xd.length&&af.Vtf(xd)&&(Ab[Qb]=uc)}return Ab}}Object(l.a)(af,"NaiveBayesClassifierModel",null,[]);class Zi{constructor(hb,Ab){this.iqa=null;this.oc=hb;this.nuc=new af(Ab,hb.GKl);this.oc.Xxb&&(this.iqa=null)}uK(){return"NBCommand"}sT(){return 0===this.oc.Su?
0:1===this.oc.Su?1:2}qH(hb,Ab,Qb=!1,uc=e.a.tellMe,Xc=null){const xd=new v.a(hb);if((!Xc||Array.contains(Xc,0))&&!z.a.rQ(hb)){if(gk.CommandResultsUtility.muf(hb.Ig)&&(Xc=gk.CommandResultsUtility.vUh(hb.Ig),0<Xc.results.length)){Xc.displayName="Classifier Debug";xd.Lv(Xc);Ab.resultsUpdated(xd);return}if(!this.nuc.Mwf()){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");
}this.oc.Xxb&&this.iqa&&this.iqa.initialize();Xc=this.nuc.JXl(hb.Ig);gk.CommandResultsUtility.MXd(Xc,!1,"Classifier","NaiveBayesian");Xc=gk.CommandResultsUtility.iMd(hb,Xc,this.oc,this.iqa,null,null,0,1);0<Xc.results.length&&uc!==e.a.contextMenu&&(Xc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Qb||Xc.results.length||this.oc.XZ||this.oc.G5a||(hb=new m.a("lookupNoResults",14,hb.Ig,null,1),Xc.Ly(hb));0<Xc.results.length&&xd.Lv(Xc)}Ab.resultsUpdated(xd)}}Object(l.a)(Zi,"NaiveBayesCommandProvider",
null,[1099]);class si{constructor(){this.Rtb=null;this.Uw=!1;this.Dge()}Dge(){this.Uw||(this.Rtb=window.NBCRM)&&4===this.Rtb.length&&(this.Uw=!0);return this.Uw}ZPl(){return this.Uw?this.Rtb[1]:null}DYl(){return this.Uw?this.Rtb[2]:null}rHl(){return this.Uw?this.Rtb[3][0]:null}wkf(){return this.Uw?this.Rtb[0][0]:null}}Object(l.a)(si,"NaiveBayesModelAdapter",null,[1125]);var eo=c(182);class lk{constructor(hb){this.oc=hb}uK(){return"OfficeScript"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,
Ab){const Qb=new v.a(hb);if(!z.a.rQ(hb)){hb=eo.d(hb.Ig);var uc=new w.a(26);uc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;uc=this.Idh(hb,lk.fto,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,uc);uc=this.Idh(hb,lk.Xol,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,uc);Qb.Lv(uc)}Ab.resultsUpdated(Qb)}Idh(hb,Ab,Qb,uc,Xc,xd){const de=[];for(const Dd of Ab)if(eo.a(hb,Dd)){this.oc.Xua?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Qb,
Xc)),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Qb,uc))):(de.push(appChrome.actions.setControlLabel(Qb,Xc)),de.push(appChrome.actions.setButtonCommandValueId(Qb,uc)),appChrome.api.dispatch(de));xd.Ly(new m.a(Qb,27,null,null,1));break}return xd}}lk.fto="unhide row rows col cols column columns".split(" ");lk.Xol=["freeze","selection","pane","panes"];Object(l.a)(lk,"OfficeScriptsSamplesProvider",null,[1099]);var cn=c(82),Al=c(283),Vc=c(1522),Sk=c(1485),ne=c(1521),qi=
c(33),Wf=c(119),Ak=c(27);class Qf{constructor(hb){this.hP=null;this.Y0=-1;this.rEf=14;this.uEf=12;this.attributes=this.KPe=this.query=null;this.q9b=!1;this.pWb=[];this.rg=pf.AFrameworkApplication.Ve;pf.AFrameworkApplication.K&&(this.rEf=pf.AFrameworkApplication.K.pc("TellMeMaxTermedResults",this.rEf),this.uEf=pf.AFrameworkApplication.K.pc("TellMeMaxZeroTermResults",this.uEf));this.eU=hb}get eo(){return this.pWb}get fhe(){return this.KPe}Lv(hb){let Ab=!1;for(let Qb=0;Qb<this.eo.length;Qb++)if(28!==
this.eo[Qb].groupType&&this.eo[Qb].groupType===hb.groupType){this.ZSe(this.eo[Qb],hb);Ab=!0;break}Ab||this.eo.push(hb)}ZSe(hb,Ab){for(let Qb=0;Qb<Ab.results.length;Qb++)hb.Ly(Ab.results[Qb])}EVi(hb){const Ab=[];for(const Qb of this.eo)Qb.groupType!==hb&&Ab.push(Qb);this.eo.length!==Ab.length&&(this.pWb=Ab)}VDn(hb){let Ab=null,Qb=null,uc=null;for(let Xc=0;Xc<hb.length;Xc++){const xd=hb[Xc];if(xd&&xd.eo&&xd.eo.length)for(const de of xd.eo)if(17===de.groupType||18===de.groupType)Ab=de;else if(0===de.groupType||
16===de.groupType)Qb=de,uc=xd}Ab&&Qb&&0<Qb.results.length&&(17===Ab.groupType&&({xSe:Qb,kTe:Ab}=gk.CommandResultsUtility.sak(Qb,Ab,this.eU.VN()?this.eU.VN().hwl:-.6)),uc.EVi(Qb.groupType))}Gco(){new cn.a;this.s4c(this.eU.Wvi)}lSc(hb,Ab){return this.query.Ig.length>this.eU.VN().FQl&&this.Wtm(hb,Ab)||this.query.Ig.length>this.eU.VN().GQl&&this.Jwm(hb,Ab)?!0:!1}Jwm(hb,Ab){return hb&&hb.length&&Ab&&Ab.length?-1===Ab.toLowerCase().indexOf(hb.toLowerCase())?!1:!0:!1}Wtm(hb,Ab){return hb&&hb.length&&Ab&&
Ab.length?Ab.toLowerCase().startsWith(hb.toLowerCase()):!1}Mhl(hb){const Ab=[];for(const Qb of this.eU.VN().zO?this.fhe:this.eo)hb.contains(Qb.groupType)||Ab.push(Qb);this.eU.VN().zO?this.KPe=Ab:this.pWb=Ab}lAo(hb,Ab){const Qb=[];for(const uc of this.eo){const Xc=uc;if(13!==Xc.groupType||24!==Xc.groupType){const xd=hb[Sk.a[Xc.groupType].toLowerCase()];let de="False";xd<Ab&&(de="True");Xc.displayName=Xc.displayName+" ("+de+": "+xd+")"}Qb.push(Xc)}this.pWb=Qb}s4c(hb,Ab=!1,Qb=null){if(this.eU.VN().zO){if(!Ab)for(this.KPe=
Array(this.eo.length),Ab=0;Ab<this.eo.length;Ab++)this.fhe[Ab]=this.eo[Ab];this.eU.awi.s4c(this.eo,this.fhe,this.query,hb,Qb)}else{for(Qb=new cn.a;this.eo.length;){Ab=this.eo.pop();const uc=Sk.a[Ab.groupType].toLowerCase(),Xc=hb[uc];if(Ak.c(Xc))throw Error.create("GroupId "+uc+" missed from group SortingOrder");Qb.add(new Al.a(Xc,Ab))}Qb.Sc((uc,Xc)=>uc.key<Xc.key?-1:1);for(hb=0;hb<Qb.count;hb++)Ab=Qb.J(hb).value,this.eo.push(Ab)}}Hco(){var hb=!1;let Ab=!1,Qb=!1;for(let Xc=0;Xc<this.eo.length;Xc++){var uc=
this.eo[Xc];const xd=uc.groupType;if(8===xd||15===xd||14===xd){uc=uc.results;for(let de=0;de<uc.length;de++){if(8===xd&&this.lSc(this.query.Ig,uc[de].label)){hb=!0;break}if(15===xd&&this.lSc(this.query.Ig,uc[de].label)){Ab=!0;break}if(14===xd){if(this.lSc(this.query.Ig,uc[de].label)||this.lSc(this.query.Ig,uc[de].description)){Qb=!0;break}const Dd=uc[de].label.split(" ");for(const ee of Dd)if(this.lSc(this.query.Ig,ee)){Qb=!0;break}}}}}hb=this.eU.sSl(hb,Ab,Qb);this.s4c(hb)}PIb(hb,Ab,Qb,uc,Xc,xd){if(Xc===
this.hP){var de=hb.data.Ae;Xc=null;try{Xc=qi.b(de)}catch(Qe){r.TellMeActor.instance.Qe.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Qe);return}if("RankerResults"in Xc&&Xc.RankerResults){this.CBa();var Dd=Xc.RankerResults,ee=new cn.a,vf=new cn.a;de=0;for(var eg of Dd){Dd=eg.ProviderId;var $b=eg.Score;de+=$b;ee.add(new Al.a(Dd,$b))}ee.Sc((Wm,ph)=>Wm.value>ph.value?-1:1);$b=xd?xd.h4h:1E-6;eg={};Dd={};let Qe=0;for(var Hd=0;Hd<ee.count;Hd++){let Wm=parseInt(ee.J(Hd).key),
ph=ee.J(Hd).value/de;1===Wm&&(Dd.answer=Qe++,Dd.entity=Qe++,Dd.definition=Qe++,Dd.wolframanswer=Qe++,ph<$b&&(vf.add(9),vf.add(11),vf.add(10),vf.add(12)),eg.answer=ph,eg.entity=ph,eg.definition=ph,eg.wolframanswer=ph);2===Wm&&(Dd.assistance=Qe++,ph<$b&&vf.add(8),eg.assistance=ph);3===Wm&&(Dd.classifier=Qe++,Dd.serviceclassifier=Qe++,ph<$b&&(vf.add(0),vf.add(17)),eg.classifier=ph,eg.serviceclassifier=ph);4===Wm&&(Dd.people=Qe++,ph<$b&&vf.add(14),eg.people=ph);5===Wm&&(Dd.document=Qe++,ph<$b&&vf.add(15),
eg.document=ph);6===Wm&&(Dd.findindocument=Qe++,ph<$b&&vf.add(2),eg.findindocument=ph);7===Wm&&(Dd.notes=Qe++,ph<$b&&vf.add(20),eg.notes=ph);8===Wm&&(Dd.image=Qe++,ph<$b&&vf.add(19),eg.image=ph)}ee=new cn.a;ee.add("classifier");ee.add("serviceclassifier");ee.add("appsforoffice");ee.add("addin");ee.add("findindocument");ee.add("assistance");ee.add("document");ee.add("people");ee.add("answer");ee.add("wolframanswer");ee.add("definition");ee.add("entity");ee.add("image");ee.add("template");ee.add("officescript");
for(Hd=0;Hd<ee.count;Hd++)ee.J(Hd)in Dd||(Dd[ee.J(Hd)]=Qe++);Dd.learning=Qe++;Dd.insights=Qe++;Dd.actionai=Qe++;Dd.feedback=Qe++;xd&&xd.hli&&this.lAo(eg,$b);xd&&xd.ili&&this.Mhl(vf);vf={};for(var $f in eg)vf[$f]=eg[$f]*de;this.s4c(Dd,!0,vf)}if(xd.NUd&&"Intents"in Xc&&Xc.Intents){$f=Xc.Intents;for(var xi of $f)if(this.dzf(xi)&&"Serplet"===xi.GroupType&&xi.ConfidenceScore>xi.ConfidenceThreshold){$f=!1;Xc=0;if(xd.OUd){de=new m.a("",29);for(vf=0;vf<this.eo.length;vf++)if((ee=this.eo[vf].results)&&0<ee.length){Xc=
vf;de=ee[0];break}2===de.groupType&&($f=!0)}de=new w.a(13);$f&&xd.OUd&&(de=new w.a(13,CommonUIStrings.l_TellMeWebTitle));vf=new m.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Ig,null,0);ee=[];eg=null;eg=z.a.mga()?z.a.zMa(this.query.Ig,1):z.a.Nzb(this.query.Ig);ee.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",eg));eg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Ig);ee.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",
eg));appChrome.api.dispatch(ee);de.Ly(vf);vf=[];if($f&&xd.OUd)for(vf.push(this.eo[Xc]),vf.push(de),$f=Xc+1;$f<this.eo.length;$f++)(Xc=this.eo[$f].results)&&0<Xc.length&&vf.push(this.eo[$f]);else for(vf.push(de),$f=0;$f<this.eo.length;$f++)(Xc=this.eo[$f].results)&&0<Xc.length&&vf.push(this.eo[$f]);this.pWb=vf}}if(xd.uSc&&!xd.zO){xi=$f=-1;for(Xc=0;Xc<this.eo.length;Xc++)switch(this.eo[Xc].groupType){case 23:$f=Xc;break;case 0:case 17:case 2:-1===xi&&(xi=Xc)}if(-1!==$f){xi=-1===xi?0:$f>xi?xi+1:xi;$f=
this.eo[$f];Xc=Array(this.eo.length);de=0;for(vf=0;vf<Xc.length;vf++)vf===xi?Xc[vf]=$f:(23===this.eo[de].groupType&&de++,Xc[vf]=this.eo[de],de++);this.pWb=Xc}}uc.resultsUpdated(this);uc=r.TellMeActor.instance.Qe;uc.d8(Ab.length,"RankerInference",hb.data.jf.toString(),Math.round(window.performance.now()-Qb),ne.a.phj,!0,Vc.a.tOa);this.q9b&&uc&&(hb=this.query.Ilb,Ab=uc.Xbd,xd.cVd&&hb>Ab&&!xd.zO&&(uc.MCf(this.query.Ig),uc.S1f(hb)))}}dzf(hb){if("GroupType"in hb&&hb.GroupType&&"ConfidenceScore"in hb&&"ConfidenceThreshold"in
hb)return!0;r.TellMeActor.instance.Qe.onError("IsValidIntentGroup","Invalid intents found");return!1}DIb(hb,Ab,Qb,uc,Xc){uc===this.hP&&(this.CBa(),r.TellMeActor.instance.Qe.d8(Ab.length,"RankerInference",hb.data.jf.toString(),Math.round(window.performance.now()-Qb),ne.a.phj,!1,Vc.a.tOa));Xc.resultsUpdated(this)}CBa(){-1!==this.Y0&&(window.clearTimeout(this.Y0),this.Y0=-1)}Ico(hb){let Ab;Ab=this.eU.VN().zO?r.TellMeActor.instance.Qe.Smf(this.fhe,this.query.Ig):r.TellMeActor.instance.Qe.Smf(this.eo,
this.query.Ig);var Qb=this.eU.VN().g4h;""!==Qb&&(Qb="_"+Qb);let uc="";this.eU.VN().WTd&&(uc="RankerInference"+Qb+",");this.eU.VN().NUd&&(uc+="SerpletClassifier");","===uc.charAt(uc.length-1)&&(uc=uc.substring(0,uc.length-1));Qb=r.TellMeActor.instance.Qe.V5h(uc);const Xc=this.hP=Wf.a.create().toString();Qb["Client-Request-Id"]=Xc;const xd=window.performance.now(),de=this.eU.VN()?this.eU.VN().i4h:600;this.CBa();this.Y0=window.setTimeout(()=>{if(Xc===this.hP){this.hP="";this.Y0=-1;hb.resultsUpdated(this);
const Dd={};Dd[a.a.provider]="Ranker";Dd[a.a.eKb]=this.query.Ilb;r.TellMeActor.instance.Qe.hA(k.a.timedOut,de,Dd)}},de);this.rg.qj(r.TellMeActor.instance.Qe.W5h(),2,Ab,Qb,!1,0,Dd=>{this.PIb(Dd,this.query.Ig,xd,hb,Xc,this.eU.VN())},Dd=>{this.DIb(Dd,this.query.Ig,xd,Xc,hb)},null,null,!1,4E3,6E3)}Lpo(){var hb=0,Ab=new cn.a,Qb=this.eU.Uvi,uc=this.eU.Vvi;for(var Xc=0;Xc<this.eo.length;Xc++){var xd=this.eo[Xc],de=Sk.a[xd.groupType].toLowerCase(),Dd=Qb[de];hb+=xd.results.length;xd.results.length>Dd&&(de=
uc[de],Ak.c(de)||Ab.add(new Al.a(de,xd)))}uc=!this.query||""===this.query.Ig.trim();Xc=hb-(uc?this.uEf:this.rEf);if(!(0>=Xc)){uc=window.performance.now();hb=hb.toString()+" total,"+Xc.toString()+" to remove.";if(0<Ab.count)for(Ab.Sc((ee,vf)=>ee.key>vf.key?-1:1),xd=0;xd<Ab.count&&0<Xc;xd++){de=Ab.J(xd).value;Dd=Sk.a[de.groupType].toLowerCase();let ee=de.results.length-Qb[Dd];ee>Xc&&(ee=Xc);0<ee&&(de.wXf(ee),hb+=Dd+": "+ee.toString()+" results removed.",Xc-=ee)}if(0<Xc){hb+=Xc.toString()+" results left after trimming.";
Ab=new cn.a;Qb=this.eU.Zvi;for(xd=0;xd<this.eo.length;xd++)de=this.eo[xd],Dd=Qb[Sk.a[de.groupType].toLowerCase()],Ak.c(Dd)||Ab.add(new Al.a(Dd,de));Ab.Sc((ee,vf)=>ee.key<vf.key?-1:1);for(Qb=0;0<Xc;)xd=Ab.J(Qb++).value,Xc>=xd.results.length?(Array.remove(this.eo,xd),hb+=Sk.a[xd.groupType]+": "+xd.results.length.toString()+" results force removed.",Xc-=xd.results.length):(xd.wXf(Xc),hb+=Sk.a[xd.groupType]+": "+Xc.toString()+" results force removed.",Xc=0)}r.TellMeActor.instance.Qe&&(Ab={},Ab[a.a.message]=
hb,r.TellMeActor.instance.Qe.hA("ShowOptimal",window.performance.now()-uc,Ab))}}}Object(l.a)(Qf,"CombineResultsUpdatedEventArgs",null,[1075]);var Tk=c(1584);class ff{constructor(hb,Ab,Qb,uc=!1,Xc=""){this.WGe=this.wJe=!1;this.gv=hb;this.Bvb=[];this.w1g=Ab.length;this.oc=r.TellMeActor.instance.VN();this.eid=uc;this.vka=Xc;this.DXb={};for(hb=0;hb<Ab.length;++hb)this.DXb[hb.toString()]=Qb?0:Ab[hb].sT()}J0n(hb,Ab){Ab&&Ab.query&&Ab.query.Ilb<r.TellMeActor.instance.Qra||(this.Bvb[hb]=Ab,this.WGe?this.wJe=
!0:(!this.oc||3!==this.oc.Su||3!==this.DXb[hb.toString()]||this.CFh())&&this.xRd())}Jfn(){this.WGe=!0}Ato(){this.WGe=!1;this.wJe&&(this.wJe=!1,this.xRd())}CFh(){if(this.Bvb.length<this.w1g)return!1;for(let hb=0;hb<this.w1g;++hb)if(!this.Bvb[hb])return!1;return!0}xRd(){var hb=this.CFh();const Ab=window.performance.now(),Qb=new Qf(r.TellMeActor.instance.xMg);Qb.VDn(this.Bvb);for(var uc=0;uc<this.Bvb.length;++uc){var Xc=this.Bvb[uc];if(Xc&&Xc.eo&&Xc.eo.length&&(Qb.query=Xc.query,Xc.attributes&&0<Xc.attributes.length&&
(Qb.attributes=Xc.attributes),Xc&&Xc.eo&&(hb||this.lEk(uc,this.Bvb))))for(const xd of Xc.eo)Qb.Lv(xd)}Qb.eo&&Qb.eo.length&&(Qb.q9b=hb,this.oc&&this.oc.kge&&Qb.Lpo(),Tk.a.Rni()&&(this.oc&&this.oc.mvm&&Qb.query.Ig&&0<Qb.query.Ig.length?Qb.Hco():Qb.Gco()),Tk.a.Rni()&&this.oc&&(this.oc.WTd||this.oc.NUd)&&this.eid&&Qb.query.Ig&&0<Qb.query.Ig.length&&Qb.q9b&&this.vka!==e.a.contextMenu?(3===this.oc.Su&&hb||this.gv.resultsUpdated(Qb),Qb.Ico(this.gv)):this.gv.resultsUpdated(Qb),hb=r.TellMeActor.instance.Qe,
Qb.q9b&&hb&&(uc=Qb.query.Ilb,Xc=hb.Xbd,Qb.query.Ig&&0<Qb.query.Ig.length&&this.eid&&this.oc.cVd&&this.vka!==e.a.contextMenu&&uc>Xc&&!this.oc.WTd&&!this.oc.zO&&(hb.MCf(Qb.query.Ig),hb.S1f(uc)),hb.hA(k.a.cMn,window.performance.now()-Ab)))}lEk(hb,Ab){if(!(this.DXb&&hb.toString()in this.DXb)||Ab.length<=hb||!Ab[hb])return!1;if(!Ab[hb].eo.length)return!0;const Qb=this.DXb[hb.toString()];if(0===Qb)return!0;const uc=this.DXb;for(let xd in uc){var Xc=uc[xd];const de=Number.parseInvariant(xd);if(de!==hb&&
Xc===Qb&&!(Ab.length>de&&Ab[de]))return!1}return!0}}Object(l.a)(ff,"ResultsAggregator",null,[]);var vj=c(1708);class jd{constructor(){this.Oic=this.Pic=this.Nic=this.logCount=this.logRank=this.invertedRank=0}bak(hb,Ab){switch(hb){case 1:this.invertedRank=Ab;break;case 3:this.logRank=Ab;break;case 2:this.logCount=Ab;break;case 5:this.Nic=Ab;break;case 4:this.Pic=Ab;break;case 6:this.Oic=Ab}}}Object(l.a)(jd,"CommandFeatures",null,[]);class Uk{constructor(hb){this.WJg=0;this.YUj=hb;this.jHj={}}get modelId(){return this.YUj}get featureIntercept(){return this.WJg}get HDc(){return this.jHj}$9j(hb,
Ab,Qb){0===Ab?this.WJg=Qb:(this.HDc[hb]||(this.HDc[hb]=new jd),this.HDc[hb].bak(Ab,Qb))}}Object(l.a)(Uk,"CoefficientsModel",null,[]);const If=(hb,Ab)=>Math.pow(10,-Ab/(60*Math.LN10/Math.LN2*hb));class zf{constructor(hb,Ab){this.gj=1;this.Qdd=new jd;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=hb?1/hb:0;this.features.logRank=2/Math.pow(2,hb);this.features.Nic=If(10,Ab);this.features.Pic=If(2,Ab);this.features.Oic=If(1,Ab)}get count(){return this.gj}get features(){return this.Qdd}rci(){this.gj=
this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}$zo(hb){const Ab=2/Math.pow(2,hb);this.features.invertedRank=Math.max(this.features.invertedRank,hb?1/hb:0);this.features.logRank=Math.max(this.features.logRank,Ab)}yBo(hb){const Ab=If(10,hb),Qb=If(2,hb);hb=If(1,hb);this.features.Nic=Math.max(this.features.Nic,Ab);this.features.Pic=Math.max(this.features.Pic,Qb);this.features.Oic=Math.max(this.features.Oic,hb)}}Object(l.a)(zf,"CommandModel",null,[]);class Wn{constructor(hb){this.dnc=
null;if(!hb&&r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("PredictionEngine","IModelAdapter can't be null");this.XUb=hb;this.hkd=this.UBf()}UBf(){const hb=this.XUb.fKl(),Ab=this.XUb.wkf();if(void 0===hb||null===hb||void 0===Ab||null===Ab)return!1;try{window.performance.now();this.dnc={};for(let Qb=0;Qb<hb.length;Qb++){const uc=hb[Qb],Xc=Ab[uc[0].toString()].trim(),xd=uc[1],de=0!==xd?Ab[uc[2].toString()].trim():"",Dd=uc[3];Xc in this.dnc||(this.dnc[Xc]=new Uk(Xc));this.dnc[Xc].$9j(de,
xd,Dd)}}catch(Qb){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("LoadModelData","Error Loading Suggestions Model: "+Qb);return!1}return!0}Tpl(){const hb=this.XUb.IGl(),Ab={};if(!hb)return Ab;let Qb=1;for(let uc=0;uc<hb.length;uc++){const Xc=hb[uc];Xc.Id in Ab?(Ab[Xc.Id].rci(),Ab[Xc.Id].$zo(Qb),Ab[Xc.Id].yBo(Xc.TimeElapsedSinceClick)):Ab[Xc.Id]=new zf(Qb,Xc.TimeElapsedSinceClick);Qb++}return Ab}Mwf(){this.hkd||(this.hkd=this.UBf());return this.hkd}oPl(){let hb=[];if(!this.hkd){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("GetPredictedCommands",
"IModelAdapter returned no data");return hb}const Ab=this.Tpl(),Qb=this.dnc;for(let Xc in Qb){const xd=Qb[Xc],de=xd.modelId;let Dd=0;for(let ee in Ab){var uc=ee;const vf=Ab[ee].features;(uc=uc in xd.HDc?xd.HDc[uc]:null)&&(Dd+=vf.invertedRank*uc.invertedRank+vf.logRank*uc.logRank+vf.logCount*uc.logCount+vf.Nic*uc.Nic+vf.Pic*uc.Pic+vf.Oic*uc.Oic)}Dd+=xd.featureIntercept;hb.push(new wi.a(de,Dd))}hb.sort((Xc,xd)=>Xc.score<xd.score?1:Xc.score>xd.score?-1:0);0<hb.length-10&&(hb=hb.slice(0,10));return hb}}
Object(l.a)(Wn,"PredictionEngine",null,[]);class Kh{constructor(){this.C4g={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}aJd(hb,
Ab){return Ab&&"word"===Ab.application.toLowerCase()&&hb in this.C4g?this.C4g[hb]:[]}}Object(l.a)(Kh,"SuggestionResultsUtility",null,[]);class ti{constructor(hb,Ab,Qb){this.oc=Ab;this.nuc=new Wn(hb);this.G1=Qb;this.t7g=new Kh}uK(){return"Suggestion"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:2}qH(hb,Ab,Qb,uc=e.a.tellMe,Xc=null){Qb=new v.a(hb);r.TellMeActor.instance.S7c=!1;if((!Xc||Array.contains(Xc,16))&&z.a.rQ(hb)){if(!this.nuc.Mwf()){if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.HUd()&&0<this.t7g.aJd(r.TellMeActor.instance.sCd,this.oc).length){const de=this.t7g.aJd(r.TellMeActor.instance.sCd,this.oc);Xc=[];for(var xd of de)this.oc.Sbe&&"Find"===xd||Xc.push(new wi.a(xd,0));r.TellMeActor.instance.S7c=!0}else Xc=this.nuc.oPl();gk.CommandResultsUtility.MXd(Xc,!0,"Recommended","LRE");xd=[];for(const de of Xc)this.G1&&this.G1.s2e(de.commandId)||
xd.push(de);hb=gk.CommandResultsUtility.iMd(hb,xd,this.oc,null,null,null,16,1);0<hb.results.length&&uc!==e.a.contextMenu&&(hb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<hb.results.length&&Qb.Lv(hb)}Ab.resultsUpdated(Qb)}HUd(){return!!this.oc&&(this.oc.HUd||this.oc.Azm)}}Object(l.a)(ti,"SuggestionResultsProvider",null,[1099]);class jg{IGl(){return r.TellMeActor.instance.qpe}fKl(){return window.TellMeSuggestionModel}wkf(){return window.CoefficientModelIdMap}}Object(l.a)(jg,"SuggestionsModelAdapter",
null,[1124]);var ej=c(1722),dl=c(1675);c.d(L,"AggregatorResultsProvider",function(){return ui});class ui{constructor(hb=!1){this.dWb={};this.dWb[e.a.tellMe]=[];this.dWb[e.a.contextMenu]=[];this.eid=hb}Rpi(hb,Ab,Qb,uc,Xc=null){let xd;var de=!1;switch(uc){case e.a.contextMenu:xd=this.dWb[e.a.contextMenu];de=!0;break;default:xd=this.dWb[e.a.tellMe]}Ab=new ff(Ab,xd,de,this.eid,uc);Ab.Jfn();for(let Dd=0;Dd<xd.length;++Dd){const ee=window.performance.now(),vf=new I(Ab,Dd);(de=r.TellMeActor.instance.VN())&&
de.ktk?window.setTimeout(()=>{xd[Dd].qH(hb,vf,Qb,uc,Xc);if(r.TellMeActor.instance.Qe){const eg={};eg[a.a.provider]=xd[Dd].uK();eg[a.a.eKb]=hb.Ilb;r.TellMeActor.instance.Qe.hA(k.a.qH,window.performance.now()-ee,eg)}},0):(xd[Dd].qH(hb,vf,Qb,uc,Xc),r.TellMeActor.instance.Qe&&(de={},de[a.a.provider]=xd[Dd].uK(),de[a.a.eKb]=hb.Ilb,r.TellMeActor.instance.Qe.hA(k.a.qH,window.performance.now()-ee,de)))}Ab.Ato()}uK(){return"Aggregator"}sT(){return 0}qH(hb,Ab,Qb=!1,uc=e.a.tellMe,Xc=null){if(r.TellMeActor.instance.jVm)this.Rpi(hb,
Ab,Qb,uc,Xc);else{const xd=window.performance.now();r.TellMeActor.instance.UFo.then(()=>{r.TellMeActor.instance.Qe&&r.TellMeActor.instance.Qe.hA(k.a.kVm,window.performance.now()-xd);this.Rpi(hb,Ab,Qb,uc,Xc);return!0})}}kF(hb,Ab){this.dWb[Ab].push(hb)}Nak(hb){switch(hb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ab=this.dWb[e.a.tellMe];for(const Qb of Ab)if("FindInDocument"===Qb.uK()){Qb.OZn(hb);break}}}static createInstance(hb,Ab,Qb,uc){var Xc=
uc&&z.a.y4f(Ab),xd=Xc&&Ab.bOf;const de=Ab.Qyf&&!z.a.YFb(),Dd=Ab.$wf,ee=new ui(Xc);if(Ab.Q7n){var vf=new Rk(Ab);ee.kF(vf,e.a.tellMe)}vf=Ab.nq?pf.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):pf.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const eg=!vf&&pf.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");ee.kF(new Gh.a(hb,Ab.Cro,eg,!1),e.a.tellMe);vf&&ee.kF(new ti(new jg,Ab,hb),e.a.tellMe);hb=pf.AFrameworkApplication.ta.Pb.Eoi?new Zi(Ab,new si):new wn(Ab,
Qb);ee.kF(hb,e.a.contextMenu);(Xc&&Ab.cOf||xd)&&ee.kF(ej.a.uBh(Ab,!0),e.a.tellMe);ee.kF(hb,e.a.tellMe);!Ab.FNh||"Word"===Ab.application&&Ab.RGd||ee.kF(new bc(Ab),e.a.tellMe);Ab.Xxb&&(xd=new K(Ab),ee.kF(xd,e.a.tellMe),ee.kF(xd,e.a.contextMenu));!Ab.ayb||Ab.y3c||Ab.x3c||ee.kF(new F.a(Ab),e.a.tellMe);uc&&(Ab.XZ||z.a.mga())&&(xd=new Me(Ab),ee.kF(xd,e.a.tellMe),ee.kF(xd,e.a.contextMenu));Xc&&ee.kF(ej.a.uBh(Ab,!1),e.a.tellMe);uc&&!Ab.r8f&&z.a.x4f(Ab)&&(ee.kF(new vj.a(Ab),e.a.tellMe),Ab.Hfj&&ee.kF(new vj.a(Ab),
e.a.contextMenu));de&&ee.kF(new Gl(Ab),e.a.tellMe);(Ab.Tgc||Ab.zO)&&ee.kF(new oe.a(Ab),e.a.tellMe);Ab.uSc&&ee.kF(new dl.a(Ab),e.a.tellMe);Ab.IRd&&(Xc=new G(Ab),ee.kF(Xc,e.a.tellMe),ee.kF(Xc,e.a.contextMenu));uc&&Ab.MRd&&ee.kF(new H.AddinResultsProvider(Ab),e.a.tellMe);Dd&&"Excel"===Ab.application&&ee.kF(new lk(Ab),e.a.tellMe);return ee}}Object(l.a)(ui,"AggregatorResultsProvider",null,[1099])},1701:function(D,L,c){D=c(0);var l=c(17),e=c(7),a=c(152),k=c(228),m=c(412),w=c(61),v=c(68),r=c(934),z=c(861),
A=c(554);c(496);var G=c(1665),H=c(1666),I=c(1662),K=c(1664),F=c(1663),J=c(933),N=c(860);class O{constructor(la,na,Ca){this.opl=la;this.zqk=na;this.nCk=Ca}}Object(D.a)(O,"BacktraceAndMakeUpdateHintsInput",null,[]);var M=c(1506),T;(function(la){la[la.EOP=0]="EOP";la[la.character=1]="character";la[la.embeddedMarker=2]="embeddedMarker"})(T||(T={}));Object(D.b)("LCSBlockType",T);class R{toString(){return String.format("[Type: {0}]",T[this.type])}}Object(D.a)(R,"ALCSBlock",null,[]);class W extends R{constructor(la,
na){super();this.yoe=na;this.FGe=la}get type(){return 1}get character(){return this.yoe}get zv(){return this.FGe}bA(la){return 1===la.type&&M.a.tjh(la.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(D.a)(W,"CharacterLCSBlock",R,[]);class V extends R{constructor(la,na,Ca){super();this.FGe=la;this.dRe=na;this.rtc=Ca}get type(){return 0}get Pc(){return this.dRe}get length(){return this.rtc}get zv(){return this.FGe}bA(la){return 0!==
la.type?!1:la.zv===this.zv&&la.Pc===this.Pc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.zv.toString(),this.Pc,this.length)}}Object(D.a)(V,"EOPLCSBlock",R,[]);class ba extends W{constructor(la,na,Ca){super(la,"\ufffc");this.nUj=na;this.Fed=Ca}get type(){return 2}get fm(){return this.nUj}get Hj(){return this.Fed}bA(la){return 2!==la.type?!1:la.fm===this.fm&&this.Hj.equals(la.Hj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",
super.toString(),this.fm,this.Hj)}}Object(D.a)(ba,"EmbeddedMarkerLCSBlock",W,[]);class ha{constructor(la,na){this.x=la;this.y=na}equals(la){return la.x===this.x&&la.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(ha,"IntPair",null,[893]);var ca=c(1541),ia=c(1525),ra=c(1542),da=c(1661);c.d(L,"a",function(){return za});class za{constructor(la,na){this.Qg=la;this.ae=na}FBh(la,na,Ca,Na,Ta,Fa,qa){return this.$Xk(la,na,Ca,Na,Ta,Fa,qa)}$Xk(la,na,Ca,Na,Ta,Fa,qa){let ja;ja=null;({returnValue:la}=
this.LKd(la,na));if(!la)return a.a.instance.Sa(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.ae.logger.dU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ja};({returnValue:Ca}=this.LKd(Ca,Na));if(!Ca)return a.a.instance.Sa(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.ae.logger.dU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ja};this.ae.logger.dU("GetLCSBlocksFromObject");ja=this.ZXk(la,Ca,Ta,Fa,qa);return ja?{returnValue:!0,updateHints:ja}:
(a.a.instance.Sa(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ja})}uNh(la,na,Ca,Na){({returnValue:la}=this.LKd(la,na));if(!la)return-1;({returnValue:Ca}=this.LKd(Ca,Na));if(!Ca)return-1;({C6e:Ca}=this.yNh(la,Ca));return Ca}LKd(la,na){let Ca;const Na=new k.a;Ca=new k.a;if(!la.length)return a.a.instance.Sa(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.ae.logger.Vg(Object.assign(new ca.a,{tj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,
dbf:Ca};for(let qa=0;qa<la.length;qa++)if(this.ae.runtime.sG("GetLCSBlocksFromObject: paraObjs#"+qa),393230===la.J(qa).Rc){const ja=this.Qg.getPropertyString(la.J(qa),l.a.Co),X=this.Qg.getPropertyUint32(la.J(qa),e.a.Pc);if(null==X)return a.a.instance.Sa(594124835,1,2,"Abandoning LCS due to missing WordId"),this.ae.logger.Vg(Object.assign(new ca.a,{tj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,dbf:Ca};let ua=this.Qg.getPropertyUint32s(la.J(qa),l.a.vm);ua=ia.a.n7i(ua,ja.length);const Ha=
this.Qg.getPropertyObjectIds(la.J(qa),l.a.An);let Ea;for(Ea=0;Ea<ua.length-1;Ea++){var Ta=na(Ha.ig(Ea)),Fa=void 0;Fa=Ta?(Fa=this.Qg.getPropertyBool(Ta,l.a.Y8))?Fa:!1:!1;if(Fa)Na.add(this.KSk(la.J(qa).id,Ta));else for(Ta=ua.ig(Ea);Ta<ua.ig(Ea+1);Ta++)Na.add(new W(la.J(qa).id,M.a.charAt(ja,Ta)))}Na.add(new V(la.J(qa).id,X,ua.J(Ea)));Ca.add(Na.length-1)}else return a.a.instance.Sa(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",la.J(qa).Rc),this.ae.logger.Vg(Object.assign(new ca.a,
{tj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,dbf:Ca};this.ae.runtime.sG("LCS: GetLCSBlocks for base");return{returnValue:Na,dbf:Ca}}KSk(la,na){const Ca=null==this.Qg.getPropertyInt32(na,e.a.Qq)?0:this.Qg.getPropertyInt32(na,e.a.Qq);return new ba(la,Ca,na.id)}ZXk(la,na,Ca,Na,Ta){Na=({C6e:Ca}=this.yNh(la,na,Ca,Na,Ta)).returnValue;this.ae.logger.dU("FindFurthestPaths");la=new O(Na,la,na);la=new da.a(this.pqk(la,Ca),1);this.ae.logger.dU("BacktraceAndMakeUpdateHints");return la}yNh(la,
na,Ca=-1,Na=-1,Ta=-1){let Fa;if(-1===Ca||-1===Na||-1===Ta)Ta=Na=Ca=-1;Fa=-1;const qa=new m.a;qa.Z(new ha(-1,1),new ha(0,-1));if(-1!==Ca){qa.Z(new ha(0,0),new ha(Ca,Ca));var ja=1}else ja=0,Na=la.length,Ta=na.length;for(Ca=0;ja<=la.length+na.length;ja++){let X=!1;for(let ua=-ja;ua<=ja;ua+=2){let Ha,Ea;ua===-ja?(Ha=qa.J(new ha(ja-1,ua+1)).x,Ea=qa.J(new ha(ja-1,ua+1)).y+1):ua===ja?(Ha=qa.J(new ha(ja-1,ua-1)).x+1,Ea=qa.J(new ha(ja-1,ua-1)).y):qa.J(new ha(ja-1,ua-1)).x>=qa.J(new ha(ja-1,ua+1)).x?(Ha=qa.J(new ha(ja-
1,ua-1)).x+1,Ea=qa.J(new ha(ja-1,ua-1)).y):(Ha=qa.J(new ha(ja-1,ua+1)).x,Ea=qa.J(new ha(ja-1,ua+1)).y+1);for(;Ha<Na&&Ea<Ta&&la.J(Ha).bA(na.J(Ea));)Ha++,Ea++;qa.Z(new ha(ja,ua),new ha(Ha,Ea));if(Ha===Na&&Ea===Ta){X=!0;Fa=ja;Ca=ua;break}}if(X)break;this.ae.runtime.sG("LCS FindFurthestPaths")}if(Ca!==Na-Ta)return{returnValue:null,C6e:Fa};qa.Z(new ha(Fa,Ca),new ha(Na+1,Ta+1));a.a.instance.Sa(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",la.length,
na.length,Fa);return{returnValue:qa,C6e:Fa}}pqk(la,na){const Ca=la.opl,Na=la.zqk;la=la.nCk;const Ta=new k.a;let Fa=Na.length,qa=la.length;for(;0<Fa||0<qa;){var ja=Fa-1,X=qa-1;if(this.Ifn(Ca,na,Fa,qa)){ja=la.J(X);if(1===ja.type||2===ja.type)this.lhm(Ta,Fa,ja);else if(0===ja.type)this.Mgm(Ta,Fa,ja);else return a.a.instance.Sa(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ja.type),this.ae.logger.Vg(Object.assign(new ra.a,{tj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),
null;qa--;na--}else if(this.Hfn(Ca,na,Fa,qa)){X=Na.J(ja);if(1===X.type||2===X.type)this.i2k(Ta,ja,X);else if(0===X.type)this.P1k(Ta,ja,X);else return a.a.instance.Sa(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",X.type),this.ae.logger.Vg(Object.assign(new ra.a,{tj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Fa--;na--}else if(Fa&&qa&&Na.J(ja).bA(la.J(X)))Fa--,qa--;else return a.a.instance.Sa(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.ae.logger.Vg(Object.assign(new ra.a,
{tj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.ae.runtime.sG("LCS: CreateUpdateHintsFromLCSBlocks");return Ta}Hfn(la,na,Ca,Na){na=new ha(na-1,Ca-Na-1);return la.ub(na)&&la.J(na).x===Ca-1&&la.J(na).y===Na}Ifn(la,na,Ca,Na){na=new ha(na-1,Ca-Na+1);return la.ub(na)&&la.J(na).x===Ca&&la.J(na).y===Na-1}addPara(la,na,Ca,Na,Ta,Fa){var qa=null;Ca.block?qa=Ca.block.zv:0<=Ta&&0===la.J(Ta).type&&(qa=la.J(Ta).zv);Ca=la=Fa.zv;if(Na.xZb.contains(la))for(Ta=0,la=w.a.Gf("{00000000-0000-0000-0000-000000000000}{"+
Ta+"}");Na.xZb.contains(la);)Ta++,la=w.a.Gf("{00000000-0000-0000-0000-000000000000}{"+Ta+"}");qa=new r.AddParagraphUpdateHint(la,Fa.Pc,qa);qa.ubn=Ca;na.updateHints.add(qa);Na.zv=la;Na.Pc=Fa.Pc;Na.xZb.add(la);Na.EQa=0}Mgm(la,na,Ca){Ca=new I.a(Ca.zv,Ca.Pc);let Na=!1;if(0<la.length&&11===la.ig(la.length-1).type){const Ta=la.ig(la.length-1);Ta.cp===na&&(Na=!0,Ta.TZ.add(Ca))}Na||(na=new F.a(na),na.TZ.add(Ca),la.add(na))}splitPara(la,na,Ca,Na,Ta,Fa,qa,ja){la=this.cjl(Fa.zv,la,na,Na);if(!la)return!1;na=
new N.a(Fa.zv,Fa.Pc,Fa.EQa,la.zv,la.Pc,qa.zv,qa.Pc);Ca.updateHints.add(na);Fa.Pc=la.Pc;la!==ja?(Ta.block=la,Ta.CRo=Fa.EQa,Ta=new r.AddParagraphUpdateHint(ja.zv,ja.Pc,la.zv),Ca.updateHints.add(Ta),Fa.zv=ja.zv,Fa.Pc=ja.Pc,Fa.xZb.add(ja.zv),Fa.EQa=0):Fa.xZb.add(qa.zv);return!0}lhm(la,na,Ca){var Na=!1;if(0<la.length&&11===la.ig(la.length-1).type){const Ta=la.ig(la.length-1);Ta.cp===na&&((Na=Object(v.a)(K.a,Ta.TZ.J(Ta.TZ.length-1)))?Na.text=Ca.character.toString()+Na.text:Ta.TZ.add(new K.a(Ca.zv,Ca.character.toString())),
Na=!0)}Na||(na=new F.a(na),na.TZ.add(new K.a(Ca.zv,Ca.character.toString())),la.add(na))}deletePara(la,na,Ca,Na,Ta,Fa){let qa=-1;for(let ja=0;ja<Ta.length;ja++)if(Ta.J(ja)===Fa){0<ja&&(qa=ja-1);break}Fa=null;0<=qa&&(Fa=Na.J(Ta.J(qa)));Na=new z.a(Ca.zv,Ca.Pc,Fa?Fa.zv:null);la.updateHints.add(Na);Fa&&na.zv.equals(Ca.zv)&&(na.EQa=Fa.length,na.zv=Fa.zv,na.Pc=Fa.Pc);na.xZb.remove(Ca.zv)}P1k(la,na,Ca){na=new G.a(na,Ca.zv,Ca.Pc);la.add(na)}mergePara(la,na,Ca){la.updateHints.add(new J.MergeParagraphUpdateHint(Ca.zv,
Ca.Pc,Ca.length,na.zv,na.Pc,Ca.zv,na.Pc));na.EQa=Ca.length;na.xZb.remove(na.zv);na.zv=Ca.zv}deleteText(la,na,Ca){let Na=!1;if(0<la.updateHints.length&&2===la.updateHints.ig(la.updateHints.length-1).type){const Ta=la.updateHints.ig(la.updateHints.length-1);Ta.Bg.equals(na.zv)&&Ta.cp===na.EQa&&(Ta.cp=na.EQa-1,Ta.text=Ca.character.toString()+Ta.text,Na=!0)}Na||la.updateHints.add(new A.DeleteTextUpdateHint(na.zv,na.EQa-1,Ca.character.toString()));--na.EQa}i2k(la,na,Ca){let Na=!1;if(0<la.length&&8===la.ig(la.length-
1).type){const Ta=la.ig(la.length-1);Ta.cp===na+1&&(Ta.text=Ca.character.toString()+Ta.text,--Ta.cp,Na=!0)}Na||la.add(new H.a(na,Ca.character.toString()))}cjl(la,na,Ca,Na){for(;0<=Na;){var Ta=na.J(Ca.J(Na));if(0!==Ta.type)break;if(Ta.zv.equals(la))return Ta;Na--}return null}}Object(D.a)(za,"LCSUpdateHintGenerator",null,[])},1707:function(D,L,c){c.r(L);D=c(0);var l=c(17),e=c(7),a=c(152),k=c(412),m=c(621),w=c(228),v=c(61),r=c(52),z=c(1491);class A extends z.a{constructor(){super()}get ifa(){return"ChildNodeListMerge"}}
Object(D.a)(A,"ChildNodeListMergeFailureDetail",z.a,[]);class G{wob(ha,ca,ia){return ca.Ty(ha,ia.J(ha))}dlj(ha,ca,ia,ra){let da;return({value:da}=ca.Gc(ha)).returnValue||({value:da}=ia.Gc(ha)).returnValue?da:ra.J(ha)}}Object(D.a)(G,"ChildNodeListMergeUtils",null,[1996]);var H=c(1519),I=c(1721),K=c(1582);class F{constructor(ha,ca){this.classId=ha;this.cso=ca}}Object(D.a)(F,"NodeChildrenTransformation",null,[]);var J=c(797),N=c(1511);class O{constructor(ha,ca,ia){this.dE=ha;this.Ppa=ia;this.R6=ca}v5d(ha){let ca,
ia;return({fPi:ca}=this.jlj(this.Ppa,ha)).returnValue&&ca.qX||({fPi:ia}=this.jlj(this.R6,ha)).returnValue&&ia.qX}jlj(ha,ca){let ia;return{returnValue:({value:ia}=(new N.a(this.dE,ha)).Joa.Gc(J.a.zb(ca))).returnValue,fPi:ia}}}Object(D.a)(O,"NodeTriplet",null,[]);var M=c(1660);class T{constructor(ha,ca,ia){this.ae=ha;this.Qg=ca;this.gW=ia;this.o7g=!0}get Ip(){return this.ae}get Yd(){return this.Qg}get iya(){return this.gW}get success(){return this.o7g}BOl(){a.a.instance.Sa(4220310,1,5,"Evaluating ParentObjects");
const ha=new k.a;this.RYe(ha,ca=>this.Ip.runtime.nk.J(ca));this.RYe(ha,ca=>this.iya.wob(ca,this.Ip.runtime.uu,this.Ip.runtime.nk));this.RYe(ha,ca=>this.iya.wob(ca,this.Ip.runtime.vq,this.Ip.runtime.nk));return ha}RYe(ha,ca){const ia=ca(c(1707).ChildNodeListMerge.h3d);this.Yd.getPropertyObjectIds(ia,l.a.gf).forEach(ra=>{this.Yd.getPropertyObjectIds(ca(ra),l.a.gf).forEach(da=>{ha.ub(da)&&!ra.equals(ha.J(da))&&(this.o7g=!1,a.a.instance.Sa(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
da,ra,ha.J(da)));ha.Z(da,ra);return!0});return!0})}}Object(D.a)(T,"OutlineGroupParentFinder",null,[]);var R=c(1492),W=c(1543),V=c(1583);c.d(L,"ChildNodeListMerge",function(){return ba});class ba{constructor(ha,ca=null,ia=null,ra=null,da=null){this.Qg=ha;this.Udn=ca||I.a.Flj;this.t_d=ia||this.DLl();this.iya=ra||new G;this.Oxi=da||this.KJl()}get Yd(){return this.Qg}DLl(){return[new F(393227,Object(r.a)(this,this.Hcn,"pageContentNodeThreewayChildMerge")),new F(1073872968,Object(r.a)(this,this.PJo,"wordSectionNodeThreewayChildMerge")),
new F(393241,Object(r.a)(this,this.Y2d,"outlineElementContainerThreewayChildMerge")),new F(393252,Object(r.a)(this,this.ajo,"tableCellThreewayChildMergev2")),new F(1074135125,Object(r.a)(this,this.Y2d,"outlineElementContainerThreewayChildMerge")),new F(1074135123,Object(r.a)(this,this.Y2d,"outlineElementContainerThreewayChildMerge")),new F(1074135127,Object(r.a)(this,this.Y2d,"outlineElementContainerThreewayChildMerge"))]}KJl(){return[Object(r.a)(this,this.Yjn,"prepareObjectGroupings"),Object(r.a)(this,
this.l3l,"handleInterOutlineGroupMerge"),Object(r.a)(this,this.lgn,"performThreewayChildMerge")]}uTm(ha){let ca=0;for(;ca<this.Oxi.length;ca++)if(!(0,this.Oxi[ca])(ha))return a.a.instance.Sa(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",ca),ha.logger.UXd("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ca),!1;return!0}Yjn(ha){const ca=new k.a,ia=new k.a,ra=new m.a;ha.runtime.uu.forEach((da,za)=>ba.QKi(za,ca));ha.runtime.vq.forEach((da,za)=>ba.QKi(za,ia));for(let da=0;da<
this.t_d.length;da++){const za=this.t_d[da].classId;ha.runtime.ikb.Z(za,new k.a);ca.ub(za)&&ca.J(za).forEach(la=>{var na=ha.runtime.nk.J(la.id);na&&(na=new O(na,la,ha.runtime.vq.Ty(la.id,na)),ha.runtime.ikb.J(za).add(la.id,na),ra.add(la.id));return!0});ia.ub(za)&&ia.J(za).forEach(la=>{if(ra.contains(la.id))return!0;const na=ha.runtime.nk.J(la.id);na&&ha.runtime.ikb.J(za).add(la.id,new O(na,na,la));return!0})}ha.runtime.sG("PrepareObjectGroupings");ha.logger.Cga("PrepareObjectGroupings");return!0}lgn(ha){let ca=
!0;for(let ia=0;ca&&ia<this.t_d.length;ia++){const ra=this.t_d[ia];ha.runtime.sG("Before function#"+ia);const da=ra.classId;ha.runtime.ikb.J(da).forEach((za,la)=>{ha.runtime.$La.contains(la.dE.id)||(ca=ra.cso(ha,la)&&ca);ca||(a.a.instance.Sa(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",da,la.dE.id),ha.logger.Vg(Object.assign(new A,{tj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ca});ha.runtime.sG("PerformThreewayChildMerge"+ia)}ha.logger.Cga("PerformThreewayChildMerge");
return ca}Hcn(ha,ca){if(ca.v5d(l.a.gf)){var ia=this.Yd.getPropertyObjectIds(ca.dE,l.a.gf);const ra=this.Yd.getPropertyObjectIds(ca.R6,l.a.gf);ca=this.Yd.getPropertyObjectIds(ca.Ppa,l.a.gf);ia=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ia.length,ra.length,ca.length,ha.input.source);a.a.instance.Sa(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ia);ha.logger.Vg(Object.assign(new A,{tj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:ia}));return!1}return!0}PJo(ha,ca){if(ca.v5d(l.a.gf)){const Ca=new m.a,Na=new m.a,Ta=new m.a,Fa=new m.a;var ia=this.Yd.getPropertyObjectIds(ca.dE,l.a.gf),ra=ia.tG(),da,za=({myh:da}=this.xsj(ca.R6,ra,Ca,"Favored")).returnValue,la=({myh:na}=this.xsj(ca.Ppa,ra,Na,"Unfavored")).returnValue;if(!za||!la)return ia=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
ra.count,Ca.count,Na.count,da,na),ha.logger.Vg(Object.assign(new A,{tj:"WordSectionNodeThreewayChildMerge",info:ia})),!1;ia.forEach(qa=>{Ca.contains(qa)||Ta.add(qa);Na.contains(qa)||Fa.add(qa);return!0});ca=ca.dE.aH();ra=new w.a;for(da=0;da<ia.length;da++){var na=ia.ig(da);if(Ta.contains(na)||Fa.contains(na)){if(ha.runtime.$La.add(na),ra.length&&(za=ra.ig(ra.length-1),za=ha.runtime.ikb.J(393241).J(za),la=ha.runtime.ikb.J(393241).J(na),za&&la))Ta.contains(na)?Fa.contains(na)||(za.dE=za.dE.aH(),za.Ppa=
za.Ppa.aH(),this.Mvd(za.dE,la.dE),this.Mvd(za.Ppa,la.Ppa)):(za.dE=za.dE.aH(),za.R6=za.R6.aH(),this.Mvd(za.dE,la.dE),this.Mvd(za.R6,la.R6))}else ra.add(na)}this.Yd.setPropertyObjectIds(ca,l.a.gf,ra);ia=new R.a(ca);ia.KB(l.a.gf);ha.runtime.Ym.Z(ca.id,ia)}return!0}Mvd(ha,ca){const ia=this.Yd.getPropertyObjectIds(ha,l.a.gf);ca=this.Yd.getPropertyObjectIds(ca,l.a.gf);const ra=ia.p4();ca.forEach(da=>{ra.add(da);return!0});this.Yd.setPropertyObjectIds(ha,l.a.gf,ra)}xsj(ha,ca,ia,ra){let da=0,za=!0;this.Yd.getPropertyObjectIds(ha,
l.a.gf).forEach(la=>{ca.contains(la)?ia.add(la):(za=!1,a.a.instance.Sa(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ra,la),da++);return!0});return{returnValue:za,myh:da}}l3l(ha){let ca=!0;ha.runtime.ikb.J(393241).forEach((ia,ra)=>{if(this.Mqm(ra)){a.a.instance.Sa(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ra.dE.id);let da;const za=new T(ha,this.Yd,this.iya);if(({cJi:ia,euj:da}=this.zqo(ha,za.BOl(),ra)).returnValue)return a.a.instance.Sa(4220303,1,
4,"Merging WordSection {0} as a unit.",da),ca=za.success&&this.jUm(ha,da,ia)&&ca,ca||(a.a.instance.Sa(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",ra.dE.id,za.success),ha.logger.Vg(Object.assign(new A,{tj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",za.success)}))),ca}return!0});return ca}Mqm(ha){if(!ha.v5d(l.a.gf))return!1;const ca=this.Yd.getPropertyObjectIds(ha.dE,l.a.gf).J(0),
ia=this.Yd.getPropertyObjectIds(ha.R6,l.a.gf);ha=this.Yd.getPropertyObjectIds(ha.Ppa,l.a.gf);return!ia.contains(ca,(ra,da)=>ra.equals(da))||!ha.contains(ca,(ra,da)=>ra.equals(da))}zqo(ha,ca,ia){ca=ca.J(ia.dE.id);a.a.instance.Sa(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ia.dE.id,ca);if(ha.runtime.$La.contains(ca))return a.a.instance.Sa(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
ca),{returnValue:!1,cJi:null,euj:ca};const ra=new M.a;ia=ha.runtime.nk.J(ca);this.Yd.getPropertyObjectIds(ia,l.a.gf).forEach(da=>{ra.Lvd(da);return!0});ia=this.iya.wob(ca,ha.runtime.uu,ha.runtime.nk);this.Yd.getPropertyObjectIds(ia,l.a.gf).forEach(da=>{ra.Nvd(da);return!0});ha=this.iya.wob(ca,ha.runtime.vq,ha.runtime.nk);this.Yd.getPropertyObjectIds(ha,l.a.gf).forEach(da=>{ra.Rvd(da);return!0});return{returnValue:!0,cJi:ra,euj:ca}}IRf(ha,ca,ia,ra,da){let za=!0;ha.forEach(la=>{const na=ca(la);this.Yd.getPropertyObjectIds(na,
l.a.gf).forEach(Ca=>{ia.add(Ca);if(ra.ub(Ca))return(za=ra.J(Ca).equals(la)&&za)||a.a.instance.Sa(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",da,Ca,la,ra.J(Ca)),za;ra.Z(Ca,la);return!0});return!0});return za}QMl(ha,ca){let ia,ra,da,za;ia=new w.a;ra=new w.a;da=new w.a;za=new k.a;const la=ha.runtime.nk;return this.IRf(ca.eyb,na=>la.J(na),ia,za,"Base")&&this.IRf(ca.kcf,na=>this.iya.wob(na,ha.runtime.uu,la),ra,za,"Favored")&&
this.IRf(ca.Bob,na=>this.iya.wob(na,ha.runtime.vq,la),da,za,"Unfavored")?{returnValue:!0,Ukh:ia,qMh:ra,Amj:da,MBi:za}:{returnValue:!1,Ukh:ia,qMh:ra,Amj:da,MBi:za}}Zjl(ha,ca,ia,ra){let da=!0;const za=ha.runtime.nk,la=ha.runtime.uu,na=ha.runtime.vq,Ca=ha.runtime.Ym,Na=new w.a,Ta=new k.a;ia.forEach(Fa=>{const qa=ra.J(Fa);if(!qa)return a.a.instance.Sa(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",Fa),ha.logger.Vg(Object.assign(new A,{tj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),da=!1;qa.equals(Na.last())||(Na.add(qa),Ta.add(qa,new w.a));Ta.J(qa).add(Fa);ha.runtime.$La.add(Fa);return!0});if(!da)return!1;Ta.forEach((Fa,qa)=>{const ja=this.iya.dlj(Fa,la,na,za).aH();this.Yd.setPropertyObjectIds(ja,l.a.gf,qa);Ca.Z(Fa,new R.a(ja));Ca.J(Fa).KB(l.a.gf);ha.runtime.$La.add(Fa);return da});ia=this.iya.dlj(ca,la,na,za).aH();this.Yd.setPropertyObjectIds(ia,l.a.gf,Na);Ca.Z(ca,new R.a(ia));Ca.J(ca).KB(l.a.gf);ha.runtime.$La.add(ca);return da}jUm(ha,ca,ia){let ra,da;
if(!({Ukh:za,qMh:ra,Amj:da,MBi:ia}=this.QMl(ha,ia)).returnValue)return!1;var za=H.b(za,ra,da);za=this.tOf(ha,za);return!!za&&this.Zjl(ha,ca,za,ia)}Y2d(ha,ca){return this.YIi(ha,ca)}YIi(ha,ca){if(ca.v5d(l.a.gf)){var ia=this.MMl(ca);ia=this.tOf(ha,ia);if(!ia)return a.a.instance.Sa(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.dE.id),ha.logger.Vg(Object.assign(new A,
{tj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),K.a(ca.dE,"OutlineElementContainerThreewayChildMerge_Base",1),K.a(ca.R6,"OutlineElementContainerThreewayChildMerge_Favored",1),K.a(ca.Ppa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ra=this.Yd.getPropertyObjectIds(ca.dE,l.a.gf);const da=ia.tG();ra.forEach(za=>{da.contains(za)||(za=this.Yd.getPropertyObjectIds(ca.dE,l.a.FL),0<za.length&&ha.runtime.dPf.add(za.J(0)));return!0});ra=ca.R6.aH();this.Yd.setPropertyObjectIds(ra,
l.a.gf,ia);ha.runtime.Ym.Z(ra.id,new R.a(ra));ha.runtime.Ym.J(ra.id).KB(l.a.gf)}return!0}gGb(ha){if(!ha)return a.a.instance.Sa(573957964,1,2,"Feature helper is null"),!1;ha.ez(106);return ha.isFeatureEnabled(106)}ajo(ha,ca){if(!this.gGb(ha.runtime.$b))return this.c9f(ha,ca);var ia=ca.dE.id,ra=V.e(ha,ca.dE,null);if(ra.equals(v.a.nil))return a.a.instance.Sa(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ia),ha.logger.Vg(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),
!1;var da=ha.runtime.fzb.J(ra);if(da&&(da=da.J(ia)))if(da.pg)ca=ca.R6.aH(),ca.removeProperty(l.a.gf),this.Yd.setPropertyBool(ca,e.a.ghostCell,!0),null!=da.colSpan?this.Yd.setPropertyUint32(ca,e.a.colSpan,da.colSpan):ca.removeProperty(e.a.colSpan),ha.runtime.Ym.Z(ca.id,new R.a(ca)),ha.runtime.Ym.J(ca.id).KB(l.a.gf),ha.runtime.Ym.J(ca.id).KB(e.a.ghostCell),ha.runtime.Ym.J(ca.id).KB(e.a.colSpan);else{let za,la;({Bwd:ra,pGd:za,$ge:la}=this.KIl(ha,ca,da,ra));if(!za.length&&!la.length)return a.a.instance.Sa(573957966,
1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",ia),ha.logger.Vg(Object.assign(new W.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;za.length?la.length?(ia=H.b(ra,za,la),ia=this.tOf(ha,ia)):ia=za:ia=la;if(!ia)return a.a.instance.Sa(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.dE.id),ha.logger.Vg(Object.assign(new A,
{tj:"TableCellThreewayChildMergev2",eventId:"8n426"})),K.a(ca.dE,"TableCellThreewayChildMergev2_Base",1),K.a(ca.R6,"TableCellThreewayChildMergev2_Favored",1),K.a(ca.Ppa,"TableCellThreewayChildMergev2_Unfavored",1),!1;ca=ca.R6.aH();this.Yd.setPropertyObjectIds(ca,l.a.gf,ia);ca.removeProperty(e.a.ghostCell);ia=da.rowSpan;da=da.colSpan;null!=ia&&null!=da&&(1<ia||1<da)?(this.Yd.setPropertyUint32(ca,e.a.rowSpan,ia),this.Yd.setPropertyUint32(ca,e.a.colSpan,da)):(ca.removeProperty(e.a.rowSpan),ca.removeProperty(e.a.colSpan));
ha.runtime.Ym.Z(ca.id,new R.a(ca));ha.runtime.Ym.J(ca.id).KB(l.a.gf);ha.runtime.Ym.J(ca.id).KB(e.a.ghostCell);ha.runtime.Ym.J(ca.id).KB(e.a.rowSpan);ha.runtime.Ym.J(ca.id).KB(e.a.colSpan)}else return this.c9f(ha,ca);ha.logger.Cga("TableCellThreewayChildMergev2");return!0}KIl(ha,ca,ia,ra){let da,za;({Bwd:ca,pGd:da,$ge:za}=this.oWh(ca));ca||(ca=new w.a);da||(da=new w.a);za||(za=new w.a);var la=ca.tG(),na=da.tG(),Ca=za.tG(),Na=ia.T_d;if(Na)for(var Ta=0;Ta<Na.length;Ta++){var Fa=Na.J(Ta),qa=ha.runtime.nk.J(Fa);
!la.contains(Fa)&&qa&&(la.add(Fa),ca.add(Fa));!na.contains(Fa)&&ha.runtime.uu.Ty(Fa,qa)&&(na.add(Fa),da.add(Fa));!Ca.contains(Fa)&&ha.runtime.vq.Ty(Fa,qa)&&(Ca.add(Fa),za.add(Fa))}ha.logger.Cga("OENodesAddedToChildrenList");if(Na=ia.pof)for(Ta=0;Ta<Na.length;Ta++)if(Fa=Na.J(Ta),qa=ha.runtime.nk.J(Fa)){var ja=this.Yd.getPropertyObjectIds(qa,l.a.gf);if(ja)for(var X=0;X<ja.length;X++){var ua=ja.J(X);la.contains(ua)||(la.add(ua),ca.add(ua))}ja=ha.runtime.uu.Ty(Fa,qa);if(ja=this.Yd.getPropertyObjectIds(ja,
l.a.gf))for(X=0;X<ja.length;X++)ua=ja.J(X),na.contains(ua)||(na.add(ua),da.add(ua));Fa=ha.runtime.vq.Ty(Fa,qa);if(Fa=this.Yd.getPropertyObjectIds(Fa,l.a.gf))for(qa=0;qa<Fa.length;qa++)ja=Fa.J(qa),Ca.contains(ja)||(Ca.add(ja),za.add(ja))}ha.logger.Cga("GhostCellOENodesAddedToChildrenList");if(ia=ia.QIf)for(la=0;la<ia.length;la++)if(na=ia.J(la),na=ha.runtime.fzb.J(ra).J(na))if(na=na.T_d){na=na.tG();Ca=new w.a;for(Na=0;Na<ca.length;Na++)na.contains(ca.J(Na))||Ca.add(ca.J(Na));ca=Ca;Ca=new w.a;for(Na=
0;Na<da.length;Na++)na.contains(da.J(Na))||Ca.add(da.J(Na));da=Ca;Ca=new w.a;for(Na=0;Na<za.length;Na++)na.contains(za.J(Na))||Ca.add(za.J(Na));za=Ca}ha.logger.Cga("NonGhostCellsOENodesRemovedFromChildrenList");return{Bwd:ca,pGd:da,$ge:za}}c9f(ha,ca){let ia=ca.R6.hasProperty(l.a.gf),ra=ca.Ppa.hasProperty(l.a.gf);ia&&(ia=!!this.Yd.getPropertyObjectIds(ca.R6,l.a.gf).length);ra&&(ra=!!this.Yd.getPropertyObjectIds(ca.Ppa,l.a.gf).length);if(ia!==ra)if(this.gxm(ha.runtime.$b))ha.logger.Zsi(Object.assign(new W.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return ha.logger.Vg(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.YIi(ha,ca)}MMl(ha){let ca,ia;({Bwd:ha,pGd:ca,$ge:ia}=this.oWh(ha));return H.b(ha,ca,ia)}tOf(ha,ca){a.a.instance.Sa(4220309,1,5,"Considering {0} OutlineElement collections for merge.",ca.length);const ia=new w.a;let ra=!0;ca.forEach(da=>{if(!da)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
ha.logger.Vg(Object.assign(new A,{tj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ra=!1;if(1===da.YUm&&1===da.oEf){const ja=da.eyb.J(0),X=da.kcf.J(0),ua=da.Bob.J(0);if(ja&&ja.equals(X)&&ja.equals(ua))return ia.add(ja),!0;if(1!==ca.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ja,X,ua,ca.length),
ha.logger.Vg(Object.assign(new A,{tj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ra=!1}const za=new k.a,la=new w.a,na=new w.a,Ca=new w.a,Na=new w.a,Ta=new w.a,Fa=new w.a,qa=ha.runtime.nk;da.eyb.forEach(ja=>ra=this.ASf(ha,ja,X=>qa.J(X),la,Na,za,"Base"));if(!ra)return a.a.instance.Sa(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ha.logger.Vg(Object.assign(new A,{tj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;
da.kcf.forEach(ja=>ra=this.ASf(ha,ja,X=>this.iya.wob(X,ha.runtime.uu,qa),na,Ta,za,"Favored"));if(!ra)return a.a.instance.Sa(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),ha.logger.Vg(Object.assign(new A,{tj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;da.Bob.forEach(ja=>ra=this.ASf(ha,ja,X=>this.iya.wob(X,ha.runtime.vq,qa),Ca,Fa,za,"Unfavored"));if(!ra)return a.a.instance.Sa(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
ha.logger.Vg(Object.assign(new A,{tj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ha.runtime.$b&&ha.runtime.$b.CDb(1000005)&&(Ta.length&&this.fgl(Ta,ha.runtime.uu)?(this.deh(Ta,ha,ia,za),this.Vud(ha,za,Fa)):this.deh(Fa,ha,ia,za));if(la.length){da=null;if(!({Ym:da}=this.Udn(ha,la,na,Ca,da)).returnValue||!da)return ra=!1;da.forEach(ja=>{0<ja.YXb.count&&ha.runtime.Ym.Z(ja.rm.id,ja);ia.add(za.J(ja.rm.id));return!0})}return!0});return ra?ia:null}fgl(ha,ca){for(let ia=0;ia<ha.length;ia++)if(ca.get(ha.ig(ia).id))return!0;
return!1}Vud(ha,ca,ia){ia.length&&(ia.forEach(ra=>{ha.runtime.xhc.add(ra.id);ha.runtime.xhc.add(ca.J(ra.id));return!0}),I.a.Vud(ha,this.Yd,ia.J(0)))}deh(ha,ca,ia,ra){ha.forEach(da=>{const za=new R.a(da.aH());ca.runtime.Ym.Z(da.id,za);ia.add(ra.J(da.id));return!0})}ASf(ha,ca,ia,ra,da,za,la){var na=ia(ca);if(!na)return a.a.instance.Sa(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",la,ca),ha.logger.Vg(Object.assign(new A,{tj:"ProcessOutlineElement",eventId:"aqwkb",
info:String.format("[Revision: {0}] Failed to find OutlineElement",la)})),!1;const Ca=this.Yd.getPropertyObjectIds(na,l.a.FL);if(!Ca||!Ca.length)return a.a.instance.Sa(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",la,ca),ha.logger.Vg(Object.assign(new A,{tj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",la)})),K.a(na,"ProcessOutlineElement_"+la,1),!1;na=Ca.ig(0);ia=ia(na);if(!ia)return a.a.instance.Sa(4285059,
1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",la,na,ca),ha.logger.Vg(Object.assign(new A,{tj:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",la)})),!1;if((la=this.Yd.getPropertyString(ia,e.a.EM))&&""!==la&&ha.runtime.$b&&(ha.runtime.$b.Eof(1000005),ha.runtime.$b.CDb(1000005)))return da.add(ia),za.add(na,ca),ha.runtime.$La.add(na),!0;ra.add(ia);
za.add(na,ca);ha.runtime.$La.add(na);return!0}oWh(ha){let ca,ia;ca=this.Yd.getPropertyObjectIds(ha.dE,l.a.gf);ia=this.Yd.getPropertyObjectIds(ha.R6,l.a.gf);ha=this.Yd.getPropertyObjectIds(ha.Ppa,l.a.gf);return{Bwd:ca,pGd:ia,$ge:ha}}gxm(ha){if(!ha)return a.a.instance.Sa(51422868,1,2,"Feature Helper is null"),!1;ha.ez(105);return ha.isFeatureEnabled(105)}static QKi(ha,ca){ca.ub(ha.Rc)||ca.Z(ha.Rc,new w.a);ca.J(ha.Rc).add(ha);return!0}}ba.h3d=v.a.Gf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(ba,
"ChildNodeListMerge",null,[1923])},1708:function(D,L,c){D=c(0);var l=c(1459),e=c(1575),a=c(1507),k=c(1477),m=c(1522);class w{constructor(ha,ca){this.DimensionValue=this.DimensionName=null;this.DimensionName=ha;this.DimensionValue=ca}}Object(D.a)(w,"Dimension",null,[]);class v{constructor(ha,ca,ia,ra,da){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ha;this.Query=ca;this.From=ia;this.Size=ra;da&&(this.Filter=da)}}Object(D.a)(v,"EntityRequest",null,[]);class r{constructor(ha){this.QueryString=
null;this.QueryString=ha}}Object(D.a)(r,"Query",null,[]);var z=c(1460);class A{constructor(ha,ca){this.Dimensions=this.Name=null;this.Name=ha;this.Dimensions=ca}}Object(D.a)(A,"Scenario",null,[]);var G=c(1464),H=c(1463);class I{constructor(ha,ca,ia,ra){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ha;this.TimeZone=ca;this.Cvid=ia;this.Scenario=ra}}Object(D.a)(I,"SubstrateBody",null,[]);var K=c(1521),F=c(1457),J=c(1456),N=c(2),O=c(1645),M=c(1644),T=c(1505),R=c(33),
W=c(16),V=c(119);c.d(L,"a",function(){return ba});class ba{constructor(ha){this.ivc=this.Yab=this.Jkd=this.Vpc=this.Tvc=0;this.JXg=this.o0g=this.hP=null;this.qtb=0;this.Y0=-1;this.xyc="";this.rg=N.AFrameworkApplication.Ve;this.oc=ha;this.Wqd=this.Tmf();this.CKe=new e.a;this.$Vg=this.oc.kge?3:2;this.d8g=this.oc.kge&&this.oc.Bbj?5:3;this.Mah=this.oc.Sbe?2:3;this.Nah=1;this.Ljd=this.oc.v0h;this.x6g=this.oc.rwm;this.Qwc=ha.x4h;N.AFrameworkApplication.K&&(this.o0g=N.AFrameworkApplication.K.lb("AppCatalogUrl")+
N.AFrameworkApplication.K.lb("SearchPersonaPhotoBaseUrl"))}uK(){return"Substrate"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:3}qH(ha,ca,ia,ra=l.a.tellMe,da=null){const za=new H.a(ha);if(!da||Array.contains(da,14)||Array.contains(da,15)||Array.contains(da,20))if(!this.qtb||window.performance.now()-this.qtb>=J.a.MSa)if(ia=this.CKe.a5h())this.qtb=window.performance.now(),ia.then(la=>{la&&""!==la?(this.xyc=la,""!==this.hP&&this.$4h(ha,ra,this.xyc,ca,da)):(F.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery",
"Empty or null token returned"),ca.resultsUpdated(za))},la=>{F.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+la);ca.resultsUpdated(za)});else{if(F.TellMeActor.instance.Qe)F.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ca.resultsUpdated(za)}else this.xyc&&""!==this.xyc?this.$4h(ha,ra,this.xyc,ca,da):(ca.resultsUpdated(za),F.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery",
"Not able to acquire token"));else ca.resultsUpdated(za)}Nec(){this.Yab=this.ivc=this.Jkd=this.Vpc=this.Tvc=0}$4h(ha,ca,ia,ra,da){this.Nec();const za=new H.a(ha),la=this.hP=V.a.create().toString();this.CBa();this.Y0=window.setTimeout(()=>{if(la===this.hP){this.hP="";this.Y0=-1;ra.resultsUpdated(za);const Na={};Na[a.a.provider]=this.uK();Na[a.a.eKb]=ha.Ilb;F.TellMeActor.instance.Qe.hA(k.a.timedOut,this.Qwc,Na)}},this.Qwc);const na={"Content-Type":"application/json",Accept:"application/json"};na.Authorization=
"Bearer "+ia;na["X-Office-Version"]=N.AFrameworkApplication.buildVersion;na["X-Office-Application"]=N.AFrameworkApplication.K.lb("Application");na["X-Office-Platform"]="WAC";na["X-TellMe-SessionId"]=F.TellMeActor.instance.UMd();na["X-TellMe-Culture"]=N.AFrameworkApplication.uiCulture;na["X-TellMe-ProcessSessionId"]=N.AFrameworkApplication.userSessionId;na["Client-Request-Id"]=la;const Ca=window.performance.now();this.rg.qj(this.kVl(),2,this.lVl(ha.Ig,this.oc.application,F.TellMeActor.instance.UMd(),
J.a.rQ(ha)),na,!1,0,Na=>{this.PIb(Na,ha,ra,la,Ca,ca,da)},Na=>{this.DIb(Na,ha,ra,la,Ca)},null,null,!1,4E3,6E3)}CBa(){-1!==this.Y0&&(window.clearTimeout(this.Y0),this.Y0=-1)}PIb(ha,ca,ia,ra,da,za,la){F.TellMeActor.instance.Qe.d8(ca.Ig.length,this.Wqd.join(","),ha.data.jf.toString(),Math.round(window.performance.now()-da),K.a.substrate,!0,m.a.tOa);const na=J.a.rQ(ca),Ca=new H.a(ca);if(ra===this.hP){this.CBa();ha=R.b(ha.data.Ae);if(ha.Groups){ha=ha.Groups;for(const Na of ha)"People"===Na.Type&&this.oc.y5c&&
(la?Array.contains(la,14):1)?(ha=this.G1h(Na.Suggestions,na,za),0<ha.results.length&&Ca.Lv(ha)):"File"===Na.Type&&this.oc.w5c&&(la?Array.contains(la,15):1)?(ha=this.RWh(Na.Suggestions,na,za),0<ha.results.length&&Ca.Lv(ha)):"Notes"===Na.Type&&this.oc.Yib&&za!==l.a.contextMenu&&(la?Array.contains(la,20):1)&&(ha=this.q0h(Na.Suggestions,na,ca),0<ha.results.length&&Ca.Lv(ha))}ia.resultsUpdated(Ca);F.TellMeActor.instance.Qe.d8(ca.Ig.length,this.Wqd.join(","),"",Math.round(window.performance.now()-da),"",
!0,m.a.provider)}else ia.resultsUpdated(Ca)}q0h(ha,ca,ia){const ra=new G.a(20);ra.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const da of ha)this.Lym(da)&&(ha=da.NotesType,ha=W.a.jh(ha),ha=this.RLl(ha,da.LastModifiedTime,da.BodyPreview,da.Subject,ca,ia,da))&&(ha.groupType=20,ra.Ly(ha));return ra}G1h(ha,ca,ia){const ra=new G.a(14);ra.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const za of ha)if(this.Mym(za)){var da=za.Id.split("@")[0];ha=za.EmailAddresses[0];let la=za.Type;
if(void 0===la||null===la)la="User";if(da=this.OOl(la,za.DisplayName,za.JobTitle,ha,da,ia,ca))da.description=ha,ha=za.JobTitle,"Department"in za&&"CompanyName"in za&&(ha+="@"+za.Department+"@"+za.CompanyName),da.fI=ha,ra.Ly(da)}return ra}RWh(ha,ca,ia){const ra=new G.a(15);ra.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const la of ha)if(this.Bym(la)){var da=la.FileName;ha=la.FileExtension;const na=da.length>ha.length?da.substr(0,da.length-ha.length-1):la.Title;var za=void 0;ha=0;"DateCreated"in
la?(ha=J.a.Cnf(la.DateCreated),za=J.a.r6h(la.DateCreated),za=String.format(CommonUIStrings.l_CreatedTimeFormatString,la.Author,za)):za=la.Author;const Ca=la.AccessUrl+"?web=1",Na=W.a.gOc(Ca);da=String.format('<a href="{0}">{1}</a>',Na,W.a.UZ(da));if(ia!==l.a.contextMenu||W.a.tX(Ca))if(da=this.wCl(na,ia===l.a.contextMenu?da:Ca,za,la.FileExtension,la.Text,ca))da.description=la.Author,da.vvd=ha,ra.Ly(da)}return ra}DIb(ha,ca,ia,ra,da){ra===this.hP&&(this.CBa(),F.TellMeActor.instance.Qe.d8(ca.Ig.length,
this.Wqd.join(","),ha.data.jf.toString(),Math.round(window.performance.now()-da),K.a.substrate,!1,m.a.tOa));ha=new H.a(ca);ia.resultsUpdated(ha)}OOl(ha,ca,ia,ra,da,za,la){la=la?this.Nah:this.$Vg;if(!window.LPC&&!J.a.Puf()||this.Tvc===la)return null;this.Tvc+=1;la="PeopleSuggestion"+this.Tvc.toString();var na=this.o0g+"?size=1&accountName="+ra;ha=Object.assign(new O.a,{PersonaType:ha,Smtp:ra,ProfilePictureUrl:na,AadObjectId:da});const Ca=Object.assign(new M.a,{identifiers:ha,displayName:ca});ha=za===
l.a.contextMenu;this.oc.Xua?(F.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(la,Ca,ca,ia)),za===l.a.contextMenu&&(ia=J.a.bBh(ca,ra,da),F.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(la,ia))),F.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(la,ha))):(na=[],na.push(appChrome.actions.setPersonaButtonCoauthor(la,Ca,ca,ia)),za===l.a.contextMenu&&(ia=J.a.bBh(ca,ra,da),na.push(appChrome.actions.setButtonCommandValueId(la,
ia))),na.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(la,ha)),appChrome.api.dispatch(na));return new z.a(la,11,ca,ra,0)}RLl(ha,ca,ia,ra,da,za,la){if(da&&!this.oc.Ioi||this.Jkd===this.Ljd||this.ivc===this.Ljd||this.Yab===this.Ljd)return null;var na=null;this.Jkd+=1;da="";const Ca=[],Na={};la.type="Notes";this.JXg=Object.assign(new T.a,{landingTab:"Notes",data:la});za=J.a.zMa(za.Ig,33,this.JXg);if("onenotepagepreviews"===ha){if(!("ClickthroughUrl"in la&&la.ClickthroughUrl)||""===
la.ClickthroughUrl)return null;this.ivc+=1;da="OnenoteNotesSuggestion"+this.ivc.toString();Na["default"]="SaveAsonetoc2_20";na=la.ClickthroughUrl;Ca.push(appChrome.actions.setControlIconSet(da,Na));Ca.push(appChrome.actions.setCompoundButtonCommandValueId(da,na));na=new z.a(da,19,null,null,0)}else if("stickynote"===ha){if(!this.x6g)return null;this.Yab+=1;da="NotesSuggestion"+this.Yab.toString();Na["default"]="ShowAllNotes_20";Ca.push(appChrome.actions.setControlIconSet(da,Na));Ca.push(appChrome.actions.setCompoundButtonCommandValueId(da,
za));na=new z.a(da,21,null,null,0)}else if("samsung"===ha){if(!this.x6g)return null;this.Yab+=1;da="NotesSuggestion"+this.Yab.toString();Na["default"]="CategoryCollapsed_20";Ca.push(appChrome.actions.setControlIconSet(da,Na));Ca.push(appChrome.actions.setCompoundButtonCommandValueId(da,za));na=new z.a(da,20,null,null,0)}""!==da&&(ha=J.a.r6h(ca),ha=String.format(CommonUIStrings.l_LastModifiedString,ha),na.label=ra,na.vvd=J.a.Cnf(ca),Ca.push(appChrome.actions.setControlLabel(da,ra)),Ca.push(appChrome.actions.updateCompoundButtonDescription(da,
ha)),Ca.push(appChrome.actions.setControlCustomTooltip(da,ia)),appChrome.api.dispatch(Ca));return na}wCl(ha,ca,ia,ra,da,za){if(this.Vpc===(za?this.Mah:this.d8g))return null;this.Vpc+=1;za="FileSuggestion"+this.Vpc.toString();const la=[],na={};na["default"]=J.a.CFl(ra);this.oc.Xua?(F.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(za,ha)),F.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(za,na)),F.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(za,
ia)),F.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(za,ca)),F.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(za,da))):(la.push(appChrome.actions.setControlLabel(za,ha)),la.push(appChrome.actions.setControlIconSet(za,na)),la.push(appChrome.actions.updateCompoundButtonDescription(za,ia)),la.push(appChrome.actions.setCompoundButtonCommandValueId(za,ca)),la.push(appChrome.actions.setControlCustomTooltip(za,da)),appChrome.api.dispatch(la));
return new z.a(za,6,ha,ia,0)}Tmf(){const ha=[];this.oc.y5c&&Array.add(ha,"People");this.oc.w5c&&Array.add(ha,"File");this.oc.Yib&&Array.add(ha,"Notes");return ha}lVl(ha,ca,ia,ra){var da=new r(ha);ha=new v("File",da,0,ra?this.Mah:this.d8g,null);ra=new v("People",da,0,ra?this.Nah:this.$Vg,J.a.Vfn);da=new v("Notes",da,0,this.Ljd,null);ca=new w("app",ca.toLowerCase());var za=[];Array.add(za,ca);ca=new A("tellmesearch",za);za=[];this.oc.w5c&&Array.add(za,ha);this.oc.y5c&&Array.add(za,ra);this.oc.Yib&&
Array.add(za,da);ia=new I(za,"UTC",ia,ca);return R.c(ia)}kVl(){let ha=this.oc.lho;this.oc.Yib&&(ha+="?&setflight=NotesFrom3S");""!==this.oc.b5h&&(ha=ha+"&"+this.oc.b5h);return ha}Mym(ha){return"DisplayName"in ha&&"Id"in ha&&"EmailAddresses"in ha&&!!ha.Id&&!!ha.EmailAddresses}Bym(ha){return"FileExtension"in ha&&!!ha.FileExtension&&"FileName"in ha&&!!ha.FileName&&""!==ha.FileName&&"AccessUrl"in ha&&!!ha.AccessUrl&&""!==ha.AccessUrl}Lym(ha){return"Id"in ha&&!!ha.Id&&"NotesType"in ha&&!!ha.NotesType&&
"Subject"in ha&&!!ha.Subject&&""!==ha.Subject}}Object(D.a)(ba,"SubstrateResultsProvider",null,[1099])},1709:function(D,L,c){D=c(0);var l=c(45),e=c(7),a=c(17),k=c(152),m=c(80),w=c(154),v=c(228),r=c(621),z=c(61),A=c(412),G=c(2),H=c(1418),I=c(760);class K{constructor(la,na=0){this.s4e=null;this.KPf=0;this.gM=la;this.QTm=na}}Object(D.a)(K,"GraphMergerResponse",null,[]);var F=c(52),J=c(1),N=c(134),O=c(719),M=c(1491),T=c(1540);class R extends T.a{constructor(){super();this.Udj=null;this.qtj=!1}get ifa(){return"Crash"}pCb(){this.detail.Z("Type",
this.ifa);this.detail.Z("Trace",this.Ypo(this.Udj));this.detail.Z("Continue",this.qtj);return this.detail}Ypo(la){la=la.split("\n");const na=4<la.length?4:la.length,Ca=new Sys.StringBuilder;for(let Na=0;Na<na;Na++)Na===na-1?Ca.append(String.format("{0}...",la[Na])):Ca.append(String.format("{0}\n",la[Na]));return Ca.toString()}}Object(D.a)(R,"CrashMergeFailureDetail",T.a,[]);var W=c(1884),V=c(1511),ba=c(1592),ha=c(1492);class ca{constructor(){this.msk=new A.a;this.rKk=new A.a;this.ENk=new A.a}}Object(D.a)(ca,
"RangeMarkers",null,[]);class ia{constructor(){this.colSpan=this.rowSpan=null;this.pg=!1;this.Cve=new v.a;this.yEe=new v.a;this.REe=new v.a}get pof(){return this.Cve.p4()}set pof(la){la||(this.Cve=new v.a);this.Cve=la.p4()}get QIf(){return this.yEe.p4()}set QIf(la){la||(this.yEe=new v.a);this.yEe=la.p4()}get T_d(){return this.REe.p4()}set T_d(la){la||(this.REe=new v.a);this.REe=la.p4()}}Object(D.a)(ia,"TableCellStructureInfo",null,[]);var ra=c(1543),da=c(1583);c.d(L,"a",function(){return za});class za{constructor(){this.DNd=
0;this.qMg=this.J9a=this.VUb=this.Qg=this.k3g=this.rWb=null;this.YVg=0;this.NSg=50;this.VJg=this.LDg=null}get i_i(){return this.rWb}get cNn(){return this.k3g}get Yd(){return this.Qg}get Rjb(){return this.VUb}get w8h(){return this.J9a}get Q0l(){return this.qMg}get zac(){return this.YVg}get Rrh(){return this.LDg}get vIc(){return this.VJg}Gac(la,na,Ca,Na,Ta,Fa,qa){Ca=this.OUk(la,na,Na,Ta,Fa,qa,this.vIc);Na=0;const ja=Ca.runtime.Wbe;let X=null;try{this.eLm(ja,Ca,qa,la,na,Ta,Fa);for(la=1;Na<this.Rjb.length;Na++)if(!(0,this.Rjb[Na])(Ca)){la=
2;Ca.logger.UXd("GraphMerger.GetMergeFunctions()",Na);break}return X=new K(Ca.output.gM,la)}catch(ua){const Ha=!Ca.output.timeout;Ca.output.crash=Ha;const Ea=this.PJd(ua),wa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ha?"Crashed":"Timed Out",Ca.input.JHb,!!Ca.output.gM,Ea);Ha?(k.a.instance.Sa(4051608,1,1,"MergeChanges Crash. [Error: {0}]",wa),Ca.logger.Vg(Object.assign(new R,{Udj:Ea,qtj:!!Ca.output.gM}))):k.a.instance.Sa(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",
wa);if(Ca.output.gM)return X=new K(Ca.output.gM,2);throw ua;}finally{Ca.output.succeeded?this.bLm(ja,Ca,Na):Ca.output.timeout?this.dLm(Ca,Na):Ca.output.crash?Ca.output.gM?this.cLm(Ca,Na):this.aLm(Ca,Na):this.$Km(Ca,Na);Ca.logger.ZKm();k.a.instance.tia(42350232,1,Ca.output.succeeded?4:2,"MergeLogger",Ca.logger.NJl());Ca.logger.JUc.l$h()&&k.a.instance.tia(559015903,1,2,"MarkerInfo",Ca.logger.JUc.toString());if(Ca.runtime.$b&&Ca.runtime.$b.isFeatureEnabled(73))try{this.OHm(Ca)}catch(ua){k.a.instance.Sa(571619421,
1,4,"Error logging references: {0}",ua.toString())}this.HMm(Ca);X.KPf|=(Ca.output.succeeded?2:1)<<2*(qa-1);if(X)try{X.s4e=this.Fjn(Ca)}catch(ua){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",ua)}}}HMm(la){if(!la.output.succeeded){la=la.output.timeout?"Timeout":la.logger.oPi?la.logger.oPi.ifa:"Unknown";const na=new N.a;m.Health.instance.recordQosError(la,["MergeFailure"],!0,!0,!1,!1,na)}}OHm(la){const na=Ta=>{const Fa=this.UCa()-la.input.nSa>this.zac;if(0<this.zac&&Fa)throw k.a.instance.Sa(571619422,
1,2,"Timed out while calculating added and deleted nodes: {0}",Ta),w.a.invalidOperation(Ta);};let Ca=la.runtime.uu.keys,Na=Ta=>la.runtime.uu.J(Ta);this.hCf(la,na,Ca,Na,"Favored");Ca=la.runtime.vq.keys;Na=Ta=>la.runtime.vq.J(Ta);this.hCf(la,na,Ca,Na,"Unfavored");Ca=la.runtime.Ym.keys;Na=Ta=>{const Fa=la.runtime.Ym.J(Ta);return Fa?Fa.rm:la.runtime.uu.J(Ta)};this.hCf(la,na,Ca,Na,"Merged")}hCf(la,na,Ca,Na,Ta){var Fa=new v.a;const qa=new v.a;for(let ja=0;ja<Ca.length;ja++){na("LogAddedAndDeletedNodes");
const X=Na(Ca.J(ja));if(4325465===X.Rc)continue;const ua=la.runtime.nk.J(X.id);ua&&this.PHm(Fa,qa,X,ua)}this.Uti(qa,ja=>la.runtime.nk.J(ja),na);this.Uti(Fa,Na,na);na=new Sys.StringBuilder;for(Ca=0;Ca<Fa.length;Ca++)na.append(Fa.J(Ca).toString()+",");Fa=new Sys.StringBuilder;for(Ca=0;Ca<qa.length;Ca++)Fa.append(qa.J(Ca).toString()+",");k.a.instance.tia(571619423,1,4,Ta+" revision: Added references",na.toString());k.a.instance.tia(571619424,1,4,Ta+" revision: Deleted references",Fa.toString())}PHm(la,
na,Ca,Na){const Ta=Ca.Aj();for(let qa=0;qa<Ta.length;qa++){const ja=Ta[qa];if(this.vgi(ja)){var Fa=this.Yd.getPropertyObjectIds(Ca,ja);this.WJm(la,na,Na,ja,Fa)}else this.Fli(ja)&&(Fa=this.Yd.getPropertyObjectId(Ca,ja),this.VJm(la,na,Na,ja,Fa))}}Uti(la,na,Ca){Ca("LogNestedReferences");Ca=new v.a;const Na=new r.a;for(let Ta=0;Ta<la.length;Ta++){const Fa=la.J(Ta);this.ICf(Fa,Ca,Na,na)}for(na=0;na<Ca.length;na++)la.add(Ca.J(na))}ICf(la,na,Ca,Na){const Ta=Na(la);if(Ta){const qa=Ta.Aj();for(let ja=0;ja<
qa.length;ja++){var Fa=qa[ja];if(this.vgi(Fa)){Fa=this.Yd.getPropertyObjectIds(Ta,Fa);for(let X=0;X<Fa.length;X++)Ca.contains(Fa.J(X))||(na.add(Fa.J(X)),Ca.add(Fa.J(X)),this.ICf(Fa.J(X),na,Ca,Na))}else this.Fli(Fa)&&(Fa=this.Yd.getPropertyObjectId(Ta,Fa),Ca.contains(Fa)||(na.add(Fa),Ca.add(Fa),this.ICf(la,na,Ca,Na)))}}}WJm(la,na,Ca,Na,Ta){if(this.Yd.hasProperty(Ca,Na)){Ca=this.Yd.getPropertyObjectIds(Ca,Na);const Fa=Ca.tG();Na=Ta.tG();for(let qa=0;qa<Ta.length;qa++)Fa.contains(Ta.J(qa))||la.add(Ta.J(qa));
for(la=0;la<Ca.length;la++)Na.contains(Ca.J(la))||na.add(Ca.J(la))}else for(na=0;na<Ta.length;na++)la.add(Ta.J(na))}VJm(la,na,Ca,Na,Ta){Ta&&(this.Yd.hasProperty(Ca,Na)?(Ca=this.Yd.getPropertyObjectId(Ca,Na),Ta.equals(Ca)||(la.add(Ta),na.add(Ca))):la.add(Ta))}YKm(la){k.a.instance.Sa(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",la.input.JHb,la.output.crash,la.output.timeout)}eLm(la,na,Ca,Na,Ta,Fa,qa){if(la){la=Na.length?Na.ig(Na.length-1):null;var ja=Ta.length?Ta.ig(Ta.length-
1):null;Ca=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",na.input.JHb,Na.length,la?la.id:z.a.nil,la?la.rW?la.rW.id:z.a.nil:z.a.nil,Ta.length,ja?ja.id:z.a.nil,ja?ja.rW?ja.rW.id:z.a.nil:z.a.nil,Fa,qa,this.zac,Ca);switch(na.input.source){case 5:k.a.instance.Sa(51663493,1,4,Ca);break;default:k.a.instance.Sa(4051606,
1,4,Ca)}}}bLm(la,na,Ca){if(la)switch(la=this.KKc(na,Ca,"Succeeded"),na.input.source){case 5:k.a.instance.Sa(51663494,1,4,la);break;default:k.a.instance.Sa(4059162,1,4,la)}}dLm(la,na){na=this.KKc(la,na,"Timeout");switch(la.input.source){case 5:k.a.instance.Sa(51663495,1,4,na);break;default:k.a.instance.Sa(4059163,1,2,na)}}$Km(la,na){na=this.KKc(la,na,"Rejection");switch(la.input.source){case 5:k.a.instance.Sa(51663496,1,4,na);break;default:k.a.instance.Sa(4059164,1,2,na)}}cLm(la,na){na=this.KKc(la,
na,"Crash - Rejection");switch(la.input.source){case 5:k.a.instance.Sa(51663497,1,4,na);break;default:k.a.instance.Sa(4059165,1,2,na)}}aLm(la,na){na=this.KKc(la,na,"Crash - Failed");switch(la.input.source){case 5:k.a.instance.Sa(51663498,1,4,na);break;default:k.a.instance.Sa(4059166,1,2,na)}}KKc(la,na,Ca){const Na=la.output.gM,Ta=Na&&Na.length?Na.ig(Na.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
la.input.JHb,Ca,this.UCa()-la.input.nSa,na,Na?Na.length:0,Ta?Ta.id:z.a.nil,Ta?Ta.rW?Ta.rW.id:z.a.nil:z.a.nil,la.input.source)}OUk(la,na,Ca,Na,Ta,Fa,qa){const ja=new W.a,X=ja.input;X.Z8=la;X.qTa=na;X.gm=Ca;X.Lga=Na;X.lEb=Ta;X.source=Fa;X.vIc=qa;X.nSa=this.UCa();ja.logger.L1n(X.nSa);la=ja.runtime;la.G3c=k.a.instance.O8(1,5);la.Wbe=k.a.instance.O8(1,4);let ua="";la.sG=Ha=>{if(this.zac){var Ea=this.UCa()-X.nSa,wa=Ea>this.zac;ua+=String.format(" ({0}: {1})",Ha,Ea);wa&&(ja.output.timeout=!0,Ha=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",
X.JHb,this.zac,Ha,Ea,ua),k.a.instance.Sa(528061012,1,2,Ha),this.$lo(Ha))}};return ja}tLc(){return[Object(F.a)(this,this.Abn,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.Dqm,"isInputValid"),Object(F.a)(this,this.bem,"initializeOutputMergeState"),Object(F.a)(this,this.FQd,"initializeRuntimeMergeState"),ba.a.njn,Object(F.a)(this,this.mjn,"preProcessTableStructure"),Object(F.a)(this.Rrh,this.Rrh.uTm,"mergeChildNodeLists"),Object(F.a)(this,this.uro,"tryObjectMerge"),ba.a.Vin,Object(F.a)(this,
this.Shl,"finalizeObjectMerge"),Object(F.a)(this,this.uEo,"validateMarkers"),Object(F.a)(this,this.Qak,"addMergeResultsToOutput")]}Abn(la){const na=la.input.Z8;la=la.output;return na?na.length?!0:(k.a.instance.Sa(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),la.gM=na,la.succeeded=!0,!1):(k.a.instance.Sa(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),la.gM=na,la.succeeded=!0,!1)}Dqm(la){var na=la.input;const Ca=na.Z8,
Na=na.qTa,Ta=na.gm,Fa=na.Lga;na=na.lEb;la=la.output;if(!Na||!Na.length)return k.a.instance.Sa(42350233,1,5,"IsInputValid: No local changes to merge."),la.gM=Ca,la.succeeded=!0,!1;let qa=!0;if(2!==Fa&&1!==Fa)return la.gM=Ca,!1;Ta&&Ta!==z.a.nil||(qa=!1);Ca.length<(na?2:1)&&(k.a.instance.Sa(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",na),qa=!1);qa||(la.gM=2===Fa?Ca:Na);return qa}FQd(la){var na=
la.input,Ca=na.Z8,Na=na.qTa,Ta=na.Lga,Fa;let qa;({u$f:Fa,Vfg:qa,LBa:na}=this.Rjf(la,Ca,Na,na.lEb));if(!na)return k.a.instance.Sa(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",Fa.id,qa.id),la.logger.Vg(Object.assign(new M.a,{tj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.rui(Fa,Ca.length,"TheirChanges"),this.rui(qa,Na.length,"YourChanges"),la.output.gM=2===Ta?Ca:Na,!1;la.runtime.LBa=
na;({ato:Ca,ggl:Na}=this.b4k(Ta,Fa,qa));({bto:na,hgl:Ta,Dqk:Fa}=this.iKl(la,Ca,Na,na));la.runtime.nk=Fa;la.runtime.vq=na;la.runtime.uu=Ta;la.runtime.Ym=new A.a;la.runtime.qGd=Na.id;la.runtime.ahe=Ca.id;la.runtime.ikb=new A.a;la.runtime.$La=new r.a;la.runtime.o7e=new A.a;la.runtime.fzb=new A.a;la.runtime.f9f=new A.a;la.runtime.k7d=new ca;la.runtime.oZd=new v.a;la.runtime.dPf=new r.a;la.runtime.xhc=new v.a;la.runtime.$b=la.input.vIc(la);la.runtime.$b.Tud(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature",
"WoWor220;WoWor220cf",l.a.Zko);la.runtime.$b.Tud(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",l.a.bno);la.runtime.$b.Tud(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.Qfl);la.runtime.$b.Tud(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.mDn);la.runtime.Adi=!0;G.AFrameworkApplication.K&&(this.NSg=G.AFrameworkApplication.K.pc("WordEditorGraphMergeMaxIterationsPerCycle",
50));return!0}rui(la,na,Ca){const Na=new v.a;for(;la;)Na.add(la),la=la.rW;const Ta=new Sys.StringBuilder;Ta.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Ca,na,Na.length));let Fa=Na.length,qa=0;Na.forEach(ja=>({vbi:Fa,Sui:qa}=this.Fck(Ta,ja,Na,Fa,qa)).returnValue);k.a.instance.Sa(4273302,1,4,Ta.toString())}Fck(la,na,Ca,Na,Ta){la.append(String.format(" [{0} {1} {2}]",Na,na.Jva?"S":"B",na.id));Na--;Ta++;return 50<Ta&&Ca.length!==Ta?(la.append(" ...Truncated."),{returnValue:!1,
vbi:Na,Sui:Ta}):{returnValue:!0,vbi:Na,Sui:Ta}}Rjf(la,na,Ca,Na){na=na.ig(na.length-1-(Na?1:0));Ca=Ca.ig(Ca.length-1);Na=na.G_a(Ca);la.runtime.sG("GetCommonBase");la.logger.Cga("GetCommonBase");return{u$f:na,Vfg:Ca,LBa:Na}}iKl(la,na,Ca,Na){let Ta,Fa;({result:Ta}=na.Hac(Na));la.runtime.sG("GetUnfavoredChanges");la.logger.Cga("GetUnfavoredChanges");({result:Fa}=Ca.Hac(Na));5===la.input.source&&(la.runtime.kgl=O.a.c3h(Ca),la.runtime.dto=O.a.c3h(na));la.runtime.sG("GetFavoredChanges");la.logger.Cga("GetFavoredChanges");
na=new H.a(Object(F.a)(Na,Na.a0a,"getMergeableObject"));la.runtime.sG("GetModifiedObjects");la.logger.Cga("GetModifiedObjects");return{bto:Ta,hgl:Fa,Dqk:na}}b4k(la,na,Ca){2===la?(la=na,na=Ca):la=Ca;return{ato:na,ggl:la}}bem(la){const na=la.input,Ca=na.Z8,Na=na.qTa;la.output.gM=(2===na.Lga?Ca:Na).p4();la.runtime.sG("InitializeOutputMergeState");la.logger.Cga("InitializeOutputMergeState");return!0}Qak(la){var na=la.input.gm;const Ca=la.runtime.Ym,Na=la.output.gM;na=this.PUk(la,Na.ig(Na.length-1),na,
z.a.create());this.qhl(la,na,Ca);Na.add(na);return la.output.succeeded=!0}PUk(la,na,Ca,Na){la.runtime.Wbe&&k.a.instance.Sa(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Ca,Na);la=this.cNn(Na);la.brk(na,Ca);return la}qhl(la,na,Ca){la.runtime.Wbe&&k.a.instance.Sa(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",Ca.count);Ca.forEach((Na,Ta)=>{na.jck(Ta.rm);return!0})}gGb(la){if(!la)return k.a.instance.Sa(573957952,1,2,"Feature helper is null"),
!1;la.ez(106);return la.isFeatureEnabled(106)}mjn(la){if(!this.gGb(la.runtime.$b))return!0;const na=la.runtime.uu,Ca=la.runtime.vq,Na=la.runtime.nk;let Ta=!0;na.forEach((Fa,qa)=>{393252===qa.Rc&&(Ta=this.YMi(la,Fa,qa,Na,na));return Ta});if(!Ta)return!1;Ca.forEach((Fa,qa)=>{393252===qa.Rc&&(Ta=this.YMi(la,Fa,qa,Na,Ca));return Ta});la.logger.Cga("PreProcessTableStructure");return Ta}YMi(la,na,Ca,Na,Ta){const Fa=null==this.Yd.getPropertyBool(Ca,e.a.ghostCell)?!1:this.Yd.getPropertyBool(Ca,e.a.ghostCell),
qa=null==this.Yd.getPropertyUint32(Ca,e.a.rowSpan)?1:this.Yd.getPropertyUint32(Ca,e.a.rowSpan),ja=null==this.Yd.getPropertyUint32(Ca,e.a.colSpan)?1:this.Yd.getPropertyUint32(Ca,e.a.colSpan);if(Fa)return!0;var X=Na.J(na);if(X){Na=null==this.Yd.getPropertyBool(X,e.a.ghostCell)?!1:this.Yd.getPropertyBool(X,e.a.ghostCell);var ua=null==this.Yd.getPropertyUint32(X,e.a.rowSpan)?1:this.Yd.getPropertyUint32(X,e.a.rowSpan);var Ha=null==this.Yd.getPropertyUint32(X,e.a.colSpan)?1:this.Yd.getPropertyUint32(X,
e.a.colSpan);Na=Na!==Fa;ua=ua!==qa;Ha=Ha!==ja}else Ha=ua=Na=!0;const Ea=da.e(la,Ca,Ta);if(Ea.equals(z.a.nil))return k.a.instance.Sa(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",na),la.logger.Vg(Object.assign(new ra.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let wa=la.runtime.fzb.J(Ea);wa||(la.runtime.fzb.Z(Ea,new A.a),wa=la.runtime.fzb.J(Ea));let sa=wa.J(na),fa=new v.a;const Ma=new v.a,Ua=new v.a;Na&&(sa||(fa=this.Yd.getPropertyObjectIds(Ca,
a.a.gf)));if(ua||Ha)if(sa){if(sa.pg)return k.a.instance.Sa(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),la.logger.Vg(Object.assign(new ra.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=sa.rowSpan&&qa!==sa.rowSpan||null!=sa.colSpan&&ja!==sa.colSpan)return k.a.instance.Sa(573957962,1,4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),la.logger.Vg(Object.assign(new ra.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),
!1}else{var Qa;({rowIndex:Ca,z0b:Qa}=da.b(la,Ta,Ca));if(-1===Ca||-1===Qa)return k.a.instance.Sa(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",na),la.logger.Vg(Object.assign(new ra.a,{info:"Table cell location could not be found"})),!1;for(var Ja=Ca;Ja<Ca+qa;Ja++)for(var Wa=Qa;Wa<Qa+ja;Wa++){var Ya=da.c(la,Ea,Ja,Wa);if(Ya.equals(z.a.nil))return k.a.instance.Sa(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),la.logger.Vg(Object.assign(new ra.a,
{info:"Ghost cell not found in the table bounds"})),!1;var sb=Ta.Ty(Ya,la.runtime.nk.J(Ya));if(!sb)return k.a.instance.Sa(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),la.logger.Vg(Object.assign(new ra.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!Ya.equals(na)){if(null==this.Yd.getPropertyBool(sb,e.a.ghostCell)||!this.Yd.getPropertyBool(sb,e.a.ghostCell))return k.a.instance.Sa(573957957,
1,4,"Other revision deleted some of the cells this revision is trying to merge"),la.logger.Vg(Object.assign(new ra.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var ob=wa.J(Ya);if(ob)return k.a.instance.Sa(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),la.logger.Vg(Object.assign(new ra.a,{info:"Ghost cell is already merged with some other cell"})),!1;Ma.add(Ya);ob=new ia;ob.pg=!0;sb=this.Yd.getPropertyUint32(sb,e.a.colSpan);
null!=sb&&(ob.colSpan=sb);wa.Z(Ya,ob)}}if(X&&(null==this.Yd.getPropertyBool(X,e.a.ghostCell)||!this.Yd.getPropertyBool(X,e.a.ghostCell))&&(Ta=null==this.Yd.getPropertyUint32(X,e.a.rowSpan)?1:this.Yd.getPropertyUint32(X,e.a.rowSpan),Ca=null==this.Yd.getPropertyUint32(X,e.a.colSpan)?1:this.Yd.getPropertyUint32(X,e.a.colSpan),Ta>qa||Ca>ja)){Ja=Qa=-1;({rowIndex:Qa,z0b:Ja}=da.a(la,null,X,Qa,Ja));if(-1===Qa||-1===Ja)return k.a.instance.Sa(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",
na),la.logger.Vg(Object.assign(new ra.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;X=Ma.tG();for(Wa=Qa;Wa<Qa+Ta;Wa++)for(Ya=Ja;Ya<Ja+Ca;Ya++){ob=da.d(la,null,Ea,Wa,Ya);if(!ob)return k.a.instance.Sa(573957960,1,2,"Table cell could not be found within table bounds"),la.logger.Vg(Object.assign(new ra.a,{info:"Ghost cell not found in the table bounds"})),!1;ob.id.equals(na)||X.contains(ob.id)||Ua.add(ob.id)}}}!sa&&(Na||ua||Ha)&&(k.a.instance.Sa(573957963,
1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",na),sa=new ia,sa.rowSpan=qa,sa.colSpan=ja,sa.pg=Fa,sa.T_d=fa,sa.pof=Ma,sa.QIf=Ua,wa.add(na,sa));return!0}uro(la){return this.Blj(la,!1)}Shl(la){return this.Blj(la,!0)}Blj(la,na){const Ca=la.runtime,Na=Ca.nk,Ta=Ca.uu,Fa=na?Ca.o7e:Ca.vq,qa=Ca.Ym;let ja=!0;const X=la.runtime.G3c;let ua=0,Ha=0,Ea=0;Fa.forEach((wa,sa)=>{X&&k.a.instance.Sa(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
wa,sa.Rc,na);Ha++;this.NSg===Ha&&(ua++,la.runtime.sG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",ua,Ea,na)),Ha=0);if(la.runtime.$b&&la.runtime.$b.CDb(1000005)&&la.runtime.xhc.contains(sa.id,(Ua,Qa)=>Ua.equals(Qa))||this.Sbo(sa.Rc))return!0;if(!na&&this.M0k(sa.Rc,la.runtime.$b))return Ca.o7e.Z(wa,sa),!0;var fa=Ta.get(wa);if(!fa)return qa.ub(wa)?qa.J(wa).Wxi(sa):qa.Z(wa,new ha.a(sa,!1)),!0;if(!Na.J(wa)&&!this.iUm(fa.Rc)){var Ma=!!la.input.Z8&&!!la.input.Z8.last()&&
la.input.Z8.last().w3(wa);const Ua=!!la.input.qTa&&!!la.input.qTa.last()&&la.input.qTa.last().w3(wa),Qa=new V.a(fa,sa);if(!Qa.qX)return qa.Z(wa,new ha.a(fa,!1)),!0;k.a.instance.Sa(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",wa,sa.Rc,na,Ma,Ua,!Qa.qX,la.input.source);la.logger.Vg(Object.assign(new M.a,{tj:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return ja=!1}Ma=qa.Ty(wa,new ha.a(Na.J(wa)));({Sk:fa,returnValue:ja}=this.Q0l.merge(la,this.w8h,this.Yd,Ma,fa,sa));Ea++;ja&&(la.runtime.sG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",wa,sa.Rc,Ea,ua,na)),fa&&(qa.ub(fa.rm.id)?qa.J(fa.rm.id).Wxi(fa.rm):qa.Z(fa.rm.id,fa)));return ja});la.logger.Cga("ObjectMerge");X&&k.a.instance.Sa(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Fa.count,
Ea,na);return ja}uEo(la){try{for(let na=0;na<la.runtime.oZd.length;na++){const Ca=la.runtime.oZd.J(na);if(la.runtime.Ym.J(Ca)){if(!this.Krm(la,Ca))return!1}else k.a.instance.Sa(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");la.runtime.sG("Validate markers taking too long")}}catch(na){k.a.instance.Sa(559535579,1,2,"ValidateMerge threw an exception: {0}",na)}return la.logger.JUc.l$h()?!1:!0}f8n(la){return 38===la||39===la||40===la||41===la||44===la||45===la||33===la||34===la?!1:
!0}yJl(la){switch(la){case 38:case 39:case 40:case 41:return e.a.oe;case 44:case 45:return e.a.Twd;case 33:case 34:return e.a.Wj}return I.CommonProperties.nil}tEo(la,na){const Ca=this.Yd.getPropertyUint32(la,e.a.Qq);if(!Ca||this.f8n(Ca))return!0;la=this.Yd.getPropertyObjectId(la,this.yJl(Ca));return za.W4b(na,la)?!0:(na.logger.JUc.pRd=Ca,!1)}Krm(la,na){if(la.runtime.dPf.contains(na))return!1;if(na=za.W4b(la,na)){na=this.Yd.getPropertyObjectIds(na,a.a.An);for(let Ca=0;Ca<na.length;Ca++){const Na=za.W4b(la,
na.ig(Ca));if(Na&&!this.tEo(Na,la))return!1}}return!0}Sbo(la){switch(la){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}M0k(la,na){let Ca=!1;if(1074135145===la)return!0;na&&na.ez(125);na&&na.isFeatureEnabled(125)&&1074135153===la&&(Ca=!0);return Ca}iUm(la){switch(la){case 1074135162:return!0}return!1}YWk(la,na){const Ca=new v.a,Na=new v.a,Ta=new v.a;var Fa=la.runtime.LBa;const qa=Fa?Fa.id:z.a.nil;this.LBf(Fa).forEach(ja=>{Ca.add(na(ja));
return!0});Fa=la.input.Z8.ig(la.input.Z8.length-1);this.LBf(Fa,qa).forEach(ja=>{Na.add(na(ja));return!0});la=la.input.qTa.ig(la.input.qTa.length-1);this.LBf(la,qa).forEach(ja=>{Ta.add(na(ja));return!0});return{Bqk:Ca,Elo:Na,yKo:Ta}}LBf(la,na=null){const Ca=new v.a;na||(na=z.a.nil);for(;la&&!na.equals(la.id);)Ca.add(la),la=la.rW;Ca.reverse();return Ca}Qho(la){const na=3===this.DNd;let Ca=!1;!la.output.succeeded&&(2===this.DNd||la.output.crash&&1===this.DNd)&&(Ca=!0);let Na=!1;la.input.Z8&&0<la.input.Z8.length&&
(na||Ca)&&la.runtime.uu&&la.runtime.nk&&la.runtime.$b&&(Na=la.runtime.$b.isFeatureEnabled(49));return Na}vgi(la){return 9===J.a.jDb(J.a.Ref(la))}Fli(la){return 8===J.a.jDb(J.a.Ref(la))}static jEl(la){return la.output.crash?2:la.output.succeeded?3:1}static W4b(la,na){if(!na||na===z.a.nil)return null;const Ca=la.runtime.Ym.J(na);return Ca?Ca.rm:la.runtime.nk.J(na)}}za.CNd=z.a.Gf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(D.a)(za,"GraphMergerBase",null,[1360])},1719:function(D,L,c){D=c(0);var l=
c(228),e=c(1581),a=c(154),k=c(1506);class m extends e.a{constructor(v,r,z,A,G,H,I,K,F,J,N,O,M,T){super(v,3,r,z,A,G,H,K,F,J,N,O,M,T);this.yoe=I}get character(){return this.yoe}get text(){return this.character.toString()}j3c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}s4b(){return"CharRun"}clone(){return new m(this.UAc,this.source,this.Jj,this.Bg,this.runId,this.xI,this.character,this.gkb,this.hPa,this.Iaa,this.vDa,this.UQa,this.NE,this.Mt)}bA(v,r,z,A=!1){return super.bA(v,
r,z,A)?v.character===this.character?!0:k.a.tjh(v.character,this.character):!1}}Object(D.a)(m,"CharRunMergeBlock",e.a,[]);c.d(L,"a",function(){return w});class w extends e.a{constructor(v,r,z,A,G,H,I,K,F,J,N,O,M,T,R){super(v,1,r,z,A,G,H,K,J,N,O,M,T,R);this._text=I;this.uNe=F}get text(){return this._text}j3c(v){this._text=v}get U5a(){return this.uNe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.uNe)}s4b(){return"TextRun"}clone(){return new w(this.UAc,
this.source,this.Jj,this.Bg,this.runId,this.xI,this._text,this.gkb,this.uNe,this.hPa,this.Iaa,this.vDa,this.UQa,this.NE,this.Mt)}bA(v,r,z,A=!1){return super.bA(v,r,z,A)?k.a.sjh(this._text,v._text):!1}A4c(){const v=new l.a;for(let z=0;z<this.text.length;z++){var r=k.a.charAt(this._text,z);if(k.a.Ywm(k.a.Mmo(r))){let A="";A+=r;r=k.a.charAt(this._text,++z);A+=r;r=new w(this.UAc,this.source,this.Jj,this.Bg,this.runId,this.xI,A,this.gkb,!1,this.hPa,this.Iaa,this.vDa,this.UQa,this.NE,this.Mt);v.add(r)}else r=
new m(this.UAc,this.source,this.Jj,this.Bg,this.runId,this.xI,r,this.gkb,this.hPa,this.Iaa,this.vDa,this.UQa,this.NE,this.Mt),v.add(r)}return v}}Object(D.a)(w,"TextRunMergeBlock",e.a,[])},1720:function(D,L,c){D=c(0);var l=c(990),e=c(17),a=c(412),k=c(228);c(61);c(797);var m=c(621),w=c(152),v=c(154),r=c(1012),z;(function(K){K[K.none=0]="none";K[K.browser=1]="browser";K[K.serverPutChanges=2]="serverPutChanges";K[K.syncDiff=3]="syncDiff";K[K.docxMerge=4]="docxMerge";K[K.undo=5]="undo"})(z||(z={}));Object(D.b)("GraphMergeSource",
z);var A=c(1707),G=c(1519),H=c(1701);c.d(L,"a",function(){return I});class I{constructor(K){this.vA=new r.a;this.GV=new a.a;this.M8g=new a.a(0);this.l$c=new k.a;this.yNg=new k.a;this.gXg=new k.a;this.AUg=new k.a;this.rWg="";this.LUa=null;this.Qr=this.zBe=0;this.emd=new a.a(0);this.Ute=this.H_g=this.Pid=0;const {MarkerValidation:F}=c(1819);this._state=K;this.oUj=new F}get JUc(){return this.oUj}get oPi(){return this.LUa}L1n(K){this.zBe=K}UXd(K,F){this.rWg=String.format("{0}-{1}",K,F)}Jae(K){this.FFk();
this.Ute=K}L2f(){this.Ute=0}FFk(){this.LUa&&this.l$c.add(this.LUa);this.LUa=null}Vg(K){this.LUa||(this.LUa=K);switch(this.Ute){case 1:this.yNg.add(K);break;case 2:this.gXg.add(K);break;case 3:this.AUg.add(K);break;default:this.LUa&&this.l$c.add(K)}}Zsi(K){this.l$c.add(K)}ZKm(){this.Qr=this.UCa();this.Cga("MergeEnd")}Cga(K){const F=this.UCa();this.M8g.Z(K,F-this.zBe);this.zBe=F}M_n(){this.Pid=this.UCa();this.H_g++}dU(K){const F=this.UCa();let J;({value:J}=this.emd.Gc(K)).returnValue?(J+=F-this.Pid,
this.emd.Z(K,J)):this.emd.Z(K,F-this.Pid);this.Pid=F}NJl(){this.GV.Z("Id",this._state.input.JHb.toString());this.GV.Z("Source",z[this._state.input.source]);this.GV.Z("RevSummary",I.oTa(this.MRl()));this.GV.Z("NodesRolledBackIfFailed",I.oTa(this.JLl()));if(!this._state.output.succeeded){let K,F,J,N,O;({Eqk:K,igl:F,cto:J,Jqk:N,eto:O}=this.Xhl(this._state.runtime));this.GV.Z("CharactersLost",this.Pvl(K,F,J));this.GV.Z("CharactersLostInComments",this.Rwl());this.GV.Z("CharactersLostInTables",this.vsl(O,
N))}this.GV.Z("FuncStep",this.rWg);this.GV.Z("FailureDetail",I.oTa(this.pCb()));this.GV.Z("FailDetailHints",this.RJd(this.yNg));this.GV.Z("FailDetailNaiveMerge",this.RJd(this.gXg));this.GV.Z("FailDetailLcs",this.RJd(this.AUg));this.GV.Z("ExtraDetails",this.RJd(this.l$c));this.GV.Z("Timeline",I.oTa(this.M8g));this.GV.Z("ParagraphMergesCount",this.H_g);this.GV.Z("ParagraphMergeDurations",I.oTa(this.emd));this.GV.Z("MarkerInfo",I.oTa(this.JUc.SVh()));this.GV.Z("Result",I.oTa(this.PJl()));return JSON.stringify(I.oTa(this.GV))}UCa(){return(new Date).getTime()}MRl(){const K=
new a.a;let F,J,N;({u$f:F,Vfg:J,LBa:N}=this.Rjf(this._state,this._state.input.Z8,this._state.input.qTa,this._state.input.lEb));K.Z("hasBase",N?"true":"false");if(N){let O=0,M=0;for(;F&&!F.id.equals(N.id);)O++,F=F.rW;for(;J&&!J.id.equals(N.id);)M++,J=J.rW;K.Z("lenToBaseTheirs",F?O:-1);K.Z("lenToBaseYours",J?M:-1)}return K}Rjf(K,F,J,N){K=F.ig(F.length-1-(N?1:0));F=(J=J.ig(J.length-1))&&K?K.G_a(J):null;return{u$f:K,Vfg:J,LBa:F}}JLl(){if(!this._state.runtime.Adi)return null;const K=this._state.runtime.vq,
F=new a.a(0);K.forEach((J,N)=>{({value:J}=F.Gc(N.Rc.toString()));F.Z(N.Rc.toString(),J+1);return!0});return F}Pvl(K,F,J){let N=null,O=null,M=null;const T=this._state.runtime.vq;let R=0;try{M=new H.a(this.vA,this._state);N=G.b(K,F,J);O=new m.a;for(K=0;K<N.length;K++)if(!N.J(K).eyb.Qp(N.J(K).Bob,(W,V)=>W.equals(V))){const W=this.FFh(N.J(K),M);R+=W;O.add(N.J(K))}N&&T.forEach((W,V)=>{if(393230===V.Rc){V=null;for(let ba=0;ba<N.length;ba++)if(!O.contains(N.J(ba))&&N.J(ba).Bob.contains(W,(ha,ca)=>ha===ca)){V=
N.J(ba);break}V&&(W=this.FFh(V,M),O.add(V),R+=W)}return!0});return R}catch(W){return w.a.instance.Sa(579190992,1,2,"Exception in GetCharactersLost: "+W.toString()),-1}}Xhl(K){let F,J,N,O,M;K.sG=R=>{if(750<this.UCa()-this._state.input.nSa)throw w.a.instance.Sa(579190991,1,2,"Timed out while calculating characters lost: {0}",R),v.a.invalidOperation(R);};F=new k.a;J=new k.a;N=new k.a;O=new k.a;const T=new k.a;M=new k.a;try{if(K.nk){const R=K.nk.J(A.ChildNodeListMerge.h3d);let W,V;W=K.uu.J(A.ChildNodeListMerge.h3d)||
R;V=K.vq.J(A.ChildNodeListMerge.h3d)||R;this.Jcf(R,ba=>K.nk.J(ba),F,O);this.Jcf(W,ba=>K.uu.J(ba)||K.nk.J(ba),J,T);this.Jcf(V,ba=>K.vq.J(ba)||K.nk.J(ba),N,M)}}catch(R){w.a.instance.Sa(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+R.toString())}return{Eqk:F,igl:J,cto:N,Jqk:O,eto:M}}vsl(K,F){try{let N=0;const O=this._state.runtime;var J=R=>O.vq.J(R)||O.nk.J(R);const M=new m.a,T=this.Ijl(K,O,J,M);for(K=0;K<T.count;K++){let R=T.keys.J(K);const W=T.J(R);if(!M.contains(R)){let V=this.n5h(O,
J,M,R,W);if(-1!==V)N+=V;else return w.a.instance.Sa(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(J=0;J<F.length;J++){let R=F.J(0);if(!M.contains(R)){let W=this.WMd(O.nk.J(R));if(-1===W)return w.a.instance.Sa(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;N+=W}}return N}catch(N){return w.a.instance.Sa(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+N.toString()),-1}}n5h(K,F,J,N,O){K.sG("GetTableCharactersLost");
let M=0;O=this.vA.getPropertyObjectIds(O,e.a.gf);for(let ba=0;ba<O.length;ba++){var T=F(O.J(ba));T=this.vA.getPropertyObjectIds(T,e.a.gf);for(let ha=0;ha<T.length;ha++){var R=F(T.J(ha));if(K.nk.J(O.J(ba))&&K.nk.J(T.J(ha))){var W=K.nk.J(T.J(ha));if(!W)return w.a.instance.Sa(573089737,1,2,"Base cell unexpectedly null"),-1;R=this.vA.getPropertyObjectIds(W,e.a.gf);var V=K.uu.J(T.J(ha))||K.nk.J(T.J(ha));V=this.vA.getPropertyObjectIds(V,e.a.gf);W=this.vA.getPropertyObjectIds(W,e.a.gf);R=G.b(R,V,W);for(W=
0;W<R.length;W++){V=R.J(W);const ca=this.hWl(K,F,J,V);if(-1===ca)return w.a.instance.Sa(573089738,1,2,"Error getting characters lost for parition {0}",V.toString()),-1;M+=ca}}else{W=this.QWl(F,R,J);if(-1===W)return w.a.instance.Sa(573089736,1,2,"Error getting text length of cell {0}",R.id.toString()),-1;M+=W}}}J.add(N);return M}hWl(K,F,J,N){let O=0;var M=new k.a,T=new k.a;const R=new a.a;new a.a;for(var W=0;W<N.eyb.length;W++){var V=K.nk.J(N.eyb.J(W));V=this.vA.getPropertyObjectIds(V,e.a.FL);if(1!==
V.length)return w.a.instance.Sa(573089739,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;var ba=K.nk.J(V.J(0));393230===ba.Rc?M.add(ba):393250===ba.Rc&&R.add(V.J(0),ba)}for(W=0;W<N.Bob.length;W++){V=F(N.Bob.J(W));V=this.vA.getPropertyObjectIds(V,e.a.FL);if(1!==V.length)return w.a.instance.Sa(573089740,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;ba=F(V.J(0));if(393230===ba.Rc)T.add(ba);else if(393250===ba.Rc){ba=this.n5h(K,F,J,V.J(0),ba);if(-1===ba)return w.a.instance.Sa(573089741,
1,2,"Error diffing table {0}",V.J(0).toString()),-1;O+=ba}}W=new H.a(this.vA,this._state);if(0<M.length&&0<T.length){M=W.uNh(M,ha=>K.nk.J(ha),T,ha=>F(ha));if(-1===M)return w.a.instance.Sa(573089742,1,2,"Problem diffing parition {0} with LCS",N.toString()),-1;O+=M}else if(0<M.length)for(N=0;N<M.length;N++)O+=this.vA.getPropertyString(M.J(N),e.a.Co).length+1;else if(0<T.length)for(N=0;N<T.length;N++)O+=this.vA.getPropertyString(T.J(N),e.a.Co).length+1;for(N=0;N<R.count;N++)if(M=R.keys.J(N),!J.contains(M)){T=
this.WMd(R.J(M));if(-1===T)return w.a.instance.Sa(573089743,1,2,"Error getting length of table {0}",M.toString()),-1;O+=T}return O}QWl(K,F,J){let N=0;F=this.vA.getPropertyObjectIds(F,e.a.gf);for(let T=0;T<F.length;T++){var O=K(F.J(T));O=this.vA.getPropertyObjectIds(O,e.a.FL);if(1!==O.length)return w.a.instance.Sa(573089744,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var M=K(O.J(0));if(393230===M.Rc)N+=this.vA.getPropertyString(M,e.a.Co).length+1;else if(393250===M.Rc){M=this.WMd(M);
if(-1===M)return w.a.instance.Sa(573089745,1,2,"Problem finding text length of table {0}",O.J(0).toString()),-1;N+=M;J.add(O.J(0))}}return N}WMd(K){this._state.runtime.sG("GetTextLengthOfTable");let F=0;const J=R=>this._state.runtime.vq.J(R)||this._state.runtime.nk.J(R);K=this.vA.getPropertyObjectIds(K,e.a.gf);for(let R=0;R<K.length;R++){var N=J(K.J(R));N=this.vA.getPropertyObjectIds(N,e.a.gf);for(let W=0;W<N.length;W++){var O=J(N.J(W));O=this.vA.getPropertyObjectIds(O,e.a.gf);for(let V=0;V<O.length;V++){var M=
J(O.J(V));M=this.vA.getPropertyObjectIds(M,e.a.FL);if(1!==M.length)return w.a.instance.Sa(573089746,1,2,"Unexpected number of ContentNodes: {0}",M.length),-1;var T=J(M.J(0));if(393230===T.Rc)F+=this.vA.getPropertyString(T,e.a.Co).length+1;else if(393250===T.Rc){T=this.WMd(T);if(-1===T)return w.a.instance.Sa(573089747,1,2,"Error finding the text length of table {0}",M.J(0)),-1;F+=T}}}}return F}Ijl(K,F,J,N){const O=new a.a;for(let M=0;M<K.length;M++){let T=!1;F.vq.J(K.J(M))&&(T=!0);const R=J(K.J(M)),
W=this.vA.getPropertyObjectIds(R,e.a.gf);if(!T)for(let V=0;V<W.length;V++)if(F.vq.J(W.J(V))){T=!0;break}T?O.add(K.J(M),R):N.add(K.J(M))}return O}FFh(K,F){return this.EFh(K.eyb,K.Bob,F)}EFh(K,F,J){const N=new k.a;for(var O=0;O<K.length;O++)N.add(this._state.runtime.nk.J(K.J(O)));K=new k.a;for(O=0;O<F.length;O++)K.add(this._state.runtime.vq.J(F.J(O))||this._state.runtime.nk.J(F.J(O)));return J.uNh(N,M=>this._state.runtime.nk.J(M),K,M=>this._state.runtime.vq.J(M)||this._state.runtime.nk.J(M))}Jcf(K,
F,J,N){if(393227===K.Rc){K=this.vA.getPropertyObjectIds(K,e.a.gf);for(let O=0;O<K.length;O++){const M=this.vA.getPropertyObjectIds(F(K.J(O)),e.a.gf);for(let T=0;T<M.length;T++){const R=this.vA.getPropertyObjectIds(F(M.J(T)),e.a.gf);for(let W=0;W<R.length;W++){const V=this.vA.getPropertyObjectIds(F(R.J(W)),e.a.FL);if(1!==V.length)return;const ba=F(V.J(0));393230===ba.Rc?J.add(V.J(0)):393250===ba.Rc?N.add(V.J(0)):w.a.instance.Sa(573089748,1,2,"Unsupported class id in GetCharactersLost: "+l.a[ba.Rc])}}}}}Kcf(K,
F){K=this.vA.getPropertyObjectIds(K,e.a.gf);const J=new k.a;for(let N=0;N<K.length;N++){const O=this.vA.getPropertyObjectIds(F(K.J(N)),e.a.FL);if(1!==O.length)return null;J.add(O.J(0))}return J}Rwl(){let K=0;const F=this._state.runtime,J=F.vq,N=M=>F.vq.J(M)||F.nk.J(M);let O=null;F.sG=M=>{if(750<this.UCa()-this._state.input.nSa)throw w.a.instance.Sa(573089749,1,2,"Timed out while calculating comment characters lost: {0}",M),v.a.invalidOperation(M);};try{J.forEach((M,T)=>{if(1074135127===T.Rc){M=this.Kcf(T,
N);var R=F.nk.J(T.id);if(R)R=this.Kcf(R,V=>F.nk.J(V)),O||(O=new H.a(this.vA,this._state)),K+=this.EFh(R,M,O);else for(R=0;R<M.length;R++)K+=this.vA.getPropertyString(F.vq.J(M.J(R)),e.a.Co).length+1}if(1074135126===T.Rc&&(M=this.vA.getPropertyObjectIds(T,e.a.gf).tG(),T=F.nk.J(T.id)))for(T=this.vA.getPropertyObjectIds(T,e.a.gf),R=0;R<T.length;R++)if(!M.contains(T.J(R))){var W=F.nk.J(T.J(R));W=this.Kcf(W,V=>F.nk.J(V));for(let V=0;V<W.length;V++)K+=this.vA.getPropertyString(F.nk.J(W.J(V)),e.a.Co).length+
1}return!0})}catch(M){return w.a.instance.Sa(573089750,1,2,"Exception in GetCommentCharactersLost: "+M.toString()),-1}return K}pCb(){return this.LUa?this.LUa.pCb():null}RJd(K){const F=new k.a;K.forEach(J=>{F.add(I.oTa(J.pCb()));return!0});return F.toArray()}PJl(){const K=new a.a;K.Z("Succeeded",this._state.output.succeeded);K.Z("Timeout",this._state.output.timeout);K.Z("Crash",this._state.output.crash);K.Z("MergedRevisions",this._state.output.gM?this._state.output.gM.length:-1);K.Z("Duration",this.Qr-
this._state.input.nSa);return K}static oTa(K){if(!K)return null;const F={};K.forEach((J,N)=>{F[J.toString()]=N;return!0});return F}}Object(D.a)(I,"MergeLogger",null,[])},1721:function(D,L,c){D=c(0);var l=c(231),e=c(17),a=c(7),k=c(124),m=c(797),w=c(152),v=c(228),r=c(412),z=c(1452);class A{constructor(I,K,F){this.position=I;this.leader=K;this.val=F}equals(I){return this.position===I.position&&this.leader===I.leader&&this.val===I.val}toString(){return this.position.toString()}}Object(D.a)(A,"TabStop",
null,[]);var G=c(1820);c.d(L,"a",function(){return H});class H extends z.a{constructor(){super()}get Gn(){return 20}get Qz(){return 0}qk(){const I=super.qk();I.Z(m.a.zb(e.a.Co),1);I.Z(m.a.zb(e.a.An),1);I.Z(m.a.zb(e.a.vm),1);I.Z(m.a.zb(a.a.rt),1);I.Z(m.a.zb(a.a.Sq),1);I.Z(m.a.zb(a.a.Pc),1);I.Z(m.a.zb(e.a.vnb),1);I.Z(m.a.zb(a.a.cOa),1);I.Z(m.a.zb(a.a.IFa),1);I.Z(m.a.zb(e.a.iwa),1);I.Z(m.a.zb(a.a.SDa),1);I.Z(m.a.zb(a.a.Wea),1);I.Z(m.a.zb(a.a.TDa),1);I.Z(m.a.zb(a.a.qCa),1);I.Z(m.a.zb(a.a.UDa),1);I.Z(m.a.zb(a.a.rCa),
1);I.Z(m.a.zb(a.a.HFa),1);I.Z(m.a.zb(a.a.fHa),1);I.Z(m.a.zb(a.a.gHa),1);I.Z(m.a.zb(a.a.Yxa),1);I.Z(m.a.zb(a.a.ov),1);I.Z(m.a.zb(a.a.gy),1);I.Z(m.a.zb(a.a.hy),1);I.Z(m.a.zb(a.a.yv),1);I.Z(m.a.zb(k.a.CK),6);I.Z(m.a.zb(k.a.lTa),6);I.Z(m.a.zb(a.a.Vyb),7);I.Z(m.a.zb(k.a.CK),6);I.Z(m.a.zb(a.a.Mcj),2);I.Z(m.a.zb(k.a.iNk),2);I.Z(m.a.zb(k.a.Hdn),2);I.Z(m.a.zb(a.a.fjc),2);I.Z(m.a.zb(a.a.m6c),2);I.Z(m.a.zb(a.a.hOb),2);I.Z(m.a.zb(a.a.o6a),2);I.Z(m.a.zb(a.a.n6c),2);I.Z(m.a.zb(a.a.o6c),2);I.Z(m.a.zb(a.a.lockNotFullySupportedParagraphInBlockContentControl),
2);I.Z(m.a.zb(a.a.listID),3);I.Z(m.a.zb(a.a.listLevel),3);return I}rB(I,K){if(K===m.a.zb(e.a.Co)||K===m.a.zb(e.a.An)||K===m.a.zb(e.a.vm)||K===m.a.zb(a.a.rt)||K===m.a.zb(a.a.Sq)||K===m.a.zb(a.a.Pc)||K===m.a.zb(e.a.vnb)||K===m.a.zb(a.a.cOa)||K===m.a.zb(a.a.IFa)||K===m.a.zb(e.a.iwa)||K===m.a.zb(a.a.SDa)||K===m.a.zb(a.a.Wea)||K===m.a.zb(a.a.TDa)||K===m.a.zb(a.a.qCa)||K===m.a.zb(a.a.UDa)||K===m.a.zb(a.a.rCa)||K===m.a.zb(a.a.HFa)||K===m.a.zb(a.a.fHa)||K===m.a.zb(a.a.gHa)||K===m.a.zb(a.a.Yxa)||K===m.a.zb(a.a.ov)||
K===m.a.zb(a.a.EM)){var F=I.nn.value.Eu,J=I.nn.value.Af;K=I.Sg.value.Af;if(I.Ip.runtime.$La.contains(F.id))return w.a.instance.Sa(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",F.id),!0;if(I.Ip.runtime.$b.CDb(1000005)&&this.Zbo(I,K,J))return I.Sk=K.aH(),H.cdh(I),H.Vud(I.Ip,I.Yd,J),!0;const N=new v.a;N.add(F);F=new v.a;F.add(J);J=new v.a;J.add(K);if(!({Ym:K}=H.Flj(I.Ip,N,J,F)).returnValue)return I.Teg=!0,I.Sk=null,!1;
H.cdh(I);I.Sk=K.ig(0).rm;return!0}return K===m.a.zb(a.a.gy)||K===m.a.zb(a.a.hy)||K===m.a.zb(a.a.yv)?(this.jqo(I),I.xg.add(m.a.zb(a.a.gy)),I.xg.add(m.a.zb(a.a.hy)),I.xg.add(m.a.zb(a.a.yv)),!0):!1}Zbo(I,K,F){K=I.Yd.getPropertyString(K,a.a.EM);I=I.Yd.getPropertyString(F,a.a.EM);return K||I?!0:!1}jqo(I){const K=I.Yd,F=I.Sk;var J=I.nn.value.Af,N=I.Sg.value.Af;I=this.Shf(I.nn.value.Eu,K);N=this.Shf(N,K);J=this.Shf(J,K);({lUm:J,mUm:I,nUm:N}=this.RJl(I,N,J));J.length?(K.setPropertyUint32s(F,a.a.yv,J),K.setPropertyUint32s(F,
a.a.gy,I),K.setPropertyUint32s(F,a.a.hy,N)):this.$Cn(F)}Shf(I,K){const F=K.getPropertyUint32s(I,a.a.yv),J=K.getPropertyUint32s(I,a.a.gy);I=K.getPropertyUint32s(I,a.a.hy);K=new v.a;if(!F)return K;for(let N=0;N<F.length;++N)K.add(new A(F.J(N),J.J(N),I.J(N)));return K}RJl(I,K,F){({SIi:K,TIi:M,UIi:O}=this.BVh(I,K));let J,N;({SIi:F,TIi:J,UIi:N}=this.BVh(I,F));I=this.o2l(I,M,O,J,N);var O=this.n2l(I,K,F);I=new v.a;K=new v.a;var M=new v.a;for(F=0;F<O.length;++F)I.add(O.J(F).position),K.add(O.J(F).leader),
M.add(O.J(F).val);return{lUm:I,mUm:K,nUm:M}}BVh(I,K){let F,J,N;F=new v.a;J=new r.a;N=new r.a;let O,M;for(O=M=0;O<I.length&&M<K.length;)I.J(O).position===K.J(M).position?(I.J(O).equals(K.J(M))||N.Z(I.J(O).position,K.J(M)),++O,++M):I.J(O).position<K.J(M).position?(J.Z(I.J(O).position,I.J(O)),++O):(F.add(K.J(M)),++M);for(;O<I.length;)J.Z(I.J(O).position,I.J(O)),++O;for(;M<K.length;)F.add(K.J(M)),++M;return{SIi:F,TIi:J,UIi:N}}o2l(I,K,F,J,N){const O=new v.a;for(let M=0;M<I.length;++M){const T=I.J(M).position;
K.ub(T)||(F.ub(T)?O.add(F.J(T)):J.ub(T)||(N.ub(T)?O.add(N.J(T)):O.add(I.J(M))))}return O}n2l(I,K,F){K=this.Uxi(K,F);return this.Uxi(I,K)}Uxi(I,K){const F=new v.a;let J,N;for(J=N=0;J<I.length&&N<K.length;)I.J(J).position<=K.J(N).position?(F.add(I.J(J)),I.J(J).position===K.J(N).position&&++N,++J):F.add(K.J(N++));for(;J<I.length;)F.add(I.J(J++));for(;N<K.length;)F.add(K.J(N++));return F}$Cn(I){I.removeProperty(a.a.yv);I.removeProperty(a.a.gy);I.removeProperty(a.a.hy)}static nh(){return new H}static get instance(){return H.Pg.value}static cdh(I){I.xg.add(m.a.zb(e.a.Co));
I.xg.add(m.a.zb(e.a.An));I.xg.add(m.a.zb(e.a.vm));I.xg.add(m.a.zb(a.a.rt));I.xg.add(m.a.zb(a.a.Sq));I.xg.add(m.a.zb(a.a.Pc));I.xg.add(m.a.zb(e.a.vnb));I.xg.add(m.a.zb(a.a.cOa));I.xg.add(m.a.zb(a.a.IFa));I.xg.add(m.a.zb(e.a.iwa));I.xg.add(m.a.zb(a.a.SDa));I.xg.add(m.a.zb(a.a.Wea));I.xg.add(m.a.zb(a.a.TDa));I.xg.add(m.a.zb(a.a.qCa));I.xg.add(m.a.zb(a.a.UDa));I.xg.add(m.a.zb(a.a.rCa));I.xg.add(m.a.zb(a.a.HFa));I.xg.add(m.a.zb(a.a.fHa));I.xg.add(m.a.zb(a.a.gHa));I.xg.add(m.a.zb(a.a.Yxa));I.xg.add(m.a.zb(a.a.ov));
I.xg.add(m.a.zb(a.a.EM))}static Flj(I,K,F,J){return(new G.a(I,K,F,J)).ojc()}static Vud(I,K,F){F=K.getPropertyObjectIds(F,e.a.An);for(let N=0;N<F.length;N++){var J=I.runtime.vq.J(F.ig(N));if(J&&(J=K.getPropertyObjectId(J,a.a.oe))){I.runtime.xhc.add(J);break}}}}H.Pg=new l.a(H.nh);Object(D.a)(H,"ParagraphNodeComplexMerge",z.a,[])},1722:function(D,L,c){D=c(0);var l=c(82),e=c(1459),a=c(1575),k=c(1507),m=c(1477),w=c(1522),v=c(1460),r=c(1464),z=c(1463),A=c(1457),G=c(1456);class H{constructor(ba){this.oc=
ba;this.Wqd=this.Tmf()}uK(){return"Add-ins"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?1:3}qH(ba,ha){ba=new z.a(ba);ha.resultsUpdated(ba)}Zgb(ba,ha,ca){let ia;ia=this.oc.zO?new r.a(27):new r.a(25);ia.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ca&&this.Iao(ba.Ig,ha,ia)}Iao(ba,ha,ca){const ia=[];let ra;ra=this.oc.Gjm?this.oc.zO&&this.oc.wcb?G.a.Sfb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,ba)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,
ba):this.oc.Hjm?this.oc.zO&&this.oc.wcb?G.a.Sfb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,ba)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,ba):this.oc.zO&&this.oc.wcb?G.a.Sfb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,ba)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,ba);this.oc.Xua?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ra)),
A.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ba))):(ia.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ra)),ia.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ba)),appChrome.api.dispatch(ia));ca.Ly(new v.a("LaunchAddinDialogFromTellMe",28));ha.Lv(ca)}Tmf(){const ba=[];this.oc.MRd&&Array.add(ba,"Addin");return ba}}Object(D.a)(H,"AddinStoreResultsProvider",null,[1099]);var I=c(1673),K=c(1493),
F=c(1508),J=c(1674),N=c(1708),O=c(1675),M=c(1521),T=c(2),R=c(33),W=c(119);c.d(L,"a",function(){return V});class V{constructor(ba,ha,ca){this.Xxc=this.cqd=this.dqd=this.bqd=!1;this.hP=null;this.Y0=-1;this.vka=this.wyc=null;this.Lyc="";this.qtb=0;this.oc=ba;const ia=G.a.mga();this.l9a=ha||[];this.rg=T.AFrameworkApplication.Ve;this.S5g=ba.cOf;this.eqd=ba.bOf;this.GLe=ia&&this.KMb();this.HLe=ia&&this.LMb();this.q2j=ia&&this.MMb();this.JLe=this.OMb();this.U5g=this.Tgc();ba.r8f&&G.a.x4f(ba)&&(this.wyc=
new N.a(ba),this.bqd=ba.w5c,this.dqd=ba.y5c,this.cqd=ba.Yib,this.Xxc=this.bqd&&this.qD("File")||this.dqd&&this.qD("People")||this.cqd&&this.qD("Notes"));this.aqd=this.D7n();this.jqd=ba.nXc;this.ILe=this.W7n();this.R5g=this.C7n();this.m9=this.IWl();this.hBg=new I.a(ba);this.rPj=new J.a(ba);this.O4j=new O.a(ba);this.tDj=new H(ba);this.Qwc=ca;this.CKe=new a.a;this.jqd&&(this.hBg=new I.a(ba))}qD(ba){return Array.contains(this.l9a,ba)?!0:!1}uK(){return"TellMeService"}sT(){return 0===this.oc.Su?0:1===this.oc.Su?
1:this.qD("Command")||this.qD("Recommended")?2:3}FWl(ba){let ha="";if(!ba&&this.qD("Command")&&this.oc.Owf){ha+="CommandSearch_DLIS,";var ca=this.oc.thj;0<ca.length&&(ha+=ca+",")}ba&&this.qD("Recommended")&&this.eqd&&(ca=this.F_l(),0<ca.length&&(ha+=ca+","));!ba&&this.qD("Help")&&(ba=this.oc.shj,0<ba.length&&(ha+=ba+","));0<ha.length&&(ha=ha.substr(0,ha.length-1));return ha}qH(ba,ha,ca,ia=e.a.tellMe,ra=null){const da=new z.a(ba);ca=G.a.rQ(ba);if(this.Xxc&&(!this.qtb||window.performance.now()-this.qtb>=
G.a.MSa)){var za=this.CKe.JWl();if(za)this.qtb=window.performance.now(),za.then(Na=>{this.Lyc=Na},Na=>{A.TellMeActor.instance.Qe.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+Na)});else if(A.TellMeActor.instance.Qe)A.TellMeActor.instance.Qe.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var la=this.Xxc&&!!this.Lyc;za=la||ca&&this.qD("Recommended")&&this.eqd;la=la||!ca&&(this.S5g&&this.qD("Command")||this.GLe&&this.qD("Answer")||this.HLe&&
this.qD("Definition")||this.U5g&&this.qD("Image")||this.jqd&&this.qD("Help")||this.JLe&&this.qD("WolframAnswer")||this.ILe&&this.qD("Template")||this.R5g&&this.qD("Addin"));if(za||la)if(this.vka=ia,ia={"Content-Type":"application/json",Accept:"application/json"},ia["X-Office-Version"]=T.AFrameworkApplication.buildVersion,ia["X-Office-Application"]=T.AFrameworkApplication.K.lb("Application"),ia["X-Office-Platform"]="WAC",ia["X-TellMe-SqmUserId"]=T.AFrameworkApplication.K.lb("LoggableUserId")||"",ia["X-TellMe-SessionId"]=
A.TellMeActor.instance.UMd(),this.Lyc&&(ia.Authorization="Bearer "+this.Lyc),za=this.FWl(ca),0<za.length&&(ia["X-TellMe-Flights"]=za),za=[],!ca&&this.qD("Answer")&&this.GLe&&(ra?Array.contains(ra,9):1)&&Array.add(za,"Answer"),!ca&&this.qD("Command")&&this.S5g&&!K.CommandResultsUtility.muf(ba.Ig)&&(ra?Array.contains(ra,17):1)&&Array.add(za,"Command"),!ca&&this.qD("Definition")&&this.HLe&&(ra?Array.contains(ra,10):1)&&Array.add(za,"Definition"),!ca&&this.qD("Help")&&this.jqd&&(ra?Array.contains(ra,
8):1)&&Array.add(za,"Help"),!ca&&this.qD("WolframAnswer")&&this.JLe&&(ra?Array.contains(ra,12):1)&&Array.add(za,"WolframAnswer"),ca&&this.qD("Recommended")&&this.eqd&&!A.TellMeActor.instance.S7c&&(ra?Array.contains(ra,18):1)&&Array.add(za,"Recommended"),!ca&&this.qD("Image")&&this.U5g&&(ra?Array.contains(ra,19):1)&&Array.add(za,"Image"),this.Lyc&&this.Xxc&&(ra?Array.contains(ra,14)||Array.contains(ra,15)||Array.contains(ra,20):1)&&(this.wyc.Nec(),this.bqd&&this.qD("File")&&Array.add(za,"File"),this.dqd&&
this.qD("People")&&Array.add(za,"People"),this.cqd&&this.qD("Notes")&&Array.add(za,"Notes")),!ca&&this.qD("Template")&&this.ILe&&(ra?Array.contains(ra,23):1)&&Array.add(za,"Template"),!ca&&this.qD("Addin")&&this.R5g&&(ra?Array.contains(ra,25):1)&&Array.add(za,"Addin"),za.length){ia["X-TellMe-SuggestionTypes"]=za.join(",");ia["X-TellMe-Culture"]=T.AFrameworkApplication.uiCulture;ia["X-TellMe-ProcessSessionId"]=T.AFrameworkApplication.userSessionId;var na=this.hP=W.a.create().toString();ia["Client-Request-Id"]=
na;var Ca=window.performance.now();this.CBa();this.Y0=window.setTimeout(()=>{if(na===this.hP){this.hP="";this.Y0=-1;ha.resultsUpdated(da);const Na={};Na[k.a.provider]=this.uK();Na[k.a.eKb]=ba.Ilb;A.TellMeActor.instance.Qe.hA(m.a.timedOut,this.Qwc,Na)}},this.Qwc);this.rg.qj(this.m9,2,this.HWl(ba.Ig),ia,!1,0,Na=>{this.PIb(Na,ba,ha,na,Ca,ra)},Na=>{this.DIb(Na,ba,ha,na,Ca)},null,null,!1,4E3,6E3)}else A.TellMeActor.instance.Qe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),
ha.resultsUpdated(da);else ha.resultsUpdated(da)}CBa(){-1!==this.Y0&&(window.clearTimeout(this.Y0),this.Y0=-1)}PIb(ba,ha,ca,ia,ra,da){const za=new z.a(ha);if(ia===this.hP){this.CBa();A.TellMeActor.instance.Qe.d8(ha.Ig.length,this.l9a.join(","),ba.data.jf.toString(),Math.round(window.performance.now()-ra),M.a.tellMe,!0,w.a.tOa);ia=ba.data.Ae;ba=null;try{ba=R.b(ia)}catch(Fa){A.TellMeActor.instance.Qe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+Fa);return}ia=G.a.rQ(ha);
if("Groups"in ba&&ba.Groups){var la=ba.Groups;for(var na of la)if("GroupType"in na&&"Suggestions"in na&&na.Suggestions)if("Commands"===na.GroupType&&(da?Array.contains(da,17):1)||"Recommended"===na.GroupType&&(da?Array.contains(da,18):1)){var Ca=(la="Recommended"===na.GroupType)?"DLIS":"NaiveBayes";"Source"in na&&na.Source&&(Ca=na.Source);var Na=na.Suggestions;new l.a;var Ta=[];for(const Fa of Na)this.vym(Fa)&&(Na=Fa.Type,("Command"===Na||la&&"Recommended"===Na)&&Ta.push(new F.a(Fa.CommandId,Fa.Score)));
K.CommandResultsUtility.MXd(Ta,!ha.Ig.trim().length,na.GroupType,Ca);Ca=A.TellMeActor.instance.G1;Na=[];for(const Fa of Ta)la&&Ca&&Ca.s2e(Fa.commandId)||Na.push(Fa);Ta=K.CommandResultsUtility.iMd(ha,Na,this.oc,null,null,null,la?18:17,0);0<Ta.results.length&&(this.vka!==e.a.contextMenu&&(Ta.displayName=la?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),za.Lv(Ta))}else if("Answer"===na.GroupType){Na=na.Suggestions;la=null;Ta=2147483647;Ca="";for(const Fa of Na)if(this.uym(Fa))if(Ca=
Fa.Type,Na=this.YLd(Ca),"Answer"===Ca&&this.GLe){la=this.SAh(Ca,Fa,ha.Ig);break}else Na&&Na<Ta&&(Ta=Na,la=this.SAh(Ca,Fa,ha.Ig));Ta=G.a.aMn(ha.Ig,Ca);la&&(da?Array.contains(da,la.type):1)&&(Ca=[],this.aqd?this.oc.Xua?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(la.value,la.kC)),A.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(la.value,la.description)),A.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(la.value,
Ta))):(Ca.push(appChrome.actions.setControlLabel(la.value,la.kC)),Ca.push(appChrome.actions.updateCompoundButtonDescription(la.value,la.description)),Ca.push(appChrome.actions.setCompoundButtonCommandValueId(la.value,Ta)),appChrome.api.dispatch(Ca)):this.oc.Xua?(A.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(la.value,la.kC+" - "+la.description)),A.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(la.value,Ta))):(Ca.push(appChrome.actions.setControlLabel(la.value,
la.kC+" - "+la.description)),Ca.push(appChrome.actions.setButtonCommandValueId(la.value,Ta)),appChrome.api.dispatch(Ca)),Ta=this.dXk(la.type),Ta.Ly(la),za.Lv(Ta))}else"Help"===na.GroupType&&na.Suggestions.length&&(da?Array.contains(da,8):1)?this.jqd&&(la=this.hBg.Zgb(ha,na.Suggestions))&&0<la.results.length&&za.Lv(la):"Template"===na.GroupType&&(da?Array.contains(da,23):1)?(la=na.Suggestions)&&0<la.length&&this.O4j.Zgb(ha,za,la):"Addin"===na.GroupType&&(da?Array.contains(da,25):1)?(la=na.Suggestions)&&
0<la.length&&this.tDj.Zgb(ha,za,la):"Substrate"===na.GroupType&&this.Xxc&&"Type"in na&&("File"===na.Type&&this.bqd&&(da?Array.contains(da,15):1)?(la=this.wyc.RWh(na.Suggestions,ia,this.vka))&&0<la.results.length&&za.Lv(la):"People"===na.Type&&this.dqd&&(da?Array.contains(da,14):1)?(la=this.wyc.G1h(na.Suggestions,ia,this.vka))&&0<la.results.length&&za.Lv(la):"Notes"===na.Type&&this.cqd&&(da?Array.contains(da,14):1)&&(la=this.wyc.q0h(na.Suggestions,ia,ha))&&0<la.results.length&&za.Lv(la));else A.TellMeActor.instance.Qe.onError("OnSuccessCallBack",
"GroupType"in na?"Invalid group suggestions found for "+na.GroupType:"Invalid group found")}if(ba.Intents){na=ba.Intents;for(const Fa of na)this.dzf(Fa)&&("Image"===Fa.GroupType&&Fa.ConfidenceScore>Fa.ConfidenceThreshold&&(da?Array.contains(da,19):1)?this.rPj.Zgb(ha,za,0,Fa):"Commands"===Fa.GroupType&&Fa.ConfidenceScore<Fa.ConfidenceThreshold&&(da?Array.contains(da,17):1)&&(na=new r.a(17),za.Lv(na)))}ca.resultsUpdated(za);A.TellMeActor.instance.Qe.d8(ha.Ig.length,this.l9a.join(","),"",Math.round(window.performance.now()-
ra),"",!0,w.a.provider)}}DIb(ba,ha,ca,ia,ra){const da=new z.a(ha);ia===this.hP&&(this.CBa(),A.TellMeActor.instance.Qe.d8(ha.Ig.length,this.l9a.join(","),ba.data.jf.toString(),Math.round(window.performance.now()-ra),M.a.tellMe,!1,w.a.tOa));ca.resultsUpdated(da)}YLd(ba){switch(ba){case "Entity":return this.q2j?3:0;case "Definition":return this.HLe?5:0;case "WolframAnswer":return this.JLe?2:0;default:return 0}}SAh(ba,ha,ca){switch(ba){case "Answer":return new v.a(this.aqd?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ha.Title?ca:ha.Title,ha.Description,0);case "Entity":return new v.a(this.aqd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ha.Title?ca:ha.Title,ha.Description,0);case "Definition":return new v.a(this.aqd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ha.Title?ca:ha.Title,ha.Description,0);case "WolframAnswer":return new v.a("WolframForSearch",3,""===ha.Title?ca:ha.Title,ha.Description,0);default:return null}}dXk(ba){switch(ba){case 0:return new r.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new r.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new r.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new r.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new r.a(19,this.oc.Ogc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}uym(ba){return"Type"in ba&&!!ba.Type&&""!==ba.Type&&"Description"in ba&&!!ba.Description&&""!==ba.Description}vym(ba){return"Type"in ba&&!!ba.Type&&""!==ba.Type&&"CommandId"in ba&&
!!ba.CommandId&&""!==ba.CommandId&&"Score"in ba&&!!ba.Score}dzf(ba){if("GroupType"in ba&&ba.GroupType&&"ConfidenceScore"in ba&&"ConfidenceThreshold"in ba)return!0;A.TellMeActor.instance.Qe.onError("IsValidIntentGroup","Invalid intents found");return!1}HWl(ba){const ha=G.a.Uni(ba),ca={};ca.Query=ba;ha&&this.eqd&&(this.osm()?ca.UserActionEvents=A.TellMeActor.instance.s$g:(ca.CommandClickedEvents=A.TellMeActor.instance.qpe,ca.CommandActionEvents=A.TellMeActor.instance.uEg),ca.TellMeCommandClickMruEvents=
A.TellMeActor.instance.ZWg,ca.ContentType=A.TellMeActor.instance.sCd);this.ILe&&(ba={},ba.Application=this.oc.application,ca.TemplateInfo=ba);return R.c(ca)}KMb(){return!!this.oc&&this.oc.KMb||!!T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Pb.KMb}LMb(){return!!this.oc&&this.oc.LMb||!!T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Pb.LMb}MMb(){return!!this.oc&&this.oc.MMb||!!T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Pb.MMb}OMb(){return!!this.oc&&this.oc.OMb||!!T.AFrameworkApplication.ta&&
T.AFrameworkApplication.ta.Pb.OMb}Tgc(){return!!this.oc&&(this.oc.Tgc||this.oc.zO)}D7n(){return!!this.oc&&!this.oc.j2a}W7n(){return!!this.oc&&this.oc.uSc}C7n(){return!!this.oc&&this.oc.Ijm&&this.oc.Fjm}Foi(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Goi(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",
!1)}osm(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}F_l(){return T.AFrameworkApplication.K?T.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}IWl(){if(!T.AFrameworkApplication.K)return"";if(this.Goi())return T.AFrameworkApplication.K.lb("TellMeServiceProdEndpointForSearch");if(this.Foi())return T.AFrameworkApplication.K.lb("TellMeServiceEdogEndpointForSearch");
if(G.a.Puf())return T.AFrameworkApplication.K.lb("TellMeServiceIntEndpointForSearch");let ba=T.AFrameworkApplication.K.lb("TellMeServiceSearchEndpoint");ba&&""!==ba||(ba=T.AFrameworkApplication.rhj);return ba}static uBh(ba,ha){if(ha)return new V(ba,["Command","Recommended"],ba.iCl);ha=G.a.mga()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");return new V(ba,ha,ba.x4h)}}Object(D.a)(V,"TellMeServiceProvider",
null,[1099])},1819:function(D,L,c){c.r(L);c.d(L,"MarkerValidation",function(){return a});D=c(0);var l=c(412),e=c(1720);class a{constructor(){this.pRd=this.tfi=this.sfi=this.rfi=0}SVh(){const k=new l.a(0);k.Z("InvalidBookmarks",this.rfi);k.Z("InvalidComments",this.sfi);k.Z("InvalidContentControls",this.tfi);0!==this.pRd&&k.Z("InvalidMarkerType",this.pRd);return k}l$h(){return 0<this.rfi||0<this.sfi||0<this.tfi||0!==this.pRd?!0:!1}toString(){return JSON.stringify(e.a.oTa(this.SVh()))}}Object(D.a)(a,
"MarkerValidation",null,[])},1820:function(D,L,c){c.d(L,"a",function(){return w});D=c(0);var l=c(152),e=c(1012),a=c(251),k=c(1592),m=c(1525);class w{constructor(v,r,z,A,G=null,H=null,I=null,K=null){this.ae=v;this.aF=r;this.nza=z;this.EAa=A;this.OUj=G;this.tLj=H;this.f6j=I;this.Sqa=K||this.d4e()}d4e(){return v=>!!this.ae.runtime.$b&&this.ae.runtime.$b.isFeatureEnabled(v)}YSk(){return()=>this.ae.runtime.$b}O9e(){return!!this.ae.runtime.nk.J(a.a.VK)}edj(){let v;if(1===this.ae.input.source||2===this.ae.input.source)v=
80;else if(4===this.ae.input.source||3===this.ae.input.source)v=38;else if(5===this.ae.input.source)v=119;else return!1;return this.O9e()&&this.Sqa(v)}gfj(v,...r){return String.format.apply(null,[v].concat(r))}BLd(v){const {ParagraphMerge:r}=c(1885);let z=this.ae,A=this.nza,G=this.EAa;v||(z=this.OUj||this.ae,A=this.tLj||A,G=this.f6j||G);var H=m.a.skf(this.aF);const I=m.a.skf(A),K=m.a.skf(G);H=this.gfj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.LBa.id,z.runtime.qGd,z.runtime.ahe,H.Oq(),I.Oq(),K.Oq());return v?{returnValue:new k.a(z,this.aF,A,G,this.d4e(),new e.a),Oq:H}:{returnValue:new r(z,this.aF,A,G,this.d4e(),this.YSk(),new e.a),Oq:H}}ojc(){this.ae.logger.M_n();var v=this.edj();var r=({Oq:A}=this.BLd(v)).returnValue;l.a.instance.Sa(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",v,A);this.ae.logger.dU("ParagraphMergeSelector initialization");v?this.ae.logger.Jae(1):this.ae.logger.Jae(2);
let z=({Ym:r}=r.ojc()).returnValue;this.ae.logger.L2f();var A=!z;v=!!this.ae.runtime.nk.J(a.a.VK)&&(v&&!z||!v);A&&({Oq:A,returnValue:r}=this.BLd(!1),{Ym:r,returnValue:z}=r.ojc(),l.a.instance.Sa(18994390,1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,A));v&&(A=new e.a,m.a.SKn(this.ae,A));this.ae.logger.dU("ParagraphMergeSelector finalization");return{returnValue:z,Ym:r}}b7c(v,r){let z,A,G;const H=this.edj()&&this.Sqa(120);let I=({Oq:G}=this.BLd(H)).returnValue,K=({H4a:z,
Voa:A}=I.b7c(v,r)).returnValue;l.a.instance.Sa(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",H,G);H&&!K&&I.TZf&&({Oq:G,returnValue:I}=this.BLd(!1),{H4a:z,Voa:A,returnValue:K}=I.b7c(v,r),l.a.instance.Sa(18994392,1,K?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",K,G));return{returnValue:K,H4a:z,Voa:A}}}Object(D.a)(w,"ParagraphMergeSelector",null,[1920])},1821:function(D,L,c){c.r(L);c.d(L,"SurfaceStringTokenStringGenerator",
function(){return e});D=c(0);var l=c(1547);class e extends l.a{constructor(a){super(a);this.Cb=a}apply(a,k,m,w,v,r,z){null==r&&(r=a.y6h(v,k));z=l.a.eeh(a,r,this.Cb.score,m,w,z);return{Y5c:r,wCc:z}}}e.xCc=0;Object(D.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1822:function(D,L,c){c.r(L);c.d(L,"QueryTokenStringGenerator",function(){return a});D=c(0);var l=c(1547),e=c(1453);class a extends l.a{constructor(k){super(k);this.Cb=k}apply(k,m,w,v,r,z,A){m=this.Cb.query.load(m,null);r=0;let G=null;this.Cb.query.f4===
e.Annotations.Zxa?m&&(G=this.Cb.name):((G=this.Cb.name)&&(G+="_"),G+=this.Cb.annotations.Mca(this.Cb.query.f4,m));null!=G&&(r=l.a.eeh(k,G,this.Cb.score,w,v,r));return{Y5c:z,wCc:A+r}}}a.xCc=1;Object(D.a)(a,"QueryTokenStringGenerator",l.a,[])},1823:function(D,L,c){c.r(L);c.d(L,"FuzzyMatchTokenStringGenerator",function(){return e});D=c(0);var l=c(1547);class e extends l.a{constructor(a){super(a);this.Cb=a}apply(a,k,m,w,v,r,z){null==r&&(r=a.y6h(v,k));a=this.Cb.OKh.YOm(r);if(this.Cb.kIi)for(var A of a)if(!A.LN&&
A.mHd)return{Y5c:r,wCc:z};A=0;for(const G of a)if(G.LN&&!({fZe:A}=this.jjh(G,!0,m,w,A)).returnValue)return{Y5c:r,wCc:z};if(this.Cb.nci)for(const G of a)if(!({fZe:A}=this.jjh(G,!1,m,w,A)).returnValue)break;return{Y5c:r,wCc:z}}jjh(a,k,m,w,v){let r;k?(k=0,r=a.mHd?1:0):(k=a.mHd?1:0,r=a.count-k);for(let z=0;z<r;++z)if(l.a.feh(a.rfb+k+z,this.Cb.score,m,w),++v,0<this.Cb.qEf&&v>=this.Cb.qEf)return{returnValue:!1,fZe:v};return{returnValue:!0,fZe:v}}}e.xCc=2;Object(D.a)(e,"FuzzyMatchTokenStringGenerator",l.a,
[])},1875:function(D,L,c){D=c(0);var l=c(7),e=c(44),a=c(231),k=c(1452);class m extends k.a{constructor(){super()}get Gn(){return 2}get Qz(){return 7}static nh(){return new m}static get instance(){return m.Pg.value}}m.Pg=new a.a(m.nh);Object(D.a)(m,"AppBindingNodeComplexMerge",k.a,[]);var w=c(17),v=c(797),r=c(152),z=c(1492);class A extends k.a{constructor(){super()}get Gn(){return 3}get Qz(){return 7}qk(){const lb=super.qk();lb.Z(v.a.zb(w.a.bU),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(w.a.bU)){const Db=
lb.Sk;var pc=lb.Yd;r.a.instance.Sa(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Db.id,Db.Rc,Tb);Tb=pc.getPropertyMilliseconds(lb.Sg.value.Af,w.a.bU);pc=pc.getPropertyMilliseconds(lb.nn.value.Af,w.a.bU);Tb<pc&&this.sxl(lb);lb.xg.add(v.a.zb(w.a.bU));return!0}r.a.instance.Sa(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}sxl(lb){this.RHn(lb.nn.value.Af,
lb.Sk);this.fhf(lb,l.a.fVe);this.fhf(lb,l.a.ohh);this.fhf(lb,l.a.dhh)}fhf(lb,Tb){var pc=lb.Yd,Db=lb.Sk;if(pc.hasProperty(Db,Tb)&&(Tb=pc.getPropertyObjectIds(Db,Tb))&&Tb.length)for(pc=lb.Ip.runtime.vq,lb=lb.Ip.runtime.Ym,Db=0;Db<Tb.length;Db++){const Ob=Tb.J(Db);if(!pc.ub(Ob))continue;const jb=pc.J(Ob).aH();lb.add(Ob,new z.a(jb,!1))}}static nh(){return new A}static get instance(){return A.Pg.value}}A.Pg=new a.a(A.nh);Object(D.a)(A,"AppNodeComplexMerge",k.a,[]);class G extends k.a{constructor(){super()}get Gn(){return 4}get Qz(){return 7}static nh(){return new G}static get instance(){return G.Pg.value}}
G.Pg=new a.a(G.nh);Object(D.a)(G,"AppPropNodeComplexMerge",k.a,[]);class H extends k.a{constructor(){super()}get Gn(){return 5}get Qz(){return 7}static nh(){return new H}static get instance(){return H.Pg.value}}H.Pg=new a.a(H.nh);Object(D.a)(H,"AppRefNodeComplexMerge",k.a,[]);var I=c(412),K=c(621),F=c(228),J=c(16);class N{constructor(lb,Tb){this.id=lb;this.xeo=Tb}}Object(D.a)(N,"IdAndTime",null,[]);class O extends k.a{constructor(){super()}get Gn(){return 6}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.YXa),
1);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.YXa)){const pc=lb.Sk,Db=lb.Yd;r.a.instance.Sa(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",pc.id,pc.Rc,Tb);Tb=Db.getPropertyObjectIds(lb.Sg.value.Eu,l.a.YXa);const Ob=Db.getPropertyObjectIds(lb.Sg.value.Af,l.a.YXa),jb=Db.getPropertyObjectIds(lb.nn.value.Af,l.a.YXa);Tb=this.jTm(lb,Tb,Ob,jb);0<Tb.length?Db.setPropertyObjectIds(pc,l.a.YXa,Tb):pc.removeProperty(l.a.YXa);lb.xg.add(v.a.zb(l.a.YXa));
return!0}r.a.instance.Sa(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}jTm(lb,Tb,pc,Db){const Ob=this.REa(Tb,pc,Db),jb=Tb.tG(),tb=pc.tG(),ac=Db.tG();Tb=k.a.filter(Ob,cd=>!jb.contains(cd)&&tb.contains(cd));pc=k.a.filter(Ob,cd=>!jb.contains(cd)&&ac.contains(cd));if(!Tb.length||!pc.length)return Ob;const zc=new I.a;Tb.forEach(cd=>{const Cd=new N(cd,this.BSh(lb,cd,!1));this.xSh(lb,cd,!1).forEach(ud=>
{zc.add(ud,Cd);return!0});return!0});const yc=new K.a;pc.forEach(cd=>{const Cd=this.BSh(lb,cd,!0);this.xSh(lb,cd,!0).forEach(ud=>zc.ub(ud)?(yc.add(zc.J(ud).xeo>=Cd?cd:zc.J(ud).id),!1):!0);return!0});return k.a.filter(Ob,cd=>!yc.contains(cd))}BSh(lb,Tb,pc){return(Tb=this.Nua(lb,Tb,pc))?lb.Yd.getPropertyMilliseconds(Tb,w.a.bU):0}Nua(lb,Tb,pc){lb=pc?lb.Ip.runtime.vq:lb.Ip.runtime.uu;return lb.ub(Tb)?lb.J(Tb):null}xSh(lb,Tb,pc){const Db=new F.a,Ob=new K.a,jb=lb.Yd;Tb=this.Nua(lb,Tb,pc);var tb=this.U2h(jb,
Tb);if(tb)for(Db.add(tb),Ob.add(tb),Tb=jb.getPropertyObjectIds(Tb,l.a.fVe),tb=0;Tb&&tb<Tb.length;tb++){const ac=this.U2h(jb,this.Nua(lb,Tb.J(tb),pc));if(!ac)break;Ob.contains(ac)||(Db.add(ac),Ob.add(ac))}return Db}U2h(lb,Tb){if(!lb.hasProperty(Tb,l.a.rcb)||!lb.hasProperty(Tb,l.a.GZb)||!lb.hasProperty(Tb,l.a.HZb))return null;const pc=lb.getPropertyString(Tb,l.a.rcb),Db=lb.getPropertyString(Tb,l.a.GZb);lb=lb.getPropertyString(Tb,l.a.HZb);return J.a.lA(pc+";"+Db+";"+lb)}static nh(){return new O}static get instance(){return O.Pg.value}}
O.Pg=new a.a(O.nh);Object(D.a)(O,"AppsNodeComplexMerge",k.a,[]);class M extends k.a{constructor(){super()}get Gn(){return 36}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.tcg),1);lb.Z(v.a.zb(l.a.X2f),1);return lb}rB(lb,Tb){r.a.instance.Sa(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Tb);if(Tb===v.a.zb(l.a.tcg)||Tb===v.a.zb(l.a.X2f)){const jb=v.a.QW(Tb);var pc=lb.Sg.value.Af,Db=lb.nn.value.Af;const tb=lb.Sk;var Ob=lb.Yd.getPropertyStrings(lb.Sg.value.Eu,jb);pc=lb.Yd.getPropertyStrings(pc,
jb);Db=lb.Yd.getPropertyStrings(Db,jb);Ob=this.REa(Ob,pc,Db);lb.Yd.setPropertyStrings(tb,jb,Ob);lb.xg.add(Tb);return!0}return!1}static nh(){return new M}static get instance(){return M.Pg.value}}M.Pg=new a.a(M.nh);Object(D.a)(M,"AutoSaveParametersNodeComplexMerge",k.a,[]);class T extends k.a{constructor(){super()}get Gn(){return 44}qk(){const lb=super.qk();lb.Z(v.a.zb(w.a.gf),1);return lb}rB(lb,Tb){const pc=lb.Ip.runtime.$b;if(Tb===v.a.zb(w.a.gf))return r.a.instance.Sa(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
lb.Sk.id,lb.Sk.Rc,Tb),pc.ez(125),pc.isFeatureEnabled(125)?this.mTm(lb,Tb):this.ITm(lb,Tb),!0;r.a.instance.Sa(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}mTm(lb,Tb){const pc=v.a.QW(Tb),Db=lb.Yd;var Ob=Db.getPropertyObjectIds(lb.Sg.value.Eu,pc),jb=Db.getPropertyObjectIds(lb.Sg.value.Af,pc),tb=Db.getPropertyObjectIds(lb.nn.value.Af,pc);tb=T.BYl(lb,jb,tb);Ob=this.REa(Ob,jb,
tb);jb=lb.Sk;0<Ob.length?Db.setPropertyObjectIds(jb,pc,Ob):jb.removeProperty(pc);lb.xg.add(Tb)}static nh(){return new T}static get instance(){return T.Pg.value}static BYl(lb,Tb,pc){const Db=new F.a,Ob=new I.a;Tb.forEach(jb=>{const tb=lb.Ip.runtime.uu.J(jb);tb&&Ob.add(tb.cQ(l.a.at).toString(),jb);return!0});pc.forEach(jb=>{var tb=lb.Ip.runtime.vq.J(jb);tb?(tb=tb.cQ(l.a.at).toString(),Ob.ub(tb)&&Ob.get(tb)!==jb?r.a.instance.Sa(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
Db.add(jb)):Db.add(jb);return!0});return Db}}T.Pg=new a.a(T.nh);Object(D.a)(T,"BookmarkContainerNodeComplexMerge",k.a,[]);class R extends k.a{constructor(){super()}get Gn(){return 41}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.oyb),1);lb.Z(v.a.zb(l.a.at),1);return lb}rB(lb,Tb){return Tb===v.a.zb(l.a.oyb)?(lb.xg.add(v.a.zb(l.a.oyb)),!0):Tb===v.a.zb(l.a.at)?(lb.xg.add(v.a.zb(l.a.at)),!0):!1}kf(lb){return lb&&lb.length?!1:!0}static nh(){return new R}static get instance(){return R.Pg.value}}R.Pg=new a.a(R.nh);
Object(D.a)(R,"BookmarkNodeComplexMerge",k.a,[]);class W extends k.a{constructor(){super();this.oSd=!1}get Gn(){return 7}qk(){const lb=super.qk();lb.Z(v.a.zb(w.a.gf),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(w.a.gf)){const Ob=lb.Sk,jb=lb.Yd;var pc=lb.Ip.runtime.$b;pc&&(this.oSd=pc.isFeatureEnabled(74));r.a.instance.Sa(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ob.id,Ob.Rc,Tb);Tb=jb.getPropertyObjectIds(lb.Sg.value.Eu,w.a.gf);
pc=jb.getPropertyObjectIds(lb.Sg.value.Af,w.a.gf);var Db=jb.getPropertyObjectIds(lb.nn.value.Af,w.a.gf);Tb=this.wTm(Tb,pc,Db);if(this.oSd&&0<Tb.length){pc=new Sys.StringBuilder;for(Db=0;Db<Tb.length;Db++)pc.append(Tb.J(Db).toString()+",");r.a.instance.Sa(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Ob.id,pc.toString())}0<Tb.length?jb.setPropertyObjectIds(Ob,w.a.gf,Tb):Ob.removeProperty(w.a.gf);lb.xg.add(v.a.zb(w.a.gf));return!0}r.a.instance.Sa(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
lb.Sg.value.Af.id,Tb);return!1}wTm(lb,Tb,pc){const Db=new F.a,Ob=new I.a(0);this.ohl(lb,pc,Db,Ob);return this.S3k(Tb,Ob,Db)}ohl(lb,Tb,pc,Db){lb=lb||new F.a;Tb=Tb||new F.a;lb.forEach(Ob=>{Db.Z(Ob,1);return!0});Tb.forEach(Ob=>{Db.Gc(Ob).returnValue?Db.Z(Ob,2):(Db.Z(Ob,0),pc.add(Ob));return!0})}S3k(lb,Tb,pc){lb=lb||new F.a;const Db=new F.a,Ob=new F.a,jb=new F.a;lb.forEach(tb=>{let ac=!0,zc;({value:zc}=Tb.Gc(tb)).returnValue&&(0===zc?Tb.Z(tb,2):1===zc&&(ac=!1));ac?Db.add(tb):this.oSd&&Ob.add(tb);return!0});
pc.forEach(tb=>{let ac=!1,zc;({value:zc}=Tb.Gc(tb)).returnValue?0===zc&&(ac=!0,Tb.Z(tb,2)):r.a.instance.Sa(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",tb);ac?Db.add(tb):this.oSd&&jb.add(tb);return!0});this.oui(Ob,"Favored");this.oui(jb,"Unfavored");return Db}oui(lb,Tb){if(lb.length){var pc=new Sys.StringBuilder;for(let Db=0;Db<lb.length;Db++)pc.append(lb.J(Db).toString()+",");r.a.instance.Sa(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Tb,pc.toString())}}static nh(){return new W}static get instance(){return W.Pg.value}}W.Pg=new a.a(W.nh);Object(D.a)(W,"CommentContentNodeComplexMerge",k.a,[]);var V=c(1788);class ba extends k.a{constructor(){super()}get Gn(){return 8}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.R$),3);lb.Z(v.a.zb(l.a.nE),3);lb.Z(v.a.zb(l.a.TDc),2);lb.Z(v.a.zb(l.a.commentId),2);lb.Z(v.a.zb(l.a.Vuh),2);lb.Z(v.a.zb(l.a.IBa),2);lb.Z(v.a.zb(l.a.lMa),1);lb.Z(v.a.zb(l.a.hhb),
1);lb.Z(v.a.zb(l.a.iib),1);lb.Z(v.a.zb(l.a.v6),1);lb.Z(v.a.zb(l.a.dG),1);lb.Z(v.a.zb(l.a.SDc),2);lb.Z(v.a.zb(l.a.Jzd),2);lb.Z(v.a.zb(l.a.E0b),2);lb.Z(v.a.zb(l.a.y1e),2);lb.Z(v.a.zb(l.a.EL),1);lb.Z(v.a.zb(w.a.gf),0);lb.Z(v.a.zb(l.a.cH),0);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.EL)){var pc=lb.Yd.getPropertyString(lb.nn.value.Af,l.a.EL);this.kf(pc)?lb.Sk.removeProperty(l.a.EL):lb.Sk.Bxa(l.a.EL,pc);return!0}if(Tb!==v.a.zb(l.a.lMa)&&Tb!==v.a.zb(l.a.hhb)&&Tb!==v.a.zb(l.a.iib)&&Tb!==v.a.zb(l.a.dG)&&Tb!==
v.a.zb(l.a.v6))return!1;var Db=lb.Sg.value.Af,Ob=lb.nn.value.Af;pc=lb.Sk;if(Tb===v.a.zb(l.a.lMa)){Db=lb.Yd.getPropertyString(Db,l.a.lMa);Ob=lb.Yd.getPropertyString(Ob,l.a.lMa);Ob=this.kf(Db)?Ob:this.kf(Ob)?Db:null;if(this.kf(Ob))return!0;lb.Yd.setPropertyString(pc,l.a.lMa,Ob);lb.xg.add(v.a.zb(l.a.lMa));return!0}if(Tb===v.a.zb(l.a.iib))return Db=lb.Yd.getPropertyBool(Db,l.a.iib),Ob=lb.Yd.getPropertyBool(Ob,l.a.iib),Db=null!=Db?Db:!1,Db=(null!=Ob?Ob:!1)||Db,lb.Yd.setPropertyBool(pc,l.a.iib,Db),lb.xg.add(v.a.zb(l.a.iib)),
!0;if(Tb===v.a.zb(l.a.hhb)){Db=lb.Yd.getPropertyBool(Db,l.a.hhb);Ob=lb.Yd.getPropertyBool(Ob,l.a.hhb);if(Db===Ob)return!0;Db=null!=Db?Db:!1;Db=(null!=Ob?Ob:!1)||Db;lb.Yd.setPropertyBool(pc,l.a.hhb,Db);return!0}if(Tb===v.a.zb(l.a.dG)){Db=lb.Yd.getPropertyBool(Db,l.a.dG);Ob=lb.Yd.getPropertyBool(Ob,l.a.dG);if(Db===Ob)return!0;Db=null!=Db?Db:!1;Db=(null!=Ob?Ob:!1)||Db;lb.Yd.setPropertyBool(pc,l.a.dG,Db);lb.xg.add(v.a.zb(l.a.dG));return!0}if(Tb===v.a.zb(l.a.v6)){Tb=lb.Ip.runtime.$b;Tb.ez(V.a.xKk);if(!Tb.isFeatureEnabled(V.a.xKk))return!1;
Db=lb.Yd.getPropertyString(Db,l.a.v6);Ob=lb.Yd.getPropertyString(Ob,l.a.v6);if(Db===Ob)return!0;lb.Yd.setPropertyString(pc,l.a.v6,Ob||Db);lb.xg.add(v.a.zb(l.a.v6));return!0}return!1}kf(lb){return lb&&lb.length?!1:!0}static nh(){return new ba}static get instance(){return ba.Pg.value}}ba.Pg=new a.a(ba.nh);Object(D.a)(ba,"CommentNodeComplexMerge",k.a,[]);class ha extends k.a{constructor(){super()}get Gn(){return 46}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.contentControlNode),1);lb.Z(v.a.zb(w.a.lastModifiedTime),
0);lb.Z(v.a.zb(l.a.uEc),2);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.contentControlNode))return r.a.instance.Sa(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lb.Sk.id,lb.Sk.Rc,Tb),k.a.LEf(lb,this,l.a.contentControlNode);r.a.instance.Sa(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}static nh(){return new ha}static get instance(){return ha.Pg.value}}
ha.Pg=new a.a(ha.nh);Object(D.a)(ha,"ContentControlContainerNodeComplexMerge",k.a,[]);var ca=c(61),ia=c(1709);class ra extends k.a{constructor(){super()}get Gn(){return 37}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.y6),1);lb.Z(v.a.zb(l.a.kob),1);lb.Z(v.a.zb(l.a.FAd),2);lb.Z(v.a.zb(l.a.X0b),2);lb.Z(v.a.zb(l.a.contentControlNode),1);lb.Z(v.a.zb(l.a.w7),1);lb.Z(v.a.zb(l.a.Iea),1);lb.Z(v.a.zb(l.a.$0b),1);lb.Z(v.a.zb(l.a.Kdb),1);lb.Z(v.a.zb(l.a.Idb),1);lb.Z(v.a.zb(l.a.Hdb),1);lb.Z(v.a.zb(l.a.K2e),2);lb.Z(v.a.zb(l.a.vEc),
1);lb.Z(v.a.zb(l.a.GAd),1);lb.Z(v.a.zb(l.a.x6),1);this.$b.isFeatureEnabled(26)&&(lb.Z(v.a.zb(l.a.pX),2),lb.Z(v.a.zb(l.a.Ota),2),lb.Z(v.a.zb(l.a.Ela),2),lb.Z(v.a.zb(l.a.q3),1),lb.Z(v.a.zb(l.a.dna),1),lb.Z(v.a.zb(l.a.ena),1));return lb}rB(lb,Tb){var pc=lb.Sg.value.Af,Db=lb.nn.value.Af;const Ob=lb.Sk;if(Tb===v.a.zb(l.a.contentControlNode))return k.a.LEf(lb,this,l.a.contentControlNode);if(Tb===v.a.zb(l.a.w7)){Tb=lb.Yd.getPropertyBool(pc,l.a.w7);Db=lb.Yd.getPropertyBool(Db,l.a.w7);if(null!=Tb&&Tb||null!=
Db&&Db)lb.Yd.setPropertyBool(Ob,l.a.w7,!0),lb.xg.add(v.a.zb(l.a.w7));return!0}if(Tb===v.a.zb(l.a.Iea))return Tb=lb.Yd.getPropertyBool(pc,l.a.Iea),Db=lb.Yd.getPropertyBool(Db,l.a.Iea),lb.Yd.setPropertyBool(Ob,l.a.Iea,null!=Tb&&!!Tb&&null!=Db&&!!Db),lb.xg.add(v.a.zb(l.a.Iea)),!0;if(Tb===v.a.zb(l.a.$0b))return Tb=lb.Yd.getPropertyUint32(Db,l.a.$0b),null!=Tb&&(lb.Yd.setPropertyUint32(Ob,l.a.$0b,Tb),lb.xg.add(v.a.zb(l.a.$0b))),!0;if(Tb===v.a.zb(l.a.Kdb)||Tb===v.a.zb(l.a.Idb)||Tb===v.a.zb(l.a.Hdb))return(Db=
lb.Yd.getPropertyString(Db,v.a.QW(Tb)))&&0<Db.length&&(lb.Yd.setPropertyString(Ob,v.a.QW(Tb),Db),lb.xg.add(Tb)),!0;if(Tb===v.a.zb(l.a.vEc)||Tb===v.a.zb(l.a.GAd)){pc=lb.Yd.getPropertyObjectId(pc,v.a.QW(Tb));if(ia.a.W4b(lb.Ip,pc))return!0;if((Db=lb.Yd.getPropertyObjectId(Db,v.a.QW(Tb)))&&Db!==ca.a.nil)return lb.Yd.setPropertyObjectId(Ob,v.a.QW(Tb),Db),lb.xg.add(Tb),!0;Ob.removeProperty(v.a.QW(Tb));lb.xg.add(Tb);return!0}if(Tb===v.a.zb(l.a.x6)){pc=lb.Yd.getPropertyObjectId(pc,l.a.x6);if((pc=ia.a.W4b(lb.Ip,
pc))&&lb.Yd.getPropertyObjectIds(pc,l.a.contentControlNode).tG().contains(lb.Sk.id))return!0;Db=lb.Yd.getPropertyObjectId(Db,l.a.x6);return(pc=ia.a.W4b(lb.Ip,Db))&&lb.Yd.getPropertyObjectIds(pc,l.a.contentControlNode).tG().contains(lb.Sk.id)?(lb.Yd.setPropertyObjectId(Ob,l.a.x6,Db),lb.xg.add(Tb),!0):!1}if(Tb===v.a.zb(l.a.y6))return Tb=lb.Yd.getPropertyBool(Db,l.a.y6),null==Tb||Tb||(lb.Yd.setPropertyBool(Ob,l.a.y6,!1),lb.xg.add(v.a.zb(l.a.y6))),!0;if(Tb===v.a.zb(l.a.kob)){Tb=lb.Yd.getPropertyObjectId(pc,
l.a.kob);Db=lb.Yd.getPropertyObjectId(Db,l.a.kob);if(Tb&&!Tb.equals(Db))return!1;if(Tb=Tb||Db)lb.Yd.setPropertyObjectId(Ob,l.a.kob,Tb),lb.xg.add(v.a.zb(l.a.kob));return!0}!this.$b.isFeatureEnabled(26)||Tb!==v.a.zb(l.a.q3)&&Tb!==v.a.zb(l.a.dna)&&Tb!==v.a.zb(l.a.ena)||r.a.instance.Sa(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Tb);return!1}static nh(){return new ra}static get instance(){return ra.Pg.value}}ra.Pg=new a.a(ra.nh);
Object(D.a)(ra,"ContentControlNodeComplexMerge",k.a,[]);class da extends k.a{constructor(){super()}get Gn(){return 10}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.customXmlPartNode),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.customXmlPartNode)){Tb=lb.Sk;const Db=lb.Yd;var pc=Db.getPropertyObjectIds(lb.Sg.value.Eu,l.a.customXmlPartNode);const Ob=Db.getPropertyObjectIds(lb.Sg.value.Af,l.a.customXmlPartNode),jb=Db.getPropertyObjectIds(lb.nn.value.Af,l.a.customXmlPartNode);pc=this.BTm(pc,Ob,jb);0<pc.length?
Db.setPropertyObjectIds(Tb,l.a.customXmlPartNode,pc):Tb.removeProperty(l.a.customXmlPartNode);lb.xg.add(v.a.zb(l.a.customXmlPartNode));return!0}return!1}BTm(lb,Tb,pc){return this.REa(lb,Tb,pc)}static nh(){return new da}static get instance(){return da.Pg.value}}da.Pg=new a.a(da.nh);Object(D.a)(da,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class za extends k.a{constructor(){super()}get Gn(){return 9}get Qz(){return 0}static nh(){return new za}static get instance(){return za.Pg.value}}za.Pg=new a.a(za.nh);
Object(D.a)(za,"CustomXmlPartNodeComplexMerge",k.a,[]);class la extends k.a{constructor(){super()}get Gn(){return 29}get Qz(){return 3}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.embeddedFontNode),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.embeddedFontNode)){Tb=lb.Yd;var pc=Tb.getPropertyObjectIds(lb.Sg.value.Eu,l.a.embeddedFontNode),Db=Tb.getPropertyObjectIds(lb.Sg.value.Af,l.a.embeddedFontNode);const Ob=Tb.getPropertyObjectIds(lb.nn.value.Af,l.a.embeddedFontNode);pc=this.REa(pc,Db,Ob);Db=lb.Sk;0<pc.length?
Tb.setPropertyObjectIds(Db,l.a.embeddedFontNode,pc):Db.removeProperty(l.a.embeddedFontNode);lb.xg.add(v.a.zb(l.a.embeddedFontNode));return!0}return!1}static nh(){return new la}static get instance(){return la.Pg.value}}la.Pg=new a.a(la.nh);Object(D.a)(la,"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class na extends k.a{constructor(){super()}get Gn(){return 30}get Qz(){return 3}static nh(){return new na}static get instance(){return na.Pg.value}}na.Pg=new a.a(na.nh);Object(D.a)(na,"EmbeddedFontNodeComplexMerge",
k.a,[]);class Ca extends k.a{constructor(){super()}get Gn(){return 11}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.V6),4);lb.Z(v.a.zb(l.a.q_a),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.q_a)){const pc=lb.Sk,Db=lb.Yd;r.a.instance.Sa(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",pc.id,pc.Rc,Tb);Tb=Db.getPropertyObjectIds(lb.Sg.value.Eu,l.a.q_a);const Ob=Db.getPropertyObjectIds(lb.Sg.value.Af,l.a.q_a),jb=Db.getPropertyObjectIds(lb.nn.value.Af,
l.a.q_a);Tb=this.Sxi(Tb,Ob,jb,(tb,ac)=>tb.equals(ac));0<Tb.length?Db.setPropertyObjectIds(pc,l.a.q_a,Tb):pc.removeProperty(l.a.q_a);lb.xg.add(v.a.zb(l.a.q_a));return!0}r.a.instance.Sa(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}static nh(){return new Ca}static get instance(){return Ca.Pg.value}}Ca.Pg=new a.a(Ca.nh);Object(D.a)(Ca,"FootnoteEndnoteContainerNodeComplexMerge",
k.a,[]);class Na extends k.a{constructor(){super()}get Gn(){return 12}get Qz(){return 3}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.gma),1);return lb}rB(lb,Tb){const pc=lb.Sk,Db=lb.Yd;if(Tb===v.a.zb(l.a.gma)){let Ob=-1;r.a.instance.Sa(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",pc.id,pc.Rc,Tb);const jb=Db.getPropertyInt32(lb.Sg.value.Af,l.a.gma),tb=Db.getPropertyInt32(lb.nn.value.Af,l.a.gma);null!=jb&&-1!==jb?Ob=jb:null!=tb&&
(Ob=tb);Db.setPropertyInt32(pc,l.a.gma,Ob);lb.xg.add(Tb);return!0}r.a.instance.Sa(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Eu.id,Tb);return!1}static nh(){return new Na}static get instance(){r.a.instance.Sa(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Na.Pg.value}}Na.Pg=new a.a(Na.nh);Object(D.a)(Na,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class Ta extends k.a{constructor(){super()}get Gn(){return 47}qk(){const lb=
super.qk();lb.Z(v.a.zb(l.a.glossaryPageContentNode),1);return lb}rB(lb,Tb){return Tb===v.a.zb(l.a.glossaryPageContentNode)?(r.a.instance.Sa(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lb.Sk.id,lb.Sk.Rc,Tb),k.a.LEf(lb,this,l.a.glossaryPageContentNode)):!1}static nh(){return new Ta}static get instance(){return Ta.Pg.value}}Ta.Pg=new a.a(Ta.nh);Object(D.a)(Ta,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class Fa extends k.a{constructor(){super()}get Gn(){return 13}get Qz(){return 3}qk(){const lb=
super.qk();lb.Z(v.a.zb(l.a.Hha),4);return lb}static nh(){return new Fa}static get instance(){return Fa.Pg.value}}Fa.Pg=new a.a(Fa.nh);Object(D.a)(Fa,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class qa extends k.a{constructor(){super()}get Gn(){return 14}get Qz(){return 3}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.runId),3);lb.Z(v.a.zb(l.a.Pc),3);lb.Z(v.a.zb(l.a.kgi),3);lb.Z(v.a.zb(l.a.GT),1);lb.Z(v.a.zb(e.a.VZ),1);lb.Z(v.a.zb(w.a.imageAltText),1);lb.Z(v.a.zb(l.a.gX),1);lb.Z(v.a.zb(w.a.Pba),1);
lb.Z(v.a.zb(e.a.$6a),1);lb.Z(v.a.zb(l.a.VXa),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(w.a.imageAltText)||Tb===v.a.zb(l.a.gX)||Tb===v.a.zb(l.a.GT)||Tb===v.a.zb(l.a.hX)||Tb===v.a.zb(w.a.uhb)||Tb===v.a.zb(w.a.Pba)||Tb===v.a.zb(e.a.VZ)||Tb===v.a.zb(e.a.$6a)||Tb===v.a.zb(l.a.VXa)){const Db=lb.Sk;var pc=lb.Yd;r.a.instance.Sa(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Db.id,Db.Rc,Tb);const Ob=pc.getPropertyInt32(lb.Sg.value.Af,e.a.VZ);pc=pc.getPropertyInt32(lb.nn.value.Af,
e.a.VZ);if(null!=Ob&&(0===Ob||2===Ob))return!0;if(null!=pc&&(0===pc||2===pc))return Tb=lb.nn.value.Af,this.Pdb(Tb,Db,w.a.imageAltText),this.Pdb(Tb,Db,l.a.gX),this.Pdb(Tb,Db,l.a.hX),Tb.hasProperty(l.a.GT)&&this.Pdb(Tb,Db,l.a.GT),this.Pdb(Tb,Db,w.a.uhb),this.Pdb(Tb,Db,w.a.Pba),this.Pdb(Tb,Db,e.a.VZ),this.Pdb(Tb,Db,e.a.$6a),lb.xg.add(v.a.zb(w.a.imageAltText)),lb.xg.add(v.a.zb(l.a.gX)),lb.xg.add(v.a.zb(l.a.hX)),lb.xg.add(v.a.zb(l.a.GT)),lb.xg.add(v.a.zb(w.a.uhb)),lb.xg.add(v.a.zb(w.a.Pba)),lb.xg.add(v.a.zb(e.a.VZ)),
lb.xg.add(v.a.zb(e.a.$6a)),lb.xg.add(v.a.zb(l.a.VXa)),!0}r.a.instance.Sa(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Eu.id,Tb);return!1}static nh(){return new qa}static get instance(){return qa.Pg.value}}qa.Pg=new a.a(qa.nh);Object(D.a)(qa,"ImageNodeComplexMerge",k.a,[]);class ja extends k.a{constructor(){super()}get Gn(){return 40}get Qz(){return 0}static nh(){return new ja}static get instance(){return ja.Pg.value}}
ja.Pg=new a.a(ja.nh);Object(D.a)(ja,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class X extends k.a{constructor(){super()}get Gn(){return 32}get Qz(){return 0}static nh(){return new X}static get instance(){return X.Pg.value}}X.Pg=new a.a(X.nh);Object(D.a)(X,"IntelligenceContentLocatorNodeComplexMerge",k.a,[]);class ua extends k.a{constructor(){super()}get Gn(){return 34}get Qz(){return 0}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.Yhb),1);return lb}rB(lb,Tb){const pc=lb.Sk,Db=lb.Yd;if(Tb===v.a.zb(l.a.Yhb)){Tb=
Db.getPropertyObjectIds(lb.Sg.value.Eu,l.a.Yhb);const Ob=Db.getPropertyObjectIds(lb.Sg.value.Af,l.a.Yhb),jb=Db.getPropertyObjectIds(lb.nn.value.Af,l.a.Yhb);Tb=this.REa(Tb,Ob,jb);Db.setPropertyObjectIds(pc,l.a.Yhb,Tb);lb.xg.add(v.a.zb(l.a.Yhb));return!0}return!1}static nh(){return new ua}static get instance(){return ua.Pg.value}}ua.Pg=new a.a(ua.nh);Object(D.a)(ua,"IntelligenceRegionNodeComplexMerge",k.a,[]);class Ha extends k.a{constructor(){super()}get Gn(){return 35}get Qz(){return 0}static nh(){return new Ha}static get instance(){return Ha.Pg.value}}
Ha.Pg=new a.a(Ha.nh);Object(D.a)(Ha,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class Ea extends k.a{constructor(){super()}get Gn(){return 39}get Qz(){return 0}static nh(){return new Ea}static get instance(){return Ea.Pg.value}}Ea.Pg=new a.a(Ea.nh);Object(D.a)(Ea,"IntelligenceReviewedNodeComplexMerge",k.a,[]);class wa extends k.a{constructor(){super()}get Gn(){return 33}get Qz(){return 0}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.BPc),1);lb.Z(v.a.zb(l.a.fRd),1);lb.Z(v.a.zb(l.a.mtf),1);lb.Z(v.a.zb(l.a.otf),
1);return lb}rB(lb,Tb){const pc=lb.Sk,Db=lb.Yd;if(Tb===v.a.zb(l.a.BPc)||Tb===v.a.zb(l.a.fRd)||Tb===v.a.zb(l.a.mtf)||Tb===v.a.zb(l.a.otf)){Tb=Tb===v.a.zb(l.a.BPc)?l.a.BPc:l.a.fRd;var Ob=Db.getPropertyObjectIds(lb.Sg.value.Eu,Tb);const jb=Db.getPropertyObjectIds(lb.Sg.value.Af,Tb),tb=Db.getPropertyObjectIds(lb.nn.value.Af,Tb);Ob=this.REa(Ob,jb,tb);Db.setPropertyObjectIds(pc,Tb,Ob);lb.xg.add(v.a.zb(Tb));return!0}return!1}static nh(){return new wa}static get instance(){return wa.Pg.value}}wa.Pg=new a.a(wa.nh);
Object(D.a)(wa,"IntelligenceRootNodeComplexMerge",k.a,[]);class sa extends k.a{constructor(){super()}get Gn(){return 42}get Qz(){return 0}static nh(){return new sa}static get instance(){return sa.Pg.value}}sa.Pg=new a.a(sa.nh);Object(D.a)(sa,"IntelligenceSettingNodeComplexMerge",k.a,[]);class fa extends k.a{constructor(){super()}get Gn(){return 45}get Qz(){return 0}static nh(){return new fa}static get instance(){return fa.Pg.value}}fa.Pg=new a.a(fa.nh);Object(D.a)(fa,"IntelligenceWorkflowNodeComplexMerge",
k.a,[]);class Ma extends k.a{constructor(){super()}get Gn(){return 15}get Qz(){return 3}static nh(){return new Ma}static get instance(){return Ma.Pg.value}}Ma.Pg=new a.a(Ma.nh);Object(D.a)(Ma,"NumberListNodeComplexMerge",k.a,[]);var Ua=c(124);class Qa extends k.a{constructor(){super()}get Gn(){return 16}get Qz(){return 0}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.Wxb),1);lb.Z(v.a.zb(Ua.a.G1e),7);lb.Z(v.a.zb(Ua.a.E1e),7);return lb}rB(lb,Tb){const pc=lb.Sk,Db=lb.Yd;if(Tb===v.a.zb(l.a.Wxb))return this.Kzf(Db,
lb.Sg.value.Af,lb.nn.value.Af,pc,l.a.Wxb),lb.xg.add(Tb),!0;r.a.instance.Sa(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Eu.id,Tb);return!1}static nh(){return new Qa}static get instance(){return Qa.Pg.value}}Qa.Pg=new a.a(Qa.nh);Object(D.a)(Qa,"OutlineElementNodeComplexMerge",k.a,[]);class Ja extends k.a{constructor(){super()}get Gn(){return 17}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.Wxb),1);
lb.Z(v.a.zb(l.a.Kla),1);lb.Z(v.a.zb(Ua.a.wI),1);lb.Z(v.a.zb(Ua.a.z$b),1);lb.Z(v.a.zb(Ua.a.bha),8);return lb}rB(lb,Tb){const pc=lb.Sk,Db=lb.Yd;if(Tb===v.a.zb(l.a.Wxb))return this.Kzf(Db,lb.Sg.value.Af,lb.nn.value.Af,pc,l.a.Wxb),lb.xg.add(Tb),!0;if(Tb===v.a.zb(l.a.Kla)){var Ob=Db.getPropertyBool(lb.Sg.value.Af,l.a.Kla),jb=Db.getPropertyBool(lb.nn.value.Af,l.a.Kla);Db.setPropertyBool(pc,l.a.Kla,null==Ob?!1:Ob&&null==jb?!1:jb);lb.xg.add(Tb);return!0}if(Tb===v.a.zb(Ua.a.z$b))return this.Kzf(Db,lb.Sg.value.Af,
lb.nn.value.Af,pc,Ua.a.z$b),lb.xg.add(Tb),!0;if(Tb===v.a.zb(Ua.a.wI))return Ob=Db.getPropertyBool(lb.Sg.value.Af,Ua.a.wI),jb=Db.getPropertyBool(lb.nn.value.Af,Ua.a.wI),Db.setPropertyBool(pc,Ua.a.wI,null==Ob?!0:Ob||null==jb?!0:jb),lb.xg.add(Tb),!0;r.a.instance.Sa(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Eu.id,Tb);return!1}static nh(){return new Ja}static get instance(){return Ja.Pg.value}}Ja.Pg=
new a.a(Ja.nh);Object(D.a)(Ja,"OutlineGroupNodeComplexMerge",k.a,[]);var Wa=c(45),Ya=c(52);class sb extends k.a{constructor(){super()}get Gn(){return 18}get Qz(){return 2}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.$Od),3);lb.Z(v.a.zb(w.a.Gba),this.Qz);lb.Z(v.a.zb(l.a.Ut),1);lb.Z(v.a.zb(l.a.f8),1);lb.Z(v.a.zb(l.a.pq),1);lb.Z(v.a.zb(Wa.a.aJ),1);lb.Z(v.a.zb(Wa.a.p3a),1);return lb}rB(lb,Tb){const pc=lb.Yd;if(lb.Ip.runtime.$b.isFeatureEnabled(70)){if(Tb===v.a.zb(l.a.Ut)||Tb===v.a.zb(l.a.f8)||Tb===v.a.zb(Wa.a.p3a)||
Tb===v.a.zb(l.a.pq)||Tb===v.a.zb(Wa.a.aJ))return this.Wro(pc,lb)}else if(Tb===v.a.zb(l.a.Ut)||Tb===v.a.zb(l.a.pq)){let Db,Ob;({jEc:Tb,E1a:Db,w1a:Ob}=this.O_e(Object(Ya.a)(pc,pc.getPropertyUint32s,"getPropertyUint32s"),lb.Sg.value.Eu,lb.Sg.value.Af,lb.nn.value.Af,l.a.Ut,null));if(!Ob&&!Db)return r.a.instance.Sa(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",lb.Sg.value.Af.id,v.a.zb(l.a.Ut)),!0;let jb,tb,ac;({jEc:jb,
E1a:tb,w1a:ac}=this.O_e(Object(Ya.a)(pc,pc.getPropertyObjectIds,"getPropertyObjectIds"),lb.Sg.value.Eu,lb.Sg.value.Af,lb.nn.value.Af,l.a.pq,null));if(!tb&&!ac)return r.a.instance.Sa(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",lb.Sg.value.Af.id,v.a.zb(l.a.pq)),!0;const zc=tb&&!ac;if((Db&&!Ob)!==zc)return r.a.instance.Sa(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
lb.Sg.value.Af.id,v.a.zb(l.a.Ut),v.a.zb(l.a.pq)),!1;zc&&(pc.setPropertyObjectIds(lb.Sk,l.a.pq,jb),pc.setPropertyUint32s(lb.Sk,l.a.Ut,Tb));r.a.instance.Sa(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",lb.Sg.value.Af.id,v.a.zb(l.a.Ut),Db,Ob,v.a.zb(l.a.pq),tb,ac);lb.xg.add(v.a.zb(l.a.pq));lb.xg.add(v.a.zb(l.a.Ut));
return!0}r.a.instance.Sa(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}Q$h(lb,Tb,pc,Db){let Ob;({jEc:Tb,E1a:Db,w1a:Ob}=this.O_e(Tb,pc.Sg.value.Eu,pc.Sg.value.Af,pc.nn.value.Af,lb,Db));return Ob||Db?{returnValue:!0,e2e:Tb,E1a:Db,w1a:Ob}:(r.a.instance.Sa(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
pc.Sg.value.Af.id.toString(),v.a.zb(lb)),{returnValue:!1,e2e:Tb,E1a:Db,w1a:Ob})}R9h(lb,Tb,pc,Db,Ob){let jb;let tb,ac,zc,yc;({e2e:jb,E1a:cd,w1a:tb,returnValue:zc}=this.Q$h(lb,Object(Ya.a)(pc,pc.getPropertyUint32s,"getPropertyUint32s"),Db,null));({e2e:pc,E1a:Ob,w1a:ac,returnValue:yc}=this.Q$h(Tb,Object(Ya.a)(pc,pc.getPropertyObjectIds,"getPropertyObjectIds"),Db,Ob));var cd=cd&&!tb;return zc&&yc?cd!==(Ob&&!ac)?(r.a.instance.Sa(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Db.Sg.value.Af.id.toString(),v.a.zb(lb),v.a.zb(Tb)),{returnValue:2,oAd:jb,nAd:pc,Wee:cd}):{returnValue:0,oAd:jb,nAd:pc,Wee:cd}:{returnValue:1,oAd:jb,nAd:pc,Wee:cd}}gvf(lb){let Tb=!0;lb.forEach(pc=>pc!==ca.a.nil?Tb=!1:!0);return Tb}$Bl(lb,Tb,pc){return this.gvf(lb)&&this.gvf(Tb)&&this.gvf(pc)?!0:!1}Wro(lb,Tb){let pc,Db,Ob,jb,tb,ac;var zc=({oAd:jb,nAd:tb,Wee:Db}=this.R9h(Wa.a.p3a,l.a.pq,lb,Tb,null)).returnValue;if(2===zc||1===zc)return!0;({oAd:Ob,nAd:ac,Wee:pc,returnValue:zc}=this.R9h(l.a.Ut,l.a.f8,
lb,Tb,Object(Ya.a)(this,this.$Bl,"getExtendedGuidEquivalence")));if(2===zc||1===zc)return!0;let yc;({jEc:zc,E1a:cd,w1a:yc}=this.gDk(Object(Ya.a)(lb,lb.getPropertyDictionary,"getPropertyDictionary"),Tb.Sg.value.Eu,Tb.Sg.value.Af,Tb.nn.value.Af,Wa.a.aJ));if(!yc&&!cd)return r.a.instance.Sa(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Tb.Sg.value.Af.id.toString(),v.a.zb(Wa.a.aJ)),!0;var cd=cd&&!yc;if(pc!==Db||pc!==
cd)return r.a.instance.Sa(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Tb.Sg.value.Af.id.toString(),v.a.zb(l.a.Ut),v.a.zb(Wa.a.p3a),v.a.zb(Wa.a.aJ),Db,pc,cd),!0;pc&&(lb.setPropertyObjectIds(Tb.Sk,l.a.pq,tb),lb.setPropertyUint32s(Tb.Sk,Wa.a.p3a,jb),lb.setPropertyObjectIds(Tb.Sk,
l.a.f8,ac),lb.setPropertyUint32s(Tb.Sk,l.a.Ut,Ob),lb.setPropertyDictionary(Tb.Sk,Wa.a.aJ,zc));r.a.instance.Sa(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Tb.Sg.value.Af.id.toString(),Db,pc,cd);Tb.xg.add(v.a.zb(Wa.a.p3a));Tb.xg.add(v.a.zb(l.a.pq));Tb.xg.add(v.a.zb(l.a.Ut));Tb.xg.add(v.a.zb(l.a.f8));Tb.xg.add(v.a.zb(Wa.a.aJ));return!0}static nh(){return new sb}static get instance(){return sb.Pg.value}}
sb.Pg=new a.a(sb.nh);Object(D.a)(sb,"PageContentNodeComplexMerge",k.a,[]);class ob extends k.a{constructor(){super()}get Gn(){return 19}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.uGa),1);lb.Z(v.a.zb(l.a.appsNode),2);lb.Z(v.a.zb(l.a.customXmlPartContainerNode),2);lb.Z(v.a.zb(l.a.intelligenceRootNode),1);return lb}rB(lb,Tb){const pc=lb.Yd;if(Tb===v.a.zb(l.a.uGa)){var Db=pc.getPropertyObjectIds(lb.Sg.value.Eu,l.a.uGa),Ob=pc.getPropertyObjectIds(lb.Sg.value.Af,l.a.uGa),jb=pc.getPropertyObjectIds(lb.nn.value.Af,
l.a.uGa);if((Db=this.PTm(Db,Ob,jb,(tb,ac)=>tb.equals(ac),tb=>{let ac;({value:ac}=lb.Ip.runtime.vq.Gc(tb)).returnValue?lb.Ip.runtime.Ym.Z(tb,new z.a(ac,!1)):r.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},lb.Ip))&&0<Db.length)return pc.setPropertyObjectIds(lb.Sk,l.a.uGa,Db),lb.xg.add(v.a.zb(l.a.uGa)),!0}if(Tb===v.a.zb(l.a.intelligenceRootNode))return Db=pc.getPropertyObjectIds(lb.Sg.value.Eu,l.a.intelligenceRootNode),
Ob=pc.getPropertyObjectIds(lb.Sg.value.Af,l.a.intelligenceRootNode),jb=pc.getPropertyObjectIds(lb.nn.value.Af,l.a.intelligenceRootNode),Db=this.REa(Db,Ob,jb),pc.setPropertyObjectIds(lb.Sk,l.a.intelligenceRootNode,Db),lb.xg.add(Tb),!0;r.a.instance.Sa(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}static nh(){return new ob}static get instance(){return ob.Pg.value}}ob.Pg=new a.a(ob.nh);
Object(D.a)(ob,"PageManifestNodeComplexMerge",k.a,[]);class fc extends k.a{constructor(){super()}get Gn(){return 43}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.Kka),0);lb.Z(v.a.zb(l.a.sJb),0);lb.Z(v.a.zb(l.a.ZFb),0);lb.Z(v.a.zb(l.a.Mma),1);lb.Z(v.a.zb(l.a.sessionId),3);lb.Z(v.a.zb(l.a.buildVersion),3);lb.Z(v.a.zb(l.a.BX),1);lb.Z(v.a.zb(l.a.zji),1);lb.Z(v.a.zb(l.a.Yu),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(l.a.BX)||Tb===v.a.zb(l.a.zji)||Tb===v.a.zb(l.a.Yu)){var pc=lb.nn.value.Af,Db=lb.Sg.value.Af,Ob=v.a.QW(Tb);
Db=lb.Yd.getPropertyBool(Db,Ob);pc=lb.Yd.getPropertyBool(pc,Ob);lb.Yd.setPropertyBool(lb.Sk,Ob,null==Db?!1:Db&&null==pc?!1:pc);lb.xg.add(Tb);return!0}if(Tb===v.a.zb(l.a.Mma)){Tb=lb.Yd;pc=lb.Sg.value.Eu;Db=lb.nn.value.Af;Ob=lb.Sg.value.Af;pc=pc?Tb.getPropertyObjectId(pc,l.a.Mma):null;Db=Db?Tb.getPropertyObjectId(Db,l.a.Mma):null;Ob=Ob?Tb.getPropertyObjectId(Ob,l.a.Mma):null;r.a.instance.Sa(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",pc?pc.toString():
"NULL",Db?Db.toString():"NULL",Ob?Ob.toString():"NULL");if(Db){if(Ob&&Db.equals(Ob))return lb.xg.add(v.a.zb(l.a.Mma)),Tb.setPropertyObjectId(lb.Sk,l.a.Mma,Db),!0;if(ia.a.CNd.equals(Db))return lb.xg.add(v.a.zb(l.a.Mma)),Tb.setPropertyObjectId(lb.Sk,l.a.Mma,ia.a.CNd),!0}if(Ob&&ia.a.CNd.equals(Ob))return lb.xg.add(v.a.zb(l.a.Mma)),Tb.setPropertyObjectId(lb.Sk,l.a.Mma,ia.a.CNd),!0;r.a.instance.Sa(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",pc?pc.toString():
"NULL",Db?Db.toString():"NULL",Ob?Ob.toString():"NULL")}return!1}static nh(){return new fc}static get instance(){return fc.Pg.value}}fc.Pg=new a.a(fc.nh);Object(D.a)(fc,"PageMetadataNodeComplexMerge",k.a,[]);var Eb=c(1721),Ib=c(108);class Nb extends k.a{constructor(){super()}get Gn(){return 31}qk(){const lb=super.qk();lb.Z(v.a.zb(Ib.a.$v),1);lb.Z(v.a.zb(l.a.listID),3);lb.Z(v.a.zb(l.a.listLevel),1);lb.Z(v.a.zb(l.a.ve),3);lb.Z(v.a.zb(l.a.m_b),3);lb.Z(v.a.zb(l.a.runId),3);lb.Z(v.a.zb(l.a.yFd),3);lb.Z(v.a.zb(w.a.fontColor),
3);lb.Z(v.a.zb(l.a.Pvh),3);lb.Z(v.a.zb(l.a.Pc),1);lb.Z(v.a.zb(Ib.a.hSd),3);lb.Z(v.a.zb(Ib.a.xzf),3);lb.Z(v.a.zb(Ib.a.dRc),3);lb.Z(v.a.zb(l.a.fnl),3);lb.Z(v.a.zb(Ua.a.bnj),3);for(let Tb=0;Tb<Nb.C2a.length;Tb++)lb.Z(Nb.C2a[Tb],1);return lb}rB(lb,Tb){var pc=lb.Yd;const Db=lb.Sk;var Ob=lb.Ip.runtime.$b.isFeatureEnabled(123);v.a.QW(Tb);if(Tb===v.a.zb(l.a.Pc)){pc=lb.Yd.getPropertyInt32(lb.nn.value.Af,l.a.Pc);if(null==pc||!pc)return!0;lb.Yd.setPropertyInt32(Db,l.a.Pc,pc);lb.xg.add(Tb);return!0}if(Tb===v.a.zb(Ib.a.$v)){Ob=
pc.getPropertyUint32(lb.Sg.value.Af,Ib.a.$v);const jb=pc.getPropertyUint32(lb.nn.value.Af,Ib.a.$v);if(null!=Ob&&null!=jb&&Ob===jb)return pc.setPropertyUint32(Db,Ib.a.$v,Ob),lb.xg.add(Tb),!0;if(null==Ob&&null==jb)return Db.removeProperty(Ib.a.$v),lb.xg.add(v.a.zb(Ib.a.$v)),!0;if(null!=Ob&&null==jb)return pc.setPropertyUint32(Db,Ib.a.$v,Ob),lb.xg.add(Tb),!0;if(null==Ob&&null!=jb)return pc.setPropertyUint32(Db,Ib.a.$v,jb),lb.xg.add(Tb),!0}else{if(Tb===v.a.zb(l.a.listLevel))return this.oro(pc,lb);if(Tb===
v.a.zb(e.a.paragraphStyle)){if(Ob)return this.ylj(lb)}else if(Array.contains(Nb.C2a,Tb))return this.ylj(lb)}return!1}ylj(lb){let Tb=!0,pc=!0,Db,Ob;({pom:Tb,Olm:pc,jgl:Db,hMk:Ob}=this.hDk(lb));r.a.instance.Sa(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",lb.Sg.value.Af.id.toString(),Tb,pc);return Tb&&!pc?(this.Gyi(Ob,lb),!0):Tb?!1:(this.Gyi(Db,lb),!0)}hDk(lb){let Tb,pc,Db,Ob;const jb=lb.nn.value;
let tb;const ac=lb.Sg.value;let zc;pc=Tb=!0;Db=new I.a;Ob=new I.a;for(let yc=0;yc<Nb.C2a.length;yc++){const cd=Nb.C2a[yc],Cd=({value:tb}=jb.Joa.Gc(cd)).returnValue;({value:zc}=ac.Joa.Gc(cd)).returnValue&&(Tb=this.ilj(lb.Sg,Db,zc,cd)&&Tb);Cd&&(pc=this.ilj(lb.nn,Ob,tb,cd)&&pc)}return{pom:Tb,Olm:pc,jgl:Db,hMk:Ob}}ilj(lb,Tb,pc,Db){const Ob=v.a.QW(Db);lb=lb.value.Af;Tb.Z(Db,lb.hasProperty(Ob)?lb.cQ(Ob):null);return!pc.qX}Gyi(lb,Tb){const pc=Tb.Sk;for(let Ob=0;Ob<Nb.C2a.length;Ob++){var Db=Nb.C2a[Ob];const jb=
v.a.QW(Db);(Db=lb.J(Db))?pc.Bxa(jb,Db):pc.removeProperty(jb)}for(lb=0;lb<Nb.C2a.length;lb++)Tb.xg.add(Nb.C2a[lb]);r.a.instance.Sa(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Tb.Sg.value.Af.id.toString())}oro(lb,Tb){const pc=Tb.Sk,Db=lb.getPropertyInt32(Tb.Sg.value.Af,l.a.listLevel),Ob=lb.getPropertyInt32(Tb.nn.value.Af,l.a.listLevel);return null!=Db&&null!=Ob&&Db===Ob?(lb.setPropertyInt32(pc,l.a.listLevel,Db),Tb.xg.add(v.a.zb(l.a.listLevel)),
!0):null==Db&&null==Ob?(pc.removeProperty(l.a.listLevel),Tb.xg.add(v.a.zb(l.a.listLevel)),!0):null!=Db&&null==Ob?(lb.setPropertyInt32(pc,l.a.listLevel,Db),Tb.xg.add(v.a.zb(l.a.listLevel)),!0):null==Db&&null!=Ob?(lb.setPropertyInt32(pc,l.a.listLevel,Ob),Tb.xg.add(v.a.zb(l.a.listLevel)),!0):!1}static nh(){return new Nb}static get instance(){return Nb.Pg.value}}Nb.Pg=new a.a(Nb.nh);Nb.C2a=[v.a.zb(l.a.fe),v.a.zb(l.a.tt),v.a.zb(w.a.L3),v.a.zb(l.a.lba),v.a.zb(l.a.Vt),v.a.zb(l.a.Gr),v.a.zb(w.a.l_),v.a.zb(l.a.eXe),
v.a.zb(w.a.font),v.a.zb(Ua.a.Ejb),v.a.zb(e.a.paragraphStyle)];Object(D.a)(Nb,"PersistablePropertySetComplexMerge",k.a,[]);class pb extends k.a{constructor(){super()}get Gn(){return 21}get Qz(){return 0}static nh(){return new pb}static get instance(){return pb.Pg.value}}pb.Pg=new a.a(pb.nh);Object(D.a)(pb,"RevisionMetadataNodeComplexMerge",k.a,[]);class Aa extends k.a{constructor(){super()}get Gn(){return 48}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.MNi),3);return lb}static nh(){return new Aa}static get instance(){return Aa.Pg.value}}
Aa.Pg=new a.a(Aa.nh);Object(D.a)(Aa,"ShadowNumberListNodeComplexMerge",k.a,[]);class xb extends k.a{constructor(){super()}get Gn(){return 22}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.languageHint),7);lb.Z(v.a.zb(l.a.GRc),2);return lb}static nh(){return new xb}static get instance(){return xb.Pg.value}}xb.Pg=new a.a(xb.nh);Object(D.a)(xb,"SharedPersistablePropertySetComplexMerge",k.a,[]);class gb extends k.a{constructor(){super()}get Gn(){return 38}get Qz(){return 3}static nh(){return new gb}static get instance(){return gb.Pg.value}}
gb.Pg=new a.a(gb.nh);Object(D.a)(gb,"StylePropertySetComplexMerge",k.a,[]);var Xa=c(1543),Va=c(1583);class Gb extends k.a{constructor(){super()}get Gn(){return 23}get Qz(){return 0}qk(){const lb=super.qk();lb.Z(v.a.zb(w.a.gf),4);lb.Z(v.a.zb(l.a.rowSpan),1);lb.Z(v.a.zb(l.a.colSpan),1);lb.Z(v.a.zb(l.a.ghostCell),1);lb.Z(v.a.zb(Wa.a.vMerge),1);lb.Z(v.a.zb(Wa.a.gridSpan),1);lb.Z(v.a.zb(l.a.p6a),2);lb.Z(v.a.zb(l.a.rob),2);lb.Z(v.a.zb(l.a.RGa),2);lb.Z(v.a.zb(l.a.Onb),5);return lb}gGb(lb){if(!lb)return r.a.instance.Sa(573957923,
1,2,"Feature helper is null"),!1;lb.ez(106);return lb.isFeatureEnabled(106)}pga(lb){if(!lb)return r.a.instance.Sa(540120285,1,2,"Feature helper is null"),!1;lb.ez(107);return lb.isFeatureEnabled(107)}rB(lb,Tb){lb.Ip.runtime.sG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+Tb);var pc=Tb===v.a.zb(l.a.rowSpan)||Tb===v.a.zb(l.a.colSpan)||Tb===v.a.zb(l.a.ghostCell);this.pga(lb.Ip.runtime.$b)&&(pc=pc||Tb===v.a.zb(Wa.a.vMerge)||Tb===v.a.zb(Wa.a.gridSpan));if(!this.gGb(lb.Ip.runtime.$b))return!pc;
var Db=lb.nn.value.Eu,Ob=Va.e(lb.Ip,Db,null);if(Ob.equals(ca.a.nil))return r.a.instance.Sa(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Db.id),lb.Ip.logger.Vg(Object.assign(new Xa.a,{info:"Table node ID could not be found for table cell"})),!1;var jb=lb.Ip.runtime.fzb.J(Ob).J(Db.id);if(!jb)return!pc;Db=lb.Sk;Ob=lb.Yd;if(Tb===v.a.zb(l.a.ghostCell))return Ob.setPropertyBool(Db,l.a.ghostCell,jb.pg),lb.xg.add(v.a.zb(l.a.ghostCell)),!0;if(Tb===v.a.zb(l.a.rowSpan))return Tb=
jb.rowSpan,jb=jb.colSpan,null!=Tb&&null!=jb&&(1<Tb||1<jb)?Ob.setPropertyUint32(Db,l.a.rowSpan,Tb):Db.removeProperty(l.a.rowSpan),lb.xg.add(v.a.zb(l.a.rowSpan)),!0;if(Tb===v.a.zb(l.a.colSpan))return Tb=jb.rowSpan,pc=jb.colSpan,jb=jb.pg,null!=Tb&&null!=pc&&(1<Tb||1<pc)?Ob.setPropertyUint32(Db,l.a.colSpan,pc):jb&&null!=pc?Ob.setPropertyUint32(Db,l.a.colSpan,pc):Db.removeProperty(l.a.colSpan),lb.xg.add(v.a.zb(l.a.colSpan)),!0;r.a.instance.Sa(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",
Tb);lb.Ip.logger.Vg(Object.assign(new Xa.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!pc}static nh(){return new Gb}static get instance(){return Gb.Pg.value}}Gb.Pg=new a.a(Gb.nh);Object(D.a)(Gb,"TableCellNodeComplexMerge",k.a,[]);class Xb extends k.a{constructor(){super()}get Gn(){return 24}gGb(lb){if(!lb)return r.a.instance.Sa(573845782,1,2,"Feature helper is null"),!1;lb.ez(106);return lb.isFeatureEnabled(106)}get Qz(){return 0}qk(){const lb=
super.qk();lb.Z(v.a.zb(w.a.gf),1);lb.Z(v.a.zb(w.a.d0),1);lb.Z(v.a.zb(w.a.Oxa),1);lb.Z(v.a.zb(l.a.gic),1);lb.Z(v.a.zb(l.a.X8),1);lb.Z(v.a.zb(l.a.p6a),2);lb.Z(v.a.zb(l.a.rob),2);lb.Z(v.a.zb(l.a.RGa),2);return lb}rB(lb,Tb){lb.Ip.runtime.sG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Tb);if(Tb===v.a.zb(w.a.gf)||Tb===v.a.zb(w.a.d0)||Tb===v.a.zb(l.a.gic)||Tb===v.a.zb(l.a.X8)||Tb===v.a.zb(w.a.Oxa)){const Ob=lb.Sk;var pc=lb.Yd;r.a.instance.Sa(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ob.id,Ob.Rc,Tb);if(this.c7k(lb))return!1;var Db=pc.getPropertyObjectIds(lb.Sg.value.Eu,w.a.gf);const jb=pc.getPropertyObjectIds(lb.Sg.value.Af,w.a.gf),tb=pc.getPropertyObjectIds(lb.nn.value.Af,w.a.gf);Db=this.Sxi(Db,jb,tb,(ac,zc)=>ac.equals(zc));if(0<Db.length)return pc.setPropertyObjectIds(Ob,w.a.gf,Db),pc.setPropertyInt32(Ob,w.a.Oxa,Db.length),this.gGb(lb.Ip.runtime.$b)&&({value:Tb}=lb.nn.value.Joa.Gc(v.a.zb(w.a.d0)),{value:pc}=lb.Sg.value.Joa.Gc(v.a.zb(w.a.d0)),Tb.qX?Ob.Bxa(w.a.d0,Tb.newValue):
Ob.Bxa(w.a.d0,pc.newValue)),lb.xg.add(v.a.zb(w.a.gf)),lb.xg.add(v.a.zb(w.a.d0)),lb.xg.add(v.a.zb(w.a.Oxa)),lb.xg.add(v.a.zb(l.a.gic)),lb.xg.add(v.a.zb(l.a.X8)),!0}r.a.instance.Sa(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}c7k(lb){const Tb=lb.nn.value,pc=lb.Sg.value;let Db,Ob;({value:Db}=Tb.Joa.Gc(v.a.zb(w.a.d0)));({value:Ob}=pc.Joa.Gc(v.a.zb(w.a.d0)));return Db.qX||Ob.qX?Db.qX&&Ob.qX?(r.a.instance.Sa(4273304,
1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",Db.oldValue,Ob.newValue,Db.newValue),lb.Ip.logger.Vg(Object.assign(new Xa.a,{tj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Xb.wGh(lb.Ip,Db,pc,"BaseConflict")||Xb.wGh(lb.Ip,Ob,Tb,"BaseFavored")?!0:!1:!1}static nh(){return new Xb}static get instance(){return Xb.Pg.value}static wGh(lb,Tb,pc,Db){return Tb.qX&&({value:Tb}=pc.Joa.Gc(v.a.zb(w.a.gf)),
Tb.qX)?(r.a.instance.Sa(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",Db),lb.logger.Vg(Object.assign(new Xa.a,{tj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Xb.Pg=new a.a(Xb.nh);Object(D.a)(Xb,"TableNodeComplexMerge",k.a,[]);class rc extends k.a{constructor(){super()}get Gn(){return 25}get Qz(){return 0}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.Pc),3);lb.Z(v.a.zb(w.a.gf),4);lb.Z(v.a.zb(l.a.p6a),
2);lb.Z(v.a.zb(l.a.rob),2);lb.Z(v.a.zb(l.a.RGa),2);lb.Z(v.a.zb(Wa.a.m9f),2);lb.Z(v.a.zb(Wa.a.l9f),2);lb.Z(v.a.zb(l.a.Onb),5);return lb}static nh(){return new rc}static get instance(){return rc.Pg.value}}rc.Pg=new a.a(rc.nh);Object(D.a)(rc,"TableRowNodeComplexMerge",k.a,[]);class qb extends k.a{constructor(){super()}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.pko),2);lb.Z(v.a.zb(w.a.gf),1);return lb}rB(lb,Tb){if(Tb===v.a.zb(w.a.gf)){const Db=lb.Sk,Ob=lb.Yd;r.a.instance.Sa(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Db.id,Db.Rc,Tb);var pc=Ob.getPropertyObjectIds(lb.Sg.value.Eu,w.a.gf);const jb=Ob.getPropertyObjectIds(lb.Sg.value.Af,w.a.gf),tb=Ob.getPropertyObjectIds(lb.nn.value.Af,w.a.gf);if(pc=this.$Tm(pc,jb,tb))return 0<pc.length?Ob.setPropertyObjectIds(Db,w.a.gf,pc):Db.removeProperty(w.a.gf),lb.xg.add(v.a.zb(w.a.gf)),!0}r.a.instance.Sa(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",lb.Sg.value.Af.id,Tb);return!1}$Tm(lb,Tb,
pc){const Db=new I.a(0);lb.forEach(jb=>{Db.Z(jb,0);return!0});Tb.forEach(jb=>{Db.ub(jb)?Db.Z(jb,1):Db.Z(jb,3);return!0});pc.forEach(jb=>{let tb;({value:tb}=Db.Gc(jb)).returnValue?1===tb?Db.Z(jb,5):3===tb?(r.a.instance.Sa(42754253,1,2,"TaskNode was found added by both sides of merge"),Db.Z(jb,3)):Db.Z(jb,2):Db.Z(jb,4);return!0});const Ob=new F.a;Db.forEach((jb,tb)=>{0!==tb&&2!==tb&&1!==tb&&Ob.add(jb);return!0});return Ob}static nh(){return new qb}static get instance(){return qb.Pg.value}}qb.Pg=new a.a(qb.nh);
Object(D.a)(qb,"TaskContentNodeComplexMerge",k.a,[]);class Zb{equals(lb,Tb){return lb&&Tb?lb.UserId===Tb.UserId&&lb.Provider===Tb.Provider&&lb.DisplayName===Tb.DisplayName&&lb.Email===Tb.Email:!lb&&!Tb}rK(){return 0}}Object(D.a)(Zb,"CommentTaskPersonComparer",null,[213]);class Rb{equals(lb,Tb){return lb&&Tb?lb.startDate?lb.endDate?lb.startDate.getTime()===Tb.startDate.getTime()&&lb.endDate.getTime()===Tb.endDate.getTime():!Tb.endDate:!Tb.startDate:!lb&&!Tb}rK(){return 0}}Object(D.a)(Rb,"CommentTaskScheduleEqualityComparer",
null,[213]);class Ra{equals(lb,Tb){if(!lb||!Tb)return!lb&&!Tb;if(!lb.extensions&&!Tb.extensions)return!0;if(!lb.extensions||!Tb.extensions||lb.extensions.count!==Tb.extensions.count)return!1;let pc=!0;lb.extensions.forEach((Db,Ob)=>{let jb;return({value:jb}=Tb.extensions.Gc(Db)).returnValue&&Ob===jb?!0:pc=!1});return pc}rK(){return 0}}Object(D.a)(Ra,"ExtensionListEqualityComparer",null,[213]);class ab{Xcl(lb,Tb){return lb&&Tb?lb.recordId===Tb.recordId&&ab.GEg.equals(lb.user,Tb.user)&&ab.GEg.equals(lb.assignee,
Tb.assignee)&&lb.type===Tb.type&&lb.title===Tb.title&&lb.priority===Tb.priority&&lb.isLossy===Tb.isLossy&&lb.completion===Tb.completion&&lb.commentId===Tb.commentId&&lb.time===Tb.time&&ab.yHj.equals(lb.schedule,Tb.schedule):!lb&&!Tb}equals(lb,Tb){return this.Xcl(lb,Tb)}rK(){return 0}}ab.GEg=new Zb;ab.yHj=new Rb;new Ra;Object(D.a)(ab,"HistoryRecordEqualityComparer",null,[213]);var fb=c(1982),bb=c(1511);class Ub extends k.a{constructor(lb){super();this.jLa=lb}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.JNb),
5);lb.Z(v.a.zb(l.a.taskId),2);lb.Z(v.a.zb(l.a.cko),2);lb.Z(v.a.zb(l.a.gko),2);lb.Z(v.a.zb(l.a.Rxa),1);return lb}cbg(lb){if(!lb.nn.value.Eu&&!lb.Sg.value.Eu){const Tb=lb.Sg.value.Af.aH();Tb.removeProperty(l.a.Rxa);const pc=lb.Sg.value.Af,Db=lb.nn.value.Af;lb.Sg=new a.a(()=>new bb.a(Tb,pc));lb.nn=new a.a(()=>new bb.a(Tb,Db))}return super.cbg(lb)}rB(lb,Tb){if(Tb!==v.a.zb(l.a.Rxa))return r.a.instance.Sa(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
lb.Sg.value.Af.id,Tb),!1;const pc=lb.Sk,Db=lb.Yd;r.a.instance.Sa(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",pc.id,pc.Rc,Tb);Tb=Db.getPropertyString(lb.Sg.value.Eu,l.a.Rxa);const Ob=Db.getPropertyString(lb.Sg.value.Af,l.a.Rxa),jb=Db.getPropertyString(lb.nn.value.Af,l.a.Rxa);Tb=this.ZTm(Tb,Ob,jb);if(!Tb)return!1;0<Tb.length?Db.setPropertyString(pc,l.a.Rxa,Tb):pc.removeProperty(l.a.Rxa);lb.xg.add(v.a.zb(l.a.Rxa));return!0}ZTm(lb,
Tb,pc){lb=this.jLa.i2b(lb);Tb=this.jLa.i2b(Tb);pc=this.jLa.i2b(pc);if(!Ub.tmi(lb,Tb))return r.a.instance.Sa(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!Ub.tmi(lb,pc))return r.a.instance.Sa(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;pc=Ub.mJk(lb.length,Tb,pc);return this.jLa.i1f(pc)}static nh(){const lb=new fb.a;return new Ub(lb)}static get instance(){return Ub.Pg.value}static mJk(lb,Tb,pc){const Db=new F.a;for(let Ob=
0;Ob<Tb.length;Ob++)Db.add(Tb.J(Ob));for(;lb<pc.length;lb++)Db.add(pc.J(lb));return Db}static tmi(lb,Tb){const pc=lb.length;if(pc>Tb.length)return!1;for(let Db=0;Db<pc;Db++)if(!Ub.HOj.equals(Tb.J(Db),lb.J(Db)))return Tb.J(Db).recordId===lb.J(Db).recordId&&r.a.instance.Sa(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}Ub.Pg=new a.a(Ub.nh);Ub.HOj=new ab;Object(D.a)(Ub,"TaskSingleNodeComplexMerge",k.a,[]);class Oa extends k.a{constructor(){super()}get Gn(){return 26}qk(){const lb=
super.qk();lb.Z(v.a.zb(w.a.gf),1);return lb}rB(lb,Tb){const pc=w.a.gf;if(Tb===v.a.zb(pc)){Tb=lb.Sk;const Ob=lb.Yd;var Db=Ob.getPropertyObjectIds(lb.Sg.value.Eu,pc);const jb=Ob.getPropertyObjectIds(lb.Sg.value.Af,pc),tb=Ob.getPropertyObjectIds(lb.nn.value.Af,pc);Db=this.fUm(Db,jb,tb);Ob.setPropertyObjectIds(Tb,pc,Db);lb.xg.add(v.a.zb(pc));return!0}return!1}fUm(lb,Tb,pc){return this.REa(lb,Tb,pc)}static nh(){return new Oa}static get instance(){return Oa.Pg.value}}Oa.Pg=new a.a(Oa.nh);Object(D.a)(Oa,
"VectorClockContainerNodeComplexMerge",k.a,[]);class Fc extends k.a{constructor(){super()}get Gn(){return 27}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.kY),1);return lb}rB(lb,Tb){const pc=l.a.kY;if(Tb===v.a.zb(pc)){Tb=lb.Sk;const Db=lb.Yd,Ob=Db.getPropertyUint32(lb.Sg.value.Af,pc)||0,jb=Db.getPropertyUint32(lb.nn.value.Af,pc)||0;Db.setPropertyUint32(Tb,pc,this.DJl(Ob,jb));lb.xg.add(v.a.zb(pc));return!0}return!1}DJl(lb,Tb){return lb>Tb?lb:Tb}static nh(){return new Fc}static get instance(){return Fc.Pg.value}}
Fc.Pg=new a.a(Fc.nh);Object(D.a)(Fc,"VectorClockNodeComplexMerge",k.a,[]);class xc extends k.a{constructor(){super()}get Gn(){return 28}get Qz(){return 0}qk(){const lb=super.qk();lb.Z(v.a.zb(l.a.RGh),3);lb.Z(v.a.zb(l.a.Pc),3);lb.Z(v.a.zb(l.a.R7k),5);lb.Z(v.a.zb(l.a.byi),5);lb.Z(v.a.zb(l.a.Hha),5);return lb}static nh(){return new xc}static get instance(){return xc.Pg.value}}xc.Pg=new a.a(xc.nh);Object(D.a)(xc,"WordSectionNodeComplexMerge",k.a,[]);c.d(L,"a",function(){return pd});class pd{Izh(lb,Tb){switch(lb.Rc){case 131073:return lb.hasProperty(l.a.imageType)||
lb.hasProperty(e.a.VZ)?this.Wo(qa.instance,Tb):this.Wo(Nb.instance,Tb);case 1074135140:return this.Wo(m.instance,Tb);case 1074135137:return this.Wo(A.instance,Tb);case 1074135139:return this.Wo(G.instance,Tb);case 1074135138:return this.Wo(H.instance,Tb);case 1074135136:return this.Wo(O.instance,Tb);case 1074135157:return this.Wo(M.instance,Tb);case 1074135152:return this.Wo(T.instance,Tb);case 1074135153:return this.Wo(R.instance,Tb);case 1074135126:return this.Wo(W.instance,Tb);case 1074135127:return this.Wo(ba.instance,
Tb);case 1074135145:return this.Wo(ra.instance,Tb);case 1074135144:return this.Wo(ha.instance,Tb);case 1074135142:return this.Wo(da.instance,Tb);case 1074135143:return this.Wo(za.instance,Tb);case 1074135163:return this.Wo(la.instance,Tb);case 1074135164:return this.Wo(na.instance,Tb);case 1074135124:return this.Wo(Ca.instance,Tb);case 1074135125:return this.Wo(Na.instance,Tb);case 1074135122:return this.Wo(Fa.instance,Tb);case 393233:return this.Wo(qa.instance,Tb);case 1073872970:return this.Wo(qa.instance,
Tb);case 1074135170:return this.Wo(ja.instance,Tb);case 1074135168:return this.Wo(X.instance,Tb);case 1074135166:return this.Wo(ua.instance,Tb);case 1074135167:return this.Wo(Ha.instance,Tb);case 1074135169:return this.Wo(Ea.instance,Tb);case 1074135165:return this.Wo(wa.instance,Tb);case 393234:return this.Wo(Ma.instance,Tb);case 393229:return this.Wo(Qa.instance,Tb);case 393241:return this.Wo(Ja.instance,Tb);case 393227:return this.Wo(sb.instance,Tb);case 131120:return this.Wo(fc.instance,Tb);case 393271:return this.Wo(ob.instance,
Tb);case 393230:return this.Wo(Eb.a.instance,Tb);case 131140:return this.Wo(pb.instance,Tb);case 1179649:return this.Wo(xb.instance,Tb);case 1073872969:return this.Wo(gb.instance,Tb);case 393252:return this.Wo(Gb.instance,Tb);case 393250:return this.Wo(Xb.instance,Tb);case 393251:return this.Wo(rc.instance,Tb);case 1074135154:return this.Wo(Oa.instance,Tb);case 1074135161:return this.Wo(qb.instance,Tb);case 1074135162:return this.Wo(Ub.instance,Tb);case 1074135155:return this.Wo(Fc.instance,Tb);case 1073872968:return this.Wo(xc.instance,
Tb);case 1074135172:return this.Wo(fa.instance,Tb);case 1074135171:return this.Wo(sa.instance,Tb);case 1074135149:return this.Wo(Ta.instance,Tb);case 1074135151:return this.Wo(Aa.instance,Tb)}return this.Wo(k.a.instance,Tb)}Wo(lb,Tb){lb.$b=Tb?Tb():null;return lb}}Object(D.a)(pd,"GraphNodeComplexMergeFactory",null,[1922])},1882:function(D,L,c){c.r(L);D=c(0);var l=c(1485),e=c(82),a=c(283),k=c(68),m=c(1464);class w{constructor(F,J,N,O=0){this.K8h=F;this.groupType=J;this.Mof=O;this.g1c=N}}Object(D.a)(w,
"SortingGroup",null,[]);class v{constructor(F,J,N,O){this.order=F;this.k7=J;this.m1l=N;this.groupType=O}}Object(D.a)(v,"SortingProp",null,[]);var r=c(1457),z=c(1459),A=c(1456),G=c(27);class H{constructor(F,J){this.Yvi={};this.Xvi={};this.Tvi=this.dwi=1;this.unh(F,J)}Jco(F,J,N){var O=A.a.rQ(N)?this.Yvi:this.Xvi;N=new e.a;for(var M of J)J=Object(k.a)(v,O[l.a[M.groupType].toLowerCase()]),G.c(J)||N.add(new a.a(J,M));N.Sc((R,W)=>R.key.order<W.key.order?-1:1);Array.clear(F);M=r.TellMeActor.instance.eZ;
for(J=0;J<N.count;){O=N.J(J).key.k7;var T=N.J(J).value;const R=new m.a(N.J(J).key.groupType);G.c(M)||M.Location===z.a.contextMenu||(R.displayName=N.J(J).key.m1l);for(const W of T.results)R.Ly(W);for(T=++J;T<N.count&&N.J(T).key.k7===O;)this.ZSe(R,N.J(T).value),T=++J;F.push(R)}}JAo(F,J){this.Tvi=this.dwi=1;this.unh(F,J)}unh(F,J){this.adj(F);for(var N=0;N<F.length;N++){let O=F[N];for(const M of O.g1c)this.qak(M,N,O.K8h,O.groupType)}this.adj(J);for(F=0;F<J.length;F++){N=J[F];for(const O of N.g1c)this.pak(O,
F,N.K8h,N.groupType)}}adj(F){F.sort((J,N)=>Object(k.a)(w,J).Mof>Object(k.a)(w,N).Mof?-1:1)}qak(F,J,N,O){this.Yvi[l.a[F].toLowerCase()]=new v(this.dwi++,J,N,O)}pak(F,J,N,O){this.Xvi[l.a[F].toLowerCase()]=new v(this.Tvi++,J,N,O)}ZSe(F,J){for(let N=0;N<J.results.length;N++)F.Ly(J.results[N])}}Object(D.a)(H,"BaseGroupingSorter",null,[]);class I{constructor(){this.GYd=[new w("",24,[24]),new w(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new w(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,
16,7]),new w(CommonUIStrings.l_TellMeSuggestionsProviderTitle,31,[15,14,19,3]),new w("",13,[13]),new w("",22,[22])];this.BYd=[new w(CommonUIStrings.l_TellMeCommandProviderTitle,29,[17,0,1,8,26]),new w(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,30,[2,19,23,27]),new w(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,31,[15,14,20,9,12,10,11,25]),new w("",13,[13,24]),new w("",22,[22])];this.Evi=new H(this.GYd,this.BYd)}s4c(F,J,N,O=null,M=null){let T=!1;if(O){for(const R of A.a.rQ(N)?
this.GYd:this.BYd)this.Hsn(R,O);T=!0}if(M){for(const R of A.a.rQ(N)?this.GYd:this.BYd)this.KAo(J,R,M);T=!0}T&&this.Evi.JAo(this.GYd,this.BYd);this.Evi.Jco(F,J,N)}Hsn(F,J){const N=new e.a;for(var O of F.g1c){const M=J[l.a[O].toLowerCase()];N.add(new a.a(G.c(M)?Number.MAX_VALUE:M,O))}if(N.count){N.Sc((M,T)=>M.key<T.key?-1:1);J=Array(N.count);for(O=0;O<N.count;O++)J[O]=N.J(O).value;F.g1c=J}}KAo(F,J,N){let O=0;for(const M of J.g1c)if(l.a[M].toLowerCase()in N&&N[l.a[M].toLowerCase()])for(const T of F)if(T.groupType===
M){O+=N[l.a[M].toLowerCase()];break}J.Mof=O}}Object(D.a)(I,"SimplifiedGroupingSorter",null,[]);c.d(L,"GroupsPlacementInfo",function(){return K});class K{constructor(F){this.Wvi={};this.Uvi={};this.Vvi={};this.Zvi={};this.FDf={};this.$vi=this.HPm=this.CPm=this.EPm=1;this.awi=null;this.fz=F;this.qwk();this.oin();this.Uvk();this.Nuk();F.zO&&(this.awi=new I)}YG(F){this.Wvi[l.a[F].toLowerCase()]=this.EPm++}bK(F,J){this.Uvi[l.a[F].toLowerCase()]=J}CLa(F){this.Vvi[l.a[F].toLowerCase()]=this.CPm++}e2(F){this.Zvi[l.a[F].toLowerCase()]=
this.HPm++}VC(F){this.FDf[l.a[F].toLowerCase()]=this.$vi++}qwk(){const F=!!this.fz&&this.fz.j2a,J=!!this.fz&&this.fz.nXc,N=!!this.fz&&this.fz.Yib,O=!!this.fz&&this.fz.Qyf&&!A.a.YFb(),M=!!this.fz&&this.fz.uSc,T=!!this.fz&&this.fz.MRd,R=!!this.fz&&this.fz.$wf;this.fz&&this.fz.IRd&&this.YG(24);this.YG(4);this.YG(18);this.YG(16);this.YG(7);this.YG(17);this.YG(0);this.YG(1);R&&this.YG(26);M&&this.YG(23);F||this.YG(2);F&&!J||this.YG(8);this.YG(15);N&&this.YG(20);this.YG(14);this.YG(9);this.YG(12);this.YG(10);
this.YG(11);F&&this.YG(2);F&&!J&&this.YG(8);this.YG(19);T&&this.YG(25);this.YG(21);this.YG(13);O&&this.YG(22)}oin(){this.bK(21,1);this.bK(4,3);this.bK(18,3);this.bK(16,3);this.bK(7,3);this.bK(17,5);this.bK(0,5);this.bK(1,1);this.bK(26,2);this.bK(2,1);this.bK(8,2);this.bK(15,3);this.bK(14,2);this.bK(25,3);this.bK(9,1);this.bK(12,1);this.bK(10,1);this.bK(11,1);this.bK(19,1);this.bK(23,1);this.bK(13,1);this.bK(24,1);this.bK(20,2);this.bK(22,1)}Uvk(){this.CLa(4);this.CLa(0);this.CLa(17);this.CLa(7);this.CLa(16);
this.CLa(18);this.CLa(15);this.CLa(20);this.CLa(8);this.CLa(14)}Nuk(){this.e2(14);this.e2(10);this.e2(12);this.e2(9);this.e2(11);this.e2(20);this.e2(15);this.e2(8);this.e2(2);this.e2(1);this.e2(25);this.e2(7);this.e2(18);this.e2(16);this.e2(17);this.e2(0);this.e2(4)}JKn(){this.FDf={};this.$vi=1}sSl(F,J,N){this.JKn();const O=!!this.fz&&this.fz.j2a,M=!!this.fz&&this.fz.nXc,T=!!this.fz&&this.fz.Yib,R=!!this.fz&&this.fz.Qyf&&!A.a.YFb(),W=!!this.fz&&this.fz.uSc,V=!!this.fz&&this.fz.MRd,ba=!!this.fz&&this.fz.$wf,
ha=!!this.fz&&this.fz.IRd;F=F&&M;this.VC(4);this.VC(18);this.VC(16);this.VC(7);this.VC(17);this.VC(0);this.VC(1);ba&&this.VC(26);W&&this.VC(23);O&&!M||!F||this.VC(8);J&&this.VC(15);O||this.VC(2);V&&this.VC(25);N&&this.VC(14);O&&!M||F||this.VC(8);J||this.VC(15);T&&this.VC(20);N||this.VC(14);this.VC(9);this.VC(12);this.VC(10);this.VC(11);O&&this.VC(2);O&&!M&&this.VC(8);this.VC(19);this.VC(21);this.VC(13);ha&&this.VC(24);R&&this.VC(22);return this.FDf}VN(){return this.fz}}Object(D.a)(K,"GroupsPlacementInfo",
null,[])},1884:function(D,L,c){D=c(0);var l=c(1720),e=c(61);class a{constructor(){this.source=0;this.gm=this.qTa=this.Z8=null;this.Lga=0;this.lEb=!1;this.mode=this.nSa=0;this.vIc=null;this.JHb=e.a.create()}}Object(D.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.gM=null}}Object(D.a)(k,"OutputState",null,[]);class m{constructor(){this.Adi=this.Wbe=this.G3c=!1;this.$b=this.oZd=this.dPf=this.k7d=this.f9f=this.fzb=this.$La=this.sG=this.ikb=this.xhc=this.dto=
this.kgl=this.Ym=this.o7e=this.vq=this.uu=this.nk=this.ahe=this.qGd=this.LBa=null}}Object(D.a)(m,"RuntimeState",null,[]);c.d(L,"a",function(){return w});class w{constructor(){this.input=new a;this.runtime=new m;this.output=new k;this.logger=new l.a(this)}}Object(D.a)(w,"MergeState",null,[])},1885:function(D,L,c){c.r(L);D=c(0);var l=c(621),e=c(228),a=c(152),k=c(123),m=c(1581),w=c(1667),v=c(1701),r=c(7),z=c(1875);class A{constructor(N,O){this.start=N;this.end=O}}Object(D.a)(A,"MergeDiffIdx",null,[]);
class G{constructor(N,O,M,T=!1,R=null,W=null,V=!0){this.Ecd=this.Dcd=this.BHg=this.iuc=0;this.lYb=this.rne=null;this.J9a=R||new z.a;this.Qg=M;this.oqa=N.p4();this.x6j=O.p4();this.TO=new A(0,0);this.rS=new A(0,0);this.dxe=T;this.trc=V;this.Tqa=W;this.pyk();this.TZn()}get gK(){return this.oqa}get yJ(){return this.x6j}get hz(){return this.iuc}get Sz(){return this.BHg}get Qta(){return this.Dcd}get Fla(){return this.Ecd}get O4k(){const N=new e.a;for(let O=this.rne.start;O<this.rne.end;O++)N.add(this.gK.ig(O));
return N}get E8e(){const N=new e.a;for(let O=this.lYb.start;O<this.lYb.end;O++)N.add(this.yJ.ig(O));return N}N9e(N){if(this.Sz<N.Sz){if(this.Sz+this.Qta>N.Sz)return!0}else if(this.Sz>N.Sz){if(N.Sz+N.Qta>this.Sz)return!0}else if(2===this.hz&&3===N.hz||3===this.hz&&2===N.hz||2===this.hz&&2===N.hz||3===this.hz&&3===N.hz)return!0;return!1}AXi(N,O,M,T){N.FF(O);N.VA(O,M);return T+=M.length-1}ydj(N,O,M,T,R){let W=this.gK.ig(N),V=this.yJ.ig(O);if(!W||!V||!W.U5a&&!V.U5a)return{returnValue:!1,jBa:T,vHa:R};
let ba=new e.a,ha=new e.a;W.U5a&&(ba=W.A4c(),W=ba.ig(M?0:ba.length-1));V.U5a&&(ha=V.A4c(),V=ha.ig(M?0:ha.length-1));if(!W.bA(V,this.J9a,this.Tqa,this.dxe,this.trc))return{returnValue:!1,jBa:T,vHa:R};ba.length&&(T=this.AXi(this.gK,N,ba,T));ha.length&&(R=this.AXi(this.yJ,O,ha,R));return{returnValue:!0,jBa:T,vHa:R}}Cil(N,O,M,T,R,W){for(;R<=M&&W<=T;){const V=N.ig(R),ba=O.ig(W);if(!V.bA(ba,this.J9a,this.Tqa,this.dxe,this.trc))break;this.TO.start+=V.length;this.rS.start+=ba.length;R++;W++}return{dXe:R,
lcg:W}}Ail(N,O,M,T,R,W){for(;R>=M&&W>=T;){const V=N.ig(R),ba=O.ig(W);if(!V.bA(ba,this.J9a,this.Tqa,this.dxe,this.trc))return{returnValue:!0,jBa:R,vHa:W};R--;W--}return{returnValue:!1,jBa:R,vHa:W}}Bil(N,O,M,T){let R=!1;do({dXe:N,lcg:O}=this.Cil(this.gK,this.yJ,M,T,N,O)),{jBa:M,vHa:T,returnValue:R}=this.ydj(N,O,!0,M,T);while(R);return{dXe:N,lcg:O,jBa:M,vHa:T}}zil(N,O,M,T){let R=!1;do{if(!({jBa:M,vHa:T}=this.Ail(this.gK,this.yJ,N,O,M,T)).returnValue)break;({jBa:M,vHa:T,returnValue:R}=this.ydj(M,T,!1,
M,T))}while(R);return{jBa:M,vHa:T}}pyk(){var N=0,O=0,M=this.gK.length-1,T=this.yJ.length-1;0<=M&&this.gK.ig(M);0<=T&&this.yJ.ig(T);({dXe:N,lcg:O,jBa:M,vHa:T}=this.Bil(N,O,M,T));if(N<M||O<T)({jBa:M,vHa:T}=this.zil(N,O,M,T));M++;T++;this.rne=new A(N,M);this.lYb=new A(O,T);this.TO.end=this.TO.start;this.rS.end=this.rS.start;for(var R=N;R<M;R++){var W=this.gK.ig(R);this.TO.end+=W.length}for(R=O;R<T;R++)W=this.yJ.ig(R),this.rS.end+=W.length;a.a.instance.Sa(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
N,M,O,T);a.a.instance.Sa(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.TO.start,this.TO.end,this.rS.start,this.rS.end);this.TO.start<=this.TO.end&&this.rS.start<=this.rS.end&&(N=this.gK.ig(N),O=this.yJ.ig(O),R=this.gK.ig(M),W=this.yJ.ig(T),M=this.gK.ig(M-1),T=this.yJ.ig(T-1),a.a.instance.Sa(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",
N,R,O,W,M,T))}TZn(){this.BHg=this.TO.start;this.Dcd=this.Ecd=0;this.TO.start===this.TO.end&&this.rS.start===this.rS.end?this.iuc=0:this.TO.start===this.TO.end&&this.rS.start<this.rS.end?(this.iuc=1,this.Ecd=this.rS.end-this.rS.start):this.rS.start===this.rS.end&&this.TO.start<this.TO.end?(this.iuc=2,this.Dcd=this.TO.end-this.TO.start):(this.iuc=3,this.Dcd=this.TO.end-this.TO.start,this.Ecd=this.rS.end-this.rS.start);a.a.instance.Sa(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",
this.hz,this.Sz,this.Qta,this.Fla)}Rrm(N,O){return N.B3()&&O.B3()?N.runId===O.runId&&N.Bg===O.Bg:!1}Qwm(N){if(!N.B3()||"\ufffc"!==N.text)return!1;N=N.MBb;return N?N.hasProperty(r.a.Wj)||N.hasProperty(r.a.Twd)||N.hasProperty(r.a.o$e)||N.hasProperty(r.a.V6)||N.hasProperty(r.a.imageType)||N.hasProperty(r.a.pPa)||N.hasProperty(r.a.cGb)||N.hasProperty(r.a.Qq)&&(N=this.Qg.getPropertyInt32(N,r.a.Qq))&&(36===N||35===N||24===N||23===N||33===N||34===N||44===N||45===N||42===N||43===N)?!0:!1:!1}kRc(N){return N.B3()&&
!this.Qwm(N)}Zzk(){if(2===this.hz)return!1;var N=this.lYb.start;if(!N)return!1;let O=null;for(var M=this.lYb.start;M<this.lYb.end;M++){const T=this.yJ.ig(M);if(this.kRc(T)){O=T;break}}if(!O)return!1;--N;for(M=this.yJ.ig(N);M&&!this.kRc(M);)N--,M=this.yJ.ig(N);return M&&this.Rrm(M,O)?!0:!1}LXh(N){const O=new e.a;for(let M=0;M<N.length;M++)N.J(M).U5a?O.VA(O.length,N.J(M).A4c()):O.insert(O.length,N.J(M));return O}Trm(){if(3!==this.hz||this.Qta!==this.Fla)return!1;const N=this.LXh(this.O4k),O=this.LXh(this.E8e);
if(N.length!==O.length)return!1;for(let M=0;M<N.length;M++)if(!N.J(M).bA(O.J(M),this.J9a,this.Tqa,!0,this.trc))return!1;return!0}Srm(){if(0!==this.hz&&3!==this.hz||this.gK.length!==this.yJ.length)return!1;let N=!1;for(let O=0;O<this.gK.length;O++){if(!this.gK.J(O).bA(this.yJ.J(O),this.J9a,this.Tqa,!0,this.trc))return!1;if(3===this.gK.J(O).type||1===this.gK.J(O).type){const M=this.gK.J(O),T=this.yJ.J(O);N=M.runId!==T.runId||M.Bg!==T.Bg||N}}return N}}Object(D.a)(G,"MergeBlockDiff",null,[]);var H=c(1541);
class I{constructor(N,O){this.id=N;this.index=O}}Object(D.a)(I,"ParagraphStartIndex",null,[]);var K=c(1592),F=c(1525);c.d(L,"ParagraphMerge",function(){return J});class J{constructor(N,O,M,T,R,W,V){this.qWb=this.Gub=this.No=this.Rw=null;this.Ah=!1;this.H9g=this.SJg=this.JBg=this.psa=this.ZIa=this.oqa=null;this.ae=N;this.aF=O;this.EAa=T;this.nza=M;this.Sqa=R;this.Tqa=W;this.Qg=V}b3h(N){const O=new l.a;N.gK.forEach(M=>{2===M.type&&O.add(M.Jj);return!0});N.yJ.forEach(M=>{2===M.type&&O.remove(M.Jj);return!0});
return O}D_h(N){const O=new e.a;N.yJ.forEach(M=>{2===M.type&&O.add(M.Jj);return!0});return O}Dvh(N){const O=new e.a;let M=0,T=0;N.yJ.forEach(R=>{2===R.type&&(O.add(new I(R.Jj,M<N.Sz?M:M<N.Sz+N.Fla?N.Sz:M-N.Fla+N.Qta)),M=T);T+=R.length;return!0});return O}KLk(N,O){var M=this.Dvh(N);const T=this.Dvh(O);N=this.b3h(N);const R=this.b3h(O);O=new e.a;const W=new l.a;let V=0;for(let ba=0;ba<M.length;ba++){const ha=M.J(ba);if(V<T.length){let ca=T.J(V);for(;V<T.length&&ca.index<=ha.index;){if(ca.id.equals(ha.id)){V++;
break}N.contains(ca.id)||W.contains(ca.id)||(O.add(ca.id),W.add(ca.id));V++;ca=T.J(V)}}R.contains(ha.id)||(O.add(ha.id),W.add(ha.id))}for(;V<T.length;)M=T.J(V),N.contains(M.id)||W.contains(M.id)||(O.add(M.id),W.add(M.id)),V++;return O}initialize(){if(this.Ah){const N=!!this.Rw&&!!this.No;this.ae.logger.Vg(Object.assign(new H.a,{tj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return N}this.Ah=!0;if(!({gK:this.oqa,uIc:this.ZIa,S6c:this.psa,Ewd:this.JBg,rGd:this.SJg,bhe:this.H9g}=
F.a.gAh(this.ae,this.Qg,this.aF,this.nza,this.EAa,this.Sqa,!1,!1)).returnValue)return!1;this.Rw=new G(this.oqa,this.ZIa,this.Qg,void 0,void 0,this.Tqa);this.No=new G(this.oqa,this.psa,this.Qg,void 0,void 0,this.Tqa);a.a.instance.Sa(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Rw.Qta,this.Rw.Fla,this.No.Qta,this.No.Fla));return!0}kHa(){a.a.instance.Sa(593826836,1,4,"Attempting to merge with LCS");let N=!1;
const O=new v.a(this.Qg,this.ae);let M=null,T=null;var R=null;const W=ba=>this.ae.runtime.nk.J(ba),V=ba=>this.ae.runtime.vq.J(ba)||this.ae.runtime.nk.J(ba);this.Rw=new G(this.oqa,this.ZIa,this.Qg,void 0,void 0,this.Tqa,!1);this.No=new G(this.oqa,this.psa,this.Qg,void 0,void 0,this.Tqa,!1);({updateHints:M}=O.FBh(this.aF,W,this.nza,ba=>this.ae.runtime.uu.J(ba)||this.ae.runtime.nk.J(ba),this.Rw.Sz,this.Rw.Sz+this.Rw.Qta,this.Rw.Sz+this.Rw.Fla)).returnValue&&({updateHints:T}=O.FBh(this.aF,W,this.EAa,
V,this.No.Sz,this.No.Sz+this.No.Qta,this.No.Sz+this.No.Fla)).returnValue&&(N=!0);N||(a.a.instance.Sa(593826835,1,2,"Failed to create update hints with LCS"),N=!1);N&&(R=new K.a(this.ae,this.aF,this.nza,this.EAa,ba=>this.ae.runtime.$b?this.ae.runtime.$b.isFeatureEnabled(ba):!1,this.Qg,null,M,T),({Ym:R}=R.ojc()).returnValue||(a.a.instance.Sa(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.ae.logger.Vg(Object.assign(new H.a,{tj:"TryLCSMerge",eventId:"9zrqs"})),N=!1));a.a.instance.Sa(593826833,
1,N?4:2,"TryLCSMerge: [Success: {0}]",N);return{returnValue:N,Ym:R}}ojc(){let N;N=null;if(!this.initialize())return this.ae.logger.dU("ParagraphMerge Initialize"),this.L2a(),{returnValue:!1,Ym:N};this.ae.logger.dU("ParagraphMerge Initialize");let O;this.ae.logger.Jae(2);let M=({kHa:O}=this.q7k()).returnValue;M=M&&({Ym:N,kHa:O}=this.uLc(this.ae,this.Qg,this.Sqa,this.qWb,this.Gub)).returnValue;this.ae.logger.L2f();if(!M){this.ae.logger.dU("ParagraphMerge DoMergeInteral");if(O){this.ae.logger.Jae(3);
({Ym:N,returnValue:M}=this.kHa());this.ae.logger.L2f();if(M)return{returnValue:!0,Ym:N};this.L2a();return{returnValue:!1,Ym:N}}this.L2a();return{returnValue:!1,Ym:N}}if(!({Ym:N,kHa:O}=this.uLc(this.ae,this.Qg,this.Sqa,this.qWb,this.Gub)).returnValue)return this.ae.logger.dU("ParagraphMerge DoMergeInteral"),this.L2a(),{returnValue:!1,Ym:N};this.ae.logger.dU("ParagraphMerge DoMergeInteral");return{returnValue:!0,Ym:N}}uLc(){let N;if(!({R3d:N}=F.a.uLc(this.ae,this.Qg,this.Sqa,this.qWb,this.Gub)).returnValue)return this.ae.logger.dU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.L2a(),{returnValue:!1,Ym:N,kHa:!0};this.ae.logger.dU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Ym:N,kHa:!1}}L2a(N=!1){a.a.instance.tia(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+N+"] BaseRevisionMergeBlocksList: {0}",this.JBg);a.a.instance.tia(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.SJg);a.a.instance.tia(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.H9g);N=new e.a;F.a.dac(this.Qg,"BaseObjects_",this.aF,N);F.a.dac(this.Qg,"FavoredObjects_",
this.nza,N);F.a.dac(this.Qg,"ConflictObjects_",this.EAa,N);F.a.jJm(this.ae,N)}Noh(N){let O,M;M=O=0;if(0===this.Rw.hz)O=this.No.Sz;else if(1===this.Rw.hz)O=this.No.Sz<this.Rw.Sz?this.No.Sz:this.No.Sz===this.Rw.Sz?N||1!==this.No.hz?this.No.Sz+this.Rw.Fla:this.No.Sz:this.No.Sz+this.Rw.Fla;else if(2===this.Rw.hz||3===this.Rw.hz)O=this.No.Sz<=this.Rw.Sz?this.No.Sz:this.No.Sz+(this.Rw.Fla-this.Rw.Qta);if(2===this.No.hz||3===this.No.hz)M=O+this.No.Qta;return{u8h:O,G0l:M}}LNh(N,O){let M;M=0;if(!O)return{returnValue:!0,
RVc:M};let T=0,R=0;for(;T<N.length;){let W;for(let V=T;V<N.length;V++){T=V;W=N.J(V);const ba=W.length;R+=ba;if(!(R<O)){if(R>O)if(W.U5a)N.FF(T),N.VA(T,W.A4c()),R-=ba;else return a.a.instance.Sa(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",O),this.ae.logger.Vg(Object.assign(new H.a,{tj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,RVc:M};break}}if(R===
O)return T++,M=T,{returnValue:!0,RVc:M}}a.a.instance.Sa(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",O);this.ae.logger.Vg(Object.assign(new H.a,{tj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,RVc:M}}Tmk(N,O,M){let T=0;var R=0,W=!1;const V=this.No.E8e.p4();if(this.No.Zzk())for(--O;0<=O;O--){let ba=N.J(O);if(this.No.kRc(ba)){R=N.J(O);T=R.runId;R=R.Bg;W=!0;break}}W||((R=N.J(M))&&
this.No.kRc(R)?(T=R.runId,R=R.Bg):R=T=0);for(N=0;N<V.length;N++)M=V.J(N),M.B3()&&(W=M,this.No.kRc(M)?(W.runId=T,W.Bg=R):(W.runId=0,W.Bg=0));return V}Kli(N){if(2===N.length){const O=1===N.J(0).type?N.J(0):null;N=2===N.J(1).type;if(O&&N&&""===O.text)return!0}return!1}q7k(){const N=this.Rw.Srm();if(!N&&0===this.Rw.hz)return this.qWb=this.No.yJ.p4(),this.Gub=this.D_h(this.No),{returnValue:!0,kHa:!1};if(0===this.No.hz)return this.qWb=this.Rw.yJ.p4(),this.Gub=this.D_h(this.Rw),{returnValue:!0,kHa:!1};(this.Kli(this.Rw.yJ)||
this.Kli(this.No.yJ))&&this.ae.logger.Zsi(Object.assign(new H.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!N){var O=this.Rw.N9e(this.No);O&&this.Sqa(53)&&(a.a.instance.Sa(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Rw=new G(this.oqa,this.ZIa,this.Qg,!0,void 0,this.Tqa),this.No=new G(this.oqa,this.psa,this.Qg,!0,void 0,this.Tqa),O=this.Rw.N9e(this.No));if(O)return a.a.instance.Sa(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.ae.logger.Vg(Object.assign(new w.a,{tj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,kHa:!0}}var M;O=0;this.Gub=this.KLk(this.Rw,this.No);({u8h:M,G0l:R}=this.Noh(!1));const T=this.Rw.yJ.p4();if(!({RVc:M}=this.LNh(T,M)).returnValue||(2===this.No.hz||3===this.No.hz)&&!({RVc:O}=this.LNh(T,R)).returnValue)return{returnValue:!1,kHa:!1};if(2===this.No.hz||3===this.No.hz){this.Yfc(T,O);this.Yfc(T,M-1);var R=null;for(var W=O-1;W>=M;W--)2===T.J(W).type&&(R=T.J(W)),T.FF(W);0<T.length&&(W=T.J(T.length-
1),2!==W.type&&4!==W.type&&R&&(this.ae.runtime.$b.ez(76),this.ae.runtime.$b.isFeatureEnabled(76)&&(T.add(R),this.Gub.add(R.Jj))));a.a.instance.Sa(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",O-M-1,M)}if(1===this.No.hz||3===this.No.hz)R=this.No.E8e,N&&(R=this.Tmk(T,M,O)),this.Yfc(T,M-1),this.Yfc(T,M),this.Yfc(R,0),this.Yfc(R,R.length-1),T.VA(M,R),a.a.instance.Sa(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
M,N,R.Oq());this.qWb=T;return{returnValue:!0,kHa:!1}}Yfc(N,O){0>O||O>=N.length||(N=N.J(O),Object(k.a)(m.a,N)&&(N.hPa=!0))}b7c(N,O){let M;M=O;if(!this.initialize())return{returnValue:!1,H4a:N,Voa:M};if(this.No.N9e(this.Rw))return this.L2a(!0),this.ae.logger.Vg(Object.assign(new w.a,{tj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,H4a:N,Voa:M};if(0===this.No.hz||3===this.No.hz&&this.No.Trm())return{returnValue:!0,H4a:N,Voa:O};let T;({u8h:T}=this.Noh(!0));O<T||O===T&&(1!==this.No.hz||1===
this.No.hz&&1===this.Rw.hz&&O===this.Rw.Sz+this.Rw.Fla)?M=O:(M=O+this.No.Fla-this.No.Qta,M<T&&(M=T));return{returnValue:!0,H4a:N,Voa:M}}}Object(D.a)(J,"ParagraphMerge",null,[1920])},1886:function(D,L,c){c.r(L);D=c(0);var l=c(1599),e=c(1522),a=c(1485),k=c(1722),m=c(1521);class w{constructor(K="",F="",J="",N=-99999,O=-1,M=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=K?K:"";this.Description=F?F:"";this.Type=J?J:"";this.Score=N;this.Age=O;this.Count=M}}Object(D.a)(w,
"Suggestion",null,[]);class v{constructor(K,F){this.GroupType=this.Suggestions=null;this.Suggestions=K;this.GroupType=F}}Object(D.a)(v,"SuggestionGroup",null,[]);class r{}r.help="help";r.answer="answer";r.commands="commands";r.yUn="servicecommands";r.template="template";Object(D.a)(r,"SuggestionGroupType",null,[]);var z=c(1457),A=c(1456),G=c(2),H=c(33);c.d(L,"InteractionLogger",function(){return I});class I{constructor(K,F,J){this.Lse=0;this.$Ne=this.mtc=null;this.re=K;this.cMe=this.cqe=this.Axe=
!1;this.yIj=F;this.rg=G.AFrameworkApplication.Ve;this.oc=J;this.Xbd=this.LGe=0}get Poa(){return this.re.Poa}Sae(K){this.re.Sae(K)}pui(){if(this.mtc){var K=0;for(const F of this.mtc)this.re.UMm(F,K++);this.mtc=null}}beginQuery(K,F,J){this.re.IMm(K,F,J)}Ikb(K,F){this.re.Wqk(K,F);this.Axe=!0;this.cMe=!1}swa(){this.Axe=!1;this.cqe||(this.pui(),this.re.qJh(this.Lse))}KMm(K,F){this.re.LMm(K,F)}X1m(K,F,J,N,O){for(const M of this.yIj)if(K.startsWith(M)){this.cMe=!0;break}this.re.uIm(K,F,J,N,O)}E2m(K){this.cqe=
!1;this.Lse=K;this.Axe||this.cMe||(this.pui(),this.re.qJh(this.Lse,!1))}D2m(K,F){this.re.AIm(K,F);this.cqe=!0}hff(K,F){if(!K.count)return"";let J="";const N=Date.now();for(let O of K)K=(N-O.timeStamp)/1E3,K=A.a.qge(K),0<J.length&&(J+=";"),J+=F?O.commandId:O.controlId,J+=":",J+=K.toString();return J}v3a(){var K=this.hff(l.a.instance.mKc(),!1);0<K.length&&this.re.sIm(K);K=this.hff(l.a.instance.Kfb(),!0);0<K.length&&this.re.LHm(K);K=this.hff(l.a.instance.Wpc,!0);0<K.length&&this.re.xJm(K);K=z.TellMeActor.instance.$Wg;
0<K.length&&this.re.GMm(H.c(K))}pNm(K){this.re.YHm(K)}d8(K,F,J,N,O,M,T,R=null){this.re.FKm(K,F,J,N,O,M,T,R)}KCf(K,F,J,N){this.re.KCf(K,F,J,N)}hA(K,F,J=null){this.re.rH(K,F,J)}onError(K,F,J=null){this.re.JEa(K,F,J)}eZn(K){this.mtc=K}oVl(K){const F=[];if(!K)return F;for(let J=0;J<K.length;J++){const N=a.a[K[J].groupType].toLowerCase(),O=[],M=K[J].results;if(M){for(let T=0;T<M.length;T++)"findindocument"===N?Array.add(O,new w("","",N,M[T].score,M[T].vvd,M[T].count)):Array.add(O,new w(M[T].label,M[T].description,
N,M[T].score,M[T].vvd,M[T].count));"answer"===N||"definition"===N||"wolframanswer"===N||"entity"===N?Array.add(F,new v(O,r.answer)):"classifier"===N||"appsforoffice"===N?Array.add(F,new v(O,r.commands)):"serviceclassifier"===N?Array.add(F,new v(O,r.yUn)):"assistance"===N?Array.add(F,new v(O,r.help)):("document"===N||"people"===N||"findindocument"===N||"notes"===N||"image"===N||"template"===N)&&Array.add(F,new v(O,N))}}return F}Smf(K,F){const J={};J.Query=F;J.SuggestionGroups=H.c(this.oVl(K));return H.c(J)}V5h(K){const F=
{"Content-Type":"application/json",Accept:"application/json"};F["X-Office-Version"]=G.AFrameworkApplication.buildVersion;F["X-Office-Application"]=G.AFrameworkApplication.K.lb("Application");F["X-Office-Platform"]="WAC";F["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.lb("LoggableUserId")||"";F["X-TellMe-SessionId"]=this.re.Poa.fna;F["X-TellMe-SuggestionTypes"]="Ranker";F["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;F["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;F["X-TellMe-Flights"]=
K;F["X-TellMe-PartialQueryIndex"]=this.LGe;return F}PIb(K,F,J){this.d8(F.length,"RankerLogging",K.data.jf.toString(),Math.round(window.performance.now()-J),m.a.qhj,!0,e.a.tOa)}DIb(K,F,J){this.d8(F.length,"RankerLogging",K.data.jf.toString(),Math.round(window.performance.now()-J),m.a.qhj,!1,e.a.tOa)}W5h(){this.$Ne||(this.$Ne=new k.a(this.oc,null,6E3));return this.$Ne.m9}MCf(K){const F=this.Smf(this.mtc,K),J=this.V5h("RankerLogging"),N=window.performance.now();this.rg.qj(this.W5h(),2,F,J,!1,0,O=>{this.PIb(O,
K,N)},O=>{this.DIb(O,K,N)},null,null,!1,4E3,6E3);this.LGe++}zKn(){this.LGe=0}S1f(K){this.Xbd=K}}Object(D.a)(I,"InteractionLogger",null,[])},1888:function(D,L,c){c.r(L);D=c(0);var l=c(17),e=c(7),a=c(152),k=c(228),m=c(61),w=c(1659),v=c(1580),r=c(1539),z=c(1525);class A{constructor(K,F,J=null){this.author=K;this.gVc=F;this.RRf=J||m.a.nil}bA(K){return K?this.author===K.author&&this.gVc===K.gVc&&this.RRf===K.RRf:!1}}Object(D.a)(A,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(K,F,J){this.insertion=
K||G.Y$e;this.deletion=F||G.Y$e;this.GFa=J||G.Y$e}get m6l(){return 0<this.insertion.author.length}get P5l(){return 0<this.deletion.author.length}get O6l(){return 0<this.GFa.author.length}bA(K){return K?this.insertion.bA(K.insertion)&&this.deletion.bA(K.deletion)&&this.GFa.bA(K.GFa):!1}}G.Y$e=new A("",0);Object(D.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var H=c(1719);c.d(L,"ParagraphMergeBlockCreator",function(){return I});class I extends v.a{constructor(K,F,J,N,O,M,T){super();this.maxValue=
Number.MAX_VALUE;this.wA=new w.a;this.OQb=null;this.hN=0;this.vQg=!1;this.huc="";this.mme=K;this.Bs=F;this.ju=J;this.X2j=N;this.Aed=O;this.EPg=M;this.Qg=T;if(this.Qg.hasProperty(this.Bs,l.a.Co))if(this.Qg.hasProperty(this.Bs,e.a.Pc))if(this.Qg.hasProperty(this.Bs,e.a.Sq))if(this.Qg.hasProperty(this.Bs,e.a.rt))if(this.Qg.hasProperty(this.Bs,l.a.An))if(this.J1=this.Qg.getPropertyString(this.Bs,l.a.Co),this.dRe=this.Qg.getPropertyUint32(this.Bs,e.a.Pc),this.Ur=this.Qg.getPropertyUint32s(this.Bs,e.a.Sq),
this.Zld=this.Qg.getPropertyUint32s(this.Bs,e.a.rt),this.Sue=this.Qg.getPropertyObjectIds(this.Bs,l.a.An),this.J1||""===this.J1)if(this.J1.length||1!==this.Sue.length||(this.Ur.length||(this.Ur.add(0),a.a.instance.Sa(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.Zld.length||(this.Zld.add(0),a.a.instance.Sa(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.wVj=this.FId(this.Bs,e.a.DIf,this.Ur.length),
this.Pvc=this.FId(this.Bs,l.a.iwa,this.Ur.length),this.ika=this.FId(this.Bs,l.a.vnb,this.Ur.length),this.xja=this.FId(this.Bs,e.a.cOa,this.Ur.length),this.Vja=this.wYl(this.Bs,e.a.IFa,this.Ur.length),this.xcm(),K=this.Qg.hasProperty(this.Bs,l.a.vm)?this.Qg.getPropertyUint32s(this.Bs,l.a.vm):new k.a,this.Wod=z.a.n7i(K,this.J1.length),this.Ur.length!==this.Zld.length)a.a.instance.Sa(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",F.id);else if(this.Ur.length!==
this.Sue.length)a.a.instance.Sa(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",F.id);else{this.EPg&&(this.Qg.hasProperty(this.Bs,e.a.ov)?this.OQb=this.Qg.getPropertyObjectIds(this.Bs,e.a.ov):(a.a.instance.Sa(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",F.id),this.OQb=this.zZ(this.Ur.length,m.a.nil)),this.Ur.length!==this.OQb.length&&(a.a.instance.Sa(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
F.id,this.Ur.length,this.OQb.length),this.OQb=this.zZ(this.Ur.length,m.a.nil)));if(this.Ur.length!==this.Pvc.length||this.Ur.length!==this.ika.length||this.Ur.length!==this.xja.length||this.Ur.length!==this.Vja.length)this.Ur.length===this.Pvc.length||this.Aed||a.a.instance.Sa(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",F.id,this.Ur.length,this.Pvc.length),this.Ur.length===this.ika.length||
this.Aed||a.a.instance.Sa(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",F.id,this.Ur.length,this.ika.length),this.Ur.length===this.xja.length||this.Aed||a.a.instance.Sa(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",F.id,this.Ur.length,this.xja.length),this.Ur.length===this.Vja.length||
this.Aed||a.a.instance.Sa(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",F.id,this.Ur.length,this.Vja.length),K=this.Qg.getPropertyBool(this.Bs,l.a.z2e),a.a.instance.Sa(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",F.id,O,null==K?!1:K),this.Pvc=this.zZ(this.Ur.length,!0),this.ika=this.zZ(this.Ur.length,!1),this.xja=this.zZ(this.Ur.length,
!1),this.Vja=this.zZ(this.Ur.length,0),this.Qg.setPropertyBool(this.Bs,l.a.z2e,!1);this.wA.FEo(this.Ur.length)?(this.Wod.length!==this.Ur.length+1&&a.a.instance.Sa(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",F.id,this.Ur.length,this.Wod.length),this.ASj=!0):a.a.instance.Sa(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",F.id)}else a.a.instance.Sa(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",F.id);else a.a.instance.Sa(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",F.id)}xcm(){this.Qg.hasProperty(this.Bs,e.a.SDa)?this.wA.Vhb=this.Qg.getPropertyBools(this.Bs,e.a.SDa):this.wA.Vhb=this.zZ(this.Ur.length,!1);this.Qg.hasProperty(this.Bs,e.a.Wea)?this.wA.meb=this.Qg.getPropertyBools(this.Bs,e.a.Wea):this.wA.meb=this.zZ(this.Ur.length,!1);this.Qg.hasProperty(this.Bs,e.a.TDa)?this.wA.Uhb=this.Qg.getPropertyStrings(this.Bs,e.a.TDa):this.wA.Uhb=this.zZ(this.Ur.length,"");this.Qg.hasProperty(this.Bs,
e.a.qCa)?this.wA.leb=this.Qg.getPropertyStrings(this.Bs,e.a.qCa):this.wA.leb=this.zZ(this.Ur.length,"");this.Qg.hasProperty(this.Bs,e.a.UDa)?this.wA.Whb=this.Qg.getPropertyListOfMilliseconds(this.Bs,e.a.UDa):this.wA.Whb=this.zZ(this.Ur.length,0);this.Qg.hasProperty(this.Bs,e.a.rCa)?this.wA.BZa=this.Qg.getPropertyListOfMilliseconds(this.Bs,e.a.rCa):this.wA.BZa=this.zZ(this.Ur.length,0);this.Qg.hasProperty(this.Bs,e.a.HFa)?this.wA.$3a=this.Qg.getPropertyBools(this.Bs,e.a.HFa):this.wA.$3a=this.zZ(this.Ur.length,
!1);this.Qg.hasProperty(this.Bs,e.a.fHa)?this.wA.Alb=this.Qg.getPropertyStrings(this.Bs,e.a.fHa):this.wA.Alb=this.zZ(this.Ur.length,"");this.Qg.hasProperty(this.Bs,e.a.gHa)?this.wA.Clb=this.Qg.getPropertyListOfMilliseconds(this.Bs,e.a.gHa):this.wA.Clb=this.zZ(this.Ur.length,0);this.Qg.hasProperty(this.Bs,e.a.Yxa)?this.wA.Blb=this.Qg.getPropertyObjectIds(this.Bs,e.a.Yxa):this.wA.Blb=this.zZ(this.Ur.length,m.a.nil)}FId(K,F,J){return this.Qg.hasProperty(K,F)?this.Qg.getPropertyBools(K,F):this.zZ(J,!1)}wYl(K,
F,J){return this.Qg.hasProperty(K,F)?this.Qg.getPropertyUint32s(K,F):this.zZ(J,0)}zZ(K,F){const J=new k.a;for(let N=0;N<K;N++)J.add(F);return J}PWl(K){const F=this.Wod.ig(K);K=this.Wod.ig(K+1);return this.J1.substring(F,K)}S_h(){if(this.vQg)return null;var K=this.hN<this.Ur.length?this.Ur.ig(this.hN):this.maxValue;if(K===this.maxValue||this.X2j&&!this.J1.length)return this.vQg=!0,K=new r.a(this.ju,this.Bs.id,this.dRe),this.huc=this.lVe(this.huc,K.toString()),K;const F=this.Zld.ig(this.hN),J=this.Sue.ig(this.hN),
N=this.wVj.ig(this.hN),O=this.Pvc.ig(this.hN),M=this.ika.ig(this.hN),T=this.xja.ig(this.hN),R=this.Vja.ig(this.hN),W=this.EPg?this.OQb.ig(this.hN):null;var V=null;this.wA.Vhb.ig(this.hN)&&(V=new A(this.wA.Uhb.ig(this.hN)||"",this.wA.Whb.ig(this.hN)));var ba=null;this.wA.meb.ig(this.hN)&&(ba=new A(this.wA.leb.ig(this.hN)||"",this.wA.BZa.ig(this.hN)));var ha=null;this.wA.$3a.ig(this.hN)&&(ha=new A(this.wA.Alb.ig(this.hN)||"",this.wA.Clb.ig(this.hN),this.wA.Blb.ig(this.hN)));V=new G(V,ba,ha);ba=this.PWl(this.hN);
this.hN++;ha=ba.startsWith("\ufddfHYPERLINK ");K=new H.a(this.mme,this.ju,this.Bs.id,F,K,J,ba,N,!ha,O,M,T,R,V,W);this.huc=this.lVe(this.huc,K.toString());return K}B_h(){let K;K=null;var F="";if(!this.ASj)return{KEf:K,$2a:F};if(F=this.S_h())K=new k.a,K.add(F);for(;F=this.S_h();)K.add(F);F=this.huc;return{KEf:K,$2a:F}}}Object(D.a)(I,"ParagraphMergeBlockCreator",v.a,[])},1891:function(D,L,c){c.r(L);D=c(0);var l=c(228),e=c(1580),a=c(1538);class k extends a.a{constructor(w,v){super(4,w,v)}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.Jj)}s4b(){return"Table"}clone(){return new k(this.source,this.Jj)}bA(w,v,r,z=!1){return super.bA(w,v,r,z)?this.Jj.equals(w.Jj):!1}get length(){return 1}}Object(D.a)(k,"TableMergeBlock",a.a,[]);c.d(L,"TableMergeBlockCreator",function(){return m});class m extends e.a{constructor(w,v){super();this.TBg=new k(v,w.id)}B_h(){let w;w=new l.a;w.add(this.TBg);return{KEf:w,$2a:this.lVe("",this.TBg.toString())}}}Object(D.a)(m,"TableMergeBlockCreator",e.a,[])},1970:function(D,L,c){c.r(L);
var l=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},e=c(0),a=c(52),k=c(69);class m extends Sys.EventArgs{constructor(Q,ya){super();this.zfe=Q;this.actualValue=ya}}Object(e.a)(m,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,
[]);var w=c(29);class v{constructor(){this.oRb=[];this.EFg=this.rqe=0;this.Lh=null;this.sa=new k.a}init(Q,ya,kb){this.Lh=Q;this.rqe=ya;this.EFg=kb;this.Lh.DTe(Object(a.a)(this,this.t0d,"onCpuMeterFrameAvailable"));this.bfk(Object(a.a)(this,this.IQk,"cpuPercentThresholdExceeded"))}t0d(Q,ya){ya.eAi&&(Array.enqueue(this.oRb,ya.eAi.CP),this.oRb.length>this.EFg&&(Array.dequeue(this.oRb),this.NCk()))}NCk(){var Q=this.oRb.length;let ya=0;for(let kb=0;kb<Q;kb++){const Mb=Array.dequeue(this.oRb);ya+=Mb;Array.enqueue(this.oRb,
Mb)}Q=ya/Q;Q>this.rqe&&this.sa.raiseEvent("CPTTE",new m(this.rqe,Q))}IQk(Q,ya){w.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.BBd(ya.zfe,ya.actualValue))}bfk(Q){this.sa.addHandler("CPTTE",Q)}BBd(Q,ya){const kb={};kb.ThresholdValue=Q;kb.ActualValue=ya;return kb}}Object(e.a)(v,"CpuMeterMonitor",null,[1680]);var r=c(438);class z{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(z,"ProfileInformation",null,[]);var A=c(6),G=c(30),H=c(201),I=c(77);class K{constructor(Q=
0,ya=0){this.Asb=!1;this.Vrb={};this.Ajd=Q;this.Sjd=ya;this.HPe=0;G.a.addHandler(window.self,A.a.tgh,()=>{this.Asb=!0});G.a.addHandler(window.self,A.a.ugh,()=>{this.Asb=!1})}wgh(Q,ya,kb){const Mb=K.generateKey(ya,kb);Mb in this.Vrb?ya=this.Vrb[Mb]:(ya=new z,ya.S=kb?1:0,this.Vrb[Mb]=ya,this.HPe++);ya.C++;ya.M=Q>ya.M?Q:ya.M;ya.T+=Q}YAa(Q,ya){this.wgh(Q,ya,!1);this.Asb&&this.wgh(Q,ya,!0)}getData(){if(0<this.Sjd&&this.HPe>this.Sjd)return this.Xyl();const Q=0<this.Ajd,ya={},kb=this.Vrb;for(let vc in kb){var Mb=
vc;const id=kb[vc];this.V_i(id);Q&&id.T>=this.Ajd&&(ya[Mb]=id)}return Q?I.a.kf(ya)?null:ya:this.Vrb}Xyl(){var Q=0<this.Ajd,ya=[];const kb=this.Vrb;for(let Mb in kb){const vc={key:Mb,value:kb[Mb]};let id=vc.value;(!Q||id.T>=this.Ajd)&&Array.add(ya,vc)}if(ya.length>this.Sjd)ya.sort((Mb,vc)=>vc.value.T-Mb.value.T),ya=ya.slice(0,this.Sjd);else if(!ya.length)return null;Q={};for(const Mb of ya)ya=Mb.value,this.V_i(ya),Q[Mb.key]=ya;return Q}V_i(Q){Q.M=H.a.xU(Q.M,0);Q.T=H.a.xU(Q.T,0)}reset(){this.Vrb={};
this.HPe=0}static generateKey(Q,ya){return ya?Q+" [it]":Q}}Object(e.a)(K,"FunctionCallAggregator",null,[857]);var F=c(2),J=c(1197);class N{}Object(e.a)(N,"CpuMeterFrame",null,[]);class O extends Sys.EventArgs{constructor(Q){super();this.eAi=Q}}Object(e.a)(O,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class M{}Object(e.a)(M,"MiniTaskItemInfo",null,[]);class T{}Object(e.a)(T,"TaskItemInfo",null,[]);var R=c(1016),W=c(1373),V=c(200);class ba{constructor(Q,ya,kb,Mb,vc){this.hwb=0;this.WY=null;
this.$od=this.T6g=0;this.W3g=!1;this.GSb=0;this.rsc=!1;this.Era=null;this.Jgd=0;this.fFe=new k.a;this.yrd=[];this.yz=Q;this.ZCe=ya;this.Yue=kb;this.HVg=Mb;F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.p$b();this.dLj=vc;this.Zue=new K(100);this.jUj=R.a.sE(1,5,new W.a)}DTe(Q){this.fFe.addHandler("OnCpuMeterFrameAvailable",Q)}sWi(Q){this.fFe.removeHandler("OnCpuMeterFrameAvailable",Q)}Dlb(Q,ya,kb,Mb=null){kb=Mb?Mb.priority:7;const vc=this.yz();this.start(ya,
kb);try{Q()}finally{this.stop(ya,Mb),Q=this.yz()-vc,this.HVg.track(Q,ya)}}Sd(Q,ya){const kb=this.yz();try{Q()}finally{Q=this.yz()-kb,this.Yue.YAa(Q,ya),0<this.hwb&&this.Zue.YAa(Q,ya),this.HVg.track(Q,ya)}}wNf(Q){const ya=new T;ya.TN=Q.aDf;ya.TP=Q.priority;this.WQi(1,ya)}tac(Q){this.Jgd|=Q}start(Q,ya){if(!this.hwb){this.Zue.reset();const kb=this.ppi(Q);kb&&this.PYd(1);this.WY=new T;this.WY.TN=Q;this.WY.TP=ya;this.WY.ST=(new Date).toISOString();this.WY.STS=H.a.xU(this.yz(),2);kb?this.WY.UI=1:this.Yrm(Q)?
this.WY.UI=2:this.WY.UI=0}this.hwb++}PYd(Q){this.GSb|=Q}Uyd(Q=!0,ya=0){this.GSb=Q?0:this.GSb&~ya}stop(Q,ya=null){let kb;this.hwb--;0>=this.hwb&&this.WY&&(kb=this.yz()-this.WY.STS,this.$od+=kb,this.ZCe.YAa(kb,Q),this.ppi(Q)&&this.Uyd(!1,1),this.WY.TRT=H.a.xU(kb,2),ya&&(this.WY.TQT=H.a.xU(ya.Qqn,2),this.WY.TDT=H.a.xU(ya.wqi,2)),this.dLj&&(this.WQi(0,this.WY),this.YIn()),this.hwb=0);0<=Q.indexOf(J.a.mso)&&this.tac(2);0<=Q.indexOf(J.a.GXi)&&this.tac(4);1===(this.GSb&1)&&this.tac(1);2===(this.GSb&2)&&
this.tac(8)}YIn(){var Q=this.WY.TRT;if(750<Q){let kb=this.Zue.getData();if(kb){const Mb={};for(let vc in kb){var ya=kb[vc];const id=vc;id.startsWith("SiOp_")||id.endsWith("[it]")||(Mb[id]=Math.round(100*ya.T/Q))}kb=Mb}Q=Object.assign(new M,{B:this.WY.STS,T:Q,S:kb});this.jUj.track(Q,this.WY.TN)}}xco(){var Q=this.yz()-this.T6g,ya=H.a.xU(this.$od/Q*100,2);Q=new N;Q.CP=ya;Q.II=this.Jgd;ya=this.ZCe.getData();I.a.count(ya)&&(Q.LRT=ya);ya=this.Yue.getData();I.a.count(ya)&&(Q.FP=ya);this.fFe.raiseEvent("OnCpuMeterFrameAvailable",
new O(Q));this.fej()}fej(){this.ZCe.reset();this.Yue.reset();this.$od=this.hwb=0;this.T6g=this.yz();this.Jgd=0;this.WY=null}run(){this.W3g?this.xco():(this.fej(),this.W3g=!0);this.Era?this.Era(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}tud(Q,ya,kb){const Mb=Array(2);Mb[0]=ya;Mb[1]=kb;this.yrd[Q]||(this.yrd[Q]=[]);this.yrd[Q].push(Mb)}WQi(Q,ya){Q=this.yrd[Q];if(!V.a.kf(Q))for(let Mb=0;Mb<Q.length;Mb++){var kb=Q[Mb];const vc=kb[0];kb=kb[1];vc&&!vc(ya)||
kb(ya)}}p$b(){if(!this.rsc){const Q=window.setTimeout;this.Era=(ya,kb)=>Q(ya,kb);this.rsc=!0}}ppi(Q){return Q.startsWith("key")||Q.startsWith("input")}Yrm(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(e.a)(ba,"CpuMeter",null,[169]);class ha{constructor(Q){this.Inc=null;this.Op=new r.a;this.yz=Q}initialize(Q,ya,kb,Mb=!1){this.Inc||(this.Inc=new ba(this.yz,Q,ya,kb,Mb),this.Op.Cg(this.Inc));return this.Inc}}Object(e.a)(ha,"CpuMeterProvider",null,[1679]);var ca=
c(177),ia=c(164);class ra{constructor(Q=1){this.QC=[];this.xcd=[];this.gj=Q}Mil(){let Q=0;for(let ya=0;ya<this.QC.length;ya++)this.QC[ya]<this.QC[Q]&&(Q=ya);return Q}YAa(Q,ya){Q=H.a.xU(Q,2);if(this.QC.length<this.gj)Array.add(this.QC,Q),Array.add(this.xcd,ya);else{var kb=this.Mil();Q>this.QC[kb]&&(this.QC[kb]=Q,this.xcd[kb]=ya)}}getData(){return this.QC.length?{["Vals"]:this.QC,["Desc"]:this.xcd}:null}reset(){this.QC=[];this.xcd=[]}}Object(e.a)(ra,"MaxDataAggregator",null,[857]);var da=c(35),za=c(22);
class la{get name(){return"Common.App.CpuMeter"}xc(Q){Q.register(ha,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Xd(()=>new ha(da.a.Ye));Q.register(v,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Xd(()=>new v)}init(){const Q=F.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const ya=za.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");ia.a.instance.Hvd.continueWith(()=>{la.gdm(Q,ya)})}}dispose(){}static gdm(Q,
ya){const kb=R.a.sE(10,5,new K(Q.pc("TaskManagerLoggingThreshold",0),Q.pc("CpuMeterMaximumEntriesToLog",0)));ya=ya.initialize(new ra(5),new K,kb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfDisableCpuMeterFrames",!1)||(ya.run(),Q.$("CpuMeterMonitorIsEnabled")&&za.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ya,Q.$P("CpuMeterAverageCpuPercentThreshold",80),Q.pc("CpuMeterRollingAverageFramesCount",15)));w.b(16827671,
306,50,"Initializing CpuMeter")}static main(){ca.a.instance.Kc(new la)}}Object(e.a)(la,"CpuMeterPackage",null,[1,2]);var na=c(8),Ca=c(80),Na=c(1042),Ta=c(1021),Fa=c(15),qa=c(1374);class ja{constructor(){this.Jra=this.Jlc=null;this.zYb=!0;this.Bsc=!1}xc(Q){F.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1650,"Common.IEventTimingMeter").singleInstance().Xd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Ta.a(F.AFrameworkApplication.K.pc("EventTimingMeterEventSamplingPercent",
0)/100);Q=new Na.a(Object(a.a)(Q,Q.zMb,"shouldBeInSample"));const ya=R.a.sE(16,1,Q);this.Jra=new qa.a("TypingDuration-SlowPercentileAtValue","Percentile",F.AFrameworkApplication.K.$P("AshaVetoForTypingThresholdInMS",150),F.AFrameworkApplication.K.$P("AshaVetoForTypingThresholdPercentile",95),this.zYb);(this.Bsc=!Fa.a.c2a)&&F.AFrameworkApplication.rJ(()=>{this.U_e()});this.Jlc=kb=>{kb=kb.rawEvent.detail;for(const Mb of kb)ya.track(Mb,"EventTimingData"),"false"!==Mb.metadata.altPressed.toString()||
"false"!==Mb.metadata.ctrlPressed.toString()||"false"!==Mb.metadata.repeat.toString()||"CharacterKey"!==Mb.metadata.key.toString()&&"Space"!==Mb.metadata.key.toString()||!this.Bsc||this.Jra.Rwa(Mb.timeToRequestAnimationFrameMs)};G.a.addHandler(window.self,A.a.sgh,this.Jlc)}dispose(){this.Jlc&&(G.a.removeHandler(window.self,A.a.sgh,this.Jlc),this.Jlc=null)}U_e(){this.Jra.cRa();this.Jra.hJi&&(na.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Ca.Health.instance.recordQosError("SlowTypingSession",
["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){ca.a.instance.Kc(new ja)}}Object(e.a)(ja,"EventTimingMeterPackage",null,[1,2]);var X=c(82),ua=c(68),Ha=c(33);class Ea{constructor(Q,ya,kb,Mb=null,vc=null){this.mL=Q;this.esb=ya;this.yqc=kb;this.C0g=Mb;this.bwc=vc}RFd(Q){const ya=new Sys.StringBuilder(this.mL.p1c);ya.append("RoamingServiceHandler.ashx?action=");ya.append("getFirstRunExperienceSettings");ya.append("&");ya.append(this.Llf(Q));ya.append("&");ya.append(F.AFrameworkApplication.Gm);
F.AFrameworkApplication.Ve.qj(ya.toString(),1,null,null,!0,2,Object(a.a)(this,this.pDa,"getRequestSuccessCallback"),Object(a.a)(this,this.Daa,"getRequestFailureCallback"),null)}r3b(Q){var ya=new Sys.StringBuilder(this.mL.p1c);ya.append("RoamingServiceHandler.ashx?action=");ya.append("saveFirstRunExperienceSettings");ya.append("&");ya.append(F.AFrameworkApplication.Gm);ya=ya.toString();Q=Ha.c(Q);F.AFrameworkApplication.Ve.qj(ya,2,Q,null,!0,4,Object(a.a)(this,this.Zin,"postRequestSuccessCallback"),
Object(a.a)(this,this.Rba,"postRequestFailureCallback"),null)}pDa(Q){let ya=!1,kb=null;try{if(0<Q.data.Ae.length){const Mb=Object(ua.a)(Object,Ha.a(Q.data.Ae)),vc=Mb?Mb[this.mL.cVe]:null;vc&&(kb=Object(ua.a)(Object,Ha.a(vc.toString())))}ya=!0}catch(Mb){this.Daa(null)}ya&&this.esb&&this.esb(Q.data,kb)}Daa(Q){this.yqc&&this.yqc(Q?Q.data:null)}Zin(Q){this.C0g&&this.C0g(Q?Q.data:null)}Rba(Q){this.bwc&&this.bwc(Q?Q.data:null)}Llf(Q){const ya=new Sys.StringBuilder("requestedsettings=");for(let kb=0;kb<
Q.count;kb++)ya.append(Q.J(kb)),kb<Q.count-1&&ya.append(";");return ya.toString()}}Object(e.a)(Ea,"FirstRunExperienceRequestHandler",null,[]);var wa=c(205);class sa{constructor(){this.eqc=this.jed=this.mL=null}f$n(Q){Q?(this.mL=Q,this.Vrm()&&(na.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new X.a,Q.add(this.mL.cVe),this.jed=new Ea(this.mL,Object(a.a)(this,this.pDa,"getRequestSuccessCallback"),Object(a.a)(this,this.Daa,"getRequestFailureCallback"),
null,Object(a.a)(this,this.Rba,"postRequestFailureCallback")),this.jed.RFd(Q)),(this.mL.Koi||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.E5f()):na.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Vrm(){try{if(this.mL.Koi)return!0;if(!F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||F.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.mL.Pmm||
this.mL.W9b||F.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=F.AFrameworkApplication.K.lb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){na.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}T0i(Q){const ya={},kb={};kb.FREDisplayedDate=(new Date).toUTCString();kb.VersionDisplayed=Q;kb.RemindMeLater=!1;ya[this.mL.cVe]=Ha.c(kb);na.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.jed&&this.jed.r3b(ya)}pDa(Q,ya){Q=Q?+Q.FS-+Q.oH:-1;Q>this.mL.H_i?na.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.mL.H_i):ya?this.$8n(ya)?(na.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.mL.ryi),this.E5f()):(this.d9e(!1),
na.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(na.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.E5f())}Daa(Q){this.d9e(!1);na.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.jf:-1)}Rba(Q){na.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
Q?Q.jf:-1)}E5f(){this.d9e(!0);var Q=za.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?this.Xaj(Q):(na.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Q=za.a.instance.Za("Common.ISystemInitiatedFeedback"))?Q.execute(ya=>{this.Xaj(ya)}):na.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Xaj(Q){if(Q){var ya=this.mL.Qll;
ya&&(F.AFrameworkApplication.Xm(ya),F.AFrameworkApplication.Aga(ya));na.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ya);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.eqc=Object(a.a)(this,this.R3m,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.eqc,!0),window.addEventListener("FRELaunchedEvent",this.eqc,!0)):(na.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.T0i(this.mL.currentVersion))}else na.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}R3m(Q){if(Q){var ya=Q.detail;Q=Q.type;var kb=this.mL&&this.mL.lph?this.mL.lph.split("-")[0]:null;if("FRELaunchedEvent"===Q||kb&&ya&&ya.id&&-1!==ya.id.indexOf(kb))ya.success&&(na.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.T0i(this.mL.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.eqc,
!0),window.removeEventListener("FRELaunchedEvent",this.eqc,!0))}}$8n(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.mL.ryi)return!0}else if(F.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<this.mL.currentVersion)return na.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}d9e(Q){F.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
wa.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(e.a)(sa,"FirstRunExperienceLauncher",null,[1635]);class fa{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}xc(Q){this.W=Q;this.W.register(1635,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Xd(()=>new sa)}init(){}dispose(){}static main(){ca.a.instance.Kc(new fa)}}Object(e.a)(fa,"FirstRunExperienceLauncherPackage",null,[1,2]);class Ma{constructor(){this.y=this.x=0}}Object(e.a)(Ma,
"HammerPoint",null,[]);var Ua=c(13);class Qa{constructor(Q,ya,kb,Mb,vc){this.RTg=this.eVa=this.wgd=1;this.Lsd=this.pzc=this.qXa=0;this.tEe=this.rIa=null;this.Hpb=this.eue=this.nnd=!1;this.Oi=Q;this.UKa=ya;this.Kvb=kb;this.ga=Mb;vc&&(this.nnd=vc.$("PromoteLayerPinchToZoomIsEnabled"),this.eue=vc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.Hpb=vc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get NK(){return this.UKa}vpm(){return!!this.Oi.instance}o4m(Q){this.ga&&this.ga.processAction(Ua.a.rej,
2);const ya=this.Oi.instance;this.nnd&&ya.LQi();this.eVa=ya.jj;this.wgd=Q.BJc.scale;this.RTg=1;this.tEe=this.Roh();this.rIa=this.UKa.getBounds();if(!this.rIa)return na.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.R1h(Q);this.Hpb?this.L6i(this.UKa.scrollWidth,this.rIa.width,Q,this.eVa,ya):this.qXa=this.UKa.scrollWidth>this.rIa.width?this.BCc(this.Kvb.scrollLeft,Q.x,this.eVa):null;this.Lsd=this.UKa.scrollHeight>this.rIa.height?this.BCc(this.Kvb.scrollTop,Q.y,this.eVa):null;return!0}mZf(){this.qXa=
null;this.pzc=0}L6i(Q,ya,kb,Mb,vc){Q>ya?this.qXa?(Q=vc.nBf,Q!==this.pzc&&(this.qXa-=this.pzc-Q,this.pzc=Q)):(this.qXa=this.BCc(this.Kvb.scrollLeft,kb.x,Mb),this.pzc=vc.nBf):this.mZf()}n4m(Q){const ya=this.R1h(Q);if(!ya)return na.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.vXn(Q.BJc.scale/this.wgd)*this.eVa;this.xAo(ya,Q);this.yAo(ya,Q);return!0}xAo(Q,ya){const kb=this.UKa.scrollWidth,Mb=this.rIa.width;this.Hpb?this.L6i(kb,Mb,Q,ya,this.Oi.instance):!this.qXa&&kb>Mb&&
(this.qXa=this.BCc(this.Kvb.scrollLeft,Q.x,ya));if(Q=this.Zoh(Q.x,this.qXa,kb,Mb,ya))this.Kvb.scrollLeft=Q}yAo(Q,ya){const kb=this.UKa.scrollHeight,Mb=this.rIa.height;!this.Lsd&&kb>Mb&&(this.Lsd=this.BCc(this.Kvb.scrollTop,Q.y,ya));if(Q=this.Zoh(Q.y,this.Lsd,kb,Mb,ya))this.Kvb.scrollTop=Q}Zoh(Q,ya,kb,Mb,vc){return kb<=Mb||!ya||!Mb?null:Math.max(0,Math.min(ya*vc-Q,kb-Mb))}BCc(Q,ya,kb){return(Q+ya)/kb}m4m(Q){Q=Q.BJc.scale;this.eue&&(Q/=this.wgd);this.kNh(Q);this.nnd&&this.Oi.instance.OUf();this.ga&&
this.ga.processAction(Ua.a.paf,2);this.Hpb&&this.mZf()}l4m(Q){Q=Q.BJc.scale;this.eue&&(Q/=this.wgd);this.kNh(Q,!0);this.nnd&&this.Oi.instance.OUf();this.ga&&this.ga.processAction(Ua.a.paf,2);this.Hpb&&this.mZf()}vXn(Q){const ya=this.Oi.instance,kb=new Date>=this.tEe;kb&&(this.tEe=this.Roh());Math.abs(Q-this.RTg)>=.01*Q&&ya.l3n(Q*this.eVa,kb);return ya.jj/this.eVa}kNh(Q,ya=!1){Q*=this.eVa;this.Oi.instance.M3f(Q,!1);const kb={};kb.initialScale=this.eVa;kb.finalScale=Q;kb.cancelled=ya;na.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",kb)}R1h(Q){return(Q=Q.BJc.center)&&this.rIa?Object.assign(new Ma,{x:Q.x-this.rIa.x,y:Q.y-this.rIa.y}):null}Roh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(e.a)(Qa,"PinchZoomAdapter",null,[1692]);class Ja{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(Ja,"ScrollContainerElement",null,[1688]);
var Wa=c(112);class Ya{constructor(Q,ya,kb,Mb,vc,id){this.XMe=this.G9a=null;this.W=Q;this.je=ya;this.Ehd=kb;this.IRg=Mb;this.PRj=vc;this.lTb=id;this.hbd=new X.a}register(Q,ya){this.Ehd&&(4===F.AFrameworkApplication.ta.Pb.$n&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Wa.a.get_instance().al(8,()=>{this.qZi(Q,ya)}):this.qZi(Q,ya))}qZi(Q,ya){this.W.Za("Common.IGestureInputManager").execute(kb=>{this.kfo();this.G9a=kb;this.hbd.add(Q);
if(this.IRg){if(this.PRj&&0!==kb.fEl()){this.Uej();return}var Mb=this.W.Za("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const vc=new Ja(Q);Mb=new Qa(Mb,vc,ya,F.AFrameworkApplication.ya,F.AFrameworkApplication.K);kb.rzn(Q,Mb)}this.Uej()})}unregister(){if(this.G9a&&this.hbd){if(this.IRg){for(let Q of this.hbd)this.G9a.Qto(Q);this.hbd.clear()}this.G9a=null}}kfo(){this.lTb&&(this.je?this.XMe=this.je.jg("Task","Register"):na.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}Uej(){this.lTb&&
(this.XMe?this.XMe.stop():na.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(Ya,"GestureInputRegistrar",null,[1649]);class sb{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInput"}init(){this.Ah||(this.W.resolve("Common.IGestureInputRegistrar"),this.Ah=!0)}dispose(){}xc(Q){this.W=Q;Q.register(1649,"Common.IGestureInputRegistrar").singleInstance().Xd(()=>new Ya(Q,F.AFrameworkApplication.ta.tq,F.AFrameworkApplication.nRc(),F.AFrameworkApplication.pmi(),
!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){ca.a.instance.Kc(new sb)}}Object(e.a)(sb,"GestureInputPackage",null,[1,2]);var ob=c(320),fc=c(85);class Eb{constructor(){this.Mlb=this.HRh=null}}Object(e.a)(Eb,"GestureAdapterInfo",null,[]);var Ib=c(379),Nb=c(240);class pb{constructor(){this.Xqb=null}OBf(){if(!this.Xqb){var Q="hammer.min.js";F.AFrameworkApplication.K.Sv("IsServerFlavorDebug")&&
(Q=F.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=F.AFrameworkApplication.Nw(String.format("{0}",Q),5);Q=Nb.a.create(Q,null,null);Ib.a.eT(Q);this.Xqb=Q.G2a}return this.Xqb}static get instance(){pb._instance||(pb._instance=new pb);return pb._instance}}pb._instance=null;Object(e.a)(pb,"HammerJsDependencyLoader",null,[1690]);const Aa=(Q,ya,kb=null)=>{if(void 0===ya||null===ya)throw na.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Mb=null;switch(Q){case A.a.pinch:Mb=new Hammer.Pinch(kb);break;case A.a.pan:Mb=new Hammer.Pan(kb)}Mb&&(Mb.manager=ya);return Mb};var xb;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(xb||(xb={}));Object(e.b)("GestureEvent",xb);var gb=c(56);class Xa extends gb.a{constructor(Q,ya,kb,Mb,vc,id,ae,we){super(Q,kb,Mb,id);this.Zmc=ya;this.TWa=ae;this.Bqa=we;this.MMj=vc}get shiftKey(){return this.TWa}get ctrlKey(){return this.Bqa}get clientPoint(){return this.Zmc}get BJc(){return this.MMj}static create(Q,
ya,kb,Mb,vc,id){if(kb.rawEvent)if(id){var ae=kb.rawEvent;ae=new Sys.UI.Point(ae.clientX,ae.clientY)}else ae=gb.a.PId(kb);else ae=new Sys.UI.Point(kb.clientX,kb.clientY);return new Xa(Q,ae,ya,kb,Mb,vc,kb.shiftKey,kb.ctrlKey,id)}}Object(e.a)(Xa,"GestureEventArgs",gb.a,[]);class Va{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(Va,"GestureManagerData",null,[]);class Gb{}Gb.Xzj=2;Gb.Yzj=4;Gb.Zzj=8;Gb.$zj=8;Object(e.a)(Gb,"HammerConstants",null,[]);var Xb=c(75),rc=c(107),qb=c(16),Zb=c(93);class Rb extends G.a{constructor(Q,ya){super();this.FJa=ob.a.Oql;this.pHe=!!window.PointerEvent;this.Z8g=window.hasOwnProperty("ontouchstart");this.Zrb=this.Yuc=null;this.rJa=
!1;this.Uja=new fc.a;this.$vc=new fc.a;this.JLg=new X.a;this.N8a=null;this.HQb=this.lTb=this.zDg=this.Coe=this.MCe=this.N2g=this.QDg=this.xzc=!1;this.auc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.YMe=null;this.tg=Xb.EventHandlerManager.instance;this.pHe?(na.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Yuc=Object(a.a)(this,this.H1d,"onPointerEvent"),this.Zrb=A.a.Qql):this.Z8g?(na.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Yuc=Object(a.a)(this,
this.Ukb,"onTouchEvent"),this.Zrb=A.a.touchEvents):(na.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Yuc=Object(a.a)(this,this.t1d,"onMouseEvent"),this.Zrb=A.a.Pql);this.je=ya;this.g1=Q;F.AFrameworkApplication.K&&(this.xzc=F.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.QDg=F.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.N2g=F.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.MCe=F.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Coe=F.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.zDg=F.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.lTb=F.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.HQb=this.xzc&&F.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&F.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}fEl(){return this.pHe?0:this.Z8g?1:2}Vu(Q){super.Vu(Q);this.tg.MDa(this.Zrb,Q,0,this.Yuc)}Nu(Q){super.Nu(Q);
this.tg.zZa(Q,this.Zrb)}rzn(Q,ya){F.AFrameworkApplication.nRc()?pb.instance.OBf().continueWith(kb=>{this.jfo();if(kb.Di||kb.yo)na.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",kb.status);else{na.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",kb.status);if(this.zDg){kb=window.Hammer;if("undefined"===typeof kb){na.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Nde();return}if("undefined"===typeof kb.inputHandler){na.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.Nde();return}}if(!Q)throw this.Nde(),Error.argumentNull("source element can not be null");kb=rc.a.Db(Q,this.FJa);if(void 0===kb||null===kb)kb=new fc.a,rc.a.rl(Q,this.FJa,kb),this.szn(Q);if(!kb.ub(xb[0])){var Mb=Object.assign(new Eb,{Mlb:Aa(xb[0],this,null),HRh:ya});kb.add(xb[0],Mb)}}this.Nde()}):na.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}jfo(){this.lTb&&(this.je?this.YMe=this.je.jg("Task",
"RegisterGestureAdapterAfterLoad"):na.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Nde(){this.lTb&&(this.YMe?this.YMe.stop():na.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Qto(Q){na.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const ya=rc.a.Db(Q,this.FJa);void 0!==ya&&null!==ya&&(ya.remove(xb[0]),ya.count||(rc.a.tU(Q,this.FJa),this.curRecognizer=null,this.Rto(Q)))}szn(Q){this.JLg.add(Q);this.tg.MDa(this.Zrb,Q,
0,this.Yuc)}Rto(Q){this.JLg.remove(Q);this.tg.zZa(Q,this.Zrb)}recognize(Q){var ya=Array(Q.pointers.length);for(var kb=0;kb<Q.pointers.length;kb++)ya[kb]=Q.pointers[kb].target;kb=null;for(this.N8a=this.nJl(ya);void 0!==this.N8a&&null!==this.N8a&&(kb=rc.a.Db(this.N8a,this.FJa),void 0===kb||null===kb);this.N8a=this.N8a.parentNode);if(void 0!==kb&&null!==kb){this.curRecognizer&&this.curRecognizer.state===Gb.$zj&&(this.curRecognizer=null);ya=kb.keys;for(let Mb of ya){ya=kb.J(Mb);void 0!==ya&&null!==ya&&
void 0!==ya.Mlb&&null!==ya.Mlb&&(void 0===this.curRecognizer||null===this.curRecognizer||ya.Mlb===this.curRecognizer||ya.Mlb.canRecognizeWith(this.curRecognizer))&&ya.Mlb.recognize(Q);const vc=ya.Mlb.state;this.curRecognizer||Gb.Xzj!==vc&&Gb.Yzj!==vc&&Gb.Zzj!==vc||(this.curRecognizer=ya.Mlb)}}}emit(Q,ya){if("hammer.input"!==Q){this.rJa=!1;ya=Xa.create(Q,this.N8a,ya.srcEvent,ya,3,this.pHe);var kb=rc.a.Db(this.N8a,this.FJa);if(this.Jtm(Q))var Mb=0;else if(this.jtm(Q))Mb=1;else if(this.axm(Q))Mb=2;else{na.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:kb}=kb.Gc(xb[Mb]));void 0!==kb&&null!==kb&&((kb=kb.HRh,kb.vpm())?Q.endsWith("start")?this.rJa=kb.o4m(ya):Q.endsWith("end")?(kb.m4m(ya),this.rJa=!0):Q.endsWith("cancel")?(kb.l4m(ya),this.rJa=!0):Q.endsWith("move")&&(this.rJa=kb.n4m(ya)):na.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(ua.a)(Hammer.Recognizer,Q)}nJl(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];
var ya=Q[0],kb=!0;for(let Mb=1;Mb<Q.length;Mb++){if(!Q[Mb])return null;if(ya!==Q[Mb]){kb=!1;break}}if(kb)return ya;ya=this.jSh(Q[0]);kb=0;for(const Mb of Q){Q=this.jSh(Mb);if(ya.J(ya.count-1)!==Q.J(Q.count-1))return null;for(let vc=ya.count-2,id=Q.count-2;vc>=kb&&0<=id;vc--,id--)if(ya.J(vc)!==Q.J(id)){kb=vc+1;break}}return ya.J(kb)}jSh(Q){const ya=new X.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)ya.add(Q);return ya}ZYh(Q){switch(Q){case A.a.HO:case A.a.syb:return 1;case A.a.GO:case A.a.FYe:return 2;
case A.a.vJ:case A.a.tyb:return 4;case A.a.Yfe:case A.a.EYe:return 8}return 0}Ukb(Q,ya,kb){Q=this.ZYh(Q);ya=this.HGl(kb);Hammer.inputHandler(this,Q,ya);this.rJa&&kb.preventDefault();return this.rJa}L9h(){return 1<this.Uja.count}Txd(){na.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.xzc)for(let Q of this.Uja)this.AVi(Q.key);else this.Uja=new fc.a;this.session=null}obk(Q,ya,kb){na.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.$vc.ub(Q)){try{ya.setPointerCapture(Q)}catch(Mb){na.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Mb)}this.$vc.add(Q,ya)}this.Uja.Z(Q,kb);this.HQb&&1<this.Uja.count&&this.g1&&!this.g1.NCc&&(this.g1.NCc=!0)}AVi(Q){na.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.$vc.ub(Q)){try{this.$vc.J(Q).releasePointerCapture(Q)}catch(ya){na.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ya)}this.$vc.remove(Q)}else na.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.Uja.remove(Q);this.HQb&&
1>=this.Uja.count&&this.g1&&this.g1.NCc&&(this.g1.NCc=!1)}H1d(Q,ya,kb){var Mb=kb.rawEvent.pointerType.toString();const vc=kb.rawEvent.pointerId.toString();if("touch"!==Mb)return!1;Q=this.ZYh(Q);if(1!==Q&&!this.Uja.ub(vc))return!1;this.QDg&&1===Q&&kb.rawEvent.isPrimary&&this.Uja.count&&(na.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Txd());this.xzc?this.obk(vc,ya,kb):this.Uja.Z(vc,kb);this.MCe&&2===Q&&(!this.Coe||this.Coe&&"function"===typeof kb.rawEvent.getCoalescedEvents)&&
(ya=kb.rawEvent.getCoalescedEvents())&&this.L9h()&&(this.auc=Math.max(this.auc,ya.length));this.N2g&&(this.rJa=!1);Mb=this.GGl(this.Uja,kb,Mb);Hammer.inputHandler(this,Q,Mb);if(4===Q||8===Q)this.xzc?this.AVi(vc):this.Uja.remove(vc),this.Uja.count||(this.session=null,this.MCe&&-1!==this.auc&&(na.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.auc),this.auc=-1));this.rJa&&kb.preventDefault();return this.rJa}t1d(){return!1}HGl(Q){const ya=new Va;var kb=Q.rawEvent;const Mb=
kb.touches;kb=kb.changedTouches;ya.pointers=Array.clone(Mb);ya.pointers=Array.clone(0<Mb.length?Mb:kb);ya.changedPointers=Array.clone(kb);ya.srcEvent=Q;ya.pointerType="touch";return ya}GGl(Q,ya,kb){const Mb=new Va;Mb.pointers=Zb.toArray(Q.values);Mb.changedPointers=[ya];Mb.pointerType=kb;Mb.srcEvent=ya;return Mb}Jtm(Q){return qb.a.startsWith(Q,A.a.pinch)}jtm(Q){return qb.a.startsWith(Q,A.a.pan)}axm(Q){return qb.a.startsWith(Q,A.a.swipe)}}Object(e.a)(Rb,"GestureInputManager",G.a,[1675,1676]);var Ra=
c(243);class ab{constructor(){this.W=null;this.Ah=!1}get name(){return"Common.App.GestureInputManager"}xc(Q){Q.register(Rb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Xd(()=>new Rb(Ra.a.instance,F.AFrameworkApplication.ta.tq));this.W=Q}init(){this.Ah||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Ah=!0)}dispose(){}static main(){ca.a.instance.Kc(new ab)}}Object(e.a)(ab,"GestureInputManagerPackage",null,[1,2]);var fb=c(231),
bb=c(46),Ub=c(1514);class Oa{constructor(Q,ya,kb){this.qLe=this.pLe=null;this.aXb=new r.a;this.rg=Q;this.Quc=kb;this.yka=ya.appSettings[Oa.lGo]||""}get I4n(){return this.aXb.task}get yP(){return this.rg.value}zJn(){const Q={};Q[Oa.s5l]=F.AFrameworkApplication.Gm;Q["Content-Type"]="application/json; charset=utf-8";na.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ya=bb.a.zp(this.yka+Oa.J4n,Oa.y_m,F.AFrameworkApplication.ta.Pb.$n.toString());
this.yP.qj(ya,1,"",Q,!0,2,Object(a.a)(this,this.QIb,"onSuccessCallback"),Object(a.a)(this,this.EIb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}pLm(Q){try{const ya={};ya.FlightName=Q.FlightName;ya.SessionID=Q.SessionID;na.ULS.sendTraceTag(594883776,215,50,Ha.c(ya))}catch(ya){na.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}QIb(Q){if((Q=Q.data.Ae)&&Q.length)try{const ya=Ha.a(Q);this.pLe=ya.NavBarDataJson;na.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.pLe?({Uv:this.qLe}=Ha.d(ya.NavBarDataJson)).returnValue?(this.pLm(this.qLe),this.aXb.Cg(this.qLe)):(na.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Ub.a.x6c(this.pLe)}),this.aXb.hca()):(na.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.aXb.hca())}catch(ya){na.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.aXb.hca()}else na.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}EIb(){this.aXb.hca();
na.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Oa._instance||(Oa._instance=Oa.SBb())}static SBb(){return new Oa(new fb.a(()=>F.AFrameworkApplication.Ve),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.Pb.$n)}}Oa.s5l="X-qs";Oa.y_m="at";Oa.J4n="O365ShellServiceProxy.ashx";Oa._instance=null;Oa.lGo="ShellWebServiceBase";Object(e.a)(Oa,"O365ShellActor",null,[1941]);class Fc{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}xc(Q){this.W=
Q;this.W.register(Oa,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Xd(()=>new Oa(new fb.a(()=>F.AFrameworkApplication.Ve),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.Pb.$n))}init(){F.AFrameworkApplication.K.lp(Object(a.a)(this,this.rx,"onFullAppSettingsReady"))}rx(){F.AFrameworkApplication.Ldg&&F.AFrameworkApplication.ta.Pb.ZI&&this.W.resolve("Common.App.O365Shell.O365ShellActor").zJn()}dispose(){}static main(){ca.a.instance.Kc(new Fc)}}
Object(e.a)(Fc,"PackageManager",null,[1,2]);class xc{KPa(){}init(){}dispose(){}}Object(e.a)(xc,"NoOpOfflineLogger",null,[2005,9]);var pd=c(607);class lb{}lb.Gvd=0;Object(e.a)(lb,"OfflineLoggerConstants",null,[]);var Tb=c(83),pc=c(234),Db=c(318);class Ob{constructor(Q,ya,kb,Mb,vc,id,ae){this.PCe=this.Rtc=null;this.nVa=!1;this.G5=null;this.Vnc=this.tUb=this.Lqb=0;this.RJ=this.K$a=this.wad=this.nmd=this.eS=null;this.El=!1;this.Rza=kb;this.CAa=Mb;this.sAa=vc;this.rg=ya;this.Gb=Q;this.mUa=id;ae?(this.wad=
new Ob(Q,ya,kb,Mb,vc,id,!1),this.wad.nmd=this,this.Rtc="OfflineLoggerManifest|"+this.mUa,this.PCe="OfflineLog|"+this.mUa+"|"):(this.Rtc="OfflineLoggerManifest",this.PCe="OfflineLog|")}init(){this.Y3f();this.XEm();this.nVa=!1;this.rg.$Yb(this);this.eS=new Tb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Gb.Xb(this.eS);this.wad&&this.wad.init()}pCc(Q){return this.PCe+Q}XEm(){const Q=this.Rza.getItem(this.Rtc);void 0!==Q&&null!==Q&&0<Q.length&&(this.G5=Ob.E6c(Q));this.G5||
(this.G5={});if(void 0===this.G5.end||null===this.G5.end)this.G5.end=0;if(void 0===this.G5.offset||null===this.G5.offset)this.G5.offset=0;this.Lqb=this.G5.offset;isFinite(this.Lqb)||(this.Lqb=0);this.tUb=this.G5.end;isFinite(this.tUb)||(this.tUb=0);this.Vnc=this.tUb}Y3f(){this.K$a=new Db.a;this.RJ=new pc.a;this.nmd||(this.CAa.Teh(Object(a.a)(this,this.KNf,"onUlsReadyToBeSent")),this.CAa.zfh(Object(a.a)(this,this.MNf,"onUlsSentSuccessfully")),this.CAa.yfh(Object(a.a)(this,this.LNf,"onUlsSentFailed")));
this.CAa.Jeh(Object(a.a)(this,this.XJf,"onAfterUlsHostDisposed"))}KNf(Q,ya){if(void 0!==ya&&null!==ya&&void 0!==ya.args&&null!==ya.args){Q=!1;if(!this.K$a.ub(ya.args.tag)){if(!this.K$a.ub(lb.Gvd))return;Q=!0}this.K$a.remove(Q?lb.Gvd:ya.args.tag);this.RJ.ub(ya.GM)||this.RJ.Z(ya.GM,new X.a);this.RJ.J(ya.GM).add(ya.args)}}MNf(Q,ya){this.RJ.remove(ya.GM)}LNf(Q,ya){if(void 0!==ya&&null!==ya&&this.RJ.ub(ya.GM)){Q=this.RJ.J(ya.GM);for(let kb=0,Mb=Q.count;kb<Mb;++kb)ya=Ob.serialize(Q.J(kb),this.sAa),this.F6c(this.pCc(this.Vnc++),
ya)}}XJf(){this.dispose()}F6c(Q,ya){try{return this.Rza.setItem(Q,ya),!0}catch(kb){return na.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",kb.message),!1}}sendOfflineLogs(){if(!this.nVa){for(var Q=this.Lqb,ya=new X.a,kb=null;Q<this.tUb&&5>=ya.count;++Q){var Mb=this.pCc(Q);const vc=this.Rza.getItem(Mb);this.Rza.removeItem(Mb);if(void 0===vc||null===vc)continue;const id=({sessionId:Mb}=Ob.deserialize(vc)).returnValue;if(id){if(!kb)kb=Mb;else if(Mb!==kb)break;ya.add(id)}else na.ULS.sendTraceTag(18614233,
222,15,"Unable to deserialze the offline log: {0}",vc)}0<ya.count&&this.CAa.RYi(this,Zb.toArray(ya),kb);this.Lqb=Q;Q>=this.tUb&&(this.Gb.Se(this.eS),this.eS=null)}}KPa(Q,ya,kb){!this.El&&na.ULS.O8(ya,kb)&&(this.nmd?this.nmd.KPa(Q,ya,kb):this.K$a.Z(Q,!0))}dispose(){if(!this.El){this.eS&&this.Gb.Se(this.eS);var Q=Zb.toArray(this.RJ.keys);Q.sort();for(const ya of Q){Q=this.RJ.J(ya);for(let kb=0,Mb=Q.count;kb<Mb;++kb){const vc=Ob.serialize(Q.J(kb),this.sAa);this.F6c(this.pCc(this.Vnc++),vc)}}this.Lqb<
this.Vnc?(this.G5.end=this.Vnc,this.G5.offset=this.Lqb,this.F6c(this.Rtc,JSON.stringify(this.G5))):this.Rza.removeItem(this.Rtc)}this.El=!0}hQa(){this.nVa=!0}dkb(){this.nVa=!1}static serialize(Q,ya){const kb={};kb.t=Q.tag;kb.c=Q.category;kb.l=Q.level;kb.m=Q.message;kb.lt=Q.logType;kb.s=ya;kb.ts=Q.timestamp;kb.o=Q.isMinified;kb.a=Q.args;return JSON.stringify(kb)}static deserialize(Q){return(Q=Ob.E6c(Q))?{returnValue:new pd.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static E6c(Q){try{return JSON.parse(Q)}catch(ya){na.ULS.sendTraceTag(18614234,
222,10,"OfflineLogger TryParseString failed with exception: {0}",ya.message)}return null}}Object(e.a)(Ob,"OfflineLoggerImpl",null,[2005,9,225]);class jb{constructor(Q,ya,kb,Mb){this.sessionId=Q;this.version=ya;this.twd=kb;this.pOf=Mb;this.Yva=new X.a}}Object(e.a)(jb,"CachedLogUpload",null,[]);class tb{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(e.a)(tb,
"LoggingExceptionArgsLocalStorage",null,[]);class ac{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new tb(Q.exceptionArgs))}}Object(e.a)(ac,"LoggingArgsLocalStorage",null,[]);var zc=c(361);class yc{constructor(Q,ya,kb,Mb,vc,id,ae){this.t=Q;this.m=ya;this.s=kb;this.v=Mb;this.i=vc;this.a=id;this.d=ae;this.op="Log"}}Object(e.a)(yc,"LoggingKeyLocalStorage",null,[]);var cd=c(119);
const Cd=(Q,ya,kb,Mb,vc)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===ya&&isFinite(Q.t)&&cd.a.isValid(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===kb)&&(!vc||void 0===Q.d||null===Q.d||Q.d===Mb);class ud{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,Fg,ck){this.nVa=this.uVg=this.iVg=this.jVg=!1;this.RJ=this.K$a=this.G5=this.eS=null;this.El=!1;this.gtb=[];this.nUb=[];this.Rza=kb;this.CAa=Mb;this.sAa=vc;this.rg=ya;this.Gb=
Q;this.Quc=id;this.SEe=ae;this.X2g=we;this.FVa=Ee;this.RTj=jf;this.gAe=Ng;this.mUa=Fg;this.$Pg=ck}get manifest(){return this.G5}get $Tc(){return this.K$a}get LPa(){return this.RJ}init(){this.Y3f();this.nVa=!1;this.rg.$Yb(this);this.eS=new Tb.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Gb.Xb(this.eS)}determineLogsToSendAtBoot(){this.bFh(!0)}determineLogsToSendOnReconnect(){this.bFh(!1)}bFh(Q){this.sFd();this.gtb=[];Q&&(this.nUb=[]);for(var ya=0;ya<
this.Rza.length;ya++){const kb=this.Rza.key(ya),Mb=ud.Glj(kb,!1);Cd(Mb,this.Quc,this.SEe,this.mUa,this.$Pg)&&(Mb.s===this.sAa?Array.add(this.gtb,kb):Q&&Array.add(this.nUb,kb))}if(this.gtb.length||Q&&this.nUb.length)if(ya=this.gAe?Object(a.a)(this,this.Bco,"sortDescendKeysToUpload"):Object(a.a)(this,this.Eco,"sortKeysToUpload"),this.gtb.sort(ya),Q&&this.nUb.sort(ya),0<this.gtb.length||0<this.nUb.length)this.eS=new Tb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Gb.Xb(this.eS)}Eco(Q){return Q.s!==
Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}Bco(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}pCc(Q,ya,kb,Mb){Q=new yc(this.Quc,this.SEe,ya,kb,Q,Mb,this.mUa);return JSON.stringify(Q)}Y3f(){this.K$a=new Db.a;this.RJ=new pc.a;this.CAa.Teh(Object(a.a)(this,this.KNf,"onUlsReadyToBeSent"));this.CAa.zfh(Object(a.a)(this,this.MNf,"onUlsSentSuccessfully"));this.CAa.yfh(Object(a.a)(this,this.LNf,"onUlsSentFailed"));this.CAa.Jeh(Object(a.a)(this,this.XJf,"onAfterUlsHostDisposed"))}KNf(Q,ya){if(void 0!==ya&&null!==
ya&&void 0!==ya.args&&null!==ya.args){if(this.$Tc.ub(ya.args.tag))this.$Tc.remove(ya.args.tag);else if(this.$Tc.ub(lb.Gvd))this.$Tc.remove(lb.Gvd);else if(!(this.RTj&&50>ya.args.level))return;({value:Q}=this.LPa.Gc(ya.GM)).returnValue||(Q=new jb(ya.sessionId,ya.version,ya.twd,ya.pOf),this.LPa.Z(ya.GM,Q));this.LPa.J(ya.GM).Yva.add(ya.args)}}MNf(Q,ya){this.LPa.remove(ya.GM)}LNf(Q,ya){void 0!==ya&&null!==ya&&this.LPa.ub(ya.GM)&&this.Nyi(ya.GM)&&!this.uVg&&(this.uVg=!0,na.ULS.sendTraceTag(37290073,222,
50,"Added logs to local storage."))}Nyi(Q){let ya=!1;if(({value:Mb}=this.LPa.Gc(Q)).returnValue&&Mb&&0<Mb.Yva.count){if(Mb.twd>=this.FVa)return!1;var kb=Mb.Yva;const vc=Array(kb.count);for(let id=0,ae=kb.count;id<ae;++id)vc[id]=new ac(kb.J(id));kb=ud.serialize(vc);var Mb=this.pCc(Mb.pOf,Mb.sessionId,Mb.version,Mb.twd);this.F6c(Mb,kb)&&(this.LPa.remove(Q),ya=!0)}return ya}XJf(){this.dispose()}F6c(Q,ya){try{return this.Rza.setItem(Q,ya),!0}catch(kb){return na.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",
kb.message),!1}}sendOfflineLogs(){if(!this.nVa){var Q=0<this.gtb.length?this.gtb:this.nUb,ya=Q.length;if(ya)for(;0<ya;){F.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");ya--;var kb=this.gAe?Q.pop():Q[0];this.gAe||Array.removeAt(Q,0);const id=ud.Glj(kb,!0);if(Cd(id,this.Quc,this.SEe,this.mUa,this.$Pg)){var Mb=this.Rza.getItem(kb);this.Rza.removeItem(kb);if(void 0!==Mb&&null!==Mb)if(id.a>this.FVa)na.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",
id.a,this.FVa);else if(kb=ud.E6c(Mb,!0),void 0!==kb&&null!==kb&&isFinite(kb.length))if(kb.length){Mb=kb[kb.length-1];var vc=(new Date).getTime()-Mb.ts;if(vc<-ud.hij)na.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Mb.ts);else if(vc>this.X2g*ud.hij)na.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.X2g,Mb.ts);else{id.s===this.sAa?this.jVg||(this.jVg=!0,na.ULS.sendTraceTag(37290080,
222,50,"Attempted to re-send logs from this session.")):this.iVg||(this.iVg=!0,na.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",id.s));ya=Array(kb.length);for(Mb=0;Mb<kb.length;Mb++){Q=Mb;a:{vc=kb[Mb];if(void 0===vc||null===vc){vc=null;break a}let ae=null;vc.e&&(ae=new zc.a(null),ae.name=vc.e.n,ae.stack=vc.e.s,ae.message=vc.e.m,ae.file=vc.e.f,ae.line=vc.e.l,ae.column=vc.e.c);vc=new pd.a(vc.ts,vc.c,vc.t,vc.l,vc.m,vc.lt,vc.o,vc.a,ae)}ya[Q]=vc}this.CAa.RYi(this,
ya,id.s,id.v,id.a+1,id.i);break}}else na.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Mb);else na.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Mb)}}else this.sFd()}}KPa(Q,ya,kb){!this.El&&na.ULS.O8(ya,kb)&&this.$Tc.Z(Q,!0)}dispose(){if(!this.El){this.eS&&this.Gb.Se(this.eS);var Q=Zb.toArray(this.LPa.keys);for(const ya of Q)this.Nyi(ya)}this.El=!0}hQa(){this.nVa=!0;this.sFd()}dkb(){this.nVa=!1;this.sFd();this.eS&&this.Gb.Se(this.eS);
this.eS=new Tb.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Gb.Xb(this.eS)}sFd(){this.eS&&(this.Gb.Se(this.eS),this.eS=null)}static serialize(Q){return JSON.stringify(Q)}static Glj(Q,ya){(Q=ud.E6c(Q,ya))&&void 0===Q.d&&(Q=new yc(Q.t,Q.m,Q.s,Q.v,Q.i,Q.a,0));return Q}static E6c(Q,ya){try{return JSON.parse(Q)}catch(kb){ya&&na.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",kb.message)}return null}}
ud.hij=864E5;Object(e.a)(ud,"OfflineLoggerImplV2",null,[2005,9,225]);class $d{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(ya){return this.handleError("Key",ya),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(ya){return this.handleError("GetItem",ya),null}}setItem(Q,ya){try{return localStorage.setItem(Q,ya)}catch(kb){return this.handleError("SetItem",
kb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(ya){this.handleError("RemoveItem",ya)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,ya){na.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,ya.message)}}Object(e.a)($d,"OfflineStorage",null,[2004]);class gc{create(Q){var ya=null;try{void 0!==localStorage&&null!==localStorage&&(ya=new $d)}catch(Mb){na.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",
Mb.message)}Object.getType(na.ULS.host).implementsInterface(1066)&&ya||(na.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",ya?"supported":"not supported",Object.getType(na.ULS.host).implementsInterface(1066)?"supported":"not supported"),Q=0);const kb=F.AFrameworkApplication.K;1===Q?ya=new Ob(F.AFrameworkApplication.uc,F.AFrameworkApplication.Ve,ya,na.ULS.host,F.AFrameworkApplication.userSessionId,F.AFrameworkApplication.HCh,kb.$("OfflineLoggerDataBoundarySupportIsEnabled")):
2===Q?(Q=F.AFrameworkApplication.ta.Pb,ya=new ud(F.AFrameworkApplication.uc,F.AFrameworkApplication.Ve,ya,na.ULS.host,F.AFrameworkApplication.userSessionId,Q.$n,Q.Qga,kb.pc("OfflineLoggerRetentionInDays",30),kb.pc("OfflineLoggerMaxAttempts",5),kb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),kb.$("SendOfflineLogsV2ImprovementIsEnabled"),F.AFrameworkApplication.HCh,kb.$("OfflineLoggerDataBoundarySupportIsEnabled"))):ya=new xc;ya.init();return ya}}Object(e.a)(gc,"OfflineLoggerFactory",null,
[]);class kc{xc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=F.AFrameworkApplication.K;let ya=0;Q.$("OneNoteOfflineLoggerIsEnabled")?ya=1:Q.$("OfflineLoggerV2IsEnabled")&&(ya=2);0!==ya&&(F.AFrameworkApplication.t$f=(new gc).create(ya))}dispose(){}}Object(e.a)(kc,"OfflineLoggerPackage",null,[1,2]);var Wc=c(55),td=c(1347);class Fe{constructor(Q){this.Rvi=null;na.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.AUc=F.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");
(this.W7=Q)||na.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.AUc&&this.AUc.length||na.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}Jgl(Q){Q&&(this.AUc="https://dcg-df.microsoft.com/",na.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.Igl()}Igl(){na.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.Rvi)na.ULS.sendTraceTag(527574722,
306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.Rvi=new Date;var Q=new Date;this.W7.uia("BayBridge",this.AUc).then(ya=>{const kb=+new Date-+Q;ya.IsSuccess?(na.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",kb),this.Agl(ya.Token,this.Wsl())):na.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
kb,ya.ErrorCode,ya.ErrorMessage)}).catch(ya=>{na.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",ya,+new Date-+Q)})}}Agl(Q,ya){const kb={};kb.Authorization="Bearer "+Q;kb["Authorization-Type"]="AAD";kb.Accept="application/json";kb["DCG-SessionId"]=F.AFrameworkApplication.userSessionId;F.AFrameworkApplication.Ve.qj(ya,1,null,kb,!1,2,Object(a.a)(this,this.LUl,"getStatusSucceeded"),Object(a.a)(this,this.JUl,"getStatusFailed"),null,void 0,
void 0,void 0,void 0,"39");Wc.a("FetchAccountLinkedStatus")}Wul(){const Q=td.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}Wsl(){return this.AUc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}JUl(){na.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}LUl(Q){na.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Q=Ha.a(Q.data.Ae).state+"";td.a.instance.setItem("AccountLinkedStatusCache",
Q)}}Object(e.a)(Fe,"PhoneLinkManager",null,[1916]);class Cf{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}xc(Q){this.W=Q;this.W.register(1916,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Xd(()=>new Fe(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){F.AFrameworkApplication.K.lp(()=>{this.a1a()})}a1a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){ca.a.instance.Kc(new Cf)}}Object(e.a)(Cf,"PhoneLinkPackage",null,[1,2]);const ie=
Q=>{try{return Ha.a(Q)}catch(ya){}return null};class Ae{constructor(Q,ya,kb,Mb,vc,id){this.KY=!1;this.Vl=null;this.dHe=!1;this.ga=Q;this.rg=ya;this.Lk=kb;this.vUg=Mb;this.Ma=vc;this.wTj=id}init(Q,ya){ya&&Q.Za("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.UWe,"awaitRtc"))}UWe(Q){const ya=Q.lLc();ya.continueWith(()=>{this.Vl=ya.result;this.dHe&&(this.Vl.vO(2,null,!0),this.dHe=!1);this.Vl.f6((kb,Mb)=>{2===Mb.type&&this.Bc.processAction(Ua.a.fileNameUpdate,2)});this.Vl.Esa((kb,Mb)=>
{2===Mb.newState&&this.Bc.processAction(Ua.a.fileNameUpdate,2)});2===this.Vl.connectionState&&this.Bc.processAction(Ua.a.fileNameUpdate,2)})}$Ma(Q){this.wLh(Q,!0)}wLh(Q,ya){const kb=this.Mvk(Q.Dcj),Mb={};Mb[Ae.Wwh]=Ae.Xwh;this.FYi.qj(kb,2,"",Mb,!1,2,Object(a.a)(this,this.Ybc,"onRefreshFilenameSuccess"),ya?Object(a.a)(this,this.S7m,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.qGi,"onRefreshFilenameFailureNoRetry"),Q)}Ybc(Q){this.KY=!1;const ya=ie(Q.data.Ae);Q.data.state.onSuccess(ya,this.vUg.value)}S7m(Q){5!==
Q.data.status||this.KY?this.qGi(Q):(this.KY=!0,this.wLh(Q.data.state,!1))}qGi(Q){Q.data.state.onFailure(-1)}fBb(Q){this.xLh(Q,!0)}xLh(Q,ya){const kb=this.Nvk(),Mb={};Mb[Ae.Wwh]=Ae.Xwh;Mb[Ae.q5l]=qb.a.Pj(Q.MYi);Mb[Ae.o5l]=this.wTj.value.cIk;this.FYi.qj(kb,2,"",Mb,!1,2,Object(a.a)(this,this.cXc,"onRenameFileSuccess"),ya?Object(a.a)(this,this.X7m,"onRenameFileFailureRetry"):Object(a.a)(this,this.sGi,"onRenameFileFailureNoRetry"),Q)}Nvk(){return this.tnh()}Mvk(Q){let ya=this.tnh();return ya=bb.a.zp(ya,
Ae.u5l,Q?"2":"1")}tnh(){let Q=(this.Ma.value.appSettings.RenameWebServiceBase||"")+Ae.p5l;Q=bb.a.zp(Q,Ae.r5l,qb.a.Pj(F.AFrameworkApplication.Gm));this.wo&&this.wo.svf&&(Q=bb.a.zp(Q,Ae.t5l,"1"));return Q}cXc(Q){this.KY=!1;const ya=ie(Q.data.Ae);Q.data.state.onSuccess(ya,this.vUg.value);this.kBi()}kBi(){this.Vl?this.Vl.vO(2,null,!0):this.dHe=!0}X7m(Q){5!==Q.data.status||this.KY?this.sGi(Q):(this.KY=!0,this.xLh(Q.data.state,!1))}sGi(Q){Q.data.state.onFailure(-1)}get Bc(){return this.ga.value}get FYi(){return this.rg.value}get wo(){return this.Lk.value}static get instance(){return Ae._instance||
(Ae._instance=Ae.SBb())}static SBb(){return new Ae(new fb.a(()=>F.AFrameworkApplication.ya),new fb.a(()=>F.AFrameworkApplication.Ve),new fb.a(()=>F.AFrameworkApplication.wo),new fb.a(()=>za.a.instance.resolve("Postmessage.IHostPostmessenger")),new fb.a(()=>F.AFrameworkApplication.K),new fb.a(()=>za.a.instance.resolve("Common.IRenameProps")))}}Ae.Wwh="Content-Type";Ae.Xwh="application/json; charset=utf-8";Ae.p5l="renamehandler.ashx";Ae.r5l="qs";Ae.q5l="n";Ae.t5l="sl";Ae.o5l="X-CoauthLockId";Ae.u5l=
"u";Ae._instance=null;Object(e.a)(Ae,"ExecuteRenameFileHandler",null,[]);class xe{constructor(){this.onFailure=this.onSuccess=null;this.Dcj=!1}}Object(e.a)(xe,"ExecuteRefreshFilenameData",null,[]);class ng{constructor(){this.onFailure=this.onSuccess=this.MYi=null}}Object(e.a)(ng,"ExecuteRenameFileData",null,[]);class Af{constructor(){this.W=null;this.Hte=Ae.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}xc(Q){this.W=Q}init(){F.AFrameworkApplication.K.lp(Object(a.a)(this,this.rx,
"onFullAppSettingsReady"))}rx(){F.AFrameworkApplication.SRc()&&(Ae.instance.init(this.W,F.AFrameworkApplication.t0c),F.AFrameworkApplication.fBb=Object(a.a)(this,this.fBb,"executeRenameFile"),F.AFrameworkApplication.$Ma=Object(a.a)(this,this.$Ma,"executeRefreshFilename"),F.AFrameworkApplication.a2c=Object(a.a)(this,this.a2c,"sendFileNameAndLocationUpdateNotification"))}fBb(Q,ya,kb){const Mb=new ng;Mb.MYi=Q;Mb.onSuccess=ya;Mb.onFailure=kb;this.Hte.fBb(Mb)}$Ma(Q,ya,kb){const Mb=new xe;Mb.onSuccess=
Q;Mb.onFailure=ya;Mb.Dcj=kb;this.Hte.$Ma(Mb)}a2c(){this.Hte.kBi()}dispose(){}}Object(e.a)(Af,"PackageManager",null,[1,2]);var De=c(144);class Rf{constructor(Q,ya,kb){this.R5f=this.S5f=this.T5f=!1;this.h6f=!Q&&!ya;this.i6f=!Q&&!kb;this.h6f||this.i6f||(this.T5f=!Q,this.S5f=!ya,this.R5f=!kb)}}Object(e.a)(Rf,"RenameDisabledDialogInfo",null,[]);class Je extends De.StandardDialog{constructor(Q,ya,kb,Mb,vc){super();this.c$f=[];this.uda=new Rf(Q,ya,kb);this.Qbb=Mb;this.q$a=vc;this.mg="RenameDisabledDialog";
this.Ed=0;this.Ue(1,CommonUIStrings.l_DialogClose);this.o2n();this.gHn()}o2n(){this.uda.h6f?this.Z3c(this.Qbb?this.q$a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.uda.i6f?this.Z3c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Mak();this.mAc(this.c$f)}Z3c(Q){Array.add(this.c$f,Q)}Mak(){const Q=[];this.uda.T5f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.uda.S5f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.uda.R5f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.c$f,Q)}}Object(e.a)(Je,"ReactRenameDisabledDialogBase",De.StandardDialog,[]);class le extends Je{constructor(Q,ya,kb,Mb,vc){super(Q,ya,kb,Mb,vc)}gHn(){this.Sjb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(e.a)(le,"ReactRenameDisabledDialog",Je,[]);var dh=c(156);class lj{static get Hg(){return dh.a.Sy(lj.am,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}lj.am="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(lj,"RenameDisabledDialogHtml",null,[]);class sh extends dh.a{constructor(Q,ya,kb,Mb,vc){super();this.uda=new Rf(Q,ya,kb);this.Qbb=Mb;this.q$a=vc;this.mg="RenameDisabledDialog";this.Ed=0;this.Ue(1,CommonUIStrings.l_DialogClose);this.Hg=lj.Hg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.k4("RenameRow")}QX(){if(this.uda.h6f){let Q;Q=this.Qbb?this.q$a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;sh.Z3c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.uda.i6f?sh.Z3c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.w8l()}w8l(){this.uda.T5f&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.uda.S5f&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.uda.R5f&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Z3c(Q,ya,kb){Q.style.display="none";ya.innerText=kb}}Object(e.a)(sh,"RenameDisabledDialog",dh.a,[]);var We=c(63);class Fh{constructor(Q,ya){this.Ntb=0;this.ga=Q;this.KIa=ya}initialize(Q){if(!this.ga||!this.KIa)return!1;this.Ntb=Q;this.Wb();return!0}Wb(){this.ga.pa(Ua.a.H1e,We.a.frame,Object(a.a)(this,this.H1e,"commitNewDocumentTitle"))}H1e(Q,ya,kb,Mb,vc){if(1===kb)return this.ga.processAction(Ua.a.renameFile,
1);Q=qb.a.zI(this.KIa.Nz);vc=(0,vc.getNewDocumentTitle)();vc.length>this.Ntb&&(vc=vc.substr(0,this.Ntb));if(32!==this.ga.Ub(Ua.a.renameFile,2,vc))return this.Rjc(Q),8;this.Rjc(vc);return 32}Rjc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Jl(){return new Fh(F.AFrameworkApplication.ya,F.AFrameworkApplication.su)}}Object(e.a)(Fh,"ReactRenameUIHandler",null,[2006]);var cc=c(223),tc=c(1033),bd=c(470),vd=c(86),Tc=c(146),nb=c(23);class Fb{constructor(Q,ya,kb,Mb,vc,id,ae,we,
Ee,jf,Ng,Fg){this._initialized=!1;this._element=null;this.Ntb=0;this.PKe=this.fxe=!1;this.ga=Q;this.Tia=ya;this.ie=kb;this.Rr=Mb;this.KIa=vc;this.b4g=id;this.rpd=ae;this.Xoe=we;this.P9a=Ee;this.zRg=jf;this.Bi=Ng;this.Jye=Fg}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,ya,kb){if(!(this.ga&&this.KIa&&this.b4g&&this.rpd&&this.Xoe&&ya)||0>=Q)return!1;this._element=ya;this._element.title=kb;this._element.setAttribute(nb.a.wh,nb.a.l2);this._element.setAttribute("Unselectable",
"on");this.Ntb=Q;this.fB();return this._initialized=!0}fB(){this.Tia&&(this.Tia.mb(A.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Tia.mb(A.a.paste,this._element,Object(a.a)(this,this.VWc,"onPaste")));this.ie.mb(A.a.hi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Rr.mb(A.a.pointerDown,this._element,Object(a.a)(this,this.fC,"onPointerDown"));this.Rr.mb(A.a.nM,this._element,Object(a.a)(this,this.twa,"onPointerUp"))}onBlur(){this.isActive&&!this.fxe&&(this.zRg||
this.Xoe(this._element),this.evh(),this.P6e(!1));return this.fxe=!1}VWc(){na.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.v5m(Q):this.w5m(Q)}v5m(Q){let ya=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:this.evh();this.P6e(this.Bi||this.Jye);ya=!0;break;case Sys.UI.Key.tab:this.zRg&&this.Xoe(this._element);break;case Sys.UI.Key.esc:this.DZf(),this.P6e(this.Bi||this.Jye),ya=!0}return ya}w5m(Q){let ya=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Kkj(this.Jye),
this.isActive&&this.rpd(this._element),ya=!0}return ya}fC(){this.isActive||(this.Kkj(!1),this.isActive&&(this._element.focus(),this.rpd(this._element),this.PKe=!0));return!1}twa(){return this.PKe?(this.rpd(this._element),this.PKe=!1,!0):!1}v9b(){return 32===this.ga.processAction(Ua.a.renameFile,1)}evh(){const Q=qb.a.zI(this.KIa.Nz);let ya=this._element.innerText.trim();ya.length>this.Ntb&&(ya=ya.substr(0,this.Ntb));ya!==Q&&""!==ya?32!==this.ga.Ub(Ua.a.renameFile,2,ya)?this.DZf():this.Rjc(ya):this.DZf()}DZf(){this.Rjc(qb.a.zI(this.KIa.Nz))}Rjc(Q){this._initialized&&
(this._element.innerText=Q,this.b4g())}Kkj(Q){this.v9b()?this.isActive||(Q&&(this.fxe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(nb.a.wh,nb.a.Tjh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,cc.CuiHelper.hIh),this.P9a&&this.P9a.execute(ya=>{ya.OQi(!0)}),Q&&this._element.focus(),na.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(Ua.a.lhc,
2)}P6e(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(nb.a.wh,nb.a.l2);Sys.UI.DomElement.removeCssClass(this._element,cc.CuiHelper.hIh);this.P9a&&this.P9a.execute(ya=>{ya.OQi(!1)});Q&&(this._element.blur(),this._element.focus())}static kxa(){tc.a.kxa(F.AFrameworkApplication.isRtl)}static Jl(){return new Fb(F.AFrameworkApplication.ya,bd.a.instance,vd.KeyInputManager.instance,Tc.a.instance,F.AFrameworkApplication.su,Fb.kxa,
da.a.BRn,da.a.Tsh,za.a.instance.Za("Common.App.Header.HeaderEventSource"),Fa.a.v3,Fa.a.zi,Fa.a.kj)}}Object(e.a)(Fb,"RenameUIHandler",null,[2006]);class Kc{static get instance(){return F.AFrameworkApplication.ta.Pb.ZI?Kc._instance||(Kc._instance=Fh.Jl()):Kc._instance||(Kc._instance=Fb.Jl())}}Kc._instance=null;Object(e.a)(Kc,"RenameUIHandlerFactory",null,[]);var sc=c(114);class Oc{constructor(){this.nIf=this.wXm=this.gZk=null}}Object(e.a)(Oc,"RenameMruEntryProperties",null,[]);var Ke=c(161),Re=c(88),
lf=c(1513),Jh;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(Jh||(Jh={}));Object(e.b)("CommonOperationResult",Jh);class zg{constructor(Q,ya,kb,Mb,vc,id,
ae,we,Ee,jf,Ng,Fg){this.TRg=Q;this.ga=ya;this.Lk=kb;this.fL=Mb;this.utb=vc;this.K6j=id;this.Qbb=ae;this.Y9g=we;this.x_j=Ee;this.q$a=jf;this.Ma=Ng;this.w_j=Fg}Wb(){F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.ZI||this.Bc.pa(Ua.a.w7b,We.a.frame,Object(a.a)(this,this.w7b,"initializeRenameUIHandler"));this.Bc.pa(Ua.a.lhc,We.a.frame,Object(a.a)(this,this.lhc,"showRenameDisabledDialog"));this.Bc.pa(Ua.a.renameFile,We.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.Bc.gb(Ua.a.fileNameUpdate,
We.a.frame,Object(a.a)(this,this.zxn,"refreshFilename"),64);this.Bc.gb(Ua.a.RZd,We.a.frame,Object(a.a)(this,this.RZd,"moveToFolderCompleteByHost"),64);this.Bc.pa(Ua.a.SHb,We.a.frame,Object(a.a)(this,this.SHb,"moveToFolder"));(F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||F.AFrameworkApplication.ta&&(F.AFrameworkApplication.K.$("PostMessageEmbedded")||F.AFrameworkApplication.K.$("IsJsApi"))&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&F.AFrameworkApplication.fO().execute(Q=>{Q.Jv(Re.a.gzi);Q.oC(Re.a.gzi,zg.Ttn);Q.Jv(Re.a.tcf);Q.oC(Re.a.tcf,zg.Rtn)})}v9b(){return 0===this.w_j.d3h()?32:8}kDo(){return this.wo?this.Qbb?this.wo.mHh:this.wo.Ofb:!0}w7b(){return Kc.instance.initialize(F.AFrameworkApplication.GGd,F.AFrameworkApplication.eHh,F.AFrameworkApplication.TWi||CommonUIStrings.l_RenameFileTooltip)?32:8}lhc(){const Q=this.kDo(),ya=this.K6j();na.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.utb,ya,Q,this.Qbb);F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.ZA&&F.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new le(this.utb,!ya,!Q,this.Qbb,this.q$a()):new sh(this.utb,!ya,!Q,this.Qbb,this.q$a());return 32}renameFile(Q,ya,kb,Mb,vc){if(1===kb)return this.v9b();if(!F.AFrameworkApplication.fBb)return 8;if(8===this.v9b())return this.Bc.processAction(Ua.a.lhc,2),8;na.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");F.AFrameworkApplication.fBb(vc,Object(a.a)(this,
this.cXc,"onRenameFileSuccess"),Object(a.a)(this,this.W7m,"onRenameFileFailure"));return 32}cXc(Q,ya){Q?0!==Q.OperationResult?this.c9h(Q.OperationResult):(this.lTn(ya,Q.NewName),this.lvo(Q,Object(a.a)(F.AFrameworkApplication.ta.Pb,F.AFrameworkApplication.ta.Pb.qpj,"updateOpenInClientDocumentUrl")),F.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&F.AFrameworkApplication.ta.updateCommandUI(),this.x_j.gnj()):this.c9h(5)}lTn(Q,ya){const kb={};kb[Ke.a.fhl]=ya;Q.sendMessage(Re.a.tcf,
kb)}lvo(Q,ya){this.xvo(Q);F.AFrameworkApplication.GDd=Q.DirectInvokeDavUrl;ya=ya(Q.EditDocInClientUrl);const kb=new Oc;kb.nIf=this.fL.Nz;kb.gZk=ya;kb.wXm=Q.EditDocInClientUrl;this.Bc.Ub(Ua.a.UWi,2,kb)}c9h(Q){switch(Q){case 1:Q=new De.StandardDialog,Q.Ed=0,Q.GU(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.CZi()}}xvo(Q){this.fL.Nz=zg.Akk(this.fL.Nz,Q.NewName);Q.BreadcrumbFolderName&&(this.fL.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&
(this.fL.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.Y9g(Q.NewName)}W7m(Q){const ya=new De.StandardDialog;ya.Ed=0;switch(Q){case 1:na.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ya.Yha(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:na.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ya.Yha(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;
default:na.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),ya.Yha(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}F.AFrameworkApplication.fO().execute(kb=>{kb.sendMessage(Re.a.ehl,{["FailureMessage"]:Jh[Q]})});this.CZi()}zxn(Q,ya,kb){if(1===kb)return this.v9b();if(!F.AFrameworkApplication.$Ma)return 8;F.AFrameworkApplication.$Ma(Object(a.a)(this,this.Ybc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.K1d,"onRefreshFilenameFailure"),
!1);return 32}SHb(Q,ya,kb,Mb,vc){if(1===kb)return F.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===kb){const id={};Q=F.AFrameworkApplication.kGb;ya=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&ya)&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);id[Ke.a.yho]=Q;vc&&vc.MoveButtonClickedTime&&(id[Ke.a.LVm]=vc.MoveButtonClickedTime.getTime());F.AFrameworkApplication.fO().execute(ae=>{ae.sendMessage(Re.a.SHb,
id)});if(vc&&vc.MoveButtonClickedTime){if(Q=sc.a.AF())vc=(new Date).getTime()-vc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",vc.toString());Ca.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}RZd(Q,ya,kb,Mb,vc){if(1===kb)return F.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.v9b():8;if(2===kb){if(!F.AFrameworkApplication.a2c)return Ca.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!vc)return Ca.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(vc[Ke.a.ymm])if(vc[Ke.a.Yqj])if(Q=vc[Ke.a.Yqj].toLowerCase(),ya=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),kb=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ya&&F.AFrameworkApplication.kGb&&kb){const id={};id[Ke.a.dec]="1";id[Ke.a.documentUrl]=Q;id[Ke.a.reason]=lf.a.O_f;Ca.Health.instance.recordKpiSuccess("MoveToFolder",null);
F.AFrameworkApplication.fO().execute(ae=>{ae.sendMessage(Re.a.CAb,id)})}else if(!F.AFrameworkApplication.kGb&&kb)Ca.Health.instance.recordKpiSuccess("MoveToFolder",null),da.a.en(Q,da.a.aqa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ca.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ca.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else F.AFrameworkApplication.$Ma(Object(a.a)(this,this.Ybc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.K1d,"onRefreshFilenameFailure"),!1),F.AFrameworkApplication.a2c(),Ca.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}C8n(Q,ya){return Q&&ya?Q!==this.fL.breadcrumbFolderName||ya!==this.fL.breadcrumbFolderUrl:!1}Ybc(Q,ya){Q&&(Q.NewName!==qb.a.zI(this.fL.Nz)||this.C8n(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.cXc(Q,ya)}K1d(){}CZi(){this.Y9g(qb.a.zI(this.fL.Nz))}get Bc(){return this.ga.value}get wo(){return this.Lk.value}static get instance(){return zg._instance||
(zg._instance=zg.SBb())}static SBb(){return new zg(F.AFrameworkApplication.SRc,new fb.a(()=>F.AFrameworkApplication.ya),new fb.a(()=>F.AFrameworkApplication.wo),F.AFrameworkApplication.su,F.AFrameworkApplication.Qna,()=>F.AFrameworkApplication.Vdg,F.AFrameworkApplication.t0c,Object(a.a)(Kc.instance,Kc.instance.Rjc,"updateTitle"),za.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>F.AFrameworkApplication.Yu,F.AFrameworkApplication.K,za.a.instance.resolve("Common.IRenameProps"))}static Akk(Q,
ya){Q=qb.a.NNa(Q);return ya+Q}static Ttn(Q){const ya=Q.Values[Ke.a.$rm];na.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ya);ya?F.AFrameworkApplication.ya.Ub(Ua.a.RZd,2,Q.Values):Ca.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static Rtn(Q){F.AFrameworkApplication.ya.Ub(Ua.a.renameFile,2,Q.Values.NewName)}}zg._instance=null;Object(e.a)(zg,"RenameActor",null,[]);var Kd=c(133),Td=c(1353),Gd=c(575),rf=c(393);class hf{constructor(Q,
ya){this.ga=Q;this.Coc=ya}Wb(){this.ga.pa(Ua.a.c6f,We.a.frame,Object(a.a)(this,this.rao,"showRenameDialogAction"))}rao(Q,ya,kb){Q=32;if(1===kb)return rf.SessionStatusManager.instance.zj||F.AFrameworkApplication.tna?8:32;2===kb&&(32!==this.ga.processAction(Ua.a.renameFile,1)?(this.ga.processAction(Ua.a.lhc,2),Kd.a.instance.fc(Td.a.ama,{["Reason"]:Gd.a.sGn}),Q=8):32===this.ga.processAction(Ua.a.mhc,1)?this.ga.processAction(Ua.a.mhc,2):this.Coc.value.create().gSa());return Q}}Object(e.a)(hf,"RenameDialogActor",
null,[1991]);class Ui{constructor(Q,ya,kb){this.dialog=null;this.ga=Q;this.fL=ya;this.x9a=kb}fRl(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:Ui.A2b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:qb.a.zI(this.fL.Nz),["maxLength"]:this.x9a};return Q}gSa(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.fRl()};this.dialog=new dh.a(!1,!1,!0);this.dialog.Ed=1;this.dialog.mg="RenameDialog";this.dialog.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.YXf,"renameDialogHandler"),
Q)}YXf(Q,ya){if(ya&&1===Q){if(ya[Ui.A2b]&&(Q=qb.a.zI(this.fL.Nz),ya=(ya[Ui.A2b]||"").trim(),ya!==Q&&""!==ya)){this.ga.Ub(Ua.a.renameFile,2,ya);return}Kd.a.instance.fc(Td.a.w2b,{["Reason"]:Gd.a.ZMh})}}}Ui.A2b="txtDocumentName";Object(e.a)(Ui,"ReactRenameDialog",null,[2007]);class Ik{static get Hg(){return dh.a.Sy(Ik.am,CommonUIStrings.l_RenameDialogLabel)}}Ik.am="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(Ik,"RenameDialogHtml",null,[]);class th extends dh.a{constructor(Q,ya,kb){super();this.ga=Q;this.fL=ya;this.x9a=kb;this.mg="RenameDialog";this.Hg=Ik.Hg}gSa(){var Q={["txtDocumentName"]:qb.a.zI(this.fL.Nz)};this.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.YXf,"renameDialogHandler"),Q);Q=document.getElementById(th.A2b);0<this.x9a&&(Q.maxLength=this.x9a);Q.focus()}YXf(Q,ya){if(1===Q&&(Q=qb.a.zI(this.fL.Nz),ya=(ya[th.A2b]||"").trim(),ya!==Q&&""!==ya)){this.ga.Ub(Ua.a.renameFile,
2,ya);return}Kd.a.instance.fc(Td.a.w2b,{["Reason"]:Gd.a.ZMh})}}th.A2b="txtDocumentName";Object(e.a)(th,"RenameDialog",dh.a,[2007]);class Mi{constructor(Q){this.KIa=null;this.x9a=0;this.ga=Q;this._initialized=!1}initialize(Q,ya){this.KIa=Q;this.x9a=ya;this._initialized=!0}create(){return this._initialized?F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.ZA&&F.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Ui(this.ga,this.KIa,this.x9a):new th(this.ga,this.KIa,this.x9a):null}}Object(e.a)(Mi,
"RenameDialogFactory",null,[1990]);var of=c(157),ci=c(141),Fl=c(84);class xg{constructor(Q,ya){this.ga=Q;this.Vb=ya}Wb(){this.ga.pa(Ua.a.mhc,We.a.frame,Object(a.a)(this,this.sao,"showRenameFlyoutAction"))}xAk(){return ci.d("setDocumentTitleFlyoutOpened")&&F.AFrameworkApplication.ta.Pb.ZI}sao(Q,ya,kb){if(1===kb)return this.xAk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Dck(){xg.iwm&&F.AFrameworkApplication.XT&&Fl.a.instance.Xb(new Tb.a(5,1,5E3,()=>{32===
this.ga.processAction(Ua.a.mhc,1)&&this.Vb&&this.Vb.currentScope.name===of.AFrame.So&&(Wc.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(Ua.a.mhc,2))}))}static get iwm(){xg.Xhd&&null!=xg.Xhd||(F.AFrameworkApplication.Ce("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),xg.Xhd=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return xg.Xhd}}xg.Xhd=null;
Object(e.a)(xg,"RenameFlyoutActor",null,[1988]);class Uf{constructor(Q,ya,kb,Mb,vc){this.cIk=null;this.Lk=vc;this.URg=kb;this.TRg=Mb;this.M6j=Q;this.q$a=ya}get wo(){return this.Lk.value}d3h(){if(!this.TRg())return 5;if(this.q$a())return 1;if(this.wo){if(this.URg&&!this.wo.mHh)return 3;if(!this.URg&&!this.wo.Ofb)return 4}return this.M6j()?0:2}}Object(e.a)(Uf,"RenameProps",null,[1977]);class tg{constructor(Q,ya,kb,Mb,vc,id){this.Yq=!1;this.GBe=new fc.a;this.hSb=ya;this.yz=kb;this.bRb=Mb;this.Ma=vc;
this.lka=id}enable(){this.Yq||(this.gnj(),this.F7f(),this.Yq=!0)}generateKey(Q,ya,kb){return String.format("{0}/{1}/{2}",kb,Q,ya)}nHl(){const Q=qb.a.zI(this.hSb().Nz);return this.generateKey(this.hSb().breadcrumbFolderName,this.hSb().breadcrumbFolderUrl,Q)}oHl(Q,ya,kb){return Q&&ya?this.generateKey(Q,ya,kb):kb}N4k(Q,ya,kb){return Q&&Q!==this.hSb().breadcrumbFolderName||ya&&ya!==this.hSb().breadcrumbFolderUrl?!0:kb!==qb.a.zI(this.hSb().Nz)}gnj(){const Q=this.nHl();this.GBe.Z(Q,new Date)}pQf(Q){this.O6n(Q)&&
this.mbh(Q)}O6n(Q){const ya=this.bRb();return ya?this.lka&&this.lka.zo||!ya.svf||!F.AFrameworkApplication.$Ma?(this.Xej(Q),this.Yq=!1):!0:!1}oHi(Q,ya,kb,Mb){const vc=this.N4k(Q,ya,kb);Q=this.oHl(Q,ya,kb);ya=this.GBe.Gc(Q).returnValue;vc&&!ya&&(this.e9h(Mb),na.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.GCf));vc||this.GBe.Z(Q,this.yz())}}Object(e.a)(tg,"ARenamedFileChecker",null,[1940]);class sg extends tg{constructor(Q,ya,kb,Mb,vc,id,ae,we){super(Q,ya,kb,Mb,vc,id);this.XJ=vc;
this.v_j=ae;this.Iwe=we}get GCf(){return"RenamedFileCheckerUsingSettingsRefresh"}F7f(){this.XJ.HAc(Object(a.a)(this,this.x9h,"handleSettingsRefresh"))}x9h(Q,ya){ya&&ya.bIb&&ya.eCi&&(ya.nPa("BreadcrumbDocName")||ya.nPa("BreadcrumbFolderName")||ya.nPa("BreadcrumbFolderUrl")||ya.nPa("DirectInvokeDAVUrl")||ya.nPa("EditDocInClientUrl"))&&(na.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.GCf),this.pQf(ya))}Xej(){this.XJ.GWi(Object(a.a)(this,this.x9h,"handleSettingsRefresh"))}mbh(Q){if(Q&&
Q.bIb){const ya=Q.bIb;this.oHi(ya.lb("BreadcrumbFolderName"),ya.lb("BreadcrumbFolderUrl"),ya.lb("BreadcrumbDocName"),Q)}}e9h(Q){const ya={OperationResult:0,classId:1};Q=Q.bIb;ya.BreadcrumbFolderName=Q.lb("BreadcrumbFolderName");ya.BreadcrumbFolderUrl=Q.lb("BreadcrumbFolderUrl");ya.DirectInvokeDavUrl=Q.lb("DirectInvokeDAVUrl");ya.EditDocInClientUrl=Q.lb("EditDocInClientUrl");Q=Q.lb("BreadcrumbDocName");ya.NewName=F.AFrameworkApplication.YGc?Q:qb.a.zI(Q);this.Iwe.execute(kb=>{this.ajm(ya,kb)})}ajm(Q,
ya){this.v_j().cXc(Q,ya)}}Object(e.a)(sg,"RenamedFileCheckerUsingSettingsRefresh",tg,[]);class jh extends tg{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf){super(Q,kb,Mb,vc,id,Ee);this.Hwc=this.Rm=null;this.PYj=ya;this.ga=ae;this.Gb=we;jf&&jf.execute(Ng=>{this.KBn(Ng)})}get GCf(){return"RenamedFileCheckerUsingTask"}KBn(Q){this.Rm=Q;this.Rm.QXa(Object(a.a)(this,this.RZ,"handleVisibilityChange"))}RZ(Q,ya){!this.Yq||0!==ya.newState&&1!==ya.newState||this.Hwc||(this.F7f(),this.pQf(this.Hwc))}F7f(){this.Hwc=
new Tb.a(3,2,this.PYj(),Object(a.a)(this,this.pQf,"performRenameFileCheckTick"),89);this.Gb.Xb(this.Hwc)}Xej(Q){this.Gb.Se(Q)}mbh(Q){this.Rm&&2===this.Rm.nF?this.zDn(Q):F.AFrameworkApplication.$Ma(Object(a.a)(this,this.Ybc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.K1d,"onRefreshFilenameFailure"),!0)}zDn(Q){this.Gb.Se(Q);this.Hwc=null}Ybc(Q){Q&&this.oHi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}e9h(){this.ga.processAction(Ua.a.fileNameUpdate,2)}K1d(){}}Object(e.a)(jh,"RenamedFileCheckerUsingTask",
tg,[]);var eh=c(57);class li{constructor(){this.Ma=this.W=null}get name(){return"Common.App.RenameFile"}xc(Q){this.W=Q;this.Ma=F.AFrameworkApplication.K;this.W.register(hf,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Xd(()=>new hf(F.AFrameworkApplication.ya,this.W.af("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(Mi,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Xd(()=>new Mi(F.AFrameworkApplication.ya)).singleInstance();
this.W.register(1940,"Common.App.Rename.IRenamedFileChecker").Xd(()=>this.tWk()).singleInstance();this.W.register(xg,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Xd(()=>new xg(F.AFrameworkApplication.ya,eh.FocusManager.instance())).singleInstance()}tWk(){if(this.Ma.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Pa("Common.IRefreshableAppSettings");if(Q&&Q.Umi)return new sg(()=>Q.pc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>F.AFrameworkApplication.su,
()=>new Date,()=>F.AFrameworkApplication.wo,Q,this.W.Pa("Common.ISessionStatus"),()=>zg.instance,this.W.Za("Postmessage.IHostPostmessenger"))}return new jh(()=>this.Ma.pc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ma.pc("RenamedFileCheckerPingIntervalInMs",12E4),()=>F.AFrameworkApplication.su,()=>new Date,()=>F.AFrameworkApplication.wo,F.AFrameworkApplication.K,F.AFrameworkApplication.ya,F.AFrameworkApplication.uc,this.W.Pa("Common.ISessionStatus"),this.W.Za("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ma.lp(Object(a.a)(this,
this.rx,"onFullAppSettingsReady"))}rx(){const Q=F.AFrameworkApplication.ta.Pb.ZI;F.AFrameworkApplication.SRc()&&Kc.instance.initialize(F.AFrameworkApplication.GGd,Q?null:F.AFrameworkApplication.eHh,Q?null:F.AFrameworkApplication.TWi||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Uf,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Xd(()=>new Uf(()=>F.AFrameworkApplication.Vdg,()=>F.AFrameworkApplication.Yu,F.AFrameworkApplication.t0c,F.AFrameworkApplication.SRc,new fb.a(()=>F.AFrameworkApplication.wo))).singleInstance(),
zg.instance.Wb(),this.Ma.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(F.AFrameworkApplication.su,F.AFrameworkApplication.GGd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Wb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Wb(),F.AFrameworkApplication.t0c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Dck())}dispose(){}}Object(e.a)(li,"PackageManager",null,
[1,2]);class Oj{static get Hg(){return dh.a.Sy(Oj.am,CommonUIStrings.l_SaveACopyFileName)}}Oj.am="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(Oj,"FileNameDialogHtml",null,[]);class yk extends dh.a{constructor(Q,
ya,kb,Mb){super();this.ted=this.gJa=null;this.ga=Q;this.jqa=ya;this.uzc=kb;this.Ue(1,CommonUIStrings.l_SaveButtonLabel);this.Hg=Oj.Hg;this.mg="FileNameDialog-SaveACopy";this.Pm=Mb}xCa(Q,ya,kb){this.ted=Q;this.gJa=kb;Q={["txtFileName"]:qb.a.zI(F.AFrameworkApplication.su.Nz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,ya)};this.Wh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.EGd,"fileNameDialogHandler"),Q);na.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}EGd(Q,ya){1!==Q?na.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=ya.txtFileName.trim(),na.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ya=qb.a.NNa(F.AFrameworkApplication.fileName),Q&&""!==Q&&""!==ya&&(Q+=ya),this.uzc.IGa(this.ted,this.gJa,Q,this.Pm))}}Object(e.a)(yk,"FileNameDialog",dh.a,[1978]);class dj{constructor(Q,ya,kb){this.ga=Q;this.jqa=ya;this.uzc=kb}create(Q){return new yk(this.ga,
this.jqa,this.uzc,Q)}}Object(e.a)(dj,"FileNameDialogFactory",null,[1943]);class bl extends De.StandardDialog{constructor(Q){super();this.Ed=1;this.Ue(1,CommonUIStrings.l_RetryButtonLabel);this.Ue(0,CommonUIStrings.l_DialogClose);this.ga=Q}$S(Q){na.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.py(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.RZf,"retryDialogHandler"))}RZf(Q){1===Q?(na.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),
this.ga.processAction(Ua.a.tfc,2)):na.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(bl,"RetryDialog",De.StandardDialog,[1942]);var mh=c(227);class Qk{constructor(Q,ya,kb,Mb){this.yod=null;this.L0j=Q;this.Ma=kb;this.AZg=ya;this.NUg=new r.a;this.je=Mb}W9b(){return this.Ma.$("SaveToCloudStorageUIIsEnabled")}Lfb(){return Ua.a.X_f}Dxd(){Ib.a.D_c(Object(a.a)(this,this.d1i,"saveToCloudActionDispatcher"));Ib.a.MHc([new mh.a(Ua.a.X_f,We.a.frame,0)],this.AZg.r5b())}Wb(){const Q=
this.AZg.r5b();Q?(Q.lW(()=>{this.NUg.Cg(!0)}),this.Dxd()):na.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}bSi(){na.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}d1i(Q,ya,kb,Mb,vc){return ya.contextId!==We.a.frame||Q!==this.Lfb()?2:this.W9b()?1===kb?rf.SessionStatusManager.instance.zj||F.AFrameworkApplication.tna?8:32:2===kb?(this.bSi(),vc&&vc.FileDownloadUrl&&na.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.je&&(this.yod=this.je.jg("DialogShown","SaveToOneDriveReponseTime")),this.NUg.task.continueWith(()=>{this.yod&&(this.yod.stop(),this.yod=null);this.L0j.start(vc)}),32):8:8}}Object(e.a)(Qk,"SaveToCloudStorageActor",null,[1948]);class Zf extends Qk{constructor(Q,ya,kb,Mb){super(Q,ya,kb,Mb);this.pXj=ya}W9b(){return this.Ma.$("SaveACopyBrsIsEnabled")}Lfb(){return Ua.a.tfc}Dxd(){Ib.a.D_c(Object(a.a)(this,this.d1i,"saveToCloudActionDispatcher"));Ib.a.MHc([new mh.a(Ua.a.tfc,We.a.frame,0)],this.pXj.r5b())}bSi(){F.AFrameworkApplication.Ce("CreateCopy_cf;CreateCopy_tf");
na.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(Zf,"SaveACopyActor",Qk,[]);class Pl{}Pl.default=0;Object(e.a)(Pl,"SaveToCloudErrorCodes",null,[]);class rh{constructor(Q,ya,kb,Mb,vc,id){this.Pm=null;this.G2j=Q;this.Xra=ya;this.uzc=kb;this.Ma=Mb;this.z$c=vc;this.FG=id}start(Q){this.Pm=Q;if("SharePointOnlineConsumer"===this.Ma.lb("FileSource")){const ya=za.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ya){ya.start(null,
Q);return}}this.Xra.TPc?(na.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.vzk()):(na.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.Bao())}Bao(){this.G2j.create().xCa()}Kp(){this.FG().$S(Pl.default)}vzk(){try{na.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.z$c||2===this.z$c)Q={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId};
WL.init(Q);na.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(Q){na.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.Kp()}}onSuccess(Q){na.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&
Q.data.folders&&this.uzc.IGa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Pm)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){na.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}na.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else na.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Kp()}}Object(e.a)(rh,"SaveToCloudManager",
null,[1949]);class tf extends rh{constructor(Q,ya,kb,Mb,vc,id,ae){super(ya,kb,Mb,vc,id,ae);this.DLj=Q}onSuccess(Q){Q&&Q.data&&Q.data.folders?(na.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.DLj.create(this.Pm).xCa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(na.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Kp())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&na.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}Kp(){na.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Kp()}}Object(e.a)(tf,"SaveACopyManager",rh,[]);var Ql=c(185);class ji{constructor(Q,ya,kb,Mb,vc){this.gJa=this.Uk=this.Imc=null;this.KY=!1;this.Pm=this.tXa=null;this.eQe=Q;this.kWa=ya;this.FG=kb;this.Vi=Mb;this.je=vc}D5a(){this.Vi&&1===this.Vi.state||(this.Uk=this.kWa(),this.Uk.message=CommonUIStrings.l_CommentProgressTooltip,this.Uk.Ed=
5,this.Uk.Qt=!1,this.Uk.wM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Hla(){this.Uk&&(this.Uk.close(),this.Uk=null)}q4(){1!==F.AFrameworkApplication.ta.state&&this.FG().$S(Pl.default)}FKb(){na.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");da.a.en(this.gJa,da.a.aqa(3),void 0,"UploadToCloudManager.RedirectToFolder")}EKb(Q){let ya=!1,kb=!1;F.AFrameworkApplication.K&&(ya=F.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),kb=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
na.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,ya);if(ya&&kb){na.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Mb={};Mb[Ke.a.dec]="1";Mb[Ke.a.documentUrl]=Q;F.AFrameworkApplication.fO().execute(vc=>{vc.sendMessage(Re.a.CAb,Mb)})}else da.a.en(Q,da.a.aqa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}IGa(Q,ya,kb=null,Mb=null){na.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.je&&(this.tXa=this.je.jg("DialogShown","SaveToOneDriveUploadTime"));this.D5a();this.gJa=ya;this.Imc=this.eQe.create(Q,kb,Mb);this.Pm=Mb;this.hfa()}hfa(){na.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Imc.execute(Object(a.a)(this,this.J8m,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.I8m,"onSaveToCloudUploadFailed"))}J8m(Q){this.Hla();this.KY=!1;if(Q&&Q.data&&Q.data.Ae){var ya;if(({Uv:ya}=Ha.d(Q.data.Ae)).returnValue)if(Q=ya,Q.StatusCode!==Ql.a.tB&&Q.StatusCode!==
Ql.a.DFc)na.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.q4();else{na.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.EKb(Q.NewDocumentUrl):this.FKb()}catch(kb){na.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",kb.toString())}this.kYc()}else na.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ub.a.x6c(Q.data.Ae)}),
this.q4()}else na.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.q4()}I8m(Q){5!==Q.data.status&&12!==Q.data.status||this.KY?(na.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.Hla(),this.q4(),this.kYc()):(na.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.KY=!0,this.hfa())}kYc(){this.tXa&&(this.tXa.stop(),this.tXa=null)}}Object(e.a)(ji,"UploadToCloudManager",null,
[1944]);class fi extends ji{constructor(Q,ya,kb,Mb,vc,id){super(ya,kb,Mb,vc,id);this.ga=Q}cyf(){return!!this.Pm&&!!this.Pm.SaveEntryPoint&&"VersionHistory"===this.Pm.SaveEntryPoint.toString()}q4(){na.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.cyf()&&this.ga.Ub(Ua.a.M8d,2,{["FailureReason"]:"Unknown"});super.q4()}FKb(){na.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.cyf()&&this.ga.processAction(Ua.a.M0c,2);super.FKb()}EKb(Q){na.ULS.sendTraceTag(7205461,
216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.cyf()&&this.ga.processAction(Ua.a.M0c,2);super.EKb(Q)}hfa(){this.Pm&&"true"===this.Pm.SkipSaveToHost?super.hfa():32!==this.ga.processAction(Ua.a.BLb,1)?(na.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.hfa()):this.ga.Ub(Ua.a.BLb,2,[()=>{na.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");ji.prototype.hfa.call(this)},()=>{na.ULS.sendTraceTag(8741713,
216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.q4()}])}}Object(e.a)(fi,"SaveACopyUploadToCloudManager",ji,[]);var Yh=c(751),Yj=c(1181);class ef{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){F.AFrameworkApplication.K.lp(Object(a.a)(this,this.rx,"onFullAppSettingsReady"))}rx(){F.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Wb()}dispose(){}xc(Q){this.W=Q;this.W.register(fi,
"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Xd(()=>new fi(F.AFrameworkApplication.ya,Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Yj.a).create(),()=>new bl(F.AFrameworkApplication.ya),F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.tq)).singleInstance();this.W.register(dj,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Xd(()=>new dj(F.AFrameworkApplication.ya,F.AFrameworkApplication.ta.Pb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();
this.W.register(Zf,"Common.App.SaveACopy.SaveACopyActor").Xd(()=>new Zf(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.tq)).singleInstance();this.W.register(tf,"Common.App.SaveACopy.SaveACopyManager").Xd(()=>new tf(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Yh.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
F.AFrameworkApplication.K,F.AFrameworkApplication.Vla,()=>new bl(F.AFrameworkApplication.ya))).singleInstance()}static main(){ca.a.instance.Kc(new ef)}}Object(e.a)(ef,"PackageManager",null,[1,2]);var Zj=c(41);class Od extends De.StandardDialog{constructor(Q,ya){super();this.rVb=!1;this.YM=null;this.ga=Q;this.Kpc=ya;this.yGa=!1}$S(Q,ya,kb){this.YM=ya;this.rVb=kb;na.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,kb);Q=this.L_e(Q);0===Q?(this.Ed=6,this.Ue(0,CommonUIStrings.l_DialogClose)):
(this.Ed=0,this.Ue(1,CommonUIStrings.l_DialogClose));0===Q&&na.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.py(Zj.a.gPn,this.rAl(Q),this.qAl(Q,ya),Object(a.a)(this,this.RZf,"retryDialogHandler"),!0)}RZf(Q){1===Q?(na.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.YM?this.ga.Ub(Ua.a.E1c,2,[this.YM,this.rVb]):this.ga.processAction(Ua.a.E1c,2)):na.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}L_e(Q){return 0>Q||6<Q?(na.ULS.sendTraceTag(8194012,
216,15,"Unexpected error code {0}.",Q),0):Q}qAl(Q,ya){Q=this.L_e(Q);return this.Kpc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ya),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,
CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ya),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}rAl(Q){Q=this.L_e(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(e.a)(Od,"ErrorRetryDialog",De.StandardDialog,
[1992]);class Sh{constructor(Q,ya){this.Ma=Q;this.ga=ya;this.Kpc=this.Ma.$("SaveToHostWithExtraCharsInFileName")}create(){return new Od(this.ga,this.Kpc)}}Object(e.a)(Sh,"ErrorRetryDialogFactory",null,[1960]);class qf extends dh.a{constructor(Q,ya,kb,Mb,vc,id,ae=null){super();this.p5=null;this.ga=ya;this.jqa=Mb;this.uXa=id;this.Ma=Q;this.FG=vc;this.Vi=kb;this.Kpc=this.Ma.$("SaveToHostWithExtraCharsInFileName");this.Pm=ae;this.Ue(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Vi}UFh(Q,ya){this.Lha(1,
!!Q&&Q!==ya);this.p5=document.getElementById(qf.YMh);G.a.addHandler(this.p5,"change",Object(a.a)(this,this.M0d,"onFileNameChange"));G.a.addHandler(this.p5,"input",Object(a.a)(this,this.M0d,"onFileNameChange"));this.p5.focus()}XMh(Q){return this.Kpc?(new RegExp("["+this.PKh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.PKh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}PKh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Xof(){const Q=qb.a.zI(F.AFrameworkApplication.su.Nz);this.Lha(1,!!this.p5&&
""!==this.p5.value&&this.p5.value!==Q)}M0d(){this.p5&&window.setTimeout(()=>{this.Xof()},0)}EGd(Q,ya){if(1!==Q)na.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=ya[qf.YMh];ya=qf.nJi in ya?ya[qf.nJi]:!1;na.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",qb.a.zSi(Q),ya);const kb=qb.a.NNa(F.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==kb||1===this.ta.state?this.XMh(Q)?
this.FG.create().$S(1,Q,ya):this.uXa.IGa(Q+kb,ya,this.Pm):this.FG.create().$S(2,Q,ya)}}dispose(){this.p5&&(G.a.removeHandler(this.p5,"change",Object(a.a)(this,this.M0d,"onFileNameChange")),G.a.removeHandler(this.p5,"input",Object(a.a)(this,this.M0d,"onFileNameChange")),this.p5=null);super.dispose()}}qf.YMh="txtFileName";qf.nJi="chkOverwrite";Object(e.a)(qf,"FileNameDialogBase",dh.a,[]);class Ld{static get Hg(){return dh.a.Sy(Ld.am,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Ld.am="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(Ld,"FileNameDialogHtml",null,[]);class fh extends qf{constructor(Q,ya,kb,Mb,vc,id){super(Q,ya,kb,Mb,vc,id);this.Hg=Ld.Hg;this.mg="FileNameDialog-SaveAsToHost"}xCa(Q,ya){const kb=qb.a.zI(F.AFrameworkApplication.su.Nz);ya={["txtFileName"]:Q||kb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ya};this.Wh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.EGd,"fileNameDialogHandler"),ya);this.UFh(Q,kb)}}Object(e.a)(fh,"FileNameDialog",qf,[1989]);class Vm{constructor(Q,ya,
kb,Mb,vc,id){this.ga=ya;this.Ma=Q;this.jqa=Mb;this.uXa=id;this.FG=vc;this.Vi=kb}create(){return new fh(this.Ma,this.ga,this.Vi,this.jqa,this.FG,this.uXa)}}Object(e.a)(Vm,"FileNameDialogFactory",null,[1959]);class zl{constructor(Q,ya,kb){this.uXa=kb;this.bue=ya;this.Ma=Q}Wb(){2===F.AFrameworkApplication.ta.Pb.$n?F.AFrameworkApplication.ya.gb(Ua.a.E1c,We.a.frame,Object(a.a)(this,this.M0i,"saveAsToHostActionDispatcher"),4):F.AFrameworkApplication.ya.pa(Ua.a.E1c,We.a.frame,Object(a.a)(this,this.M0i,"saveAsToHostActionDispatcher"))}M0i(Q,
ya,kb,Mb,vc){return ya.contextId!==We.a.frame||Q!==Ua.a.E1c?2:this.Ma.$("SaveAsToHostBrsIsEnabled")?1===kb?rf.SessionStatusManager.instance.zj||F.AFrameworkApplication.tna?8:32:2===kb?(na.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.bue.create(),vc&&Object.getType(vc)===Array&&2===vc.length?Q.xCa(vc[0],!!vc[1]):Q.xCa(null,!1),32):8:8}}Object(e.a)(zl,"SaveAsToHostActor",null,[]);class Pm{constructor(Q,ya,kb,Mb,vc,id,ae,we){this.Uk=null;this.rVb=
this.KY=!1;this.tXa=this.Pm=this.YM=null;this.Ma=ya;this.yka=this.Ma.appSettings.SaveAsToHostWebServiceBase;this.yPg=Mb;this.kWa=vc;this.rg=kb;this.FG=id;this.je=we;this.Vi=ae;this.ga=Q;this.WUa=ya.lb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}D5a(){1!==this.Vi.state&&(this.Uk=this.kWa(),this.Uk.message=CommonUIStrings.l_CommentProgressTooltip,this.Uk.Ed=5,this.Uk.Qt=!1,this.Uk.wM(CommonUIStrings.l_DefaultDialogTitle,null,null))}q4(Q=0){1!==this.Vi.state&&this.FG.create().$S(Q,qb.a.zI(this.YM),
this.rVb)}FKb(){const Q=this.Ma.appSettings.BreadcrumbFolderUrl;na.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");da.a.en(Q,da.a.aqa(3),void 0,"UploadToHostManager.RedirectToFolder")}EKb(Q){let ya=!1,kb=!1;this.Ma&&(ya=this.Ma.$("SaveACopyIsEnabledForUiHost"),kb=this.Ma.$("UiHostSupportsDocRebootFeatures"));na.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,ya,kb);if(ya&&kb){na.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Mb={};Mb[Ke.a.dec]="1";Mb[Ke.a.documentUrl]=Q;Mb[Ke.a.reason]=lf.a.O_f;F.AFrameworkApplication.fO().execute(vc=>{vc.sendMessage(Re.a.CAb,Mb)})}else ya&&!kb&&F.AFrameworkApplication.iga?da.a.en(Q,da.a.aqa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):da.a.en(Q,da.a.aqa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}IGa(Q,ya,kb=null){na.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.yPg&&
!this.yPg()&&this.rg&&(this.je&&(this.tXa=this.je.jg("DialogShown","SaveAsToHostUploadTime")),this.D5a(),this.rVb=ya,this.YM=Q,(this.Pm=kb)&&"true"===this.Pm.SkipSaveToHost?this.NFd():this.hfa())}hfa(){32!==this.ga.processAction(Ua.a.BLb,1)?(na.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.NFd()):this.ga.Ub(Ua.a.BLb,2,[()=>{na.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.NFd()},(Q,ya)=>
{na.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.q4(ya)}])}L$m(Q){this.Hla();this.KY=!1;if(Q&&Q.data&&Q.data.Ae)if(({Uv:ya}=Ha.d(Q.data.Ae)).returnValue)if(Q=ya,Q.StatusCode!==Ql.a.tB&&Q.StatusCode!==Ql.a.DFc){na.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ya={};ya.FailureReason=Q.StatusCode.toString();ya.ExtraInfo=Q.ExtraInfo;this.vRa(ya);this.q4(parseInt(Q.ExtraInfo))}else{na.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.SYf();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.EKb(Q.NewDocumentUrl):this.FKb()}catch(kb){na.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",kb.toString())}this.kYc()}else na.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ub.a.x6c(Q.data.Ae)}),this.vRa({["FailureReason"]:"Failed to deserialize response"}),this.q4();else na.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.vRa({["FailureReason"]:"null response"}),this.q4()}K$m(Q){5!==Q.data.status&&12!==Q.data.status||this.KY?(na.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.jf}),this.vRa({["FailureReason"]:Q.data.jf.toString()}),this.Hla(),this.q4(),this.kYc()):(na.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.KY=!0,this.Pm&&"true"===this.Pm.SkipSaveToHost?this.NFd():this.hfa())}Hla(){this.Uk&&
(this.Uk.close(),this.Uk=null)}kYc(){this.tXa&&(this.tXa.stop(),this.tXa=null)}SYf(){this.Pm&&"VersionHistory"===this.Pm.SaveEntryPoint&&this.ga.processAction(Ua.a.M0c,2)}vRa(Q){this.Pm&&"VersionHistory"===this.Pm.SaveEntryPoint&&this.ga.Ub(Ua.a.M8d,2,Q)}NFd(){let Q=this.yka+this.WUa;Q=bb.a.zp(Q,"qs",qb.a.Pj(F.AFrameworkApplication.Gm));Q=bb.a.zp(Q,"n",qb.a.Pj((new Date).getTime().toString()));Q=bb.a.zp(Q,"ov",qb.a.Pj(this.rVb.toString()));Q=bb.a.zp(Q,"fn",qb.a.Pj(this.YM));this.Pm&&this.Pm.FileDownloadUrl&&
(Q=bb.a.zp(Q,"furl",qb.a.Pj(this.Pm.FileDownloadUrl)));this.rg.qj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.L$m,"onUploadFinished"),Object(a.a)(this,this.K$m,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(Pm,"UploadToHostManager",null,[1937]);class xo{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){F.AFrameworkApplication.K.lp(Object(a.a)(this,this.rx,"onFullAppSettingsReady"))}rx(){F.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Wb()}xc(Q){this.W=Q;this.W.register(Sh,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Xd(()=>new Sh(F.AFrameworkApplication.K,F.AFrameworkApplication.ya)).singleInstance();this.W.register(Pm,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Xd(()=>new Pm(F.AFrameworkApplication.ya,F.AFrameworkApplication.K,F.AFrameworkApplication.Ve,
()=>F.AFrameworkApplication.Rk,()=>(new Yj.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.tq)).singleInstance();this.W.register(Vm,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Xd(()=>new Vm(F.AFrameworkApplication.K,F.AFrameworkApplication.ya,F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.Pb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(zl,"Common.App.SaveAsToHost.SaveAsToHostActor").Xd(()=>new zl(F.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){ca.a.instance.Kc(new xo)}}Object(e.a)(xo,"SaveAsToHostPackage",null,[1,2]);class Vn extends De.StandardDialog{constructor(){super();this.Ed=0;this.Ue(1,CommonUIStrings.l_DialogClose)}$S(Q){this.py(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Vn,"ErrorDialog",De.StandardDialog,[1942]);var zk=c(198);class Lh extends De.StandardDialog{constructor(Q,ya,kb){super();this.ga=Q;this.Xra=ya;this.jqa=kb;this.D9=!1;this.Ed=1;this.DU(1);this.Ue(1,CommonUIStrings.l_SignIn);this.Ue(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}xCa(){this.Xra.ueh(Object(a.a)(this,this.lHi,"onSignIn"));this.xv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.ifm,"inputHandler"))}ifm(Q){0===
Q?(na.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.f4d()}FCk(){let Q="2";if(this.jqa)switch(this.jqa.$n){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.Xra.hFn(Object(a.a)(this,this.lHi,"onSignIn"));super.hide()}f4d(){var Q=F.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";Q=new zk.QueryStringBuilder(Q);Q.Pe("prompt","1");Q.Pe("cbcxt",this.FCk());F.AFrameworkApplication.Dka(Q);da.a.en(Q.toString(),
"LoginWindow",void 0,"SignInDialog")}lHi(){this.nga&&this.hide();na.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(Ua.a.X_f,2)}}Object(e.a)(Lh,"SignInDialog",De.StandardDialog,[1980]);class rk{constructor(Q,ya,kb){this.ga=Q;this.Xra=ya;this.jqa=kb}create(){return new Lh(this.ga,this.Xra,this.jqa)}}Object(e.a)(rk,"SignInDialogFactory",null,[1946]);class Jj{constructor(Q,ya,kb,Mb,vc,id,ae){this.yka=Q;this.YM=ya;this.MSb=
kb;this.ted=Mb;this.lIe=vc;this.WUa=id;this.Pm=ae}execute(Q,ya){if(!F.AFrameworkApplication.Rk&&F.AFrameworkApplication.Ve){var kb=this.yka+this.WUa;kb=bb.a.zp(kb,"fo",qb.a.Pj(this.ted));kb=bb.a.zp(kb,"fn",qb.a.Pj(this.YM));kb=bb.a.zp(kb,"qs",qb.a.Pj(this.lIe));kb=bb.a.zp(kb,"n",qb.a.Pj((new Date).getTime().toString()));this.Pm&&this.Pm.FileDownloadUrl&&(kb=bb.a.zp(kb,"furl",qb.a.Pj(this.Pm.FileDownloadUrl)));this.MSb&&(kb=bb.a.zp(kb,"fnn",qb.a.Pj(this.MSb)));F.AFrameworkApplication.Ve.qj(kb,1,"",
{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,ya,null)}}}Object(e.a)(Jj,"SkyDriveUploadCaller",null,[1979]);class Rl{constructor(Q){this.Ma=Q;this.cxb=Q.appSettings.SkyDriveUploadWebServiceBase;this.YM=Q.appSettings.FileName;this.WUa=Q.lb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,ya,kb){return new Jj(this.cxb,this.YM,ya,Q,F.AFrameworkApplication.Gm,this.WUa,kb)}}Object(e.a)(Rl,"SkydriveUploadCallerFactory",null,[1945]);class cl{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){F.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&
this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Wb()}dispose(){}xc(Q){this.W=Q;this.W.register(rk,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Xd(()=>new rk(F.AFrameworkApplication.ya,Yh.a.instance,F.AFrameworkApplication.ta.Pb)).singleInstance();this.W.register(Rl,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Xd(()=>new Rl(F.AFrameworkApplication.K)).singleInstance();
this.W.register(Qk,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Xd(()=>new Qk(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),F.AFrameworkApplication.K,F.AFrameworkApplication.ta.tq)).singleInstance();this.W.register(ji,"Common.App.SaveToCloudStorage.UploadToCloudManager").Xd(()=>new ji(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Yj.a).create(),()=>new Vn,F.AFrameworkApplication.ta,
F.AFrameworkApplication.ta.tq)).singleInstance();this.W.register(rh,"Common.App.SaveToCloudStorage.SaveToCloudManager").Xd(()=>new rh(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Yh.a.instance,Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),F.AFrameworkApplication.K,F.AFrameworkApplication.Vla,()=>new Vn)).singleInstance()}static main(){ca.a.instance.Kc(new cl)}}Object(e.a)(cl,"PackageManager",null,[1,2]);class Am extends De.StandardDialog{constructor(){super();this.Ed=
0;this.Ue(1,CommonUIStrings.l_DialogClose)}$S(Q,ya){this.lGh(Q,ya,Zj.a.iPn)}lGh(Q,ya,kb){na.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",kb);this.py(kb,Q,ya,null)}m9e(Q,ya){na.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.py(Zj.a.kPn,Q,ya,null,!0)}}Object(e.a)(Am,"ErrorDialog",De.StandardDialog,[941]);class fk{static get Hg(){return dh.a.Sy(fk.am,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}fk.am="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(fk,"FileNameDialogHtml",null,[]);var cf=c(65);class ig extends qf{constructor(Q,ya,kb,Mb,vc,id,ae,we){super(Q,ya,kb,Mb,vc,id,we);this.a$a=this.sKe=this.lP=null;this.lxk=CommonUIStrings.l_SaveToAnotherFolder;this.Hg=fk.Hg;this.mg="FileNameDialog-SaveToSharePoint";this.qxc=ae;this.BXj=we}xCa(Q){const ya=qb.a.zI(F.AFrameworkApplication.su.Nz),kb=F.AFrameworkApplication.breadcrumbFolderName,Mb=F.AFrameworkApplication.breadcrumbBrandName,vc={["txtFileName"]:Q||ya};let id=CommonUIStrings.L_SaveAs;
2===F.AFrameworkApplication.ta.Pb.$n&&(id=CommonUIStrings.L_SaveACopy);this.Wh(id,Object(a.a)(this,this.EGd,"fileNameDialogHandler"),vc);this.UFh(Q,ya);this.f8e.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");F.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.lP=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.sKe=nb.a.Bhh(Q,this.lP,"anotherFolderDescribedBy"),this.lP.className=
"WACButton WACDialogButtonNormal",Q=!1,kb&&kb.length?(this.jch(this.lP,this.sKe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Mb,kb)),Q=this.H9j(Mb,kb)):this.jch(this.lP,this.sKe,CommonUIStrings.l_CurrentOnlineFolder),this.xak(this.lP),this.J9j(this.lP),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.lP,"SaveToAnotherLocationTwo"),na.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.lP,
"SaveToAnotherLocationOne"),G.a.addHandler(this.lP,A.a.click,Object(a.a)(this,this.iNf,"onSaveToAnotherLocationClick")),G.a.addHandler(this.lP,A.a.hi,Object(a.a)(this,this.RGi,"onSaveToAnotherLocationKeyDown")))}H9j(Q,ya){let kb;kb=!1;const Mb=document.getElementById("currentLocation");Mb.innerText="";const vc=this.N_h(Mb,Q),id=this.N_h(Mb,ya);let ae=255,we=255;255<vc+id&&(ae=Math.max(238,408-vc),we=Math.max(170,408-id),kb=!0);this.Hck(Mb,Q,we,ya,ae);return kb}N_h(Q,ya){const kb=document.createElement("div");
kb.innerText=ya;kb.style.visibility="hidden";Q.appendChild(kb);ya=kb.clientWidth;Q.removeChild(kb);return ya}Hck(Q,ya,kb,Mb,vc){ya&&(this.ich(Q,ya,kb),this.zck(Q));Mb&&this.ich(Q,Mb,vc)}ich(Q,ya,kb){const Mb=document.createElement("div");Mb.innerText=ya;Mb.title=ya;Mb.className="SaveToAnotherFolderBreadcrumb";Mb.style.maxWidth=kb.toString()+"px";Q.appendChild(Mb)}zck(Q){const ya=document.createElement("span");ya.id="FolderSeparator";const kb=document.createElementNS("http://www.w3.org/2000/svg","svg");
kb.setAttribute("class","SeparatorCaret");const Mb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Mb.setAttribute("points","1 4 1 11 5 7.5");kb.appendChild(Mb);ya.appendChild(kb);Q.appendChild(ya)}jch(Q,ya,kb){kb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,kb);ya&&(ya.innerText=kb);Q.tabIndex=0;Q.setAttribute(nb.a.wh,nb.a.l2)}J9j(Q){const ya=document.createElement("span");ya.id="anotherFolderText";ya.innerText=this.lxk;ya.className="AnotherFolderTextSpan";
Q.appendChild(ya)}xak(Q){const ya=document.createElement("span");ya.className="cui-img-cont-float cui-img-16by16 ";this.a$a=document.createElementNS("http://www.w3.org/2000/svg","svg");this.a$a.setAttribute("class","FolderIconSVG");const kb=document.createElementNS("http://www.w3.org/2000/svg","path");kb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.a$a.appendChild(kb);ya.appendChild(this.a$a);Q.appendChild(ya)}RGi(Q){!Q||
Q.keyCode!==cf.a.us&&Q.keyCode!==cf.a.sie||this.iNf(Q)}iNf(){if(this.p5){const Q=qb.a.NNa(F.AFrameworkApplication.fileName);let ya=this.p5.value;this.hide();ya&&""!==ya&&""!==Q||1===this.ta.state?(""!==Q&&(ya+=Q),this.XMh(ya)?this.FG.create().$S(1,ya,!1):this.qxc.start(ya,this.BXj)):this.FG.create().$S(2,ya,!1)}}lCk(Q){this.lP&&this.a$a&&(Q?(this.lP.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.lP,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.a$a,"DisabledFolderIconSVG")):(this.lP.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.lP,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.a$a,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.lP,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.a$a,"DisabledFolderIconSVG"))))}Xof(){super.Xof();this.lCk(!!this.p5&&""!==this.p5.value)}dispose(){this.lP&&(G.a.removeHandler(this.lP,A.a.click,Object(a.a)(this,this.iNf,"onSaveToAnotherLocationClick")),G.a.removeHandler(this.lP,A.a.hi,Object(a.a)(this,this.RGi,
"onSaveToAnotherLocationKeyDown")),this.lP=null);super.dispose()}}Object(e.a)(ig,"FileNameDialog",qf,[1097]);var gk=c(546),wi=c(376),pf=c(1510),wn=c(1621);class Gh{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(Gh,"SaveAsDialogInput",null,[]);class Gl{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(Gl,"SaveLocation",null,[]);var Jk=c(134);class Ei{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee){this.aCe=
null;this.YM="";this.qxc=Q;this.FG=ya;this.Pm=Ee;this.uXa=kb;this.Vi=vc;this.fL=Mb;this.Rwb=ae;this.ZWb=we;id&&(this.aCe=new fb.a(()=>new pf.a(id.value,null)))}izl(){const Q=new gk.a(wi.a.Ri());Q.Z("type","currentHost");return Object.assign(new Gl,{folderName:this.fL.breadcrumbFolderName,friendlyPath:this.fL.breadcrumbBrandName,properties:Q})}gwm(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}STl(){if(!this.aCe||
!this.Rwb)return null;var Q=this.aCe.value.gk("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.ozi)return null;Q=Q.ozi;const ya=new X.a;let kb=0,Mb=0;for(var vc=0;vc<Q.length;vc++){var id=Q[vc];if(!this.gwm(id))continue;kb++;if(!id.sharepoint_info)continue;const ae=id.url,we=id.sharepoint_info.site_url,Ee=id.title;id=wn.b(id,F.AFrameworkApplication.isRtl);if(!(ae&&we&&Ee&&id))continue;Mb++;const jf=new gk.a(wi.a.Ri());jf.Z("type","SharePoint");jf.Z("siteUrl",we);jf.Z("folderUrl",ae);Mb++;ya.add(Object.assign(new Gl,
{folderName:Ee,friendlyPath:id,properties:jf}))}vc=new Map;vc.set("NumPlaces",Q.length.toString());vc.set("NumSharepointPlaces",kb.toString());vc.set("placesWithMetadata",Mb.toString());Ca.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",vc);0<kb&&(Mb?.5>1*Mb/kb&&Ca.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ca.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ya}pAl(){const Q=
new X.a;Q.add(this.izl());const ya=this.STl();ya&&Q.addRange(ya);return Object.assign(new Gh,{enableMoreLocations:!F.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.YM,extension:qb.a.NNa(this.fL.Nz),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}bif(){const Q=Object(a.a)(this,this.pAl,"getDialogInput"),ya={};ya.inputPropsCallback=Q;return ya}xCa(Q){this.YM=Q;this.YM||(this.YM=String.format(CommonUIStrings.l_SaveACopy_Filename,qb.a.zI(this.fL.Nz)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.bif()};let ya=CommonUIStrings.L_SaveAs;2===this.Vi.Pb.$n&&(ya=CommonUIStrings.L_SaveACopy);const kb=new dh.a(!1,!1,!0);kb.Ed=1;kb.mg="SaveAsDialog";kb.Ue(1,CommonUIStrings.l_SaveButtonLabel);kb.Wh(ya,Object(a.a)(this,this.ePn,"saveAsDialogHandler"),Q)}P$n(Q,ya){Q&&""!==Q&&""!==ya||1===this.Vi.state?this.fwm()?this.jFm(Q,ya):(""!==ya&&(Q+=ya),this.qxc.start(Q,this.Pm)):(na.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.FG.create().$S(2,
Q,!1))}jFm(Q,ya){Ca.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const kb=this.ZWb.r4e(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.ZWb.Iif(kb).then(Mb=>{if(Mb&&0<Mb.length){const vc=Mb[0][Ke.a.Hgn];Mb=Mb[0][Ke.a.Ign];if(""!==vc&&""!==Mb)this.Rwb.IGa(Mb,Q+ya,vc,this.Pm),Ca.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.FG.create().$S(0,Q,!1);const id=sc.a.AF();id&&(id.set("SiteUrlAvailable",
""===vc?"false":"true"),id.set("FolderUrlAvailable",""===Mb?"false":"true"));Ca.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Jk.a,{extendedProperties:id}))}}else this.FG.create().$S(0,Q,!1),Ca.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Mb=>{"Canceled"===Mb?((Mb=sc.a.AF())&&Mb.set("IsCanceled","true"),Ca.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Jk.a,{extendedProperties:Mb}))):
Ca.Health.instance.recordKpiFailure("SaveACopySFP",Mb,!1,!1,null)})}fwm(){return this.ZWb?this.ZWb.lyf():(na.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}ePn(Q,ya){if(ya&&1===Q){Q=ya.fileName;var kb=qb.a.NNa(this.fL.Nz);ya.moreLocationsSelected&&this.P$n(Q,kb);if(ya.locationCallback){var Mb=ya.locationCallback();Mb?Mb.properties&&"currentHost"===Mb.properties.J("type")?this.uXa.IGa(Q+kb,!1,this.Pm):Mb.properties&&"SharePoint"===Mb.properties.J("type")?(ya=Mb.properties.J("siteUrl"),
Mb=Mb.properties.J("folderUrl"),this.Rwb.IGa(Mb,Q+kb,ya,this.Pm)):na.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):na.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else na.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(Ei,"ReactSaveAsDialog",null,[1097]);class bc{constructor(Q,ya,kb,Mb,vc,id,ae,we=null,Ee=null,jf=null){this.ga=ya;this.Ma=Q;this.jqa=Mb;this.uXa=id;this.FG=vc;this.Vi=kb;this.$3g=ae;this.pTj=we;this.Rwb=Ee;this.ZWb=
jf}create(Q){return this.Vi&&this.Vi.Pb.ZA?new Ei(this.$3g,this.FG,this.uXa,F.AFrameworkApplication.su,this.Vi,this.pTj,this.Rwb,this.ZWb,Q):new ig(this.Ma,this.ga,this.Vi,this.jqa,this.FG,this.uXa,this.$3g,Q)}}Object(e.a)(bc,"FileNameDialogFactory",null,[1072]);class oe{constructor(Q,ya,kb,Mb){this.ow=this.gvc=null;this.Hrb=Q;this.Vi=kb;this.OYj=Mb;this.UUa=new fb.a(()=>new pf.a(ya.value,Object(a.a)(this,this.NCb,"getMoreInfoEventReceived")))}get gIi(){this.gvc||(this.UUa.value.gk("Save As",!0),
this.ow&&this.ow.Oba&&this.ow.Oba.length&&(this.gvc=this.mMl(this.ow.Oba)));return this.gvc}start(Q){if(!this.gIi)if(F.AFrameworkApplication.breadcrumbFolderUrl&&F.AFrameworkApplication.breadcrumbFolderUrl.length)this.gvc=F.AFrameworkApplication.breadcrumbFolderUrl;else return na.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.ow),!1;const ya=this.OYj();ya.aao();const kb=
ya.UOl();if(!kb)return na.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Hrb.start((Mb,vc)=>{ya.hide();Q(Mb,vc)},()=>{this.tIb(ya)},kb,this.gvc);return!0}tIb(Q){Q.hide();na.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}mMl(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const ya=Q.indexOf("/documents/");return-1!==ya?Q.substring(0,ya+1)+"_layouts/15/onedrive.aspx":""}NCb(Q){this.ow||3!==Q.state||(this.ow=Q)}}Object(e.a)(oe,"OneDriveFilePickerHelper",
null,[1070]);class Me extends dh.a{constructor(){super()}aao(){this.KRb="FilePickerDialog";this.Hg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.mg="PickerDialog-MsoSp";this.showDialog("",null)}UOl(){return document.getElementById("FilePickerDiv")}SK(){}Vba(){}}Object(e.a)(Me,"PickerDialog",dh.a,[1071]);class Ri{constructor(Q,ya,kb,Mb,vc,id,ae){this.Ma=Q;this.bue=kb;this.ga=ya;this.qxc=Mb;this.Hrb=vc;this.fvc=id;this.tGj=ae}Wb(){const Q=this.Hrb.r5b();Q?Fa.a.rna||this.Ma.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.gb(Ua.a.wfc,We.a.frame,Object(a.a)(this,this.g1i,"saveToSharePointActionDispatcher"),64):(Q.G2a.continueWith(ya=>{ya.Di&&this.Hrb.$Lf(ya)}),this.Dxd()):na.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}Dxd(){Ib.a.D_c(Object(a.a)(this,this.g1i,"saveToSharePointActionDispatcher"));Ib.a.MHc([new mh.a(Ua.a.wfc,We.a.frame,0)],this.Hrb.r5b())}get W9b(){return this.Ma.$("SaveToAnotherFolderBrsIsEnabled")}get Hph(){return this.Ma.$("UserCanWriteRelative")}g1i(Q,
ya,kb,Mb,vc){return ya.contextId!==We.a.frame||Q!==Ua.a.wfc?2:this.W9b&&(this.fvc.gIi||this.Hph)?1===kb?rf.SessionStatusManager.instance.zj||F.AFrameworkApplication.tna?8:this.tGj()?32:8:2===kb?(na.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(vc&&vc.SaveEntryPoint&&"VersionHistory"===vc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Hph?(na.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.bue.create(vc).xCa(null)):(na.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.qxc.start(null,vc)),32):8:8}}Object(e.a)(Ri,"SaveToSharePointActor",null,[]);class Rk{constructor(Q,ya,kb,Mb){this.Pm=this.qXg=null;this.Rwb=Q;this.FG=ya;this.fvc=kb;this.Vi=Mb}start(Q,ya){na.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.qXg=Q;this.Pm=ya;this.fvc.start((kb,Mb)=>{this.processResponse(kb,Mb)})||this.Y5f()}processResponse(Q,ya){if(Q)this.onSuccess(ya);else this.onFailure(ya)}Y5f(){1!==
this.Vi.state&&this.FG().m9e(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){na.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const ya=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let kb=null;if(ya&&(kb=Q?this.dUl(Q):this.cUl(ya))){this.Rwb.IGa(ya,this.qXg,kb,this.Pm);return}na.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ya,!kb)}na.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.Y5f()}cUl(Q){Q.endsWith("/")||(Q+="/");let ya=0;for(let kb=0;kb<Q.length;kb++)if("/"===Q.charAt(kb)&&5===++ya)return Q.substr(0,kb);return null}dUl(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const ya=Q.lastIndexOf("/");return-1!==ya?Q.substring(0,ya):null}onFailure(Q){na.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");Q&&Q.error?na.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Q.error.errorCode,Q.error.message):na.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.Y5f()}}Object(e.a)(Rk,"SaveToSharePointManager",null,[1963]);class cg{constructor(Q,ya,kb,Mb,vc,id,ae,we){this.yka=Q;this.YM=ya;this.MSb=Mb;this.lIe=id;this.gJa=kb;this.U2j=vc;this.WUa=ae;this.Pm=we}execute(Q,ya){if(!F.AFrameworkApplication.Rk&&
F.AFrameworkApplication.Ve){var kb=this.yka+this.WUa;kb=bb.a.zp(kb,"fu",qb.a.Pj(this.gJa));kb=bb.a.zp(kb,"su",qb.a.Pj(this.U2j));kb=bb.a.zp(kb,"fn",qb.a.Pj(this.YM));kb=bb.a.zp(kb,"n",qb.a.Pj((new Date).getTime().toString()));this.Pm&&this.Pm.FileDownloadUrl&&(kb=bb.a.zp(kb,"furl",qb.a.Pj(this.Pm.FileDownloadUrl)));kb=kb+"&"+this.lIe;this.MSb&&this.MSb.length?kb=bb.a.zp(kb,"fnn",qb.a.Pj(this.MSb)):na.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");na.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");F.AFrameworkApplication.Ve.qj(kb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,ya,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(cg,"SharePointSaveAsCaller",null,[1993]);class af{constructor(Q){this.cxb=Q.appSettings.SaveAsToHostWebServiceBase;this.YM=Q.appSettings.FileName;this.WUa=Q.lb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,ya,kb,Mb){return new cg(this.cxb,this.YM,Q,ya,kb,F.AFrameworkApplication.Gm,
this.WUa,Mb)}}Object(e.a)(af,"SharePointUploadCallerFactory",null,[1962]);var Zi=c(1349);class si{constructor(Q,ya,kb,Mb,vc){this.Uk=this.Imc=null;this.rme=!1;this.mKe=this.gJa=null;this.eQe=ya;this.kWa=kb;this.FG=Mb;this.Vi=vc;this.ga=Q}IGa(Q,ya,kb,Mb){this.rme=!1;na.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.D5a();this.gJa=Q;Mb&&Mb.SaveEntryPoint&&(this.mKe=Mb.SaveEntryPoint);this.Imc=this.eQe.create(Q,ya,kb,Mb);Mb&&"true"===Mb.SkipSaveToHost?
this.hfa():this.Jnl()}Jnl(){const Q=()=>{na.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.hfa()};32!==this.ga.Ub(Ua.a.BLb,2,[()=>{na.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.hfa()},Q])&&Q()}hfa(){na.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Imc.execute(Object(a.a)(this,this.L8m,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.K8m,
"onSaveToSharePointUploadFailed"))}L8m(Q){if(Q&&Q.data&&Q.data.Ae){var ya;if(({Uv:ya}=Ha.d(Q.data.Ae)).returnValue)if(ya.StatusCode!==Ql.a.tB&&ya.StatusCode!==Ql.a.DFc)na.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,ya.StatusCode),ya.StatusCode!==Ql.a.XYf&&this.OGh(Q.data.status)||(this.vRa(ya.StatusCode.toString()),this.Z9n(ya.StatusCode));else{na.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.SYf();try{ya.NewDocumentUrl?this.EKb(ya.NewDocumentUrl):this.FKb()}catch(kb){na.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",kb.toString())}}else na.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ub.a.x6c(Q.data.Ae)}),this.YDd()||(this.vRa("Failed to deserialize response"),this.g4c())}else na.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.YDd()||(this.vRa("Unknown"),this.g4c())}K8m(Q){Q&&Q.data?this.OGh(Q.data.status)||
(na.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.vRa(Zi.a[Q.data.status]),this.g4c()):(na.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.YDd()||(this.vRa("Unknown"),this.g4c()))}YDd(){if(!this.rme)return na.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.rme=!0,this.hfa(),!0;na.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}OGh(Q){na.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
Q);return this.YDd()}FKb(){na.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");da.a.en(this.gJa,da.a.aqa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}EKb(Q){let ya=!1,kb=!1;F.AFrameworkApplication.K&&(ya=F.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),kb=F.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));na.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,ya);if(ya&&kb){na.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Mb={};Mb[Ke.a.dec]="1";Mb[Ke.a.documentUrl]=Q;Mb[Ke.a.reason]=lf.a.O_f;F.AFrameworkApplication.fO().execute(vc=>{vc.sendMessage(Re.a.CAb,Mb)})}else da.a.en(Q,da.a.aqa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}D5a(){this.Vi&&1===this.Vi.state||(this.Uk=this.kWa(),this.Uk.message=CommonUIStrings.l_CommentProgressTooltip,this.Uk.Ed=5,this.Uk.Qt=!1,this.Uk.wM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Hla(){this.Uk&&(this.Uk.close(),this.Uk=null)}g4c(){this.Kp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}Q$n(){this.Kp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}d$n(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Kp(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,Zj.a.fPn)}Kp(Q,ya,kb=Zj.a.jPn){na.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,ya);this.Hla();1!==this.Vi.state&&this.FG().lGh(Q,ya,kb)}Z9n(Q){na.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
Q);switch(Q){case Ql.a.Uge:this.Q$n();break;case Ql.a.XYf:this.d$n();break;default:this.g4c()}}SYf(){"VersionHistory"===this.mKe&&this.ga.processAction(Ua.a.M0c,2)}vRa(Q){"VersionHistory"===this.mKe&&this.ga.Ub(Ua.a.M8d,2,{["FailureReason"]:Q})}}Object(e.a)(si,"UploadToSharePointManager",null,[1961]);var eo=c(642),lk=c(121);class cn{constructor(){this.Rpd=this.aEe=this.SDe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}xc(Q){this.W=Q;this.SDe=eo.a.sq(Q.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.aEe=eo.a.sq(Q.Za("Common.IEventEmitter<Common.IMruResult>"));this.Rpd=eo.a.sq(Q.Za("Common.App.SharedFilePicker.ISharedFilePicker"));lk.Task.WAA.call(null,this.SDe,this.aEe,this.Rpd).continueWith(()=>{this.Txn()})}Txn(){this.W.register(af,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Xd(()=>new af(F.AFrameworkApplication.K)).singleInstance();this.W.register(si,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Xd(()=>
new si(F.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Yj.a).create(),()=>new Am,F.AFrameworkApplication.ta)).singleInstance();this.W.register(Rk,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Xd(()=>new Rk(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Am,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),F.AFrameworkApplication.ta)).singleInstance();
this.W.register(oe,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Xd(()=>new oe(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new fb.a(()=>this.SDe.result),F.AFrameworkApplication.ta,()=>new Me)).singleInstance();this.W.register(bc,"Common.App.SaveToSharePoint.FileNameDialogFactory").Xd(()=>new bc(F.AFrameworkApplication.K,F.AFrameworkApplication.ya,F.AFrameworkApplication.ta,F.AFrameworkApplication.ta.Pb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new fb.a(()=>this.aEe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Rpd?this.Rpd.result:null)).singleInstance();this.W.register(Ri,"Common.App.SaveToSharePoint.SaveToSharePointActor").Xd(()=>new Ri(F.AFrameworkApplication.K,F.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>F.AFrameworkApplication.ta.GAk)).singleInstance();F.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Wb()}static main(){ca.a.instance.Kc(new cn)}}Object(e.a)(cn,"PackageManager",null,[1,2]);
class Al{}Object(e.a)(Al,"StringDifference",null,[1951]);class Vc{constructor(Q,ya){this.charCode=Q;this.description=ya}}Object(e.a)(Vc,"UBTableEntry",null,[]);class Sk{}new Vc(8,"C0 Controls 1");new Vc(9,"Horizontal tab (HT)");new Vc(10,"Line feed (LF)");new Vc(12,"C0 Controls 2");new Vc(13,"Carriage return (CR)");new Vc(31,"C0 Controls 3");new Vc(32,"Space");new Vc(47,"ASCII Punctuation and Symbols 1");new Vc(57,"ASCII Digits");new Vc(64,"ASCII Punctuation and Symbols 2");new Vc(90,"Uppercase Latin Alphabet");
new Vc(96,"ASCII Punctuation and Symbols 3");new Vc(122,"Lowercase Latin Alphabet");new Vc(127,"U+0000..U+007F Basic Latin");new Vc(159,"C1 Controls");new Vc(160,"NB Space");new Vc(191,"Latin-1 Punctuation and Symbols");new Vc(255,"U+0080..U+00FF Latin-1 Supplement");new Vc(383,"U+0100..U+017F Latin Extended-A");new Vc(591,"U+0180..U+024F Latin Extended-B");new Vc(687,"U+0250..U+02AF IPA Extensions");new Vc(767,"U+02B0..U+02FF Spacing Modifier Letters");new Vc(879,"U+0300..U+036F Combining Diacritical Marks");
new Vc(1023,"U+0370..U+03FF Greek and Coptic");new Vc(1279,"U+0400..U+04FF Cyrillic");new Vc(1327,"U+0500..U+052F Cyrillic Supplement");new Vc(1423,"U+0530..U+058F Armenian");new Vc(1535,"U+0590..U+05FF Hebrew");new Vc(1791,"U+0600..U+06FF Arabic");new Vc(1871,"U+0700..U+074F Syriac");new Vc(1919,"U+0750..U+077F Arabic Supplement");new Vc(1983,"U+0780..U+07BF Thaana");new Vc(2047,"U+07C0..U+07FF NKo");new Vc(2111,"U+0800..U+083F Samaritan");new Vc(2143,"U+0840..U+085F Mandaic");new Vc(2303,"U+08A0..U+08FF Arabic Extended-A");
new Vc(2431,"U+0900..U+097F Devanagari");new Vc(2559,"U+0980..U+09FF Bengali");new Vc(2687,"U+0A00..U+0A7F Gurmukhi");new Vc(2815,"U+0A80..U+0AFF Gujarati");new Vc(2943,"U+0B00..U+0B7F Oriya");new Vc(3071,"U+0B80..U+0BFF Tamil");new Vc(3199,"U+0C00..U+0C7F Telugu");new Vc(3327,"U+0C80..U+0CFF Kannada");new Vc(3455,"U+0D00..U+0D7F Malayalam");new Vc(3583,"U+0D80..U+0DFF Sinhala");new Vc(3711,"U+0E00..U+0E7F Thai");new Vc(3839,"U+0E80..U+0EFF Lao");new Vc(4095,"U+0F00..U+0FFF Tibetan");new Vc(4255,
"U+1000..U+109F Myanmar");new Vc(4351,"U+10A0..U+10FF Georgian");new Vc(4607,"U+1100..U+11FF Hangul Jamo");new Vc(4991,"U+1200..U+137F Ethiopic");new Vc(5023,"U+1380..U+139F Ethiopic Supplement");new Vc(5119,"U+13A0..U+13FF Cherokee");new Vc(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new Vc(5791,"U+1680..U+169F Ogham");new Vc(5887,"U+16A0..U+16FF Runic");new Vc(5919,"U+1700..U+171F Tagalog");new Vc(5951,"U+1720..U+173F Hanunoo");new Vc(5983,"U+1740..U+175F Buhid");new Vc(6015,"U+1760..U+177F Tagbanwa");
new Vc(6143,"U+1780..U+17FF Khmer");new Vc(6319,"U+1800..U+18AF Mongolian");new Vc(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new Vc(6479,"U+1900..U+194F Limbu");new Vc(6527,"U+1950..U+197F Tai Le");new Vc(6623,"U+1980..U+19DF New Tai Lue");new Vc(6655,"U+19E0..U+19FF Khmer Symbols");new Vc(6687,"U+1A00..U+1A1F Buginese");new Vc(6831,"U+1A20..U+1AAF Tai Tham");new Vc(7039,"U+1B00..U+1B7F Balinese");new Vc(7103,"U+1B80..U+1BBF Sundanese");new Vc(7167,"U+1BC0..U+1BFF Batak");
new Vc(7247,"U+1C00..U+1C4F Lepcha");new Vc(7295,"U+1C50..U+1C7F Ol Chiki");new Vc(7375,"U+1CC0..U+1CCF Sundanese Supplement");new Vc(7423,"U+1CD0..U+1CFF Vedic Extensions");new Vc(7551,"U+1D00..U+1D7F Phonetic Extensions");new Vc(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new Vc(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new Vc(7935,"U+1E00..U+1EFF Latin Extended Additional");new Vc(8191,"U+1F00..U+1FFF Greek Extended");new Vc(8303,"U+2000..U+206F General Punctuation");
new Vc(8351,"U+2070..U+209F Superscripts and Subscripts");new Vc(8399,"U+20A0..U+20CF Currency Symbols");new Vc(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new Vc(8527,"U+2100..U+214F Letterlike Symbols");new Vc(8591,"U+2150..U+218F Number Forms");new Vc(8703,"U+2190..U+21FF Arrows");new Vc(8959,"U+2200..U+22FF Mathematical Operators");new Vc(9215,"U+2300..U+23FF Miscellaneous Technical");new Vc(9279,"U+2400..U+243F Control Pictures");new Vc(9311,"U+2440..U+245F Optical Character Recognition");
new Vc(9471,"U+2460..U+24FF Enclosed Alphanumerics");new Vc(9599,"U+2500..U+257F Box Drawing");new Vc(9631,"U+2580..U+259F Block Elements");new Vc(9727,"U+25A0..U+25FF Geometric Shapes");new Vc(9983,"U+2600..U+26FF Miscellaneous Symbols");new Vc(10175,"U+2700..U+27BF Dingbats");new Vc(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new Vc(10239,"U+27F0..U+27FF Supplemental Arrows-A");new Vc(10495,"U+2800..U+28FF Braille Patterns");new Vc(10623,"U+2900..U+297F Supplemental Arrows-B");
new Vc(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new Vc(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new Vc(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new Vc(11359,"U+2C00..U+2C5F Glagolitic");new Vc(11391,"U+2C60..U+2C7F Latin Extended-C");new Vc(11519,"U+2C80..U+2CFF Coptic");new Vc(11567,"U+2D00..U+2D2F Georgian Supplement");new Vc(11647,"U+2D30..U+2D7F Tifinagh");new Vc(11743,"U+2D80..U+2DDF Ethiopic Extended");new Vc(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new Vc(11903,"U+2E00..U+2E7F Supplemental Punctuation");new Vc(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new Vc(12255,"U+2F00..U+2FDF Kangxi Radicals");new Vc(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new Vc(12351,"U+3000..U+303F CJK Symbols and Punctuation");new Vc(12447,"U+3040..U+309F Hiragana");new Vc(12543,"U+30A0..U+30FF Katakana");new Vc(12591,"U+3100..U+312F Bopomofo");new Vc(12687,"U+3130..U+318F Hangul Compatibility Jamo");new Vc(12703,"U+3190..U+319F Kanbun");new Vc(12735,
"U+31A0..U+31BF Bopomofo Extended");new Vc(12783,"U+31C0..U+31EF CJK Strokes");new Vc(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new Vc(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new Vc(13311,"U+3300..U+33FF CJK Compatibility");new Vc(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new Vc(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new Vc(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new Vc(42127,"U+A000..U+A48F Yi Syllables");new Vc(42191,"U+A490..U+A4CF Yi Radicals");
new Vc(42239,"U+A4D0..U+A4FF Lisu");new Vc(42559,"U+A500..U+A63F Vai");new Vc(42655,"U+A640..U+A69F Cyrillic Extended-B");new Vc(42751,"U+A6A0..U+A6FF Bamum");new Vc(42783,"U+A700..U+A71F Modifier Tone Letters");new Vc(43007,"U+A720..U+A7FF Latin Extended-D");new Vc(43055,"U+A800..U+A82F Syloti Nagri");new Vc(43071,"U+A830..U+A83F Common Indic Number Forms");new Vc(43135,"U+A840..U+A87F Phags-pa");new Vc(43231,"U+A880..U+A8DF Saurashtra");new Vc(43263,"U+A8E0..U+A8FF Devanagari Extended");new Vc(43311,
"U+A900..U+A92F Kayah Li");new Vc(43359,"U+A930..U+A95F Rejang");new Vc(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new Vc(43487,"U+A980..U+A9DF Javanese");new Vc(43615,"U+AA00..U+AA5F Cham");new Vc(43647,"U+AA60..U+AA7F Myanmar Extended-A");new Vc(43743,"U+AA80..U+AADF Tai Viet");new Vc(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new Vc(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new Vc(44031,"U+ABC0..U+ABFF Meetei Mayek");new Vc(55215,"U+AC00..U+D7AF Hangul Syllables");new Vc(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new Vc(56191,"U+D800..U+DB7F High Surrogates");new Vc(56319,"U+DB80..U+DBFF High Private Use Surrogates");new Vc(57343,"U+DC00..U+DFFF Low Surrogates");new Vc(63743,"U+E000..U+F8FF Private Use Area");new Vc(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new Vc(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new Vc(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new Vc(65039,"U+FE00..U+FE0F Variation Selectors");new Vc(65055,"U+FE10..U+FE1F Vertical Forms");new Vc(65071,"U+FE20..U+FE2F Combining Half Marks");
new Vc(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new Vc(65135,"U+FE50..U+FE6F Small Form Variants");new Vc(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new Vc(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new Vc(65535,"U+FFF0..U+FFFF Specials");new Vc(65663,"U+10000..U+1007F Linear B Syllabary");new Vc(65791,"U+10080..U+100FF Linear B Ideograms");new Vc(65855,"U+10100..U+1013F Aegean Numbers");new Vc(65935,"U+10140..U+1018F Ancient Greek Numbers");new Vc(65999,"U+10190..U+101CF Ancient Symbols");
new Vc(66047,"U+101D0..U+101FF Phaistos Disc");new Vc(66207,"U+10280..U+1029F Lycian");new Vc(66271,"U+102A0..U+102DF Carian");new Vc(66351,"U+10300..U+1032F Old Italic");new Vc(66383,"U+10330..U+1034F Gothic");new Vc(66463,"U+10380..U+1039F Ugaritic");new Vc(66527,"U+103A0..U+103DF Old Persian");new Vc(66639,"U+10400..U+1044F Deseret");new Vc(66687,"U+10450..U+1047F Shavian");new Vc(66735,"U+10480..U+104AF Osmanya");new Vc(67647,"U+10800..U+1083F Cypriot Syllabary");new Vc(67679,"U+10840..U+1085F Imperial Aramaic");
new Vc(67871,"U+10900..U+1091F Phoenician");new Vc(67903,"U+10920..U+1093F Lydian");new Vc(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new Vc(68095,"U+109A0..U+109FF Meoritic Cursive");new Vc(68191,"U+10A00..U+10A5F Kharoshthi");new Vc(68223,"U+10A60..U+10A7F Old South Arabian");new Vc(68415,"U+10B00..U+10B3F Avestan");new Vc(68447,"U+10B40..U+10B5F Inscriptional Parthian");new Vc(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new Vc(68687,"U+10C00..U+10C4F Old Turkic");new Vc(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new Vc(69759,"U+11000..U+1107F Brahmi");new Vc(69839,"U+11080..U+110CF Kaithi");new Vc(69887,"U+110D0..U+110FF Sora Sompeng");new Vc(69967,"U+11100..U+1114F Chakma");new Vc(70111,"U+11180..U+111DF Sharada");new Vc(71375,"U+11680..U+116CF Takri");new Vc(74751,"U+12000..U+123FF Cuneiform");new Vc(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new Vc(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new Vc(92735,"U+16800..U+16A3F Bamum Supplement");new Vc(94111,"U+16F00..U+16F9F Miao");new Vc(110847,
"U+1B000..U+1B0FF Kana Supplement");new Vc(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new Vc(119295,"U+1D100..U+1D1FF Musical Symbols");new Vc(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new Vc(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new Vc(119679,"U+1D360..U+1D37F Counting Rod Numerals");new Vc(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new Vc(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new Vc(127023,"U+1F000..U+1F02F Mahjong Tiles");
new Vc(127135,"U+1F030..U+1F09F Domino Tiles");new Vc(127231,"U+1F0A0..U+1F0FF Playing Cards");new Vc(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new Vc(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new Vc(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new Vc(128591,"U+1F600..U+1F64F Emoticons");new Vc(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new Vc(128895,"U+1F700..U+1F77F Alchemical Symbols");new Vc(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new Vc(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new Vc(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new Vc(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new Vc(917631,"U+E0000..U+E007F Tags");new Vc(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new Vc(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new Vc(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(Sk,"UnicodeBlocks",null,[1939]);class ne{constructor(){this.W=
null}xc(Q){this.W=Q;this.W.register(Al,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(Sk,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){ca.a.instance.Kc(new ne)}}
Object(e.a)(ne,"SensitiveLoggingPackage",null,[1,2]);var qi;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder";Q[Q.yourPhone=3]="yourPhone"})(qi||(qi={}));Object(e.b)("SharedFilePickerLandingLocation",qi);class Wf{constructor(Q){this.eEb=this.ydc=null;this._initialized=!1;this.Kqf=Q}Oaf(Q){this._initialized||(Q.Jv(Re.a.FRi),Q.oC(Re.a.FRi,Object(a.a)(this,this.O7m,"onReceivedPickerResponse")),this._initialized=!0)}Iif(Q){return this.eEb=new Promise((ya,
kb)=>{const Mb={};Mb[Ke.a.Ggn]=Q;this.ydc=(vc,id)=>{""===id?(na.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ya(vc)):("Canceled"===id?na.ULS.sendTraceTag(572548164,306,50,id):na.ULS.sendTraceTag(556901065,306,10,id),kb(id))};this.Kqf.execute(vc=>{this.Oaf(vc);vc.sendMessage(Re.a.ebn,Mb)})})}O7m(Q){this.ydc(Q.Values[Ke.a.cSn],void 0===Q.Values[Ke.a.tQf]||null===Q.Values[Ke.a.tQf]?"":Q.Values[Ke.a.tQf])}lyf(){return F.AFrameworkApplication.K.$("UiHostCommonFilePicker")}r4e(Q,
ya,kb,Mb,vc,id,ae,we,Ee=null){const jf={};jf[Ke.a.DRn]=Q;jf[Ke.a.titleText]=ya;jf[Ke.a.Uik]=kb;jf[Ke.a.Vik]=Mb;jf[Ke.a.Xik]=vc;jf[Ke.a.x6k]=!0;jf[Ke.a.khl]=id;jf[Ke.a.Kgn]=ae;jf[Ke.a.Jgn]=qi[we];ci.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(jf[Ke.a.Lgn]="Dark");Ee&&(null!=Ee.yZb&&(jf[Ke.a.yZb]=Ee.yZb),null!=Ee.m7b&&(jf[Ke.a.m7b]=Ee.m7b));return jf}}Object(e.a)(Wf,"SharedFilePickerManager",null,[1947]);class Ak{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}xc(Q){this.W=
Q;Q.register(Wf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Xd(()=>new Wf(Q.Za("Postmessage.IHostPostmessenger")))}init(){F.AFrameworkApplication.K.lp(()=>{this.a1a()})}a1a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){ca.a.instance.Kc(new Ak)}}Object(e.a)(Ak,"SharedFilePickerPackage",null,[1,2]);class Qf extends Sys.EventArgs{constructor(){super()}}Object(e.a)(Qf,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class Tk{}Object(e.a)(Tk,"TypingSpeedMeterWindow",null,[]);class ff{constructor(Q,ya){new k.a;this.yz=Q;this.Lh=ya;this.Lh.DTe(Object(a.a)(this,this.t0d,"onCpuMeterFrameAvailable"))}t0d(){}dispose(){this.Lh.sWi(Object(a.a)(this,this.t0d,"onCpuMeterFrameAvailable"))}}Object(e.a)(ff,"TypingSpeedMeter",null,[1981]);class vj{constructor(Q){this.Csd=null;this.Op=new r.a;this.yz=Q}initialize(Q,ya,kb,Mb){this.Csd||(this.Csd=new ff(this.yz,Q,ya,kb,Mb),this.Op.Cg(this.Csd));return this.Csd}}
Object(e.a)(vj,"TypingSpeedMeterProvider",null,[1950]);class jd{constructor(){this.APe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(F.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=za.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),ya=eo.a.sq(za.a.instance.Za("Common.ICpuMeterProvider"));ya.continueWith(()=>{const kb=ya.result.Op.task;var Mb=new Ta.a(F.AFrameworkApplication.K.pc("TypingSpeedMeterWindowSamplingPercent",0)/100);Mb=new Na.a(Object(a.a)(Mb,
Mb.zMb,"shouldBeInSample"));const vc=R.a.sE(12,1,Mb),id=F.AFrameworkApplication.K.pc("TypingSpeedMeterWindowTimeoutMs",5E3),ae=F.AFrameworkApplication.K.pc("TypingSpeedMeterMaxKeystrokesPerWindow",5);kb.CWR(()=>this.APe=Q.initialize(kb.result,vc,id,ae))})}}dispose(){this.APe&&this.APe.dispose()}xc(Q){Q.register(vj,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Xd(()=>new vj(da.a.Ye))}static main(){ca.a.instance.Kc(new jd)}}Object(e.a)(jd,
"TypingSpeedMeterPackage",null,[1,2]);class Uk{create(Q){return new Ta.a(Q)}}Object(e.a)(Uk,"RandomSamplerFactory",null,[868]);var If=c(11),zf=c(1380);class Wn{constructor(Q,ya,kb,Mb,vc){Q.xfk(()=>{Mb.G0c()});Q.Rfk((id,ae)=>{Mb.E0c(ae.revisionId,ae.s3a)});Q.PTe((id,ae)=>{Mb.Ham(ae.eNn,ae.s3a,ae.mij)});Q.wfk(()=>{Mb.JYf()});ya.Ufk((id,ae)=>{Mb.omo(ae.MXi,ae.zfe,ae.actualValue)});ya.Nek((id,ae)=>{Mb.nmo(ae.MXi,ae.zfe,ae.actualValue)});vc.cvd(()=>{Mb.Q6c()});kb.f6((id,ae)=>{6===ae.type&&Mb.ofc(ae.FM)})}}
Object(e.a)(Wn,"EventForwarder",null,[]);class Kh{constructor(Q,ya,kb){this.QVj=Q;this.RM=kb;this.PXb=ya}create(Q,ya){return new Wn(this.QVj,this.PXb,Q,ya,this.RM)}}Object(e.a)(Kh,"EventForwarderFactory",null,[]);var ti=c(441);class jg{}jg.oso="TypingToOutboundReplicationStart";jg.Jbn="OutboundReplicationStartToOutboundReplicationEnd";jg.f0i="RtcNotificationToInboundReplicationEnd";jg.kmj="TypingToInboundReplicationEnd";Object(e.a)(jg,"PerfTrackerPhases",null,[]);class ej{constructor(Q,ya,kb,Mb,vc,
id,ae,we,Ee=null){this.hVg=!1;this.MEe=5;this.CWg=50;this.nDe=20;this.KBe=this.YCe=this.uya=null;this.Rnc=this.Hnc=0;this.JMe=this.TNe=!1;this.xrd=Array(7);this.llc=null;this.NMg=!1;this.Eoe=null;this.mha={};this.pgd=Q;this.jUa=ya;this.tUj=kb;this.zOg=Mb.create(jg.f0i,vc,id,20,!1);this.Dsd=Mb.create(jg.kmj,ae,we,20,!0);if(this.Ma=F.AFrameworkApplication.K)this.hVg=this.Ma.$("LogSteppedInboundFrameIsEnabled"),this.nDe=this.Ma.pc("InboundFrameMaxNumberOfLongRunningTasks",20),this.CWg=this.Ma.pc("InboundFrameMinLengthForLongRunningTasksInMs",
50),this.MEe=this.Ma.pc("InboundFrameNumberOfLastShortTasks",5);this.sqb=Ee}get JDk(){null==this.Eoe&&(this.Eoe=!!this.Ma&&this.Ma.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.Eoe}initialize(Q){this.uya=Q}CIn(Q,ya,kb=null){this.ish();na.ULS.shipAssertTag(8229761,324,0<Q.length);let Mb=!1;for(const id of Q){const ae=id.toString();if(ae in this.mha){var vc=this.mha[ae];if(!vc.Vfc){vc.N3i(Q,ya,kb);if(Mb)this.xui(id.toString(),vc,null,null,this.xrd,null);else{const we=
this.Dfl(),Ee=this.Gql(this.llc);Mb=!0;this.xui(id.toString(),vc,we,this.KBe,this.xrd,Ee)}delete this.mha[ae]}}else vc=this.pgd.create(this.zOg,this.Dsd),vc.N3i(Q,ya),this.mha[ae]=vc}this.JMe=!1}ofc(Q){na.ULS.shipAssertTag(8257930,304,Q.zpi,"Expected data not sent on the wire");if(Q.zpi){if(Q.q9d in this.mha){var ya=this.mha[Q.q9d];ya.F9d||(ya.ofc(Q.revisionId,Q.VIi,Q.X$i,Q.s3a),delete this.mha[Q.q9d])}else ya=this.pgd.create(this.zOg,this.Dsd),ya.ofc(Q.revisionId,Q.VIi,Q.X$i,Q.s3a),this.mha[Q.q9d]=
ya;this.ish()}}tcm(){this.TNe||(this.YCe=Array(this.nDe),this.KBe=Array(this.MEe),this.Rnc=this.Hnc=0,this.xrd=[0,0,0,0,0,0,0,0],this.llc=Array(3),this.llc[1]=[0,0],this.llc[2]=[0,0],this.TNe=!0)}r7n(Q){return!Q.TP&&Q.TN===J.a.GXi&&(Q=ti.a(this.mha))&&Q[0]?!0:!1}K2m(Q){this.TNe=!1;const ya=ti.a(this.mha);ya&&ya[0]&&(Q.TRT>=this.CWg&&this.Hnc<this.nDe?this.YCe[this.Hnc++]=Q:(this.KBe[this.Rnc]=Q,this.Rnc=this.Rnc<this.MEe-1?this.Rnc+1:0),this.FNm(Q),this.YNm(Q))}J2m(){this.tcm();this.JMe=!0}FNm(Q){this.xrd[Q.TP]++}YNm(Q){if(Q&&
Q.UI){const ya=this.llc[Q.UI];ya[0]+=1;ya[1]+=Q.TRT}}Gql(Q){const ya={};Q&&(Q[1]&&(ya.Typing=Q[1]),Q[2]&&(ya.Clicking=Q[2]));return ya}Dfl(){return this.Hnc?this.YCe.slice(0,this.Hnc-1):null}ish(){var Q=ti.a(this.mha);if(Q&&(this.NMg||this.KOm(Q),Q.length>this.tUj))for(const ya of Q){Q=this.mha[ya];const kb=Q.createdTime,Mb=this.jUa();6E4<Mb-kb&&(w.b(8438528,304,50,"{0}",{["Not Received"]:Q.Vfc?"RtcNotification":"ServerRevision",["Duration"]:Mb-kb}),Q.Vfc||w.b(42075798,304,15,"{0}",{["RevisionId"]:ya,
["Duration"]:Mb-kb}),delete this.mha[ya])}}KOm(Q){if(this.JDk&&this.sqb)for(const ya of Q)if(Q=this.mha[ya],Q.F9d&&!Q.Vfc&&(Q=Q.createdTime,2E3<this.jUa()-Q)){let kb=null;If.App.xa&&If.App.xa.jb&&If.App.xa.jb.Yc&&(kb=If.App.xa.jb.Yc.contentReplicator);this.sqb.execute(Mb=>{Mb.flush(kb,1)});this.NMg=!0}}xui(Q,ya,kb,Mb,vc,id){this.hVg&&(ya=ya.oql())&&(ya.RevisionId=Q,ya.LRTWR=kb,ya.LSTWR=Mb,ya.TSD=vc,ya.UIWR=id,this.uya&&this.uya.track(ya))}}Object(e.a)(ej,"InboundMonitor",null,[1985]);class dl{constructor(Q,
ya,kb,Mb){this.sA=ya;this.pgd=kb;this.n5j=Mb}create(Q,ya,kb,Mb,vc=null){return new ej(this.pgd,this.sA,50,this.n5j,Q,ya,kb,Mb,vc)}}Object(e.a)(dl,"InboundMonitorFactory",null,[1955]);var ui=c(303);class hb{}hb.lie="UserCount";hb.aNn="RevisionChainLength";Object(e.a)(hb,"PerfTrackerPivotNames",null,[]);class Ab{}Object(e.a)(Ab,"PerfTrackingContext",null,[]);const Qb=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class uc{}Object(e.a)(uc,"SteppedInboundFrame",
null,[]);class Xc{constructor(Q,ya,kb,Mb,vc){this.sab=this.rgd=null;this.uOg=500;this.qgd=this.nra=this.Bsb=this.yTb=this.N9c=-1;this.Blg=null;this.S4g=this.K3g=!1;this.m3g=null;this.d_g=this.kKa=0;this.MVb=Q;this.createdTime=ya();this.Zpd=!1;this.YFe=0;this.eub=kb;this.BPj=Mb;this.Dsd=vc;F.AFrameworkApplication.K&&(this.uOg=F.AFrameworkApplication.K.pc("InboundFrameSamplingMinimalTotalTimeMs",500))}get F9d(){return this.K3g}get Vfc(){return this.S4g}get k_i(){return this.m3g}get s3a(){return this.kKa}get Ibn(){return this.d_g}get NAb(){return this.eub()}ofc(Q,
ya,kb,Mb){this.F9d||(this.Zpd=kb,this.YFe=ya,this.N9c=H.a.xU(da.a.Ye(),2),this.Blg=(new Date).toISOString(),this.sab=Q,this.d_g=Mb,this.K3g=!0,this.Vfc?this.DJh():(this.yej(),ia.a.instance.Ky(Q.toString()+"Start"),ui.a.instance.PYd(2)))}N3i(Q,ya,kb=null){this.Vfc||(this.kKa=ya,this.S4g=!0,this.m3g=Q,this.qgd=H.a.xU(da.a.Ye(),2),this.F9d&&(ia.a.instance.Ky(this.sab.toString()+"End"),kb&&(this.yTb=kb.IJn,this.Bsb=kb.D4a,this.nra=kb.DIn),ui.a.instance.Uyd(),this.DJh()))}oql(){if(!(0<this.N9c&&0<this.yTb&&
0<this.Bsb&&0<this.nra&&0<this.qgd))return null;const Q=new uc;Q.TT=H.a.xU(this.qgd-this.N9c,2);if(Q.TT<this.uOg)return null;Q.ST=this.Blg;Q.UC=this.NAb;Q.RS=H.a.xU(this.yTb-this.N9c,2);Q.SR=H.a.xU(this.Bsb-this.yTb,2);Q.RRS=H.a.xU(this.nra-this.Bsb,2);Q.RP=H.a.xU(this.qgd-this.nra,2);Q.ResponseLanded=H.a.xU(this.Bsb,2);0<Q.RS?(ia.a.instance.KX("RTCToRequestSent",this.sab.toString()+"Start","RequestInvoked"+this.yTb),ia.a.instance.KX("RequestSentToResponseReceived","RequestInvoked"+this.yTb,"RequestCompleted"+
this.Bsb),ia.a.instance.KX("ResponseReceivedToReplicationStart","RequestCompleted"+this.Bsb,"ReplicationStart"+this.nra)):ia.a.instance.KX("RTCToReplicationStart",this.sab.toString()+"Start","ReplicationStart"+this.nra);ia.a.instance.KX("Replication","ReplicationStart"+this.nra,this.sab.toString()+"End");return Q}yej(){this.rgd=this.MVb.create();this.rgd.start(jg.f0i,jg.kmj)}DJh(){this.rgd||this.yej();const Q=this.rgd.end(this.Zpd,this.XVk());this.BPj.L8d(Q);this.Dsd.L8d(Q+this.YFe)}XVk(){const Q=
{};Q[hb.lie]=Qb(this.NAb);var ya=this.k_i.length;Q[hb.aNn]=9>=ya?ya.toString():"10AndAbove";return Object.assign(new Ab,{P:Q,FC:this.s3a,CFC:this.Ibn+this.s3a,ID:this.sab.toString(),CD:this.YFe,UC:this.NAb,RCL:this.k_i.length})}}Object(e.a)(Xc,"InboundOperation",null,[1983]);class xd{constructor(Q,ya,kb){this.XIa=Q;this.jUa=ya;this.eub=kb}create(Q,ya){return new Xc(this.XIa,this.jUa,this.eub,Q,ya)}}Object(e.a)(xd,"InboundOperationFactory",null,[1956]);class de{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee){this.$pd=
!0;this.f0g=this.zmd=null;this.vO=jf=>{this.pj.vO(6,jf)};this.XFe=Q;this.NKj=ya;this.NYj=kb;this.pj=Mb;this.BPe=vc.create("TypingToOutboundReplicationStart",id,ae,20,!1);this.bJe=vc.create("OutboundReplicationStartToOutboundReplicationEnd",we,Ee,20,!1)}get bQf(){return this.zmd}get Z3d(){return this.f0g}Q6c(){!this.bQf&&this.$pd&&(this.$pd=this.NKj())&&(this.zmd=this.XFe.create(this.vO,this.NYj(),this.BPe,this.bJe),this.bQf.Q6c())}G0c(){this.$pd=!0;this.f0g=this.bQf;this.Z3d&&(this.zmd=null,this.Z3d.G0c())}JYf(){this.zmd=
null}E0c(Q,ya){this.Z3d&&this.Z3d.E0c(Q,ya)}}Object(e.a)(de,"OutboundMonitor",null,[]);class Dd{constructor(Q,ya){this.XFe=Q;this.FXj=ya}create(Q,ya,kb,Mb,vc,id,ae){return new de(this.XFe,Q,ya,kb,this.FXj,Mb,vc,id,ae)}}Object(e.a)(Dd,"OutboundMonitorFactory",null,[]);var ee=c(61);class vf{constructor(Q){this.Jab=Q}get Lsn(){return this.Jab}ub(Q){return!!this.Jab&&Q in this.Jab}get zpi(){return this.ub(vf.wEd)&&this.ub(vf.pLb)&&this.ub(vf.Y4f)}get revisionId(){if(this.ub(vf.pLb))return ee.a.Gf(this.Jab[vf.pLb]);
throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get q9d(){if(this.ub(vf.pLb))return this.Jab[vf.pLb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get VIi(){if(this.ub(vf.wEd))return Number.parseInvariant(this.Jab[vf.wEd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get X$i(){if(this.ub(vf.pLb))return Boolean.parse(this.Jab[vf.Y4f]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");
}get s3a(){if(this.ub(vf.lJf))return Number.parseInvariant(this.Jab[vf.lJf]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static qTk(Q){return new vf(Q)}static uTk(Q,ya,kb,Mb){const vc={};vc[vf.wEd]=Q.toString();vc[vf.pLb]=ya.toString();vc[vf.Y4f]=kb.toString();vc[vf.lJf]=Mb.toString();return new vf(vc)}}vf.pLb="RevisionID";vf.wEd="Duration";vf.Y4f="ShouldSample";vf.lJf="NumSequentialFailures";Object(e.a)(vf,"ReplicationNotificationMessage",null,[1987]);
class eg{constructor(Q,ya,kb,Mb,vc,id,ae){this.Qr=this.Fi=0;this.uub=this.mzc=null;this.Sle=[];this.e1g=null;this.Hdd={};this.kKa=0;this.MVb=Q;this.f1j=ya;this.jUa=kb;this.eub=Mb;this.O5g=vc;this.sab=null;this.Hdd.TypingStartStage=null;this.Hdd.ReplicationStartStage="TypingStartStage";this.Hdd.ReplicationEndStage="ReplicationStartStage";this.l$g=1<this.NAb;this.BPe=id;this.bJe=ae}get NAb(){return this.eub()}Q6c(){this.J_e("TypingStartStage")&&(this.KVf("TypingStartStage"),na.ULS.shipAssertTag(8257931,
324,!this.uub&&!this.Qr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.Fi=this.jUa(),this.mzc=this.MVb.create(),this.qej(this.mzc,jg.oso))}G0c(){if(this.J_e("ReplicationStartStage")){this.KVf("ReplicationStartStage");na.ULS.shipAssertTag(8257932,324,!!this.mzc,"TypingStart not called");if(this.mzc){const Q=this.yJh(this.mzc,this.sab);this.BPe.L8d(Q)}this.uub=this.MVb.create();this.qej(this.uub,jg.Jbn)}}E0c(Q,ya){this.J_e("ReplicationEndStage")&&(this.KVf("ReplicationEndStage"),
this.Qr=this.jUa(),this.kKa=ya,na.ULS.shipAssertTag(8257933,324,!!this.uub,"ReplicationStart not called"),this.uub&&(na.ULS.shipAssertTag(8193425,324,!!this.uub,"ReplicationStart not called"),ya=this.yJh(this.uub,Q),this.bJe.L8d(ya)),na.ULS.shipAssertTag(8257934,324,!!this.Fi,"StartTime not set. No message sent to other editors."),this.Fi&&(Q=vf.uTk(this.Qr-this.Fi,Q,this.O5g,this.kKa),this.f1j(Q.Lsn)))}J_e(Q){if(this.Hdd[Q]===this.e1g)return!0;na.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.b9j()});
return!1}b9j(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let ya=0;ya<this.Sle.length;ya++)Q.append(" "+this.Sle[ya]);return Q.toString()}KVf(Q){this.Sle.push(Q);this.e1g=Q}qej(Q,ya){this.l$g&&Q.start(ya)}yJh(Q,ya){if(!this.l$g)return-1;const kb={};kb[hb.lie]=Qb(this.NAb);ya=Object.assign(new Ab,{P:kb,FC:this.kKa,CFC:0,ID:ya?ya.toString():"",CD:0,UC:this.NAb,RCL:0});return Q.end(this.O5g,ya)}}Object(e.a)(eg,"OutboundOperation",null,[1986]);class $b{constructor(Q,ya,kb){this.MVb=Q;
this.jUa=ya;this.eub=kb}create(Q,ya,kb,Mb){return new eg(this.MVb,Q,this.jUa,this.eub,ya,kb,Mb)}}Object(e.a)($b,"OutboundOperationFactory",null,[1957]);class Hd{constructor(Q,ya){this.QEg=this._name=this.T1=null;this.je=Q;this.uya=ya}start(Q,ya=null){this.T1=this.je.jg("UserAction",Q);this._name=Q;this.QEg=ya}end(Q,ya){let kb=-1;Q&&(kb=this.T1.vi,ya.D=kb,ya.CN=this.QEg,ya.CD+=kb,this.uya.track(ya,this._name));return kb}}Object(e.a)(Hd,"PerfTracker",null,[1984]);class $f{constructor(Q,ya){this.je=
Q;this.uya=ya}create(){return new Hd(this.je,this.uya)}}Object(e.a)($f,"PerfTrackerFactory",null,[1954]);class xi{constructor(Q,ya,kb){this.pvc=null;this.EXj=Q;this.yOg=ya;this.D1g=kb}init(Q,ya,kb,Mb,vc,id,ae){ya=this.D1g.create(ya/100);kb=this.D1g.create(kb/100);this.pvc=this.EXj.create(Object(a.a)(ya,ya.zMb,"shouldBeInSample"),Object(a.a)(kb,kb.zMb,"shouldBeInSample"),Q,Mb,vc,id,ae)}Q6c(){this.pvc.Q6c()}G0c(){this.pvc.G0c()}JYf(){this.pvc.JYf()}E0c(Q,ya){this.pvc.E0c(Q,ya)}Ham(Q,ya,kb=null){this.yOg.CIn(Q,
ya,kb)}ofc(Q){Q=vf.qTk(Q);this.yOg.ofc(Q);ia.a.instance.Ky(Q.revisionId+"Start")}omo(Q,ya,kb){w.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.BBd(Q,ya,kb))}nmo(Q,ya,kb){w.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.BBd(Q,ya,kb))}BBd(Q,ya,kb){const Mb={};Mb.PhaseName=Q;Mb.ThresholdValue=ya;Mb.ActualValue=kb;return Mb}}Object(e.a)(xi,"ReplicationTelemetryManager",null,[]);var Qe=c(935);class Wm extends Qe.a{constructor(Q,ya){super(Q,
ya);this.gj=this.Xqd=0}Rwa(Q){this.Xqd+=Q;this.gj++}getValue(){return this.gj?this.Xqd/this.gj:0}zRa(){this.gj=this.Xqd=0}}Object(e.a)(Wm,"AverageMetric",Qe.a,[]);class ph extends Qe.a{constructor(Q,ya){super(Q,ya);this.J5=0}Rwa(Q){Q>this.J5&&(this.J5=Q)}getValue(){return this.J5}zRa(){this.J5=0}}Object(e.a)(ph,"MaxMetric",Qe.a,[]);var mj=c(1824);class Xn extends Qe.a{constructor(Q,ya,kb=100){super(Q,ya);this.Njd=this.fVb=this.AXb=0;this.Kod=kb;this.SJe=new mj.a(this.Kod)}Rwa(Q){if(this.fVb===this.Kod){const ya=
this.SJe.dequeue();this.AXb-=ya;this.fVb--}this.SJe.enqueue(Q);this.AXb+=Q;this.fVb++;Q=this.AXb/this.fVb;Q>this.Njd&&this.fVb===this.Kod&&(this.Njd=Q)}getValue(){return this.Njd}zRa(){this.Njd=0;this.SJe=new mj.a(this.Kod);this.fVb=this.AXb=0}}Object(e.a)(Xn,"MaxRollingAverageMetric",Qe.a,[]);class mf extends Qe.a{constructor(Q,ya){super(Q,ya);this.gj=0}Rwa(){this.gj++}getValue(){return this.gj}zRa(){this.gj=0}}Object(e.a)(mf,"CounterMetric",Qe.a,[]);class Ba{constructor(Q,ya){this.zYb=ya;this.ine=
new Wm(Q+"-AverageValue","Milliseconds");this.lDe=new ph(Q+"-MaxValue","Milliseconds");this.sDe=new Xn(Q+"-MaxRollingAverageValue","Milliseconds");this.pqe=new mf(Q+"-NumberOfEvents","Count");this.Jra=new qa.a(Q+"-SlowPercentileAtValue","Percentile",F.AFrameworkApplication.K.$P("CoAuthLatencySlowTargetValue",3E3),F.AFrameworkApplication.K.$P("CoAuthLatencySlowThresholdPercentile",95),this.zYb);this.hHe=new qa.a(Q+"-BrokenSlowPercentileAtValue","Percentile",F.AFrameworkApplication.K.$P("CoAuthLatencyBrokenSlowTargetValue",
5E3),F.AFrameworkApplication.K.$P("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.zYb)}J_(Q){this.ine.Rwa(Q);this.lDe.Rwa(Q);this.sDe.Rwa(Q);this.pqe.Rwa(Q);this.Jra.Rwa(Q);this.hHe.Rwa(Q)}q7d(){this.ine.cRa();this.lDe.cRa();this.sDe.cRa();this.pqe.cRa();this.Jra.cRa();this.hHe.cRa();this.ine.zRa();this.lDe.zRa();this.sDe.zRa();this.pqe.zRa();this.Jra.zRa();this.hHe.zRa()}}Object(e.a)(Ba,"ReplicationLatencyMetrics",null,[]);class ub{constructor(){this.VBe=new fc.a}oSi(Q,ya,kb){if(!(0>ya)){if(!({value:Mb}=
this.VBe.Gc(Q,Mb)).returnValue){var Mb=new Ba(Q,kb);this.VBe.Z(Q,Mb)}Mb.J_(ya)}}q7d(){for(const Q of this.VBe.values)Q.q7d()}}Object(e.a)(ub,"ReplicationTelemetryMetricsManager",null,[1953]);class ic{oSi(){}q7d(){}}Object(e.a)(ic,"ReplicationTelemetryMetricsManagerStub",null,[1953]);class Hc{constructor(Q,ya,kb,Mb,vc,id,ae){this.iXa=this.msd=0;this.TUj=Q;this.kHe=kb;this.v8g=Mb;this.FBg=vc;this.PXb=ya;this.UUj=id;this.zYb=ae}L8d(Q){this.TUj.oSi(this.kHe,Q,this.zYb);Q>this.v8g&&this.PXb.Xlo(this.kHe,
this.v8g,Q);this.msd+=Q;this.iXa++;this.msd/this.iXa>this.FBg&&this.iXa>this.UUj&&this.PXb.eqk(this.kHe,this.FBg,this.msd/this.iXa)}}Object(e.a)(Hc,"TimeSpanVerifier",null,[1982]);class Vb{constructor(Q,ya){this.N_j=Q;this.PXb=ya}create(Q,ya,kb,Mb,vc){return new Hc(this.N_j,this.PXb,Q,ya,kb,Mb,vc)}}Object(e.a)(Vb,"TimeSpanVerifierFactory",null,[1952]);class Ud extends Sys.EventArgs{constructor(Q,ya,kb){super();this.MXi=Q;this.zfe=ya;this.actualValue=kb}}Object(e.a)(Ud,"TimeSpanVerifierEventArgs",
Sys.EventArgs,[]);class Cc{constructor(){this.sa=new k.a}Xlo(Q,ya,kb){this.sa.raiseEvent("TSVTE",new Ud(Q,ya,kb))}eqk(Q,ya,kb){this.sa.raiseEvent("TSVATE",new Ud(Q,ya,kb))}Ufk(Q){this.sa.addHandler("TSVTE",Q)}Nek(Q){this.sa.addHandler("TSVATE",Q)}}Object(e.a)(Cc,"TimeSpanVerifierNotifier",null,[1938]);class Te{constructor(){this.W=this.Ma=null}get name(){return"Box4.ReplicationTelemetry"}xc(Q){this.Ma=Q.resolve("Common.IAppSettingsManager");this.W=Q;if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){Q.ha("ReplicationTelemetry.IPerfTrackerFactory",
()=>new $f(If.App.xa.tq,R.a.sE(20,1,new W.a))).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Cc).singleInstance();this.Ma.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new ub).singleInstance():Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new ic).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Vb(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),
Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();Q.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new $b(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Te.lWh)).singleInstance();Q.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Dd(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();Q.ha("ReplicationTelemetry.InboundOperationFactory",()=>
new xd(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Te.lWh)).singleInstance();var ya=new dl(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),kb=this.Ma.$("ComponentStateLoggingPackageIsEnabled")?this.W.Za("Common.IComponentStateLogManager"):null;Q.ha("ReplicationTelemetry.IInboundMonitor",()=>ya.create(this.Ma.pc("Box4ReplicationTelemetryInboundOperationThreshold",
0),this.Ma.pc("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Ma.pc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ma.pc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),kb)).singleInstance();Q.ha("Common.IRandomSamplerFactory",()=>new Uk).singleInstance();Q.ha("ReplicationTelemetry.ReplicationTelemetryManager",()=>new xi(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).singleInstance();
Q.ha("ReplicationTelemetry.EventForwarderFactory",()=>new Kh(zf.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Ma.pc("Box4ReplicationTelemetrySamplePercent",0),ya=this.Ma.pc("Box4ReplicationTelemetryPhaseSamplePercent",0),kb=this.Ma.pc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Mb=this.Ma.pc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",
0),vc=this.Ma.pc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),id=this.Ma.pc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),ae=this;this.W.Za("Box4.Presence.IRtcProxyProvider").execute(Ee=>{Ee.GI().continueWith(()=>{const jf=Ee.GI().result,Ng=ae.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Ng.init(jf,Q,ya,kb,Mb,vc,id);ae.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(jf,Ng);if(ae.Ma.$("LogSteppedInboundFrameIsEnabled")){const Fg=
eo.a.sq(ae.W.Za("Common.ICpuMeterProvider"));Fg.continueWith(()=>{const ck=ae.W.resolve("ReplicationTelemetry.IInboundMonitor");var Ki=new Na.a(()=>!0);Ki=R.a.sE(19,1,Ki);ck.initialize(Ki);const Il=Fg.result.Op.task;Il.continueWith(()=>{Il.result.tud(0,()=>ck.JMe,wl=>{ck.K2m(wl)});Il.result.tud(1,wl=>ck.r7n(wl),()=>{ck.J2m()})})})}na.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var we=this;F.AFrameworkApplication.rJ(()=>{we.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").q7d()})}}dispose(){}static lWh(){const Q=
If.App.yd;return Q?Q.pIh:0}}Object(e.a)(Te,"ReplicationTelemetryPackage",null,[1,2]);var Ne=c(938),Sf=c(14),Ie=c(151),pg=c(3),ak=c(97),nn=c(67),Sl=c(233),ql=c(19),Pj=c(24),tm=c(10),mi=c(1957);class Wl{static get Hg(){return dh.a.Sy(Wl.am,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Wl.am="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(Wl,"InsertSymbolsDialogHtml",null,[]);class Ah extends mi.a{constructor(Q,ya,kb,Mb){super();this.AV=Mb;this.rUb=this.hLa=this.wbb=null;this.Txe=0;this.Zgm=vc=>{1===vc?(this.PLf("symbol_d_"+Ah.ftc),this.Vb.LK(this.oK,!0),this.Vb.Ks().Xj.vy(this.AG),this.AG.focus()):this.hide()};this.kgj=vc=>{if(vc.target!==this.rUb){const id=this.Vb.Ks();id&&id.Xj&&(id.Xj.vy(vc.target),this.rUb=vc.target)}this.Z8m(vc.target.id)};this.uio=vc=>{const id=vc.Bf;if("a"!==id.tagName.toLowerCase())return!1;vc.eventName===
A.a.IA&&this.PLf(id.id);this.Vb.LK(this.oK,!0);this.Vb.Ks().Xj.vy(id);id.focus();return!0};this.wio=vc=>{var id=vc.Bf;if("a"!==id.tagName.toLowerCase())return!1;const ae=parseInt(id.id.substr(id.id.lastIndexOf("_")+1));if(vc.Ib.ctrlKey||vc.Ib.altKey||vc.Ib.keyCode>=cf.a.NPb&&vc.Ib.keyCode<=cf.a.OPb)return!1;if(vc.eventName===A.a.hi){vc=vc.Ib.keyCode;let we=-1;vc===Sys.UI.Key.enter?(this.PLf(id.id),this.Vb.LK(this.oK,!0),this.Vb.Ks().Xj.vy(id),id.focus()):vc===Sys.UI.Key.up?we=ae-15:vc===Sys.UI.Key.down?
we=ae+15:vc===Sys.UI.Key.left?we=F.AFrameworkApplication.isRtl?ae+1:ae-1:vc===Sys.UI.Key.right&&(we=F.AFrameworkApplication.isRtl?ae-1:ae+1);0<=we&&(id=this.Zmf("symbol_d_"+we))&&id.focus()}return!0};this.ga=Q;this.Vb=ya;this.xbb=kb;this.Ue(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ue(0,CommonUIStrings.l_DialogClose);this.D9=!1;this.Hg=Wl.Hg;this.mg="InsertSymbolsDialog"}dispose(){0<Ah.ZOe&&na.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.Txe,Ah.ZOe);Ah.iHg++;na.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Ah.iHg);this.ga=this.xbb=null;super.dispose()}gSa(){this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.Zgm,null);this.Txe=0;Ah.oHg++;na.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Ah.oHg);const Q=this.Zmf("symbol_d_"+Ah.ftc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let ya=0;ya<Q.length;ya++)G.a.removeHandler(Q[ya],
A.a.focus,this.kgj);super.hide()}get ojb(){return Ah.ltc}set ojb(Q){Ah.ltc=Q}get kjb(){return Ah.$sc}set kjb(Q){Ah.$sc=Q}QX(){super.QX();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.xbb.Juk(),Q=Q.getElementsByTagName("a")))for(let ya=0;ya<Q.length;ya++)G.a.addHandler(Q[ya],A.a.focus,this.kgj)}Qka(){const Q=document.getElementById("symbolsContainer");Q&&(this.wbb||(this.wbb=this.uio,this.xq.mb(A.a.click,Q,this.wbb),this.xq.mb(A.a.IA,Q,this.wbb)),this.hLa||(this.hLa=this.wio,
this.ie.mb(A.a.hi,Q,this.hLa),this.ie.mb(A.a.St,Q,this.hLa),this.ie.mb(A.a.sh,Q,this.hLa)));super.Qka()}qeb(){const Q=document.getElementById("symbolsContainer");Q&&(this.wbb&&(this.xq.sc(A.a.click,Q,this.wbb),this.xq.sc(A.a.IA,Q,this.wbb),this.wbb=null),this.hLa&&(this.ie.sc(A.a.hi,Q,this.hLa),this.ie.sc(A.a.St,Q,this.hLa),this.ie.sc(A.a.sh,Q,this.hLa),this.hLa=null));super.qeb()}get Opf(){return this.AV?!0:!1}Z8m(Q){this.K7i("symbol_d_"+Ah.ftc,!1);Ah.ftc=parseInt(Q.substr(Q.lastIndexOf("_")+1));
this.K7i(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const ya=this.IMd(Ah.ftc);Q.innerText=ya.altText}}IMd(Q){const ya=this.xbb.wee.S8f.value,kb=ti.a(ya);return ya[kb[Q]]}PLf(Q){this.Txe++;Ah.ZOe++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const ya=this.IMd(Q),kb={};kb.SourceControlId="symbol_"+Q+"_"+ya.uee;this.ga.Ub(pg.a.Thb,2,kb);na.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}Zmf(Q){const ya=document.getElementById("symbolsContainer");return ya?
ya.querySelector("#"+Q):null}K7i(Q,ya){if(Q=this.Zmf(Q))ya?(Q.setAttribute("selected","true"),this.AV&&(Q.setAttribute("aria-selected","true"),Q.tabIndex=0)):(Q.removeAttribute("selected"),this.AV&&(Q.setAttribute("aria-selected","false"),Q.tabIndex=-1))}}Ah.ftc=0;Ah.ltc=null;Ah.$sc=null;Ah.oHg=0;Ah.iHg=0;Ah.ZOe=0;Object(e.a)(Ah,"InsertSymbolsDialog",mi.a,[]);class yd{constructor(Q,ya,kb,Mb,vc,id,ae){this.AVl=()=>this.xbb.Kvk();this.YPi=(we,Ee,jf,Ng,Fg)=>{if(1===jf)return 32;we=this.xbb.LKi(Fg);we=
String.format(this.xbb.vio,we.character);Fg[Ne.a.InnerHTML]=we;Fg[Ne.a.On]=!1;return 32};this.IOa=(we,Ee,jf,Ng,Fg)=>{if(({ye:we,selected:jf,IOa:Il}=this.XFc(Ee,jf)).returnValue)return Il;var ck=ql.SelectionEditor.pf(jf);let Ki=!0;jf=8;var Il=this.Ic.Qc(15);Il.Eb(we.jd);ck||(jf=this.ga.Tf(Ee,pg.a.Cla,2,!0,Ng,null),Ee=32===jf,na.ULS.shipAssertTag(6407387,348,Ee,"DeleteForReplace did not succeed. Response is {0}",jf),Ki=Ee);Ki&&(Ee=we.Bb.Lg,ck=ql.SelectionEditor.pf(Ee),na.ULS.shipAssertTag(6407388,348,
ck,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Ee.contextId),jf=8,ck&&(jf=this.ga.Tf(Ee,pg.a.Thb,2,!1,Ng,Fg),na.ULS.shipAssertTag(6407389,348,32===jf,"Insertion at IP context did not succeed. Response is {0}",jf),32===jf&&eh.FocusManager.instance().Dg(we.vI)));Il.dispose();return jf};this.Ygm=(we,Ee,jf,Ng,Fg)=>{if(1===jf)return 32;if(ql.SelectionEditor.u1a(Ee))return 2;we=this.xbb.LKi(Fg);Ng.Xr=we.index;Ng=this.Zc.ng(Ee.node);jf=Ng.Ab(11);na.ULS.shipAssertTag(6379466,
324,jf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Ie.a[Ee.node.type]);jf=this.Ic.Qc(15);jf.ev(Ng);yd.characterPropertiesEditor.replaceTextRange(Ee,we.character,!0,!1);Ee=Pj.SelectionFactory.we(Ng.currentNode,Ee.cpBegin+1);this.ib.setSelection(Ee);jf.dispose();return 32};this.AJb=(we,Ee,jf,Ng,Fg)=>{if(1===jf)return 32;Fg.MenuItems=this.a4j.value;return 32};this.lgj=(we,Ee,jf)=>{({IOa:we}=this.XFc(Ee,jf));return we};this.obj=(we,Ee,jf)=>{2===jf&&(new Ah(this.ga,eh.FocusManager.instance(),
za.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"),!!If.App.instance&&If.App.instance.Pva)).gSa();return 32};this.UTf=()=>32;this.ga=Q;this.Zc=ya;this.a4j=new fb.a(this.AVl);this.Ic=kb;this.xbb=Mb;this.Tk=vc;this.ib=id;this.Om=ae}Wb(){this.ga.gb(pg.a.UTf,Sf.a.application,this.UTf,96);this.ga.pa(pg.a.AJb,Sf.a.view,this.AJb);this.ga.pa(pg.a.vee,Sf.a.view,this.lgj);this.ga.pa(pg.a.y6d,Sf.a.view,this.YPi);this.ga.pa(pg.a.Thb,Sf.a.view,this.IOa);this.ga.pa(pg.a.AJb,Sf.a.Vc,this.AJb);this.ga.pa(pg.a.vee,
Sf.a.Vc,this.lgj);this.ga.pa(pg.a.y6d,Sf.a.Vc,this.YPi);this.ga.pa(pg.a.Thb,Sf.a.Vc,this.Ygm);this.ga.Xc(pg.a.AJb,1124);this.ga.Xc(pg.a.vee,1036);this.ga.Xc(pg.a.y6d,1124);this.ga.Xc(pg.a.Thb,1036);F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.pa(pg.a.pPc,Sf.a.view,this.obj),this.ga.pa(pg.a.pPc,Sf.a.Vc,this.obj),this.ga.Xc(pg.a.pPc,1124))}XFc(Q,ya){let kb,Mb=null;Q.view.ue&&(Mb=Q.view);kb=null;if(!Mb||!Mb.Bb)return w.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",
Q.toString()),{returnValue:!0,ye:Mb,selected:kb,IOa:8};kb=Mb.Bb.Lg;if(!kb)return{returnValue:!0,ye:Mb,selected:kb,IOa:2};if(this.Tk.xZ(kb)||this.Tk.uva(kb))return{returnValue:!0,ye:Mb,selected:kb,IOa:8};if(Mb.Bb.hb.YI||this.Om&&this.Om.instance&&this.Om.instance.PT(kb)||ql.SelectionEditor.u1a(Q.Yj))return{returnValue:!0,ye:Mb,selected:kb,IOa:2};if(yd.Yg.lya(tm.ParagraphReader.MT,kb))return Q=8,yd.Mc.fc(ak.a.vf,{["Reason"]:nn.a.BN}),{returnValue:!0,ye:Mb,selected:kb,IOa:Q};Q=32;return 1===ya?{returnValue:!0,
ye:Mb,selected:kb,IOa:Q}:{returnValue:!1,ye:Mb,selected:kb,IOa:Q}}static get characterPropertiesEditor(){return yd.Rd||(yd.Rd=za.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){yd.Rd=Q}static get Yg(){return Sl.ContextSetEditor.instance}static get Mc(){return Kd.a.instance}}yd.Rd=null;Object(e.a)(yd,"SymbolsActor",null,[1919]);class Jd{constructor(Q,ya){this.uee=Q;this.altText=ya}}Object(e.a)(Jd,"Symbol",null,[]);class Se{constructor(){this.BNe=null;
this.G7g=new fb.a(Se.s5e)}get S8f(){return this.G7g}wZh(Q){this.BNe||(this.BNe=ti.a(this.G7g.value));return Array.indexOf(this.BNe,Q)}static s5e(){const Q={};Q["\u2022"]=new Jd("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Jd("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Jd("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Jd("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Jd("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Jd("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);
Q["\u2122"]=new Jd("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Jd("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Jd("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Jd("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Jd("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Jd("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Jd("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Jd("\u221e",
Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Jd("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Jd("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Jd("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Q["\u03c0"]=new Jd("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Jd("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Jd("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Jd("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);
Q["\u0394"]=new Jd("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Jd("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Jd("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Jd("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Q["\u00bf"]=new Jd("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Jd("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Jd("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Jd("\u2026",
Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Jd("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Jd("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Jd("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Q["\u00c3"]=new Jd("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Jd("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Jd("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);
Q["\u00c6"]=new Jd("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Jd("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Jd("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Jd("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Jd("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Jd("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=
new Jd("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Jd("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Jd("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Jd("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Q["\u00d1"]=new Jd("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Jd("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Jd("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Jd("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Jd("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Jd("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=new Jd("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Jd("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Jd("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);
Q["\u00dc"]=new Jd("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Jd("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Jd("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Jd("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Jd("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Jd("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Jd("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Jd("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Jd("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Jd("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Q["\u00e8"]=new Jd("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Jd("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Jd("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
Q["\u00eb"]=new Jd("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Jd("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Jd("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Jd("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Jd("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Jd("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Jd("\u00f2",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Jd("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Jd("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Jd("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Q["\u00f6"]=new Jd("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Jd("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Jd("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);
Q["\u00fb"]=new Jd("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Jd("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Jd("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=new Jd("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Jd("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Jd("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=
new Jd("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Jd("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Jd("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Jd("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Q["\u015f"]=new Jd("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Jd("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(e.a)(Se,"SymbolsLoader",
null,[1917]);var be=c(443),el=c(357),fj=c(214),Hh=c(653),Fm=c(1436),ri=c(239),Mh=c(95);class Fi{constructor(Q,ya){this.AV=ya;this.wee=Q}get vio(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}LKi(Q){Q=Q.SourceControlId.split("_");const ya={};2===Q.length?(ya.character=Q[1],ya.index=this.wee.wZh(ya.character)):(ya.character=Q[2],ya.index=parseInt(Q[1]));return ya}Kvk(){return this.j5h()}build(){return this.BVl()}Juk(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');
const ya=this.wee.S8f.value,kb=ti.a(ya);let Mb=0;for(;Mb<kb.length;){Mb%15||Q.append('<tr role="presentation">');const vc=ya[kb[Mb]];Q.append(String.format(this.AV?'<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>':'<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Mb,qb.a.UZ(vc.uee),qb.a.UZ(vc.altText)));Mb++;Mb%15&&Mb!==kb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}BVl(){const Q=this.j5h();return ri.q(Q)}j5h(){const Q=Object.assign(new be.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.Vck());F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.Yak());return Q}Yak(){const Q=Object.assign(new el.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),ya=Object.assign(new fj.a,{Id:"btnMoreSymbols",Command:pg.a.pPc.toString(),LabelText:qb.a.Cf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:qb.a.Cf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:F.AFrameworkApplication.Cr,Image16by16Class:Mh.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(ya);return Q}Vck(){const Q=Object.assign(new el.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
ya=Object.assign(new Hh.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),kb=this.wee.S8f.value,Mb=ti.a(kb),vc=Math.min(25,Mb.length);for(let ae=0;ae<vc;ae++){var id=kb[Mb[ae]];id=Object.assign(new Fm.a,{Id:String.format("{0}{1}_{2}","symbol_",ae,id.uee),Character:id.uee,Command:pg.a.Thb.toString(),QueryCommand:pg.a.y6d.toString(),Alt:qb.a.Cf(id.altText)});ya.GalleryItems.push(id)}Q.ControlList.push(ya);
return Q}}Object(e.a)(Fi,"SymbolsUiBuilder",null,[1918]);var rp=c(54),kh=c(248),cr=c(658),dg=c(395);class Kf{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){F.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Wb()}dispose(){}xc(Q){this.W=Q;this.W.register(Se,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new Fi(this.W.resolve("Box4.Symbols.ISymbolsLoader"),
!!If.App.instance&&If.App.instance.Pva)).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();this.W.ha("Box4.Symbols.SymbolsActor",()=>new yd(F.AFrameworkApplication.ya,new cr.a,new dg.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),kh.a.instance,rp.a.instance,this.W.Za("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){ca.a.instance.Kc(new Kf)}}Object(e.a)(Kf,"Box4SymbolsPackage",null,[1,2]);var yi=window.AccCheckerPaneData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},nf=c(1579),Bb=c(1538),Ec=c(1525),sd=c(1875),Ce=c(208),Ue=c(444);class Mf{constructor(){this.QHa=null}xc(Q){this.container=Q}init(){this.QHa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.QHa&&
this.QHa.dispose()}}Object(e.a)(Mf,"ALiveBooksAccessibilityCheckPackageManager",null,[1,2]);class Tg{get WNk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get XNk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get YNk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Fbn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Jcc(){return CommonUIStrings.l_AccCheckerPaneTitle}get hfn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(e.a)(Tg,"AccessibilityCheckStringsProvider",null,[63]);class Nh{constructor(){this.l0i=this.contentId=null}}Object(e.a)(Nh,"ResultIds",null,[]);class Vk{constructor(Q,ya){this._element=null;this.qg=ya;this.ie=Q}get element(){this._element||(this._element=this.ESk(),this.jz());return this._element}O3f(Q){this._element=Q}dispose(){this.element&&(this.d9(),this.O3f(null))}jz(){this.qg&&this.ie?(this.qg.mb(A.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ie.mb(A.a.hi,this.element,
Object(a.a)(this,this.gG,"onKeyPress"))):na.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}d9(){this.qg&&this.ie&&(this.qg.sc(A.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ie.sc(A.a.hi,this.element,Object(a.a)(this,this.gG,"onKeyPress")))}onClick(){this.e1d();return!0}gG(Q){return this.drm(Q.Ib.keyCode)?(this.e1d(),!0):!1}drm(Q){return Q===cf.a.sie||Q===cf.a.us}}
Object(e.a)(Vk,"AInteractivePaneElement",null,[94,9]);var qd=c(478),Wg=c(49);class $g extends Vk{constructor(Q,ya,kb){super(Q,ya);this.hFe=kb}hide(){this.element.removeAttribute(nb.a.wh);nb.a.Tq(this.element,nb.a.Mz,nb.a.ep);this.element.style.display="none"}show(){nb.a.Tq(this.element,nb.a.Mz,nb.a.AL);nb.a.Tq(this.element,nb.a.wh,nb.a.hWe);this.element.style.display="block"}ESk(){const Q=qd.b("div",this.bBi,"AccCheckerNotification");nb.a.Tq(Q,nb.a.Cjh,nb.a.ep);nb.a.Tq(Q,nb.a.qea,this.WIf);Q.tabIndex=
0;const ya=qd.b("span",this.aBi,"AccCheckerNotificationIcon");var kb=Mh.createClusteredImage(16,16,"Info_16x16x32","",!0,"");ya.appendChild(kb);kb=qd.b("span",this.WIf,"AccCheckerNotificationText");Wg.a.oy(kb,this.cBi);Q.appendChild(ya);Q.appendChild(kb);return Q}e1d(){this.hFe()}}Object(e.a)($g,"APopupNotification",Vk,[751,94,9]);class Hg extends $g{constructor(Q,ya,kb,Mb){super(Q,ya,kb);this.bsa=Mb}get bBi(){return"AccCheckerOutOfSyncNotificationId"}get aBi(){return"AccCheckerOutOfSyncNotificationIconId"}get WIf(){return"AccCheckerOutOfSyncNotificationTextId"}get cBi(){return this.bsa.Fbn}}
Object(e.a)(Hg,"OutOfSyncNotification",$g,[]);class oc extends $g{constructor(Q,ya,kb,Mb){super(Q,ya,kb);this.bsa=Mb}get bBi(){return"AccCheckerPartialResultNotificationId"}get aBi(){return"AccCheckerPartialResultNotificationIconId"}get WIf(){return"AccCheckerPartialResultNotificationTextId"}get cBi(){return this.bsa.hfn}}Object(e.a)(oc,"PartialResultNotification",$g,[]);var Tl=c(142),ni=c(28),di=c(181);class Yg{constructor(Q,ya,kb,Mb=null,vc=null,id=null,ae=null){this.U2g=this.rL=this.ie=this.QHa=
null;this.Lna=Mb;this.qg=Q;this.Vb=ya;this.Zo=kb;this.bsa=ae||new Tg;this.VFe=vc||new Hg(this.Lna,this.qg,Object(a.a)(this,this.Z4k,"dimissOutOfSyncNotification"),this.bsa);this.NGe=id||new oc(this.Lna,this.qg,Object(a.a)(this,this.$4k,"dimissPartialResultNotification"),this.bsa)}show(){}hide(){}get Lna(){return this.ie||(this.ie=F.AFrameworkApplication.ta.uy)}set Lna(Q){this.ie=Q}ezh(){}Tma(){}dispose(){}y6a(){}Wim(Q){var ya=this.U2g[Q];Q=ya.contentId;if((ya=ya.l0i+"")&&ya.length){const kb=[];Array.add(kb,
Object.assign(new ni.a,{name:"RuleID",string:ya}));Tl.a.sendTelemetryEvent(Object.assign(new di.a,{name:String.format("{0}.{1}",Yg.L9f,"ViolationSelected"),dataFields:kb}))}this.XWm(Q)}XWm(Q){Q&&this.QHa.BXn(Q)||(this.Vb.LK(of.AFrame.Tah,!1),this.A9n())}Z4k(){this.S3c(!1)}$4k(){this.fbj(!1)}A9n(){const Q=Object.assign(new De.StandardDialog(!0),{Qt:F.AFrameworkApplication.Qaa,Ed:1,yGa:!1});Q.DU(1);Q.Ue(1,this.bsa.WNk);Q.Ue(0,CommonUIStrings.l_DialogCancel);Q.GU(this.bsa.YNk,this.bsa.XNk,ya=>{1===ya&&
this.Jtf()})}Qvk(Q){let ya=null;if(Q.Results&&0<Q.Results.length){ya={};let kb=0;for(const Mb of Q.Results)Mb.ResultId=Yg.f8j+ ++kb,Q=new Nh,Q.contentId=Mb.ContentId,Q.l0i=Mb.RuleId,ya[Mb.ResultId]=Q}return ya}tNm(){Tl.a.addNamespaceMapping(Yg.L9f,Yg.Iko);Tl.a.sendTelemetryEvent(Object.assign(new di.a,{name:String.format("{0}.{1}",Yg.L9f,"ShowTaskpane")}))}}Yg.f8j="AccCheckResult";Yg.L9f="Office.UX.AccChecker";Yg.Iko="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(Yg,
"BaseAccessibilityCheckPane",null,[65,9]);class Bh{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(Bh,"AccCheckerTaskPaneProps",null,[]);var uh=c(1363),ld=c(1377),fl=c(1025),fg=c(160);class Xg extends Yg{constructor(Q,ya,kb,Mb,vc=null,id=null,ae,we=null,Ee=null){super(ya,
kb,Mb,id,void 0,void 0,we);this.Ozg=null;this.I1g=this.MGe=this.Ild=this.fpd=this.zod=!1;this.ZPe=null;this.WNe=!!F.AFrameworkApplication.ta&&!!F.AFrameworkApplication.ta.Pb&&F.AFrameworkApplication.ta.Pb.Oyf;this.dqc=this.N4=null;this.Rqc=0;this.wfd=null;this.oY=vc;Ee&&(this.N4=Ee.Ytd,this.dqc=Ee.zTo,this.Rqc=Ee.IUo);this.xA=new ld.a}get isVisible(){return this.I1g}dSa(Q){this.I1g=Q}k9e(Q){Q&&(this.Ozg=Q,Q.IsSuccess&&(this.U2g=this.Qvk(Q),Q.IsPartialResult&&this.fbj(!0)),this.zod=!0,this.fpd=!1,
this.ym())}S3c(Q){this.isVisible&&Q!==this.Ild&&(this.Ild=Q,this.ym())}fbj(Q){this.MGe=Q;this.ym()}wO(){this.fpd||fg.UISurfaces.wu().then(Q=>{ia.a.instance.Ky(Xg.wpb+":PaneOpen:Start");Q.showTaskPane(Xg.wpb,this.Pz());this.Jtf();return null});this.isVisible?fg.UISurfaces.wu().then(Q=>{Q.setSelectedTaskPane(Xg.wpb);return null}):this.tNm()}ym(){fg.UISurfaces.wu().then(Q=>{Q.updateTaskPane(Xg.wpb,this.Pz());return null})}Pz(){var Q=new Bh;this.xA.gMb(Q);Q=Object.assign(new fl.a,{title:this.bsa.Jcc,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.D8();this.dSa(!0);F.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.kca();this.dSa(!1);this.fpd=this.zod=!1;this.ym();F.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.WNe&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const ya=this.Vb.le(Xg.wpb);ya.parent=of.AFrame.Hp;ya.BK=!0;this.QHa=Q;this.f9j()}dispose(){this.y6a();this.VFe&&(this.VFe.dispose(),this.VFe=null);
this.NGe&&(this.NGe.dispose(),this.NGe=null);super.dispose()}f9j(){this.xA.MK(this.onRecheckExecute());this.xA.MK(this.Wql());this.xA.MK(this.yRl());this.xA.MK(this.onInvokeNavigateExecute());this.xA.MK(this.fFl());this.xA.MK(this.KMl());this.xA.MK(this.DOl());this.xA.MK(this.updateLastScanTime());this.xA.MK(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.Jtf()}}}Wql(){return Q=>{Q.accessibilityCheckResultCollection=this.Ozg}}yRl(){return Q=>{Q.resultsReady=this.zod}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=ya=>{this.Wim(ya)}}}fFl(){return Q=>{Q.helpLink=this.dfl}}KMl(){return Q=>{Q.outOfSync=this.Ild}}DOl(){return Q=>{Q.partialResult=this.MGe}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=ya=>{this.ZPe=ya}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{F.AFrameworkApplication.K&&F.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?F.AFrameworkApplication.rI||this.njh()?this.wfd?this.wfd():this.N4.value&&this.dqc&&
this.Rqc&&this.N4.value.Ub(this.Rqc,2,this.dqc):this.dcj():this.njh()?this.wfd?this.wfd():this.N4.value&&this.dqc&&this.Rqc&&this.N4.value.Ub(this.Rqc,2,this.dqc):this.dcj()}}}njh(){return!this.oY||!this.oY.value}dcj(){const Q=this.oY.value;if(Q){var ya={};ya.query=Xg.UZj+Xg.AOj;ya=Object.assign(new uh.a,{NX:ya});Q.sca(Xg.rwe,ya)}}Jtf(){this.MGe=this.Ild=this.zod=!1;this.ZPe&&this.ZPe();this.ym();this.fpd=!0;this.QHa.J1m()}D8(){this.Vb.Dg(Xg.wpb)}kca(){this.i2a()&&this.Vb.Dg(this.Vb.QS)}i2a(){return!!this.Vb.currentScope&&
this.Vb.currentScope.name===Xg.wpb}}Xg.wpb="AccessibilityCheckerPane";Xg.AOj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Xg.rwe="FA000000012";Xg.UZj="AssetID=";Object(e.a)(Xg,"ReactAccessibilityCheckPane",Yg,[]);class Xf extends Xg{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee=null){super(Q,ya,kb,Mb,vc,id,void 0,Ee);this.gLj=we;this.Y1=ae}get dfl(){return this.gLj}wO(){this.Y1.yMa();super.wO()}}Object(e.a)(Xf,"ReactLiveBooksAccessibilityCheckPane",Xg,[]);var Hp=c(1124),gm=c(139),Ig=c(184),Bk=c(74),zi=c(159),Lc=
c(528),nh;(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(nh||(nh={}));Object(e.b)("AccessibilityRuleCategory",nh);class Sd{constructor(Q,ya,kb=null){this.sle=null;this.cRg=this.MPg=!1;this.zLa=Q;this.S9c=ya;this.ga=kb;this.Bc.pa(Ua.a.BHk,We.a.frame,Object(a.a)(this,this.T0e,"closePane"))}get Bc(){return this.ga||(this.ga=F.AFrameworkApplication.ya)}set Bc(Q){this.ga=Q}mbl(){this.MPg||(this.zLa.initialize(this),this.S9c.initialize(this),
this.MPg=!0)}J1m(){w.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.S9c.lOn()}wO(Q,ya,kb){if(1===kb)return rf.SessionStatusManager.instance.zj?8:32;this.zLa.isVisible||this.mbl();this.Z$n();return 32}T0e(Q,ya,kb){1!==kb&&this.zLa.Tma();return 32}m8m(){this.zLa.S3c(!0)}k9e(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const kb=Q.AccessibilityRules;for(let Mb in kb){var ya=Mb;const vc=kb[Mb].RuleId+"";ya!==vc&&w.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
ya,vc)}this.sle=kb}else!this.sle&&Q.Results&&0<Q.Results.length?(w.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.sle;Q.IsSuccess||w.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.PDn(Q);this.eNm(Q);this.zLa.k9e(Q)}}PDn(Q){const ya=Q.AccessibilityRules;if(Q=Q.Results)for(let kb=Q.length-1;0<=kb;kb--){const Mb=Q[kb];let vc="";const id=Mb.RuleId;Mb.ContentName||(vc+="Result does not have content name. ");id in ya||(vc+=String.format("No accessibility check rule exists for ID {0}.",
id));0<vc.length&&(w.b(36214999,200,15,"Omitting invalid accessibility check result: "+vc),Array.removeAt(Q,kb))}}HSl(){return F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):za.a.instance.resolve("Common.IDynamicScriptLoaderProvider").pA.loadScript("accessibility-checker-pane-strings")}Z$n(){this.cRg?this.zLa.wO():this.HSl().then(()=>{this.cRg=!0;this.zLa.wO()}).catch(Q=>na.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}eNm(Q){var ya={};const kb={};var Mb=Q.Results,vc=[];Array.add(vc,Object.assign(new ni.a,{name:"FinalViolationCount",int64:0}));Array.add(vc,Object.assign(new ni.a,{name:"FinalErrorCount",string:"0"}));Array.add(vc,Object.assign(new ni.a,{name:"FinalWarningCount",string:"0"}));Array.add(vc,Object.assign(new ni.a,{name:"FinalTipCount",string:"0"}));Array.add(vc,Object.assign(new ni.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Mb){for(const we of Mb)if(Q.AccessibilityRules){var id=Q.AccessibilityRules[we.RuleId];
if(id){if(ya[nh[id.Category]]){let Ee=ya[nh[id.Category]];ya[nh[id.Category]]=++Ee}else ya[nh[id.Category]]=1;kb[we.RuleId]?(id=kb[we.RuleId],kb[we.RuleId]=++id):kb[we.RuleId]=1}}vc[0].int64=Mb.length;for(var ae in ya)switch(Q=ya[ae],Mb=ae,Mb="Final"+Mb.charAt(0).toUpperCase()+Mb.substring(1,Mb.length)+"Count",Mb){case "FinalErrorCount":vc[1].string=Q.toString();break;case "FinalWarningCount":vc[2].string=Q.toString();break;case "FinalTipCount":vc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":vc[4].string=
Q.toString()}}Tl.a.sendTelemetryEvent(Object.assign(new di.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:vc}));for(let we in kb)ya=we,vc=kb[we],ae=[],Array.add(ae,Object.assign(new ni.a,{name:"RuleID",string:ya})),Array.add(ae,Object.assign(new ni.a,{name:"FinalViolationCount",string:vc.toString()})),Tl.a.sendTelemetryEvent(Object.assign(new di.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:ae}))}dispose(){this.zLa&&
this.zLa.dispose();this.S9c&&this.S9c.dispose()}}Object(e.a)(Sd,"AAccessibilityCheckManager",null,[62,9]);var je=c(330);const Bl=[12,14,22,19,30,43,44];class Pg extends Sd{constructor(Q,ya,kb,Mb,vc,id){super(ya,kb,Q);this.Bc.pa(Ua.a.q5f,We.a.frame,this.wO.bind(this));this.Bc.gb(Ua.a.yqn,We.a.frame,this.$Pi.bind(this),96);this.graph=vc;this.jVj=Mb;this.GRj=id;this.fcc=()=>{this.m8m()};this.tAn()}$Pi(Q,ya,kb,Mb,vc){if(1===kb)return 32;vc[je.a.On]=this.zLa.isVisible;return 32}BXn(Q){if(this.GRj)return na.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;na.ULS.shipAssertTag(20272215,334,!!Q);return this.jVj.RWm(Q)}tAn(){for(const Q of Bl){const ya=this.graph.Xe(Q);ya.Ap(this.fcc);ya.mu(this.fcc);ya.Mv(this.fcc)}}$to(){for(const Q of Bl){const ya=this.graph.Xe(Q);ya.YX(this.fcc);ya.vU(this.fcc);ya.yha(this.fcc)}}dispose(){super.dispose();this.$to()}}Object(e.a)(Pg,"WordAccessibilityCheckManager",Sd,[]);var gl=c(92),yo=c(36),Xl=c(135),Gm=c(20),Hm=c(180),Kj=c(7),Bf=c(18),Ge=c(499);class vi{constructor(Q,
ya,kb,Mb,vc,id,ae){this.Qo=null;this.Wzb=0;this.Zc=ya;this.DB=kb;this.ib=Mb;this.ga=vc;this.fd=id;this.Ht=Q;this.ud=ae}get dR(){if(!this.Qo){const Q=this.Zc.ng(this.Ht.Yc);this.DB.ebg(Q);if(Q.Ab(7)||Q.kd(7))this.Qo=gl.a.Vr(Q,Q.origin)}return this.Qo}RWm(Q){if(!Q||!Q.Bg||0>=Q.Bg.length)return na.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var ya=Array(Q.Bg.length);let kb=7,Mb=null;for(let id=0;id<Q.Bg.length;id++)if(Mb=this.Zil(Q.Bg[id])){if(7===kb)kb=this.Wzb;else if(kb!==
this.Wzb)return na.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var vc=this.ud.HQa(Mb.characterData,Mb.qa);const ae=Q.cpBegin?this.ud.yzb(vc,Q.cpBegin):-1;vc=Q.cpEnd?this.ud.yzb(vc,Q.cpEnd):-1;if(-1>ae||-1>vc)return na.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;ya[id]=yo.a.IL(ae,vc,!1,Mb);switch(Q.contentType){case 5:if(!Xl.HyperlinkReader.j$h(ya[id],!1))return!1;break;case 6:if(!Gm.ImageReader.p3(ya[id]))return!1;
break;case 7:ya[id]=yo.a.IL(-1,-1,!1,Mb)}}else return!1;ya=new Hm.Selection(ya,!1);return this.v1n(Mb,ya,Q.contentType)}Zil(Q){if(this.dR)for(this.dR.reset(),this.Wzb=7;this.dR.moveNext();){var ya=this.dR.currentNode.type;if(38===ya||36===ya||23===ya)this.Wzb=ya;else if(12===ya){ya=this.dR.currentNode;const kb=ya.ia(Kj.a.Pc,0);if(Q===kb)return ya}}return null}P8f(Q){this.ga.processAction(Bf.a.ZS,2);this.ga.processAction(Bf.a.eaa,2);let ya=2;switch(this.Wzb){case 23:ya=32;break;case 38:ya=this.ga.Ub(Bf.a.Wkb,
2,new Ge.a(Q));break;case 36:ya=this.ga.Ub(Bf.a.pjb,2,new Ge.a(Q));break;default:na.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.Wzb)}if(32===ya)return!0;na.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.Wzb);return!1}v1n(Q,ya,kb){if(this.P8f(Q)){Q=this.Ht.Jt;const Mb=this.ib.hb.kb;Mb&&Mb.equals(ya)&&this.fd.pca(Q,null);this.fd.pca(Q,ya);switch(kb){case 0:case 1:this.ga.processAction(pg.a.JLb,2);break;case 2:this.ga.processAction(pg.a.O1c,
2);break;case 3:this.ga.processAction(pg.a.qxa,2)}return!0}return!1}}Object(e.a)(vi,"WordAccessibilityCheckNavigateManager",null,[1958]);class Mc{constructor(Q){this.QHa=null;this.OLg=Q}get fileId(){return this.OLg?this.OLg():null}initialize(Q){this.QHa=Q}ZCi(Q){this.QHa.k9e(Q)}}Object(e.a)(Mc,"AAccessibilityCheckService",null,[64,9]);class Xm{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);
const ya=Q.AccessibilityRules,kb={};if(ya)for(let Mb=0;Mb<ya.length;++Mb){const vc=ya[Mb];kb[vc.Key]=vc.Value}Q.AccessibilityRules=kb;return Q}}Object(e.a)(Xm,"AccessibilityCheckResultCollection",null,[]);class um extends Mc{constructor(Q){super(Q);this.onFailure=(ya,kb)=>{na.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",kb);ya=Object.assign(new Xm,{IsSuccess:!1});this.ZCi(ya)};this.onSuccess=ya=>{ya=um.wRl(ya);let kb=null;if(ya)try{kb=this.C2k(ya)}catch(Mb){na.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Mb.message),kb=Object.assign(new Xm,{IsSuccess:!1})}else na.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),kb=Object.assign(new Xm,{IsSuccess:!1});this.ZCi(kb)}}dispose(){}static wRl(Q){let ya=null;Q&&Q.jk&&(ya=Q.jk[0]);return ya?ya.Body:null}}Object(e.a)(um,"ALiveBooksAccessibilityCheckService",Mc,[]);var On=c(1064),Uj=c(246);class hm extends Uj.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}el(){return 56}static construct(Q,
ya){const kb=new hm;kb.FileId=Q;kb.IsCoauthorable=ya;return kb}}Object(e.a)(hm,"WordAccessibilityCheckRequest",Uj.a,[]);class Ag{}Object(e.a)(Ag,"AccessibilityCheckRule",null,[]);var bk=c(154);class kf{static parse(Q){switch(qb.a.jh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),bk.a.argument(Q);}}}Object(e.a)(kf,"AccessibilityRuleCategoryParser",null,[]);class rr{constructor(){this.Category=
this.Text=this.Id=null}static Jmo(Q){const ya=new Ag;ya.RuleId=Q.Id;ya.RuleName=Q.Text;ya.Category=kf.parse(Q.Category);return ya}}Object(e.a)(rr,"WordAccessibilityCheckRule",null,[]);class Dj{}Object(e.a)(Dj,"AccessibilityCheckResult",null,[]);class Io{constructor(){this.cpEnd=this.cpBegin=this.Bg=null;this.contentType=0}}Object(e.a)(Io,"WordAccessibilityCheckContentId",null,[]);const lm=Q=>{switch(qb.a.jh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var hp=c(1550);class Yl{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static Hmo(Q){const ya=new Dj;ya.RuleId=Q.RuleId;ya.ContentName=Q.Label;const kb=new Io;kb.Bg=Q.ParaId;kb.cpBegin=hp.b(Q.OS);kb.cpEnd=hp.b(Q.OE);kb.contentType=lm(Q.ContentType);ya.ContentId=kb;return ya}}Object(e.a)(Yl,"WordAccessibilityViolation",null,
[]);class wq{constructor(){this.Violations=this.Rules=null}static Imo(Q){const ya=new Xm;try{var kb={};if(Q.Rules){for(let Mb=0;Mb<Q.Rules.length;++Mb){const vc=rr.Jmo(Q.Rules[Mb]);kb[vc.RuleId]=vc}ya.AccessibilityRules=kb}if(Q.Violations){const Mb=Array(Q.Violations.length);for(kb=0;kb<Q.Violations.length;++kb)Mb[kb]=Yl.Hmo(Q.Violations[kb]);ya.Results=Mb}ya.IsPartialResult=!1;ya.IsSuccess=!0}catch(Mb){na.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Mb.message),ya.IsSuccess=!1}return ya}}Object(e.a)(wq,"WordAccessibilityCheckResult",null,[]);class sr extends um{constructor(Q,ya,kb){super(Q);this.YSb=ya;this.Psb=kb}lOn(){const Q=Object.assign(new On.a,{ks:hm.construct(this.fileId,this.Psb),status:1,vH:"AccessibilityCheck"});this.YSb(12,!1,this.onSuccess,this.onFailure,Q,null,Q)}C2k(Q){Q=Ha.b(Q);return wq.Imo(Q)}}Object(e.a)(sr,"WordAccessibilityCheckService",um,[]);class sp extends Mf{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}xc(Q){super.xc(Q);
Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Xf(F.AFrameworkApplication.ya,Ce.a.instance,eh.FocusManager.instance(),Ue.a.instance,Q.af("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),vd.KeyInputManager.instance,Hp.a.instance,F.AFrameworkApplication.K.lb("AccessibilityCheckerHelpUrl"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new sr(()=>F.AFrameworkApplication.rootQuerySignature,Lc.a.VP,gm.PageReader.instance.HKd(If.App.xa.jb.Yc))).singleInstance();
Q.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new vi(If.App.xa.jb,Q.resolve("Box4.Graph.IGraphIteratorFactory"),Ig.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),F.AFrameworkApplication.ya,Bk.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Pg(F.AFrameworkApplication.ya,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),If.App.kk.sl,zi.App.sRc)).singleInstance()}init(){zi.App.Tie&&this.container.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{Mf.prototype.init.call(this)})}}Object(e.a)(sp,"WordAccCheckerPackageManager",Mf,[]);class Lj{constructor(Q,ya){this.B7g=!1;this.Hpo=()=>{this.Gpo()};this.Lk=Q;this.mS=ya}Ekb(Q){Q.iX.Jgk(this.Hpo)}Gpo(){!this.B7g&&this.Lk&&
(this.Lk.BEa?this.mS?this.mS.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):na.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.B7g=!0)}}Object(e.a)(Lj,"CoauthSurveyManager",null,[1915]);class Jo{constructor(){this.Ht=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){If.App.xa&&(this.Ht=If.App.xa.jb)&&(this.Ht.pva?this.$ha():this.Ht.kea(()=>{this.$ha()}))}$ha(){var Q=this.Ht.Yc;Q&&(Q=Q.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").Ekb(Q)}dispose(){}xc(Q){this.W=Q;Q.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Lj(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Za("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){F.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&ca.a.instance.Kc(new Jo)}}Object(e.a)(Jo,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var Hn;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(Hn||(Hn={}));Object(e.b)("ComponentLoggingScenario",Hn);var mk=c(1419);class mo{flush(Q,ya){const kb=this.oAl(Q);kb.LoggingScenario=Hn[ya];ti.a(kb).length?na.ULS.sendTraceTag(594571986,3013,15,"{0}",kb):na.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
mk.a[Q.QYa])}oAl(Q){const ya={};if(!Q)return ya;const kb=new mj.a;for(kb.enqueue(Q);!kb.isEmpty;){Q=kb.dequeue();const Mb=mk.a[Q.QYa];try{ya[Mb]=Q.yI()}catch(vc){na.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Mb.toString(),{["Kind"]:"Exception",["Stack"]:vc.stack,["Message"]:vc.message,["FileName"]:vc.fileName,["LineNumber"]:vc.lineNumber})}if((Q=Q.hAd)&&Q.length)for(const vc of Q)!vc||mk.a[vc.QYa]in ya||kb.enqueue(vc)}return ya}}
Object(e.a)(mo,"ComponentStateLogManager",null,[1914]);class Ro{flush(){}}Object(e.a)(Ro,"NoOpComponentStateLogManager",null,[1914]);class Kk{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}xc(Q){this.W=Q;F.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new mo).as("Common.IComponentStateLogManager").singleInstance():
Q.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Ro).as("Common.IComponentStateLogManager").singleInstance()}static main(){ca.a.instance.Kc(new Kk)}}Object(e.a)(Kk,"WordEditorComponentStateLoggingPackage",null,[1,2]);var on=c(1958);class iq{constructor(Q,ya,kb){this.rg=Q;this.qqd=ya;this.G1g=kb}qj(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf=null,Ng=!1,Fg=null,ck=null,Ki=null,Il=null,wl=!1){return this.G1g?this.qqd.qj(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,ck,Ki):this.rg.qj(Q,ya,kb,Mb,vc,id,
ae,we,Ee,jf,Ng,Fg,ck,Ki,Il,wl)}H5b(Q){return this.G1g?this.qqd.H5b():this.rg.H5b(Q)}}Object(e.a)(iq,"ClientRequestAdapter",null,[915]);var Ko=c(186),no=c(269),Wk=c(267),Zh=c(1372),Ai=c(286),vm=c(1382),Qm=c(1959),ag=c(51),Yn=c(734),Im=c(599),Oe=c(127),pj=c(577),kg=c(482),Mj;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(Mj||
(Mj={}));Object(e.b)("MostRecentRevisionIdOrigin",Mj);class pn extends Sys.EventArgs{constructor(Q,ya,kb,Mb){super();this.jTc=Q;this.httpStatusCode=kb;this.sH=Mb}}Object(e.a)(pn,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class dn{constructor(){this.S5=0}get isEmpty(){return!this.S5}BAc(Q){this.S5|=Q}TRc(Q){return!!(this.S5&Q)}clear(){this.S5=0}MCc(){return!1}}Object(e.a)(dn,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Pn{constructor(Q,ya=3){this.S5=0;this.Cod=new Map;this.zUj=Q;this.h0j=
ya}get isEmpty(){return!this.S5}BAc(Q){this.S5|=Q;let ya=this.Cod.get(Q)||0;this.Cod.set(Q,++ya)}TRc(Q){return!!(this.S5&Q)}clear(){this.S5=0;this.Cod.clear()}MCc(Q){return this.h0j&Q?(this.Cod.get(Q)||0)<this.zUj:!1}}Object(e.a)(Pn,"DocxSaveMonitorRetryAttemptMany",null,[]);class Up{static create(Q=!1,ya=3,kb=0){return Q?new Pn(ya,kb):new dn}}Object(e.a)(Up,"DocxSaveMonitorRetryAttemptFactory",null,[]);var Xk=c(1658),Zn;(function(Q){Q[Q.aXo=-1]="noResultYet";Q[Q.k1o=0]="upToDate";Q[Q.VZo=1]="sessionLost";
Q[Q.q1o=2]="userSignedOut";Q[Q.GYo=3]="previousRequestPending";Q[Q.O8d=4]="requestFailed";Q[Q.p_o=5]="shuttingDown";Q[Q.fXo=6]="nullResponseData";Q[Q.oVo=7]="invalidResponseData";Q[Q.tTo=8]="failedRevisionLookup";Q[Q.AZo=9]="savedWithinThreshold";Q[Q.cXo=10]="notSavedWarning";Q[Q.FVo=11]="kickoutThreshold";Q[Q.W0o=12]="unknownRevision";Q[Q.xRo=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.GVo=17]="kickoutThreshold_Offline";
Q[Q.ASo=18]="dssSessionDeleted";Q[Q.BSo=19]="dssSessionExpired";Q[Q.z1o=20]="waitingForSessionTokenRefresh";Q[Q.CSo=21]="dssSessionNotFound"})(Zn||(Zn={}));Object(e.b)("SaveMonitorResult",Zn);class Bg{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,Fg,ck,Ki,Il,wl,Wi,wg,xr,Mr,Tq,Zp,Vg,Sg,Og,Gw=null,wk){this.ouc=0;this.YTb=!1;this.Pwc=null;this.Zsc=this.gN=-1;this.IHe=null;this.Vmd=0;this.Wmd=!1;this.jub=null;this.Vuc=0;this.tKe=this.H8g=null;this.zR=this.ZTg=this.rse=0;this.SBe=null;this.fRg=!1;this.Rm=
null;this.rqd=0;this.Trd=void 0;this.Xpd=!1;this.e3g=0;this.gkl=()=>{var va;na.ULS.sendTraceTag(524871194,Bg.Zn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.g_,["AppVisibilityState"]:Zh.a[null===(va=this.Rm)||void 0===va?void 0:va.nF]});va=this.ptb;this.ptb=this.yz();if(this.K9())this.Dz.event(5),this.stop("session has shut down");else{this.i$a===Bg.WZi&&this.cya(this.JSb);var Sa=this.Dqc();if(Sa)if(this.hAe()&&F.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),
this.g_)this.Dz.event(0);else if(this.bUb())this.Dz.event(1),this.stop("session is lost"),F.AFrameworkApplication.Ce("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.fRg&&!this.erm()&&(na.ULS.sendTraceTag(554726995,Bg.Zn,10,"DocxSaveMonitor: Session lost but not kicked out"),this.dA(ag.a.jHh));else if(this.hAe())20!==this.Dz.currentState?(this.Dz.event(20),this.H8g=this.yz(),na.ULS.sendTraceTag(593510691,Bg.Zn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",
this.J8g)):this.yz().getTime()-this.H8g.getTime()>this.J8g&&(this.Dz.event(14),this.Xpd?this.RVd(20,ag.a.$Gc,"TokenExpired"):(this.stop("Waited too long for session token to be refreshed"),this.dA(ag.a.$Gc)));else if(this.ySj())if(this.ptb=va,this.YTb)this.Dz.event(3),this.yz().getTime()-this.Pwc.getTime()>this.dBe&&(va=this.cpe.H5b(this.gN),na.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.gN,Zi.a[va]),this.ood&&this.ood.log(),this.stop("stuck on previousRequestPending"),
this.dA());else if(va=Im.b(Xk.a.construct(Sa)),this.YTb=!0,this.Pwc=this.S_j(),this.gN=this.cpe.qj(Bg.serviceUrl,2,va,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.bEk,this.aEk,null,void 0,void 0,this.oIe,this.Epd,void 0,void 0,!0),0>=this.gN)this.YTb=!1,na.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.gN.toString());else{va=this.cpe.H5b(this.gN);Sa=100;if(va&&1!==va||this.EOg)Sa=50;na.ULS.sendTraceTag(19161612,Bg.Zn,Sa,"DocxSaveMonitor: Sending Request {0}",
{["Id"]:this.gN,["Status"]:Zi.a[va]});this.ood&&this.ood.start(this.gN)}else this.Dz.event(2);else this.Dz.event(13)}};this.aEk=va=>{this.zR=this.qAd+1;let Sa=this.YTb=!1,Da=!1;va=va.data;Fa.a.Kl&&F.AFrameworkApplication.Aga("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");va?(na.ULS.sendTraceTag(22552773,Bg.Zn,15,"Request failed {0}",{["Status"]:va.status,["HttpStatus"]:va.jf,["Correlation"]:va.Bj?va.Bj[Ai.a.C6]:"",["Id"]:va.id,["ConsecutiveErrors"]:this.qAd,["Request.InvokedTime"]:va.oH,
["Request.EnqueueTime"]:va.TMa,["Request.CompletedTime"]:va.FS}),Da=7===va.status||13===va.status,this.MCc(2)&&Da?(this.cUa.BAc(2),Sa=!0,this.Zsc=va.jf,this.Dz.event(16)):this.MCc(1)&&5===va.status?(this.cUa.BAc(1),Sa=!0,this.Zsc=va.jf,this.Dz.event(15)):(this.Dz.event(4),this.Zsc=va.jf)):(this.Dz.event(4),na.ULS.sendTraceTag(23425240,Bg.Zn,15,"RequestFailed and event data is null"));if(!Sa&&(this.cUa.clear(),Da?this.RVd(17,ag.a.y8k,"while offline"):this.RVd(11,ag.a.M9e,"while online")))return;this.cya(Sa?
this.xtl(Da):this.JSb)};this.bEk=va=>{this.zR=this.qAd+1;this.YTb=!1;var Sa={};this.cUa.clear();if(va=va.data){var Da=va.Bj?va.Bj[Ai.a.C6]:"";Sa.HttpStatus=va.jf;Sa.Correlation=Da;Sa.Id=va.id;na.ULS.sendTraceTag(23425242,Bg.Zn,this.EOg?50:100,"Request succeeded at the HTTP level {0}",Sa);this.Zsc=va.jf}else na.ULS.sendTraceTag(23425241,Bg.Zn,15,"Request succeeded with null response data");if(this.K9()||!this.kEd)this.Dz.event(5),this.stop("session has shut down");else if(!this.$vm())if(va&&va.Ae)if(va=
this.Pta(va.Ae))if(this.E1.G6a(va),va.StatusCode)this.UAm(va,Sa)||this.Dz.event(8,Sa);else{this.zR=0;this.ptb=this.yz();this.zJe.clear();Sa={["LastSavedRevisionId"]:va.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:va.RevisionSequenceNumber};va=Oe.b(va.LastSavedRevisionId);this.ngc(va,3);var xa=this.xhf().store.getRevision(va);if(xa){va=null;Da=this.egb();xa=(xa=xa.G_a(Da))?xa.id:ee.a.nil;let $a=Da;for(;$a&&!$a.id.equals(xa);)va=$a,$a=$a.Zl;this.e4l(va,Sa,Da)||this.Dz.event(9)}else this.M2l()||
this.Dz.event(12,Sa);this.cya(this.lwb)&&na.ULS.sendTraceTag(22552774,Bg.Zn,50,"Received response from server -- going back to normal interval")}else this.Dz.event(7),this.Xzf("invalid response",Sa);else this.Dz.event(6),this.Xzf("null response",Sa)};this.$Ln=(va,Sa)=>{va={};va.DocxSaveMonitorState=Zn[Sa.newState];va.PreviousState=Zn[Sa.SRf];va.PreviousStateHits=Sa.TRf;va.PreviousStateTransitionTime=Sa.URf.toISOString();va.LastHttpStatus=this.Zsc;va.LastSuccessTime=this.ptb.toISOString();this.Pwc&&
(va.LastRequestStartTime=this.Pwc.toISOString());va.LastSavedRevisionID=this.CZd.toString();va.LastSavedRevisionIdOrigin=this.ouc;va.LastSavedRevisionIdSetTime=this.tKe?this.tKe.toISOString():null;va.IsViable=this.nf.Ova;va.IsNetworkConnected=this.nf.XI;va.IsExpired=this.nf.Uaa;va.HasEmergencyViewModeBeenDeployed=this.nf.zj;va["Navigator.Online"]=window.navigator.onLine;const Da=Sa.Bfo;Da&&Bg.Qxi(va,Da);Sa=Sa.newState;switch(Sa){case 13:na.ULS.sendTraceTag(5830086,Bg.Zn,50,"{0}",va);break;case 1:na.ULS.sendTraceTag(5884125,
Bg.Zn,50,"{0}",va);break;case 0:na.ULS.sendTraceTag(5830087,Bg.Zn,50,"{0}",va);break;case 2:na.ULS.sendTraceTag(5830088,Bg.Zn,50,"{0}",va);break;case 3:na.ULS.sendTraceTag(5830089,Bg.Zn,50,"{0}",va);break;case 4:na.ULS.sendTraceTag(5884126,Bg.Zn,50,"{0}",va);break;case 5:na.ULS.sendTraceTag(5884127,Bg.Zn,50,"{0}",va);break;case 6:na.ULS.shipAssertTag(5830090,Bg.Zn,!1,"{0}",va);break;case 7:na.ULS.shipAssertTag(5830091,Bg.Zn,!1,"{0}",va);break;case 8:na.ULS.sendTraceTag(5830092,Bg.Zn,15,"{0}",va);
break;case 10:na.ULS.sendTraceTag(5830094,Bg.Zn,15,"{0}",va);break;case 9:na.ULS.sendTraceTag(5884128,Bg.Zn,50,"{0}",va);break;case 11:na.ULS.sendTraceTag(5830096,Bg.Zn,15,"{0}",va);break;case 17:na.ULS.sendTraceTag(37835678,Bg.Zn,15,"{0}",va);break;case 12:na.ULS.sendTraceTag(5830095,Bg.Zn,15,"{0}",va);break;case 18:na.ULS.sendTraceTag(38122832,Bg.Zn,15,"{0}",va);break;case 19:na.ULS.sendTraceTag(38122833,Bg.Zn,15,"{0}",va);break;case 21:na.ULS.sendTraceTag(0,Bg.Zn,15,"{0}",va);break;case 14:na.ULS.sendTraceTag(6575508,
Bg.Zn,15,"{0}",va);break;case 15:na.ULS.sendTraceTag(36739287,Bg.Zn,50,"{0}",va);break;case 16:na.ULS.sendTraceTag(36767649,Bg.Zn,15,"{0}",va);break;case 20:na.ULS.sendTraceTag(593510690,Bg.Zn,15,"{0}",va);break;default:na.ULS.shipAssertTag(5884129,Bg.Zn,!1,"Bad state:{0} logInfo:{1}",Sa,va)}};this.lwb=Q;this.JSb=ya;this.i$a=Q;this.Z$g=kb;this.b2j=Mb;this.oIe=id;this.Epd=ae;this.iVb=we;this.VHg=Ee;this.cpe=jf;this.C5=Ng;this.E1=Fg;this.Dqc=ck;this.ySj=Ki;this.bUb=Il;this.hAe=wl;this.K9=Wi;this.yz=
wg;this.S_j=xr;this.fRg=Og;this.cUa=Up.create(wk.isEnabled,wk.maxRetries,Zp.S5);this.zJe=new kg.a;this.hve=Vg;this.Dz=new vm.a(-1);this.nf=Gw;this.Dz.XTe(this.$Ln);this.ood=Mr;this.ptb=wg();this.EOg=Tq;this.HDj=wk.isEnabled?null:Zp;this.sqb=Sg;this.J8g=this.Z$g;this.UDe=ee.a.nil;this.sa=new k.a;za.a.instance.Za("Common.App.VisibilityManagement.IVisibilityManager").execute(va=>{this.Rm=va;this.Rm.QXa((Sa,Da)=>{this.RZ(Sa,Da)});this.THe=va.nF});this.nf&&this.nf.CTe((va,Sa)=>{this.qIb(va,Sa)});this.dBe=
F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",vc):vc;if(this.Xpd=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWithSessionExpiredOnlyWhenVisible",!1):!1)this.e3g=F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.JSb);this.i0j=wk}qIb(Q,ya){na.ULS.sendTraceTag(528577692,Bg.Zn,
15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Qm.a[ya.KJf],Qm.a[ya.FVc]);1!==ya.FVc&&3!==ya.FVc&&(na.ULS.sendTraceTag(528566343,Bg.Zn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.cUa.TRc(1),this.cUa.TRc(2)),this.cUa.clear())}get kEd(){return this.rse}get CZd(){return this.UDe}get g_(){const Q=!this.egb()||this.CZd.equals(this.egb().id);Q||na.ULS.sendTraceTag(521413851,Bg.Zn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",
this.egb().id.toString(),this.CZd.toString());return Q}get zki(){return this.yz().getTime()-this.ptb.getTime()>this.dBe}get qAd(){return this.zR}get QYa(){return 3}get hAd(){let Q=null;If.App.xa&&If.App.xa.jb&&If.App.xa.jb.Yc&&(Q=If.App.xa.jb.Yc.contentReplicator);return[Q,zi.App.i0]}RZ(Q,ya){var kb,Mb,vc;Q={["VisibilityState"]:Zh.a[this.Rm.nF],["IsVisible"]:this.Rm.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.YTb,["KickoutIntervalElapsed"]:this.zki,["LastSuccessfulIterationTime"]:null!==
(kb=this.ptb)&&void 0!==kb?kb:"null",["RequestStartTime"]:null!==(Mb=this.Pwc)&&void 0!==Mb?Mb:"null",["SkippedKickouts"]:this.rqd,["LastSkippedKickoutAt"]:null!==(vc=this.dUg)&&void 0!==vc?vc:"null"},["IsViable"]:this.nf.Ova,["IsNetworkConnected"]:this.nf.XI,["IsExpired"]:this.nf.Uaa,["HasEmergencyViewModeBeenDeployed"]:this.nf.zj,["Navigator.Online"]:window.navigator.onLine};na.ULS.sendTraceTag(539874775,Bg.Zn,50,Ha.c(Q));this.THe!=this.Rm.nF&&(this.Xpd&&(0==ya.oldState||1==ya.oldState||0!==ya.newState&&
1!==ya.newState||this.cya(this.e3g)),0===this.Rm.nF?(Wc.c(Bf.a.wtk,void 0,void 0,void 0,void 0,void 0,Q),this.Trd&&Wc.b("AvgTimeSpentOutsideOfWord",Date.now()-this.Trd,1),this.Trd=void 0):0===this.THe&&(Wc.c(Bf.a.xtk,void 0,void 0,void 0,void 0,void 0,Q),this.Trd=Date.now()),this.THe=this.Rm.nF)}start(){this.rse=this.VHg.Xdb(this.gkl,this.i$a)}cya(Q){if(!this.kEd||this.i$a===Q)return!1;const ya=this.i$a;this.i$a=Q;this.stop("changing save monitor interval from "+ya+"ms to "+Q+"ms");this.start();return!0}ngc(Q,
ya){if(ya>=this.ouc&&Q&&!ee.a.nil.equals(Q)){var kb=!this.UDe.equals(Q);this.ouc=ya;this.UDe=Q;const Mb=this.yz();this.tKe=Mb;const vc=this.g_;kb&&(ya={["Id"]:Q.toString(),["IsUpToDate"]:vc,["Origin"]:Mj[ya]},this.SBe&&(ya.LastUpToDateTime=this.SBe.toISOString()),(kb=this.xhf())&&kb.store&&(Q=kb.store.getRevision(Q))&&(ya.LastSavedCreationTime=Q.creationTime.toISOString()),na.ULS.sendTraceTag(557320151,Bg.Zn,50,"Updating Last Saved Revision: {0}",ya));vc&&(this.SBe=Mb)}else ya<this.ouc?na.ULS.sendTraceTag(572051800,
Bg.Zn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.ouc,ya):na.ULS.sendTraceTag(572051801,Bg.Zn,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',ya)}stop(Q){this.Se(Q)}Se(Q){this.kEd&&(na.ULS.sendTraceTag(5830084,Bg.Zn,50,"Stopping DocxSaveMonitor because {0}!",Q),this.VHg.Se(this.kEd),this.rse=0)}M2l(){if(0>=this.iVb)return!1;var Q=this.dMl();if(!Q)return this.IHe=null,this.Vmd=0,this.Wmd=!1;this.jub=Q.iHd;this.jub===this.IHe?this.Vmd++:(this.IHe=this.jub,this.Vmd=1,this.Wmd=
!1);if(this.Vmd<Bg.TUm)return!1;this.Vuc=+this.yz()-+this.jub;if(this.Vuc<=this.iVb)return!1;if(!this.Wmd)return this.Wmd=!0,this.PQi(),!1;if(this.sqb)this.sqb.execute(ya=>{ya.flush(this,0)});else{Q="";try{this.hve&&(Q=this.hve())}catch(ya){Q=Ha.c({["Kind"]:"Exception",["Stack"]:ya.stack,["Message"]:ya.message,["FileName"]:ya.fileName,["LineNumber"]:ya.lineNumber}),na.ULS.sendTraceTag(50426817,Bg.Zn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}na.ULS.sendTraceTag(50426818,
Bg.Zn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.jub.toISOString(),this.Vuc,this.iVb,Q)}this.iVb=-1;this.stop("Exceeded oldest allowed local revision");this.dA(ag.a.z8k);return!0}dMl(){let Q=null,ya=this.egb();for(;ya&&!ya.Jva;)Q=ya,ya=ya.Zl;return Q}$vm(){return this.bUb()?(this.Dz.event(1),this.stop("session is lost"),!0):this.hAe()?(this.Dz.event(14),na.ULS.sendTraceTag(20029718,Bg.Zn,15,"ExpiredSessionNotLostYet"),
this.stop("session is expired"),this.dA(ag.a.$Gc),!0):!1}xhf(){const Q=this.Dqc();return Q?Q.Jc:null}egb(){const Q=this.xhf();return Q?Q.Jm:null}MCc(Q){return this.i0j.isEnabled?this.cUa.MCc(Q):this.HDj.TRc(Q)&&!this.cUa.TRc(Q)}xtl(Q){return Q?Bg.Bmo:Bg.WZi}RVd(Q,ya,kb){if(this.zki)if(this.Rm&&!this.Rm.isVisible)na.ULS.sendTraceTag(540669727,Bg.Zn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.rqd+=1,this.dUg=this.yz();else return this.Dz.event(Q,
{}),this.stop("request failed after kickout interval "+kb),this.sqb&&this.sqb.execute(Mb=>{Mb.flush(this,2)}),this.dA(ya),!0;return!1}UAm(Q,ya){const kb=Q.StatusCode;return 88===kb||89===kb||236===kb?(ya.KickoutDiagnostics=this.hve(),88===kb?(ya.Result="deleted DSS session",this.Dz.event(18,ya),this.stop("deleted DSS session"),this.dA(ag.a.localCobaltDeletedSessionFault)):89===kb?(ya.Result="expired DSS session",this.Dz.event(19,ya),this.stop("expired DSS session"),this.dA(ag.a.localCobaltExpiredSessionFault)):
(F.AFrameworkApplication.Xm("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=Oe.b(Q.LastSavedRevisionId),this.ngc(Q,4)),ya.Result="DSS session not found",this.Dz.event(21,ya),this.stop("DSS session not found"),this.dA(ag.a.localCobaltSessionNotFound)),!0):14===kb?(this.stop("DSS returned an unspecified failure"),this.dA(ag.a.vHm),
!0):104===kb?(this.stop("this operation is disabled on the server"),!0):this.Xzf("unrecognized OperationResult: "+kb,ya)}Xzf(Q,ya){if(!this.zJe.contains(Q))this.zJe.add(Q);else if(this.RVd(11,ag.a.M9e,Q))return ya.ConsecutiveErrors=this.qAd,ya.Reason=Q,na.ULS.sendTraceTag(41997899,Bg.Zn,15,"DocxSaveMonitor kickout. {0}",ya),!0;this.cya(this.JSb);return!1}e4l(Q,ya,kb){let Mb=!1;if(Q){const vc=this.yz().getTime()-Q.creationTime.getTime();vc>=this.Z$g&&(Mb=!0,Bg.Qxi(ya,this.KRl(Q,vc,kb)),vc>=this.dBe&&
10===this.Dz.currentState?(this.Dz.event(11,ya),this.stop("didn't save in time"),this.dA()):(this.Dz.event(10,ya),this.PQi(),this.sef()))}return Mb}Dfk(Q){this.sa.addHandler(Bg.VMi,Q)}gfk(Q){this.sa.addHandler(Bg.zef,Q)}yWi(Q){this.sa.removeHandler(Bg.zef,Q)}PQi(){this.sa.raiseEvent(Bg.VMi)}Pta(Q){let ya;return({group:ya}=pj.a.q0(Q)).returnValue?ya.Responses[0]:null}KRl(Q,ya,kb){const Mb={};Mb.FirstUnsavedRevisionId=Q.id.toString();Mb.FirstUnsavedRevisionLengthToRoot=Q.yQ;Mb.UnsavedTimeInMs=ya;Mb.CurrentRevisionId=
kb.id.toString();Mb.CurrentRevisionLengthToRoot=kb.yQ;return Mb}sef(){Lc.a.tef(8)}dA(Q=ag.a.M9e){this.b2j?(this.stop(Bg.VAm),Q===ag.a.$Gc?this.C5.value.dA(Q,Object.assign(new Yn.a,{Xka:4,s2:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,K$:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.C5.value.dA(Q,new Yn.a)):na.ULS.sendTraceTag(19247383,Bg.Zn,50,"Kickout disabled")}yI(){const Q={};this.jub&&(Q.ORT=this.jub.toISOString());0<this.Vuc&&(Q.AA=this.Vuc);0<this.iVb&&
(Q.MAA=this.iVb);0<this.rqd&&(Q.LSKO=this.dUg.toISOString());this.Dz&&0<=this.Dz.currentState&&(Q.SMS=Zn[this.Dz.currentState]);const ya={};F.AFrameworkApplication.Cna&&(ya.S=1);If.App.lostSession&&(ya.LS=1);this.nf&&(this.nf.zo&&(ya.KO=1),this.nf.Uaa&&(ya.TE=1));this.Rm&&(ya.VS=Zh.a[this.Rm.nF]);window.navigator&&(ya.NW=!window.navigator.onLine);Q.AMD=ya;return Q}OEl(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};F.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=
qb.a.lQ(F.AFrameworkApplication.buildVersion));F.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=qb.a.lQ(F.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=F.AFrameworkApplication.yLa.toString());F.AFrameworkApplication.canary&&(Q["X-Key"]=qb.a.lQ(F.AFrameworkApplication.canary));F.AFrameworkApplication.userType&&(Q["X-UserType"]=qb.a.lQ(F.AFrameworkApplication.userType));const ya=F.AFrameworkApplication.Ve.M4;ya&&(Q["X-WacCluster"]=qb.a.lQ(ya));F.AFrameworkApplication.userSessionId&&
(Q["X-UserSessionId"]=qb.a.lQ(F.AFrameworkApplication.userSessionId));return Q}Rnl(){var Q=this.nf?this.nf.networkState:null;if(1===Q||3===Q)na.ULS.sendTraceTag(558158790,Bg.Zn,15,"Not sending request because we dont have network.");else if(Q=this.Dqc()){var ya=new Sys.Net.WebRequest;ya.set_httpVerb("POST");ya.set_url(Bg.serviceUrl);var kb={};kb.body=Im.b(Xk.a.construct(Q));kb.headers=this.OEl();kb.method=ya.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(ya.getResolvedUrl(),kb).then(Mb=>
{na.ULS.sendTraceTag(561551382,Bg.Zn,50,"Request succeeded at the HTTP level {0}",Mb.statusText);this.ZTg=Mb.status;return Mb.json()},Mb=>{na.ULS.sendTraceTag(561551383,Bg.Zn,15,"Request failed at the HTTP level {0}",Mb);return null}).then(Mb=>{Mb=JSON.stringify(Mb);this.QDk(Mb,this.ZTg);return Mb},()=>{na.ULS.sendTraceTag(561551385,Bg.Zn,15,"Request succeeded with null response data");return""}):na.ULS.sendTraceTag(561002076,Bg.Zn,15,"Browser does not support Fetch.")}catch(Mb){na.ULS.sendTraceTag(561551386,
Bg.Zn,15,String.format("Exception when attempting to get last revision save id : {0}",Mb))}}else na.ULS.sendTraceTag(540079457,Bg.Zn,15,"Target node is null, not sending last saved revision request.")}QDk(Q,ya){let kb=ee.a.nil,Mb=!1,vc=-1;ya===Ql.a.tB&&((Q=this.Pta(Q))?(kb=Oe.b(Q.LastSavedRevisionId),Q.StatusCode||(Mb=!0,vc=Q.StatusCode)):na.ULS.sendTraceTag(561002077,Bg.Zn,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(Bg.zef,new pn(kb,Mb,ya,vc))}static Qxi(Q,
ya){for(const kb in ya)Q[kb]=ya[kb]}erm(){return rf.SessionStatusManager.instance.zo}}Bg.WZi=0;Bg.serviceUrl=If.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";Bg.VAm="kickout";Bg.VMi="PS";Bg.zef="FLSR";Bg.Zn=343;Bg.TUm=5;Bg.Bmo=5E4;Object(e.a)(Bg,"DocxSaveMonitor",null,[1909,146]);class Vp{Xdb(Q,ya){return window.setInterval(Q,ya)}Se(Q){window.clearInterval(Q)}}Vp.instance=new Vp;Object(e.a)(Vp,"DocxSaveMonitorTaskManager",null,[1907]);class Ck{constructor(Q){this.gN=0;this.asa=
Q}start(Q){this.asa&&(this.gN=Q,this.asa.reset())}log(){if(this.asa){var Q={};Q.RequstId=this.gN;Q.InvokeCount=this.asa.MPc;Q.InvokeFailedCount=this.asa.NPc;Q.NoOpenConnectionCount=this.asa.JVc;Q.SynchronousNotificationCount=this.asa.j5c;Q.ResponseNotAvailable=this.asa.a1c;na.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(e.a)(Ck,"RequestLifeCycleTelemetryManager",null,[1908]);class So{constructor(){this.W=this.pKe=null;this.RWk=()=>{var Q=F.AFrameworkApplication.K;
if(!Q.$("DocxSaveMonitorEnabled"))return null;var ya=Q.$("DocxSaveMonitorKickoutEnabled");const kb=Q.pc("DocxSaveMonitorIntervalMs",6E4),Mb=Q.pc("DocxSaveMonitorFailureIntervalMs",5E3),vc=Q.pc("DocxSaveMonitorWarningTimeMs",12E4),id=Q.pc("DocxSaveMonitorKickoutTimeMs",3E5),ae=Q.pc("DocxSaveMonitorQueueTimeoutMs",6E4),we=Q.pc("DocxSaveMonitorSentTimeoutMs",12E4),Ee=Q.pc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var jf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const Ng=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");
var Fg=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),ck=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||Fg;Fg=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Ki=F.AFrameworkApplication.Ve,Il=ck?new on.a(F.AFrameworkApplication.userSessionId,Ki.M4,Ki.ADh):null;Il=new iq(Ki,Il,ck);jf=jf&&Ki&&!ck?new Ck(Ki.Gca):null;
ck=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Ki=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const wl=Up.create(ck,Ki);wl.BAc(1);wl.BAc(2);Fg=Fg?this.W.Za("Common.IComponentStateLogManager"):null;ya=new Bg(kb,Mb,vc,ya,id,ae,we,Ee,Vp.instance,Il,za.a.instance.af("Box4.IKickoutExecutor"),
no.a.instance,this.X5b,()=>!F.AFrameworkApplication.g_d||Yh.a.instance.TPc,()=>If.App.lostSession,Object(a.a)(Ko.a.instance,Ko.a.instance.ABa,"checkAndTriggerSessionHasExpired"),()=>F.AFrameworkApplication.Rk,()=>new Date,()=>new Date,jf,Ng,wl,this.Drl,Fg,Q,za.a.instance.Pa("Common.ISessionStatus")||rf.SessionStatusManager.instance,{isEnabled:ck,maxRetries:Ki});ya.start();na.ULS.sendTraceTag(5884131,Bg.Zn,50,"SaveMonitor initialized");return ya};this.X5b=()=>{const Q=If.App.xa.jb.wc;return Q?Q.jd:
null};this.Drl=()=>{const Q={};F.AFrameworkApplication.uc&&(Q.TM=F.AFrameworkApplication.uc.yI());Wk.WoncaApp.VE&&(Q.RS=Wk.WoncaApp.VE.yI());zi.App.i0&&(Q.CRS=zi.App.i0.yI());If.App.xa&&If.App.xa.jb&&If.App.xa.jb.Yc&&If.App.xa.jb.Yc.contentReplicator&&(Q.GSR=If.App.xa.jb.Yc.contentReplicator.yI());F.AFrameworkApplication.Cna&&(Q.S=1);If.App.lostSession&&(Q.LS=1);If.App.yd&&If.App.yd.pB.zo&&(Q.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(If.App.Fs||
If.App.Lm)this.pKe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.pKe&&this.pKe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}xc(Q){this.W=Q;(If.App.Fs||If.App.Lm)&&Q.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.RWk).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){ca.a.instance.Kc(new So)}}Object(e.a)(So,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var In;(function(Q){Q[Q.version0=0]="version0";Q[Q.version1=1]="version1"})(In||(In={}));
Object(e.b)("FirstRunExperienceVersion",In);class ip{get cVe(){return"Word"}get lph(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return In.version0}get currentVersion(){return In.version1}get Pmm(){return ip.isEnabled()&&F.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get W9b(){return ip.isEnabled()&&F.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get Koi(){return F.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get Qll(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get ryi(){return 24}get H_i(){return 4E3}get p1c(){return""}static isEnabled(){const Q=
F.AFrameworkApplication.sessionStartInfoSettings?F.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(e.a)(ip,"FirstRunExperienceLauncherSettings",null,[1935]);class Zl{constructor(Q){this.EKg=Q}e$n(Q){this.EKg&&this.EKg.f$n(Q)}}Object(e.a)(Zl,"FirstRunExperienceManager",null,[1934]);class xn{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}xc(Q){this.W=Q;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new Zl(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const Q=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.e$n(new ip)}dispose(){}}Object(e.a)(xn,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class Ip{constructor(Q,ya,kb){this.GPi=(Mb,vc,id,ae,we)=>{if(1===id)return 32;switch(Mb){case Bf.a.HPi:we[je.a.On]=1===this.xJa.geb;break;case Bf.a.IPi:we[je.a.On]=2===this.xJa.geb}return 32};this.opa=
(Mb,vc,id,ae,we)=>{var Ee,jf;if(1===id)return we=null===(jf=null===(Ee=vc.view.Bb)||void 0===Ee?void 0:Ee.hb)||void 0===jf?void 0:jf.kb,(null===we||void 0===we?0:we.yK)||Mb===Bf.a.R3c&&(null===we||void 0===we?0:we.A1a)?32:8;if(2===id){Ee=this.xJa.hj.isVisible;this.xJa.mB(!0,1===we);jf=0;switch(Mb){case Bf.a.F5f:we=1;break;case Bf.a.G5f:we=2;break;case Bf.a.lce:we=2;jf=1;break;case Bf.a.mce:we=1;jf=2;break;case Bf.a.R3c:we=1;jf=3;break;case Bf.a.Lfe:we=this.xJa.geb;this.tSg&&!we&&(we=1);break;default:jf=
we=0}Ee&&Mb===Bf.a.opa||this.xJa.XXn(we,jf);return 32}return 8};this.vPd=(Mb,vc,id,ae,we)=>{this.toggleButton(we,!1);return this.MHk(id)};this.Lfe=(Mb,vc,id,ae,we)=>this.xJa.hj.isVisible?this.vPd(Mb,vc,id,ae,we):this.opa(Mb,vc,id,ae,we);this.ga=Q;this.xJa=ya;this.tSg=kb}dispose(){this.xJa&&this.xJa.dispose()}Wb(){this.ga.pa(Bf.a.Lfe,Sf.a.view,this.Lfe);this.ga.gb(Bf.a.opa,Sf.a.view,this.opa,4);this.ga.pa(Bf.a.vPd,Sf.a.view,this.vPd);this.ga.gb(Bf.a.lce,Sf.a.view,this.opa,4);this.ga.pa(Bf.a.mce,Sf.a.view,
this.opa);this.ga.pa(Bf.a.R3c,Sf.a.view,this.opa);this.tSg&&(this.ga.gb(Bf.a.HPi,Sf.a.view,this.GPi,96),this.ga.pa(Bf.a.F5f,Sf.a.view,this.opa),this.ga.gb(Bf.a.IPi,Sf.a.view,this.GPi,96),this.ga.pa(Bf.a.G5f,Sf.a.view,this.opa))}MHk(Q){if(1===Q)return 32;this.xJa.mB(!1);return 32}toggleButton(Q,ya){Q&&(Q[je.a.On]=ya)}}Object(e.a)(Ip,"FormatPictureActor",null,[9]);class ma{constructor(Q){this.wwb=!1;this.hj=Q}get geb(){return this.hj.jZk}XXn(Q,ya){switch(Q){case 0:case 1:this.hj.bao(ya);break;case 2:this.hj.oao(ya)}}mB(Q,
ya=!1){this.wwb||this.xsf();Q?this.hj.wO(ya):this.hj.Tma()}dispose(){this.hj.dispose()}xsf(){this.wwb||(this.hj.initialize(),this.wwb=!0)}}Object(e.a)(ma,"FormatPictureManager",null,[1911,9]);var cb=c(375),zb=c(108),Wb=c(333);class nc{}nc.EO=Wb.a.cId;nc.Icc=1;nc.Jcc=WordEditorIntl.WordEditorStrings.L_FormatPicture;nc.Lta="FormatPictureTaskPaneData";Object(e.a)(nc,"FormatPicturePaneConstants",null,[]);class Uc{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=
this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(Uc,"FormatPictureTaskPaneProps",null,[]);class Md{constructor(Q,ya,kb,Mb){this.DKe=0;this.yoc=this.tka=null;this.Pod=this.God=this.ijd=this.Z$c=this.jsd=0;this.Ku=this.bSb=!1;this.Eqe=0;this.h9m=()=>{this.y5i()};this.Nl=()=>{let vc=!1;vc=this.wpn()||vc;vc=
this.i4a()||vc;vc=this.h4a()||vc;vc=this.Edc()||vc;(vc=this.rpn()||vc)&&this.ym()};this.Y1=Q;this.kTj=ya;this.ZBe=kb;this.qg=Mb}initialize(){this.qZ();this.Wha()}get isVisible(){return this.Ku}wO(Q){this.Y3c(Q)}Tma(){this.kca();this.p8l()}bao(Q){this.L7i(Q,1)}oao(Q){this.L7i(Q,2)}L7i(Q,ya){this.Eqe=ya;this.DKe=Q}get jZk(){return this.Eqe}dispose(){}qZ(){this.Y1.yMa();this.DKe=this.Eqe=0}get Hh(){return this.kTj.value}get Bc(){return this.ZBe.value}i2a(){return!!this.Hh.currentScope&&this.Hh.currentScope.name===
nc.EO}y5i(){this.Hh.Dg(nc.EO)}Wha(){const Q=this.Hh.le(nc.EO);Q.parent=of.AFrame.Hp;Q.hea(this.h9m)}kca(){this.i2a()&&this.Hh.Dg(this.Hh.QS)}Y3c(Q){fg.UISurfaces.wu().then(ya=>{ya.showTaskPane(nc.EO,this.Pz(Q));this.isVisible&&Q&&this.Hh.Dg(nc.EO);return null})}ym(){fg.UISurfaces.wu().then(Q=>{Q.updateTaskPane(nc.EO,this.Pz(!1));return null})}p8l(){fg.UISurfaces.wu().then(Q=>{Q.hideTaskPane(nc.EO,2);return null})}Pz(){const Q=new Uc;this.a4n(Q);return Object.assign(new fl.a,{title:nc.Jcc,hideHeader:!1,
width:320,location:2,contentProps:Q,onOpen:ya=>{this.Ku=!0;If.App.xa.MXa(this.Nl);If.App.xa.updateCommandUI();this.y5i();this.qg.tAc(nc.EO,ya)},onClose:()=>{this.kca();this.Ku=!1;If.App.xa.wec(this.Nl);If.App.xa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}a4n(Q){const ya=ci.e().numberFormatInfo;Q.section=this.DKe;Q.numberFormatInfo="object"===typeof ya?ya:null;Q.title=this.tka;Q.description=this.yoc;Q.topCrop=this.jsd;Q.bottomCrop=this.Z$c;Q.leftCrop=
this.ijd;Q.rightCrop=this.God;Q.rotationAngle=this.Pod;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.bSb}onTitleChange(){return Q=>{if(Q!==this.tka){this.tka=Q;var ya=new cb.DictionaryPropertySet;ya.setValue(zb.a.xhb,Q);this.Bc.Ub(pg.a.C2c,2,ya);this.ym()}}}onDescriptionChange(){return Q=>{if(Q!==this.yoc){var ya=new cb.DictionaryPropertySet;
ya.setValue(zb.a.gX,Q);this.yoc=Q;this.Bc.Ub(pg.a.$Lb,2,ya);this.ym()}}}onCropSpinButtonChange(){return(Q,ya)=>{const kb=new cb.DictionaryPropertySet;switch(ya){case 0:this.jsd=Q;kb.setValue(zb.a.Chb,Q);this.Bc.Ub(Bf.a.wOc,2,kb);break;case 1:this.Z$c=Q;kb.setValue(zb.a.zhb,Q);this.Bc.Ub(Bf.a.tOc,2,kb);break;case 2:this.ijd=Q;kb.setValue(zb.a.Ahb,Q);this.Bc.Ub(Bf.a.uOc,2,kb);break;case 3:this.God=Q,kb.setValue(zb.a.Bhb,Q),this.Bc.Ub(Bf.a.vOc,2,kb)}this.ym()}}onRotationSpinButtonChange(){return Q=>
{this.Pod=Q;const ya=new cb.DictionaryPropertySet;ya.setValue(zb.a.DOc,0);ya.setValue(zb.a.QI,Q);this.Bc.Ub(pg.a.imageRotate,2,ya);this.ym()}}wpn(){const Q=2===this.Bc.Ub(pg.a.C2c,1,null),ya=Q!==this.bSb;this.bSb=Q;return ya}i4a(){var Q=new cb.DictionaryPropertySet;this.Bc.Ub(pg.a.i4a,2,Q);Q=Q.ia(zb.a.xhb,"");const ya=Q!==this.tka;this.tka=Q;return ya}h4a(){var Q=new cb.DictionaryPropertySet;this.Bc.Ub(pg.a.h4a,2,Q);Q=Q.ia(zb.a.gX,"");const ya=Q!==this.yoc;this.yoc=Q;return ya}Edc(){var Q=new cb.DictionaryPropertySet;
this.Bc.Ub(Bf.a.vZc,2,Q);const ya=Q.ia(zb.a.Chb,0),kb=Q.ia(zb.a.zhb,0),Mb=Q.ia(zb.a.Ahb,0);Q=Q.ia(zb.a.Bhb,0);const vc=ya!==this.jsd||kb!==this.Z$c||Mb!==this.ijd||Q!==this.God;this.jsd=ya;this.Z$c=kb;this.ijd=Mb;this.God=Q;return vc}rpn(){var Q=new cb.DictionaryPropertySet;this.Bc.Ub(pg.a.hKb,2,Q);Q=Q.ia(zb.a.QI,0);const ya=Q!==this.Pod;this.Pod=Q;return ya}}Object(e.a)(Md,"ReactFormatPicturePane",null,[1912,9]);class ge{constructor(){this.Ced=this.W=null}get name(){return"WordEditor.FormatPicture"}xc(Q){this.W=
Q;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new ma(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"),zi.App.Rtj)).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new Md(Hp.a.instance,new fb.a(()=>eh.FocusManager.instance()),new fb.a(()=>F.AFrameworkApplication.ya),Ce.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new Ip(F.AFrameworkApplication.ya,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"),
zi.App.Rtj)).singleInstance()}init(){if(zi.App.Zie||zi.App.ofg)this.Ced=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.Ced.Wb(),If.App.xa.updateCommandUI()}dispose(){this.Ced&&this.Ced.dispose()}static main(){ca.a.instance.Kc(new ge)}}Object(e.a)(ge,"WordEditorFormatPicturePackage",null,[1,2]);var Pd=c(1442),te=c(567);class Xe extends Uj.a{constructor(){super();this.Prompt=0;this.FileId=null}el(){return 100}static construct(Q,ya){const kb=new Xe;kb.FileId=Q;kb.Prompt=ya;return kb}}
Object(e.a)(Xe,"GraphMergeConsentChangedRequest",Uj.a,[]);var Yf=c(591);class Jg extends Yf.a{constructor(){super();this.Location=this.FileId=null}el(){return 34}static construct(Q,ya){const kb=new Jg;kb.FileId=Q;kb.Location=ya;return kb}}Object(e.a)(Jg,"PlayGraphMergeReplayRequest",Yf.a,[]);class $h{constructor(Q,ya,kb,Mb,vc,id=null,ae=null){this.El=!1;this.bN=null;this.K4g=this.HAe=!1;this.j2e=()=>{if(this.Dya.gPd)this.HAe=!0;else if(this.HAe=!1,!this.eUn){this.K4g=!0;var we=this.pIa.Mwa;na.ULS.sendTraceTag(39084353,
300,50,"GraphMerge consent given: {0}",400===we);if(100===we||400===we)we=Xe.construct(this.KR(),we),this.my(we)}};this.o9h=(we,Ee)=>{Ee&&Ee.OEf&&Ee.OEf.s4e&&!this.Dya.Ooi&&(this.Dya.fnj(),this.Dya.gPd=!0,this.my(Ee.OEf.s4e))};this.m9h=(we,Ee)=>{Ee&&Ee.s8c&&this.Dya.fnj()};this.n9h=(we,Ee)=>{Ee&&(Ee.ShowMergePrompt&&this.pIa.BYi(this.j2e),F.AFrameworkApplication.Gg&&(F.AFrameworkApplication.Gg.SessionMergeInfo|=Ee.PartMergeInfo))};this.KR=Q;this.Dtd=kb;this.Dya=Mb;this.pIa=vc;this.Dtd&&this.Dtd.lfk(this.o9h);
this.E1=id||no.a.instance;if(!ae){const we=new te.a;ae=Ee=>we.kma(0,Ee)}this.jFj=ae}get ezm(){return this.HAe}get eUn(){return this.K4g}my(Q){const ya=new On.a;ya.ks=Q;ya.status=1;ya.vH="GraphMerge";const kb=this.jFj(()=>{this.$0c(ya,33===Q.el())});kb.cK(ya);kb.HW()}$0c(Q,ya){this.El||(ya&&(this.Dya.gPd=!1),2===Q.statusCode&&!V.a.EFb(Q.jk)&&1===Q.jk.length&&Q.jk[0]?(Q=Q.jk[0],Q.StatusCode?this.Dya.W2f():ya&&this.pIa.BYi(this.j2e),this.E1.G6a(Q),this.ezm&&this.j2e()):this.Dya.W2f())}Ekb(Q){this.bN=
Q;this.bN.mZb(this.m9h);this.bN.nZb(this.n9h)}dispose(){this.El||(this.Dtd&&this.Dtd.IFn(this.o9h),this.bN&&(this.bN.RKb(this.m9h),this.bN.n0c(this.n9h)),this.El=!0)}}Object(e.a)($h,"GraphMergeBackupManager",null,[1933,9]);class ei{constructor(Q,ya=null,kb=null,Mb=null){this.nne=0;this.Cze=!1;this.jTg=new Date(0);this.gPd=!1;this.pIa=Q;this.yz=ya||(()=>new Date);kb||(kb=F.AFrameworkApplication.K?F.AFrameworkApplication.K.pc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.VUj=kb;Mb||(Mb=F.AFrameworkApplication.K?
F.AFrameworkApplication.K.pc("WordEditorGraphMergeMaxBackups",1):1);this.SVg=Mb}get Lxm(){return+this.yz()-+this.jTg<this.VUj}get Ooi(){return 500===this.pIa.Mwa?!1:100===this.pIa.Mwa?!0:this.Cze||this.gPd||this.Lxm}fnj(){this.jTg=this.yz();this.nne++;this.nne>=this.SVg&&this.W2f()}W2f(){this.Cze||(this.Cze=!0,na.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.nne,this.SVg))}}Object(e.a)(ei,"GraphMergeBackupThrottler",
null,[1932]);class rl{constructor(Q,ya,kb=null){this.IMg=!1;this.cV=Q;this.xLj=ya;null==kb&&(kb=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.$He=kb?500:300}get Mwa(){return this.$He}BYi(Q){if(!this.IMg&&300===this.Mwa){var ya=this.xLj.value;ya&&ya.isFeatureEnabled(49)&&(this.IMg=!0,this.cV.execute(kb=>{kb.p$n(()=>{this.vMk(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.Mwa&&(na.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),
this.$He=100,Q());this.TUi()}vMk(Q){300===this.Mwa&&(na.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.$He=400,Q());this.TUi()}TUi(){this.cV.execute(Q=>{Q.i8l()})}}Object(e.a)(rl,"GraphMergeCollectionConsentManager",null,[1931]);class Bi extends Sys.EventArgs{constructor(Q){super();this.OEf=Q}}Object(e.a)(Bi,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var en=c(841),Jm=c(719),fn=c(1012),Rm=c(637),Km=c(1709),Bm=c(1707),sk=c(228),Jn=c(152);class yg{constructor(Q,
ya,kb,Mb,vc,id){this.fTf=this.xg=null;this.nSc=this.Teg=!1;this.Sk=null;this.G3c=Q.runtime.G3c;this.Ip=Q;this.Yd=ya;this.Sg=kb;this.nn=Mb;this.fMk=vc;this.graphNodeComplexMerge=id}}Object(e.a)(yg,"GraphNodeComplexMergeState",null,[]);var Cm=c(1511),Ni=c(1492);class Ci{constructor(Q,ya=null){this.Qg=Q;this.VUb=ya||this.tLc()}get Rjb(){return this.VUb}get Yd(){return this.Qg}tLc(){return[Object(a.a)(this,this.Gbo,"simpleMerge"),Object(a.a)(this,this.wLk,"complexMerge")]}e4n(Q,ya,kb,Mb,vc,id){ya=new yg(Q,
kb,new fb.a(()=>new Cm.a(Mb?Mb.rm:null,vc)),new fb.a(()=>new Cm.a(Mb?Mb.rm:null,id)),new fb.a(()=>new Cm.a(id,vc)),ya.Izh(vc,()=>Q.runtime.$b));ya.xg=Mb.YXb;ya.fTf=new sk.a;return ya}merge(Q,ya,kb,Mb,vc,id){ya=this.e4n(Q,ya,kb,Mb,vc,id);kb=!0;for(Mb=0;Mb<this.Rjb.length&&kb;Mb++)(kb=(0,this.Rjb[Mb])(ya))||Q.logger.UXd("GraphNodeMerge.GetMergeFunctions()",Mb);if(Q=ya.nSc&&ya.Sk?new Ni.a(ya.Sk,!1):null)switch(Q.A2n(ya.xg),(Q?Q.rm:vc).Rc){case 1074135145:ya.Ip.runtime.k7d.ENk.Z(Q.rm.id,Q.rm);break;case 1074135153:ya.Ip.runtime.k7d.msk.Z(Q.rm.id,
Q.rm);break;case 1074135127:ya.Ip.runtime.k7d.rKk.Z(Q.rm.id,Q.rm);break;case 393230:ya.Ip.runtime.oZd.add(Q.rm.id)}return{returnValue:ya.nSc,Sk:Q}}Gbo(Q){if(Q.Ip.runtime.$b&&Q.Ip.runtime.$b.CDb(1000005)&&0<Q.xg.count)return!0;var ya=Q.graphNodeComplexMerge.w5d;return Q.nn.value.pQc(ya)&&Q.fMk.value.pQc(ya)?Q.Sg.value.pQc(ya)?!0:(ya=Q.nn.value.Af,Q.nSc=!0,Q.Sk=ya.aH(),!1):(Q.nSc=!0,!1)}wLk(Q){const ya=Q.nn.value.Af;Q.G3c&&Jn.a.instance.Sa(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
ya.id,ya.Rc);const kb=Q.graphNodeComplexMerge.cbg(Q);Q.nSc=kb;Jn.a.instance.Sa(4018184,1,kb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",kb?"Succeeded":"Failed",ya.id,ya.Rc,!!Q.Sk);return kb}}Object(e.a)(Ci,"GraphNodeMerge",null,[1921]);class gg extends Uj.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}el(){return 33}static construct(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng){const Fg=new gg;Fg.FileId=Q;Fg.BaseRevisions=ya;Fg.TheirRevisions=kb;Fg.YourRevisions=Mb;Fg.IgnoreConflictsInLastServerRevision=vc;Fg.MergeHint=id;Fg.ObjectSpaceId=ae?Oe.a(ae):null;Fg.RequestId=we?Oe.a(we):null;Fg.Source=Ee;Fg.Reason=jf;Fg.Prompt=Ng;return Fg}}Object(e.a)(gg,"CreateGraphMergeReplayRequest",Uj.a,[]);var oo=c(807),Df=c(251),$l=c(17),sl=c(1820),Eg=c(1884);class To{constructor(Q,
ya=null,kb=null){this.A7k=(Mb,vc)=>{let id=Mb;var ae=vc,we=this.W$a.get(Mb);if(!we)return{dGa:id,hLb:ae};ae=new sk.a;ae.add(we);var Ee=this.Stb.get(Mb)||this.aF.J(Mb);we=new sk.a;we.add(Ee);Ee=new sk.a;Ee.add(this.aF.J(Mb));na.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.OG.Fof,this.OG.Lga,this.o_h(we),this.o_h(ae));var jf=this.E_h(this.OG.Lga);this.jll(jf,Mb,ae);we=new sl.a(jf,Ee,1===jf.input.Lga?
we:ae,1===jf.input.Lga?ae:we,this.E_h(1),we,ae);ae=new sk.a;for(Ee=0;Ee<vc.length;Ee++){this.OG.sG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Ng=({H4a:id,Voa:jf}=we.b7c(Mb,vc.J(Ee))).returnValue;ae.add(jf);Ng?na.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Mb,vc.J(Ee),id,jf):na.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Mb)}return{dGa:id,hLb:ae}};this.OG=Q;this.aF=Q.nk;this.W$a=Q.Flo;this.Stb=Q.zKo;this.UTj=Q.uHm;this.Qg=ya||new fn.a;this.rYj=kb||this.A7k}RGc(Q){const ya=new sk.a;for(let kb=0;kb<Q.length;kb++){const Mb=this.r7k(Q.J(kb));ya.add(Mb)}return ya}QGc(Q,ya,kb){const Mb=Q.Ws===Q.fx&&Q.startCp===Q.endCp;ya&&({dGa:Q.Ws,Voa:Q.startCp}=this.bTa(Q.Ws,Q.startCp,Q.Ws),Mb&&(Q.fx=Q.Ws,Q.endCp=Q.startCp));kb&&!Mb&&({dGa:Q.fx,Voa:Q.endCp}=this.bTa(Q.fx,Q.endCp,Q.fx));return Q}r7k(Q){if(Q.Ws===Q.fx){var ya=new sk.a;
ya.add(Q.startCp);ya.add(Q.endCp);({dGa:Q,hLb:ya}=this.idg(Q.Ws,ya));return new oo.a(Q,ya.J(0),Q,ya.J(1))}ya=new sk.a;var kb=new sk.a;let Mb;ya.add(Q.startCp);({dGa:ya,hLb:Mb}=this.idg(Q.Ws,ya));kb.add(Q.endCp);({dGa:Q,hLb:kb}=this.idg(Q.fx,kb));return new oo.a(ya,Mb.J(0),Q,kb.J(0))}idg(Q,ya){let kb=Q,Mb=ya;if(!this.aF.J(Q))return na.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{dGa:kb,
hLb:Mb};if(this.W$a.get(Q))({dGa:kb,hLb:Mb}=this.rYj(Q,ya,kb,Mb));else if(this.OG.Orf&&!this.OG.Orf.J(this.OG.Orf.length-1).w3(Q)){Mb=new sk.a;for(let vc=0;vc<ya.length;vc++){let id;({dGa:kb,Voa:id}=this.bTa(Q,ya.J(vc),kb));Mb.add(id)}}return{dGa:kb,hLb:Mb}}o_h(Q){let ya="";Q.forEach(kb=>{ya+=kb.Q5c();ya+=" ";return!0});return ya}E_h(Q){const ya=za.a.instance.Pa("Box4.IFeatureHelper"),kb=new Eg.a;kb.input.source=this.OG.Fof;kb.input.Lga=this.OG.Lga;kb.input.vIc=()=>ya;kb.runtime.nk=this.aF;kb.runtime.LBa=
this.OG.UKk;1===Q?(kb.runtime.uu=this.Stb,kb.runtime.vq=this.W$a,kb.runtime.qGd=this.OG.Aqi,kb.runtime.ahe=this.OG.Tqi):2===Q&&(kb.runtime.uu=this.W$a,kb.runtime.vq=this.Stb,kb.runtime.qGd=this.OG.Tqi,kb.runtime.ahe=this.OG.Aqi);kb.runtime.$b=ya;return kb}jll(Q,ya,kb){if(Q.runtime.uu.ub(Df.a.VK)){var Mb=Q.runtime.uu.J(Df.a.VK);Mb=this.Qg.getPropertyObjectIds(Mb,Kj.a.v0);if(1===Mb.length&&(Mb=Mb.J(0),Q.runtime.uu.ub(Mb)&&(Mb=Q.runtime.uu.J(Mb),3===this.Qg.getPropertyInt32(Mb,Kj.a.Job)))){const vc=
this.Qg.getPropertyString(Mb,Kj.a.Bia),id=this.Qg.getPropertyString(Mb,Kj.a.EOb);ya.toString()===vc&&vc===id&&(ya=this.Qg.getPropertyObjectId(Mb,Kj.a.e7c),Q.runtime.uu.ub(ya)&&kb.add(Q.runtime.uu.J(ya)))}}}RNl(Q,ya){let kb=0;for(let Mb=0;Mb<Q.length;Mb++)if(ya.equals(Q.J(Mb)))return kb=Mb,{returnValue:!0,idx:kb};return{returnValue:!1,idx:kb}}bTa(Q,ya){const kb=this.UTj&&!!this.Stb.J(Q)&&!this.aF.J(Q);let Mb=Q,vc=ya,id=!1,ae=!1;(kb?this.Stb:this.W$a).forEach((we,Ee)=>{this.OG.sG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.hxf(Ee.Rc)&&this.aF.J(we)){Ee=null;if(kb){Ee=this.QLc(Ng=>this.Stb.J(Ng)||this.aF.J(Ng),we);var jf=this.$Td(Ee,Q)}else jf=this.QLc(Ng=>this.aF.J(Ng),we),jf=this.$Td(jf,Q);if(jf&&(ae=!0,Ee||(Ee=this.QLc(Ng=>this.Stb.J(Ng)||this.aF.J(Ng),we)),we=this.QLc(Ng=>this.W$a.J(Ng)||this.aF.J(Ng),we),jf=0,({idx:jf}=this.RNl(Ee,Q)).returnValue)){for(let Ng=jf+1;Ng<Ee.length;Ng++)if(this.$Td(we,Ee.J(Ng)))return vc=0,Mb=Ee.J(Ng),id=!0,!1;for(--jf;0<=jf;jf--)if(this.$Td(we,Ee.J(jf)))return vc=Number.MAX_VALUE,
Mb=Ee.J(jf),id=!0,!1}}return!0});id||(na.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,ya,kb,ae),5===this.OG.Fof&&(na.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Mb),({uOh:ya}=this.cDl()).returnValue?(Mb=ya,vc=0,na.ULS.sendTraceTag(17340241,
318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Mb)):na.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Mb)));return{dGa:Mb,Voa:vc}}cDl(){let Q=ee.a.nil,ya=new sk.a;this.W$a.forEach((kb,Mb)=>{this.OG.sG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.hxf(Mb.Rc)?(ya=this.QLc(vc=>this.W$a.J(vc)||this.aF.J(vc),kb),!1):!0});return 0<ya.length?(Q=ya.J(0),{returnValue:!0,uOh:Q}):{returnValue:!1,uOh:Q}}hxf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}QLc(Q,ya){var kb=Q(ya);ya=new sk.a;if(!this.hxf(kb.Rc))return ya;kb=this.Qg.getPropertyObjectIds(kb,$l.a.gf);for(let Mb=0;Mb<kb.length;Mb++){const vc=new sk.a;this.plf(Q,kb.J(Mb),vc);ya.VA(ya.length,vc)}return ya}plf(Q,ya,kb){var Mb=Q(ya);if(Mb)if(393230===Mb.Rc)kb.add(ya);else if(393229===
Mb.Rc)ya=this.Qg.getPropertyObjectIds(Mb,$l.a.FL).ig(0),this.plf(Q,ya,kb);else if(393250===Mb.Rc||393251===Mb.Rc||393252===Mb.Rc)for(ya=this.Qg.getPropertyObjectIds(Mb,$l.a.gf),Mb=0;Mb<ya.length;Mb++)this.plf(Q,ya.J(Mb),kb)}$Td(Q,ya){for(let kb=0;kb<Q.length;kb++)if(ya.equals(Q.J(kb)))return!0;return!1}}Object(e.a)(To,"GraphMergeSelectionRecordUpdater",null,[]);class Yk extends Km.a{constructor(Q=null,ya=null,kb=null,Mb=null,vc=null,id=null,ae=null,we=null,Ee=-1,jf=null,Ng=null,Fg=null){super();this.cBh=
ck=>{const Ki=ck.rW,Il=If.App.xa.jb.Yc;return new en.a(ck,Ki,Il.Bd,Il.fileId,Il.MKb,Il.contextId,Ki?Ki.id:ee.a.nil,this.i_i,!1,!0)};this.KR=Q||(()=>F.AFrameworkApplication.rootQuerySignature);ya||(ya=ck=>new Jm.a(ck));this.k3g=ya;this.Qg=kb||new fn.a;this.LDg=ae||new Bm.ChildNodeListMerge(this.Yd);this.rWb=we;this.i_i||(this.rWb=(ck,Ki,Il)=>new Rm.a(ck,Ki,Il));this.VUb=Mb||this.tLc();this.J9a=vc||new sd.a;this.qMg=id||new Ci(this.Yd);this.YVg=void 0===Ee||null===Ee||-1===Ee?zi.App.Stj:Ee;this.Dya=
jf;this.pIa=Ng;this.DNd=this.L3k(Fg);this.VJg=()=>za.a.instance.Pa("Box4.IFeatureHelper")}L3k(Q){Q||(Q=F.AFrameworkApplication.K?F.AFrameworkApplication.K.pc("WordEditorGraphMergeBackupCasesBrowser",0):0);return Q}UCa(){return(new Date).getTime()}gfj(Q,...ya){return String.format.apply(null,[Q].concat(ya))}$lo(Q){throw bk.a.invalidOperation(Q);}PJd(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}Fjn(Q){if(this.Dya&&this.Dya.Ooi||!this.Qho(Q))return null;this.YKm(Q);
let ya;({Bqk:Mb,Elo:vc,yKo:ya}=this.YWk(Q,this.cBh));const kb=Km.a.jEl(Q);var Mb=gg.construct(this.KR(),Mb.Vxa(),vc.Vxa(),ya.Vxa(),Q.input.lEb,Q.input.Lga,Q.input.gm,Q.input.JHb,Q.input.source,kb,this.pIa.Mwa);var vc=Q.output.gM;3===kb&&0<vc.length&&(Mb.MergedRevision=this.cBh(Q.output.gM.last()));return Mb}RGc(Q,ya){return(new To(Q)).RGc(ya)}QGc(Q,ya,kb,Mb){return(new To(Q)).QGc(ya,kb,Mb)}}Object(e.a)(Yk,"GraphMerger",Km.a,[]);class wm extends Yk{constructor(Q,ya=null,kb=null){super(Q,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,ya,kb);this.sa=new k.a}get Mwa(){return this.pIa?this.pIa.Mwa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}lfk(Q){this.sa.addHandler(wm.Dof,Q)}IFn(Q){this.sa.removeHandler(wm.Dof,Q)}N4f(){return!1}Gac(Q,ya,kb,Mb,vc,id,ae){(Q=super.Gac(Q,ya,kb,Mb,vc,id,ae))&&this.sa.raiseEvent(wm.Dof,new Bi(Q));return Q}}wm.Dof="GMC";Object(e.a)(wm,"WordEditorGraphMerger",Yk,[1930,1359,1360]);class tl{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}xc(Q){this.W=
Q;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new rl(this.W.Za("WordEditor.IBusinessBarController"),new fb.a(()=>Q.Pa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new ei(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>
new wm(()=>F.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new $h(()=>F.AFrameworkApplication.rootQuerySignature,F.AFrameworkApplication.ya,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),
this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){If.App.cR||(If.App.cR=Pd.a.Nea());const Q=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");If.App.cR.urk(Q);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.W.Pa("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(e.a)(tl,"GraphMergePackage",null,[1,2]);var Dh=c(302);class Lk{constructor(Q){this.spe="FontPicker";this.fze=null;this.N7a=Q;this.Odd=
this.N7a.Wwa(Dh.a.TGb,Object(a.a)(this,this.oBb,"featureStateChangeCallback"));this.N7a.isFeatureEnabled(Dh.a.TGb,!1).then(ya=>{this.fze=ya})}get isLicensed(){return this.fze}oBb(Q){this.fze=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.spe,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.N7a.oec(Dh.a.TGb,this.Odd)}}Object(e.a)(Lk,"ModernFontPickerFeatureHelper",null,[1069,9]);var tk=c(504),tp=c(656),Jp=c(1615);class zo{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=
null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(zo,"FontInfoTaskPaneProps",null,[]);class Oq{constructor(Q,ya,kb,Mb=null){this.sPe=this.sV=this.Odd=null;this._state=this.sUb=0;this.ZBe=Q;this.N7a=ya;this.hFj=kb;this.Vb=Mb}get Bc(){return this.ZBe.value}initialize(){this.Bc.pa(Ua.a.YYf,We.a.frame,Object(a.a)(this,this.YYf,"requestFontInfo"));this.Odd=this.N7a.Wwa(Dh.a.TGb,Object(a.a)(this,this.oBb,"featureStateChangeCallback"));this.Wha()}wO(Q=!1){const ya=
fg.UISurfaces.wu(),kb=this.N7a.isFeatureEnabled(Dh.a.TGb,!1),Mb=[];Mb.push(ya);Mb.push(kb);Promise.all(Mb).then(vc=>{vc[0].showTaskPane(Jp.a.JBb,this.Pz(vc[1]));Q&&this.wJ()})}Ezo(Q){fg.UISurfaces.wu().then(ya=>{ya.updateTaskPane(Jp.a.JBb,this.Pz(Q));return null})}oBb(Q){this.Ezo(Q.isEnabled)}YYf(Q,ya,kb,Mb,vc){this.sV=vc.CommandValueId;this.sPe=vc.Trigger;this.sUb=vc.InputMethod;this.wO(2===this._state&&1===this.sUb);return 32}Pz(Q){const ya=new zo;ya.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,
"onUpsellButtonClicked");ya.fontName=this.sV;ya.isLicensed=Q;ya.trigger=this.sPe;ya.helpArticleUrl=this.IMk();ya.paneId=Jp.a.JBb;Q=this.ucm();Q.contentProps=ya;return Q}ucm(){return Object.assign(new fl.a,{title:Jp.a.Jcc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,
"onHide")})}Wha(){if(this.Vb){var Q=this.Vb.le(Jp.a.JBb);Q.parent=of.AFrame.Hp;Q.BK=!0}}onOpen(){this._state=2;this.wJ()}onShow(Q){0!==this._state&&(this._state=2,1===Q&&(this.sUb=Q),this.wJ())}onClose(){this.sUb=this._state=0;this.blur()}onHide(){this._state=1;this.sUb=0}wJ(){this.Vb&&1===this.sUb&&this.Vb.Dg(Jp.a.JBb)}blur(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===Jp.a.JBb&&this.Vb.Dg(this.Vb.QS)}onUpsellButtonClicked(){this.N7a.launchUpsellExperience(Jp.a.experienceId)}dispose(){this.N7a.oec(Dh.a.TGb,
this.Odd)}IMk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.hFj,this.eFl(),"WDWAENDUSER",F.AFrameworkApplication.lcid)}eFl(){switch(this.sPe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Oq.Vtk(this.sV)}static Vtk(Q){let ya="hlpFontInfo";for(let kb=0;kb<Q.length;++kb){const Mb=qb.a.charAt(Q,
kb);if(255<Q.charCodeAt(kb)||qb.a.QRd(Mb))ya+=Mb}return ya}}Object(e.a)(Oq,"FontInfoPane",null,[942,9]);class xq extends Oq{constructor(Q,ya,kb,Mb,vc){super(Q,ya,Mb.lb("FontInfoHelpBaseUrl"),vc);this.Y1=kb}wO(Q){this.qZ();super.wO(Q)}oBb(Q){super.oBb(Q);If.App.xa.updateCommandUI()}qZ(){this.Y1.yMa()}}Object(e.a)(xq,"WordEditorFontInfoPane",Oq,[]);class Hl{constructor(){this.VSb=this.bkd=this.lqc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}xc(Q){this.W=Q;Q.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Lk(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();Q.ha("Common.ModernFontPicker.IFontInfoPane",()=>new xq(new fb.a(()=>F.AFrameworkApplication.ya),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Hp.a.instance,F.AFrameworkApplication.K,eh.FocusManager.instance())).singleInstance()}init(){this.bkd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.lqc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.lqc.initialize();F.AFrameworkApplication.K.$("IsAnonymousUser")||((this.VSb=this.W.Pa(tp.a))?this.VSb.initialize():na.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));If.App.xa.updateCommandUI()}dispose(){this.lqc&&(this.lqc.dispose(),this.lqc=null);this.bkd&&(this.bkd.dispose(),this.bkd=null);this.VSb&&(this.VSb.cta(),this.VSb=null)}static main(){Object(tk.a)()&&ca.a.instance.Kc(new Hl)}}Object(e.a)(Hl,"ModernFontPickerPackage",null,[1,2]);var gj=c(131),Vd=
c(5),Ao=c(261),mb=c(40),hc=c(1083);class Nc{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,Fg=null){this.pY=kb;this.Zc=Q;this.Ic=ya;this.Bh=vc;this.$Ha=id;this.dV=ae;this.pDg=we;this.oDg=Ee;this.zx=jf;this.BIj=Fg||Nc.Dw}get qh(){return this.zx?this.zx.qh:!1}Udi(Q){return this.QDa(Q,0)}sfm(Q){return this.QDa(Q,1)}QDa(Q,ya){let kb=null;if(this.qh&&this.dV&&(this.oDg.instance&&this.oDg.instance.mHa(Q),ya?1===ya&&(kb=this.dV.r_h(Q.node)):kb=this.dV.shf(Q.node,Q.cpBegin,Q.Fb),kb&&!kb.ia(Kj.a.w7,!1)))return na.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Mb=Vd.GraphIterator.PW(this.Zc.Bk());Mb.set(Q.node);Mb.Ab(10);const vc=this.Ic.Qc(15);vc.ev(Mb);ya?mb.OutlineElementNavigator.$d(Mb):(this.splitParagraph(Mb,Q),this.pY.yjc(Q.node,cf.a.us));Q=tm.ParagraphReader.Il(Mb.currentNode);this.Egm(Mb);this.qh&&kb&&this.pDg&&(ya=new X.a,ya.add(Mb.currentNode),this.pDg.ech(ya,kb.id));this.UYn(Q);vc.dispose();return 32}UYn(Q){Q=Pj.SelectionFactory.we(Q,0);rp.a.instance.setSelection(Q)}Egm(Q){this.Bh.pD(Q,
!0,!0,null,!1,!1);Q=mb.OutlineElementNavigator.Ee(Q);this.tfm(Q)}splitParagraph(Q,ya){const kb=mb.OutlineElementNavigator.$d(Q);if(ya.cpBegin||this.qh&&(!this.qh||-1!==ya.Fb)){If.App.yd.Xp&&ya.cpBegin!==tm.ParagraphReader.textLength(ya.node)&&If.App.yd.Vq.WG(ya.node);this.Bh.pD(Q,!1,!0,null,!1,!0);var Mb=Vd.GraphIterator.PW(this.Zc.Bk());Mb.set(kb);this.Bh.P8(Mb,Q,ya,!0,!0,!0)}}tfm(Q){Q=this.BIj(Q);this.$Ha.rei(Q)}static kE(){return new Nc(new cr.a,new dg.a,za.a.instance.resolve("Box4.IAutoCorrectScheduler"),
hc.a.instance,za.a.instance.resolve("Box4.IOutlineElementEditor"),za.a.instance.resolve("Box4.IBlobEditor"),za.a.instance.Pa("Box4.IContentControlReader"),za.a.instance.Pa("Box4.IContentControlEditor"),za.a.instance.Za("Box4.IContentControlConverter"),za.a.instance.Pa("Box4.ContentControlConfigSettings"),za.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=Nc.Xrg?Nc.Xrg:Nc.Xrg=Nc.kE()}static Dw(Q){return yo.a.Dw(Q)}}Object(e.a)(Nc,"PageBreakInserter",null,[1976]);class ed{constructor(Q,
ya,kb,Mb,vc,id,ae,we){this.Hgm=(Ee,jf,Ng,Fg)=>{var ck=jf.view,Ki=ck.Bb.Lg;if(!Ki)return 2;if(!this.H_e(jf))return 8;if(1===Ng)return 32;let Il=!0;Ng=8;const wl=this.eAe(Ki);Ki=this.Ic.Qc(15);Ki.Eb(ck.jd);Ki.Kk=Ee;wl||(Ng=this.ga.Tf(jf,pg.a.Cla,2,!0,Fg,null),Ee=32===Ng,na.ULS.shipAssertTag(4208012,314,Ee),Il=Ee);Il&&(ck=ck.Bb.Lg,Ee=this.eAe(ck),na.ULS.shipAssertTag(4208013,314,Ee,"{0}",{["ContextId"]:jf.contextId}),Ng=8,Ee&&(Ng=this.Uxe.Udi(ck),na.ULS.shipAssertTag(4208014,314,32===Ng)));Ki.dispose();
32===Ng&&this.Ud.Ds(10);return Ng};this.Ggm=(Ee,jf,Ng)=>{if(!jf||jf.contextId!==Sf.a.Vc)return 8;if(1===Ng)return jf.contextId===Sf.a.Vc?32:8;if(2===Ng){if(!this.H_e(jf))return 8;Ee=this.Uxe.Udi(jf);32===Ee&&this.Ud.Ds(10);return Ee}return 32};this.Fgm=(Ee,jf,Ng)=>{if(!jf||jf.contextId!==Sf.a.table)return 8;if(1===Ng)return 32;if(2===Ng){if(!this.H_e(jf))return 8;Ee=this.Uxe.sfm(jf);32===Ee&&this.Ud.Ds(10);return Ee}return 32};this.ga=Q;this.Uxe=ya;this.Ic=kb;this.Om=Mb;this.eAe=vc;this.Tk=id;this.wRj=
ae;this.Ud=we}Wb(){this.ga.pa(Bf.a.QDa,Sf.a.view,this.Hgm);this.ga.pa(Bf.a.QDa,Sf.a.Vc,this.Ggm);this.ga.pa(Bf.a.QDa,Sf.a.table,this.Fgm);this.ga.Xc(Bf.a.QDa,4)}c4(){const Q=eh.FocusManager.instance().le(gj.AppFrame.oE);of.AFrame.oi(Q,vd.KeyInputManager.lc(cf.a.us,vd.KeyInputManager.Rh),Bf.a.QDa)}Yqm(Q){return this.Jw(Q.iterator)}wum(Q){Q=Q.J(0);const ya=ql.SelectionEditor.Vj(Q,!0,!1);if(this.Jw(ya.Qa.iterator))return!0;Q=ql.SelectionEditor.Vj(Q,!1,!1);return this.Jw(Q.Qa.iterator)}Jw(Q){return Q.Ab(14)}H_e(Q){let ya=
null,kb=Q;if(kb.contextId===Sf.a.view){ya=kb.view;if(!ya.features.F8f)return!1;kb=ya.Bb.Lg;if(!kb)return!1}else{const Mb=Vd.GraphIterator.$a(kb.node);if(Mb.Ab(36)||Mb.Ab(38)||Mb.Ab(40)||Mb.Ab(14))return!1}return Ao.a.dga(Q)?!1:kb.contextId===Sf.a.table?this.Tk.Jqm(kb.node):!this.Tk.Hqm(kb)||this.Om&&this.Om.instance&&this.Om.instance.PT(kb)?!1:((Q=this.eAe(kb))?this.Yqm(kb):this.wum(ya.Bb.hb))||Q&&this.wRj(kb,!0)?!1:!0}static kE(){return new ed(F.AFrameworkApplication.ya,Nc.instance,new dg.a,za.a.instance.Za("Box4.IExternalSelectionManager"),
ql.SelectionEditor.pf,kh.a.instance,Xl.HyperlinkReader.fga,za.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=ed.Oqg?ed.Oqg:ed.Oqg=ed.kE()}}Object(e.a)(ed,"PageBreakActor",null,[1928]);class Ed{constructor(){this.iGe=this.W=null}get name(){return"WordEditor.PageBreak"}xc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>{this.$m()})}$m(){this.iGe=ed.instance;this.iGe.Wb();this.iGe.c4();If.App.xa.updateCommandUI()}dispose(){}}
Object(e.a)(Ed,"PackageManager",null,[1,2]);var ke=c(1444),Lf=c(1445),Gf=c(236),Cg=c(150),Uh=c(260),nj=c(290),ah=c(474);class ul{constructor(Q,ya,kb,Mb,vc,id,ae){this.Pub=null;this.sa=new k.a;this.Jqe=1;this.Oid=-1;this.WVa=null;this.joa=()=>{this.pZe()};this.ib=ya;this.Gb=kb;this.Mcd=Mb;this.YH=vc;this.xy=id;this.Tda=ae;this.enable()}get IFc(){return this.Jqe}C8i(Q){this.Jqe!==Q&&(this.Jqe=Q,this.sa.raiseEvent("X"),this.lxf&&this.Ucg())}get lxf(){const Q=za.a.instance.Pa("WordEditor.Pagination.IPageEndMarkers");
return Q?Q.lxf:!0}get $e(){return this.YH.value}get ij(){return ui.a.instance}qek(Q){this.sa.addHandler("X",Q)}Ucg(){this.ij.Sd(()=>{this.Tda.oU(ah.a.wJi)},"CPC:UPN")}enable(){this.ib.DA(this.joa);this.pZe()}pZe(){if(!this.WVa||1>=this.WVa.count)this.C8i(1);else{var Q=this.ib.hb.kb;if(Q){var ya=Q.Sf?Q.Tc:Q.Qa;!ya||0>ya.cpBegin||(Q=ya.node)&&tm.ParagraphReader.ic(Q)&&this.rqm(Q)&&(this.Pub&&(this.Gb.Se(this.Pub),this.Pub=null),this.Pub=new Tb.a(2,1,400,kb=>{this.findCurrentPageFromIp(kb,ya)},62),this.Gb.Xb(this.Pub))}}}rqm(Q){Q=
Vd.GraphIterator.$a(Q);return Q.Ab(35)||Q.Ab(37)||Q.Ab(39)?!1:!0}Apj(Q){this.WVa=Q;this.aoj()}aoj(){if(-1!==this.Oid){var Q=this.jil(this.Oid);-1!==Q&&this.C8i(Q)}}findCurrentPageFromIp(Q,ya){this.Pub===Q&&(this.Pub=null,this.Oid=this.Rql(ya),-1!==this.Oid&&this.aoj())}jil(Q){if(!this.WVa)return-1;for(let ya=0;ya<this.WVa.count;ya++){const kb=this.WVa.J(ya);if(Q>kb.Sah&&Q<kb.Sah+kb.height)return kb.si}return-1}Rql(Q){var ya=this.hOl(Q);if(!ya||!ya.htmlElement)return-1;const kb=ya.getBounds();Q=this.Byl(Q,
ya);if(!Q)return-1;ya=da.a.k0a(this.Mcd.K3a,ya.htmlElement).y;return Q.y+Math.floor(Q.height/2)-kb.y+ya}hOl(Q){return Q.node.xe(this.$e.Sb)}Byl(Q,ya){Q=this.xy?this.xy.X$(Q,!0):Q.cpBegin;return nj.a.Cq(ya,Q)}disable(){this.ib.$ba(this.joa)}}Object(e.a)(ul,"CurrentPageCalculator",null,[2010,1973]);class jl{constructor(Q){jl.DY=Q}get e6e(){return jl.DY}get IFc(){return this.e6e.IFc}nal(){this.e6e.enable()}g5k(){this.e6e.disable()}}jl.DY=null;Object(e.a)(jl,"CurrentPageManager",null,[2008]);var Lm=c(124);
class xh extends Sys.EventArgs{constructor(Q,ya){super();this.bAi=ya}}Object(e.a)(xh,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Dm extends Sys.EventArgs{constructor(Q,ya,kb){super();this.delta=Q;this.bAi=kb}}Object(e.a)(Dm,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class Bo{constructor(Q,ya,kb){this.Y0g=this.fnd=-1;this.tvc=null;this.sa=new k.a;this.oEe=!1;this.edn=(Mb,vc)=>{this.oEe=this.iDk();vc.blb||this.Opc.value.measure(this.dDk)};this.dDk=()=>{const Mb=this.K3a.clientHeight;
this.cDk(Mb);this.lDk(Mb)};this.vOf=(Mb,vc)=>{vc.property===Lm.a.wI&&(Mb=vc.node)&&Mb.ia(Lm.a.wI,!1)&&(Mb=Mb.xe(this.$e.Sb))&&(Mb=Mb.htmlElement)&&this.TVa.add(Mb)};this.YH=Q;this.Opc=ya;this.TVa=new X.a;this.$e.Leh(this.edn);this.yqf();this.tba=this.tba.bind(this);kb.Jxb(this.tba)}get $e(){return this.YH.value}tba(){this.tvc=null}get K3a(){this.tvc||(this.tvc=this.$e.jd.xe(this.$e.Sb).K3a,na.ULS.shipAssertTag(34136386,336,!!this.tvc));return this.tvc}yfk(Q){this.sa.addHandler("OnPageContentSizeChangeKey",
Q)}cDk(Q){Q!==this.Y0g&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new xh(Q,this.oEe)),this.Y0g=Q)}lDk(Q){Q!==this.fnd&&(-1!==this.fnd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new Dm(Q-this.fnd,Q,this.oEe)),this.fnd=this.K3a.clientHeight)}iDk(){let Q=!1;for(let ya=this.TVa.count-1;0<=ya;ya--)this.TVa.J(ya).hasChildNodes()&&(this.TVa.removeAt(ya),Q=!0);return Q}yqf(){If.App.kk.sl.Xe(23).Ap(this.vOf)}}Object(e.a)(Bo,"DocumentSizeManager",null,[]);var gn=c(62),hn=c(262);class tr{constructor(Q){this.YH=
Q}get $e(){const Q=this.YH.value;na.ULS.shipAssertTag(37820298,336,Q.mi,"OutlineManager.PageView is not a PageView.");return Q}Nae(Q,ya){const kb=gn.a.Mi(tr.Uf.OA(Q),1);ya+=kb;Q.xe(this.$e.Sb).htmlElement.firstChild.style.minHeight=ya+"px"}kXh(){const Q=Vd.GraphIterator.$a(this.$e.jd);Q.jo();Q.Vd();na.ULS.shipAssertTag(37820299,336,10===Q.Hn.type);return Q.Hn}KZh(){const Q=Vd.GraphIterator.$a(this.$e.jd);Q.jo();Q.Haa();na.ULS.shipAssertTag(37820300,336,10===Q.Hn.type);return Q.Hn}VPl(Q){const ya=
Vd.GraphIterator.$a(this.$e.jd);ya.jo();ya.Vd();let kb=ya.Hn,Mb=null;for(;Q!==kb&&ya.Rj();)Mb=kb,kb=ya.Hn;na.ULS.shipAssertTag(37820301,336,10===ya.Hn.type);return Mb}static get Uf(){return hn.a.instance}}Object(e.a)(tr,"OutlineManager",null,[1971]);class yq{constructor(Q){this.Kza=0;this.N0=null;this.s5f=ya=>{for(const kb of ya.customData)this.showAdornmentText(kb)};this.Gb=Q}y2d(){this.N0||(this.N0=this.oFc())}nzd(){this.N0&&0<yq.XJc(this.N0).length&&this.Gb.Xb(this.N0);this.N0=null}oFc(){return Object.assign(new Tb.a(3,
1,250,this.s5f,166),{customData:[]})}K2f(Q){this.Kza=Q}N3c(Q){if(Q){Q.style.width=this.Kza+"px";if(this.N0)var ya=this.N0;else ya=this.oFc(),this.Gb.Xb(ya);yq.XJc(ya).push(Q)}}PNc(Q){Q&&(Q.style.width="0px",this.fqf(Q))}W6c(Q,ya){ya?this.N3c(Q):this.PNc(Q)}showAdornmentText(Q){Q.style.width===this.Kza+"px"&&(this.iKc(Q).style.visibility="visible")}fqf(Q){Q&&(this.iKc(Q).style.visibility="hidden")}iKc(Q){Q=Q.childNodes;na.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+
Q.length);return Q[0]}static XJc(Q){return Q.customData}}Object(e.a)(yq,"PageAdornmentAnimationManager",null,[1969]);class jp{constructor(Q){this.Rl=Q;this.S9=new pc.a;this.T9=new pc.a}MBa(Q){Q=Vd.GraphIterator.$a(Q);if(Q.jo()&&Q.Sp()){Q.Vd();do 10===Q.ef&&this.WQf(Q.currentNode),Q.ht();while(8!==Q.ef)}}EMb(Q){const ya=Q.si;var kb=this.gDb(Q.aOb);if(!this.S9.ub(kb))return na.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+kb),!1;Q=
this.S9.J(kb);na.ULS.shipAssertTag(24958353,336,this.T9.ub(kb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");kb=this.T9.J(kb);return this.aqf(Q,ya,kb)}DMb(Q){const ya=Q.si;var kb=this.gDb(Q.aOb);if(!this.S9.ub(kb))return na.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+kb),!1;Q=this.S9.J(kb);na.ULS.shipAssertTag(24958355,336,this.T9.ub(kb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
kb=this.T9.J(kb);return this.aef(Q,ya,kb)}mnf(Q){if(!Q)return na.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var ya=Q.$wd;if(!ya)return na.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.si)),0;ya=this.Rl.tCb(ya);if(!ya)return na.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;ya=this.Rl.Jfa(ya);const kb=1===Q.si;Q=!(Q.si%2);return 1===ya?1:
2===ya?kb?2:1:3===ya?Q?3:4:kb?2:Q?3:4}WQf(Q){if(10===Q.type){var ya=new pc.a,kb=this.Rl.tCb(Q);na.ULS.shipAssertTag(24958356,336,!!kb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Mb=this.Rl.Jfa(kb);Q=this.gDb(Q);this.fdg(Q,Mb);this.edg(Q,ya);kb=Vd.GraphIterator.$a(kb);if(kb.Sp()){kb.Vd();do Q=kb.currentNode,Mb=this.Rl.dLc(Q),Q=this.Rl.eai(Q),ya.add(Mb,Q),kb.ht();while(36===kb.ef)}}}fdg(Q,ya){this.T9.ub(Q)?this.T9.Z(Q,
ya):this.T9.add(Q,ya)}edg(Q,ya){this.S9.ub(Q)?this.S9.Z(Q,ya):this.S9.add(Q,ya)}gDb(Q){na.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ia(Kj.a.Hha,0)}aqf(Q,ya,kb){const Mb=1===ya;ya=!(ya%2);switch(kb){case 2:if(Mb){if(Q.ub(2))return Q.J(2)}else if(Q.ub(0))return Q.J(0);break;case 3:if(ya){if(Q.ub(1))return Q.J(1)}else if(Q.ub(0))return Q.J(0);break;case 4:if(Mb){if(Q.ub(2))return Q.J(2)}else if(ya){if(Q.ub(1))return Q.J(1)}else if(Q.ub(0))return Q.J(0);
break;case 1:if(Q.ub(0))return Q.J(0)}return!1}aef(Q,ya,kb){const Mb=1===ya;ya=!(ya%2);switch(kb){case 2:if(Mb){if(Q.ub(5))return Q.J(5)}else if(Q.ub(3))return Q.J(3);break;case 3:if(ya){if(Q.ub(4))return Q.J(4)}else if(Q.ub(3))return Q.J(3);break;case 4:if(Mb){if(Q.ub(5))return Q.J(5)}else if(ya){if(Q.ub(4))return Q.J(4)}else if(Q.ub(3))return Q.J(3);break;case 1:if(Q.ub(3))return Q.J(3)}return!1}}Object(e.a)(jp,"PageAdornmentContentManager",null,[1970]);var Lp=c(1139);class Si{constructor(Q,ya,
kb,Mb,vc,id,ae,we,Ee){this.keg(Q,ya,kb,id,ae,we,Ee);this.si=Q;this.Aq=ya;this.As=kb;this.aOb=Mb;this.$wd=vc;this.Edb=id;this.G6b=ae;this.V3b=we;this.NJi=Ee}get top(){return this.Aq}get height(){return this.As}b3c(Q){this.Aq!==Q&&(this.Edb.style.top=Q+"px",this.Aq=Q)}m2f(Q){this.height!==Q&&(this.Edb.style.height=Q+"px",this.As=Q)}keg(Q,ya,kb,Mb,vc,id,ae){na.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);na.ULS.shipAssertTag(37244962,
336,0<=ya,"PageAdornmentContainer: top parameter value {0} is unexpected value.",ya);na.ULS.shipAssertTag(37244963,336,0<=kb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",kb,ya);na.ULS.shipAssertTag(37244992,336,!!Mb,"PageAdornmentContainer: containerDomElement parameter is null.");na.ULS.shipAssertTag(37244993,336,!!vc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");na.ULS.shipAssertTag(37244994,336,!!id,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
na.ULS.shipAssertTag(37244995,336,!!ae,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(e.a)(Si,"PageAdornmentContainer",null,[2E3]);class Oh{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,Fg,ck){this.eNg="headerFooterTab";this.Drd=null;this.Ku=!0;this.lwe=0;this.rBe=null;this.I0a=!1;this.GIb=Ki=>{this.c0m(Ki.Pv);return!0};this.dB=()=>!0;this.XDb=()=>{this.B3e()&&(this.I0a=!1,this.cvo(),this.rBe=new Date)};this.IIb=Ki=>{this.I0a||this.ZU.N3c(Ki.Pv);return!0};this.HIb=Ki=>
{this.I0a||(Ki=Ki.Pv,this.b5f(Ki)||this.ZU.PNc(Ki));return!0};this.Kyn=()=>{let Ki=Array.dequeue(this.NIe);for(;Ki;)this.qU(Ki),Ki=Array.dequeue(this.NIe);this.Drd=null};this.YH=Q;this.qg=ya;this.ND=kb;this.Tia=Mb;this.ga=vc;this.Qj=id;this.ZU=ae;this.Vya=we;this.vJa=Ee;this.Gb=jf;this.Ma=Ng;this.NIe=[];this.J0=new Map;this.WH=Fg;this.Tw=ck;this.vJa.dvd(this.XDb);this.ww=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.vX;if(this.ehd=(this.fye=!!this.Ma&&this.Ma.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&
!!this.Ma&&this.Ma.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===If.App.xa.eI.getLayoutBreakpoint()&&(this.Ku=!1),If.App.xa.eI.registerLayoutBreakpointChanged(this.eNg,Ki=>{switch(Ki){case "Small":this.Cai();break;default:this.Fbj()}})}get $e(){return this.YH.value}Fbj(){try{this.U$n()}catch(Q){na.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}Cai(){try{this.l8l()}catch(Q){na.ULS.shipAssertTag(37244998,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}kEn(){for(const Q of this.J0.keys())this.S7d(Q)}MBa(){try{this.HLk()}catch(Q){na.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}Apj(Q){try{this.yzo(Q)}catch(ya){na.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",ya.message)}}dispose(){try{this.Dto(),this.iuo(),this.vJa&&this.vJa.vWi(this.XDb)}catch(Q){na.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}c0m(Q){const ya=this.MQc(Q),kb=this.HUh(Q);kb?(Q=this.Vya.mnf(kb),this.ga.Ub(ya?Bf.a.Die:Bf.a.i8c,2,Q),this.I0a=!0):(na.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.processAction(Bf.a.PQd,2))}Dto(){this.J0.forEach(Q=>{this.WSa(Q)})}iuo(){this.ww&&(this.ehd&&(If.App.xa.eI.unregisterLayoutBreakpointChanged(this.eNg),this.ehd=
!1),this.ww=!1)}WSa(Q){if(Q){var ya=Q.G6b;Q=Q.V3b;Wg.a.AEa(ya)&&Wg.a.AEa(Q)?(this.Qj.sc(A.a.DQ,ya,this.IIb),this.Qj.sc(A.a.DQ,Q,this.IIb),this.Qj.sc(A.a.GK,ya,this.HIb),this.Qj.sc(A.a.GK,Q,this.HIb),this.qg.sc(A.a.click,ya,this.GIb),this.qg.sc(A.a.click,Q,this.GIb),this.ND.sc(ya,Oh.xIb),this.ND.sc(Q,Oh.xIb),this.Tia.sc(A.a.qx,ya,this.dB),this.Tia.sc(A.a.qx,Q,this.dB)):na.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Gqn(Q){this.NIe.push(Q);
this.Drd||(this.Drd=new Tb.a(2,1,50,this.Kyn),this.Gb.Xb(this.Drd))}qU(Q){if(Q){var ya=Q.G6b;Q=Q.V3b;Wg.a.AEa(ya)&&Wg.a.AEa(Q)?(this.Qj.mb(A.a.DQ,ya,this.IIb),this.Qj.mb(A.a.DQ,Q,this.IIb),this.Qj.mb(A.a.GK,ya,this.HIb),this.Qj.mb(A.a.GK,Q,this.HIb),this.qg.mb(A.a.click,ya,this.GIb),this.qg.mb(A.a.click,Q,this.GIb),this.ND.mb(ya,Oh.xIb),this.ND.mb(Q,Oh.xIb),this.Tia.mb(A.a.qx,ya,this.dB),this.Tia.mb(A.a.qx,Q,this.dB)):na.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}U$n(){if(!this.Ku){for(const Q of this.J0.values())Q.Edb.style.display=
"block";this.Ku=!0}}l8l(){this.Ku&&(this.J0.forEach(Q=>{Q.Edb.style.display="none"}),this.Ku=!1)}HLk(){this.Vya.MBa(this.$e.jd)}yzo(Q){this.ZU.y2d();var ya=0;const kb=new X.a;this.MBa();const Mb=this.DHl();for(var vc of Q)Q=vc.si,this.Ccn(vc)||this.S7d(vc.si),this.J0.has(Q)?this.pwo(vc):this.ZRk(vc),ya=Q,kb.add(Q);for(vc=1;vc<=ya;vc++)kb.contains(vc)||this.S7d(vc);for(ya+=1;ya<=Mb;ya++)this.S7d(ya);this.ZU.nzd()}Ccn(Q){return this.J0.has(Q.si)?this.J0.get(Q.si).aOb.id===Q.aOb.id:!1}DHl(){let Q=0;
this.J0.forEach((ya,kb)=>{kb>Q&&(Q=kb)});return Q}ZRk(Q){const ya=Q.aOb.xe(this.$e.Sb);if(ya){var kb=Q.si;Q=this.$Ec(kb,Q.top,Q.height,ya.faa,Q.aOb,Q.$wd);this.Gqn(Q);this.$bg(Q);this.udg(Q);this.ehd&&!this.Ku&&(Q.Edb.style.display="none");this.J0.set(kb,Q)}}$Ec(Q,ya,kb,Mb,vc,id){const ae=qd.b("div","","PageAdornmentContainer");ae.style.top=ya+"px";ae.style.height=kb+"px";Mb.appendChild(ae);this.qZe(ae,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Mb=this.X4e(Q);
ae.appendChild(Mb);const we=this.v4e(Q);ae.appendChild(we);const Ee=this.m4e(Q);ae.appendChild(Ee);F.AFrameworkApplication.isRtl&&(ae.classList.add("Rtl"),we.classList.add("Rtl"),Ee.classList.add("Rtl"));return new Si(Q,ya,kb,vc,id,ae,we,Ee,Mb)}v4e(Q){Q=qd.b("div","h"+Q,this.Tw?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.WH&&(this.Tw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Lp.a.Rie);const ya=qd.b("span","","");ya.innerText=WordEditorIntl.WordEditorStrings.l_Header;
ya.style.whiteSpace="nowrap";Q.appendChild(ya);return Q}m4e(Q){Q=qd.b("div","f"+Q,this.Tw?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.WH&&(this.Tw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Lp.a.Rie);const ya=qd.b("span","","");ya.innerText=WordEditorIntl.WordEditorStrings.l_Footer;ya.style.whiteSpace="nowrap";Q.appendChild(ya);return Q}X4e(Q){const ya=qd.b("div","","PageAdornmentNumberLabel");ya.innerText=Q.toString();return ya}qZe(Q,ya,kb){if(!this.lwe){const Mb=
qd.b("p","","");Mb.innerText=ya;Mb.style.whiteSpace="nowrap";Mb.style.visibility="hidden";Q.appendChild(Mb);ya=qd.b("p","","");ya.innerText=kb;ya.style.whiteSpace="nowrap";ya.style.visibility="hidden";Q.appendChild(ya);this.lwe=Q.clientWidth;this.ZU.K2f(this.lwe);Q.removeChild(Mb);Q.removeChild(ya)}}S7d(Q){if(this.J0.has(Q)){var ya=this.J0.get(Q);this.WSa(ya);Wg.a.hw(ya.Edb);this.J0.delete(Q)}}pwo(Q){if(this.J0.has(Q.si)){var ya=this.J0.get(Q.si);ya.b3c(Q.top);ya.m2f(Q.height);this.$bg(ya);this.udg(ya)}else na.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}cvo(){this.ZU.y2d();this.MBa();this.J0.forEach(Q=>{this.$bg(Q);this.udg(Q)});this.ZU.nzd()}$bg(Q){const ya=Q.G6b,kb=Q.V3b,Mb=this.Vya.EMb(Q),vc=this.Vya.DMb(Q);this.GBo(Q,Mb,vc);this.ZU.W6c(ya,Mb);this.ZU.W6c(kb,vc)}GBo(Q,ya=!0,kb=!0){const Mb=Q.G6b;Q=Q.V3b;3!==F.AFrameworkApplication.ya.mode?(Mb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Mb.title=
ya?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=kb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}b5f(Q){const ya=this.HUh(Q);return ya?this.MQc(Q)?this.Vya.EMb(ya):this.Vya.DMb(ya):(na.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}HUh(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.J0.has(Q)?this.J0.get(Q):(na.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}MQc(Q){return Q.id.length?"h"===Q.id.substring(0,1):(na.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}udg(Q){const ya=Q.height;ya<Oh.aVm?(Q.G6b.classList.add(Oh.mhb),Q.V3b.classList.add(Oh.mhb)):(Q.G6b.classList.remove(Oh.mhb),Q.V3b.classList.remove(Oh.mhb));ya<Oh.bVm?(Q.NJi.classList.add(Oh.mhb),Q.Edb.classList.add(Oh.mhb)):(Q.NJi.classList.remove(Oh.mhb),Q.Edb.classList.remove(Oh.mhb))}B3e(){return!this.rBe||
H.a.Upf(this.rBe,500)}static xIb(){return!0}}Oh.mhb="Hidden";Oh.aVm=120;Oh.bVm=50;Object(e.a)(Oh,"PageAdornmentManager",null,[1972,9,1973]);class uk{constructor(Q,ya){this.j3d=new X.a;this.j3d.add(Q);this.j3d.add(ya)}}Object(e.a)(uk,"PageElementManagerList",null,[]);var hl=c(66);class vl{constructor(Q,ya,kb){this.Sm=Q;this.tVb=[];this.UJ=ya;this.WH=kb}mUi(){for(let Q=0,ya=this.tVb.length;Q<ya;Q++)Wg.a.hw(this.tVb[Q]);Array.clear(this.tVb)}gWh(Q,ya,kb,Mb,vc,id){let ae=Math.min(Mb.x-id.x,vc.x-id.x);
Mb=Math.min(id.x+id.width-(Mb.x+Mb.width),id.x+id.width-(vc.x+vc.width));ya+=vc.y-id.y;({dha:ya,leftMargin:ae,rightMargin:Mb}=this.Ohk(ya,ae,Mb));Q=this.kNl(Q,ae,Mb,ae,Mb,kb);Q.style.top=ya+"px";Q.style.zIndex="0";this.tVb.push(Q);hl.c(Q,!0);return Q}vLd(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}kNl(Q,ya,kb,Mb,vc,id){return Q?this.gWl(ya,kb,Mb,vc,id):this.CNl(Mb,vc,id)}Ohk(Q,ya,kb){ya/=this.Sm.instance.jj;kb/=this.Sm.instance.jj;Q/=this.Sm.instance.jj;return{dha:Q,leftMargin:ya,rightMargin:kb}}Fpm(Q){return this.tpi(Q)&&
this.DJi(Q)?(Q=this.WCb(Q))&&Q.offsetParent?!1:!0:!1}Epm(Q){return!this.tpi(Q)||this.DJi(Q)?!1:!0}AQ(){}WCb(Q){if(!Q.yPf)return null;let ya=null;Q.qib&&!Q.cba?(Q=this.vLd(Q.yPf))&&(ya=Q):ya=Q.yPf;return ya}tpi(Q){return Q.qib&&!Q.cba&&Q.paragraphNode?!0:!1}DJi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}Xoh(Q,ya){Q=da.a.zNa(Q);ya=da.a.zNa(ya);return(Q-ya)/this.Sm.instance.jj}uZe(Q,ya){Q=da.a.zNa(Q);ya=da.a.zNa(ya);return(Q-ya)/this.Sm.instance.jj}KYd(){this.Cpj(!1)}JYd(){this.Cpj(!0)}Cpj(Q){for(let ya=
0,kb=this.tVb.length;ya<kb;ya++){const Mb=this.tVb[ya];"PageEndMarker.Para"===Mb.id?vl.Gpj(Mb,Q):"PageEndMarker.Table"===Mb.id&&vl.Aqj(Mb,Q)}}CNl(Q,ya,kb){if(!vl.qYb){vl.qYb=qd.b("div","PageEndMarker.Para","PageEndMarker");var Mb=qd.b("div","","Current FullWidth");this.WH&&(Mb.style.borderTopColor=this.UJ.Lua());vl.qYb.appendChild(Mb);Mb=qd.b("div","","Stale LeftWing");const vc=qd.b("div","","Stale RightWing");this.WH&&(Mb.style.borderTopColor=this.UJ.Lua(),vc.style.borderTopColor=this.UJ.Lua());
vl.qYb.appendChild(Mb);vl.qYb.appendChild(vc)}Mb=vl.qYb.cloneNode(!0);Mb.childNodes[1].style.width=Q-10+"px";Mb.childNodes[2].style.width=ya-10+"px";vl.Gpj(Mb,kb);return Mb}gWl(Q,ya,kb,Mb,vc){if(!vl.Qwb){vl.Qwb=qd.b("div","PageEndMarker.Table","PageEndMarker");var id=qd.b("div","","Current LeftWing"),ae=qd.b("div","","Current RightWing");this.WH&&(id.style.borderTopColor=this.UJ.Lua(),ae.style.borderTopColor=this.UJ.Lua());vl.Qwb.appendChild(id);vl.Qwb.appendChild(ae);id=qd.b("div","","Stale LeftWing");
ae=qd.b("div","","Stale RightWing");this.WH&&(id.style.borderTopColor=this.UJ.Lua(),ae.style.borderTopColor=this.UJ.Lua());vl.Qwb.appendChild(id);vl.Qwb.appendChild(ae)}id=vl.Qwb.cloneNode(!0);id.childNodes[0].style.width=Q+"px";id.childNodes[1].style.width=ya+"px";id.childNodes[2].style.width=kb-10+"px";id.childNodes[3].style.width=Mb-10+"px";vl.Aqj(id,vc);return id}static Gpj(Q,ya){ya?vl.dQm(Q):vl.eQm(Q)}static eQm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display=
"block"}static dQm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static Aqj(Q,ya){ya?vl.iQm(Q):vl.jQm(Q)}static jQm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static iQm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}
vl.qYb=null;vl.Qwb=null;Object(e.a)(vl,"PageEndDOMHelper",null,[]);class Uo{constructor(Q,ya){this.Zub=this.d1g=null;this.Sm=Q;this.Lh=ya}V7f(Q,ya){try{this.xgo(Q,ya)}catch(kb){na.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",kb.message)}}fLk(Q,ya,kb,Mb,vc,id,ae){this.Lh.Sd(()=>{try{this.gLk(Q,ya,kb,Mb,vc,id,ae)}catch(we){na.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
we.message)}},"PEMPC:CP")}xgo(Q,ya){this.d1g=Q;this.Zub=ya}gLk(Q,ya,kb,Mb,vc,id,ae){var we=this.d1g;if(we&&Q){var Ee=we.count,jf=Q.count;if(Ee&&jf){var Ng=this.Lil(we,Q);if(Ng.count){var Fg=this.Sm.jj,ck=this.P0b(Ng)/Fg,Ki=this.Evh(Ng)/Fg;Q=this.dHd(we,Q);if(Q.count){we=this.P0b(Q)/Fg;Fg=this.Evh(Q)/Fg;var Il=!0;for(var wl=0;wl<Ng.count;wl++)if(Ng.J(wl)){Il=!1;break}var Wi=wl=0;this.Zub&&ya&&(wl=this.byk(this.Zub,ya),Wi=ya.count-this.Zub.count);na.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:kb,
["HardPageBreakExists"]:vc,["EstimatedPageCount"]:Ee,["CalculatedPageCount"]:jf,["InOrderAverageDelta"]:ck,["InOrderStandardDeviation"]:Ki,["ShortestAverageDelta"]:we,["ShortestStandardDeviation"]:Fg,["PositionsShouldBeUpdated"]:Mb,["DocumentHeightChanged"]:id,["DeltasAllZero"]:Il,["HeaderFooterOpenSinceLastResponse"]:ae,["DeltaInViewport"]:wl,["ChangeInViewportMarkerCount"]:Wi});id||ae||Il||(na.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
ya=Ng.toArray().toString(),kb=Q.toArray().toString(),na.ULS.sendTraceTag(35726603,336,50,"{0} {1}",ya,kb))}}}}else na.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}byk(Q,ya){const kb=new X.a;for(const Mb of Q)kb.add(Mb.top);if(!kb.count)return-1;Q=new X.a;for(const Mb of ya)Q.add(Mb.top);if(!Q.count)return-1;ya=this.dHd(kb,Q);return this.P0b(ya)/this.Sm.jj}P0b(Q){if(!Q.count)return 0;let ya=0;for(let kb=
0;kb<Q.count;kb++)ya+=Q.J(kb);return ya/Q.count}Evh(Q){if(!Q.count)return 0;const ya=this.P0b(Q);let kb=0;for(let Mb=0;Mb<Q.count;Mb++){const vc=Q.J(Mb)-ya;kb+=vc*vc}return Math.sqrt(kb/Q.count)}Lil(Q,ya){const kb=new X.a;if(!Q.count||!ya.count)return kb;Q.Sc((vc,id)=>vc-id);ya.Sc((vc,id)=>vc-id);const Mb=Math.min(Q.count,ya.count);for(let vc=0;vc<Mb;vc++){const id=Math.abs(Q.J(vc)-ya.J(vc));kb.add(id)}return kb}dHd(Q,ya){const kb=new X.a;if(!Q.count||!ya.count)return kb;var Mb=Q.count<=ya.count;
const vc=Mb?Q:ya;Q=Mb?ya:Q;for(ya=0;ya<vc.count;ya++){Mb=vc.J(ya);let ae=Math.abs(Mb-Q.J(0)),we=0;for(let Ee=1;Ee<Q.count;Ee++){var id=Q.J(Ee);id=Math.abs(Mb-id);id<ae&&(ae=id,we=Ee)}kb.add(ae);Q.removeAt(we)}return kb}}Object(e.a)(Uo,"PageEndMarkerPositionComparer",null,[1967]);var lg=c(433),kl=c(524);class Qj{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf){this.Aq=Q;this._pageNumber=ya;this.qib=kb;this.cba=Mb;this.yPf=vc;this.outlineNode=id;this.outlineGroupNode=ae;this.g_g=we;this.paragraphNode=Ee;this.mU=
jf}get top(){return this.Aq}get si(){return this._pageNumber}get Wbn(){return this.g_g}b3c(Q){this.Aq=Q}Oae(Q){this._pageNumber=Q}N6i(Q){this.g_g=Q}}Object(e.a)(Qj,"PageEndMarker",null,[]);class Lo{constructor(){this.tf=null;this.kAi=0}}Object(e.a)(Lo,"PageEndMarkerToRestore",null,[]);class qn{constructor(Q,ya,kb,Mb,vc,id,ae){this.vOf=(we,Ee)=>{Ee.property===Lm.a.wI&&(we=Ee.node)&&we.ia(Lm.a.wI,!1)&&this.qtd.contains(we.id)&&(Ee=we.xe(this.$e.Sb))&&(Ee=Ee.htmlElement)&&(this.qtd.remove(we.id),this.TVa.add(Ee))};
this.YH=Q;this.Sm=ya;this.uKa=kb;this.Fx=Mb;this.mGe=vc;this.UY=id;this.Dn=ae;this.Gt=new X.a;this.uVb=new X.a;this.Pwb=new pc.a;this.qtd=new kl.a(new lg.a);this.TVa=new X.a;this.xVb=!!vc;this.yqf()}get $e(){const Q=this.YH.value;na.ULS.shipAssertTag(37052750,336,Q.mi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}k7c(Q){try{this.$yo(Q)}catch(ya){this.Fx.AQ(ya.message+" "+ya.stack),na.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
ya.message)}}Wbk(Q){try{this.Xbk(Q)}catch(ya){this.Fx.AQ(ya.message+" "+ya.stack),na.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",ya.message)}}czk(Q){try{return this.dzk(Q)}catch(ya){this.Fx.AQ(ya.message+" "+ya.stack),na.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",ya.message)}return!1}ULn(){try{this.VLn()}catch(Q){this.Fx.AQ(Q.message+" "+Q.stack),na.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}fMc(){try{return this.iRl()}catch(Q){return this.Fx.AQ(Q.message+" "+Q.stack),na.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}ddg(){try{this.zAo()}catch(Q){this.Fx.AQ(Q.message+" "+Q.stack),na.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
Q.message)}}X_e(){try{return this.GEk()}catch(Q){return this.Fx.AQ(Q.message+" "+Q.stack),na.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}wgm(Q){try{this.xgm(Q)}catch(ya){this.Fx.AQ(ya.message+" "+ya.stack),na.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",ya.message)}}$yo(Q){if(Q){this.jGk();for(let ya=0;ya<Q.length;ya++){const kb=
ya+1,Mb=this.SMk(Q[ya],kb);this.Gt.add(Mb);this.Pwb.add(kb,Mb)}}}xgm(Q){let ya=!1;for(const kb of Q)if(kb)if(0<kb.hC)for(const Mb of kb.htf)ya=this.Kud(Mb,kb.outlineGroupNode)||ya;else if(0>kb.hC){ya=!0;for(const Mb of kb.pDd)this.O1k(Mb.si)}ya&&this.tYf()}Xbk(Q){const ya=this.KUh(Q.paragraphNode);this.Kud(Q,ya)&&this.tYf()}O1k(Q){const ya=Q-1;0>ya||this.Gt.count<=ya||(this.Gt.removeAt(ya),this.Pwb.ub(Q)&&this.Pwb.remove(Q))}iRl(){const Q=new X.a;for(const ya of this.Gt)this.k9b(ya)&&Q.add(ya);return Q}Kud(Q,
ya){if(!Q)return na.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;ya=this.PMk(Q,ya);Q=Q.plm?-1:Q.si;let kb=!1,Mb;this.Pwb.ub(Q)?(Mb=this.Pwb.J(Q).si,ya.Oae(Mb),this.Gt.Z(Mb-1,ya),this.Pwb.remove(Q)):(Mb=ya.si,this.Gt.insert(Mb-1,ya),kb=!0);return kb}SMk(Q,ya){return new Qj(0,ya,Q.HardBreak,!1,null,null,null,0,null,null)}PMk(Q,ya){const kb=Q.glb,Mb=Q.si,vc=Q.mU,id=!!vc&&vc.HardBreak,ae=Q.cba,we=Q.paragraphNode,Ee=this.T0h(ya),
jf=Q.outlineNode;var Ng=this.flf(jf);if(!Ng)return na.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Fg=null;id&&(Fg=this.Fx.vLd(Q.glb));Q=this.Fx.Xoh(Fg||kb,Ee);Ng=this.Fx.uZe(Fg||kb,Ng);return new Qj(Ng,Mb,id,ae,kb,jf,ya,Q,we,vc)}dzk(Q){this.uVb=new X.a;this.xVb&&this.mGe.reset();this.gDn();this.Fco();this.Phk();this.Syk(Q);return 0<this.uVb.count}gDn(){for(let Q=0;Q<this.Gt.count;Q++){const ya=this.Gt.J(Q);this.Fx.Fpm(ya)?this.AOm(ya):
(this.Fx.Epm(ya)||this.k9b(ya)&&!this.flf(ya.outlineNode))&&this.uVi(ya)}}Phk(){let Q=0,ya=null;var kb=0;let Mb=0;for(let vc=0;vc<this.Gt.count;vc++){const id=this.Gt.J(vc);this.k9b(id)&&(id.qib&&(Mb+=this.Toh(id,kb,Mb)),ya&&ya.id===id.outlineNode.id||(ya=id.outlineNode,Mb=Q=0),id.qib&&!id.cba&&(Q=this.Qyk(id)),kb=id.top+Q+Mb,id.b3c(kb))}this.Toh(null,kb,Mb);this.ZCn()}Toh(Q,ya,kb){let Mb=null;this.xVb&&(Mb=this.mGe.Tyk(Q,ya,kb));return Mb?Mb.delta:0}VLn(){if(this.uVb){for(let Q=0;Q<this.uVb.count;Q++){const ya=
this.uVb.J(Q);Wg.a.$Wn(ya.tf,ya.kAi)}this.xVb&&this.mGe.RLn()}}zAo(){if(!this.xVb){var Q=this.uKa.KZh();if(this.Gt.count){var ya=this.uKa.kXh();for(let vc=0;vc<this.Gt.count;vc++){var kb=this.Gt.J(vc);if(this.k9b(kb)&&kb.cba){kb=this.uKa.VPl(kb.outlineNode);var Mb=0<vc?this.Gt.J(vc-1).outlineNode:ya;Mb=vc&&kb.id===Mb.id?this.Gt.J(vc-1).top:0;this.uKa.Nae(kb,Mb)}}ya=this.Gt.J(this.Gt.count-1);ya.cba?this.uKa.Nae(Q,0):this.uKa.Nae(Q,ya.top)}else this.uKa.Nae(Q,0)}}Fco(){this.Gt.Sc((Q,ya)=>Q.si-ya.si)}tYf(){for(let Q=
0;Q<this.Gt.count;Q++)this.Gt.J(Q).Oae(Q+1)}Qyk(Q){return Q?this.Woh(Q)-Q.top:(na.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}azk(Q){if(!Q)return 0;const ya=this.T0h(Q.outlineGroupNode);return ya?this.Fx.Xoh(this.Fx.WCb(Q),ya):0}Woh(Q){if(!Q)return 0;const ya=this.Fx.WCb(Q);Q=this.flf(Q.outlineNode);return Q?this.Fx.uZe(ya,Q):(na.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}ZCn(){let Q=0,ya=!1,kb=null,Mb=!1;for(let vc=this.Gt.count-1;0<=vc;vc--){const id=this.Gt.J(vc);this.k9b(id)&&(kb&&kb.id===id.outlineNode.id||(ya=!kb,kb=id.outlineNode,Q=this.TMl(kb)),id.qib?(ya=!1,Q=id.top):this.xVb&&ya||!(id.top>Q)||(this.uVi(id),Wg.a.hw(this.Fx.WCb(id)),Mb=!0))}Mb&&this.tYf()}uVi(Q){this.Gt.contains(Q)&&(this.xVb&&this.UY.lEn(Q),this.Gt.remove(Q))}k9b(Q){return Q?(Q=this.Fx.WCb(Q))&&Q.offsetParent?!0:!1:(na.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}GEk(){let Q=!1;for(let ya=this.TVa.count-1;0<=ya;ya--)this.TVa.J(ya).hasChildNodes()&&(this.TVa.removeAt(ya),Q=!0);return Q}AOm(Q){(Q=this.KUh(Q.paragraphNode))&&(this.qtd.contains(Q.id)||this.qtd.add(Q.id))}yqf(){this.Dn&&this.Dn.Xe(23).Ap(this.vOf)}Syk(Q){for(let ya=this.Gt.count-1;0<=ya;ya--){const kb=this.Gt.J(ya);this.k9b(kb)&&this.Ryk(kb,Q)}}Ryk(Q,ya){const kb=this.Woh(Q),Mb=this.azk(Q);Q.qib?(Q.b3c(kb),Q.N6i(Mb)):(ya=ya?kb-Q.top:Mb-Q.Wbn,Q.b3c(kb-ya),Q.N6i(Mb-ya),1<Math.abs(ya)&&this.I0n(this.Fx.WCb(Q),
ya))}flf(Q){if(!Q)return null;Q=Q.xe(this.$e.Sb);return Q?Q.htmlElement:(na.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}T0h(Q){return Q?(Q=Q.xe(this.$e.Sb))?Q.htmlElement:null:null}KUh(Q){Q=Vd.GraphIterator.$a(Q);return Q.Ab(23)?Q.kd(23):null}SMl(Q){if(!Q)return null;Q=Q.xe(this.$e.Sb);return Q?da.a.getElementBounds(Q.htmlElement):(na.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}TMl(Q){return(Q=
this.SMl(Q))?Q.height/this.Sm.jj:0}I0n(Q,ya){ya=(Wg.a.sBl(Q)-ya)*this.Sm.jj;this.uVb.add(Object.assign(new Lo,{tf:Q,kAi:ya}))}jGk(){this.Gt=new X.a;this.Pwb=new pc.a}}Object(e.a)(qn,"PageEndMarkerPositionUpdater",null,[1966]);var Pq=c(412),im=c(38),am=c(889),Vj=c(372),qj=c(21);class Vh{constructor(Q,ya,kb,Mb,vc,id,ae=!1,we=!1,Ee=!1,jf=!1,Ng=!1){this.keg(ya,kb,Mb,vc,id,Ee,Ng);this.position=Q;this.si=ya;this.paragraphNode=kb;this.mU=Mb;this.glb=vc;this.outlineNode=id;this.T1a=ae;this.Toi=we;this.plm=
Ee;this.cba=jf;this.uxf=Ng}Oae(Q){this.si=Q}keg(Q,ya,kb,Mb,vc,id,ae){ae||(na.ULS.shipAssertTag(38326881,336,!!vc,"PageEndDetails: outlineNode parameter value is null."),na.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),na.ULS.shipAssertTag(24126529,336,!!ya||id,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),na.ULS.shipAssertTag(24126530,336,!!kb||id,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
na.ULS.shipAssertTag(24126531,336,!!Mb||id,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static $Tk(Q,ya){return Vh.W3e(0,Q,null,ya,!0,!1)}static aUk(Q){return Vh.W3e(0,0,null,Q,!1,!0)}static W3e(Q,ya,kb,Mb,vc,id){return new Vh(Q,ya,null,null,kb,Mb,vc,id,!0)}static w1b(Q,ya){return new Vh(0,Q,null,ya,null,null,void 0,void 0,void 0,void 0,!0)}}Object(e.a)(Vh,"PageEndDetails",null,[]);class mm{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,Fg,ck,Ki,Il,wl,Wi,
wg,xr,Mr,Tq){this.Gra=!0;this.mqe=0;this.Xld=this.mwe=this.nwe=this.mse=this.kGe=this.Zve=!1;this.bod=this.vvb=null;this.xze=!0;this.wIb=()=>{this.KYd()};this.CLf=()=>{this.nwe=!1};this.DLf=()=>{this.mwe=this.nwe=!0};this.J6m=(Zp,Vg)=>{1>=Math.abs(Vg.delta)||(this.mse=!0,this.Bpj(!Vg.bAi))};this.hxn=Zp=>{Zp===this.vvb&&(this.vvb=null);if(this.Gra){var Vg=Zp.customData;if(Zp=this.UVa.get(Vg.id))for(this.UVa.Z(Vg.id,new X.a),na.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
Zp.count,Vg.id),this.U9&&this.U9.MBa(),Vg=0;Vg<Zp.count;Vg++){const Sg=Zp.J(Vg),Og=Sg.mU;Og.HardBreak||(Wg.a.hw(Sg.glb),this.fYf(Og))}}};this.gxn=()=>{this.bod=null;this.Gra&&this.eha&&0<this.eha.count&&(na.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.k7c(this.eha.toArray(),this.Gra))};this.YH=Q;this.Ci=ya;this.U9=kb;this.fN=Mb;this.p_g=vc;this.lab=id;mm.Fx=we;this.ZLg=Ee;this.aI=jf;this.Gb=Ng;this.kNj=Fg;this.je=Ki;this.UY=wl;this.oGe=Wi;this.AVb=wg;
this.DY=xr;this.bVb=new Pq.a;this.vVb=new X.a;this.eha=new X.a;this.UVa=new Pq.a;this.RM=ck;this.YR=Tq;this.o3d=this.o3d.bind(this);this.q3d=this.q3d.bind(this);this.y7d=this.y7d.bind(this);this.tba=this.tba.bind(this);this.RM.cvd(this.wIb);this.lGe=!1;this.q_g=Mr;Il&&(Il.rfh(this.DLf),Il.dvd(this.CLf));ae&&ae.yfk(this.J6m);this.YR.Jxb(this.tba)}get lxf(){return this.xze}get $e(){return this.YH.value}get Ji(){return this.Ci.value}k7c(Q,ya){const kb=this.je.jg("Task","UpdateMarkers");this.vgo();this.Gra=
ya;mm.Fx.mUi();this.bVb=new Pq.a;this.vVb.clear();this.eha.clear();this.UVa=new Pq.a;this.xze=this.Zve=!1;this.fN&&this.fN.k7c(Q);this.ecl();this.mqe=Q.length;this.UY&&this.UY.reset(Q);this.U9&&this.U9.MBa();for(const Mb of Q)this.eha.add(Mb),this.fYf(Mb);ya&&this.fN&&this.oGe&&this.oGe.isEnabled&&(Q=this.fN.fMc(),this.oGe.tYa(Q));this.eLk();this.mse=this.kGe=!1;this.mwe=this.nwe;Wk.WoncaApp.instance.Dhb&&mm.qrf&&this.fN.ddg();this.lab.xzo(this.fN.fMc(),this.eha.count);this.xze=!0;this.DY.Ucg();kb.stop();
na.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:kb.vi,["RenderedLineCount"]:this.mqe,["AvgDurationPerPageInMs"]:kb.vi/this.a1h()})}d1h(){const Q=this.fN.fMc();if(!Q)return null;const ya=Wg.a.c3(),kb=new X.a;for(const Mb of Q)this.gtm(Mb,ya)&&kb.add(Mb);return kb}gtm(Q,ya){if(!Q)return!1;Q=mm.Fx.WCb(Q);if(!Q)return!1;Q=da.a.zNa(Q);return 0<=Q&&Q<=ya}LRh(){const Q=new X.a;if(!this.UVa)return na.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
Q;const ya=this.UVa.keys;for(let vc=0;vc<ya.length;vc++){var kb=ya.J(vc);if(kb=this.UVa.J(kb))for(let id=0;id<kb.count;id++){var Mb=kb.J(id);Mb.mU.HardBreak||Mb.glb.classList.contains("Hidden")||(Mb=da.a.zNa(Mb.glb),Q.add(Mb))}}return Q}vgo(){const Q=this.LRh(),ya=this.d1h();this.p_g.V7f(Q,ya);this.AVb&&this.AVb.isEnabled&&this.AVb.V7f(ya)}eLk(){if(!(25<this.a1h())){var Q=this.LRh(),ya=this.d1h();this.p_g.fLk(Q,ya,this.q_g,this.kGe,this.Zve,this.mse,this.mwe);this.AVb&&this.AVb.isEnabled&&this.AVb.tYa(ya)}}tba(){this.U9.kEn();
this.XEh()}XEh(){this.Xld&&(this.$e.rFn(this.o3d),this.$e.$Fn(this.q3d),this.$e.JFn(this.y7d),this.Xld=!1)}ecl(){this.Xld||(this.$e.Leh(this.o3d),this.$e.cgk(this.q3d),this.$e.lfh(this.y7d),this.Xld=!0)}fYf(Q){if(this.lGe)return!0;Q=this.bHn(Q);if(!Q)return!1;this.UY&&this.UY.N3l(Q);this.fN&&(this.fN.Wbk(Q),this.lab.xpj(this.fN.fMc()),Wk.WoncaApp.instance.Dhb&&mm.qrf&&this.fN.ddg());return!0}bHn(Q){let ya=this.Caa(Q.ParaId);if(!ya)return null;if(!ya.anchor||!ya.Wi)return this.ceh(Q,ya),null;let kb,
Mb;if(Q.HardBreak){var vc=tm.ParagraphReader.Tg(ya,!0,!0,!0);this.Idn(vc)&&(ya=vc);if(!({dha:vc,outlineGroupNode:kb,elb:Mb}=this.Mqo(Q,ya)).returnValue)return null;this.Zve=!0}else if(!({k3d:vc,outlineGroupNode:kb,elb:Mb}=this.cHn(Q,ya)).returnValue)return null;return this.Kud(ya,Q,vc,kb,Mb)}Idn(Q){return Q?(Q=Q.xe(this.$e.Sb))?!!mm.Fx.vLd(Q.htmlElement):!1:!1}cHn(Q,ya){var kb=Q.PageEndType;let Mb,vc=0,id=null;if(!kb){if(!({dha:Q,iPf:Mb}=this.e1h(Q,ya)).returnValue)return{returnValue:!1,k3d:vc,outlineGroupNode:id,
elb:null}}else if(!({dha:Q,Oee:Mb}=this.lNl(Q,ya)).returnValue)return{returnValue:!1,k3d:vc,outlineGroupNode:id,elb:null};var ae=Vd.GraphIterator.$a(ya);ae.zd();id=ae.kd(23);ya=id.xe(this.$e.Sb).getBounds();ae=ae.I4a().xe(this.$e.Sb);if(!ae)return na.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.$e.Sb),{returnValue:!1,k3d:vc,outlineGroupNode:id,elb:null};const we=ae.getBounds();vc=Q-ya.y;kb=mm.Fx.gWh(kb,vc,this.Gra,Mb,ya,we);ae.faa.appendChild(kb);return{returnValue:!0,
k3d:vc,outlineGroupNode:id,elb:kb}}Mqo(Q,ya){let kb=null;const Mb=ya.xe(this.$e.Sb);var vc=0;let id=null;if(this.AVd(Q,Mb,ya))return{returnValue:!1,dha:vc,outlineGroupNode:kb,elb:id};kb=mm.Kzi(ya);const ae=kb.xe(this.$e.Sb);if(!ae)return na.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.$e.Sb),{returnValue:!1,dha:vc,outlineGroupNode:kb,elb:id};vc=ae.getBounds();vc=nj.a.Cq(Mb,Q.CP).y-vc.y;id=this.EEl(ya);return{returnValue:!0,dha:vc,outlineGroupNode:kb,elb:id}}EEl(Q){return Q.xe(this.$e.Sb).htmlElement}Caa(Q){const ya=
this.aI.Bgb(Q);if(ya!==ee.a.nil){const kb=this.Ji.Db(ya);if(kb)return kb}na.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,ya);return null}e1h(Q,ya){const kb=Q.CP;let Mb=0,vc=null;const id=ya.xe(this.$e.Sb);if(this.AVd(Q,id,ya))return{returnValue:!1,dha:Mb,iPf:vc};vc=id.getBounds();Mb=kb?this.ZLg(Object(ua.a)(132,id),kb):vc.y-this.kNj(id);return{returnValue:!0,dha:Mb,iPf:vc}}lNl(Q,ya){let kb=null,Mb=0;var vc=Q.PageEndType;let id=Vd.GraphIterator.$a(ya);
id.zd();if(!im.TableReader.Jw(id))return na.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({dha:Mb,iPf:kb}=this.e1h(Q,ya)).returnValue,dha:Mb,Oee:kb};if(1===vc){qj.returnToContainingRow(id);vc=id.currentNode.xe(this.$e.Sb);if(this.AVd(Q,vc,ya))return{returnValue:!1,dha:Mb,Oee:kb};Mb=vc.getBounds().y}else{vc=ya.xe(this.$e.Sb);if(this.AVd(Q,vc,ya))return{returnValue:!1,dha:Mb,Oee:kb};Mb=this.ZLg(Object(ua.a)(132,
vc),Q.CP)}--Mb;ya=null;do Q=ya,ya=id.kd(14);while(ya);id=Vd.GraphIterator.$a(Q);id.zd();qj.moveToFirstRow(id);kb=id.currentNode.xe(this.$e.Sb).getBounds();return{returnValue:!0,dha:Mb,Oee:kb}}AVd(Q,ya,kb){if(!ya||ya.cwa(16))return this.ceh(Q,kb),!0;ya=ya.getBounds();return ya.width||ya.height?!1:(this.sdh(Q),!0)}sdh(Q){this.vVb.contains(Q)||this.vVb.add(Q)}ceh(Q,ya){ya=ya.id;let kb;({value:kb}=this.bVb.Gc(ya)).returnValue||(kb=new X.a,this.bVb.Z(ya,kb));kb.add(Q)}o3d(){const Q=new X.a;for(let ya=
this.vVb.count-1;0<=ya;ya--){const kb=this.vVb.J(ya);this.fYf(kb)||Q.add(kb)}this.vVb=Q;this.X_e()}X_e(){this.fN&&this.fN.X_e()&&this.Bpj(!1)}Bpj(Q){this.fN&&(this.fN.czk(Q)&&(this.kGe=!0),this.q_g&&this.fN.ULn(),this.lab.xpj(this.fN.fMc()),Wk.WoncaApp.instance.Dhb&&mm.qrf&&this.fN.ddg())}q3d(Q,ya){try{const kb=ya.id;if(this.bVb.ub(kb)){const Mb=this.bVb.J(kb);for(Q=0;Q<Mb.count;Q++)this.sdh(Mb.J(Q));this.bVb.remove(kb)}}catch(kb){}}KYd(){this.Gra&&(this.Gra=!1,mm.Fx.KYd())}JYd(){this.Gra||(this.Gra=
!0,mm.Fx.JYd())}V$n(){this.lGe=!1;this.eha&&this.k7c(this.eha.toArray(),this.Gra);this.U9&&this.U9.Fbj()}m8l(){this.lGe=!0;mm.Fx.mUi();this.U9&&this.U9.Cai();this.UY&&this.UY.n8l()}Kud(Q,ya,kb,Mb,vc){const id=this.eha.indexOf(ya)+1;if(0>id)return null;const ae=Uh.WordSectionNavigator.instance.fJ(Q),we=this.cba(ya,Q);Q=new Vh(kb,id,Q,ya,vc,ae,!Q||!ya||!vc,!1,!1,we);this.UVa.ub(Mb.id)||this.UVa.Z(Mb.id,new X.a);this.UVa.J(Mb.id).add(Q);return Q}cba(Q,ya){if(!Q||!Q.HardBreak)return!1;Q=Vd.GraphIterator.$a(ya);
Q.Ab(7);if(Q.MI())return!1;Q.kd(23);return Q.MI()?!1:!0}ESi(Q){this.Gra&&(Q.anchor&&Q.Wi?!(Q=mm.Kzi(Q))||this.vvb&&this.vvb.customData&&this.vvb.customData.id===Q.id||(this.vvb=Object.assign(new Tb.a(3,1,500,this.hxn),{customData:Q}),this.Gb.Xb(this.vvb)):na.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}y7d(){this.Gra&&!this.bod&&this.eha&&0<this.eha.count&&(this.bod=new Tb.a(3,1,500,this.gxn),this.Gb.Xb(this.bod))}dispose(){this.$e&&
this.XEh();this.YR.OXf(this.tba);this.RM.PXf(this.wIb)}static get qrf(){null==mm.nxe&&(mm.nxe=F.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return mm.nxe}static AEl(Q){let ya=0;try{const kb=Q.htmlElement,Mb=Wg.a.mM(kb.firstChild.style.marginTop);Q=0;const vc=mm.Jlf(kb.parentNode);if(vc){const id=vc.firstChild;id&&id.classList.contains("ParaWrappingDiv")&&(Q=Wg.a.mM(id.firstChild.style.marginBottom))}ya=Math.max(Mb,Q)/2}catch(kb){}return ya}static Jlf(Q){let ya=Q.previousSibling;
if(!ya){var kb=Q.parentNode;Wg.a.Awf(kb)&&(kb=kb.parentNode)&&(ya=kb.previousSibling)}if(!ya&&(Q=Q.parentNode,Q.classList.contains(am.a.bJi)||na.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){ya=Q.lastChild;do{if(ya.classList.contains("OutlineElement")||Wg.a.Awf(ya)&&ya.classList.contains(Vj.a.R$b))break;ya=ya.previousSibling}while(ya)}if(ya){if(ya.classList.contains(Vj.a.R$b))return ya.lastChild.lastChild;
if(Wg.a.Awf(ya))return ya.lastChild}return ya}static Kzi(Q){Q=Vd.GraphIterator.$a(Q);return Q.Ab(23)?Q.kd(23):null}a1h(){return this.mqe+1}}mm.Fx=null;mm.nxe=null;Object(e.a)(mm,"PageEndMarkers",null,[1964,1965,9]);var Mt=c(117);class dr{constructor(Q,ya,kb){this.Ubn=".Outline";this.YH=Q;this.Sm=ya;this.Fx=kb}get $e(){const Q=this.YH.value;na.ULS.shipAssertTag(38416594,336,Q.mi,"Invalid PageView.");return Q}D4b(Q){return(Q=Q.outlineNode)?this.R0h(Q):(na.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),
null)}R0h(Q){let ya,kb;return(ya=Q.xe(this.$e.Sb))&&(kb=ya.htmlElement)?kb.querySelector(this.Ubn):(na.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}JUh(Q){Q=mb.OutlineElementNavigator.fl(Q.paragraphNode);let ya;return Q&&(ya=Q.xe(this.$e.Sb))?ya.htmlElement:(na.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}Loh(Q,ya){const kb=this.f_l(Q);return this.Xyk(Q,ya)-kb}aWh(Q){return this.X0h(Q.outlineNode,Q.si)}X0h(Q,ya){if(!Q)return-1;var kb=
Q.ia(Kj.a.ew,-1);kb=gn.a.Mi(kb,1);var Mb=Q.ia(Kj.a.marginTop,-1);Mb=gn.a.Mi(Mb,1);Q=Q.ia(Kj.a.marginBottom,-1);Q=gn.a.Mi(Q,1);return 1===ya?kb-Q:kb-(Mb+Q)}M1k(Q){Q&&Wg.a.hw(Q.glb)}Dlf(Q){if(Q.Toi||Q.cba)return 0;if(Q.T1a)return Q=this.D4b(Q),da.a.getElementBounds(Q).height/this.Sm.jj;const ya=this.D4b(Q);return this.Fx.uZe(this.c1h(Q),ya)}KRk(Q,ya,kb){kb=kb.xe(this.$e.Sb).getBounds();Q=Q.xe(this.$e.Sb);const Mb=Q.getBounds();kb.y=Mb.y;ya=this.Fx.gWh(0,ya*this.Sm.jj,!1,kb,kb,Mb);Q.faa.appendChild(ya);
return ya}Fei(Q,ya){if(Q&&!Q.uxf)if(Q.T1a){if(Q=this.D4b(Q))Q.style.paddingBottom=ya+"px"}else if(Q.mU&&Q.mU.HardBreak)if(Q.cba){if(Q=this.p2h(Q))Q.style.paddingBottom=ya+"px"}else{if(Q=this.JUh(Q))Q.style.paddingTop=ya+"px"}else na.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}igh(Q,ya){ya=this.D4b(ya);Q=this.D4b(Q);return da.a.zNa(ya)-da.a.zNa(Q)}q2h(Q){Q=Vd.GraphIterator.$a(Q.outlineNode);Q.Ab(7);return Q.MI()}Uli(Q){if(!Q||Q.uxf)return!1;
if(Q.T1a||Q.Toi)return!0;Q=this.c1h(Q);return!!Q&&Wg.a.iaa(Q)}AQ(Q){this.Fx.AQ(Q)}p2h(Q){return(Q=this.q2h(Q))?(Q=Q.gh(this.$e.Sb).htmlElement,Q?Q:(na.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}c1h(Q){return Q.mU&&Q.mU.HardBreak&&!Q.cba?this.Fx.vLd(Q.glb):Q.glb}f_l(Q){if(Q.T1a){Q=this.D4b(Q);if(!Q)return na.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Mt.a.WB(Q);return Wg.a.Ffa(Q.paddingBottom)}if(Q.mU&&Q.mU.HardBreak){if(Q.cba)return(Q=this.p2h(Q))?
Wg.a.Ffa(Q.style.paddingBottom):-1;Q=this.JUh(Q);return Q?Wg.a.Ffa(Q.style.paddingTop):(na.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}Xyk(Q,ya){return this.Dlf(Q)-ya}}Object(e.a)(dr,"PageFullHeightDOMHelper",null,[]);class ol{constructor(){this.delta=this.ltj=this.hC=0;this.cha=null;this.bNa=this.zNi=0;this.outlineGroupNode=null;this.QBa=0;this.htf=new X.a;this.pDd=new X.a;this.HXm=new X.a}}Object(e.a)(ol,"PageFullHeightInfo",null,[]);class Co{constructor(Q,
ya){this.Xza=Q;this.Gx=ya}Uoh(Q,ya){try{return this.Uyk(Q,ya)}catch(kb){return this.Gx.AQ(kb.message+" "+kb.stack),na.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",kb.message),null}}Uyk(Q,ya){na.ULS.shipAssertTag(38416596,336,Q.T1a||Q.mU.HardBreak);const kb=this.Gx.Dlf(Q),Mb=this.Gx.Loh(Q,ya),vc=this.Xza.Ioh(Q,Mb);Q=Object.assign(new ol,{QBa:Mb,bNa:vc,cha:Q});this.myo(Q);Q.ltj=Q.bNa-Q.QBa;Q.delta=ya+vc+Q.delta-kb;return Q}myo(Q){Q.QBa>Q.bNa?this.nyo(Q):
0>Q.QBa&&this.Hcg(Q)}Hcg(Q){let ya=Q.cha.si;for(;0>Q.QBa;)Q.hC--,Q.delta-=this.Xza.NKc(ya),Q.QBa+=this.Xza.NKc(ya-1),ya--;Q.bNa=this.Xza.NKc(ya)}nyo(Q){const ya=this.Gx.aWh(Q.cha);Q.hC=Math.floor((Q.QBa-Q.bNa)/ya)+1;Q.delta=Q.hC*ya;Q.QBa-=Q.bNa+(Q.hC-1)*ya;Q.bNa=ya}}Object(e.a)(Co,"PageFullHeightInfoCalculator",null,[]);class Dk{constructor(Q,ya,kb,Mb){this.jXa=0;this.uLa=null;this.Xza=Q;this.Aub=ya;this.hW=kb;this.Gx=Mb;this.p2g=new X.a}get ZX(){return this.p2g}N3l(Q){try{this.epf(Q)}catch(ya){this.Gx.AQ(ya.message+
" "+ya.stack),na.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",ya.message)}}reset(Q){try{this.mKn(Q)}catch(ya){this.Gx.AQ(ya.message+" "+ya.stack),na.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",ya.message)}}n8l(){try{this.o8l()}catch(Q){this.Gx.AQ(Q.message+" "+Q.stack),na.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}ygm(Q){try{this.zgm(Q)}catch(ya){this.Gx.AQ(ya.message+
" "+ya.stack),na.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",ya.message)}}lEn(Q){try{this.mEn(Q)}catch(ya){this.Gx.AQ("Pagination: "+ya.message+" "+ya.stack),na.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",ya.message)}}vdm(){var Q=this.hW.Nif(),ya=this.hW.CZh();Q=Vh.aUk(Q);ya=Vh.$Tk(this.jXa,ya);this.ZX.Z(0,Q);this.epf(ya)}qKn(){var Q=Uh.WordSectionNavigator.instance.CZh();
(Q=this.Gx.R0h(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}rem(Q){this.p2g=new X.a;this.ZX.add(null);for(let ya=0;ya<Q.length;ya++){const kb=Vh.w1b(ya+1,Q[ya]);this.ZX.add(kb)}this.ZX.add(Vh.w1b(Q.length+1,null))}cem(Q){this.Xza.xKn(Q)}UKn(){if(this.ZX)for(const Q of this.ZX)Q&&this.Mji(Q)&&this.Gx.Fei(Q,0)}epf(Q){const ya=this.PPl(Q);if(this.Gx.Uli(ya)){let kb=this.Gx.Dlf(ya);Q.outlineNode!==ya.outlineNode&&(kb+=this.Gx.igh(Q,ya));this.$xk(Q,kb);this.Mji(Q)&&this.gYf(Q,kb)}else this.uLa.add(Q),
20<this.uLa.count&&na.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.uLa.count);this.ZX.Z(Q.si,Q);this.E3l(Q)}o8l(){this.UKn()}mKn(Q){this.jXa=Q.length+1;this.uLa=new X.a;this.rem(Q);this.cem(this.jXa);this.vdm();this.qKn()}zgm(Q){this.Xza.Azo(Q);for(const ya of Q){if(!ya){na.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<ya.hC){Q=ya.cha.si;for(const kb of ya.htf)this.ZX.insert(Q,kb),Q++}else if(0>ya.hC)for(const kb of ya.pDd)this.ZX.remove(kb),this.uLa.contains(kb)&&
this.uLa.remove(kb)}this.yXi()}mEn(Q){Q=Q.si;this.Xza.nEn(Q);this.ZX.removeAt(Q);for(const ya of this.uLa)ya.si===Q&&this.uLa.remove(ya);this.yXi()}$xk(Q,ya){ya=this.Gx.Loh(Q,ya);this.Xza.Ioh(Q,ya)}gYf(Q,ya){Q.mU&&Q.mU.HardBreak||this.Aub.gYf(Q,ya)}E3l(Q){Q=Q.si+1;for(const ya of this.uLa)if(ya&&ya.si===Q){this.epf(ya);this.uLa.remove(ya);break}}yXi(){for(let Q=0;Q<this.ZX.count;Q++){const ya=this.ZX.J(Q);ya&&ya.Oae(Q)}}Mji(Q){Q=this.eNl(Q);return 2===Q||1===Q}PPl(Q){return this.ZX.J(Q.si-1)}eNl(Q){return Q.T1a?
2:Q.mU&&Q.mU.HardBreak?1:0}}Object(e.a)(Dk,"PageFullHeightManager",null,[1995]);class fo{constructor(Q,ya,kb,Mb){this.Aub=Q;this.Xza=ya;this.hW=kb;this.Gx=Mb}create(){return new Dk(this.Xza,this.Aub,this.hW,this.Gx)}}Object(e.a)(fo,"PageFullHeightManagerFactory",null,[]);var ur=c(1076),zn=c(600);class po{constructor(Q,ya,kb,Mb,vc){this.wVb=null;this.UY=Q;this.fN=ya;this.vvc=kb;this.Aub=Mb;this.Gx=vc}reset(){this.wVb=new X.a}Tyk(Q,ya,kb){try{return this.Vyk(Q,ya,kb)}catch(Mb){return na.ULS.sendTraceTag(38897350,
336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Mb.message),null}}RLn(){try{this.SLn()}catch(Q){na.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}Vyk(Q,ya,kb){if(!this.UY.ZX.count)return null;const Mb=this.jNl(Q,!Q);if(!Mb||Mb.uxf)return na.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Mb.mU&&Mb.mU.HardBreak)return null;
var vc=this.UY.ZX.J(Mb.si-1);return this.Gx.Uli(vc)&&(ya-=kb,Mb.outlineNode!==vc.outlineNode&&(ya+=this.Gx.igh(Mb,vc)),(vc=this.vvc.Uoh(Mb,ya))&&1<Math.abs(vc.delta))?(vc.zNi=ya,vc.outlineGroupNode=this.RMl(Q,Mb),this.wVb.add(vc),this.Hcg(vc),vc):null}RMl(Q,ya){return ya&&ya.T1a?(Q=Object(ua.a)(zn.a,tm.ParagraphReader.HI(ya.outlineNode)),Q=Vd.GraphIterator.$a(Q),Q.jo(),Object(ua.a)(ur.a,Q.kd(23))):Q&&Q.qib?Q.outlineGroupNode:null}SLn(){this.wVb.Sc((Q,ya)=>ya.cha.si-Q.cha.si);for(const Q of this.wVb)this.Aub.iXi(Q);
this.Dzo()}Dzo(){this.fN.value.wgm(this.wVb);this.UY.ygm(this.wVb)}jNl(Q,ya){return ya?this.UY.ZX.J(this.UY.ZX.count-1):this.UY.ZX.J(Q.si)}Hcg(Q){let ya=Q.cha.si;const kb=-Q.hC;for(let Mb=0;Mb<kb;Mb++)ya--,Q.pDd.add(this.UY.ZX.J(ya))}}Object(e.a)(po,"PageFullHeightPositionUpdater",null,[1994]);class An{constructor(Q,ya,kb,Mb,vc){this.UY=Q;this.fN=ya;this.vvc=kb;this.Aub=Mb;this.Gx=vc}create(){return new po(this.UY,this.fN,this.vvc,this.Aub,this.Gx)}}Object(e.a)(An,"PageFullHeightPositionUpdaterFactory",
null,[]);class er{constructor(Q,ya){this.Gx=Q;this.vvc=ya}gYf(Q,ya){try{this.fHn(Q,ya)}catch(kb){this.Gx.AQ(kb.message+" "+kb.stack),na.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",kb.message)}}iXi(Q){try{this.eHn(Q)}catch(ya){this.Gx.AQ(ya.message+" "+ya.stack),na.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",ya.message)}}fHn(Q,ya){na.ULS.shipAssertTag(38285913,336,Q.T1a||Q.mU.HardBreak);Q=this.vvc.Uoh(Q,
ya);this.iXi(Q)}eHn(Q){this.dHn(Q);this.XGn(Q)}XGn(Q){0<Q.hC?this.Igm(Q):0>Q.hC&&this.N1k(Q)}dHn(Q){this.Gx.Fei(Q.cha,Q.ltj)}Igm(Q){let ya=Q.zNi+Q.bNa;for(let Mb=0;Mb<Q.hC;Mb++){var kb=Q.cha.si+Mb;const vc=Q.cha.cba?this.Gx.q2h(Q.cha):Q.cha.outlineNode;kb=this.JRk(vc,Q.outlineGroupNode,ya,kb);Q.htf.add(kb);Q.HXm.add(ya);ya+=Q.bNa}}N1k(Q){for(const ya of Q.pDd)this.Gx.M1k(ya)}JRk(Q,ya,kb,Mb){ya=this.Gx.KRk(Q,kb,ya);return Vh.W3e(kb,Mb,ya,Q,!1,!1)}}Object(e.a)(er,"PageFullHeightRenderer",null,[]);class kp{constructor(Q){this.TUf=
Q}}Object(e.a)(kp,"PageHeightDeltaResult",null,[1975]);class Vo{constructor(Q,ya,kb){this.hq=null;this.Gx=Q;this.Lh=ya;kb.execute(Mb=>{Mb.register(this)})}get fVc(){return"PageHeightDelta"}get result(){return this.hq}get RIf(){return 1}get f0f(){return 500}get isEnabled(){return!0}ZIf(){this.hq=null}tYa(Q){this.Lh.Sd(()=>{try{this.CCc(Q)}catch(ya){na.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",ya.message)}},"PHDM:C")}CCc(Q){this.hq=null;Q=
this.DCc(Q);-1!==Q&&(this.hq=new kp(Q))}DCc(Q){if(!Q.count)return-1;let ya=0,kb=0;for(const Mb of Q)Q=this.Wyk(Mb),-1!==Q&&(ya+=Q,kb++);return kb?ya/kb:-1}Wyk(Q){if(!Q.jom)return-1;const ya=this.Gx.X0h(Q.$wd,Q.si);return-1===ya?-1:Math.abs(Q.height-ya)}}Object(e.a)(Vo,"PageHeightDeltaMetric",null,[1926]);class ds{constructor(Q){this.KUa=null;this.Gx=Q}NKc(Q){return this.KUa.J(Q-1)}xKn(Q){this.KUa=new X.a;for(let ya=0;ya<Q;ya++)this.KUa.add(-1)}Ioh(Q,ya){if(this.htm(Q))return this.KUa.J(Q.si-1);ya=
this.syk(Q,ya);this.wgo(Q,ya);return ya}Azo(Q){for(const ya of Q)this.zzo(ya)}wgo(Q,ya){this.KUa.Z(Q.si-1,ya)}nEn(Q){this.KUa.removeAt(Q-1)}zzo(Q){if(Q)if(0<Q.hC){var ya=Q.cha.si;for(var kb=0;kb<Q.hC;kb++)this.KUa.insert(ya,Q.bNa)}else if(0>Q.hC)for(ya=-Q.hC,Q=Q.cha.si-ya,kb=0;kb<ya;kb++)this.KUa.removeAt(Q)}htm(Q){return-1!==this.KUa.J(Q.si-1)}syk(Q,ya){if(Q.T1a||Q.mU.HardBreak)Q=this.Gx.aWh(Q),ya=ya<Q?Q:ya;return ya}}Object(e.a)(ds,"PageHeightStorage",null,[]);var oi=c(123);class Kr{constructor(Q){this.TUf=
Q}}Object(e.a)(Kr,"PageLevelDeltaResult",null,[1975]);class Qq{constructor(Q,ya,kb,Mb){this.hq=null;this.YH=Q;this.gsa=ya;this.Lh=kb;Mb.execute(vc=>{vc.register(this)})}get $e(){const Q=this.YH.value;na.ULS.shipAssertTag(39081438,336,Q.mi,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get fVc(){return"PageLevelDelta"}get result(){return this.hq}get RIf(){return 0}get f0f(){return 60}get isEnabled(){return!0}ZIf(){this.hq=null}tYa(Q){this.Lh.Sd(()=>{try{this.CCc(Q)}catch(ya){na.ULS.sendTraceTag(39081440,
324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",ya.message)}},"PLDM:C")}CCc(Q){this.hq=null;Q=this.DCc(Q);-1!==Q&&(this.hq=new Kr(Q))}DCc(Q){if(!Q.count)return-1;let ya=0,kb=0;for(const Mb of Q)Q=this.Yyk(Mb),-1!==Q&&(ya+=Q,kb++);return kb?ya/kb:-1}Yyk(Q){if(Q.qib)return-1;var ya=Q.mU.CP;Q=Q.paragraphNode;na.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.xe(this.$e.Sb);na.ULS.shipAssertTag(39081442,324,Object(oi.a)(132,Q));let kb;({oyh:ya,Eri:Q,A_i:kb}=this.Kyk(Q,Wg.a.Yz(Q.htmlElement).length,
ya));return Q&&kb?Math.min(ya.x-Q.x,kb.x-ya.x):(na.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}Kyk(Q,ya,kb){let Mb,vc,id,ae=vc=kb,we=id=Mb=null;if(kb>ya)return na.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{oyh:we,PCm:ae,Eri:id,zNn:vc,A_i:Mb};we=this.gsa.Cq(Q,kb);for(var Ee=0,jf=kb;Ee<=jf;){const Ng=Math.floor((Ee+jf)/2),Fg=this.gsa.Cq(Q,
Ng);if(Ee===jf){ae=Ng;id=Fg;break}Fg.y+Fg.height<=we.y?Ee=Ng+1:jf=Ng}for(;kb<=ya;){Ee=Math.ceil((kb+ya)/2);jf=this.gsa.Cq(Q,Ee);if(kb===ya){vc=Ee;Mb=jf;break}jf.y>=we.y+we.height?ya=Ee-1:kb=Ee}return{oyh:we,PCm:ae,Eri:id,zNn:vc,A_i:Mb}}}Object(e.a)(Qq,"PageLevelDeltaMetric",null,[1926]);class zq{constructor(Q,ya,kb,Mb,vc,id,ae){this.si=Q;this.top=ya;this.Sah=kb;this.height=Mb;this.aOb=vc;this.$wd=id;this.jom=ae}}Object(e.a)(zq,"Page",null,[]);class ok{constructor(Q,ya,kb,Mb,vc){this.qVb=null;this.F7g=
0;this.YH=Q;this.Mcd=ya;this.o_g=kb;this.uKa=Mb;this.r_g=vc;this.WVa=new X.a}get $e(){const Q=this.YH.value;na.ULS.shipAssertTag(37007393,336,Q.mi,"PageManager.PageView is not a PageView.");return Q}get hm(){return this.WVa}xpj(Q){Q=this.JRi(Q);this.zpj(Q)}xzo(Q,ya){this.F7g=ya;Q=this.JRi(Q);this.zpj(Q);this.r_g.isEnabled&&this.r_g.tYa(Q)}JRi(Q){this.WVa=new X.a;this.qVb=new Pq.a(0);const ya=new X.a;if(!Q)return this.hm;var kb=0,Mb=null;for(let vc=0;vc<Q.count;vc++){const id=Q.J(vc);kb=id.si;Mb=this.SBd(kb,
Mb,id);this.hm.add(Mb);!ok.nEe&&0>Mb.height&&ya.add(Mb);Mb=id}Q=this.SBd(kb+1,Mb,null);this.hm.add(Q);!ok.nEe&&0>Q.height&&ya.add(Q);for(const vc of ya)ok.nEe=!0,na.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+vc.si);return this.hm}SBd(Q,ya,kb){const Mb=ya?ya.outlineNode:this.uKa.kXh(),vc=kb?kb.outlineNode:this.uKa.KZh();var id=this.Y0h(Mb);const ae=this.Y0h(vc),we=ya?this.Soh(ya):0;id=we+id;const Ee=kb?this.Soh(kb):this.Mcd.K3a.clientHeight-ae;return new zq(Q,
we,id,Mb.id===vc.id?Ee-we:Ee+ae-id,Mb,vc,(kb?kb.si:this.F7g+1)===(ya?ya.si:0)+1)}Soh(Q){return Q.cba?0:Q.top}zpj(Q){if(this.o_g.j3d)for(const ya of this.o_g.j3d)ya&&ya.Apj(Q)}Y0h(Q){this.qVb||(this.qVb=new Pq.a(0));if(this.qVb.ub(Q.id))return this.qVb.J(Q.id);var ya=Q.xe(this.$e.Sb);if(!ya)return na.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;ya=da.a.k0a(this.Mcd.K3a,ya.htmlElement).y;this.qVb.Z(Q.id,ya);return ya}}ok.nEe=!1;Object(e.a)(ok,"PageManager",
null,[1936]);var Cl=c(634);class go{constructor(Q,ya,kb,Mb,vc,id,ae){this.Zdg=this.L3a=!1;this.ga=Q;this.Tda=ya;this.gUa=kb;this.Gt=Mb;this.Vi=vc;this.t_g=id;this.HC=ae;this.L3a=0===this.HC.Tv?!0:!1;this.$Jf=this.$Jf.bind(this);this.HC.Neh(this.$Jf)}Wb(){this.ga.gb(Bf.a.WZc,Sf.a.application,this.WZc.bind(this),96);this.ga.gb(Bf.a.F6d,Sf.a.application,this.F6d.bind(this),96);this.ga.gb(Bf.a.Qfe,Sf.a.application,this.Qfe.bind(this),96);this.ga.gb(Bf.a.Nfe,Sf.a.application,this.Nfe.bind(this),8)}Qfe(Q,
ya,kb){return 1===kb?32:this.ga.processAction(Bf.a.i6a,2)}Nfe(Q,ya,kb,Mb){if(1===kb)return 0===this.HC.Tv?32:8;this.L3a?(this.QFh(),this.Zdg=!0):(this.gJh(),this.Zdg=!1);this.Vi.updateCommandUI();Mb.Xr=this.L3a?1:0;return 32}WZc(Q,ya,kb,Mb,vc){if(1===kb)return 32;Q=this.t_g.DMc();-1===Q?Q="":this.L3a||1===this.HC.Tv?(ya=this.t_g.mzl(),ya>Q&&(Q=ya),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,ya,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,
Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);vc[Cl.a.Visible]=!0;vc[Cl.a.LabelText]=Q;return 32}F6d(Q,ya,kb,Mb,vc){if(1===kb)return 32;vc[je.a.On]=this.L3a;return 32}$Jf(Q,ya){0!==ya.hbc||this.Zdg?this.QFh():this.gJh()}gJh(){this.L3a||(this.gUa.nal(),this.Gt.V$n(),this.L3a=!0)}QFh(){this.L3a&&(this.gUa.g5k(),this.Gt.m8l(),this.L3a=!1)}}Object(e.a)(go,"PaginationActor",null,[]);class nm{constructor(Q){this.TUf=Q}}Object(e.a)(nm,"PaginationDeltaResult",null,[1975]);class Bn{constructor(Q,
ya){this.Zub=this.Sdd=null;this.Lh=Q;ya.execute(kb=>{kb.register(this)})}get fVc(){return"PaginationDelta"}get result(){return this.Sdd}get RIf(){return 1}get f0f(){return 200}get isEnabled(){return!0}ZIf(){this.Sdd=null}tYa(Q){this.Lh.Sd(()=>{try{this.CCc(Q)}catch(ya){na.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",ya.message)}},"PDM:C")}V7f(Q){this.Zub=Q}CCc(Q){this.Sdd=null;Q=this.DCc(this.Zub,Q);-1!==Q&&(this.Sdd=new nm(Q))}DCc(Q,ya){if(!(Q&&
ya&&Q.count&&ya.count))return-1;const kb=new X.a;for(const Mb of Q)kb.add(Mb.top);Q=new X.a;for(const Mb of ya)Q.add(Mb.top);ya=this.dHd(kb,Q);return this.P0b(ya)}P0b(Q){if(!Q.count)return 0;let ya=0;for(let kb=0;kb<Q.count;kb++)ya+=Q.J(kb);return ya/Q.count}dHd(Q,ya){const kb=new X.a;if(!Q.count||!ya.count)return kb;var Mb=Q.count<=ya.count;const vc=Mb?Q:ya;Q=Mb?ya:Q;for(ya=0;ya<vc.count;ya++){Mb=vc.J(ya);let ae=Math.abs(Mb-Q.J(0)),we=0;for(let Ee=1;Ee<Q.count;Ee++){var id=Q.J(Ee);id=Math.abs(Mb-
id);id<ae&&(ae=id,we=Ee)}kb.add(ae);Q.removeAt(we)}return kb}}Object(e.a)(Bn,"PaginationDeltaMetric",null,[1926]);var Mk=c(411),Aq=c(1371),up=c(1951);class vp extends Mk.a{constructor(Q,ya,kb,Mb,vc,id,ae,we=null){super();this.bN=null;this.lqe=0;this.jXa=-1;this.jsb=!1;this.c8=()=>{na.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.SFh()};this.zLf=()=>{if(0==this.YR.Tv){var Ee=this.bN.zu;ee.a.Qp(Ee,this.yUb)||(this.yUb=Ee,this.B5m(this.UJa,this.yUb))}};
this.YR=Q;this.tba=this.tba.bind(this);this.YR.Jxb(this.tba);this.ga=ya;this.Gt=kb;this.DY=Mb;this.aka=vc;this.fCe=we||no.a.instance;this.yUb=this.UJa=ee.a.nil;this.iTj=ae;id.CWR(()=>id.result.pB.OXa(this.c8));this.o2b();this.Zj=new Aq.a(1E3);this.Zj.xZa();this.aka.register(this)}get aoa(){return"Pagination"}get z2b(){return this.iTj.value}get GBm(){return this.UJa}get jjj(){return this.jXa}A3n(Q){this.jXa!==Q&&(this.jXa=Q,this.DY.Ucg())}tba(){this.UJa=this.yUb=ee.a.nil;this.o2b()}Ekb(Q){this.bN=
Q;this.bN.mZb(this.zLf);this.XYb(this.bN.node)}B5m(Q,ya){ee.a.Qp(Q,ya)?(this.Gt.JYd(),this.o2b()):(this.Gt.KYd(),this.mfo())}ual(){this.enabled=2}o2b(){this.enabled=0}mfo(){this.lqe=0;this.ual();this.qE(null,null,null)}Pma(){return If.App.lostSession||If.App.yd.pB.zo?!1:!!(this.enabled&2)&&this.Zj.aX()}qE(){this.Zj.zfb();this.aka.yU()}forceOutbound(){}f3(){return 0===this.enabled?!1:this.ge&&2===this.ge.status?!0:this.Pma()}uRa(){if(1===this._state)this.ge.ks=up.a.U$(F.AFrameworkApplication.rootQuerySignature,
this.UJa),this.ge.vH="Pagination",this.ge.status=1,this._state=3;else if(3===this._state&&this.ge&&2===this.ge.status)if(F.AFrameworkApplication.Rk)this._state=4;else if(this.Zj.x0(),this.Zj.r7(),this._state=1,this.lqe++,2!==this.ge.statusCode)this.p2b();else if(1!==(this.ge.jk?this.ge.jk.length:0))this.p2b();else{var Q=this.ge.jk[0];this.fCe.G6a(Q);104===Q.StatusCode?this.SFh():101===Q.StatusCode?this.p2b():3===Q.StatusCode?this.p2b():Q.StatusCode?this.p2b():Q.PageEnds?(this.A3n(Q.PageEnds.length+
1),this.UJa=Oe.b(Q.LastKnownPaginationRevision),na.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.jXa,this.UJa),this.Gt.k7c(Q.PageEnds,ee.a.Qp(this.UJa,this.yUb)),this.z2b.eha=Q.PageEnds,this.DY.pZe(),na.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.jXa,this.UJa),
this.p5k()):this.p2b()}}SFh(){this.bN&&this.bN.RKb(this.zLf);this.o2b()}p2b(){60<this.lqe&&this.o2b()}p5k(){ee.a.Qp(this.UJa,this.yUb)&&this.o2b()}dispose(){this.bN&&(this.bN.RKb(this.zLf),this.bN.node&&this.Z_c(this.bN.node),this.bN=null);this.YR.OXf(this.tba)}XYb(Q){Q&&(Q.addListener(this),this.jsb=!0)}Z_c(Q){this.jsb&&Q&&(Q.removeListener(this),this.jsb=!1)}Fkb(Q){this.Z_c(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.Bd.Jm)&&this.z2m(this.UJa,Q.id)}onAfterFirstSaveContent(){}z2m(Q,ya){ee.a.Qp(Q,
ya)&&this.Gt.JYd()}}Object(e.a)(vp,"PaginationReplicator",Mk.a,[1927,9,52]);class vk{constructor(){this.U9=this.Gt=this.DY=this.gUa=this.mv=null;this.xra=!1;this.gkk=()=>{this.jhh()}}get name(){return"WordEditor.Pagination"}get qHo(){return F.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}xc(Q){this.W=Q;this.Wc=this.W.resolve("Box4.IFeatureHelper");this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new uk(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new tr(new fb.a(()=>If.App.xa.jb.wc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new ok(new fb.a(()=>If.App.xa.jb.wc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();
this.W.ha("WordEditor.IPaginationReplicator",()=>new vp(this.W.resolve("WordEditor.IMainViewModeManager"),F.AFrameworkApplication.ya,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),zi.App.i0,If.App.Lma(),new fb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new jl(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Qq(new fb.a(()=>If.App.xa.jb.wc),this.W.resolve("Box4.ITextMetricsAdapter"),ui.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new Vo(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),ui.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",
()=>new Bn(ui.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new ds(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new dr(new fb.a(()=>If.App.xa.jb.wc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",
()=>new Co(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new er(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new An(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
this.W.af("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",
()=>new qn(new fb.a(()=>If.App.xa.jb.wc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),If.App.kk.sl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new fo(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),
this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Uh.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Uo(this.W.resolve("Common.IZoomManager"),ui.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();
this.W.ha("WordEditor.Pagination.PaginationActor",()=>new go(F.AFrameworkApplication.ya,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),F.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new Bo(new fb.a(()=>If.App.xa.jb.wc),ke.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();
this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new ul(F.AFrameworkApplication.ya,rp.a.instance,Fl.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new fb.a(()=>If.App.xa.jb.wc),this.W.Pa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.Gt=new mm(new fb.a(()=>If.App.xa.jb.wc),new fb.a(()=>If.App.xa.jb.Yc.Bd),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),nj.a.LLc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),Fl.a.instance,mm.AEl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Lf.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.qHo,this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new vl(this.W.Za("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!If.App.instance&&If.App.instance.bC)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new yq(F.AFrameworkApplication.uc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new jp(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentManager",
()=>this.U9=new Oh(new fb.a(()=>If.App.xa.jb.wc),Ce.a.instance,Gf.a.instance,bd.a.instance,F.AFrameworkApplication.ya,Cg.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Fl.a.instance,F.AFrameworkApplication.K,!!If.App.instance&&If.App.instance.bC,!!If.App.instance&&If.App.instance.vna)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.Wc.hp.continueWith(()=>
{this.$m()})}$m(){const Q=If.App.xa.jb;Q.pva?this.jhh():Q.kea(this.gkk)}jhh(){this.xra||(this.xra=!0,this.gUa=za.a.instance.resolve("WordEditor.ICurrentPageManager"),this.DY=za.a.instance.resolve("Common.ICurrentPageCalculator"),this.mv=za.a.instance.resolve("WordEditor.IPaginationReplicator"),za.a.instance.resolve("WordEditor.Pagination.PaginationActor").Wb())}dispose(){this.U9&&(this.U9.dispose(),this.U9=null);this.Gt&&(this.Gt.dispose(),this.Gt=null);this.mv&&(this.mv.dispose(),this.mv=null);this.DY&&
(this.DY.disable(),this.DY=null);this.gUa&&(this.gUa=null)}}Object(e.a)(vk,"PackageManager",null,[1,2]);class Rc{constructor(){this.W=null}xc(Q){this.W=Q||za.a.instance}dispose(){}}Object(e.a)(Rc,"TellMePackage",null,[1,2]);var jn=c(1457),wp=c(1459),ho=c(283),ao=c(1456),bm=c(1358);class Do{constructor(Q=null,ya=null,kb=null,Mb,vc=null){this.$le=null;this.lAg=!1;this.qKg=this.rQb=null;this.w2j=this.G5g=this.mEj=this.rKg=!1;this.vbd=null;this.BEj=null==ya?F.AFrameworkApplication.ayb:ya;this.XPj=null==
kb?F.AFrameworkApplication.XZ:kb;this.f3j=null==vc?F.AFrameworkApplication.G5a:vc;this.COj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.R4j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.y3n(!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.I4j=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.tSc;this.J4j=!ao.a.rna()&&!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.H4j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.zLj=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.FMb;this.K4j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.Z1j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.tXj=this.y3c||this.x3c;this.rXj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.sXj=this.Owf;this.iSj=!!F.AFrameworkApplication.K&&this.CSa&&F.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.bNj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.HNj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.QMj=F.AFrameworkApplication.K?parseFloat(F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.fSj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.rQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&ao.a.mga();
this.O3j=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.LNj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.$1j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",
!1);this.Q2j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.r2j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.zO;this.sSj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.HRj=
!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.YRj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===F.AFrameworkApplication.uiCulture;this.pSj=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1));this.ESj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.oEj=this.CSa&&!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.jOj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.W2j=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1)||"Word"!==F.AFrameworkApplication.K.lb("Application"));this.OFj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.F6j=!!F.AFrameworkApplication.K&&(F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||F.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled"));this.uQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.yQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.ZRj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.Q0j=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.qDj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",
!1);this.GNj=F.AFrameworkApplication.K?F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.rSj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.yxm;this.wQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.xQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.vQj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.L4j=this.Hoi&&(this.bOf||this.cOf||this.nXc||this.CSa&&ao.a.mga()&&!!F.AFrameworkApplication.K&&(this.Tgc||this.KMb||this.LMb||this.MMb||this.OMb||F.AFrameworkApplication.K.$("ShowAnswerSearchResults")||F.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||F.AFrameworkApplication.K.$("ShowEntitySearchResults")||F.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.rDj=!!F.AFrameworkApplication.K&&!F.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&F.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&F.AFrameworkApplication.gBa;this.sDj=!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.fdm(Q||{});this.zKe="2918242107";this.yKe="1454393937";this.Lub={};this.Ibb=[];this.HOk=[ao.a.Hge]}get application(){return this.rQb}get ayb(){return this.BEj}get dRn(){return this.zKe}get cRn(){return this.yKe}get Qcf(){return this.qKg}get FNh(){return this.rKg}get XZ(){return this.XPj}get G5a(){return this.f3j}get Xxb(){return this.mEj}get V7l(){return this.COj}get Xko(){return this.R4j}get Hoi(){return!0}get Nko(){return this.L4j}get t6n(){return this.G5g}y3n(Q){this.G5g=
Q}get CSa(){return this.I4j}get y5c(){return this.J4j}get w5c(){return this.H4j}get Rgl(){return this.zLj}get Lko(){return this.K4j}get kge(){return!1}get nXc(){return this.tXj}get bOf(){return this.rXj}get cOf(){return this.sXj}get j2a(){return!1}get cVd(){return!1}get yyf(){return this.iSj}get $be(){return this.w2j}get Tgc(){return!1}get Q7n(){return!1}get OCm(){return""}get qkf(){return 2}get FQl(){return 4}get GQl(){return 5}get g4h(){return""}get iCl(){return this.bNj}get x4h(){return this.HNj}get i4h(){return 1E3}get h4h(){return 1E-6}get lho(){return this.O3j}get r8f(){return!1}get Hfj(){return!1}get mvm(){return this.YRj}get NUd(){return!1}get OUd(){return!1}get ili(){return!1}get hli(){return!1}get yxm(){return!1}get Ioi(){return!1}get RGd(){return!1}get hnb(){return!1}get KMb(){return!1}get LMb(){return!1}get MMb(){return!1}get OMb(){return!1}get y3c(){return this.Z1j}get Ogc(){return this.$1j}get x3c(){return!1}get Ahf(){return null}get HUd(){return!1}get Sbe(){return this.r2j}get v0h(){return 0}get hwl(){return this.QMj}get b5h(){return this.LNj}get rwm(){return this.fSj}get IRd(){return this.rQj}get GKl(){return-3.9}get zO(){return this.Q2j}get uSc(){return this.sSj}get $wf(){return this.HRj}get Qyf(){return this.pSj}get wcb(){return this.oEj}get Azm(){return this.ESj}get Xua(){return this.jOj}get Gcj(){return this.W2j}get ktk(){return this.OFj}get gie(){return this.F6j}get MRd(){return this.uQj}get Ijm(){return this.yQj}get yvm(){return this.ZRj}get V1i(){return this.Q0j}get hhk(){return this.qDj}get Su(){return this.GNj}get Yib(){return this.rSj}get Gjm(){return this.wQj}get Hjm(){return this.xQj}get Fjm(){return this.vQj}get ihk(){return this.rDj}get jhk(){return this.sDj}get XFb(){return!!F.AFrameworkApplication.ta&&
F.AFrameworkApplication.ta.Pb.nq}get nq(){return!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.nq}get asm(){return!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.Rgc}get dYm(){return Mh.getImageClass("OfficeAssistant_32x32x32")}WJd(){return Promise.reject("GetFindMatchCount method is not overridden")}sVd(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}CSd(){return!1}get WTd(){return!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get shj(){return F.AFrameworkApplication.K?
F.AFrameworkApplication.K.lb("TellMeServiceHelpClassifierModelName"):""}get Owf(){return!!F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get WDb(){return"NoOpHeaderUi"}get AOk(){return this.vbd}get parameterData(){return this.Lub}get Cro(){return this.Ibb}Hcl(){if(this.$le&&!this.lAg&&(this.lAg=!0,this.Ymb(this.$le),this.nq)){var Q=za.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new bm.a(Q)).tId(this.$le.uG);appChrome.api.dispatch(Q)}}get n0f(){return""}Ymb(){}$3k(Q){const ya=
[];for(let kb=0;kb<Q.length;++kb)Q[kb].M8n?ya.push(new ho.a(Q[kb].alternate,ao.a.Jlj+kb.toString())):ya.push(new ho.a(Q[kb].standard,ao.a.Hge+kb.toString()));return ya}fdm(Q){const ya={};for(let kb in Q){const Mb=kb,vc=Q[kb];for(let id in vc){const ae=id,we=vc[id];(ya[ae]||(ya[ae]={}))[Mb]=we}}this.vbd=ya}get thj(){return""}get Bbj(){return!1}}Object(e.a)(Do,"TellMeApplicationData",null,[1074]);class Nk{constructor(Q,ya=null,kb=!1){this.standard=Q;this.alternate=ya;this.M8n=kb}}Object(e.a)(Nk,"TryQuerySet",
null,[]);class xp{constructor(){this.PWg=this.QWg=null}get EVm(){return this.PWg}Qea(Q){this.QWg=Q;return this.O4e(Q)}hZm(){this.PWg=this.QWg}MKd(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.kC):Q.kC}Ygf(Q){return Q.kC}}Object(e.a)(xp,"ParameterizedCommand",null,[]);class lp extends xp{constructor(Q){super();this.hSc=Q}get commandId(){return this.hSc?"DefinitionsParameterized":"DefinitionButton"}get vPf(){return"Definition"}O4e(Q){const ya=qb.a.Cf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
Q.kC));return ri.a(ao.a.D5e(Q.value),Ua.a.h7e.toString(),ya,ao.a.jtf,null,qb.a.Cf(ao.a.Nzb(Q.kC)),ya,null,null)}MKd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.kC)}Ygf(Q){return ao.a.Nzb(Q.kC)}}Object(e.a)(lp,"DefinitionsParameterizedCommand",xp,[]);class Qn extends xp{constructor(Q){super();this.hSc=Q}get commandId(){return this.hSc?F.AFrameworkApplication.ta.Pb.zom?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get vPf(){return"Find"}O4e(Q){const ya=
qb.a.Cf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.kC));return ri.a(ao.a.D5e(Q.value),Ua.a.findInDocument.toString(),ya,"Find_16x16x32",null,qb.a.Cf(Q.kC),ya,null,null)}MKd(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.kC)}}Object(e.a)(Qn,"FindParameterizedCommand",xp,[]);class io extends xp{constructor(Q){super();this.hSc=Q}get commandId(){return this.hSc?"SynonymsParameterized":"SynonymButton"}get vPf(){return"Synonym"}O4e(Q){const ya=qb.a.Cf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
Q.kC));return ri.a(ao.a.D5e(Q.value),Ua.a.h7e.toString(),ya,ao.a.jtf,null,qb.a.Cf(ao.a.Nzb(Q.kC)),ya,null,null)}MKd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.kC)}Ygf(Q){return ao.a.Nzb(Q.kC)}}Object(e.a)(io,"SynonymsParameterizedCommand",xp,[]);var hk=c(1960),Xp=c(1878),Kn=c(1984),Ws=c(1955),jm=c(1956),Bq=c(1536);class ss extends hk.a{constructor(){super(...arguments);this.fS=null;this.gXa=Xp.FindManager.createInstance(this,Kn.a.instance,Bq.a.instance,
!0,!0)}static get instance(){return ss._instance}F3b(){this.fS(this.gXa.Mj.ria);this.gXa.vYa(!0)}WJd(Q){const ya=new Promise((kb,Mb)=>{this.fS=kb;setTimeout(()=>{Mb("Find manager execution timed out");this.gXa.vYa(!0)},500)});Q=Ws.a.createQuery(Q,jm.a.none);this.gXa.find(Q);return ya}}ss._instance=new ss;Object(e.a)(ss,"TellMeFindStatusSpy",hk.a,[]);class Mp extends Do{constructor(Q){super({});this.rQb="Word";this.oNj=Q;F.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.rKg=!0,this.qKg=
this.RGd?"FindWithMatchesParameterized":"FindParameterized");Q=new lp(this.XFb);const ya=new io(this.XFb);this.parameterData[Q.commandId]=Q;this.parameterData[ya.commandId]=ya;F.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&(Q=new Qn(this.XFb),this.parameterData[Q.commandId]=Q);F.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(Q=[new Nk(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Nk(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Nk(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,
"",!1),new Nk(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new Nk(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.Ibb=this.$3k(Q))}WJd(Q){return ss.instance.WJd(Q)}get L4a(){return gj.AppFrame.Xoa}get WDb(){return gj.AppFrame.qOa}get n0f(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Ymb(Q){var ya=F.AFrameworkApplication.K;Q=Q.uG;Q.WordCountFlyout=!this.oNj();Q.SelectAllButton=!ya.$("TellMeSelectAllResultIsEnabled");const kb=ya.$("TellMeDesktopUpSellIsEnabled");
let Mb=F.AFrameworkApplication.Axm;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Mb));Mb=!1;Q.TextBoxUpSellButton=!kb||Mb;Q.TableOfContentsUpSellButton=!kb||Mb;Q.SmartArtUpSellButton=!kb||Mb;Q.WordArtUpSellButton=!kb||Mb;Q.MultiColumnLayoutUpSellButton=!kb||Mb;Q.InsertEquationUpSellButton=!kb||Mb;Q.TrackChangesUpSellButton=!kb||Mb;Q.ShapesUpSellButton=!kb||Mb;Q.LabelsUpSellButton=!kb||Mb;Q.InsertCitationUpSellButton=!kb||Mb;Q.TextBoxUpSellButtonEnterprise=!kb||
!Mb;Q.TableOfContentsUpSellButtonEnterprise=!kb||!Mb;Q.SmartArtUpSellButtonEnterprise=!kb||!Mb;Q.WordArtUpSellButtonEnterprise=!kb||!Mb;Q.MultiColumnLayoutUpSellButtonEnterprise=!kb||!Mb;Q.InsertEquationUpSellButtonEnterprise=!kb||!Mb;Q.TrackChangesUpSellButtonEnterprise=!kb||!Mb;Q.ShapesUpSellButtonEnterprise=!kb||!Mb;Q.LabelsUpSellButtonEnterprise=!kb||!Mb;Q.InsertCitationUpSellButtonEnterprise=!kb||!Mb;ya=!ya.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!F.AFrameworkApplication.XZ;Q.SynonymButton=
ya;Q.DefinitionButton=ya}get thj(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get r8f(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get shj(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Tgc(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",
!1)}get Owf(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get qkf(){return F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Bbj(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get cVd(){return F.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",
!1)}get WTd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get NUd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get OUd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get i4h(){return F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",
1E3)}get h4h(){return 1E-6*F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get ili(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get hli(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get g4h(){return F.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName",
"")}get Ioi(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get v0h(){return F.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get Hoi(){return F.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get kge(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get j2a(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",
!1)}get $be(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get Hfj(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get HUd(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get KMb(){return F.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get LMb(){return F.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get MMb(){return F.AFrameworkApplication.K.$("ShowEntitySearchResults")}get OMb(){return F.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Ahf(){return F.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(Mp,"WordEditorTellMeApplicationData",Do,[]);var cm=c(1505),Eo;(function(Q){Q[Q.none=0]="none";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeFast=2]="synchronizeFast";Q[Q.synchronizeSlow=3]="synchronizeSlow"})(Eo||(Eo={}));Object(e.b)("ProviderSynchronizationType",Eo);var $i;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Q[Q.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})($i||
($i={}));Object(e.b)("MenuUpdatePolicy",$i);var Wo=c(1463),Vi=c(1460),yp=c(1588),Yp=c(1464),vr=c(1485),$m=c(101),Cq=c(249);class og extends hk.a{constructor(Q){super();this.E7j=Q}F3b(){this.E7j.update()}}Object(e.a)(og,"TellMeFindStatusManager",hk.a,[]);class ts{constructor(Q){this.Bbb=this.MCg=null;this.Fi=0;this.Kgd="TellMeWAC.";const ya=Q.Qcf;this.oc=Q;this.$dd=ya;this.XBe=Object.assign(new cm.a,{landingTab:"Indoc",data:null});Q=new og(this);this.gXa=Xp.FindManager.createInstance(Q,Kn.a.instance,
Bq.a.instance,!0,!0)}uK(){return"WordFindInDocument"}sT(){return this.oc.qkf?this.oc.qkf===$i.waitAll?Eo.waitAll:Eo.synchronizeSlow:Eo.none}qH(Q,ya){this.Nym(Q)?(this.Bbb=Q,this.MCg=ya,Q=Ws.a.createQuery(Q.Ig,jm.a.none),this.Fi=window.performance.now(),this.gXa.find(Q)):ya.resultsUpdated(new Wo.a(Q))}update(){this.OTn(Math.round(window.performance.now()-this.Fi));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.Bbb.Ig);var ya=F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.hnb?
ao.a.zMa(this.Bbb.Ig,15,this.XBe):qb.a.Cf(this.Bbb.Ig);const kb=[];kb.push(appChrome.actions.setControlLabel(this.$dd,Q));kb.push(appChrome.actions.setCompoundButtonCommandValueId(this.$dd,ya));kb.push(appChrome.actions.updateCompoundButtonDescription(this.$dd,this.Inf()));appChrome.api.dispatch(kb);Q=new Vi.a(this.$dd,yp.a.FindInDocument,this.Bbb.Ig,this.gXa.Mj.ria.toString());ya=new Yp.a(vr.a.FindInDocument);ya.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;ya.Ly(Q);const Mb=new Wo.a(this.Bbb);
Mb.Lv(ya);window.requestAnimationFrame(()=>{this.MCg.resultsUpdated(Mb)});this.gXa.vYa(!0);this.PTn(Math.round(window.performance.now()-this.Fi))}Inf(){const Q=this.gXa.Mj.ria.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}Nym(Q){return!!Q&&!!Q.Ig&&""!==Q.Ig.trim()}OTn(Q){const ya={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.Bbb.Ig.length};this.sendActivityEvent(ya,Q)}PTn(Q){const ya={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Bbb.Ig.length};this.sendActivityEvent(ya,Q)}sendActivityEvent(Q,ya){Q=$m.a.mE(Q);Tl.a.lGa(Object.assign(new Cq.a,{name:"Latency",dataFields:Q,durationMs:ya}),this.Kgd)}}Object(e.a)(ts,"WordFindInDocumentWithMatchesProvider",null,[1099]);class Ek{constructor(Q,ya){this.Bc=Q;this.kRd=
ya}k1a(Q,ya,kb){return this.kRd.k1a(0,Q,ya,kb)}insertHtmlText(Q){return Q?32===this.Msf(Q):!1}Msf(Q){return this.executeCommand(pg.a.Rsa,Q)}executeCommand(Q,ya){const kb=new cb.DictionaryPropertySet;kb.setValue(zb.a.PQ,ya);kb.setValue(zb.a.pxa,!1);ya=this.Bc.processAction(Q,1);32===ya&&(ya=this.Bc.Ub(Q,2,kb));return ya}}Object(e.a)(Ek,"WordInsertContentHandler",null,[1929]);class Hs extends Rc{constructor(){super();this.rx=()=>{if(F.AFrameworkApplication.R9f){var Q=If.App.xa.Pb.Bmf(Ua.a.tellMe);Q.sQc?
this.mMi():Q.lW(this.IQn);var ya=new Mp(()=>!1);jn.TellMeActor.instance.initialize(ya,null,null,null,null,null,Object(a.a)(If.App.xa,If.App.xa.aId,"forceUpdateRibbonControls"),F.AFrameworkApplication.K,this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Za("Common.IActionContextProvider"),this.W.Za("Common.ISystemInitiatedFeedback"));jn.TellMeActor.instance.Oxn(Q);jn.TellMeActor.instance.Mzn(new Ek(F.AFrameworkApplication.ya,this.W.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
ya.FNh&&ya.RGd&&jn.TellMeActor.instance.kF(new ts(ya),wp.a.tellMe)}};this.IQn=()=>{this.mMi()}}get name(){return"WordEditor.TellMe"}init(){F.AFrameworkApplication.K.lp(this.rx)}mMi(){If.App.xa.updateCommandUI()}}Object(e.a)(Hs,"WordEditorTellMePackage",Rc,[]);class Cn{constructor(){this.W=null;this.vhj=(Q,ya,kb)=>{2===kb&&(Q=new De.StandardDialog,Q.Ed=0,Q.Yha(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>
{this.$m()})}dispose(){}$m(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(128)){F.AFrameworkApplication.ya.gb(Bf.a.wordTestFeature,Sf.a.view,this.vhj,96);var Q=eh.FocusManager.instance().le(gj.AppFrame.oE);of.AFrame.oi(Q,vd.KeyInputManager.lc(cf.a.x7a,5|vd.KeyInputManager.Rh),Bf.a.wordTestFeature)}}xc(Q){this.W=Q}static main(){ca.a.instance.Kc(new Cn)}}Object(e.a)(Cn,"WordEditorTestFeaturePackage",null,[1,2]);var fr=c(115);class bo{constructor(Q,ya){this.g0i=Q;this.Bc=ya;this.B$d=(kb,
Mb,vc,id,ae)=>{if(1===vc)return 32;this.g0i.vO(9,ae,!1);return 32};this.Dba=(kb,Mb)=>{if(9===Mb.type){var vc;(kb=Mb.FM)?("string"===typeof kb?vc=kb:"data"===kb.type&&(vc=fr.a.dBh(kb.Ekn,kb.newState,kb.B3n)),vc&&bo.zAc(vc)):na.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.C_c()}C_c(){this.Bc.pa(Bf.a.B$d,We.a.frame,this.B$d);this.g0i.f6(this.Dba)}dispose(){}static zAc(Q){Q=If.App.xa.notificationBar.sla(Q,!1);Q.image=5;Q.Xma="CoAuth_AuthorStatus_16x16x32";
If.App.xa.notificationBar.BA(Q)}}Object(e.a)(bo,"TrackChangeNotificationActor",null,[]);class ai{constructor(){this.pj=this.lPe=this.W=null;this.eXc=()=>{if(this.pj=If.App.qNd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new bo(this.pj,F.AFrameworkApplication.ya)).singleInstance(),this.lPe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}xc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").hp.continueWith(()=>
{this.$m()})}$m(){If.App.qNd().continueWith(this.eXc)}dispose(){this.lPe&&this.lPe.dispose()}}Object(e.a)(ai,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var qo=c(81),jq=c(1441),zp=c(1949);class pk{}pk.Qbg="UnsavedChanges";pk.Rbg="UnsavedChangesThemed";pk.XPn="SavedChanges";pk.Rmj="UnsavedChangesOpenPipe";pk.Auo="UnsavedChangesOpenPipeCssClassNameThemed";pk.Qmj="UnsavedChangesClosePipe";pk.xuo="UnsavedChangesClosePipeThemed";pk.yuo="UnsavedChanges";pk.zuo="UnsavedChangesThemed";
pk.Sbg="UnsavedChangesIndicatorPositionRef";Object(e.a)(pk,"UnsavedChangesHighlightUtils",null,[]);class us extends jq.a{constructor(Q,ya){super();this.pda=Q;this.Tw=ya;this.v1=[this.Tw?new zp.a(pk.Rbg,pk.zuo):new zp.a(pk.Qbg,pk.yuo)]}get Kaa(){return!0}get shb(){return 4}get O0a(){return this.v1}nFa(Q,ya){if(this.pda){var kb=this.pda.mFf;if(kb&&kb.count&&kb.contains(Q.id))for(Q=ya.LFa("span"),ya=0;ya<Q.length;ya++)kb=Q[ya],ya||kb.classList.add(this.Tw?pk.Auo:pk.Rmj),ya===Q.length-1&&kb.classList.add(this.Tw?
pk.xuo:pk.Qmj),kb.classList.add(this.Tw?pk.Rbg:pk.Qbg)}}g0a(){}}Object(e.a)(us,"UnsavedChangesHighlightActor",jq.a,[]);var Ap=c(1014);class Lr{constructor(Q){this.Lqe=null;this.pda=Q;this.cze=!1}get key(){return"UnsavedChangesHighlight"}get Cw(){return"UnsavedChanges"}reset(Q){if(this.pda){Q=Q.node;if(tm.ParagraphReader.ic(Q)){const ya=this.pda.mFf;if(ya&&ya.contains(Q.id)){this.cze=!0;this.Lqe=Q.id;return}}this.cze=!1;this.Lqe=ee.a.nil}}jHa(){let Q=null;return this.cze?(Q=Object.assign(new Ap.a,
{kG:this.key,contentObject:this.Lqe,description:null}),{returnValue:!0,jF:Q}):{returnValue:!1,jF:Q}}}Object(e.a)(Lr,"UnsavedChangesHighlightCpContentDetailsProvider",null,[245,246]);class qt{constructor(Q,ya,kb,Mb,vc,id,ae){this.NWg=null;this.X4=Q;this.nf=ya;this.TV=kb;this.A5=Mb;this.U8g=vc;this.BWb=id;this.Tw=ae;this.nf.OXa(this.c8.bind(this))}get mFf(){return this.NWg}I8l(){if(this.X4){if(1===this.X4.j1e){if(0===this.X4.rAf&&this.X4.jIi()){this.NWg=this.X4.AZd;const Q=this.X4.U6c;this.X4.YPn.forEach(this.V4k.bind(this));
Q.forEach(this.J8l.bind(this));0<Q.length&&this.D6k(this.TV);return 0}return this.Dtn(this.X4.rAf)}return 2}return 1}Dtn(Q){switch(Q){case 0:return this.X4.M$h()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}Iai(Q,ya,kb){if(ya)if(kb){kb=ya.querySelectorAll("span");for(let Mb=0;Mb<kb.length;Mb++){const vc=kb[Mb];Mb||vc.classList.add(pk.Rmj);Mb===kb.length-1&&vc.classList.add(pk.Qmj);vc.classList.add(this.Tw?pk.Rbg:pk.Qbg)}ya.classList.add(pk.Sbg);Q&&this.A5.Ljc(Q)}else ya.classList.add(pk.XPn)}O6b(Q,
ya){const kb=this.AXl(Q);if(Q&&(Q=Q.xe(zi.App.xa.jb.wc.Sb)))if(Q.kg&&Q.kg.pi&&0!==Q.kg.pi.count)for(const Mb of Q.kg.pi)this.Iai(kb,Mb,ya);else this.Iai(kb,Q.htmlElement,ya)}AXl(Q){return this.U8g&&(Q=this.U8g.CMc(Q))&&Q&&(Q=Q.xe(zi.App.xa.jb.wc.Sb))?Q:null}J8l(Q){this.O6b(Q,!0);return!0}V4k(Q){this.O6b(Q,!1);return!0}D6k(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}c8(Q,ya){ya===Sys.EventArgs.Empty?na.ULS.sendTraceTag(572364513,
306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):ya&&ya.errorCode?this.BWb.g_||(Q=this.I8l(),na.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),Ca.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.Goo(Q)):na.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",ya?"Error Code":"Kickout Event Args")}Goo(Q){let ya;const kb=new Jk.a;kb.extendedProperties=new Map;kb.extendedProperties.set("HighlightUnsavedChangesResult",
Q.toString());kb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(Q){case 1:case 2:case 6:ya="HighlightInternalError";break;case 5:ya="ChangeOutsideCanvas"}6!==Q&&5!==Q||kb.extendedProperties.set("UnsavedChangesCollectionResult",this.X4.rAf.toString());ya&&(Ca.Health.instance.recordQosError(ya,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,kb),Ca.Health.instance.recordKpiFailure("UnsavedChangesHighlight",ya,!0,!0,kb))}dispose(){this.nf.yec(this.c8.bind(this))}}Object(e.a)(qt,"UnsavedChangesHighlighter",
null,[9]);var Dq=c(526),Np=c(492),Y=c(1439);class pa extends Y.a{constructor(Q,ya){super();this.pda=Q;this.Tw=ya}fnb(Q){if(!this.pda)return!1;const ya=this.pda.mFf;return ya?ya.contains(Q.yb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}Iyk(Q,ya){ya=Q.$ma?Q.$ma[ya]?Q.$ma[ya].style?Q.$ma[ya].style.marginLeft:null:null:null;var kb=Q.leftMargin;Q=1440<=kb?-(kb/1440*96):Q.Xcb(0,96,this.zoom);kb=0;ya&&(ya=ya.match(/^(\d+)px/))&&ya[1]&&(kb=Number(ya[1]));return Q-kb}nzk(Q,ya,kb){return Sys.UI.DomElement.getBounds(Q).y-
kb.jX[ya].y}wyk(Q){return Sys.UI.DomElement.getBounds(Q).height}BAh(Q,ya,kb,Mb){let vc;vc=this.Iyk(kb,ya);ya=this.nzk(Q,ya,kb);Q=this.wyk(Q);Mb=Dq.a.createElement(Mb,Np.a.div);Mb.className=this.Tw?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Mb.style.left=vc+"px";Mb.style.top=ya+"px";Mb.style.height=Q+"px";return Mb}Rzh(Q,ya,kb,Mb){const vc=[],id=Q.querySelectorAll("."+pk.Sbg);if(0===id.length&&Q.classList.contains(pk.Sbg))kb=this.BAh(Q,ya,kb,Mb),kb.Fdb=ya,vc.push(kb);else for(Q=0;Q<
id.length;Q++){const ae=this.BAh(id[Q],ya,kb,Mb);ae.Fdb=ya;vc.push(ae)}return vc}jZa(Q){let ya=[];var kb=Q.U3;const Mb=kb.Ug.ownerDocument;if(kb.Lj){let vc=0;for(const id of kb.kg.pi)(kb=this.Rzh(id,vc,Q,Mb))&&(ya=ya.concat(kb)),vc+=1}else ya=this.Rzh(kb.htmlElement,0,Q,Mb);return ya}}Object(e.a)(pa,"UnsavedChangesIndicatorActor",Y.a,[]);class rb{constructor(){this.vV=this.hu=this.kJa=this.A5=this.vgd=this.pda=null}get name(){return"WordEditor.UnsavedChangesHighlight"}xc(){}init(){this.A5=za.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;
this.pda=new qt(za.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),rf.SessionStatusManager.instance,eo.a.sq(za.a.instance.Za("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.A5,za.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),za.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!If.App.instance&&If.App.instance.vna);this.kJa=za.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager");this.vV=za.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;
this.vgd=new pa(this.pda,!!If.App.instance&&If.App.instance.vna);this.A5.t4a(this.vgd);this.kJa&&this.kJa.execute(Q=>{Q.a4(new Lr(this.pda))});this.hu=new us(this.pda,!!If.App.instance&&If.App.instance.vna);this.vV.s4a(this.hu)}dispose(){this.A5&&this.vgd&&this.A5.hhe(this.vgd);this.vV&&this.hu&&this.vV.Lbg(this.hu);qo.a.kB(this.pda)}static main(){ca.a.instance.Kc(new rb)}}Object(e.a)(rb,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,9]);var ec=c(344);class wc{constructor(Q,ya,kb,Mb){Q=new wordVersionHistory.AppBootSettings;
Q.logger=new ec.a;Q.forcePdfDevEnv=!1;Q.userSessionId=F.AFrameworkApplication.userSessionId;Q.wacCluster=Mb;Q.publicScriptPath=F.AFrameworkApplication.u4;Q.userType=F.AFrameworkApplication.userType;this.Aie=new wordVersionHistory.AppVersionControllerImpl(Q,ya)}onVersionSelected(Q,ya,kb,Mb){this.Aie.onVersionSelected(Q,ya,kb,Mb)}onDownloadTokenReady(Q,ya){this.Aie.onDownloadTokenReady(Q,ya)}getRenderFailureEvent(){return this.Aie.getRenderFailureEvent()}getLoadFinishEvent(){return this.Aie.getLoadFinishEvent()}}
Object(e.a)(wc,"AppVersionControllerImplWrapper",null,[2015]);class gd{create(Q,ya,kb,Mb){return new wc(Q,ya,kb,Mb)}}Object(e.a)(gd,"AppVersionControllerImplWrapperFactory",null,[2014]);class Qd{getVersionHistoryControllerInstance(Q){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):null}}Object(e.a)(Qd,"VersionHistoryControllerFactory",null,[2013]);class Yd{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(ya){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(ya){}}}
Object(e.a)(Yd,"VersionHistoryLogConnector",null,[]);var Le=c(530),Ef=c(1425),Mg=c(1627);class Gi{constructor(){this.revisionId=null;this.EZf=0}}Object(e.a)(Gi,"ForceSaveData",null,[]);class oh extends Uj.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}el(){return 106}static construct(Q,ya,kb){const Mb=new oh;Mb.FileId=Q;Mb.VersionToken=ya;Mb.ExclusiveLockId=Oe.a(kb);return Mb}}Object(e.a)(oh,"RestoreVersionRequest",Uj.a,[]);class vh{static Ima(){return(new Date).getTime()}static LMk(Q){const ya=
new Jk.a;ya.durationMs=Q;ya.extendedProperties=new Map;return ya}}Object(e.a)(vh,"VersionHistoryUtils",null,[]);var rj=c(312);class La{constructor(Q,ya,kb,Mb,vc,id,ae,we,Ee,jf,Ng,Fg,ck,Ki,Il){this.Bc=Q;this.Hh=ya;this.mK=kb;this.Lnl=Mb;this.$s=vc;this.Vsi=id;this.F8c=ae;this.jxd=we;this.YEo=Ee;this.K=jf;this.ukk=Ng;this.fXe=Fg;this.ipb=ck;this.Ne=Ki;this.veg=Il;this.iTa=this.TIc=this.Q3c=this.yce=this.X5f=this.ubg=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.V9d=
0;this.KZb=this.zie=null;this.xeg=Ef.b.None;this.w9b=!1;this.zeg="";this.gfl={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.acj=(wl,Wi,wg)=>{if(1===wg)return rf.SessionStatusManager.instance.zj?8:32;if(2===wg){this.zie=cd.a.create().toString();na.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.zie);F.AFrameworkApplication.Xm("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");
F.AFrameworkApplication.Aga("WoVer882;WoVer882cf");Object(Mg.a)();this.Ne.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.Ne.logUserAction(Bf.a.jbn,{succeeded:!0});this.hhj.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Gu.VersionHistoryLaunchSessionId=this.zie;this.perfTelemetryInfos=[];this.controller||(this.zeg=this.K.lb("WacCluster"),this.controller=this.YEo.getVersionHistoryControllerInstance({ulsLogger:new ec.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,
docId:F.AFrameworkApplication.Gm,appSettings:{appName:Ef.a.Word,wdEnableDownloadTokens:this.F8c.nuj,wdEnableSaveACopy:!0,wdEnableRestore:this.F8c.luj,userSessionId:F.AFrameworkApplication.userSessionId,wacCluster:this.zeg,uiLocale:F.AFrameworkApplication.uiCulture?F.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:F.AFrameworkApplication.K.lb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.F8c.muj,
isRtl:F.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),useXhr:!1,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Ne.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:La.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.C5n()||
this.z5n());this.ebo()}return 32};this.fJn=(wl,Wi,wg)=>{if(1===wg)return rf.SessionStatusManager.instance.XI?32:8;2===wg&&(wl=this.Cdb(this.V9d),this.Ne.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:wl}),this.BVf());return 32};this.eJn=(wl,Wi,wg,xr,Mr)=>{var Tq,Zp,Vg;if(1===wg)return rf.SessionStatusManager.instance.XI?32:8;2===wg&&(wl="Unknown",Wi="",Mr&&(wl=null!==(Tq=Mr.FailureReason)&&void 0!==Tq?Tq:wl,Mr=null!==(Zp=Mr.ExtraInfo)&&void 0!==Zp?Zp:"",Wi=null!==(Vg=this.gfl[Mr])&&
void 0!==Vg?Vg:Mr),Zp=this.Cdb(this.V9d),""!==Wi&&Zp.extendedProperties.set("ExtraInfo",Wi),Vg=this.ipb.Qgb(wl,3,Wi),this.Ne.logKpiFailure("WordVersionHistorySaveACopy",wl,{isIntentional:Vg.isIntentional,additionalValues:Zp},Vg),na.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",wl,Wi));return 32};this.hWd=()=>{this.rBi();this.BVf();this.$s&&this.$s.refreshDocument({Z8n:!0})};this.Nnl=wl=>{na.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var Wi=wl.revisionId;const wg=
ee.a.create();Wi=oh.construct(F.AFrameworkApplication.rootQuerySignature,Wi,wg);const xr=Object.assign(new On.a,{ks:Wi,status:1,vH:"RestoreVersion"});Wi=this.fXe.kma(0,()=>{this.n4l(xr,wl.EZf)});Wi.cK(xr);Wi.HW()};this.eQh=(wl,Wi)=>{this.w9b=!1;const wg=this.Cdb(wl.EZf);wg.extendedProperties.set("status",Le.a[Wi]);const xr=this.ipb.Qgb("ForceSaveFailed",5);this.Ne.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:xr.isIntentional,additionalValues:wg},xr);this.Ne.logUserAction(Bf.a.yDc,
{succeeded:!1});na.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+Le.a[Wi]+" for version "+wl);this.controller.setRestoreFailedAtServer(this.hWd)};this.hhj={};this.Gu={};this.dbo=!1;this.vX=!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Pb.vX}Ayd(){null===this.TIc&&(this.TIc=vh.Ima())}Cdb(Q){const ya=new Jk.a;null===Q?na.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(ya.durationMs=vh.Ima()-Q,ya.extendedProperties=
new Map);return ya}Fem(){null===this.iTa&&(this.iTa=vh.Ima());this.Ne.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0})}BVf(){const Q=[],ya=Object.assign(new Jk.a,{extendedProperties:new Map});if(null!=this.yce&&null!=this.X5f){var kb=this.yce-this.X5f;Q.push(Object.assign(new ni.a,{name:"showPaneDuration",string:kb.toString()}));ya.extendedProperties.set("showPaneDuration",kb.toString())}null!=this.TIc&&null!=this.Q3c&&(kb=this.TIc-this.Q3c,Q.push(Object.assign(new ni.a,{name:"firstActionDuration",
string:kb.toString()})),ya.extendedProperties.set("firstActionDuration",kb.toString()));(kb=this.xeg===Ef.b.None)?this.Ne.logKpiSuccess("WordVersionHistory",{additionalValues:ya}):this.Ne.logKpiFailure("WordVersionHistory",Ef.b[this.xeg],{isIntentional:!1,additionalValues:ya},{name:La.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.Ne.logUserAction(Bf.a.SHk,{succeeded:kb,customData:Q})}Wb(){this.Bc.pa(Ua.a.Lce,We.a.frame,this.acj);this.Bc.pa(Ua.a.M0c,We.a.frame,this.fJn);
this.Bc.pa(Ua.a.M8d,We.a.frame,this.eJn)}ebo(){this.X5f=vh.Ima();this.TIc=this.Q3c=this.yce=null;if(document.getElementById("VersionHistoryOverlay"))this.XG();else{this.jzn();this.izn();this.Syn();this.Xyn();this.fzn();this.Wyn();this.F8c.ouj&&this.Vyn();this.ezn();this.gzn();const Q=document.createElement("div");let ya=Q.id="VersionHistoryOverlay",kb=null;this.Yyn(Q);if(this.vX&&(kb=Object(rj.a)("Header"))){const Mb=document.getElementById("AppHeaderPanel");ya=Mb&&"none"===Mb.style.display?String.format("{0} {1} {2}",
ya,"RegionComposer","NoAppHeader"):String.format("{0} {1}",ya,"RegionComposer")}kb||(kb=document.getElementById("WACInnerFrame"));Q.className=ya;kb.appendChild(Q);this.ubg=this.controller.createVersionHistoryDialog(Q);this.Wha()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}C5n(){if(F.AFrameworkApplication.pM)return na.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const Q=
32==this.Bc.processAction(Ua.a.tfc,1),ya=32==this.Bc.processAction(Ua.a.wfc,1);return Q||ya?!1:(na.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}z5n(){return F.AFrameworkApplication.pM?(na.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.Bc.processAction(Ua.a.downloadACopy,1)?(na.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0):!1}Xyn(){this.controller.getFullAppErrorEvent().addListener(Q=>{const ya=Q?Ef.b[Q]:"";this.Gu[La.Fko]=ya;this.xeg=Q;na.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",ya,this.zie)})}jzn(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.yce=vh.Ima();this.UJn(Q.containerDiv);this.veg.initialize(this.KZb);this.XG()})}izn(){this.controller.getVersionSelectedEvent().addListener(Q=>{null===this.iTa&&(this.iTa=vh.Ima());this.veg.display(Q)})}Vyn(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>
{try{na.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.Z2l(Q)}catch(ya){na.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",ya)}})}Z2l(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.Fem(),this.KZb.onVersionSelected(this.currentVersion,this.baseVersion,this.hhj,!this.dbo)):na.ULS.sendTraceTag(591697922,
3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}Syn(){this.controller.getCloseSelectedEvent().addListener(()=>{this.THk();this.oCm()})}Zdm(Q){const ya={};ya.FileDownloadUrl=Q;ya.SaveEntryPoint="VersionHistory";return ya}BSl(Q){let ya="Dialog Failure - ActionResponse "+Q.toString();2===Q?ya="DialogNotHandled":8===Q&&(ya="DialogFailed");return ya}fzn(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.V9d=vh.Ima();this.Ne.logKpiUsage("WordVersionHistorySaveACopy",
0);this.Ayd();na.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.rBi();var ya=this.Zdm(Q);Q=32==this.Bc.processAction(Ua.a.tfc,1);ya=this.Bc.Ub(Q?Ua.a.tfc:Ua.a.wfc,2,ya);const kb=this.Cdb(this.V9d),Mb=32===ya;if(!Mb){const vc=this.BSl(ya),id=this.ipb.Qgb(vc,2);this.Ne.logKpiFailure("WordVersionHistorySaveACopy",vc,{isIntentional:id.isIntentional,additionalValues:kb},id);na.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
ya.toString())}this.Ne.logUserAction(Bf.a.OGk,{succeeded:Mb})})}Wyn(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>{var ya=vh.Ima();this.Ne.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.Ayd();Q=new zk.QueryStringBuilder(Q);Q.Pe("fn",F.AFrameworkApplication.fileName);Q=this.Bc.Ub(Ua.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});ya=this.Cdb(ya);const kb=32===Q;kb?this.Ne.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:ya}):(this.Ne.logKpiFailure("WordVersionHistoryDownloadVersion",
Q.toString(),{isIntentional:!1,additionalValues:ya},{name:La.vetoName,errorNameOverride:"DownloadVersionFailed"}),na.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+Q.toString()));this.Ne.logUserAction(Bf.a.NGk,{succeeded:kb})})}n4l(Q,ya){this.w9b=!1;if(2===Q.statusCode&&Q.jk&&0<Q.jk.length&&Q.jk[0])if(Q=Q.jk[0],ya=this.Cdb(ya),this.Vsi&&Q.ShouldAvoidLockRelease&&this.Vsi.Gmb(!1,"VersionHistory"),191===Q.StatusCode)Q=this.ipb.Qgb("MultipleClientsInCoauthSession",5),this.Ne.logKpiFailure("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:ya},Q),this.Ne.logUserAction(Bf.a.yDc,{succeeded:!1}),na.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),La.pCm();else if(Q.StatusCode){ya.extendedProperties.set("status",Le.a[Q.StatusCode]);const kb=this.ipb.Qgb("ServerOperationFailed",5);this.Ne.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,
additionalValues:ya},kb);this.Ne.logUserAction(Bf.a.yDc,{succeeded:!1});na.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+Le.a[Q.StatusCode]);this.controller.setRestoreFailedAtServer(this.hWd)}else this.Ne.logKpiSuccess("WordVersionHistoryRestore",{additionalValues:ya}),this.Ne.logUserAction(Bf.a.yDc,{succeeded:!0}),na.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.hWd();else ya=this.ipb.Qgb("ServerOperationFailed",5),this.Ne.logKpiFailure("WordVersionHistoryRestore",
"serverOperationFailed",{isIntentional:ya.isIntentional},ya),na.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+Zi.a[Q.statusCode]),this.controller.setRestoreFailedAtServer(this.hWd)}ezn(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{if(this.w9b)na.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.w9b=!0;this.Ayd();var ya=vh.Ima();this.Ne.logKpiUsage("WordVersionHistoryRestore",0);var kb=null;Q&&(kb=Q.split("-")[0]);kb&&""!==kb?(Q=Object.assign(new Gi,
{revisionId:kb,EZf:ya}),na.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",kb),this.controller.setRestoreInProgress(),this.Lnl(19,!1,this.Nnl,this.eQh,Q,null,null)):(kb=this.ipb.Qgb("InvalidRevisionId",5),this.Ne.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:kb.isIntentional},kb),this.Ne.logUserAction(Bf.a.yDc,{succeeded:!1}),na.ULS.shipAssertTag(592197012,3005,!1),this.w9b=!1)}})}kzn(){this.KZb.getRenderFailureEvent().addListener(Q=>
{const ya=this.ipb.Qgb(Q,1),kb=this.Cdb(this.iTa);this.iTa=null;this.Ne.logKpiFailure("WordVersionHistorySelectVersion",Q,{isIntentional:ya.isIntentional,additionalValues:kb},ya);try{this.Gu.ViewerErrorCode="ViewerErrorCode"in this.Gu?this.Gu.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),na.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(Mb){na.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Mb)}})}Zyn(){this.KZb.getLoadFinishEvent().addListener(()=>
{null==this.Q3c&&(this.Q3c=vh.Ima());const Q=this.Cdb(this.iTa);this.iTa=null;this.Ne.logKpiSuccess("WordVersionHistorySelectVersion",{additionalValues:Q});this.controller.setVersionLoadComplete()})}gzn(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>{null===this.iTa&&(this.iTa=vh.Ima());this.veg.qno()})}allowKeytips(Q){ci.a("allowKeytips")&&appChrome.api.allowKeytips(Q)}XG(){this.mK.ex(gj.AppFrame.Xoa);this.allowKeytips(!1);this.mK.ex(of.AFrame.So);this.mK.ex(gj.AppFrame.vpa);
this.Hh.LK("VersionHistoryViewer",!1);this.mK.XG("VersionHistoryViewer");this.Hh.LK("VersionHistoryHeader",!0);this.mK.XG("VersionHistoryHeader");this.Hh.LK("VersionHistoryOverlay",!0);this.mK.XG("VersionHistoryOverlay")}ex(){this.mK.XG(gj.AppFrame.Xoa);this.allowKeytips(!0);this.mK.XG(of.AFrame.So);this.mK.XG(gj.AppFrame.vpa);this.mK.ex("VersionHistoryOverlay");this.Hh.RQ("VersionHistoryOverlay");this.mK.ex("VersionHistoryHeader");this.Hh.RQ("VersionHistoryHeader");this.mK.ex("VersionHistoryViewer");
this.Hh.RQ("VersionHistoryViewer")}THk(){this.w9b&&na.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.BVf();document.getElementById("VersionHistoryOverlay").style.display="none";this.Gu.browser=Fa.a.tF;Fa.a.n3&&(this.Gu.electronBrowserVersion=Fa.a.t$k);this.ex();na.ULS.sendTraceTag(592197017,3005,50,Ha.c(this.Gu))}UJn(Q){try{if(this.KZb)Yd.setIsPageLoadForFirstTime(!1);else{Yd.setIsPageLoadForFirstTime(!0);const ya=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",
!1)?this.zeg:"";this.KZb=this.ukk.create(this.F8c,Q,this.jxd,ya);this.kzn();this.Zyn()}}catch(ya){na.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",ya)}}eFc(Q){const ya=this.Hh.le(Q);ya.parent=of.AFrame.Hp;this.mK.Csa(Q);ya.BK=!0;return ya}Wha(){this.eFc("VersionHistoryOverlay").z$((Q,ya)=>{try{null!=Q&&"dialog/modal"==Q.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===ya.name&&this.ubg.then(kb=>
{kb.enterFocusTrapZone();return null})}catch(kb){na.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",kb)}});this.eFc("VersionHistoryHeader").z$((Q,ya)=>{try{"VersionHistoryHeader"===ya.name&&this.ubg.then(kb=>{kb.enterHeaderFocusTrapZone();return null})}catch(kb){na.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",kb)}});this.eFc("VersionHistoryViewer").z$((Q,ya)=>{try{"VersionHistoryViewer"===
ya.name&&eh.FocusManager.wJ(document.getElementById("vhViewer"))}catch(kb){na.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",kb)}})}oCm(){const Q=za.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):na.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}rBi(){const Q=za.a.instance.Pa("Common.ISystemInitiatedFeedback");
Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):na.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static pCm(){const Q=za.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):na.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}Yyn(Q){Q&&Q.addEventListener("keydown",ya=>{ya.ctrlKey&&"KeyC"===ya.code&&
(this.Ayd(),this.Ne.logKpiUsage("WordVersionHistoryCopyText",0),!F.AFrameworkApplication.protectFile&&!F.AFrameworkApplication.pM||F.AFrameworkApplication.TAb||ya.preventDefault());ya.ctrlKey&&"KeyF"===ya.code&&this.Ne.logKpiUsage("WordVersionHistorySearchText",0)})}}La.Fko="ErrorCode";La.vetoName="VersionHistoryExperienceDegraded";Object(e.a)(La,"VersionHistoryPaneActor",null,[2012]);class Za{constructor(){this.muj=this.luj=this.ouj=this.nuj=!1}}Object(e.a)(Za,"WordVersionHistorySettings",null,[]);
class yb{Qgb(Q,ya,kb){const Mb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};0==ya?Mb.errorNameOverride="VersionHistoryLaunchFailed":1==ya?Q.includes("Failed to fetch")?Mb.errorNameOverride="SelectVersionFailedBecauseFetchFailed":Q.includes("Unexpected server response (500) while retrieving PDF")?Mb.errorNameOverride="SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (502) while retrieving PDF")?Mb.errorNameOverride="SelectVersionFailedServerResponseBadGateway":
Q.includes("Unexpected server response (415) while retrieving PDF")?(Mb.errorNameOverride="SelectVersionFailedServerResponseUnsupportedMediaType",Mb.isIntentional=!0):Q.includes("Unexpected server response (408) while retrieving PDF")?Mb.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":Q.includes("Unexpected server response (400) while retrieving PDF")?Mb.errorNameOverride="SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?
(Mb.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Mb.isIntentional=!0):Mb.errorNameOverride="SelectVersionFailed":5==ya?(Mb.errorNameOverride="RestoreVersionFailed"+Q,Mb.isIntentional="MultipleClientsInCoauthSession"===Q):4==ya?Mb.errorNameOverride="DownloadVersionFailed"+Q:2==ya?Mb.errorNameOverride=yb.R_f+Q:3==ya&&(kb?(Mb.errorNameOverride=yb.R_f+kb,Mb.isIntentional="OverwriteTarget"===kb||"TargetFileLocked"===kb):(Q=this.xFl(Q),Mb.errorNameOverride=Q?"SaveVersionFailedServerResponse"+
Q:yb.R_f));return Mb}xFl(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}yb.R_f="SaveVersionFailed";Object(e.a)(yb,"WordVersionHistoryVetoHelper",null,[2011]);var lc=c(1017),Ic=c(1010);class dd{constructor(Q,ya){this.Nie=Q;this.Ne=ya;this.jVe=null;this.eSc=!0}initialize(Q){this.jVe=Q}qno(){this.eSc=!this.eSc;this.display(this.n9e)}display(Q){this.n9e=
Q;this.XCf(Q);if(this.jVe){var ya=this.Nie.$Zl(Q,this.eSc);if(2==ya)this.Nie.V$m(Q.currentVersion.RevisionID);else{1==ya&&this.Ne.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.Nie.k3m(Q.currentVersion.RevisionID);try{this.jVe.onVersionSelected(this.n9e.currentVersion,this.n9e.baseVersion,null,this.eSc)}catch(kb){na.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",kb)}}}else this.gOm()}XCf(Q){this.Nie.ukm(Q.currentVersion.RevisionID)||
(this.Ne.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0}),this.eSc&&!Q.noBaseToCompareTo&&this.Ne.logKpiUsage("WordVersionHistoryShowChanges",0))}gOm(){this.Ne.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});na.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(e.a)(dd,"VersionDisplayActor",null,[1924]);var rd;(function(Q){Q[Q.notStarted=0]="notStarted";
Q[Q.inProgress=1]="inProgress";Q[Q.complete=2]="complete"})(rd||(rd={}));Object(e.b)("WaitForBaseState",rd);class Wd{constructor(Q,ya){this.revisionId=Q;this.Ne=ya;this.state=rd.notStarted}get yZk(){return this.revisionId}begin(){this.state==rd.notStarted&&(this.startTime=vh.Ima(),this.state=rd.inProgress,this.Ne.logKpiUsage("WordVersionHistoryWaitForBase",1),na.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(Q){if(this.state==rd.inProgress){this.state=rd.complete;this.endTime=
vh.Ima();const ya=vh.LMk(this.endTime-this.startTime);this.revisionId==Q?this.Ne.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:ya}):this.Ne.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:ya},{name:"VersionHistoryExperienceDegraded"})}}}Object(e.a)(Wd,"WaitForBaseOperation",null,[]);class Be{constructor(Q){this.Ne=Q}$Zl(Q,ya){return Q.noBaseToCompareTo||!ya?0:Q.baseVersion?Q.baseVersion.DownloadUrl&&0<Q.baseVersion.DownloadUrl.length?0:void 0===
Q.baseVersion.DownloadUrl||null===Q.baseVersion.DownloadUrl?1:0==Q.baseVersion.DownloadUrl.length?2:1:1}ukm(Q){return this.iPb?this.iPb.yZk==Q:!1}k3m(Q){this.iPb&&this.bfj(Q)}V$m(Q){this.iPb&&this.bfj(Q);this.iPb=new Wd(Q,this.Ne);this.iPb.begin()}bfj(Q){this.iPb.end(Q);this.iPb=null}}Object(e.a)(Be,"WaitForBaseController",null,[1925]);class sf{constructor(){this.HCo={crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){F.AFrameworkApplication.wVd()?
(na.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),Wa.a.get_instance().al(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").pA;(F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(ya=>na.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",ya)).then(()=>this.O$m()).catch(ya=>
na.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",ya))})):na.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}O$m(){na.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").Wb();return null}dispose(){}xc(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");
if(this.K.$("AppSupportsVersionHistory")){var ya=this.container.resolve("Common.IBrowserUtils"),kb=new Za;kb.nuj=this.K.$("WordWdDownloadTokenIsEnabled");kb.ouj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");kb.luj=this.K.$("WordVersionHistoryEnableRestore");kb.muj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");this.container.ha("IFeatureUsageAndHealthLogger",()=>new lc.a(Ca.Health.instance,new Ic.a,this.HCo)).singleInstance();this.container.ha("IWaitForBaseController",()=>new Be(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();
this.container.ha("IVersionDisplayActor",()=>new dd(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionHistoryPaneActor",()=>new La(F.AFrameworkApplication.ya,eh.FocusManager.instance(),Ue.a.instance,Lc.a.VP,If.App.xa,If.App.j0,kb,ya,new Qd,F.AFrameworkApplication.K,new gd,new te.a,new yb,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let Q=
!1;F.AFrameworkApplication.K&&F.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&F.AFrameworkApplication.wVd()&&(Q=!0);ca.a.instance.Kc(new sf,0,Q)}}Object(e.a)(sf,"WordVersionHistoryPackage",null,[1,2]);var Th=c(106);class hj{constructor(Q,ya,kb){this.ga=Q;this.Sm=ya;this.Ma=kb}Wb(){this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Ua.a.rhc,We.a.frame,Object(a.a)(this.Sm,this.Sm.rhc,"showZoomDialog")),this.ga.gb(Ua.a.Dqn,We.a.frame,Object(a.a)(this.Sm,this.Sm.mGi,"onQueryZoomText"),
96),this.ga.pa(Ua.a.L8c,We.a.frame,Object(a.a)(this.Sm,this.Sm.Cuj,"zoomDialogTabFocusHandler")),this.ga.pa(Ua.a.K8c,We.a.frame,Object(a.a)(this.Sm,this.Sm.Cuj,"zoomDialogTabFocusHandler")));this.Ma.$("ZoomSliderIsEnabled")&&(this.ga.gb(Ua.a.hQi,We.a.frame,Object(a.a)(this.Sm,this.Sm.G7m,"onQueryZoomPercentage"),96),this.ga.gb(Ua.a.Fuj,We.a.frame,Object(a.a)(this.Sm,this.Sm.han,"onZoomToPercentage"),96),this.ga.pa(Ua.a.PKo,We.a.frame,Th.ActionManager.Mf))}}Object(e.a)(hj,"CommonZoomActor",null,[930]);
class qg extends hj{constructor(Q,ya,kb){super(Q,ya,kb);this.cea=ya}Wb(){super.Wb();this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Bf.a.Wfg,We.a.frame,Th.ActionManager.Mf),this.ga.pa(Bf.a.vje,We.a.frame,Object(a.a)(this.cea,this.cea.OKo,"zoomTo100")));this.ga.pa(Bf.a.zoomToPageWidth,We.a.frame,Object(a.a)(this.cea,this.cea.zoomToPageWidth,"zoomToPageWidth"));this.ga.pa(Ua.a.Ghb,We.a.frame,Object(a.a)(this.cea,this.cea.Ghb,"increaseZoom"));this.ga.pa(Ua.a.jeb,We.a.frame,Object(a.a)(this.cea,this.cea.jeb,
"decreaseZoom"));this.ga.pa(Bf.a.B0f,We.a.frame,Object(a.a)(this.cea,this.cea.m3n,"setZoomLevelFromRibbon"));this.ga.gb(Bf.a.Hlb,We.a.frame,Object(a.a)(this.cea,this.cea.mGi,"onQueryZoomText"),96);this.ga.gb(Bf.a.M6d,Sf.a.application,Object(a.a)(this.cea,this.cea.F7m,"onQueryZoomLevelLabelText"),96);this.ga.pa(pg.a.aCh,We.a.frame,Th.ActionManager.Mf);this.ga.pa(pg.a.$Bh,We.a.frame,Th.ActionManager.Mf);this.ga.pa(pg.a.eCh,We.a.frame,Th.ActionManager.Mf);this.ga.pa(pg.a.bCh,We.a.frame,Th.ActionManager.Mf);
this.ga.pa(Bf.a.Dia,We.a.frame,Th.ActionManager.Mf)}}Object(e.a)(qg,"WordEditorZoomActor",hj,[]);class Di{constructor(Q,ya){this.zoom=Q;this.$ik=ya}}Object(e.a)(Di,"SetCustomZoomArgs",null,[]);var Ej=c(1132);class aj{constructor(Q,ya){this.L_k=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.M_k=[aj.h8e,aj.CDd,"200","150","100","75","50"];this.Ala=3;this.VM=0;this.delta=.1;this.nBf=0;this.Ld=new k.a;this.eg=null;this.K=Q;this.Bc=ya;this.E8i(1)}get jj(){return this.VM}E8i(Q){this.VM=
Q}get MFc(){return Math.round(100*this.jj)}get RXm(){return Math.floor(this.MFc/10)/10+this.delta}get QXm(){return Math.ceil(this.MFc/10)/10-this.delta}get ga(){return F.AFrameworkApplication.ya}Ugk(Q){this.Ld.addHandler("ZoomChanged",Q)}mGn(Q){this.Ld.removeHandler("ZoomChanged",Q)}u8(Q){this.Ugk(Q)}Ylb(Q){this.mGn(Q)}GTi(){}zVi(){}FTi(){}yVi(){}M8c(Q){this.Duj(Q,this.jj)}Duj(Q,ya){null!==Q&&Mt.a.$0n(Q,ya)}M3f(Q,ya=!0){let kb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(kb=new Di(Q,
ya));this.c5i(kb)}l3n(Q,ya=!1){this.Dia(Q,3|(ya?0:4))}fan(Q,ya,kb){if(1===Q)return 32;Q=kb/100;Q<this.iVc?Q=this.iVc:Q>this.QUc&&(Q=this.QUc);this.Dia(Q,1);ya&&(ya.Xr=Math.floor(100*Q));return 32}mGi(Q,ya,kb,Mb,vc){if(1===kb)return 32;Q=qb.a.SCa(this.MFc,6,F.AFrameworkApplication.numberFormat);vc.Value=Q;vc.LabelText=Q;return 32}han(Q,ya,kb,Mb,vc){return 1===kb?32:this.fan(kb,Mb,vc.value)}G7m(Q,ya,kb,Mb,vc){vc.MinValue=100*this.iVc;vc.MaxValue=100*this.QUc;vc.value=this.MFc;return 32}C7h(){return this.L_k}D7h(){return this.M_k}szl(){let Q=
Math.floor(100*this.jj).toString();1===this.Ala?Q=aj.h8e:2===this.Ala&&(Q=aj.CDd);return Q}Ghb(Q,ya,kb){if(1===kb)return 32;this.qUc(this.Bc?this.Bc.bH:0,"IncreaseZoom");this.Ala=0;this.Dia(this.RXm);return 32}jeb(Q,ya,kb){if(1===kb)return 32;this.qUc(this.Bc?this.Bc.bH:0,"DecreaseZoom");this.Ala=0;this.Dia(this.QXm);return 32}m3n(Q,ya,kb,Mb,vc){if(1===kb)return 32;this.qUc(this.Bc?this.Bc.bH:0,"SetZoomLevelFromRibbon");Q=vc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new Tb.a(0,1,0,()=>{this.zoomToPageWidth(0,
null,2,null,null)},138,void 0,!0),Fl.a.instance.Xb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.Ala=0;this.Dia(Q);return 32}qUc(Q,ya){na.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,ya,F.AFrameworkApplication.ta.Pb.nq)}rhc(Q,ya,kb){if(1===kb)return 32;na.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.szl();this.eg=new Ej.a(this.C7h(),this.D7h(),Object(a.a)(this,
this.m5l,"handleZoomDialogResult"),eh.FocusManager.instance(),!0);this.eg.rhc(CommonUIStrings.l_ZoomDialogTitle,Q)}knm(Q){return Q.toLowerCase()===aj.h8e.toLowerCase()}lnm(Q){return Q.toLowerCase()===aj.CDd.toLowerCase()}m5l(Q){if(Q){if(this.knm(Q)){this.Ala=1;var ya=32}else if(this.lnm(Q))this.Ala=2,ya=this.zoomToPageWidth(0,null,2,null,null);else if(ya=Number.parseInvariant(Q)){this.Ala=0;let kb=ya;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(kb=new Di(ya,!0));ya=this.c5i(kb)}else ya=
8;32===ya?na.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):na.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else na.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}Bsn(){this.Ld.raiseEvent("ZoomChanged",null)}LQi(){}OUf(){}Cuj(Q){if(!this.eg)return 2;var ya=this.eg.Hh.Ks().Xj.G2;if(ya===this.eg.wz&&Q===Ua.a.L8c||ya===this.eg.AG&&Q===Ua.a.K8c)this.eg.pxb||this.eg.KRn(),this.eg.Hh.Ks().Xj.vy(this.eg.pxb);else if(ya.id.startsWith(this.eg.b_c)||
ya.className.startsWith(this.eg.oQi))ya=null,Q===Ua.a.L8c?ya=this.eg.AG:Q===Ua.a.K8c&&(ya=this.eg.wz),this.eg.Hh.Ks().Xj.vy(ya),Sys.UI.DomElement.removeCssClass(this.eg.pxb.parentNode,this.eg.FUf);else if(Q===Ua.a.L8c)this.eg.Hh.Ks().Uac();else if(Q===Ua.a.K8c)this.eg.Hh.Ks().Sac();else return 2;return 32}}aj.h8e="FullPage";aj.CDd="PageWidth";Object(e.a)(aj,"ZoomManager",null,[833]);var Ze;(function(Q){Q[Q.manual=0]="manual";Q[Q.fitToFullPage=1]="fitToFullPage";Q[Q.fitWidth=2]="fitWidth";Q[Q.onBoot=
3]="onBoot"})(Ze||(Ze={}));Object(e.b)("ZoomStatus",Ze);c(1035);var ue;(function(Q){Q[Q.normal=0]="normal";Q[Q.quiet=1]="quiet";Q[Q.disableScrollUpdate=2]="disableScrollUpdate";Q[Q.disableUiControlUpdate=4]="disableUiControlUpdate"})(ue||(ue={}));Object(e.b)("ZoomUpdateFlags",ue);var $e=c(258),rg=c(351),Hf=c(1182);class zj extends aj{constructor(Q,ya,kb,Mb,vc,id,ae){super(Q,ya);this.nHo=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.oHo=[aj.CDd,"200","150","125","100",
"75","50"];this.dQe=this.nZi=!1;this.yBg="AutoFitForAdaptiveLayout";this.cMj="FitPageWidthFailure";this.v6j="UpdateZoomFailure";this.S7j="wwf";this.tRe=null;this.ISi=()=>{this.Ala===Ze.fitWidth&&this.sdf()};this.$Yk=we=>{if(we.ctrlKey){F.AFrameworkApplication.ya.processAction(pg.a.bCh,2);we=we.tGo;if(!we)return!1;this.Dia(this.jj-(0<we?.1:-.1));this.qUc(6,"CtrlScroll");return!0}return!1};this.gan=()=>{na.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};
this.hW=kb;this.Qj=Mb;this.Vb=vc;this.qg=id;this.zqc=ae;this.SSg=Q.$("KeepViewAfterZoomIsEnabled");this.T7j=Q.$("ZoomShortCutIsEnabled");this.J6j=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.FQj=(this.fye=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.cKj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.U7j=Q.$("ZoomSliderIsEnabled");this.jz()}get appName(){return"WordEditor"}get QUc(){return 4}get iVc(){return.1}get aZk(){return wacBoot.CtrlWheelMetrics}jgk(Q){this.Ld.addHandler("PinchStart",
Q)}cGn(Q){this.Ld.removeHandler("PinchStart",Q)}igk(Q){this.Ld.addHandler("PinchEnd",Q)}bGn(Q){this.Ld.removeHandler("PinchEnd",Q)}get qJ(){return null!=this.swg?this.swg:this.swg=za.a.instance.Pa("WordEditor.IStatusBarUser")}Nqj(Q){Q=!(Q&ue.disableUiControlUpdate);const ya=Wa.a.get_instance().isCompleted(7);return Q&&ya?(Q={SelectZoomOption:"ComboBoxModel"},If.App.xa&&If.App.xa.xG(Q),this.XBo(),!0):!1}Dia(Q,ya=ue.normal){let kb=!0;this.cKj||F.AFrameworkApplication.ya.processAction(Bf.a.Dia,2);if(this.jj===
Q)return this.dQe||(this.dQe=this.Nqj(ya)),kb;Q>this.QUc?Q=this.QUc:Q<this.iVc&&(Q=this.iVc);var Mb=!!(ya&ue.quiet);1===Q||Mb||F.AFrameworkApplication.ya.processAction(Bf.a.Wfg,2);try{Mb=null;If.App.xa&&Object(oi.a)(Hf.PageView,If.App.xa.jb.wc)&&(Mb=If.App.xa.jb.wc);let vc=-1,id=-1,ae=-1;const we=!(ya&ue.disableScrollUpdate);this.SSg&&we&&(vc=ql.SelectionEditor.EZl(rp.a.instance.hb.kb,Mb),id=Mb.NK.scrollLeft,ae=Mb.NK.scrollTop);const Ee=this.jj;this.E8i(Q);this.Bsn();this.dQe=this.Nqj(ya);we&&this.wAo(Mb,
vc,id,ae,Ee)}catch(vc){kb=!1,na.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",vc)}return kb}wAo(Q,ya,kb,Mb,vc){Q&&Q.isActive?this.SSg?0<=ya&&100>=ya?Q.Es.h4(100-ya,!0,!0):Q.Es.rAm(kb,Mb,vc,this.jj):Q.Es.h4():na.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}OKo(Q,ya,kb){2===kb&&(this.qUc(this.Bc?this.Bc.bH:0,"ZoomTo100"),this.Ala=Ze.manual,this.Dia(1));return 32}c5i(Q){this.Ala=Ze.manual;let ya,kb=!0;if(this.J6j){if(!Object(oi.a)(Di,Q))return na.ULS.sendTraceTag(51644238,
353,10,"actiondata is not a SetCustomZoomArgs"),8;ya=Q.zoom/100;kb=Q.$ik}else ya=Number.parseInvariant(String.format("{0}",Q))/100;na.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",ya);Q=ue.normal;kb||(Q=ue.disableScrollUpdate);this.Dia(ya,Q);return 32}zoomToPageWidth(Q,ya,kb){if(1===kb)return 32;na.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(Wc.a)("ZoomToPageWidth",!0);this.Ala=Ze.fitWidth;this.mcl();return this.sdf()}F7m(Q,ya,kb,Mb,vc){if(1===
kb)return 32;Q=qb.a.SCa(this.MFc,6,F.AFrameworkApplication.numberFormat);vc[$e.a.labelText]=Q;return 32}C7h(){return this.nHo}D7h(){return this.oHo}mcl(){this.nZi||(If.App.xa?(If.App.xa.jZ(this.ISi),this.nZi=!0):na.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}sdf(){var Q=If.App.xa?If.App.xa.jb.wc:null;if(Q&&If.App.xa.vC){var ya=null;(Q=this.pzl(Q))&&(ya=this.hW.fJ(Q));ya||(ya=this.hW.Nif());if(null!==ya)return ya=hn.a.instance.Pt(ya),
ya=gn.a.Mi(ya,0),Q=this.zqc(),ya+=Q&&Q.Dbe()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,ya+=2*rg.a.wfg,this.Dia(If.App.xa.vC.offsetWidth/ya),32;na.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else na.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}pzl(Q){return Q&&Q.Bb&&Q.Bb.hb.kb&&Q.Bb.hb.kb.Qa&&Q.Bb.hb.kb.Qa.node?Q.Bb.hb.kb.Qa.node:null}XBo(){this.qJ&&(this.U7j?(this.qJ.oU(ah.a.JKo),this.qJ.oU(ah.a.LKo)):
this.qJ.oU(ah.a.MKo))}Zfo(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var ya=Q.ctrlWheelOccurred;if("boolean"!==typeof ya)na.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{na.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",ya);try{Q.stop()}catch(kb){na.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",kb)}}}else na.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}jz(){this.Zfo(this.aZk);if(this.Qj){var Q=document.getElementById(gj.AppFrame.fEd);
Q&&this.Qj.mb(A.a.Wjb,Q,this.$Yk)}this.Vb&&(Q=this.Vb.le(gj.AppFrame.oE),this.T7j&&(Q.bindAction(vd.KeyInputManager.lc(cf.a.dkc,vd.KeyInputManager.Rh),Ua.a.Ghb),Q.bindAction(vd.KeyInputManager.lc(cf.a.X7c,vd.KeyInputManager.Rh),Ua.a.Ghb),Q.bindAction(vd.KeyInputManager.lc(cf.a.ekc,vd.KeyInputManager.Rh),Ua.a.jeb),Q.bindAction(vd.KeyInputManager.lc(cf.a.fkc,vd.KeyInputManager.Rh),Ua.a.jeb),Q.bindAction(vd.KeyInputManager.lc(cf.a.D9c,vd.KeyInputManager.Rh),Bf.a.vje)));this.qg&&(this.tRe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&
this.qg.mb(A.a.click,this.tRe,this.gan);this.FQj&&(If.App.xa.eI.registerLayoutBreakpointChanged("canvas",ya=>{this.PWe(ya)}),If.App.xa.eI.registerBoundingWindowRectsChanged("canvas",()=>{this.PWe(If.App.xa.eI.getLayoutBreakpoint())}))}PWe(Q){let ya=!0,kb="";if(this.Ala!==Ze.onBoot)return ya;Ca.Health.instance.recordKpiUsage(this.yBg,0,this.S7j,null);switch(Q){case "Small":8===this.sdf()&&(kb=this.cMj,ya=!1);break;default:1===this.jj||this.Dia(1)||(kb=this.v6j,ya=!1)}ya||Ca.Health.instance.recordKpiFailure(this.yBg,
kb,!0,!0,null);return ya}GTi(Q){this.jgk(Q)}zVi(Q){this.cGn(Q)}FTi(Q){this.igk(Q)}yVi(Q){this.bGn(Q)}LQi(){this.Ld.raiseEvent("PinchStart",null)}OUf(){this.Ld.raiseEvent("PinchEnd",null)}}Object(e.a)(zj,"WordEditorZoomManager",aj,[1910,833]);class Oi{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(F.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),ya=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.Wb();
Sys.UI.DomElement.overrideGetBounds=!0;F.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&F.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&ya&&Wa.a.get_instance().al(4,()=>{ya.PWe(If.App.xa.eI.getLayoutBreakpoint())||na.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}xc(Q){this.W=Q;F.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new zj(F.AFrameworkApplication.K,
F.AFrameworkApplication.ya,Uh.WordSectionNavigator.instance,Cg.a.instance,eh.FocusManager.instance(),Ce.a.instance,()=>Q.Pa("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new qg(F.AFrameworkApplication.ya,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),F.AFrameworkApplication.K)).singleInstance())}static main(){ca.a.instance.Kc(new Oi)}}Object(e.a)(Oi,"ZoomPackage",null,
[1,2]);var bj=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",
ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",
LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",
attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",
LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},
children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",
Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",
LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",
MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class Nj extends dh.a{constructor(Q){super(!1,!1,!0);this.T9c=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.T9c.Pqf}};this.Wh("",Object(a.a)(this,this.IZf,"resultHandler"),Q)}IZf(Q,ya){1===Q&&(this.T9c.Pqf=ya.tooltipPersistenceEnabled)}}Object(e.a)(Nj,"AccessibilitySettingsDialog",dh.a,[]);class lh{constructor(Q,ya){this.ga=Q;this.T9c=ya}Wb(){this.ga.pa(Ua.a.c9n,We.a.frame,Object(a.a)(this,
this.d9n,"showAccessibilitySettingsDialogHandler"))}d9n(){(new Nj(this.T9c)).start();return 32}}Object(e.a)(lh,"AccessibilitySettingsDialogActor",null,[1678]);const Fk=Q=>{const ya=new r.a;F.AFrameworkApplication.Ve.qj(Rq(Q),1,null,null,!0,2,kb=>{200===kb.data.jf?ya.Cg("true"===kb.data.Ae.toLowerCase()):ya.Cg(!1)},()=>{ya.Cg(!1)},null,void 0,void 0,void 0,void 0,"7");return ya.task},Rq=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",F.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||
"",Q,F.AFrameworkApplication.Gm);class Ym{constructor(){this.rTb=null}get Pqf(){return!!this.rTb}set Pqf(Q){Q!==this.rTb&&(this.rTb=Q,ci.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.gni()&&F.AFrameworkApplication.Ve.qj(Rq("saveHoverableRibbonTooltipIsEnabled"),2,Q.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}SEm(){const Q=new r.a;if(this.rTb)Q.Cg(this.rTb);else if(this.gni()){const ya=Fk("getHoverableRibbonTooltipIsEnabled");
ya.continueWith(()=>{this.rTb=ya.result;ci.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ya.result);Q.Cg(ya.result)},8)}else Q.Cg(!1)}gni(){const Q=F.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),ya=F.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&!ya}}Object(e.a)(Ym,"AccessibilitySettingsInfo",null,[1677]);class xv{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}xc(Q){this.W=Q;this.W.register(Ym,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Xd(()=>
new Ym).singleInstance();this.W.register(lh,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Xd(()=>new lh(F.AFrameworkApplication.ya,this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const Q=this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ya=this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&ya?(ya.Wb(),
Q.SEm()):w.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){ca.a.instance.Kc(new xv)}}Object(e.a)(xv,"AccessibilitySettingsPackage",null,[1,2]);class Sq{constructor(){this.events=[];this.UYf=!1}static Szf(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!Sq.zAm[Q.key]}static nvk(Q,ya){let kb;kb=Sq.Szf(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=ya?(ya.altPressed=
(!!Q.altKey).toString(),ya.ctrlPressed=(!!Q.ctrlKey).toString(),ya.key=kb,ya.repeat=(!!Q.repeat).toString(),ya.shiftPressed=(!!Q.shiftKey).toString(),ya):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:kb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static mmi(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static bLh(Q){return!!Q&&Sq.mmi(Q)&&Sq.Szf(Q)}static cLh(Q){return!!Q&&Sq.mmi(Q)&&
!Sq.Szf(Q)}keyPressedEventHandlerStart(Q,ya){Sq.cLh(Q)&&this.wej(Q,ya)}keyPressedEventHandlerEnd(Q){Sq.cLh(Q)&&this.afj(Q)}keyDownEventHandlerStart(Q,ya){Sq.bLh(Q)&&this.wej(Q,ya)}keyDownEventHandlerEnd(Q){Sq.bLh(Q)&&this.afj(Q)}wej(Q,ya){Q={["metadata"]:Sq.nvk(Q,ya),["timeStamp"]:this.njc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.njc(performance.now()-Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(Q);this.WAn()}afj(Q){if(0!==
this.events.length){var ya=this.njc(Q.timeStamp);for(let kb=this.events.length-1;0<=kb;--kb){const Mb=this.events[kb];if(Mb.timeStamp===ya){Mb.timeToHandlerFinishMs=this.njc(performance.now()-Q.timeStamp);Mb.eventDurationMs=this.njc(Mb.timeToHandlerFinishMs-Mb.timeToHandlerStartMs);break}}}}njc(Q){return Number(Q.toFixed(2))}WAn(){if(!this.UYf){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.UYf=
!1;const ya=performance.now();this.events.forEach(Mb=>{Mb.timeToRequestAnimationFrameMs=this.njc(ya-Mb.timeStamp)});var kb=document.createEvent("CustomEvent");kb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(kb);this.events=[];kb=document.createEvent("CustomEvent");kb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(kb)});this.UYf=!0}}}Sq.zAm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,
["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Xs{constructor(){this.N8d=this.Z2a=this.DPa=this.yac=null;this.N9b=!1;this.Gec=null;this.sJc=[];this.l7c=()=>{Xs.itm()&&null==this.Z2a?(this.DPa=null,this.Z2a=requestAnimationFrame(this.SUc)):null!=this.Z2a&&(cancelAnimationFrame(this.Z2a),this.Z2a=null)};this.SUc=Q=>{if(null!=this.DPa){const ya=Q-this.DPa;if(null==this.yac||this.yac<ya)this.yac=ya;for(let kb=0;kb<Xs.ranges.length;++kb)if(ya<Xs.ranges[kb]){++this.sJc[kb];
break}}this.DPa=Q;this.Z2a=requestAnimationFrame(this.SUc)};this.$Xi=()=>{if(null!=this.yac){var Q={};for(var ya=0;ya<Xs.ranges.length;++ya)Q[Xs.ranges[ya]]=this.sJc[ya],this.sJc[ya]=0;ya=performance.now();Q={["intervalStart"]:this.Gec,["intervalEnd"]:ya,["maxFrameLengthMs"]:this.yac,["frameData"]:Q};var kb=document.createEvent("CustomEvent");kb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(kb);this.yac=null;this.Gec=ya}}}static sxf(){return!!window.performance&&!!window.performance.now}start(Q){!this.N9b&&
Xs.sxf()&&(this.H3n(),this.N8d=setInterval(this.$Xi,1E3*Q),this.Gec=performance.now(),this.l7c(),document.addEventListener("visibilitychange",this.l7c),this.N9b=!0)}stop(){this.N9b&&(document.removeEventListener("visibilitychange",this.l7c),null!=this.N8d&&(clearInterval(this.N8d),this.N8d=null),null!=this.Z2a&&(cancelAnimationFrame(this.Z2a),this.Z2a=null),this.$Xi(),this.N9b=!1)}get XRc(){return this.N9b}H3n(){this.sJc=[];for(let Q=0;Q<Xs.ranges.length;++Q)this.sJc.push(0)}}Xs.itm=()=>"visible"===
document.visibilityState;Xs.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];var Ln=c(71),gr={get w8k(){var Q=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;if(!Q)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return Q}},rt=c(1494);class Vv{constructor(Q,ya){this.jEd=Q;this.I1c=ya;this.RHi=(kb,Mb)=>Object(Ln.__awaiter)(this,void 0,void 0,function*(){if(Mb.mpa){Object(Wc.a)("AiMakerInitializationTriggered");
this.jEd.YFa(this.RHi);this.jEd.he();var [,vc]=yield Promise.all([this.FEm(),Promise.all([c.e(3),c.e(7),c.e(14)]).then(c.bind(null,1974))]);vc.main(gr.w8k)}})}initialize(){this.jEd.Fsa(this.RHi);this.jEd.initialize()}FEm(){return Object(Ln.__awaiter)(this,void 0,void 0,function*(){return F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiMakerDocumentWizardUx"):(yield Object(rt.b)(this.I1c)).pA.loadScript("aiMakerDocumentWizardUx")})}}Object(e.a)(Vv,"AiMakerInitializer",
null,[]);var hr=c(707),om=c(928);class mu extends om.a{constructor(Q){var ya;super("BooleanFeatureGateConditionId");this.du=Q.du;this.y3b=Q.y3b;this.defaultValue=null!==(ya=Q.defaultValue)&&void 0!==ya?ya:!1}initialize(){super.initialize();const Q=F.AFrameworkApplication.K;Q.lp(()=>{const ya=Q.getBooleanFeatureGate(this.y3b,this.defaultValue);this.nj(ya)})}nj(Q){super.nj(Q);na.ULS.sendTraceTag(512369937,3028,50,this.E2(this.du,Q,`featureGate=${this.y3b}`))}}Object(e.a)(mu,"BooleanFeatureGateCondition",
om.a,[]);var Rn=c(1678);const xm="CH DE FR EU UK NO SE NL PIE".split(" ");class yv extends om.a{constructor(){super("AiMakerDocumentWizardDatacenterConditionId");this.du=16}initialize(){super.initialize();F.AFrameworkApplication.K.lp(()=>{var Q,ya,kb,Mb;const vc=null!==(ya=null===(Q=F.AFrameworkApplication.sessionStartInfoSettings)||void 0===Q?void 0:Q.WACDatacenter)&&void 0!==ya?ya:"unknown";Q=null!==(Mb=null===(kb=F.AFrameworkApplication.sessionStartInfoSettings)||void 0===kb?void 0:kb.Ring)&&void 0!==
Mb?Mb:"unknown";kb=this.Njm(vc,Q);this.nj(kb);na.ULS.sendTraceTag(509747520,3028,50,this.E2(this.du,kb,`datacenter=${vc}`))})}Njm(Q,ya){if("1"===ya||"unknown"===Q)return!0;const kb=Q.toUpperCase();return!xm.some(Mb=>kb.includes(Mb))}}Object(e.a)(yv,"AiMakerDocumentWizardDatacenterCondition",om.a,[]);class bv extends om.a{constructor(Q,ya,kb){super("AiMakerConsentGroupConditionId");this.du=Q;this.Osa=ya;this.defaultValue=kb}initialize(){super.initialize();this.Osa.execute(Q=>{var ya;Q.isFeatureEnabled("AiMaker",
null!==(ya=this.defaultValue)&&void 0!==ya?ya:!1).then(kb=>{this.nj(kb);return null})})}nj(Q){super.nj(Q);na.ULS.sendTraceTag(509752010,3028,50,this.E2(this.du,Q))}}Object(e.a)(bv,"AiMakerConsentGroupCondition",om.a,[]);class Dn extends hr.a{constructor(Q,ya,kb){const Mb=new mu({du:16,y3b:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});Q=new Rn.a(16,Q,ya,!0);ya=new yv;kb=new bv(16,kb);super(16,new X.a([Mb,Q,ya,kb]),null,3028,"BlankDocumentTriggered")}}Object(e.a)(Dn,"AiMakerDocumentWizardTriggerModel",
hr.a,[]);var Mo=c(926);class wj extends Mo.a{get name(){return"WordEditor.AiMaker.Entry"}Rta(Q){this.container=Q}Tta(){(new Vv(new Dn(this.container.resolve("Box4.IParagraphReader"),If.App.xa.jb.wc,this.container.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Za("Common.IDynamicScriptLoaderProvider"))).initialize()}Sta(){}static main(){ca.a.instance.Kc(new wj)}}Object(e.a)(wj,"AiMakerEntryPackage",Mo.a,[]);var ro={get interop(){var Q=aiInserterUx.interop;if(!Q)throw Error("aiInserterUx chunk is accessed before loading");
return Q}};class En{constructor(Q,ya){this.f3d=Q;this.I1c=ya;this.jXc=(kb,Mb)=>Object(Ln.__awaiter)(this,void 0,void 0,function*(){if(Mb.mpa){Object(Wc.a)("AiInserterInitializationTriggered");this.f3d.YFa(this.jXc);this.f3d.he();var [,vc]=yield Promise.all([this.uFm(),Promise.all([c.e(3),c.e(7),c.e(17)]).then(c.bind(null,1977))]);vc.main(ro.interop)}})}initialize(){this.f3d.Fsa(this.jXc);this.f3d.initialize()}uFm(){return Object(Ln.__awaiter)(this,void 0,void 0,function*(){return F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("aiInserterUx"):(yield Object(rt.b)(this.I1c)).pA.loadScript("aiInserterUx")})}}Object(e.a)(En,"AiInserterInitializer",null,[]);class Nt extends hr.a{constructor(){const Q=new mu({du:17,y3b:"Microsoft.Office.WordOnline.IsAiInserterEnabled"});super(17,new X.a([Q]),null,3028,"AiInserterAppTriggered")}}Object(e.a)(Nt,"AiInserterTriggerModel",hr.a,[]);class pl extends Mo.a{get name(){return"WordEditor.AiInserter.Entry"}Rta(Q){this.container=Q}Tta(){(new En(new Nt,this.container.Za("Common.IDynamicScriptLoaderProvider"))).initialize()}Sta(){}static main(){ca.a.instance.Kc(new pl)}}
Object(e.a)(pl,"AiInserterEntryPackage",Mo.a,[]);class Iu extends hr.a{constructor(){const Q=new mu({du:18,y3b:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"});super(18,new X.a([Q]),null,3028,"AiRewriteTriggered")}}Object(e.a)(Iu,"AiRewriteTriggerModel",hr.a,[]);var zv={get interop(){var Q=null===aiRewriteUx||void 0===aiRewriteUx?void 0:aiRewriteUx.interop;if(!Q)throw Error("aiRewriteUx chunk is accessed before loading");return Q}};class Eq{constructor(Q,ya){this.wvd=Q;this.I1c=ya;this.jXc=(kb,
Mb)=>Object(Ln.__awaiter)(this,void 0,void 0,function*(){if(Mb.mpa){Object(Wc.a)("AiRewriteInitializationTriggered");this.wvd.YFa(this.jXc);this.wvd.he();var [,vc]=yield Promise.all([this.pEm(),Promise.all([c.e(3),c.e(7),c.e(12)]).then(c.bind(null,1980))]);vc.main(zv.interop)}})}initialize(){this.wvd.Fsa(this.jXc);this.wvd.initialize()}pEm(){return Object(Ln.__awaiter)(this,void 0,void 0,function*(){return F.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiRewriteUx"):
(yield Object(rt.b)(this.I1c)).pA.loadScript("aiRewriteUx")})}}Object(e.a)(Eq,"AiRewriteInitializer",null,[]);class wr extends Mo.a{get name(){return"WordEditor.AiRewrite.Entry"}Rta(Q){this.container=Q}Tta(){(new Eq(new Iu,this.container.Za("Common.IDynamicScriptLoaderProvider"))).initialize()}Sta(){}static main(){ca.a.instance.Kc(new wr)}}Object(e.a)(wr,"AiRewriteEntryPackage",Mo.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");
Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");
Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("WordEditor.VersionHistory");ca.a.instance.Kc(new sf);Kf.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");
l;Type.registerNamespace("CACPU");la.main();Type.registerNamespace("CAEventTimingMeter");ja.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");fa.main();Type.registerNamespace("Common.App.GestureInput");sb.main();Type.registerNamespace("Common.App.GestureManager");ab.main();Type.registerNamespace("Common.ModernFontPicker");Type.registerNamespace("Common.App.OfflineLogger");ca.a.instance.Kc(new kc);Type.registerNamespace("Common.App.O365Shell");Fc.main();Type.registerNamespace("Common.App.PhoneLink");
Cf.main();Type.registerNamespace("Common.App.SensitiveLogging");ne.main();Type.registerNamespace("Common.App.Rename");ca.a.instance.Kc(new li,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");ca.a.instance.Kc(new Af);Type.registerNamespace("Common.App.SaveAsToHost");xo.main();Type.registerNamespace("Common.App.SaveToCloudStorage");cl.main();Type.registerNamespace("Common.App.SaveACopy");ef.main();Type.registerNamespace("Common.App.SaveToSharePoint");cn.main();Type.registerNamespace("Common.App.SharedFilePicker");
Ak.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");jd.main();yi;ca.a.instance.Kc(new vk);So.main();bj;ge.main();ca.a.instance.Kc(new xn);Hl.main();nf.a.prototype.toString=Bb.a.prototype.toString;Ec.a.w8h=new sd.a;ca.a.instance.Kc(new tl);Oi.main();ca.a.instance.Kc(new sp);ca.a.instance.Kc(new Ed);ca.a.instance.Kc(new Hs);
Cn.main();Jo.main();Kk.main();rb.main();Type.registerNamespace("NLRT");ca.a.instance.Kc(new Te);Type.registerNamespace("Common.App.AccessibilitySettings");xv.main();ca.a.instance.Kc(new ai);wj.main();pl.main();wr.main();window.EventTiming={EventTimingMeter:Sq,FrameTimingMeter:Xs}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18198024/wdjs/WordEditorDS.box4.dll2.js.map